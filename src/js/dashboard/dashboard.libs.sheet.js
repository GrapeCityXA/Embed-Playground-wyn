!function(){var o,n,t=(n={},r.m=o={306:function(t,e,o){var n,r;(n=o(674)).Spread.Sheets.LicenseKey=(r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAIAAAAlC+aJAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAB3RJTUUH5AkSBgUFv5FyKQAAEvBJREFUaN7tWnl4nlWVP+fed/32L1/2rWlKl9BSCkilbC2biKMFkU1nRAccGZwqoKODMDMs44rr8KDD4+AoqCjoIFQUSimlUGQpLXSxadM0aZZmT779+97t3jN/vF/SlCZtuow8Po/3Sf7Im/e99/zOfs85SETwl7zYu03AXwG82wQc71JO8H4kCQh8u0L0fwkIAMYfMkQEwBN1IJ4QIyYSQISMz5Cy0vvIAY8XyXECIJIC2QEx2tne4sjOYrLdznR5xTESFkmBis6VoBau1aNNZqLFLJvP1UDpeykQEfDYNfnYAZD0JkjP9r+R6ng207uxOLrLs5IgPUAGyBAQEIEkEQFJAGCqqYXrg9Wnx5oujjW9Tw1UHCeMYwFAJBEAkBHJ0V2/Htz6UG5gE3k2U0xUdAAk4ZJ0iYRPNAAiMmQKchWRk/SEVwTpqaHaxLwPVy35tFk27x0c+X8EMHHMaNsT+1//dn7wLcZ1roVJOMLNAUmuR7VQrRauU4NVXA0h49KzPCvp5Pqc7H63MCiFw7jBtRBJIewU1yOJlmvrz7pdC9WWAB+NKI4KQEnj7Wxv57rbku1Pc8XkWthzMtKzjNjsaOOFseZLw3XLVLN8ui3yw9vSXS+kOtbk+jdJN8+NOCJziyNqoKrh3LuqFt8AvkYxfqIBEAEQIBtrX9259nNuYUgNVAonK91CqHZp9emryhdcDQBS2Nm+13N9rxXH2tz8oHDzJD2umlyL6tFZwcpTw3VnG7FmALDSnf2bHxht/ZVXHFMC5SRcz0qWt1zbfOl/cTU4c3WaGQAi39/1vvbN3lfu4WoIFcMtDJmJloZz7krMu8LXqOEdP88NbvYKIyQ9RAbIEdm4EUuSAoCYGjRizbHmS6tP/Qc92uQWR3s23jW842eInOsRJzcQqFw0//LHjVjzDDHMBID/Au5b/6X+Td9Tg9UkXeFkq5bcNPui7wLA4NaH+rc8UBzdhagw1WRMmwhffghDAPDdEQBJIYUl3QLXwvE5H6g/59/M+NxM7ysda262ku1qsMorjiqBiparVgfKF84EwwwAkARkXS/d2ffafVqoVrg5ZGrz+36QmP+R3MDmjrWr8gNbuBpkqgkERHIc8GHOZIiMpCfsDFONqtNunnX+V4lk21PXje1ZrQWrPDujmPGF16414nOOaA9HAODzoH/LA/vWfV4L1ggny43YgiufDFYu3v/Gd3pf+Q8A4lqYSI57zKNYyBSSwrNGQzVL513+Kz1c37nu1oEtD2rBKs9O6dHZiz72omLEfA4eCwCf+nT3i7t+s5LrYenZTA0uvO45s2x++7OfHt72E8UsR2RE4mhJPxiGKuwUN2Lzr3g8XLusc91tA1t+qIVq3fxArPmyBVc+AUCHyVCm97hEyBTPznQ8twq56uOcf8VjZtn8PU9fP7ztJ2qwGvys5vgWSZfrUekUWn+zMrv/1dkXfS+x4Go3P6AGq5Ptv+vb9H0AJOkdNQAiCQA9L/+7ldzDtbCwkrMuuC9ce1bn87eO7Pylb8pHVveZYvCYagDJXU9eZaX2zvvQzwOViz0rqQQq9r/2jeJYGzKFplHRqQEQCWQ81//m0I6H1UClWxgqm/+RqsU3DG778cBbP1SDVSTdE0L6JAyCKaa0s7ufvBoA5lz2EDKOyIST7XnlHpheh6YGgIAAsP/1+0i4JD3FLG++5H4729u94U5FjxNJRIbIS7aFDH2XDwCAiPzY8mSSHtejheE/daxdFaw4pfr0z7iFEcVMJPf8LtO7EaYxtikAEElAlhvYnNq3VjHinjVWc8YqxSjrfP4W4WSQqyCFcHKenSbPAmTkWZ6dFk6uxEkn4zlpEs4x3FpIuqqZGNr+cLbv9YZz79WjTeRZRHJgyw9LjJ2RBIgAYHjHI+TZJF090li79Avpng2pjmcVI07CBcYSLdfULbvdLG8RdtqsWFi37PaylquJJHKlfNH1tUu/qEebSNjHdF9BAOjZeBciVp92k2dnFCOW7nqhONaGyA511ofGOULGPTud6nyO6xHPTlcuvgGR973+HQAEYFJYFQtvmH3Bt5Ap0VkXdr14e9OF3w7XLCUSe/EfFSPetOI+AIg0nLf3mU9JJwfIj8rWiYSiRTI9GzP7/1i15Ka+Td8n6Xh2aqx9dd3Sf/a193AS8I0927vRznQjU5iiV55yvZXqzPZu5FqYSABiqOZMP8IHyhdFZl0QSJwMAIg8XH9euO4cf59Q1WlqqEZK9whC8O8JyPwL0AEZkBx8+7+5GojOulDYWa6YqY41AHBoZnGIChEAQLprPRBJr2gmWsyyBSO7HhNuvhTSCVIdz7jFEQBIdvx+5E+PjnX8AQDsXN/IzkdHWn/pWkkAGOt4xknvY1yDw0R6ROkW3MKw52Slk5NufjxfkkwNZnpeJOkm5l8JJJhiFkZ2WqkOAHiHFr0TkE9lbnALUwzpFiP15wFAunMt4zqQBJJMMVJ7n2nLD6rBKjVUU7fs9sLw9t1tT3A9VjZ3pfSsfetuk8LK9W+Sno1MnVZ/kEmvWDbv8kjD8kzPBqaYJNzR3b9hahBIMq65uYF01/po4wrFTBAJYafzQ28bsWYimizUgyVABABuftBOdyHXCChSf45w88WxNqYYE0kH43qme4ObH2xYdkf14hvr3vtFkiLW9L6a0z5Td+bnQ3XLkm1PSTuLXD2M9iMy6eQCFacEq08vm3tFuO4cM7FAuPmSiiMSyXTPBq6F9VgzeTYQ5Ye2HVCSKQH42a+d3S/sFCBjihGoOKU40upZSWDK5C8Z183yhYoeAwBFi4TqlgXKF/j/ClYuVgIVgAyOmOciCicr7AxJj6TjWSkEBuNFJGRqYWg7AJhlC6RwkClWaq8vusPYgC+BAenZQJJrYS1UW0y2k3RxstgQmWJkul5Ida2TnpXu3Tiy/eHhnb/y7Iyd6x/a/rB08yVrOyjGwUExDhki53oUmQoAilmuGPHJrESuOtleADBis4EEMsXNDwIAHuwVDrYBIkDwrKSv7lwLMcVw8/2T80EiIawcIHojre1Pf9KsWFQc3elk9lvJ9kzXC0QiP/gWIifhMjUg3TxJD5BxNUgkhZMDIMZ1ZIpXHAPAwbceTHWscTLdRIJxQzHiJP1wS4hcOBkAUoNVBATIfFlhSRdwaiMGAClsACIg5BoASLcwfqli0i0Eq5Y0nHuP9Apcj47teap34311y25NLLhaelb3hjsKwztO+sCP9UiTlerYt+7W+rPvjNSfZ2d6OtfdoocbG5d/VdEig1sfyva9NveS+xHZ4Nb/CdecGZ19iZPt7X7pX6V0mGICSSAARCkcKRymmCWrkC6RwINpnsnFeVxkJJliFEdb093rG8+92zd3AAjVLI3UnQ0Ag9EmK9kWb/6AYsTNxILO52+J1J8XrlsWrFrSue42xYjFZ18KAJnejYWRHbFZFwFAtPECf+9AokUNVv/p0RUHWw5OTcn0NgAAwBQTEBGQPBsAmBaaMF9ELuxstuflkqzcPCBIr1ACKBwiEHYGAISdBgDh5gDAs9O+7vnZmBTWRFpWGG3d/eQ1VrIdAIzILDVYQ9IBREAAIsY1xnXp5ktmzdUjBTJEAFCMOCAHZMLJCbeghWr82FhSTcaZFpps9JMii196KUGdtD8iAMhSFoDAJniZ6nh2YMuv80NbAYBgcpqAJAU3YgDg5AcQEEgoehRLiQlOAwAQALRQDeM6IBNO1sn2mGXzkGvjQQBpsjNVQySA67HSx1wDQKaGfGoApO8xmGISCW5Ep9ABZIoxkSAcKI8iIElXDzcAgJXcC0wh6Y3fAaePxP41QAvXKUZcOFkprPzQtrK5l6tmQrh5RIVKziHrvx9runjxJ9eHa8/y/5y1/Gu1S7+gGDEAKI60eoW0FDYAcDWw4KrVZmzOFJpMRDROE0nPSpKUyNE32WDVEgAoju1mXJNuwYzP9T+BaSMxIgCpZrkeayZhI/JM78uMa2biZPIsRASSTA3kB98aePtHAMC1cLRxBVOM4Z2PFkZbjdiccM1SRG5nunteuYep2tD2n/pcDtcsLab2+kYPRDhOAnIVCJii+6o7a/nXuB4B6QEQMiXauMItjtqpDuQ6IAtUnnoIAw7xQn71M1TznmzPS0wNZXtfAYB48/vTXeu4n44TMaZ1rf/SWNtvg5WnEon80NZMz0tasCbSuFwL1XrWWKpzjVdMqoHyVMezO36xPFR3lp3qzA28ecrfbQQA5LqVbN/95DWAaKU61GC099VvDG37KZFgSsDno/RsLVwXaTh/ZNfjnp1SjDLFTPgCOWwgG7e3aOOF/W/ezxTdGtuTG3wr0XJNzx+/cqA0gMjUQLb3lXTXegBgXFPNhHTzo62PE0lEZFqIqQGSHlOD+aGt2f43gKQeneXrOjIunGyq8zmSLuM6UwOFoW15uRkA/eiJXPPsdHnLtQAwuvsJxlTpFiIN5+rheiA6fCoBvh+I1C0zYs0kHJLe0PafasHqWNNFwskcKJKR5FpIDZSrgXKmhUgKQK4YcTVQrphliAqQ9AliakA1y33DmFB7YJzrEUWPoaL77yh6TNGjihH32w6M61Wn3eQWRzI9G7gWkcKKNV8GU1VxDo0DSNJjaiA+52+Ek+VGdKztt8LJ1r33X5Apk6tgRJKkR9Ibd6NEJEh6fhF3slKOPywZK2MqEAFJv1NWeoeE/4OMCzsdnX1JsGLxwOYfeMUkAKlmRdlJH5rg7+EBlF6qWPRxpoUQuVsY6n3168GqJYn5VwkreQxNlAOHcQ0AimO7cdp7JpKUjOuzzv+qcLJD23+iGHHPTsXmXKZHGokEzASAX8AIJFrKTlrpFcdUIzG09cdWet/si/9TDVZJzzrqZhYCkGRcB+RDOx4ZaX2c65HxpO0dJytecbT6jFVm2fyuDV9284PIFKYYNad/ZnyjQ5gy/ZlQ994v+kFXeIXOtau4Fp598f3SLeA0e027iJCpnp3e8Yvlnc/903R9YmSKZ42FG85tPO/edM+G4e2PKIEKrziSWHBtsHIJkcCpGMfvvvvuKfZCJOmpwUrh5lOda7RgVX5oG3K16tQbATG59/dcDx/5vnLwjiA9YSW5GpyUmBxEvXCyWqh24XXPA9Cu/10pvSIAKUZs7gd/xrUwAkxZH5i+bM04ADScfWew6gzPSqqB8v1//MrYntX1y+6oOfNWNz+Ik+sIM8OAij5lAwGZKpysYsRPvvoPihHb9cSVdrqLa2HPSjWcd68WqvEvFVPuehgKkEggU+e8/0Hkmu/U25+5MdPzUtMF36o7+w7XGoWjbYweKjREZIpXHNEiDQs/ut6Iz2lb/bfp7vVqoNLJ9Vcs+njlouuB5GFOmVGDY6T18fbff0IxE1LYiOykDz4Sn33pSOtjnetuE3ZaMWJAx1BnR2RcClvY6fhJH5y38peM67tXf3Ss7bdasMYtDIVqzlx43Vr0fe70xaUjt5j8Jk/f5vu7XvhnNVBFwpHCbjz/3pozPufk+vauuTnd+RwylWmhUrPjCBui3/mTwhZ2Rg1W1S/7cvVpNzv5wbanrs31va4Gq93CsFk29+Tr1qpmOZEYz8yPFQD4rXlkfZu+2/XiHYoZR2RuYbRs3ofnvP9BRY8mO9f0vf7tbN9rJF2uBJDryFjJUukA2f5GJF3pFaVwtFBN+ckfrV92J9dCI62P7Vv/JWGNKWa5mx80y1tarnraV/0T0eQDAH+CBtnQjp91Pn8LAnE96haG1UBl7dLP15zxWQDI9m8a3vFIpudlO9Pt36FKPVZAICKQ/jiLYiYC5aeUzb288pRPMMUojOzofvmu1N5nuBZGRXdzA9Gmi+atfFQx4iewzTouBpKIPNv/xt5nP10caVWDVSQcz0oa8bmVi/++6tQb/TKRldqb63+zONrq5AeEkyXhMjWoGHEj1hSoXBKqfo8/qpLp3di/+YFU5xqSnmqUCTcnPav6jFVNK745obczIevoZiV8rgg33/Xil4d3PAwkuRGXniXsjBpIhGqWRpsuijScH0icPCXz3MJwrn9TqmtdpntDcWwXEChGnKTrWUkz0TJrxdfjpYxN4owd9DEMe5R4k93/au9r38x0vUAkFT1KQNLNS89miq4YZWqwUjESXAsCMvJsz0m7+WGvOCzsDAAyNcAUU3pF4WT1SGPlqZ+qPeOzTA2QFOP2M9N1TPNCRATSdw6ZnpcH3v5RpusF1xpjTGGK6TfkxjNQ6TtBRI5MAcYBgDxbehYwbpbNr1j4sYpFn1DNxIR4j5aW4xh4IoHj13ArvS/dtS7d/WJhcKuT65NesXQfmPDfRACATOFGzIzPDdWdFWu6OFx3jp+fkvRmPq52wgBMwCi5dgAAEG7eSrZb6U473e1ZY9IrkvSYYnA1qIVq9WiTET9JD9cf+Fx6xzk5d2KG/vx5FF9VZva6B+jDfpeH/qagza+TTMy4+A/HT0OE4xrx+zMA+HOvv/jJ3b8CeLfX/wFwDQ+oD4/bFQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMC0wOS0xOFQwNjowMzo1MCswMDowMCVYxZkAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjAtMDktMThUMDY6MDM6NTArMDA6MDBUBX0lAAAAAElFTkSuQmCC/WYNR3JhcGVDaXR5LUludGVybmFsLVVzZS1Pbmx5LFd5biBEYXNoYm9hcmQsNTY4MzM3Mzk0NTE5NDQyI0IwcjNyNElsYXBkaldpZEhTa1Z6SzlKbVVXSjdWNk5HZXpzU2RydDRWbUpFUklGbWM3b0hXWVpEU0JoVWJrVlZZaVJWZUhwVlNFWmtjeEk1VTh3VWFuaFZTWHBIYlM1R2JUUlZWaFJsYWpkRWRGZDRVWFpqY0ZoRFdabFhkRlJHU0ZKSE5uTkhheUZqYXZGbFl4Sm5TNDltVnhsNk45WVhiNnNrYllSSGFEVmphbE5uWnJJRlpqVnpTSHRXTXMzbU1vNW1TdUpITjdkN0s4UlVWWUZsUzVvVVZaTmpZS3RrTlZaWE1NZDZiaFpsV0RsVWR4ZFZWcTlXYjlSNGJhdEdVT3Q2ZHNSa01ybFRNOU41U3lFSE41ZHpTdWQ2Tm1SRGNKcG1SQmRXZXBSa0kwSXlVaXdpSUJGa1FCSnpRd1FqSTBJQ1Npd2lNd2dUTzdjRE85QWpNMElpY2ZKeWUmUWYzNVZmaVVVUkpabEkwSXlRaXdpSTRFakw2QkNJVHBFSWtGV1p5QjdVaW9qSU9KeWVicGpJa0pIVWl3aUk3UUROeVlETWdBak14RURNeUFqTWlvakk0SjdRaXdpSXlWR1p1Rm1jQ0JTYWhobVdpb2pJaDk0UWl3aUl5UUROOUVUTjRrek03TXpNOFlUTmlvaklrbGtJczRYWnp4V1ltcGpJeU5IWmlzbk9pd21iQkp5ZTBJQ1Jpd2lJMzR6WjZKWFlWNWtNNGdWV1NSSFU0VlZiSnR5Y1FSNU1CSlVibnA1UktoV1VuVlRRcmxtU3pWNlFGWm1iSzNFZFM5R2NLM1VTaVJIZXg4a1dyUVZOeXR5Tk9aWFJtQnpWdUZGZVlabVF2TVZXcVZHVjU0NlZsRlRPOE56THZsVFp4ZDROTWRFZEJoR1M4SVZhbjltVHY5bU52UjVTeHVtZTY=",atob(r.substring(r.indexOf("/WYN")+4))),t.exports=n},672:function(t,e,o){t.exports=o(673)},673:function(t,e,o){"use strict";o.r(e);var n=o(306),r=o.n(n);window.GC=r.a,e.default=r.a},674:function(t,e,o){var n,r,i,a,Kt="object"==typeof Kt?Kt:{};function s(t){if(a[t])return a[t].exports;var e=a[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,s),e.l=!0,e.exports}Kt.Spread=(a={},s.m=i={"./all.entry.js":function(t,e,o){(Kt=Kt||{}).Spread=Kt.Spread||{},Kt.Spread=o("./node_modules_local/@grapecity/js-sheets-common/index.js"),Kt.Spread.CalcEngine=o("./node_modules_local/@grapecity/js-calc/index.js"),Kt.Spread.CalcEngine.BasicFunctions=o("./node_modules_local/@grapecity/js-calc-basicfunctions/index.js"),Kt.Spread.CalcEngine.AdvancedFunctions=o("./node_modules_local/@grapecity/js-calc-advancedfunctions/index.js"),Kt.Spread.Sheets=o("./dist/core/core.entry.js"),Kt.Spread.Sheets.Bindings=o("./dist/plugins/data/data.entry.js"),Kt.Spread.Sheets.CalcEngine=o("./dist/plugins/sheetsCalc/sheetsCalc.entry.js"),Kt.Spread.Sheets.ConditionalFormatting=o("./dist/plugins/conditional/conditional.entry.js"),Kt.Spread.Sheets.DataValidation=o("./dist/plugins/validation/datavalidation.entry.js"),Kt.Spread.Sheets.Touch=o("./dist/plugins/touch/touch.entry.js"),Kt.Spread.Sheets.Sparklines=o("./dist/plugins/sparkline/sparkline-wrapper.entry.js"),Kt.Spread.Sheets.CellTypes=o("./dist/plugins/celltype/celltypes.entry.js"),Kt.Spread.Sheets.Tables=o("./dist/plugins/table/table.entry.js"),Kt.Spread.Sheets.Fill=o("./dist/plugins/fill/fill.entry.js"),Kt.Spread.Sheets.ContextMenu=o("./dist/plugins/contextMenu/context-menu.entry.js"),Kt.Spread.Sheets.FormulaTextBox=o("./dist/plugins/formulaTextbox/formulaTextBox.entry.js"),t.exports=Kt.Spread},"./dist/core/celltype/basecelltype.js":function(t,e,o){"use strict";var l,S,mt,yt,at,n,u,c,h,f,a,r,st,s,lt,bt,ut,vt,M,O,ct,V,p,z,b,C,ht,ft,pt,F,W,A,L,I,Ct,N,wt,xt,Tt,At,i,St,d,g,R,m,P,v,y,w;function dt(t){var e=t.isPrinting,o=t.printZoomFactor;return e&&typeof o===A&&1!==o}function k(){}function x(t,e,o){return st(t.x)||(t.x+=e.width),t.width=t.width-e.width-o.width,t}function Mt(t,e,o,n){var r,i=o.foreColor;i=mt.Im._ob(e,i),n=st(o.opacity)?n:o.opacity,st(n)||((r=a.ec(i)).a=n,i=a.bc(r)),t.fillStyle!==i&&(t.fillStyle=i||"#000000")}function T(){this.allowOverflow=!1,this.typeName="0"}function H(t,e,o,n){var r,i,a=t.conditionalFormats;return a&&(r=t.getValue(e,o,n),i=a.oRa(t,e,o,r).iconSet,a.bp(e,o,n)&&i)}function G(t,e,o){var n,r,i=0;for(n=0;n<t.length;n++)r=t[n].style&&t[n].style.font?t[n].style.font:e,i=Math.max(lt(r,I,ut(t[n].text))/o,i),(t[n].style&&1===t[n].style.vertAlign||2===t[n].style.vertAlign)&&(i=Math.max(lt(r,I,ut(t[n].text))/o+2*yt.To.No(r,d).fontSize*.218,i));return i}function U(t,e,o,n,r){var i,a,s,l,u,c=mt.Vn.bm();if(!c)return 0;for(a=i=0;a<t.length;a++)s=void 0,s=t[a].style&&t[a].style.font?t[a].style.font:e,t[a].style&&t[a].style.vertAlign&&(s=yt.To.No(s,d).font),vt(c,s),l=a===t.length-1&&r?mt.Vn.Rvb(t[a].text):t[a].text,u=0,n?u=lt(s)*l.length/o:st(t[a].text)||(u=ct(c,s,t[a].text)/o),i+=u;return i}function B(t){return parseInt(F*t.zoom(),10)}function It(t,e,o,n){var r,i,a,s,l,u,c=t.cellPadding,h=0,f=t.labelOptions;return o&&(c=f?f.margin:"0"),c&&(h=typeof(h=parseInt((u=["0","0","0","0"],typeof(r=c)===W&&(i=r.split(" ",4),a=i.length,l=s=void 0,1===a?(s=i[0],u=[s,s,s,s]):2===a?(s=i[0],l=i[1],u=[s,l,s,l]):3===a?(l=i[1],u=[i[0],l,i[2],l]):4===a&&(u=[i[0],i[1],i[2],i[3]])),u)[e],10))===A&&0<h?h:0),n===I?h:h*n}function E(t,e,o,n){var r,i,a,s,l=n&&n.sheet;l&&o&&(r=n.canvasOffset||l._eventHandler.bG(),i=l.Dr(),(a=e.backColor||"white").stops&&(a=(s=a.stops)[0]&&s[0].color),a.backgroundColor&&(a=a.backgroundColor),S.GC$(t).width(o.width).height(o.height).css({top:r.top+i.y+o.y-2,left:r.left+i.x+o.x-2,"background-color":a}))}function D(t,e){var o,n=It(t,0),r=It(t,2),i=It(t,0,!0),a=It(t,2,!0);if(!(It(t,3,!0)+It(t,1,!0)>=e.width))if((o=t.labelOptions.alignment)===I&&(o=t.labelOptions.alignment=0),0===o||1===o||2===o){if(0<n&&i+a<n)return 1}else if((3===o||4===o||5===o)&&n<e.height&&0<r&&i+a<r)return 1}function j(t){var e="left";return 1===t||4===t?e="center":2!==t&&5!==t||(e="right"),e}function _(t,e,o){var n,r,i;if(s(e,W))return n=0,g[t.font+e]?n=g[t.font+e]:(n=ct(t,t.font,e),g[t.font+e]=n),n;if(o&&e&&e[0]&&e[0].value)return e[0].value.length*lt(t.font);for(i=r=0;i<e.length;i++)"fillingChar"!==e[i].type&&(n=0,g[t.font+e[i].value]?n=g[t.font+e[i].value]:(n=ct(t,t.font,e[i].value),g[t.font+e[i].value]=n),r+=n);return r}function J(t,e,o,n,r){var i;return i=n?Math.floor(e/r):Math.floor(e/ct(t,t.font,o)),Array(i+1).join(o)}function Z(t){var e=t.clone();return e.width--,e.height--,e}function q(t,e,o,n){var r,i,a;for(r=0;r<t.length;r++)i=void 0,t[r].style=t[r].style||{},i=(a=t[r].style).font?yt.To.No(a.font,o).font:e,st(n)||(i=yt.To.No(i,n).font),a.font=i}function Nt(t,e,o,n,r){var i=o*xt(-n)+r*wt(-n),a=o*xt(-n)+r*wt(-n),s=t-i/2,l=e-a/2;return new mt.Rect(s,l,i,a)}Object.defineProperty(e,"__esModule",{value:!0}),l=o("@grapecity/js-sheets-common"),S=o("./dist/core/util/domUtil.js"),mt=o("./dist/core/util/common.js"),yt=o("./dist/core/worksheet/stylehelper.js"),at=o("./dist/core/core.enum.js"),n=o("./dist/core/celltype/celltype.ns.js"),u=o("@grapecity/js-calc"),l.Common.F,c=l.Common.CultureManager,h=l.Common.o,f=l.Common.l,a=l.Common.pc,r=l.Common.j,st=r.Fa,s=r.Ma,lt=mt.Ul.fp,bt=mt.Ul.ol,ut=mt.Ul.uWa,vt=mt.Ul.lZa,M=mt.Ul.hZa,O=mt.Ul.K_a,ct=mt.Ul.pL,V=mt.Ul.Fxb,p=mt.Ul.lHb,z=S.GC$.extend,b=mt.Ul.Ml,C="left",ht="right",ft="center",pt="alphabetic",F=16,W="string",A="number",L=null,I=void 0,Ct=Math.floor,N=Math.ceil,wt=Math.sin,xt=Math.cos,Tt=Math.tan,At=Math.abs,i="General",St=Math.max,d=.7,g={},R="...",(w=m=m||{})[w.top=0]="top",w[w.right=1]="right",w[w.bottom=2]="bottom",w[w.left=3]="left",k.Gxb=function(t){var e,o,n=t.split("e")[1];if(n&&0<n.length&&("+"===n[0]?e=!0:"-"===n[0]&&(e=!1),o=n.slice(1)),void 0!==e)return{isAdd:e,length:o}},k.Apb=function(t,e,o){var n=k.Hxb,r=n[e+o];return r||(r=ct(t,e,o),n[e+o]=r),r},k.Ixb=function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T=n.font;if(o=o-1-3*r,i=n.textIndent&&0!==n.textIndent,a=n.isVerticalText,typeof e!==A||!0===n.shrinkToFit||a||i)return n._autoFormatter;if(s=e<0,e=At(e),l=s?k.Apb(t,T,"-"):0,c=k.Gxb(u=""+e),h=void 0,f=k.Jxb(n._autoFormatter,e),c)return h=(""+c.length).length,h=St(h,2),k.Kxb(t,o,n,h,l,c.isAdd,f);if(p=l,d=k.Apb(t,T,"0"),g=u.split("."),p+=m=d*(""+Math.round(e)).length,y=k.Apb(t,T,"."),b=void 0,m<=o){if(!g[1]||0===g[1].length)return n._autoFormatter;if((p=p+g[1].length*d+y)<=o)return n._autoFormatter;if(e<.001)return h=(""+g[1].length).length,h=St(h,2),k.Kxb(t,o,n,h,l,!1,f);for(v=o-l-m-y,C=Math.floor(v/d),b="0",0<(C=Math.min(C,g[1].length))&&(b+="."),w=0;w<C;w++)b+="0";return b}return x=Math.round(e),h=St(h=(""+(""+x).length).length,2),k.Kxb(t,o,n,h,l,!0,f)},k.Kxb=function(t,e,o,n,r,i,a){var s,l,u,c=o.font,h=k.Apb(t,c,"0"),f=k.Apb(t,c,"E"),p=k.Apb(t,c,"+"),d=k.Apb(t,c,"-"),g=e-r-n*h-f-(i?p:d)-h,m=g-k.Apb(t,c,".");if(m<=h)return i?"0E+00":0<g?"0E-00":"0";for(s=Math.floor(m/h),s=Math.min(s,a),l="0",u=0;u<s;u++)0===u&&(l+="."),l+="0";return l+(i?"E+00":"E-00")},k.Lxb=function(t,e,o,n,r){var i,a,s,l,u,c,h=n.font;if(o=o-1-3*r,i=n.textIndent||0,a=o,1!==n.hAlign&&0<i&&(a=o-8*i),a<ct(t,n.font,e)){for(s=k.Apb(t,h,"#"),l=Math.floor(o/s),u="",c=0;c<l;c++)u+="#";return u}return e},k.ap=function(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d,g,m,y;if(i&&"none"!==i&&s)try{s.ko(i)?(l=s.lo(i),u=void 0,b.msie&&((u=document.createElement("div")).appendChild(l),document.body.appendChild(u)),c=l.width,h=l.height,b.msie&&(u.removeChild(l),document.body.removeChild(u)),f=c,p=h,d=n,g=r,m=e,y=o,1===a?(f=c<=n?c:n,p=h<=r?h:r,m=c<n&&0<c?N(e+n/2-c/2):e,y=h<r&&0<h?N(o+r/2-h/2):o,d=f,g=p):2===a?0<r&&0<h&&c/h<n/r?m=e+n/2-(d=c/h*r)/2:0<n&&0<c&&h/c<r/n&&(y=o+r/2-(g=h/c*n)/2):3===a&&(d=f=c<=n?c:n,g=p=h<=r?h:r),t.drawImage(l,0,0,f,p,m,y,d,g)):s.fo(i)}catch(t){}},k.cp=function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M=0,I=r&&r.sheet,N=o.textIndent,R=o.hAlign,k=o.isVerticalText,E=o.textOrientation,D=o.borderTop||o.borderBottom||o.borderLeft||o.borderRight,j=o.font,_=r.row,O=r.col;if(E&&-90<=E&&E<=90&&(l=At(E*Math.PI/180),a=wt(l),s=xt(l)),I&&typeof e===W&&e)if(u=[],c=void 0,t&&t.richText)if(h=o.formatter||o._autoFormatter,p=(f=I.getCellType(_,O)).T_a(h,t.text),q(c=z(!0,[],f.U_a(t,e,p,j,o.foreColor)),j,n),k)if(o.wordWrap){if(d=r.sheetArea,g=I.Sl(_),(m=I._modelManager.findSpan(_,O,d))&&m.row>=_&&m.col>=O&&1<m.rowCount)for(y=_+1;y<_+m.rowCount;y++)g+=I.Sl(y);for((b=0)<N&&(b=8*N),0<(v=It(o,0))&&(g-=v),0<(C=It(o,2))&&(g-=C),g++,u=mt.Vn.M_a(e,g-3-b,j,c,k),i=0;i<u.length;i++)M+=G(u[i].textInfos,j,n)}else M=G(c,j,n);else{if(o.wordWrap){for(w=e.split(/\r\n|\r|\n/),i=0;i<w.length;i++)(x=[]).push(w[i]),u.push(x);for(u=mt.Vn.O_a(u,mt.Vn.P_a(c)),i=0;i<u.length;i++)M=Math.max(M,U(u[i],j,n,k,!0))}else M=U(c,j,n);1!==R&&0<N&&(M+=8*N/n),H(I,_,O,r.sheetArea)&&(M+=B(I))}else if(u=e.split(/\r\n|\r|\n/),T=o.font,A=lt(T)/n,k)if(o.wordWrap)for(i=0;i<u.length;i++)M+=A;else M=A;else{if(o.wordWrap){if(E)return S=I.Sl(_),mt.Vn.mHb(_,O,a,s,e,T,S);for(i=0;i<u.length;i++)M=Math.max(M,mt.Vn.Xn(u[i],T,!0)/n)}else M=E?D?(4+A)/a:s*(I.dp(e,T)/n)+A*a:I.dp(e,T)/n;1!==R&&0<N&&(M+=8*N/n),H(I,_,O,r.sheetArea)&&(M+=F)}return M},k.ep=function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D=0,j=r&&r.sheet,_=o.font,O=o.isVerticalText,F=o.textIndent,P=o.vAlign,L=o.textOrientation,H=r.row,B=r.col;if(L&&-90<=L&&L<=90&&(v=At(L*Math.PI/180),y=wt(v),b=xt(v)),j&&typeof e===W&&e)if(C=[],w=void 0,t&&t.richText)if(x=o.formatter||o._autoFormatter,A=(T=j.getCellType(H,B)).T_a(x,t.text),q(w=z(!0,[],T.U_a(t,e,A,_,o.foreColor)),_,n),O){if(o.wordWrap){for(S=e.split(/\r\n|\r|\n/),i=0;i<S.length;i++)(M=[]).push(S[i]),C.push(M);for(C=mt.Vn.O_a(C,mt.Vn.P_a(w)),i=0;i<C.length;i++)D=Math.max(D,U(C[i],_,n,O,!0))}else D=U(w,_,n,O);1!==P&&0<F&&(D+=8*F/n)}else if(o.wordWrap){if(a=r.sheetArea,s=j.Tl(B),(u=j._modelManager.findSpan(H,B,a))&&u.row>=H&&u.col>=B&&1<u.colCount)for(c=B+1;c<B+u.colCount;c++)s+=j.Tl(c);for((f=0)<F&&(f=8*F),p=It(o,1),0<(d=It(o,3))&&(s-=d),0<p&&(s-=p),s++,C=mt.Vn.M_a(e,s-3-f,_,w),i=0;i<C.length;i++)D+=G(C[i].textInfos,_,n)}else D=G(w,_,n);else if(I=o.font,N=lt(I)/n,O){if(o.wordWrap)for(C=e.split(/\r\n|\r|\n/),i=0;i<C.length;i++)R=C[i].length*N,D=Math.max(D,R);else D=e.length*N;1!==P&&0<F&&(D+=8*F/n)}else if(o.wordWrap){if(a=r.sheetArea,s=j.Tl(B),l=j.Sl(H),(u=j._modelManager.findSpan(H,B,a))&&u.row>=H&&u.col>=B&&1<u.colCount){for(c=B+1;c<B+u.colCount;c++)s+=j.Tl(c);for(h=H+1;h<H+u.colCount;h++)l+=j.Sl(h)}if((f=0)<F&&(f=8*F),p=It(o,1),0<(d=It(o,3))&&(s-=d),0<p&&(s-=p),0<(g=It(o,0))&&(l-=g),0<(m=It(o,2))&&(l-=m),1===a&&(k=j.rowFilter&&j.rowFilter())&&k.Dl(H,B,a)&&k.filterButtonVisible(B)&&(s-=j.oK(new mt.Rect(0,0,s,l),a).width),L)return E=(l-N*b)/y,C=mt.Vn.Wn(e,E,I),y*(j.dp(C[0],I)/n)+N*b;D=(C=V(t)?[e]:mt.Vn.Wn(e,s-3-f,I)).length*N}else D=L?y*(j.dp(e,I)/n)+N*b:N;return D},k.gp=function(t,e,o,n,r,i,a,s,l,u,c){var h;1===l?(t.beginPath(),(h=t.createLinearGradient(e,o+1,e,o+r-2)).addColorStop(0,s.borderLeftColor),h.addColorStop(1,s.borderRightColor),t.strokeStyle!==h&&(t.strokeStyle=h),i.borderLeft||(t.moveTo(e+.5,o),t.lineTo(e+.5,o+r)),i.borderRight||(t.moveTo(e+n-.5,o),t.lineTo(e+n-.5,o+r)),u&&!i.borderTop&&(t.moveTo(e,o+.5),t.lineTo(e+n,o+.5)),t.stroke(),s.borderBottomWidth&&!i.borderBottom&&(t.beginPath(),t.strokeStyle!==s.borderBottomColor&&(t.strokeStyle=s.borderBottomColor),t.moveTo(e+1,o+r-.5),t.lineTo(e+n,o+r-.5),t.stroke())):(t.beginPath(),(h=t.createLinearGradient(e,o,e+n-2,o)).addColorStop(0,s.borderTopColor),h.addColorStop(1,s.borderBottomColor),t.strokeStyle!==h&&(t.strokeStyle=h),i.borderTop||(t.moveTo(e,o+.5),t.lineTo(e+n,o+.5)),i.borderBottom||(t.moveTo(e,o+r-.5),t.lineTo(e+n,o+r-.5)),c&&!i.borderLeft&&(t.moveTo(e+.5,o),t.lineTo(e+.5,o+r)),t.stroke(),s.borderRightWidth&&!i.borderRight&&(t.beginPath(),t.strokeStyle!==s.borderRightColor&&(t.strokeStyle=s.borderRightColor),t.moveTo(e+n-.5,o+1),t.lineTo(e+n-.5,o+r),t.stroke()))},k.hp=function(t,e){var o;o=2===e?"active":4===e?"inactive":0===e?"disabled":"auto",S.GC$(t).css("ime-mode",o)},k.bDc=function(t,e,o,n,r,i,a){var s,l,u,c;return!!(e&&"SparklineExValue"===e.typeName&&(l=(s=a.sheet)&&s.parent)&&(u=l.getSparklineEx(e.name)))&&(c={zoomFactor:dt(a)?a.printZoomFactor:s.zoom(),sheet:s,rowIndex:a.row,columnIndex:a.col},u.paint(t,e.value,o,n,r,i,c),!0)},k.Hxb={},k.Jxb=function(t,e){var o,n,r,i,a;return t&&t.Ud&&(o=t.Ud(e).format(e))&&o[1]&&"decimalSeparator"===o[1].type?(n=o[2])&&n.type===A?(r=n.value,a=(i=o[3])&&"exponent"===i.type&&i.value&&-1<i.value.indexOf("E"),!st(r)&&a?r.length:5):0:5},k.u5=It,P=k,e.Context=P,v={9001:65087,9002:65088,10216:65087,10217:65088,10092:65087,10093:65088,10096:65087,10097:65088,12296:65087,12297:65088,9121:65089,9126:65090,12300:65089,12301:65090,65378:65089,65379:65090,40:9180,41:9181,91:9140,93:9141,65339:9140,65341:9141,123:9182,125:9183,10100:9182,10101:9183,65115:9182,65116:9183,65371:9182,65373:9183,12310:65047,12311:65048,10098:65081,10099:65082,12308:65081,12309:65082,65117:65081,65118:65082,12304:65083,12305:65084,10218:65085,10219:65086,12298:65085,12299:65086,12302:65091,12303:65092},T.prototype.uxb=function(t,e,o,n){var r={ctx:t,options:{rect:e,context:o,value:n}};return T.ao(o.sheet,"paintCellPadding",r),r.options.rect},T.prototype.Mfc=function(t,e,o){var n={context:t,options:{dom:e,cellRect:o,contentRect:o.clone(),leftExternalRect:new mt.Rect(0,0,0,0),rightExternalRect:new mt.Rect(0,0,0,0)}};return T.ao(t.sheet,"onCreateCellEditor",n),n.options.dom},T.prototype.TBb=function(t,e,o){var n={ctx:null,options:{rect:e.clone(),context:t,value:null,style:o}};return T.ao(t.sheet,"getCellButtonRect",n),n.options.rect},T.prototype.Nfc=function(t,e,o,n){var r={context:t,options:{dom:e,cellRect:o,cellStyle:n,contentRect:o.clone(),leftExternalRect:new mt.Rect(0,0,0,0),rightExternalRect:new mt.Rect(0,0,0,0)}};return T.ao(t.sheet,"onActivateCellEditor",r),r},T.prototype.VBb=function(t,e,o,n){var r={context:t,contentContainer:e,editorBounds:o,cellStyle:n,contentRect:o.clone(),leftExternalRect:new mt.Rect(0,0,0,0),rightExternalRect:new mt.Rect(0,0,0,0)};return T.ao(t.sheet,"onUpdateContainer",r),r},T.prototype.Ofc=function(t,e,o){var n={context:t,options:{dom:e,cellRect:o,contentRect:o.clone(),leftExternalRect:new mt.Rect(0,0,0,0),rightExternalRect:new mt.Rect(0,0,0,0)}};return T.ao(t.sheet,"onDeactivateCellEditor",n),n.options.dom},T.prototype.XBb=function(t,e,o){this.deactivateEditor(t,e),this.Ofc(e,t,o)},T.prototype.i5=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w=o.labelOptions;if(w&&(r=n.sheet,i=o.watermark)){if(a=w.visibility,s=r.getText(n.row,n.col,n.sheetArea),1===a||(2===a||a===I)&&""===s)return;l=r.zoom(),c=(u=w.font)?yt.To.No(u,l):yt.To.No(o.font,1),h=lt(c.font),d=e,m=It(g=o,0),y=It(g,3,!0),b=It(g,2,!0),v=d.clone(),0===(C=g.labelOptions.alignment)||1===C||2===C?m<d.height&&(v.height=m-b+1):3!==C&&4!==C&&5!==C||(v.height=d.height-b),v.x+=y,v.width-=y+It(g,1,!0),f=v,p=void 0,D(o,e)&&(p=function(t,e,o,n){var r=new mt.Point(t.x,t.y),i=parseInt(o.fontSize,10),a=It(e,0),s=It(e,2),l=It(e,3,!0),u=It(e,1,!0),c=t.width,h=t.height,f=8<i?Math.floor((i-8)/5+2):1,p=8<i?1:2,d=n-(n/2-i/2+f-1)+It(e,0,!0),g=d+1,m=h<a+s?a+d:h-s+d-1;switch(e.labelOptions.alignment){case 0:r.x+=l+p+1,r.y+=g;break;case 1:r.x+=l+(c-l-u)/2,r.y+=g;break;case 2:r.x+=c-u-2,r.y+=g;break;case 3:r.x+=l+p+1,r.y+=m;break;case 4:r.x+=l+(c-l-u)/2,r.y+=m;break;case 5:r.x+=c-u-2,r.y+=m}return r}(e,o,c,h)),p&&(t.save(),t.textAlign=j(w.alignment),t.textBaseline="alphabetic",vt(t,c.font),t.fillStyle=w.foreColor||o.foreColor||"grey",t.rect(f.x,f.y,f.width,f.height),t.clip(),t.beginPath(),t.fillText(i,p.x,p.y),t.restore())}},T.prototype.f5=function(t,e,o){var n=t.clone(),r=It(e,0,!1,o),i=It(e,1,!1,o),a=It(e,2,!1,o),s=It(e,3,!1,o);return 0<r&&(n.y+=r,n.height-=r),0<a&&(n.height-=a),0<s&&(n.x+=s,n.width-=s),0<i&&(n.width-=i),i+s>=t.width&&(n.width=0),r+a>=t.height&&(n.height=0),n},T.prototype.Ama=function(t,e,o,n){var r;return r={ctx:t,options:{rect:e=this.f5(e,o,n.sheet.zoom()),context:n}},T.ao(n.sheet,"getCellPaddingRect",r),r.options.rect},T.prototype.e5=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A=o.labelOptions;A&&(i=(r=n.sheet).getText(n.row,n.col,n.sheetArea),a=o.watermark,1!==(s=A.visibility)&&a&&(l=A.font||o.font||r._render.Bl(),1!==r.zoom()&&(l=r._render.Cl(l)),u=lt(l),D(o,e)&&(m=e,b=It(y=o,3,!0),v=It(y,1,!0),C=It(y,0,!0),w=It(y,2,!0),x=m.clone(),T=y.labelOptions.alignment,x.x=b+1,x.width-=b+v,0===T||1===T||2===T?(x.y=C,x.height=It(y,0)-C-w):3!==T&&4!==T&&5!==T||(x.y=m.height-It(y,2)+C,x.height=It(y,2)-C-w),2!==T&&5!==T||(x.width-=2),c=x),c&&((h=S.GC$(mt.Ul.Nl("span"))).text(a),f=(2===s||s===I)&&""===i,p=c.height-u,d=c.y+(f&&0<p?p:0),h.css({display:"block",position:"absolute",left:c.x,top:d,width:c.width,height:c.height,font:M(l),color:A.foreColor||o.foreColor||"grey",textAlign:j(A.alignment),overflow:"hidden",whiteSpace:"nowrap"}).attr("gcUIElement","gcEditorLabel"),S.GC$(t).append(h),f&&(g=setInterval(function(){d--,h.css("top",d),d<=c.y&&clearInterval(g)},20)))))},T.prototype._createCellTypeElement=function(t){var e,o,n=mt.Ul.Nl("div");return n.style.cssText="position: absolute; margin: 0;padding: 0 ;overflow: hidden; box-sizing: content-box;resize: none;outline: none;border: 2px #5292f7 solid;box-shadow: 1px 2px 5px rgba(0,0,0,0.4);background-color: white",(e=mt.Ul.Nl("div")).style.cssText="position: absolute; outline: none; border: none",S.GC$(n).append(S.GC$(e)),(o=this.createEditorElement(t,n))&&S.GC$(e).append(S.GC$(o)),this.Mfc(t,n,t.sheet.getCellRect(t.row,t.col)),n},T.prototype._activateEditorWrapper=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p;t&&t.firstChild&&(r=this,E(t,e,i=Z(o),n),s=(a=r.Nfc(n,t,i,e)).options.contentRect,l=a.options.cellRect,u=a.options.leftExternalRect,c=a.options.rightExternalRect,r.e5&&r.e5(t,s,e,n),h=n.sheet.zoom(),f=x(s=r.f5?r.f5(s,e,h):s,u,c),p=t.firstChild,S.GC$(p).css({left:(+S.GC$(p).css("left").replace("px","")||0)+It(e,3,!1,h),top:(+S.GC$(p).css("top").replace("px","")||0)+It(e,0,!1,h)}),r.activateEditor(t.firstChild.firstChild,e,f,n,l,u,c))},T.prototype.updateEditorContainer=function(t,e,o,n,r,i,a){var s,l,u,c,h,f;t&&e&&(l=(s=t.parentNode)?s.parentNode:I)&&r&&(u=S.GC$(l),c=r.width,h=r.height,0<c&&(u.width(c),f=l.lastChild,o&&"gcEditorLabel"===f.getAttribute("gcUIElement")&&S.GC$(f).width(c-It(o,3,!0)-It(o,1,!0)-2)),0<h&&u.height(h),st(r.x)||u.css("left",r.x+"px"),st(r.y)||u.css("top",r.y+"px"))},T.prototype._updateEditorWrapper=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g=this,m=t.firstChild,y=Z(o);E(t,e,y,n),i=(r=g.VBb(n,m,y,e)).editorBounds,a=r.contentRect,s=r.leftExternalRect,l=r.rightExternalRect,u=m.firstChild,c=x(a=g.f5?g.f5(a,e,n.sheet.zoom()):a,s,l),h=g.updateEditor(u,e,c,n,i,s,l),f={width:s.width,height:s.height},p={width:l.width,height:l.height},d={width:!isNaN(h&&h.width)&&h.width+f.width+p.width>i.width?h.width+f.width+p.width:i.width,height:!isNaN(h&&h.height)&&h.height+f.height+p.height>i.height?h.height+f.height+p.height:i.height},g.updateEditorContainer(u,h,e,n,d,f,p)},T.prototype.h5=function(t,e,o,n,r){return this.getCellAndPaddingHitInfo(t,e,o,n,r)},T.prototype.X4=function(t,e,o,n,r){var i,a,s,l,u,c,h=(c={context:u=r,value:0,cellStyle:o},y.ao(u.sheet,"getCellButtonAutoWidth",c),c.value+(l={context:s=r,value:0},y.ao(s.sheet,"getOutlineColumnOffset",l),l.value)+(a={context:i=r,value:0,cellStyle:o},y.ao(i.sheet,"getSpecialIconsAutoWidth",a),a.value)),f=this.getAutoFitWidth(t,e,o,n,r);return 0<f&&(h+=f+It(o,3,!1)+It(o,1,!1)),h},T.prototype.Y4=function(t,e,o,n,r){var i,a,s=0,l=this.getAutoFitHeight(t,e,o,n,r);return 0<l&&(s+=l+It(o,0,!1)+It(o,2,!1)),Math.max((a={context:i=r,value:0,cellStyle:o},y.ao(i.sheet,"getCellButtonAutoHeight",a),a.value),s)},T.prototype.paintValue=function(t,e,o,n,r,i,a,s){var l,u,c,h={};s.quotePrefix=a.quotePrefix,(l=this.format(O(e),a.formatter||a._autoFormatter,h,s))&&(u=new mt.Rect(o,n,r,i),this.adjustRectForIconSet(a.hAlign,s.sheet,s.row,s.col,s.sheetArea,u,h.content&&this.hasInfilling(h.content)),o=u.x,r=u.width,c=this.Pfc(t,l,a,s,o,n,r,i),this.paintText(t,e,o,n,r,i,a,s,l,h,I,c.externals))},T.prototype.S_a=function(t,e,o){var n=0;return 0<t&&(n=8*t),e&&e.XQa(o)&&(n=0),n},T.prototype.T_a=function(t,e){return!!(!t||s(t,W)&&t===i||t&&t.formatString&&t.formatString()===i)||!(e&&(!isNaN(e)||"TRUE"===e.toUpperCase()||"FALSE"===e.toUpperCase())&&"@"!==t)},T.prototype.Qfc=function(t){var e,o=0;for(e=0;e<t.length;e++)o+=t[e].width;return o},T.prototype.Rfc=function(t){var e,o=0;for(e=0;e<t.length;e++)o+=t[e].height;return o},T.prototype.Sfc=function(t,e,o,n,r){var i={ctx:t,options:{rect:o,context:e,value:n,style:r}};T.ao(e.sheet,"beforePaintLabel",i)},T.prototype.Pfc=function(t,e,o,n,r,i,a,s){var l={ctx:t,text:e,rect:new mt.Rect(r,i,a,s),style:o,context:n,externals:{left:[],right:[]}};return T.ao(n.sheet,"beforePaintText",l),l},T.prototype.Tfc=function(t,e,o,n,r,i,a,s,l){var u={ctx:t,style:e,context:o,textRect:new mt.Rect(n,r,i,a),availRect:s};return T.ao(o.sheet,l,u),u},T.prototype.Ufc=function(t,e,o,n,r,i,a,s){return this.Tfc(t,e,o,n,r,i,a,s,"beforeFillTextArea")},T.prototype.Vfc=function(t,e,o,n,r,i,a,s){return this.Tfc(t,e,o,n,r,i,a,s,"afterFillTextArea")},T.prototype.paintText=function(t,e,o,n,r,i,a,s,l,u,c,h){var f,p,d;t.save(),t.beginPath(),f=a.textOrientation,p=a.textIndent&&0!==a.textIndent,d=a.isVerticalText,e&&e.richText&&0<e.richText.length||d?this.Fpb(t,e,o,n,r,i,a,s,l,u,c,h):0!==f&&!st(f)&&-90<=f&&f<=90&&!p&&!d?this.nHb(t,e,o,n,r,i,a,s,l,u,c,h):this.N$a(t,e,o,n,r,i,a,s,l,u,c,h),t.restore()},T.prototype.oHb=function(t,e,o,n,r,i,a,s,l,u){var c,h,f,p,d,g,m,y,b,v,C,w,x=e.sheet,T=e.row,A=e.col,S=r.vAlign,M=e.sheetArea;for(c=0;c<o.length;c++)if(h=o[c].text,f=n[c].lineHeight,p=1===S?0:s,d=this.pHb(t,"0"),g="",(m=i)-1-2-p<h.length*f){if(m<3*d)u.push(0),g=R;else if(y=Ct((m-1-2-3*d-(1===S?0:s))/f),(b=0)===S){for(v=0;v<y;v++)g+=h[v];C=g.length,3*d+((g+=R).length-3)*f+s>m-1-2?(g=g.substring(0,g.length-4)+R,u.push(g.split(R)[0].length)):u.push(C)}else if(1===S){for(w=0;w<N(y/2);w++)g+=h.charAt(w),b=w;for(C=g.length,g+=R,w=N(h.length-y/2);w<h.length;w++)g+=h.charAt(w);3*d+(g.length-3)*f+s>m-1-2?(g=g.replace(h[b],""),u.push(g.split(R)[0].length)):u.push(C),l[c].y=a+(i-(3*d+(g.length-3)*f))/2}else{for(u.push(0),v=h.length-1;v>=h.length-y;v--)g=h[v]+g;3*d+((g=R+g).length-3)*f+s>m-1-2&&(g=g.replace(h[h.length-y],"")),l[c].y=a+i-s-(3*d+(g.length-3)*f)-2}o[c].textInfos[0].text=g,x._modelManager.qHb(T,A,h,M)}else x._modelManager.qHb(T,A,null,M)},T.prototype.Fpb=function(t,e,o,n,r,i,a,s,l,u,c,h){var f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_=this,O=new mt.Rect(o,n,r,i),F=_.S_a(a.textIndent,s.sheet.outlineColumn,s.col),P=a.hAlign;if(3===P&&(P=bt(P,e,a.formatter)),p=!!(f=a.isVerticalText)&&ut(l),d=a.font,g=a.formatter||a._autoFormatter,m=_.T_a(g,e.text),y=z(!0,[],_.U_a(e,l,m,d,a.foreColor)),Mt(t,s.sheet,a,c),e&&e.richText&&0<e.richText.length&&(b=s.sheet?s.sheet.zoom():1,v=s.printZoomFactor,v=dt(s)?v:L,_.V_a(y,d,b,v)),w=C=0,h&&(C=_.Qfc(h.left),w=_.Qfc(h.right)),x=C+w,T={left:C,right:w},!a.wordWrap&&a.shrinkToFit&&_.W_a(y,r-x,i,a,d,1,f),A=_.X_a(t,l,a.font,f?i:r-x,F,f?a.vAlign:a.hAlign,a.wordWrap,f,y),S=_.Y_a(A,a,P,c),M=_.Z_a(t,a,o,n,r,i,a.wordWrap,s.cellOverflowLayout,P,F,f,A[0].textLength,S[0].lineHeight),I=!1,a.showEllipsis&&f&&!e.richText&&(I=!0),N=_.$_a(o,n,r,i,P,a.vAlign,F,f,p,A,S,T,I),R=A.length,k=[],I&&u&&(u.content&&1===u.content.length&&"text"===u.content[0].type||!u.content&&1===A.length&&A[0].text)&&this.oHb(t,s,A,S,a,i,n,F,N,k),1===R&&u&&!m)_.__a(t,s.sheet,l,u,N[0].x,N[0].y,r,i,P,a,M.width,M.height,F,f,A[0].textLength,s,T,O);else{for(E=_.Wfc(A),D=N[0].x,t.textAlign===ft?D-=E/2:t.textAlign===ht&&(D-=E),_.Ufc(t,a,s,D,N[0].y,E,0,O),j=0;j<R;j++)_.a0a(t,s.sheet,N[j].x,N[j].y,S[j],P,A[j],k[j]);_.Ufc(t,a,s,D,N[0].x,E,0,O)}},T.prototype.Wfc=function(t){var e,o=t[0].textLength;for(e=0;e<t.length;e++)o=St(o,t[e].textLength);return o},T.prototype.pHb=function(t,e){var o=0,n=t.font+e;return g[n]?o=g[n]:(o=ct(t,t.font,e),g[n]=o),o},T.prototype.rHb=function(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A=e&&e.content&&0<e.content.length,S=t.sheetArea;if(s=A?e.content[0].value:o,l=this.pHb(n,s),u=t.sheet,c=t.row,h=t.col,f=r,p=0,d=this.pHb(n,"0"),p=this.pHb(n,R),f-1-2-(1===i?0:a)<l){if(g="",2===i)for(m=s.length-1;0<=m;m--){if(f-1-2-a<p){y=g.length,g=R+g.substring(1,y);break}g=(b=s.charAt(m))+g,p+=this.pHb(n,b)}else if(1===i){for(v=N((f-p)/d),m=0;m<v/2;m++)g+=b=s.charAt(m);for(g+=R,m=Ct(s.length-v/2);m<s.length;m++)g+=b=s.charAt(m);for(C=this.pHb(n,g);f-1-2<C&&g!==R;)x=(w=g.split(R))[0],T=w[1],g=x.length>T.length?x.substring(0,x.length-1)+R+T:x+R+T.substring(1,T.length),C=this.pHb(n,g)}else for(m=0;m<s.length;m++){if(f-1-2-a<p){y=g.length,g=g.substring(0,y-1)+R;break}g+=b=s.charAt(m),p+=this.pHb(n,b)}A?e.content[0].value=g:e.content=[{value:g,type:"text"}],u._modelManager.qHb(c,h,s,S)}},T.prototype.N$a=function(t,e,o,n,r,i,a,s,l,u,c,h){var f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W=this,G=0,U=a.textIndent,J=a.wordWrap,Z=a.hAlign,q=a.vAlign,K=a.shrinkToFit,Y=a.textDecoration,Q="left",X=2,$=2,tt=a.font,et=0,ot=[],nt=0,rt=s.sheet,it=new mt.Rect(o,n,r,i);if(st(s.fontInfo)&&(s.fontInfo=yt.To.No(a.font,rt.zoom()),dt(s)&&(s.fontInfo=yt.To.No(s.fontInfo.font,s.printZoomFactor))),f=parseInt(s.fontInfo.fontSize,10),st(s.lineHeight)&&(s.lineHeight=lt(yt.To.No(a.font,rt.zoom()).font,!1,ut(l))),p=s.lineHeight,Mt(t,rt,a,c),0<U&&(G=8*U),rt.outlineColumn&&rt.outlineColumn.XQa(s.col)&&(G=0),3===Z&&(Z=bt(Z,e,a.formatter)),vt(t,tt),g=d=0,h&&(d=W.Qfc(h.left),g=W.Qfc(h.right)),m=d+g,y={left:d,right:g},!J&&K)for(v={value:!1},C=b=0;C<3&&!1===v.value&&(w=t.measureText(l).width,(b=St(0,r-4-(1===Z?0:G)-m))<w);C++)tt=yt.To.No(tt,b/w,v,!0).font,vt(t,tt);if(x=(x=rt.parent&&rt.parent.options.numbersFitMode===at.NumbersFitMode.overflow||!1)||(u&&u.content?!(!u.content||1!==u.content.length||"text"!==u.content[0].type):"string"==typeof e&&e===l),!J&&!K&&a.showEllipsis&&x&&this.rHb(s,u,l,t,r,Z,G),X+=G+d,1===Z?(X=(r+d-g)/2,Q=ft):2===Z&&(X=r-g-1-2,X-=G,Q=ht),t.textAlign!==Q&&(t.textAlign=Q),T=0,J&&(T=r-m-3-G,--T,1<(nt=(ot=mt.Vn.Wn(l,T,tt,!1,t)).length)&&0!==q&&(et=(nt-1)*p)),$+=p-(S=p/2-f/2+(A=8<f?Ct((f-8)/5+2):1)-1),1===q?$=(i-et)/2+p/2-S:2===q&&($=i-et-2-S),t.textBaseline!==pt&&(t.textBaseline=pt),N={x:(I=(M=s.cellOverflowLayout)&&M.layout)?I.x:o+1,y:I?I.y:n+1,width:I?I.width:r-2,height:I?I.height:i-2},R=I&&I.width>r,k=N.x,E=N.y,D=N.width,j=N.height,J)if(t.rect(k,E,D,j),t.clip(),t.beginPath(),_=n+$,1<nt){for(O=o+X,t.textAlign===ft?O-=T/2:t.textAlign===ht&&(O-=T),W.Ufc(t,a,s,O,_,T,p*nt,it),C=0;C<nt;C++)t.fillText(ot[C],o+X,_),Y&&(w=t.measureText(ot[C]).width,W.ip(t,Y,o+X,_,w,f,A)),_+=p;W.Ufc(t,a,s,O,_,T,p*nt,it)}else W.Oja(t,l,u,o+X,n+$,Z,D,G,Y,A,f,s,a,y,it,R);else P=D-(o+1-k)<(F=ct(t,t.font,l)+m)||j<p,L=It(a,0),H=It(a,1),B=It(a,2),V=It(a,3),P||(1===Z?M&&((z=F/2)>M.backgroundLeftWidth||z>M.backgroundRightWidth)&&(P=!0):(D<F+G+L+B||j<et+V+H)&&(P=!0)),P&&(t.rect(k,E,D,j),t.clip(),t.beginPath()),W.Oja(t,l,u,o+X,n+$,Z,D,G,Y,A,f,s,a,y,it,R)},T.prototype.nHb=function(t,e,o,n,r,i,a,s,l,u,c,h){var f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U=this,J=a.wordWrap,Z=a.hAlign,q=a.vAlign,K=a.shrinkToFit,Y=a.textDecoration,Q=2,X=2,$=a.font,tt=[],et=0,ot=parseInt(s.fontInfo.fontSize,10),nt=s.sheet,rt=new mt.Rect(o,n,r,i),it=s.cellOverflowLayout,at=it&&it.layout,st=a&&(a.borderLeft||a.borderTop||a.borderRight||a.borderBottom)&&!nt.getSpan(s.row,s.col),lt=a.textOrientation,ut=lt*Math.PI/180,ct=At(ut),ht=xt(ct),ft=wt(ct),pt=Tt(ct),dt=s.lineHeight,gt=90===lt||-90===lt;if(st&&(-90<lt&&lt<0&&(d=!1),0<lt&&lt<90&&(d=!0)),m=(g={x:at?at.x:o+1,y:at?at.y:n+1,width:at?at.width:r-2,height:at?at.height:i-2}).x,y=g.y,b=g.width,v=g.height,C=dt/2*wt(ct),w=dt/2*xt(ct),T=dt/2-ot/2+(x=8<ot?Ct((ot-8)/5+2):1)-1,u&&u.content&&0<u.content.length&&!K&&(l=U.sHb(t,u.content,i-4,$)),A=nt.dp(l,$),Mt(t,nt,a,c),3===Z&&(Z=bt(Z,e,a.formatter,lt)),vt(t,$),M=S=0,h&&(S=U.Qfc(h.left),M=U.Qfc(h.right)),!J&&K)for(N={value:!1},R=I=0;R<3&&!1===N.value&&(I=St(0,(i-4-2*w)/ft))<A;R++)$=yt.To.No($,I/A,N,!0).font,vt(t,$),ot=parseInt(s.fontInfo.fontSize,10),A=nt.dp(l,$),C=(dt=mt.Ul.fp($))/2*wt(ct),w=dt/2*xt(ct);if(E=k=0,J)for(E=(i-4-2*w)/ft,et=(tt=mt.Vn.Wn(l,E,$,!1,t)).length,A=nt.dp(tt[0],$),D=0;D<et;D++)k<(j=nt.dp(tt[D],$))&&(k=j);switch(i<=(J?k:A)*ft+2*w&&(q=2),f=A/2*ht,p=(J?k:A)/2*ft,""+Z+q){case"00":Q+=f+C+S,X+=p,gt||(X+=w),st&&(Q=(i-X)/pt*(d?1:-1)+(dt/2+2)/ft);break;case"01":Q+=f+C+S,X=i/2,st&&(Q=(i-X)/pt*(d?1:-1)+(dt/2+2)/ft);break;case"02":Q+=f+C+S,X+=p,gt||(X+=w),st&&(Q=X/pt*(d?1:-1)+(dt/2+2)/ft),X=i-X;break;case"10":Q=(r+S-M)/2,X+=p,gt||(X+=w),st&&(Q+=(d?1:-1)*(i-X)/pt);break;case"11":Q=(r+S-M)/2,X=i/2,st&&(Q+=(d?1:-1)*(i-X)/pt);break;case"12":Q=(r+S-M)/2,X+=p,gt||(X+=w),st&&(Q+=(d?1:-1)*X/pt),X=i-X;break;case"20":Q=r-2-f-C-M,X+=p,gt||(X+=w),st&&(Q=r+(i-X)/pt*(d?1:-1)-(dt/2+2)/ft);break;case"21":Q=r-2-f-C-M,X=i/2,st&&(Q=r+(i-X)/pt*(d?1:-1)-(dt/2+2)/ft);break;case"22":Q=r-2-f-C-M,X+=p,gt||(X+=w),st&&(Q=r+X/pt*(d?1:-1)-(dt/2+2)/ft),X=i-X}if(J)if(_=o+Q,O=dt/ft,F=void 0,1<et){for(1===Z&&(_-=et%2!=0?O*(et-1)/2:et/2*O-.5*O),L=(P=Nt(_,n+X,A,ut,dt)).width+O*(et-1),H=P.height,B=2===Z?P.x-O*(et-1):P.x+O*(et-1),V=P.y,U.Ufc(t,a,s,B,V,L,H,rt),R=0;R<et;R++)F=R,(0<a.textOrientation&&2===Z||a.textOrientation<0&&(0===Z||1===Z))&&(F=et-R-1),U.tHb(t,ut,tt[F],_,n+X,Y,ot,x,T),_=2===Z?_-O:_+O;U.Ufc(t,a,s,B,V,L,H,rt)}else U.Xfc(t,l,o,n,Q,X,s,a,A,ut,Y,ot,x,dt,T,rt);else z=A*ft+ot*ft+2,W=It(a,0),G=It(a,2),(v-(n+1-y)<z||v<dt||v<z+W+G)&&(t.rect(m,y,b,v),t.clip()),U.Xfc(t,l,o,n,Q,X,s,a,A,ut,Y,ot,x,dt,T,rt)},T.prototype.Xfc=function(t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g){var m=Nt(o,n,l,u,p),y=m.width,b=m.height,v=m.x,C=m.y;this.Ufc(t,s,a,v,C,y,b,g),this.tHb(t,u,e,o+r,n+i,c,h,f,d),this.Ufc(t,s,a,v,C,y,b,g)},T.prototype.V_a=function(t,e,o,n){q(t,e,o,n)},T.prototype.W_a=function(t,e,o,n,r,i,a){var s,l,u,c=0,h={value:!1};for(s=0;s<3&&!1===h.value&&(l=U(t,r,i,a),c=St(0,(a?o:e)-4),(a?n.vAlign:1!==n.hAlign&&n.textIndent)&&(c=St(0,c-8*n.textIndent)),c<l);s++)for(u=0;u<t.length;u++)t[u].style.font=yt.To.No(t[u].style.font,c/l,h,!0).font},T.prototype.U_a=function(t,e,o,n,r){var i=t.richText;return!st(i)&&o||(i=[{style:{font:n,foreColor:r},text:e}]),i},T.prototype.Z_a=function(t,e,o,n,r,i,a,s,l,u,c,h,f){var p=s&&s.layout,d={x:p?p.x:o+1,y:p?p.y:n+1,width:p?p.width:r-2,height:p?p.height:i-2},g=d.x,m=d.y,y=d.width,b=d.height;return(a||this.b0a(e,l,e.vAlign,o,n,b,y,g,m,h,f,u,c,s))&&(t.rect(g,m,y,b),t.clip(),t.beginPath()),d},T.prototype.b0a=function(t,e,o,n,r,i,a,s,l,u,c,h,f,p){var d,g,m=It(t,0),y=It(t,1),b=It(t,2),v=It(t,3);return f?(!(d=i-(r+1-l)<u||a<c)&&1!==o&&i<u+h+m+b||a<c+v+y)&&(d=!0):(d=a-(n+1-s)<u||i<c)||(1===e?p&&((g=u/2)>p.backgroundLeftWidth||g>p.backgroundRightWidth)&&(d=!0):(a<u+h+v+y||i<c+m+b)&&(d=!0)),d},T.prototype.X_a=function(t,e,o,n,r,i,a,s,l){var u,c,h,f,p;if(1!==i?n=n-3-r:n-=3,a)return mt.Vn.M_a(e,n,o,l,s,t);for(c=u=0;c<l.length;c++)h=l[c].text,s?u+=lt(l[c].style.font)*(h?h.length:0):(f=yt.To.No(l[c].style.font,1),p=l[c].style.vertAlign?f.fontSize*d+"px "+f.fontFamily:l[c].style.font,u+=ct(t,p,h));return[{textLength:u,text:e,textInfos:l}]},T.prototype.__a=function(t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y){var b,v=u.font,C=yt.To.No(v,1).fontSize,w=8<C?Ct((C-8)/5+2):1;this.L$a(t,e,u),p?this.c0a(t,o,n,u,r,i,h,f,h,g,m,y):(b=a<c,this.Oja(t,o,n,r,i,l,c,f,u.textDecoration,w,C,g,u,m,y,b,d))},T.prototype.c0a=function(t,e,o,n,r,i,a,s,l,u,c,h){var f,p,d,g=o.content,m=i;if(this.Ufc(t,n,u,r,m,l,l*e.length,h),g&&0<g.length)for(p=0<(p=a-s-_(t,g,!0)-2)?p:0,f=0;f<g.length;f++)"fillingChar"===g[f].type?(d=J(t,p,g[f].value,!0),this.vWa(t,d,r,i),i+=p):"placeholder"===g[f].type?i+=g[f].value?g[f].value.length*l:0:"numberPlaceholder"===g[f].type?i+=l:(this.vWa(t,g[f].value,r,i),i+=g[f].value?g[f].value.length*l:0);else if(e)for(f=0;f<e.length;f++)i=this.vWa(t,e[f],r,i,l).y;this.Vfc(t,n,u,r,m,l,i-m,h)},T.prototype.d0a=function(t){var e=C;return 1===t?e=ft:2===t&&(e=ht),e},T.prototype.a0a=function(t,e,o,n,r,i,a,s){var l,u,c=[],h=a.textInfos;for(l=0;l<h.length;l++)c.push(z(!0,{},r,h[l].style));for(l=0;l<h.length;l++)o=(u=this.f0a(t,e,o,n,c[l],h[l].text,s)).x,n=u.y},T.prototype.Y_a=function(t,e,o,n){var r,i,a=[],s=t.length;for(r=0;r<s;r++)i=this.g0a(e,o,n,t[r].textInfos),a.push(i);return a},T.prototype.g0a=function(t,e,o,n){var r,i,a,s=0,l=0;for(r=0;r<n.length;r++)i=n[r].style&&n[r].style.font?n[r].style.font:t.font,s=Math.max(lt(i,I,ut(n[r].text)),s),l=Math.max(yt.To.No(i,1).fontSize,l),(n[r].style&&1===n[r].style.vertAlign||2===n[r].style.vertAlign)&&(s=Math.max(lt(i,I,ut(n[r].text))+2*yt.To.No(i,d).fontSize*.218,s));return{lineHeight:s,fontSize:l,baselineOffset:a=8<l?Ct((l-8)/5+2):1,lineOffset:s/2-l/2+a-1,font:t.font,foreColor:t.foreColor,textDecoration:t.textDecoration,isVerticalText:t.isVerticalText,textAlign:this.d0a(e),textBaseline:pt,opacity:o}},T.prototype.h0a=function(t,e,o){var n,r=0,i=0;for(n=0;n<t.length;n++)i+=e[n].lineHeight,r=Math.max(t[n].textLength,r);return{width:o?i:r,height:o?r:i}},T.prototype.$_a=function(t,e,o,n,r,i,a,s,l,u,c,h,f){var p,d=this.h0a(u,c,s),g=d.height,m=d.width,y=[];if(s)for(p=0;p<u.length;p++)y.push(this.i0a(t,e,o,n,r,i,a,m,u[p].textLength,c[p].lineHeight,c[p].lineOffset,l,h,u[p],f)),l?t-=c[p].lineHeight:t+=c[p].lineHeight;else for(p=0;p<u.length;p++)y.push(this.j0a(t,e,o,n,r,i,a,u[p].textLength,g,c[p].lineHeight,c[p].lineOffset,h)),e+=c[p].lineHeight;return y},T.prototype.j0a=function(t,e,o,n,r,i,a,s,l,u,c,h){var f=0,p=h.left,d=h.right;return 1===r?f=(o-s+p-d)/2:2===r?(f=o-1-2-s-d,f-=a):f=2+a+p,{x:t+f,y:e+(1===i?(n-l)/2+u-c:2===i?n-l-2+u-c:2+u-c)}},T.prototype.i0a=function(t,e,o,n,r,i,a,s,l,u,c,h,f,p,d){var g=0,m=f.left,y=f.right;return h?0===r?g=2+s+y-u/2:1===r?g=(o-m+y+s)/2-u/2:2===r&&(g=o-m-1-2-u/2):1===r?g=(o-s+m-y)/2+u/2:2===r?g=o-1-2-y-s+u/2:0===r&&(g=2+m+u/2),{x:t+g,y:e+(1===i?(n-l)/2:2===i?n-a-l-2:2+a)}},T.prototype.f0a=function(t,e,o,n,r,i,a){var s,l;return t.save(),this.L$a(t,e,r),s=r.vertAlign,l=r.isVerticalText?this.vWa(t,i,o,n,r.textDecoration,r.baselineOffset,a):this.k0a(t,o,n,r,i,s),t.restore(),l},T.prototype.L$a=function(t,e,o){Mt(t,e,o);var n=o.vertAlign?this.l0a(o.font):o.font;st(o.textBaseline)||t.textBaseline===o.textBaseline?st(t.textBaseline)&&t.textBaseline!==pt&&(t.textBaseline=pt):t.textBaseline=o.textBaseline,o.isVerticalText?t.textAlign!==ft&&(t.textAlign=ft):t.textAlign!==C&&(t.textAlign=C),vt(t,n)},T.prototype.l0a=function(t){var e=yt.To.Ko(t),o=parseFloat(e.fontSize)*d;return e.fontSize=o+"px",this.m0a(e)},T.prototype.m0a=function(t){var e="",o=t.fontStyle,n=t.fontSize,r=t.fontWeight,i=t.fontFamily;return e=void 0!==o?o:"normal",e+=void 0!==r?(e?" ":"")+r:(e?" ":"")+"normal",(e+=(e?" ":"")+n)+(void 0!==i?(e?" ":"")+i:(e?" ":"")+"Calibri")},T.prototype.vWa=function(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m,y,b;if(e&&0<e.length)for(s=t.font,l=lt(s,I,ut(e)),b=yt.To.No(s,1).fontSize,u=l/2-b/2+(8<b?Ct((b-8)/5+2):1)-1,h=(c=this.pHb(t,"0"))/2,f=0;f<e.length;f++)m=e[f],p=(y=v[m.charCodeAt(0)])?String.fromCharCode(y):m,n=n+((d=void 0!==a&&a<=f&&f<=a+2&&(a+3===e.length||0===a&&a+3<e.length||0!==a&&a+3<e.length))?c:l)-(g=d?h:u),t.fillText(p,o,n),this.Mxb(t,r,o,n,ct(t,t.font,p),yt.To.No(t.font,1).fontSize,i),n+=g;return{x:o,y:n}},T.prototype.Mxb=function(t,e,o,n,r,i,a){var s,l,u,c;t.strokeStyle!==t.fillStyle&&(t.strokeStyle=t.fillStyle),s=0,u=.5,l=Ct(((i<=12?12:i)-12)/21+1),t.lineWidth!==l&&(t.lineWidth=l),0==(1&l)&&(u=0),(c=t.textAlign)===ft?o-=r/2:c===ht&&(o-=r),t.beginPath(),2==(2&e)&&(s=N(n+a-i/2)-u,t.moveTo(o,s),t.lineTo(o+r,s)),t.stroke()},T.prototype.k0a=function(t,e,o,n,r,i){var a,s,l,u,c;return st(r)?{x:e,y:o}:(s=8<(a=yt.To.No(t.font,1).fontSize)?Ct((a-8)/5+2):1,l=0,i?(l=1===i?.74*a:.28*-a,t.fillText(r,e,o-l)):t.fillText(r,e,o),u=ct(t,t.font,r),c=n.textDecoration,this.ip(t,c,e,o,u,a,s-l),{x:e+u,y:o})},T.prototype.jp=function(t,e,o,n,r,i,a,s){var l={row:s.row,col:s.col,sheet:s.sheet,sheetArea:s.sheetArea,style:a,underline:a.textDecoration,foreColor:a.foreColor};T.ao(s.sheet,"applyHyperlinkStyle",l),this.paint(t,e,o,n,r,i,a,s)},T.prototype.paint=function(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_;t&&(l=a.backColor,s.parentBackColor!==l&&(h=t,f=o,p=n,d=r,g=i,m=s.imageLoader,b=e,v=s,T=(y=a).backColor,A=y.backgroundImage,S=y.textOrientation,M=y.isVerticalText,I=y.textIndent&&0!==y.textIndent,N=y.backgroundImageLayout,R=v.row,k=v.col,E=v.sheet&&v.sheet.getSpan(R,k),D=y&&(y.borderLeft||y.borderTop||y.borderRight||y.borderBottom),j=0,_=f,h.save(),x=S&&0!==S&&D&&b&&!E&&!M&&!I?(C=At(S*Math.PI/180),w=Tt(C),j=Ct(g/w),-90<S&&S<0&&(_=f-j),0<S&&S<90&&(_=f+j),function(){h.beginPath(),h.moveTo(_,p),h.lineTo(_+d,p),h.lineTo(f+d,p+g),h.lineTo(f,p+g),h.fill()}):function(){h.fillRect(f,p,d,g)},(T||A)&&(T&&yt.To.setFillStyle(h,T,Math.min(_,f),p,d+j,g,x),P.ap(h,f,p,d,g,A,N,m)),h.restore()),u=this,c=new mt.Rect(o,n,r,i),u.Sfc(t,s,c,e,a),u.i5&&(u.i5(t,c,a,s),c=u.f5(c,a,s.sheet.zoom())),s.cellOverflowLayout||u.uxb(t,c,s,O(e)),0<c.width&&0<c.height&&(a&&a.showEllipsis&&s.sheet._modelManager.qHb(s.row,s.col,null,s.sheetArea),u.paintContent(t,e,c.x,c.y,c.width,c.height,a,s)))},T.prototype.paintContent=function(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d,g,m=s.sheetArea;2!==m&&1!==m||(l=s.visualState||0,u="columnHeader",2===m&&(u="rowHeader"),c=this.getThemeStyle(s.visualState,"gc-"+u+"-"+mt.Im.Jm(l)),P.gp(t,o,n,r,i,a,u,c,m)),(f=s.conditionalFormats)&&(h=f.jp(t,O(e),o,n,r,i,a,s)),s.showBarIconOnly=h,(p=s.sparkline)&&p.paintSparkline(t,o,n,r,i),d=P.bDc(t,O(e),o,n,r,i,s),s.cellOverflowLayout||h||d||(g=new mt.Rect(o,n,r,i),this.paintValue(t,e,g.x,g.y,g.width,g.height,a,s))},T.prototype.adjustRectForIconSet=function(t,e,o,n,r,i,a){!function(t,e,o,n,r,i,a){if((0===t||a)&&H(e,o,n,r)){var s=B(e);i.x+=s,i.width-=s}}(t,e,o,n,r,i,a)},T.prototype.hasInfilling=function(t){for(var e=0;e<t.length;e++)if("fillingChar"===t[e].type)return!0;return!1},T.prototype.createEditorElement=function(t,e){return L},T.prototype.getEditorValue=function(t,e){return L},T.prototype.kp=function(t,e,o,n){return o},T.prototype.setEditorValue=function(t,e,o){},T.prototype.getEditingElement=function(){return L},T.prototype.parse=function(t,e,o){var n,r=st(e),i=st(t);try{if(n=l.Formatter&&l.Formatter.GeneralFormatter,!r&&!i&&n)return(typeof e===W?new n(e):e).parse(t)}catch(t){}return i?"":""+t},T.prototype.format=function(t,e,o,n){var r,i,a,s=p(e);if(n&&s&&(r=n.sheet.aHb(n.row,n.col,e),st(r)||(t=r)),st(t)||""===t)return"";if(n&&n.quotePrefix&&typeof t===W)return""+t;if(!s&&typeof e===W&&"object"!=typeof t)return mt.mn.un(t,e,o);if(!e||"General"===e||s)return"boolean"==typeof t||t instanceof Boolean?(u&&(t=t?u.getBoolean().boolean_true:u.getBoolean().boolean_false),(""+t).toUpperCase()):t instanceof Date?(a=(i=c.q4(c.culture()).DateTimeFormat).shortDatePattern,0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds()||(a=i.defaultDatePattern),f.Vb(t,a)):(typeof t===A&&(t=h.nb(""+t)),""+t);try{return l.Formatter&&l.Formatter.GeneralFormatter?(typeof e===W?mt.mn.tn(e):e).format(t,o):""+t}catch(e){return""+t}},T.prototype.focus=function(t,e){t&&t.focus&&t.focus()},T.prototype.getThemeStyle=function(t,e){return mt.Im.Km(t,e)},T.prototype.activateEditor=function(t,e,o,n,r,i,a){},T.prototype.deactivateEditor=function(t,e){},T.prototype.selectAll=function(t,e){t&&t.select&&t.select()},T.prototype.updateEditor=function(t,e,o,n,r,i,a){},T.prototype.setImeMode=function(t,e,o){this.isImeAware(o)?this.updateImeMode(t,e,o):t&&P.hp(t,0)},T.prototype.updateImeMode=function(t,e,o){t&&P.hp(t,e)},T.prototype.getHitInfo=function(t,e,o,n,r){return L},T.prototype.getCellAndPaddingHitInfo=function(t,e,o,n,r){var i,a;if(r){if(i={x:t,y:e,context:r,cellStyle:o,cellRect:n,paddingHitInfo:null},T.ao(r.sheet,"getCellButtonHitInfo",i,function(){return null!==i.paddingHitInfo&&void 0!==i.paddingHitInfo}),a=i.paddingHitInfo,i.paddingHitInfo&&!st(i.paddingHitInfo.cellButtonHitInfo)&&!st(i.paddingHitInfo.cellButtonHitInfo.buttonConfig))return i.paddingHitInfo;if(i.cellRect=this.f5?this.f5(i.cellRect,o,r.sheet.zoom()):i.cellRect,T.ao(r.sheet,"getCellTextHitInfo",i,function(){return!st(i.paddingHitInfo)&&i.paddingHitInfo.isReservedLocation}),i.paddingHitInfo&&i.paddingHitInfo.isReservedLocation)return i.paddingHitInfo;if(3===r.sheetArea)return T.ao(r.sheet,"getCellPaddingHitInfo",i,function(){return!st(i.paddingHitInfo)&&i.paddingHitInfo.isReservedLocation}),i.paddingHitInfo?i.paddingHitInfo:a||this.getHitInfo(t,e,o,n,r)}return this.getHitInfo(t,e,o,n,r)},T.prototype.processCellAndPaddingMouseDown=function(t){return T.ao(t.sheet,"processMouseDownOnCellPadding",t),this.processMouseDown(t)},T.prototype.processMouseDown=function(t){return!1},T.prototype.YBb=function(t){return T.ao(t.sheet,"processMouseMoveOnCellPadding",t),this.processMouseMove(t)},T.prototype.processMouseMove=function(t){return!1},T.prototype.XGb=function(t){return T.ao(t.sheet,"processMouseUpOnCellPadding",t),this.processMouseUp(t)},T.prototype.processMouseUp=function(t){return!1},T.prototype.processMouseEnter=function(t){return!1},T.prototype.ZBb=function(t){return T.ao(t.sheet,"processMouseLeaveOnCellPadding",t),this.processMouseLeave(t)},T.prototype.processMouseLeave=function(t){return!1},T.prototype.isReservedKey=function(t,e){return!1},T.prototype.isEditingValueChanged=function(t,e,o){return o.klb&&(t=t.replace(/\r\n?/g,"\n")),t===L&&(t=I),e===L&&(e=I),t!==e},T.prototype.processCompositionStart=function(t,e){return!1},T.prototype.processKeyDown=function(t,e){return!1},T.prototype.processKeyUp=function(t,e){return!1},T.prototype.getAutoFitWidth=function(t,e,o,n,r){return P.cp(t,e,o,n,r)},T.prototype.getAutoFitHeight=function(t,e,o,n,r){return P.ep(t,e,o,n,r)},T.prototype.Oja=function(t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y){var b;o&&o.content&&0<o.content.length&&(y||!g)?this.Pja(t,o.content,n,r,i,a,s,l,u,c,h,f,p,d,m):(m=m||ct(t,t.font,e),b=n,t.textAlign===ft?b-=m/2:t.textAlign===ht&&(b-=m),this.Ufc(t,f,h,b,r,m,h.lineHeight,d),t.fillText(e,n,r),l&&this.ip(t,l,n,r,m,c,u),this.Vfc(t,f,h,b,r,m,h.lineHeight,d))},T.prototype.tHb=function(t,e,o,n,r,i,a,s,l){if(t.save(),t.textAlign="center",t.textBaseline="middle",t.translate(n,r),t.rotate(-e),t.fillText(o,0,0),i){var u=t.measureText(o).width;this.ip(t,i,0,l,u,a,s)}t.restore()},T.prototype.sHb=function(t,e,o,n){var r,i,a;for(t.font||vt(t,n),r=0<(r=o-_(t,e))?r:0,i=[],a=0;a<e.length;a++)if("fillingChar"===e[a].type)i.push(J(t,r,e[a].value));else{if("placeholder"===e[a].type||"numberPlaceholder"===e[a].type)continue;i.push(e[a].value)}return i.join("")},T.prototype.Pja=function(t,e,o,n,r,i,a,s,l,u,c,h,f,p,d){var g,m,y,b,v;t.save(),t.textAlign!==C&&(t.textAlign=C),b=0<(b=i-a-(g=_(t,e))-((m=f?f.left:0)+(y=f?f.right:0))-2)?b:0,st(d)?this.hasInfilling(e)?1===r?(o-=(i+m-y)/2,o+=a+m):2===r&&(o=o-i+y+2,o+=a+m):st(g)||(1===r?o-=g/2:2===r&&(o-=g)):this.hasInfilling(e)?1===r?(o=o+(d||g)/2-(i+m-y)/2,o+=a+m):2===r&&(o=o+(d||g)-i+y+2,o+=a+m):st(g)||(1===r?o=o+d/2-g/2:2===r&&(o=o+d-g)),this.Ufc(t,h,c,o,n,g,c.lineHeight,p),v=this.Qja(t,e,o,n,b,s,l,u),this.Vfc(t,h,c,o,n,v-o,c.lineHeight,p),t.restore()},T.prototype.Qja=function(t,e,o,n,r,i,a,s,l){var u,c,h,f=0;for(g[t.font+"0"]?f=g[t.font+"0"]:(f=ct(t,t.font,"0"),g[t.font+"0"]=f),u=0;u<e.length;u++)"fillingChar"===e[u].type?(t.fillText(J(t,r,e[u].value),o,n),i&&this.ip(t,i,o,n,r,s,a),o+=r):"placeholder"===e[u].type?o+=ct(t,t.font,e[u].value):"numberPlaceholder"===e[u].type?o+=f:((c=e[u].value)!==L&&t.fillText(c,o,n),h=ct(t,t.font,c),i&&this.ip(t,i,o,n,h,s,a),o+=h);return o},T.prototype.ip=function(t,e,o,n,r,i,a){var s,l,u,c;t.strokeStyle!==t.fillStyle&&(t.strokeStyle=t.fillStyle),s=t.textAlign,l=0,c=.5,u=Ct(((i<=12?12:i)-12)/21+1),t.lineWidth!==u&&(t.lineWidth=u),0==(1&u)&&(c=0),s===ft?o-=r/2:s===ht&&(o-=r),t.beginPath(),4==(4&e)&&(l=N(n+a-i-1)-c,t.moveTo(o,l),t.lineTo(o+r,l)),2==(2&e)&&(l=N(n+a-i/2)-c,t.moveTo(o,l),t.lineTo(o+r,l)),1==(1&e)&&(l=N(n+a-1)-c,t.moveTo(o,l),t.lineTo(o+r,l)),8==(8&e)&&(l=N(n+a-1)-c,t.moveTo(o,l-u),t.lineTo(o+r,l-u),t.moveTo(o,l+u),t.lineTo(o+r,l+u)),t.stroke()},T.prototype.lp=function(t,e){var o="";4==(4&e)&&(o="overline"),2==(2&e)&&(o+=" line-through"),1==(1&e)&&(o+=" underline"),t.css("text-decoration",o)},T.prototype.gQa=function(){return L},T.prototype.isImeAware=function(t){return!1},T.prototype.isEditting=function(){return!1},T.prototype.lJc=function(t){},T.prototype.toJSON=function(){var t,e={};for(t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},T.prototype.fromJSON=function(t){if(t)for(var e in t)st(t[e])||(this[e]=t[e])},y=T,e.Base=y,mt.Zn(y),n._o[0]=y},"./dist/core/celltype/cellType.entry.js":function(t,o,e){"use strict";function n(t){for(var e in t)o.hasOwnProperty(e)||(o[e]=t[e])}Object.defineProperty(o,"__esModule",{value:!0}),n(e("./dist/core/celltype/celltype.ns.js")),n(e("./dist/core/celltype/basecelltype.js")),n(e("./dist/core/celltype/textcelltype.js")),n(e("./dist/core/celltype/headercelltype.js"))},"./dist/core/celltype/celltype.ns.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e._o={}},"./dist/core/celltype/headercelltype.js":function(t,e,o){"use strict";var n,r,y,q,i,T,A,S,K,M,L,Y,I,H,B,N,V,Q,X,a,s,l,u,c,h,f,p=this&&this.__extends||(u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function g(t,e){return t=t||0,S.Km(t,"gc-"+e+"-"+S.Jm(t))}function R(t,e,o,n,r,i){var a=new Image,s=i;s=(s=s.replace('url("',"")).replace('")',""),a.src=s,t.drawImage(a,e,o,n,r)}function d(t,e,o,n,r,i,a,s,l,u,c,h){var f,p,d;e&&(function(t,e,o,n,r,i,a,s,l){var u,c,h,f,p,d,g,m,y,b,v,C,w;function x(){t.fillRect(e+1,o+1,n-1,r-1)}if(!I(s)){if(t.save(),t.beginPath(),u=i.backColor,0===s&&u)q.To.setFillStyle(t,u,e,o,n,r,x);else try{if(u=l&&l.backgroundColor,c=l&&l.backgroundImage,h=a.sheet,f=a.row,p=a.col,d=a.sheetArea,g=void 0,m=!1,h.cellStates&&s===A.VisualState.hover&&((g=h.cellStates.getStyle(f,p,d))&&g.backColor&&(u=g.backColor,m=!0)),!m&&c&&-1!==c.indexOf("linear-gradient")){for(y=M(c),b={degree:90,stops:[]},v=0,C=y.length;v<C;v++)w=y[v],b.stops.push({position:w.point,color:w.color});q.To.setFillStyle_Gradient(t,b,e,o,n,r,x)}else u?(t.fillStyle=u,x()):c&&c!==N&&R(t,e+1,o+1,n-1,r-1,c)}catch(t){}T.Context.ap(t,e,o,n,r,i.backgroundImage,i.backgroundImageLayout,a.imageLoader),t.restore()}}(e,n,r,i,a,s,l,f=l.visualState||0,p=g(f,u)),T.Context.gp(e,n,r,i,a,s,u,p,c,l.needTopGridline,l.needLeftGridline),d=new y.Rect(n,r,i,a),t.Sfc(e,l,d,o,s),t.i5&&(t.i5(e,d,s,l),d=t.f5(d,s,l.sheet.zoom())),0<d.width&&0<d.height&&t.paintContent(e,o,d.x,d.y,d.width,d.height,s,l,h))}function $(t,e,o,n,r,i){var a,s={font:e,fillStyle:o},l=n.sheet;return 0!==n.visualState&&2007<parseInt(i.zIndex,10)&&l.vp(n.row,n.col,r)&&(a=l.wp(n.row,n.col,r)?t(n.visualState,"gc-columnHeader-selected"):t(n.visualState,"gc-columnHeader-highlight"),s.fillStyle=a.color,s.font=q.To.Ro(s.font,"bold")),s}function m(t,e,o,n,r,i,a,s,l,u,c,h){var f,p,d={},g=t.format(H(o),s.formatter,d),m=l.sheet;g&&(e.save(),e.beginPath(),((f=m.rowFilter&&m.rowFilter())&&f.Dl(l.row,l.col,u)&&f.filterButtonVisible(l.col)||h)&&(i-=m.oK(new y.Rect(n,r,i,a),u).width),(p=(p=s.foreColor)||c.color)&&e.fillStyle!==p&&(e.fillStyle=p),o&&o.richText&&0<o.richText.length||s.isVerticalText?function(t,e,o,n,r,i,a,s,l,u,c,h,f,p){var d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E=new X(r,i,a,s),D=$(t.getThemeStyle,l.font||o.font,o.fillStyle,h,f,p),j=l.isVerticalText,_=l.hAlign,O=function(t){var e=0,o=t.textIndent;return 0<o&&(e=8*o),e}(l),F=t.T_a(l.formatter||l._autoFormatter,n.text),P=B(!0,[],t.U_a(n,u,F,D.font,D.fillStyle));if(n&&n.richText&&0<n.richText.length&&(d=h.sheet?h.sheet.zoom():1,g=h.printZoomFactor,g=h.isPrinting&&"number"==typeof g&&1!==g?g:V,t.V_a(P,D,d,g)),m=t.Pfc(o,H(n),l,h,r,i,a,s),y=t.Qfc(m.externals.left),b=t.Qfc(m.externals.right),v=y+b,C={left:y,right:b},!l.wordWrap&&l.shrinkToFit&&t.W_a(P,a-v,s,l,D,1,j),w=t.X_a(o,u,l.font,j?s:a-v,O,j?l.vAlign:l.hAlign,l.wordWrap,j,P),x=t.Y_a(w,l,_),function(t,e,o,n,r,i,a,s,l){(!!e.wordWrap||(e.isVerticalText?i<s+a||r<l:r<s+a||i<l))&&(t.rect(o,n,r,i),t.clip(),t.beginPath())}(o,l,r,i,a,s,O,w[0].textLength,x[0].lineHeight),T=j?L(u):V,A=!1,l.wordWrap||l.shrinkToFit||!l.showEllipsis||!j||n.richText||(A=!0),S=t.$_a(E.x,E.y,E.width,E.height,_,l.vAlign,O,j,T,w,x,C,A),M=[],A&&c&&(c.content&&1===c.content.length&&"text"===c.content[0].type||!c.content&&1===w.length&&w[0].text)&&t.oHb(o,h,w,x,l,s,i,O,S,M),1===(I=w.length)&&c.content&&!F)t.__a(o,e,u,c,S[0].x,S[0].y,a,s,_,l,E.width,E.height,O,j,w[0].textLength,h,C,E);else for(N=0;N<I;N++)R=t.Wfc(w),k=S[0].x,"center"===o.textAlign?k-=R/2:"right"===o.textAlign&&(k-=R),t.Ufc(o,l,h,k,S[0].y,R,0,E),t.a0a(o,e,S[N].x,S[N].y,x[N],_,w[N],M[N]),t.Ufc(o,l,h,k,S[0].x,R,0,E)}(t,m,e,o,n,r,i,a,s,g,d,l,u,c):function(t,e,o,n,r,i,a,s,l,u,c,h){var f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J=new X(o,n,r,i),Z=$(t.getThemeStyle,a.font||e.font,e.fillStyle,u,c,h);if(Y(e,Z.font),e.fillStyle=Z.fillStyle,f=0,0<(p=a.textIndent)&&(f=8*p),d=parseInt(u.fontInfo.fontSize,10),g=a.hAlign,m=a.vAlign,y="left",b=2,v=t.Pfc(e,s,a,u,o,n,r,i),C=t.Qfc(v.externals.left),w=t.Qfc(v.externals.right),x=C+w,T={left:C,right:w},b+=f+C,1===g?(b=(r+C-w)/2,y="center"):2===g&&(b=r-w-1,b-=f,y="right"),e.textAlign!==y&&(e.textAlign=y),A=0,S="alphabetic",M=2,I=a.wordWrap,N=a.shrinkToFit,R=a.font,k=u.lineHeight,E=[],D=0,!I&&N)for(_={value:!1},O=j=0;O<3&&!1===_.value&&(F=e.measureText(s).width,(j=Math.max(0,r-4-(1===g?0:f)))<F);O++)R=q.To.No(R,j/F,_,!0).font,Y(e,R);if(P=0,I&&(P=r-x-3-f,--P,E=K.Wn(s,P,Z.font),1<(D=E.length)&&0!==m&&(A=(D-1)*k)),L=8<d?Q((d-8)/5+2):1,H=k/2-d/2+L-1,!I&&a.showEllipsis&&t.rHb(u,l,s,e,r,g,f),M+=k-H,1===m?M=(i-A)/2+k/2-H:2===m&&(M=i-A-2-H),e.textBaseline!==S&&(e.textBaseline=S),B=a.textDecoration,V=J.x,z=J.y,W=J.width,G=J.height,a.wordWrap)if(e.rect(V,z,W,G),e.clip(),e.beginPath(),U=n+M,1<D){for(t.Ufc(e,a,u,o+b,U,P,k*D,J),O=0;O<D;O++)e.fillText(E[O],o+b,U),B&&(F=e.measureText(E[O]).width,t.ip(e,B,o+b,U,F,d,L)),U+=k;t.Ufc(e,a,u,o+b,U,P,k*D,J)}else t.Oja(e,s,l,o+b,n+M,g,W,f,B,L,d,u,a,T,J);else(e.measureText(s).width>W||G<k)&&(e.rect(V,z,W,G),e.clip(),e.beginPath()),t.Oja(e,s,l,o+b,n+M,g,W,f,B,L,d,u,a,T,J,void 0,void 0,a.showEllipsis)}(t,e,n,r,i,a,s,g,d,l,u,c),e.restore())}function b(){var t=c.call(this)||this;return t.typeName="4",t}function v(){var t=h.call(this)||this;return t.typeName="3",t}function C(){var t=f.call(this)||this;return t.typeName="2",t}Object.defineProperty(e,"__esModule",{value:!0}),n=o("@grapecity/js-sheets-common"),r=o("./dist/core/util/domUtil.js"),y=o("./dist/core/util/common.js"),q=o("./dist/core/worksheet/stylehelper.js"),i=o("./dist/core/celltype/celltype.ns.js"),T=o("./dist/core/celltype/basecelltype.js"),A=o("./dist/core/core.enum.js"),S=y.Im,K=y.Vn,M=y.Ul.wl,L=y.Ul.uWa,Y=y.Ul.lZa,I=n.Common.j.Fa,H=y.Ul.K_a,B=r.GC$.extend,N="none",V=void 0,Q=Math.floor,X=y.Rect,f=T.Base,p(C,f),C.prototype.paint=function(t,e,o,n,r,i,a,s,l){d(this,t,e,o,n,r,i,a,s,"columnHeader",1,l)},C.prototype.paintContent=function(t,e,o,n,r,i,a,s,l){T.Context.bDc(t,H(e),o,n,r,i,s)||m(this,t,e,o,n,r,i,a,s,1,g(s.visualState,"columnHeader"),l)},a=C,e.ColumnHeader=a,i._o[2]=a,h=T.Base,p(v,h),v.prototype.paint=function(t,e,o,n,r,i,a,s){d(this,t,e,o,n,r,i,a,s,"rowHeader",2)},v.prototype.paintContent=function(t,e,o,n,r,i,a,s){T.Context.bDc(t,H(e),o,n,r,i,s)||m(this,t,e,o,n,r,i,a,s,2,g(s.visualState,"rowHeader"))},s=v,e.RowHeader=s,i._o[3]=s,c=T.Base,p(b,c),b.prototype.paint=function(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d,g,m,y,b,v,C,w,x;if(t){t.save(),t.rect(o,n,r,i),t.clip(),t.beginPath(),l=s.visualState||0;try{c=(u=this.getThemeStyle(s.visualState,"gc-corner-"+S.Jm(l)))&&u.backgroundColor,h=u&&u.backgroundImage,c?(t.fillStyle=c,t.fillRect(o,n,r,i)):h&&h!==N&&R(t,o,n,r,i,h)}catch(t){}if(p=(f=this.getThemeStyle(4,"gc-corner-triangle-"+S.Jm(l)))&&f.backgroundImage,d=f&&f.backgroundColor,g=t.createLinearGradient(o+r/2,n,o+r/2,n+i),p&&-1!==p.indexOf("linear-gradient")){for(y=0,b=(m=M(p)).length;y<b;y++)v=m[y],g.addColorStop(v.point,v.color);t.fillStyle=g}else d&&(g.addColorStop(.125,"#f6fafb"),g.addColorStop(1,d),t.fillStyle=g);(C=t.createLinearGradient(o+r,n+1,o+r,n+i-2)).addColorStop(0,f.borderLeftColor),C.addColorStop(1,f.borderRightColor),t.beginPath(),t.strokeStyle=C,t.moveTo(o+r-.5,n),t.lineTo(o+r-.5,n+i),t.stroke(),s.needLeftGridline&&(t.beginPath(),t.strokeStyle=f.borderLeftColor,t.moveTo(o+.5,n),t.lineTo(o+.5,n+i),t.stroke()),(w=t.createLinearGradient(o,n,o+r-2,n)).addColorStop(0,f.borderTopColor),w.addColorStop(1,f.borderBottomColor),t.beginPath(),t.strokeStyle=w,t.moveTo(o,n+i-.5),t.lineTo(o+r,n+i-.5),t.stroke(),s.needTopGridline&&(t.beginPath(),t.strokeStyle=f.borderTopColor,t.moveTo(o,n+.5),t.lineTo(o+r,n+.5),t.stroke()),t.beginPath(),r<(x=i)&&(x=r),t.moveTo(o+r-x+3,n+i-3),t.lineTo(o+r-3,n+i-3),t.lineTo(o+r-3,n+i-x+3),t.fill(),t.restore()}},l=b,e.Corner=l,i._o[4]=l},"./dist/core/celltype/textcelltype.js":function(t,e,o){"use strict";var n,S,X,r,i,$,D,j,tt,et,a,M,s,I,_,l,u,ot,f,nt,N,rt,c,h,p,it,at,d,g,st,O,F,lt,R,ut,k,ct,ht,ft,pt,dt,gt,mt,yt,bt,vt,Ct,wt,E,P,m,y,L,H,xt,Tt,B,V,z,At,St,b,W,v,C,w,x,T,A=this&&this.__extends||(w=function(t,e){return(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}w(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function G(t){return y||0===t?X.GC$(l("textarea")):X.GC$(l("div"))}function Mt(t){return t&&"DIV"===t.tagName&&"true"===t.contentEditable}function It(t){return Mt(t)?ot&&parseFloat(u.version)<10?s.Woa(t):t.innerText:t.value}function U(t,e){Mt(t)?t.innerText=tt(e)?"":e:t.value=e}function Nt(t){var e;return Mt(t)?0<(e=E.getSelection()).rangeCount?e.getRangeAt(0).startOffset:0:t.selectionStart}function Rt(t){var e;return Mt(t)?0<(e=E.getSelection()).rangeCount?e.getRangeAt(0).endOffset:0:t.selectionEnd}function J(t){return t&&"BR"===t.tagName}function Z(t){return t&&"SPAN"===t.tagName}function q(t){return t&&"DIV"===t.tagName}function K(t){return t instanceof Text}function Y(t,e,o,n){return t.substr(0,e)+n+t.substr(o,t.length-o)}function kt(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d=String.fromCharCode((l=(s=r).keyCode,u=s.shiftKey,c={106:42,107:43,109:45,110:46,111:47,173:45},h={186:59,187:61,188:44,189:45,190:46,191:47,192:96,219:91,220:92,221:93,222:39},f={186:58,187:43,188:60,189:95,190:62,191:63,192:126,219:123,220:124,221:125,222:34},96<=(p=l)&&l<=105?p=l-48:c[l]?p=c[l]:u&&f[l]?p=f[l]:!u&&h[l]?p=h[l]:!u&&65<=l&&l<=90&&(p=l+32),p));return Mt(t)?0<(i=E.getSelection()).rangeCount&&K((a=i.getRangeAt(0)).startContainer)?function t(e,o,n,r,i,a){var s,l,u,c,h,f="",p=e.childNodes,d=p.length;for(s=0;s<d;s++)Z(l=p[s])?f+=t(l,o,n,r,i,a):K(l)?(u=o&&o.startContainer,c=o&&o.endContainer,h=l.textContent,l===u||l===c?u!==c?a=l===u?(f+=Y(h,n,h.length,i),!0):(f+=Y(h,0,r,""),!1):f+=Y(h,n,r,i):a||(f+=h)):J(l)&&!a&&(f+="\n");return f}(t,a,o,n,d):a&&a.startOffset===a.endOffset?e+d:d:Y(e,o,n,d)}function Q(t){var e,o,n=((o=t)&&0<(e=o.length)&&"\n"===o[e-1]&&(o+=W),o);return n&&0<=n.indexOf(" ")&&(n=g(n," ",b)),n}function Et(t){var e,o=t;return!o||o.indexOf(W)<0&&o.indexOf("\n")<0?o:((e=t.split("\n")).forEach(function(t,e,o){t[0]===W&&(o[e]=t.substr(1))}),e.join("\n"))}function Dt(t){var e,o,n,r,i,a,s,l,u,c=E.getSelection(),h=!1,f=0,p=0,d="";if(0<c.rangeCount){if(e=c.getRangeAt(0),o=Nt(t),n=Rt(t),r=e.startContainer,i=e.endContainer,q(r))h=!0,f=o;else if(l=void 0,0<(s=(a=r.childNodes).length))for(l=0;l<s;l++){if(!(u=a[l]).tagName||"br"!==u.tagName.toLocaleLowerCase()){r=u;break}d+="\n"}return q(i)&&(p=n),d+function t(e,o,n,r,i,a,s,l){var u,c,h,f,p,d,g;if(r===i&&!a)return{content:Et(r.textContent.slice(o,n))};for(u="",c=s,p=e.childNodes,d=l||p.length;c<d;c++)if(g=p[c],Z(g)){if(h=t(g,o,n,r,i,a,0,0),u+=h.content,h.startFlag&&(a=!0),h.endFlag){f=!0;break}}else if(K(g)&&g===r)u+=g.textContent.slice(o,g.textContent.length),a=!0;else{if(K(g)&&g===i){u+=g.textContent.slice(0,n),f=!0;break}a&&(u+=J(g)?"\n":g.innerText||g.textContent)}return{content:Et(u),startFlag:a,endFlag:f}}(t,o,n,r,i,h,f,p).content}}function jt(t,e,o,n){var r,i=0,a=o;for(r=0;r<t.length;r++)nt&&(a=n[r]),t[r]>e?i+=a*xt(t[r]/e):i+=a;return i}function _t(t){var e=x.call(this)||this;return e.allowOverflow=!0,e.typeName="1",e.editorType=tt(t)?1:t,e}Object.defineProperty(e,"__esModule",{value:!0}),n=o("@grapecity/js-sheets-common"),S=o("./dist/core/worksheet/worksheet.js"),X=o("./dist/core/util/domUtil.js"),r=o("./dist/core/util/common.js"),i=o("./dist/core/celltype/celltype.ns.js"),$=o("./dist/core/celltype/basecelltype.js"),D=o("./dist/core/core.enum.js"),j=o("./dist/core/util/common.js"),tt=n.Common.j.Fa,et=r.Vn,a=r.Events.EditChange,M=r.Vl,s=r.Ul,I=r.uHb,_=s.lHb,l=s.Nl,u=s.Ml,ot=u.msie,f=u.edge,nt=u.chrome,N=s.nl,rt=s.ol,c=s.Il,h=s.vl,p=s.rl(),it=s.fp,at=s.Voa,d=s.pL,g=s.Ika,st=s.hZa,O=s.K_a,F=s.Fxb,lt="left",R="gcUIElement",ut="none",k=".gcEditingInput",ct="width",ht="height",ft="text-align",pt="hidden",dt="word-wrap",gt="overflow",mt="vertical-align",yt="normal",bt="break-word",vt="overflow-y",Ct="word-break",wt="float",E=window,P=document,m=p.ipad,y=p.iphone||m||p.android,L=null,H=void 0,xt=Math.ceil,Tt=Math.min,B=Math.sin,V=Math.cos,z=Math.abs,At=Math.max,St=parseInt,b=" ",W="​",v="string",(T=e.EditorType||(e.EditorType={}))[T.textarea=0]="textarea",T[T.editableDiv=1]="editableDiv",x=$.Base,A(_t,x),_t.prototype.getText=function(t,e){return t},_t.prototype.paintValue=function(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R=this,k=s.sheet,E=k.zoom?k.zoom():1;if(e=R.getText(e,s),l={},s.quotePrefix=a.quotePrefix,h=(c=a.formatter)&&"General"!==c,f=_(c),"string"==typeof c&&(h=h&&!f),p=a.textOrientation,d=a.textIndent&&0!==a.textIndent,g=a.isVerticalText,m=r,p&&-90<=p&&p<=90&&!d&&!g&&(y=z(p*Math.PI/180),m=(i-s.lineHeight*V(y))/B(y)),b=R.Pfc(t,u,a,s,o,n,r,i).externals,v=R.Qfc(b.left),C=R.Qfc(b.right),3===(w=a.hAlign)&&(w=rt(w,e,a.formatter)),2===w?m-=C:0===w&&(m-=v),x=a._autoFormatter&&a._autoFormatter.formatCached&&"General"!==a._autoFormatter.formatCached,h?T=a.formatter:x?T=a._autoFormatter:k.parent&&k.parent.options.numbersFitMode===D.NumbersFitMode.mask?T=$.Context.Ixb(t,e,m,a,E):k.parent&&k.parent.options.numbersFitMode===D.NumbersFitMode.overflow&&(T=a._autoFormatter),u=f&&(e instanceof Date||"boolean"==typeof e||e instanceof Boolean||"number"==typeof e)?R.format(e,c,{}):R.format(O(e),T,l,s),A=new j.Rect(o,n,r,i),this.adjustRectForIconSet(a.hAlign,s.sheet,s.row,s.col,s.sheetArea,A,l.content&&this.hasInfilling(l.content)),o=A.x,r=A.width,!0!==a.shrinkToFit&&!g)if(F(e)){if(k.parent){switch(S=u,k.parent.options.numbersFitMode){case D.NumbersFitMode.mask:S=this.Yfc(t,u,m,a,E,s,l,k);break;case D.NumbersFitMode.overflow:S=this.Klb(t,s,e,a,k,u,l)}u=S}}else void 0===k._modelManager.uIb(s.row,s.col,s.sheetArea)||a.showEllipsis||k._modelManager.qHb(s.row,s.col,void 0,s.sheetArea);return M=a.labelOptions,I=a.watermark,N=!M||0!==M.visibility,I&&!u&&N?void R.paintText(t,I,o,n,r,i,a,s,I,l,.337):void((u||l.content&&l.content.length)&&(1===a.vAlign&&nt&&n--,R.paintText(t,e,o,n,r,i,a,s,u,l,H,b)))},_t.prototype.Yfc=function(t,e,o,n,r,i,a,s){var l=$.Context.Lxb(t,e,o,n,r),u=i.row,c=i.col;return e!==l?(delete a.content,n.textIndent=0,s._modelManager.qHb(u,c,s.getText(u,c,i.sheetArea),i.sheetArea)):s._modelManager.qHb(u,c,void 0,i.sheetArea),l},_t.prototype.Klb=function(t,e,o,n,r,i,a){var s,l,u,c,h=e.row,f=e.col;if(n.wordWrap&&(n.wordWrap=!1),s=d(t,n.font,i),l=r.ss._m(f),c=void 0,!(u=e.cellOverflowLayout)&&l<s)c=r.getText(h,f,e.sheetArea);else if(u&&l<s&&this.lDc(u.backgroundWidth)&&this.lDc(u.valueWidth)){if(!this.lDc(n.hAlign))return;c=(1!==n.hAlign?u.valueWidth>u.backgroundWidth:u.valueWidth/2>u.backgroundLeftWidth||u.valueWidth/2>u.backgroundRightWidth)?r.getText(h,f,e.sheetArea):void 0}return r._modelManager.qHb(h,f,c,e.sheetArea),i},_t.prototype.lDc=function(t){return null!=t},_t.prototype.createEditorElement=function(t,e){var o,n=t&&t.sheet&&t.sheet.parent&&t.sheet.parent._host,r=h(n)+1e3;return X.GC$(e).css("z-index",r),o=G(this.editorType),X.GC$(o).css({font:"normal 11pt calibri",outline:ut,resize:ut,border:ut,padding:"1px","vertical-align":"top","min-height":"0px","box-sizing":"content-box",background:"transparent"}).css(dt,yt).attr({tabindex:-1,autocomplete:"off",contenteditable:!0}).css(gt,pt).attr(R,"gcEditingInput"),u.safari&&X.GC$(o).css("-webkit-user-select","auto"),Mt(X.GC$(o)[0])&&(X.GC$(o).css("display","table-cell"),X.GC$(o).css(Ct,yt)),X.GC$(o)[0]},_t.prototype.getEditorValue=function(t,e){var o,n;return t&&(o=It(t),!tt(o)&&0<o.length)?(n=(n=Et(o)).replace(/\r\n?/g,"\n")).indexOf(b)<0?n:g(n,b," "):L},_t.prototype.setEditorValue=function(t,e,o,n){var r,i;t&&(r=o&&o.sheet&&o.sheet.HF,i=Q(e),ot?r&&o.isImeInput||U(t,tt(i)?n?"%":"":i):U(t,r?n?"%":"":i))},_t.prototype.selectAll=function(t,e){t&&t.select?t.select():E.getSelection().selectAllChildren(t)},_t.prototype.focus=function(t,e){this.isImeAware()&&t?(t.focus(),function(t){if(Mt(t)){var e=E.getSelection();e.selectAllChildren(t),0<e.rangeCount&&e.collapseToEnd()}else t.selectionStart=t.selectionEnd=t.value.length}(t)):t.parentNode.parentNode.focus()},_t.prototype.kp=function(t,e,o,n){var r=t&&n&&n.sheet,i={},a=c(e,o,r,i);return t.oja=i.formatter||H,a},_t.prototype.activateEditor=function(t,m,y,b,v,C,w){var x,T,e,A,i=b&&b.sheet;i&&(x=this,(T=t)&&(e=X.GC$(T),A=Mt(T),x._editingElement=T,p.android&&e.bind("input"+k,function(t){try{x.$fc(T,m,y,t,b,!1,v,C,w)}catch(t){}}),e.bind("keydown"+k,function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g;try{e=t.keyCode,A&&(8===e?I.processBackspaceAndLeftArrowKeyEvent(t,!0):46===e?I.processDeleteAndRightArrowKeyEvent(t,!0):37===e?I.processBackspaceAndLeftArrowKeyEvent(t,!1):39===e&&I.processDeleteAndRightArrowKeyEvent(t,!1)),229===e||0===e||x.kK||x.$fc(T,m,y,t,b,!0,v,C,w),o=t,n=b,r=x.kK,(g=o.srcElement||o.target)&&"gcEditingInput"===g.getAttribute(R)&&13===o.keyCode&&(o.ctrlKey||o.altKey)&&((i=M.Xl())instanceof S.Worksheet&&(a=i.getCellType(i.Jl,i.Kl))&&(Mt(g)?(r&&(g.blur(),g.focus()),0<(s=E.getSelection()).rangeCount&&(l=s.getRangeAt(0),(u=P.createElement("span")).innerHTML="<br/>"+W,l.insertNode(u),(c=P.createRange()).setStartAfter(u),c.setEndAfter(u),c.collapse(!1),s.removeAllRanges(),s.addRange(c))):(h=g.selectionStart,p=(f=g.value).substr(0,h),d=f.substr(h,f.length-h),g.value=p+"\n"+d,g.selectionStart=h+1,g.selectionEnd=h+1),a.$fc(i._editor,L,L,o,n,!0)),N(o))}catch(t){}}),e.bind("keyup"+k,function(t){var e=t.keyCode,o=t.ctrlKey,n=t.altKey;229===e||0===e||x.kK||(46!==e&&8!==e&&(90!==e&&89!==e||!o||n)||(A&&"\n"===T.innerText&&X.GC$(T).empty(),x.$fc(T,m,y,t,b,!1,v,C,w)),(13!==e&&9!==e&&27!==e&&16!==e||o||n)&&i.Wq(a,{sheet:i,sheetName:i.name(),row:i.Jl,col:i.Kl,editingText:x.getEditorValue(T,b)}))}),e.bind("mousedown"+k,function(){1===i._editorStatus&&(i._editorStatus=2,i._raiseEditorStatusChanged(1,2))}),e.bind("textInput"+k,function(t){if(t.data&&(x.probabilityAddPercentSpec||x.probabilityAddPercent)&&/^[0-9]+.?[0-9]*/.test(t.data)){var e=document.createElement("span");e.innerText="%",e.id="updateEditorImpAddPercent","#text"===T.firstChild.nodeName?T.appendChild(e):T.firstChild.appendChild(e),delete x.probabilityAddPercentSpec,delete x.probabilityAddPercent}}),e.bind("compositionstart"+k,function(){x.kK=!0,x.nK=It(T)}),e.bind("compositionupdate"+k,function(t){x.$fc(T,m,y,t||L,b,!0,v,C,w)}),e.bind("compositionend"+k,function(t){var e,o,n,r;x.$fc(T,m,y,t||L,b,!1,v,C,w),x.kK=!1,e=t.keyCode,o=t.ctrlKey,n=t.altKey,r=x.getEditorValue(T,b)||"",x.nK!==r&&(e===H||13!==e&&9!==e||o||n)&&i.Wq(a,{sheet:i,sheetName:i.name(),row:i.Jl,col:i.Kl,editingText:r})}),A&&(e.bind("copy"+k,function(t){var e=E.clipboardData,o=t.clipboardData,n=Dt(t.currentTarget);tt(n)||(e&&e.setData?(e.setData("text",n),N(t)):o&&o.setData&&(o.setData("text/plain",n),N(t)))}),e.bind("paste"+k,function(t){var e,o,n,r,i,a,s,l,u,c,h=!1;if(A)try{e=void 0,ot&&!f&&E.clipboardData&&E.clipboardData.getData?e=E.clipboardData.getData("text"):t.clipboardData&&t.clipboardData.getData&&(e=t.clipboardData.getData("text/plain")),e=Q(e=e.replace(/\r\n?/g,"\n")),0<(o=E.getSelection()).rangeCount&&((r=(n=o.getRangeAt(0)).startOffset)!==n.endOffset&&n.deleteContents(),l=e,u=r,(c=It(T))&&"="===c[0]||""===c&&"="===l[0]||0===u&&"="===l[0]||(i=P.createElement("span"),"\n"===(e=e.replace(/\u200B/g,""))[(a=e.length)-1]&&(e="\r"===e[a-2]?e.substr(0,a-2):e.substr(0,a-1)),i.innerText=e,n.insertNode(i),(s=document.createRange()).setStartAfter(i),s.setEndAfter(i),s.collapse(!1),o.removeAllRanges(),o.addRange(s),h=!0))}catch(t){}if(x.mK=E.setTimeout(function(){x.$fc(T,m,y,t,b,!1,v,C,w),x.mK&&(clearTimeout(x.mK),delete x.mK)},10),h)return!1}))))},_t.prototype.deactivateEditor=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p;if(t){if(o=t,this.kK&&m&&e&&e.sheet&&e.sheet.CH)try{o&&X.GC$(o).trigger("compositionend"+k)}catch(t){}if(n=e.sheet.getActualStyle(e.row,e.col,e.sheetArea).cellPadding)for(r=[lt,"top"],i=[3,0],a=0;a<r.length;a++)s="number"==typeof(s=parseInt((p=f=h=c=u=void 0,p=["0","0","0","0"],typeof(l=n)===v&&(u=l.split(" ",4),c=u.length,f=h=void 0,1===c?(h=u[0],p=[h,h,h,h]):2===c?(h=u[0],f=u[1],p=[h,f,h,f]):3===c?(f=u[1],p=[u[0],f,u[2],f]):4===c&&(p=[u[0],u[1],u[2],u[3]])),p)[i[a]],10))&&0<s?s:0,this.shiftPadding(o,r[a],s);X.GC$(t).unbind(k),e.sheet._eventHandler.Qq()}this._editingElement=L},_t.prototype.shiftPadding=function(t,e,o){var n=X.GC$(t).parent();n&&(e===lt?n.css({left:(+X.GC$(n).css(lt).replace("px","")||0)-o}):"top"===e&&n.css({top:(+X.GC$(n).css("top").replace("px","")||0)-o}))},_t.prototype.getEditingElement=function(){return this._editingElement},_t.prototype.lK=function(t,e,o,n,r,i,a,s,l){var u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J,Z,q=r&&r.sheet,K=this,Y=q.options.sheetAreaOffset,Q=t;if(Q&&q&&(u=X.GC$(Q),c=q._render,h=r.preventOverflow,f=It(Q),q.isEditing())){if(p=Mt(Q),g=lt,m=d=void 0,y=$.Context.u5,w=C=v=b=0,e&&(b=y(e,0,!1,x=q.zoom()),v=y(e,1,!1,x),C=y(e,2,!1,x),w=y(e,3,!1,x),1===(d=rt(e.hAlign,t.LF))?g="center":2===d&&(g="right"),u.css(ft,g),e.foreColor&&u.css("color",e.foreColor),(m=e.font||c.Bl())&&(1<q.zoom()&&(m=c.Cl(m)),u.css("font",st(m))),e.textDecoration&&K.lp(u,e.textDecoration)),T=St(u.css("padding-left"),10)+St(u.css("padding-right"),10),A=St(u.css("padding-top"),10)+St(u.css("padding-bottom"),10),tt(a)&&(a=o),a&&(S=q.am(),M=o.width,a.x+a.width-Y.left>S.width&&(o.width=S.width-o.x,a.width=S.width-a.x),u.css(ct,M-T).css(ht,o.height-A),Q.maxWidth=Y.left+S.width-o.x-T-v,u.css("max-width",Q.maxWidth+"px"),Q.maxHeight=Y.top+S.height-o.y-A-C,Q.minWidth=St(Q.style.width,10),Q.minHeight=St(Q.style.height,10)),I=Nt(Q),N=Rt(Q),R=(i=(i=i&&n&&n.keyCode&&q._eventHandler.LH(n)&&0===I&&N===f.length)||q.HF)?"":f,m=(m=Q.style.font)||c.Cl(c.Bl()),k=it(m),n&&K.probabilityAddPercent&&(E=n.keyCode)&&(96<=E&&E<=105||48<=E&&E<=57)&&(q.parent.options.enableFormulaTextbox?(j=Q.innerText,/[a-z]/i.test(j)?K.probabilityAddPercent=!1:((D=document.createElement("span")).innerText="%",D.id="updateEditorImpAddPercent",Q.appendChild(D),delete K.probabilityAddPercent)):((D=document.createElement("span")).innerText="%",D.id="updateEditorImpAddPercent",Q.firstChild.appendChild(D),delete K.probabilityAddPercent)),!i&&n&&(q._eventHandler.LH(n)&&8!==n.keyCode&&(R=kt(Q,R,I,N,n)),K.kK&&(R=ot?f:K.nK+n.data)),F=O=void 0,P=(_=e&&e.wordWrap?et.Wn(R,St(Q.style.width)-T,m):R.split(/\r\n|\r|\n/)).length,Q.minWidth=Tt(Q.minWidth,Q.maxWidth),Q.minHeight=Tt(Q.minHeight,Q.maxHeight),e&&e.wordWrap||0<P){if(H=L=void 0,L=nt?function(t){var e,o=t.length,n=0;for(e=0;e<o;e++)n+=t[e];return n}(H=function(t,e){var o,n=t.length,r=[];for(o=0;o<n;o++)r.push(at(t[o],e));return r}(_,m)):P*k,e&&e.wordWrap)u.css(dt,bt).css(gt,pt).css("max-width",Q.style.width);else{for(V=[],O=B=0;O<P;O++)F=xt(q.rt(_[O],m)),V.push(F),B=At(B,F);z=u.css(dt),W=St(Q.style.width),e||z!==bt?B<=Q.minWidth?(u.css(ct,Q.minWidth).css(dt,yt).css(gt,pt),p&&u.css(Ct,yt)):B>Q.minWidth&&B<=Q.maxWidth&&!h?(u.css(ct,B).css(dt,yt).css(gt,pt),p&&u.css(Ct,yt)):B>Q.maxWidth&&!h&&(u.css(ct,Q.maxWidth-2).css(dt,bt).css(gt,pt),L=jt(V,Q.maxWidth,k,H)):W<B&&!h&&(L=jt(V,W,k,H))}L<=Q.minHeight?u.css(ht,Q.minHeight).css(wt,ut):L>Q.minHeight&&L<=Q.maxHeight?u.css(ht,L).css(wt,ut):L>Q.maxHeight&&u.css(ht,Q.maxHeight-1).css(vt,"scroll").css(wt,lt)}return d=u.css(ft),G=u.width()-Q.minWidth,tt(d)||d===lt||("center"===d?u.css(lt,Q.originalLeft-G/2):"right"===d&&u.css(lt,Q.originalLeft-G)),e&&p&&(1===(U=e.vAlign)?u.css(mt,"middle"):2===U&&u.css(mt,"bottom")),J=St(Q.style.height)+A+b+C,Z=T+w+v,"scroll"===u.css(vt)?{width:Q.offsetWidth+Z,height:i?0:J}:{width:St(Q.style.width)+Z,height:J}}},_t.prototype.updateEditor=function(t,e,o,n,r,i,a){var s,l,u;return o=this.lK(t,e,o,L,n,!1,r,i,a),ot&&t&&(l=(s=X.GC$(t))[0].style.width,s.width(l+1).width(l)),!tt(o)&&t&&(u=new j.Rect(t.style.left?parseFloat(t.style.left):0,t.style.top?parseFloat(t.style.top):0,o.width,o.height)),u},_t.prototype.$fc=function(t,e,o,n,r,i,a,s,l){if(o=this.lK(t,e,o,n,r,i,a,s,l),ot&&t){var u=X.GC$(t),c=u[0].style.width;u.width(c+1).width(c)}!tt(o)&&t&&(tt(a)?a=o:(a.x=H,a.y=H),this.updateEditorContainer(t,o,e,r,a,s,l))},_t.prototype.updateEditorContainer=function(t,e,o,n,r,i,a){var s,l,u;n&&n.preventOverflow?(x.prototype.updateEditorContainer.call(this,t,e,o,n,r,i,a),(s=t.parentNode)&&e&&(l=X.GC$(s),0<(u=e.width)&&l.width(u))):(e&&e.width&&r&&r.width&&(r.width=e.width),e&&e.height&&r&&r.height&&(r.height=e.height),x.prototype.updateEditorContainer.call(this,t,e,o,n,r,i,a))},_t.prototype.updateImeMode=function(t,e,o){this.isImeAware()&&t&&$.Context.hp(t,e)},_t.prototype.isReservedKey=function(t,e){var o=t.srcElement||t.target,n=t.keyCode,r=t.ctrlKey,i=t.altKey,a=t.metaKey;return!!(o&&e&&e.isEditing&&"gcEditingInput"===o.getAttribute(R))&&(13===n&&(r&&!t.shiftKey||i)||90===n&&r&&!i||89===n&&r&&!i||67===n&&(r||a)&&!i||88===n&&(r||a)&&!i)},_t.prototype.isImeAware=function(t){return!0},_t.prototype.toJSON=function(){var t,e={};for(t in this)this.hasOwnProperty(t)&&"_editingElement"!==t&&(e[t]=this[t]);return e},C=_t,e.Text=C,i._o[1]=C},"./dist/core/core.definition.js":function(t,e){},"./dist/core/core.entry.js":function(t,o,e){"use strict";var n,r,i,a,s,l,u;function c(t){for(var e in t)o.hasOwnProperty(e)||(o[e]=t[e])}Object.defineProperty(o,"__esModule",{value:!0}),e("./dist/core/core.res.en.js"),c(e("./dist/core/core.ns.js")),c(e("./dist/core/core.enum.js")),c(e("./dist/core/util/common.js")),c(e("./dist/core/util/domUtil.js")),e("./dist/core/core.definition.js"),n=e("./dist/core/util/common.js"),Object.defineProperty(o,"getTypeFromString",{set:function(t){n.getTypeFromString=t},get:function(){return n.getTypeFromString}}),a=-1,1===(i=(r=e("./dist/core/lc/releaseLc.js")).Soa)&&(a=Math.floor(5*Math.random()),o["G".concat("C","$")]["s".concat("d")]=a),c(e("./dist/core/util/theme.js")),c(e("./dist/core/util/basedialog.js")),c(e("./dist/core/util/imageLoader.js")),c(e("./dist/core/util/tasks.js")),0===a&&e("./dist/core/lc/lcRegister.js"),c(e("./dist/core/worksheet/stylehelper.js")),1===a&&e("./dist/core/lc/lcRegister.js"),c(e("./dist/core/worksheet/style.js")),2===a&&e("./dist/core/lc/lcRegister.js"),c(e("./dist/core/worksheet/clipboardhelper.js")),3===a&&e("./dist/core/lc/lcRegister.js"),c(e("./dist/core/worksheet/worksheet-model.js")),4===a&&e("./dist/core/lc/lcRegister.js"),c(e("./dist/core/worksheet/worksheet.js")),e("./dist/core/worksheet/worksheet-formatter.js"),c(e("./dist/core/worksheet/worksheet-actions.js")),c(e("./dist/core/worksheet/worksheet-border.js")),e("./dist/core/worksheet/worksheet-edit.js"),c(e("./dist/core/worksheet/worksheet-event.js")),e("./dist/core/worksheet/worksheet-json.js"),c(e("./dist/core/worksheet/worksheet-render.js")),e("./dist/core/worksheet/worksheet-selection.js"),e("./dist/core/worksheet/worksheet-sort.js"),c(e("./dist/core/worksheet/worksheet-ui.js")),c(e("./dist/core/worksheet/worksheet-static.js")),c(e("./dist/core/workbook/workbook.js")),e("./dist/core/workbook/workbook-json.js"),c(e("./dist/core/workbook/sheettabbase.js")),c(e("./dist/core/workbook/sheettab.js")),c(e("./dist/core/workbook/sheettab2007.js")),c(e("./dist/core/workbook/workbookpanelex.js")),s=e("./dist/core/celltype/cellType.entry.js"),o.CellTypes=s,l=e("./dist/core/celltype/headercelltype.js"),Object.defineProperty(s,"Corner",{set:function(t){t!==l.Corner&&(l.Corner=t)},get:function(){return l.Corner}}),Object.defineProperty(s,"ColumnHeader",{set:function(t){t!==l.ColumnHeader&&(l.ColumnHeader=t)},get:function(){return l.ColumnHeader}}),Object.defineProperty(s,"RowHeader",{set:function(t){t!==l.RowHeader&&(l.RowHeader=t)},get:function(){return l.RowHeader}}),u=e("./dist/core/celltype/textcelltype.js"),Object.defineProperty(s,"Text",{set:function(t){t!==u.Text&&(u.Text=t)},get:function(){return u.Text}}),s.vHb=l,s.wHb=u,1!==i&&2!==i||r.Gb(o)},"./dist/core/core.enum.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J,Z,q,K,Y,Q,X,$,tt,et,ot,nt;Object.defineProperty(e,"__esModule",{value:!0}),(nt=e.ScrollType||(e.ScrollType={}))[nt.pixels=0]="pixels",nt[nt.continuous=1]="continuous",(ot=e.AxisInfoChangeType||(e.AxisInfoChangeType={}))[ot.setRowCount=0]="setRowCount",ot[ot.setColumnCount=1]="setColumnCount",ot[ot.addRows=2]="addRows",ot[ot.deleteRows=3]="deleteRows",ot[ot.addColumns=4]="addColumns",ot[ot.deleteColumns=5]="deleteColumns",ot[ot.setRowHeight=6]="setRowHeight",ot[ot.setColumnWidth=7]="setColumnWidth",ot[ot.setRowVisible=8]="setRowVisible",ot[ot.setColumnVisible=9]="setColumnVisible",ot[ot.filterRows=10]="filterRows",ot[ot.outlineExpandRows=11]="outlineExpandRows",ot[ot.outlineExpandColumns=12]="outlineExpandColumns",(et=e.ScrollbarState||(e.ScrollbarState={}))[et.hide=0]="hide",et[et.show=1]="show",et[et.active=2]="active",et[et.inactive=3]="inactive",(tt=e.ShowResizeTip||(e.ShowResizeTip={}))[tt.none=0]="none",tt[tt.column=1]="column",tt[tt.row=2]="row",tt[tt.both=3]="both",($=e.ScrollbarAppearance||(e.ScrollbarAppearance={}))[$.skin=0]="skin",$[$.mobile=1]="mobile",(X=e.ShowScrollTip||(e.ShowScrollTip={}))[X.none=0]="none",X[X.horizontal=1]="horizontal",X[X.vertical=2]="vertical",X[X.both=3]="both",(Q=e.InsertShiftCell||(e.InsertShiftCell={}))[Q.right=0]="right",Q[Q.down=1]="down",(Y=e.ResizeMode||(e.ResizeMode={}))[Y.normal=0]="normal",Y[Y.split=1]="split",(K=e.CopyPasteHeaderOptions||(e.CopyPasteHeaderOptions={}))[K.noHeaders=0]="noHeaders",K[K.rowHeaders=1]="rowHeaders",K[K.columnHeaders=2]="columnHeaders",K[K.allHeaders=3]="allHeaders",(q=e.HeaderOptions||(e.HeaderOptions={}))[q.noHeaders=0]="noHeaders",q[q.rowHeaders=1]="rowHeaders",q[q.columnHeaders=2]="columnHeaders",q[q.allHeaders=3]="allHeaders",(Z=e.ResizeZeroIndicator||(e.ResizeZeroIndicator={}))[Z.default=0]="default",Z[Z.enhanced=1]="enhanced",(J=e.InvalidOperationType||(e.InvalidOperationType={}))[J.setFormula=0]="setFormula",J[J.copyPaste=1]="copyPaste",J[J.dragFill=2]="dragFill",J[J.dragDrop=3]="dragDrop",J[J.changePartOfArrayFormula=4]="changePartOfArrayFormula",J[J.changeSheetName=5]="changeSheetName",J[J.table=6]="table",J[J.filter=7]="filter",J[J.hideSheet=8]="hideSheet",J[J.sort=9]="sort",J[J.pivotTable=10]="pivotTable",J[J.ptOverlapValue=11]="ptOverlapValue",J[J.groupProtected=12]="groupProtected",(U=e.AutoFitType||(e.AutoFitType={}))[U.cell=0]="cell",U[U.cellWithHeader=1]="cellWithHeader",(G=e.ClipboardPasteOptions||(e.ClipboardPasteOptions={}))[G.all=0]="all",G[G.values=1]="values",G[G.formatting=2]="formatting",G[G.formulas=3]="formulas",G[G.valuesAndFormatting=4]="valuesAndFormatting",G[G.formulasAndFormatting=5]="formulasAndFormatting",(W=e.LabelAlignment||(e.LabelAlignment={}))[W.topLeft=0]="topLeft",W[W.topCenter=1]="topCenter",W[W.topRight=2]="topRight",W[W.bottomLeft=3]="bottomLeft",W[W.bottomCenter=4]="bottomCenter",W[W.bottomRight=5]="bottomRight",(z=e.LabelVisibility||(e.LabelVisibility={}))[z.visible=0]="visible",z[z.hidden=1]="hidden",z[z.auto=2]="auto",(V=e.TextDecorationType||(e.TextDecorationType={}))[V.underline=1]="underline",V[V.lineThrough=2]="lineThrough",V[V.overline=4]="overline",V[V.doubleUnderline=8]="doubleUnderline",V[V.none=0]="none",(B=e.HorizontalAlign||(e.HorizontalAlign={}))[B.left=0]="left",B[B.center=1]="center",B[B.right=2]="right",B[B.general=3]="general",(H=e.VerticalAlign||(e.VerticalAlign={}))[H.top=0]="top",H[H.center=1]="center",H[H.bottom=2]="bottom",(L=e.VertAlign||(e.VertAlign={}))[L.normal=0]="normal",L[L.superscript=1]="superscript",L[L.subscript=2]="subscript",(P=e.Nxb||(e.Nxb={}))[P.smallDecrement=0]="smallDecrement",P[P.smallIncrement=1]="smallIncrement",P[P.largeDecrement=2]="largeDecrement",P[P.largeIncrement=3]="largeIncrement",P[P.thumbPosition=4]="thumbPosition",P[P.thumbTrack=5]="thumbTrack",P[P.endScroll=6]="endScroll",(F=e.VisualState||(e.VisualState={}))[F.normal=0]="normal",F[F.highlight=1]="highlight",F[F.selected=2]="selected",F[F.active=3]="active",F[F.hover=4]="hover",F[F.activeNotSelected=5]="activeNotSelected",(O=e.EditorStatus||(e.EditorStatus={}))[O.ready=0]="ready",O[O.enter=1]="enter",O[O.edit=2]="edit",(_=e.ImeMode||(e.ImeMode={}))[_.auto=1]="auto",_[_.active=2]="active",_[_.inactive=4]="inactive",_[_.disabled=0]="disabled",(j=e.SelectionPolicy||(e.SelectionPolicy={}))[j.single=0]="single",j[j.range=1]="range",j[j.multiRange=2]="multiRange",(D=e.SelectionUnit||(e.SelectionUnit={}))[D.cell=0]="cell",D[D.row=1]="row",D[D.column=2]="column",(E=e.StorageType||(e.StorageType={}))[E.data=1]="data",E[E.style=2]="style",E[E.comment=4]="comment",E[E.tag=8]="tag",E[E.sparkline=16]="sparkline",E[E.axis=32]="axis",E[E.bindingPath=64]="bindingPath",E[E.hyperlink=256]="hyperlink",(k=e.HeaderAutoText||(e.HeaderAutoText={}))[k.blank=0]="blank",k[k.numbers=1]="numbers",k[k.letters=2]="letters",(R=e.RangeChangedAction||(e.RangeChangedAction={}))[R.dragDrop=0]="dragDrop",R[R.dragFill=1]="dragFill",R[R.clear=2]="clear",R[R.paste=3]="paste",R[R.sort=4]="sort",R[R.setArrayFormula=5]="setArrayFormula",R[R.evaluateFormula=6]="evaluateFormula",(N=e.ValueType||(e.ValueType={}))[N.normal=0]="normal",N[N.richText=1]="richText",(I=e.ImageLayout||(e.ImageLayout={}))[I.stretch=0]="stretch",I[I.center=1]="center",I[I.zoom=2]="zoom",I[I.none=3]="none",(M=e.Oxb||(e.Oxb={})).ThumbButton="thumbButton",M.TrackButton="trackButton",M.LeftButton="leftButton",M.RightButton="rightButton",M.UpButton="upButton",M.DownButton="downButton",(S=e.HorizontalPosition||(e.HorizontalPosition={}))[S.left=0]="left",S[S.center=1]="center",S[S.right=2]="right",S[S.nearest=3]="nearest",(A=e.VerticalPosition||(e.VerticalPosition={}))[A.top=0]="top",A[A.center=1]="center",A[A.bottom=2]="bottom",A[A.nearest=3]="nearest",(T=e.SheetArea||(e.SheetArea={}))[T.corner=0]="corner",T[T.colHeader=1]="colHeader",T[T.rowHeader=2]="rowHeader",T[T.viewport=3]="viewport",(x=e.SortState||(e.SortState={}))[x.none=0]="none",x[x.ascending=1]="ascending",x[x.descending=2]="descending",(w=e.CellStatesType||(e.CellStatesType={}))[w.hover=1]="hover",w[w.invalid=2]="invalid",w[w.readonly=4]="readonly",w[w.edit=8]="edit",w[w.active=16]="active",w[w.selected=32]="selected",w[w.dirty=64]="dirty",(C=e.StatesType||(e.StatesType={}))[C.hover=1]="hover",C[C.invalid=2]="invalid",C[C.readonly=4]="readonly",C[C.edit=8]="edit",C[C.active=16]="active",C[C.selected=32]="selected",C[C.dirty=64]="dirty",C[C.inserted=128]="inserted",C[C.updated=256]="updated",(v=e.ButtonVisibility||(e.ButtonVisibility={}))[v.always=0]="always",v[v.onSelected=1]="onSelected",v[v.onEditing=2]="onEditing",(b=n=e.ButtonImageType||(e.ButtonImageType={}))[b.none=0]="none",b[b.custom=1]="custom",b[b.clear=2]="clear",b[b.cancel=3]="cancel",b[b.ok=4]="ok",b[b.dropdown=5]="dropdown",b[b.ellipsis=6]="ellipsis",b[b.left=7]="left",b[b.right=8]="right",b[b.plus=9]="plus",b[b.minus=10]="minus",b[b.undo=11]="undo",b[b.redo=12]="redo",b[b.search=13]="search",b[b.separator=14]="separator",b[b.spinLeft=15]="spinLeft",b[b.spinRight=16]="spinRight",b[b.collapse=17]="collapse",b[b.expand=18]="expand",n.calcel=n.cancel,(y=e.DropDownType||(e.DropDownType={}))[y.colorPicker=0]="colorPicker",y[y.dateTimePicker=1]="dateTimePicker",y[y.timePicker=2]="timePicker",y[y.monthPicker=3]="monthPicker",y[y.list=4]="list",y[y.slider=5]="slider",y[y.calculator=6]="calculator",y[y.workflowList=7]="workflowList",y[y.multiColumn=8]="multiColumn",(m=e.ButtonPosition||(e.ButtonPosition={}))[m.left=0]="left",m[m.right=1]="right",m[m.leftOfText=2]="leftOfText",m[m.rightOfText=3]="rightOfText",(g=e.CaptionAlignment||(e.CaptionAlignment={}))[g.left=0]="left",g[g.right=1]="right",(d=e.LayoutDirection||(e.LayoutDirection={}))[d.horizontal=0]="horizontal",d[d.vertical=1]="vertical",(p=e.LayoutDisplayAs||(e.LayoutDisplayAs={}))[p.inline=0]="inline",p[p.popup=1]="popup",p[p.tree=2]="tree",(f=e.CalendarPage||(e.CalendarPage={}))[f.year=1]="year",f[f.month=2]="month",f[f.day=3]="day",(h=e.CalendarStartDay||(e.CalendarStartDay={}))[h.monday=1]="monday",h[h.tuesday=2]="tuesday",h[h.wednesday=3]="wednesday",h[h.thursday=4]="thursday",h[h.friday=5]="friday",h[h.saturday=6]="saturday",h[h.sunday=7]="sunday",(c=e.GroupSort||(e.GroupSort={}))[c.none=0]="none",c[c.group=1]="group",c[c.child=2]="child",c[c.full=3]="full",(u=e.DropdownListValue||(e.DropdownListValue={}))[u.string=0]="string",u[u.array=1]="array",(l=e.PatternType||(e.PatternType={}))[l.solid=1]="solid",l[l.darkGray=2]="darkGray",l[l.mediumGray=3]="mediumGray",l[l.lightGray=4]="lightGray",l[l.gray125=5]="gray125",l[l.gray0625=6]="gray0625",l[l.darkHorizontal=7]="darkHorizontal",l[l.darkVertical=8]="darkVertical",l[l.darkDown=9]="darkDown",l[l.darkUp=10]="darkUp",l[l.darkGrid=11]="darkGrid",l[l.darkTrellis=12]="darkTrellis",l[l.lightHorizontal=13]="lightHorizontal",l[l.lightVertical=14]="lightVertical",l[l.lightDown=15]="lightDown",l[l.lightUp=16]="lightUp",l[l.lightGrid=17]="lightGrid",l[l.lightTrellis=18]="lightTrellis",(s=e.NumbersFitMode||(e.NumbersFitMode={}))[s.mask=0]="mask",s[s.overflow=1]="overflow",(a=e.TabStripPosition||(e.TabStripPosition={}))[a.bottom=0]="bottom",a[a.top=1]="top",a[a.left=2]="left",a[a.right=3]="right",(i=e.HyperlinkTargetType||(e.HyperlinkTargetType={}))[i.blank=0]="blank",i[i.self=1]="self",i[i.parent=2]="parent",i[i.top=3]="top",(r=e.SheetType||(e.SheetType={}))[r.tableSheet=0]="tableSheet"},"./dist/core/core.ns.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("./dist/core/core.res.en.js");e.SR={en:n}},"./dist/core/core.res.en.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_NotSupported="NotSupportException",e.Exp_PasteExtentIsNull="pasteExtent is null",e.Exp_InvalidPastedArea="The pasted area should have the same size as the copy or cut area.",e.Exp_MultipleSelections="This action won't work on multiple selections.",e.Exp_ChangePartOfArray="Cannot change part of an array.",e.Exp_InvalidAndSpace="Invalid {0}: {1} (must be between {2} and {3}).",e.Exp_SrcIsNull="The argument 'src' is null",e.Exp_DestIsNull="The argument 'dest' is null",e.Exp_InvalidCustomFunction="invalid custom function",e.Exp_InvalidCustomName="invalid custom name",e.Exp_IndexOutOfRange="Index is out of range!",e.Exp_InvalidRange="Invalid range",e.Exp_NotAFunction="Not A Function",e.Exp_ArgumentOutOfRange="ArgumentOutOfRange",e.Exp_PasteSourceCellsLocked="Source sheet's cells are locked.",e.Exp_InvalidCopyPasteSize="The copy and paste areas are not the same size.",e.Exp_PasteDestinationCellsLocked="The cell you are trying to change is protected and therefore read-only.",e.Exp_PasteChangeMergeCell="Cannot change part of a merged cell.",e.Tip_Row="Row: ",e.Tip_Column="Column: ",e.Tip_Height="Height: {0} pixels",e.Tip_Width="Width: {0} pixels",e.NewTab="New...",e.Exp_EmptyNamedStyle="The name of named style cannot be empty or null",e.Exp_SheetNameInvalid="The sheet name can not be blank or contains these characters : *, :, [, ], ?, \\, /",e.Exp_SheetNameConflict="That name is already taken. Try a different one.",e.Exp_ArrayFormulaSpan="Array formulas are not valid in merged cells.",e.Exp_DestSheetIsNull="destSheet is null",e.Exp_SheetIsNull="sheet is null.",e.Exp_OverlappingSpans="This operation will cause overlapping spans.",e.NeedCanvasSupport="You need a browser which full supports HTML5 Canvas to run SpreadJS",e.ARIA_Resize="resize",e.ARIA_First="first",e.ARIA_PreviousArrow="previous arrow",e.ARIA_NextArrow="next arrow",e.ARIA_Last="last",e.ARIA_PreviousButton="previous button",e.ARIA_NextButton="next button",e.ARIA_SheetTab="sheet tab",e.ARIA_NewSheet="new sheet",e.ARIA_Blank="blank",e.ARIA_Scrollbar_Left_Button="scrollbar left button",e.ARIA_Scrollbar_Top_Button="scrollbar top button",e.ARIA_Scrollbar_Thumb_Button="scrollbar thumb button",e.ARIA_Scrollbar_Right_Button="scrollbar right button",e.ARIA_Scrollbar_Bottom_Button="scrollbar bottom button",e.ARIA_Scrollbar_TRACK_Button="scrollbar track button",e.ARIA_Cell="cell",e.ARIA_HasValue="has value {0}",e.ARIA_RowHeader="row header",e.ARIA_ColumnHeader="column header",e.SHEET_NAME="Sheet",e.lsru=["","6465706c6f796d656e74"],e.lsde=["","64657369676e6572"],e.ls1=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f752063616e206f6e6c79206465706c6f792074686973204556414c554154494f4e2076657273696f6e206c6f63616c6c792e0d0a54656d706f72617279207b317d206b6579732061726520617661696c61626c6520666f722074657374696e672e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d2e"],e.ls2=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f75722074656d706f72617279207b317d206b6579206578706972657320696e207b307d206461792873292e"],e.ls3=["","4c6963656e7365204e6f7420466f756e640d0a596f75206e65656420612076616c6964206c6963656e7365206b657920746f2072756e205370726561644a532e0d0a54656d706f72617279206b6579732061726520617661696c61626c6520666f72206576616c756174696f6e2e0d0a496620796f75207075726368617365642061206c6963656e73652c20796f7572206b657920697320696e20796f757220707572636861736520636f6e6669726d6174696f6e20656d61696c2e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e6365206f7220726571756573742061206b6579206174206763676f2e746f2f736a736b65792e"],e.ls4=["","496e76616c6964206c6963656e7365206b65792e20456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e6565642068656c702e"],e.ls5=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f75722074656d706f72617279207b317d206b65792068617320657870697265642e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20666f722068656c702e"],e.ls6=["","506f776572656420627920477261706543697479205370726561644a53204576616c756174696f6e2056657273696f6e0d0a4e6f74204c6963656e73656420666f7220446973747269627574696f6e"],e.ls7=["","457863656c20494f204c6963656e7365204e6f7420466f756e640d0a596f75206e65656420612076616c6964206c6963656e7365206b657920746f2072756e205370726561644a5320457863656c20494f2e2054656d706f72617279206b6579732061726520617661696c61626c6520666f72206576616c756174696f6e2e20496620796f75207075726368617365642061206c6963656e73652c20796f7572206b657920697320696e20796f757220707572636861736520636f6e6669726d6174696f6e20656d61696c2e20456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e63652e"],e.ls8=["","496e76616c696420457863656c20494f206c6963656e7365206b65792e200d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e63652e"],e.Exp_InsertCopiedCutCells="This selection is not valid. The copy/paste area must be the same size",e.Exp_InsertCopiedCutCellsOnSpanTable="This won’t work because it would move cells in a table on your worksheet or will cause some merged cells to unmerge.",e.Exp_InsertCopiedCutCellsNoRange="New cells can not be inserted as there are non-empty cells that would extend beyond the worksheet.",e.Exp_InvalidSortArrayFormulaInRange="Can't sort current range as array formula exist.",e.Exp_InvalidSortSpanInRange="Can't sort current range as span exist.",e.Exp_InvalidSortPartTableOrMultiTableInRange="Can't sort current range as part table or more than one table exist."},"./dist/core/lc/common.js":function(t,z,W){"use strict";(function(t){var e,o,i,n,u,r,a,S,s,l,M,c,I,h,f,p,d,g,m,y,N,R,k,E,D,j,_,O,b,F;function v(t,e){var o,n,r,i,a="",s=0;for(o=0;o<t.length;o++)s=Math.max(s,t[o].length);for(o=0;o<s;o++){for(e&&(n=""),i=0;i<t.length;i++)e?n+=o>=t[i].length?"00":t[i].charAt(o)+t[i].charAt(o+1):o<t[i].length&&(a+=t[i].charAt(o));e&&(r=parseInt(n,16),a+=String.fromCharCode(r),o++)}return a}function C(e,o,n){var r,t=v(["Lcnee","iesKy"]),i=F[t];return a(i,{pK:"l6/zrbWoSbcLFwEetFh38rH3ErBZE9H+Cqix3R+wTlfA1wD5B+lUcCQn+EJ60I4RGrm0x1sFjkiLWwB0jAn6BWZv0W4WbqAKriOdeoivxDp1Wmjs3qkEDhvbsjPtfvwx2BHil6o+/tDrdMJQSGs18WZm2PoQLQuL+9VhZ4FNRHUQU3Jtioke/OZEGHJOdYVwvCGalzBad6QFOiVbDBQPePpS3++GJzOxN8SN/7lyS5/IdKiy3WJRaVGkB370+HbN6hKraDfUgReLX26yxRaKC/5aWnGAJ2NnWLoGyAGRcwT9dVjo4bcAZNrrA0U9JVKQxaSskhdv2p49XzJkltXx5w==",aC:"B0"},function(t){(r=w(t,"VIEE")).hl=!!i,r.m=i?r.m:-1,o.call(e,r),x(r,e,i,n)},function(){(r=w()).hl=!!i,r.m=i?r.m:-1,o.call(e,r),x(r,e,i,n)}),r}function w(b,v){var C,w,x,T,t,e={isVd:function(t){return t=1===F.Workbook.lm||t,this.s&&!this.e&&(!this.adr||!!this.adr.dsr==!!t)}},A=(t=S(O),function(t){var e=S("VdgJHc#wJb59"),o=S("Zdg3Ga#UHbw5");return t&&(function(t){var e=S("MlSZto#Z");return t&&t===e}(t[e])||function(t){var e=S("yXbog&w");return t&&t===e}(t[e])||function(t){var e=S("4LJITMx8UMcA"),o=S("jOxo"),n=S("JYw3Gb4NOb6x"),r=S("g1Jbww#Y"),i=RegExp("^[\\w\\-]+\\."+r+"$","i");return t&&(t===e||t===o||t===n||c.test(t)||i.test(t))}(t[o]))}(M[t]));return e[p]=A,e.s=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y;if(!b)return!1;if(!(t=b[N])||!t.length)return!1;for(n=0,r=t.length;n<r;n++)if(o=(e=t[n])&&e[k]===v){C=e[R];break}if(!o)return!1;if(b[_]&&(T=b[_]),b[j]){if(i=new Date,s=b[j],a=new Date(P(s.substr(0,4))||0,P(s.substr(4,2))-1||0,P(s.substr(6,2))||0),x=Math.ceil((a-i)/864e5),w=x<=0)return!1}else x=void 0;return!!(A||!b[E]&&!b[D]||(p=b[E],b[D],function(){var t=S(O),e=S("VdgJHc#wJb59"),o=S("Udg36Y#oUddV"),n=M[t];return n&&n[e]===o}()&&(d=S(O),g=S("1agFGc#UHbw5"),(m=M[d]&&M[d][g])&&(m=m.toLowerCase(),y=p.split(","),p&&function(t,e){var o,n,r,i;if(t&&0===t.indexOf("//")&&!((o=t.slice(2).split("/")).length<1))for(n=o[0],r=0,i=e.length;r<i;r++)if(e[r]===n)return 1}(m,y))))||(l=b[E],b[D],c=S(O),h=S("Zdg3Ga#UHbw5"),!(f=M[c]&&M[c][h])||(f=f.toLowerCase(),u=l.split(","),l&&function(t,e){var o,n,r,i,a;for(o=0,n=e.length;o<n;o++){if(r=e[o],i=!1,r&&0===r.lastIndexOf("*.",0)&&(i=!0),(r=i?r.slice(2):r)===t)return 1;if(i&&0<(a=t.indexOf("."+r))&&a===t.length-r.length-1)return 1}}(f,u)||l&&function(t,e){var o,n,r,i;if(t&&4===t.split(".").length)for(o=0,n=e.length;o<n;o++)if((r=e[o])&&0<(i=r.length-2)&&(r===t||".*"===r.substr(i)&&t.substr(0,i)===r.substr(0,i)&&I.test(t)))return 1}(f,u))))}(),e[h]=b?b[y]?-1:1:0,e[f]=C,(e[g]=w)||(e[d]=x),e[m]=T,e}function P(t){return parseInt(t,10)}function x(t,e,o,n){var r,i,a,s,l;A(t)?(t&&t.adr&&!0!==t.adr.dsr&&(r=t.adr.flg||[],i={},a=t.m,s=t.d,F.Workbook.ao(e,"adlc",{flg:r,checkRs:i,m:a,d:s,fn:T}),void 0!==i.nwm&&(t.wm=i.wm,t.nwm=i.nwm,i.dis&&((l=t.disL||[]).push(v(["",i.dis],!0)),t.disL=l),i.state&&(t[i.state[0]]=i.state[1]))),o||(i={},a=t.m,s=t.d,1!==F.Workbook.lm&&F.Workbook.ao(e,"adlc",{flg:[],checkRs:i,m:a,d:s,nl:1}),void 0!==i.nwm&&(t.wm=i.wm,t.nwm=i.nwm)),n||e.repaint&&!e.Js&&e.repaint()):L(e,t)}function T(t,e,o){var n,r=["rs"];!t||t[n=v(["",e],!0)]&&t[n][o+r]&&t[n][o+r]()}function A(t){return t&&(t.isVd(!1)||t.b&&!t.hl)}function L(t,e){var o,n;function r(){n.width=i.GC$(o).width(),n.height=i.GC$(o).height(),function(t,e,o,n){var r,i,a,s,l;if(!n||!n.isVd(!1))for(r=n.hl?(!n.adr||!n.adr.dsr)&&n.e?"l5":"l4":"l3",i=B(r,b,n),u(t,"16pt calibri"),t.fillStyle="black",t.fillRect(0,0,e,o),t.fillStyle="white",a=30,s=0;s<i.length;s++)l=i[s],t.fillText(l,20,a),a+=25}(n.getContext("2d"),n.width,n.height,e)}t.oJc||(t.oJc=!0,o=t._host,t.sheets=[],t.pJc=[],t.no(),o&&(n=document.createElement("canvas"),o.appendChild(n),r(),i.GC$(window).bind("resize",function(){setTimeout(r,100)})))}function H(t){return new e.Common.ResourceManager(o.SR).getResource()[t]}function B(t,e,o){var n,r,i,a,s,l,u,c,h=H(v([t,"s"])),f=H(1===F.Workbook.lm?v(["ld","se"]):v(["lr","su"])),p=V(h,e);for(f=V(f,e),p=(p=p.replace("{0}",o.d)).replace("{1}",f).replace("{1}",f),n=[],i=r=0;i<p.length;i++)"\r"!==p[i]&&"\n"!==p[i]||(n.push(p.substring(r,i)),"\r"===p[i]&&i<p.length-1&&"\n"===p[i+1]&&i++,r=i+1);for(r<p.length&&n.push(p.substring(r,p.length)),s=[],l=0,u=(a=o.wm||[]).length;l<u;l++)c=a[l],s.push(""),c instanceof Array?s.push(v(c,!0)):s.push(v(["",c],!0));return 1===o.m&&o.nwm?[].concat(s):o.wm&&0<o.wm.length?n.concat(s):n}function V(t,e){var o,n,r,i=!0,a="";if(t)if("string"==typeof t)(t=t.trim())&&(o=[t]);else if(Array.isArray(t)){for(n=!0,o=[],r=0;r<t.length;r++)a=t[r].trim(),o.push(a),n&&a&&(n=!1);n&&(o=null)}return o||(i=!1,o=e),v(o,i)}Object.defineProperty(z,"__esModule",{value:!0}),e=W("@grapecity/js-sheets-common"),o=W("./dist/core/core.ns.js"),i=W("./dist/core/util/domUtil.js"),n=W("./dist/core/util/common.js"),u=n.Ul.lZa,r=W("./dist/core/lc/lcValidator.js"),a=r.mJc,S=r.nJc,s="object"==typeof t&&t&&t.Object===Object&&t,l="object"==typeof self&&self&&self.Object===Object&&self,M=s||l||Function("return this")(),c=/^[\w\-]+$/i,I=/^[0-9.]+$/,h="m",f="n",p="b",d="d",g="e",m="adr",y=S("XRsZ"),N=S("HUkJ"),R=S("T&g"),k=S("Q&w"),E=S("GRz1"),D=S("XSzB"),j=S("XRwh"),_=S("WQs5"),O="JYx3Gb#8Pb5R",b=["Ivldlcneky mi pedslsgaeiycmi o edassac.","nai ies e.Ealsra.ae@rpct.o fyune sitne"],z.mJc=C,z.Gb=function(o,t){var n,e,r,i,a,s,l,u,c,h;e=(F=t).Workbook.prototype,r=e.ad,e.ad=function(){var e=this;if(C(e,function(t){e.ls=t,n=t,e.ul=function(){C(e,function(t){e.ls=t,n=t})}}),!n||A(n))return r.apply(e,arguments)},t.PivotTableManager&&(i=t.PivotTableManager.prototype,a=i.Lla,i.Lla=function(){a.apply(this,arguments),n||this.parent||C(this,function(t){n=t})}),s=t.Worksheet.prototype,l=s.ad,s.ad=function(){if(n||this.parent||C(this,function(t){n=t}),!n||A(n))return l.apply(this,arguments)},u=t.oJ.prototype,c=u.Pw,u.Pw=function(t,e){c.apply(this,arguments),(n&&(-1===n.m||!n.hl&&n.b)||n&&n.m&&n.nwm&&(1===n.m||1===n.m&&void 0===n.d))&&o(this.kj,t,e,n)},h=u.RI,u.RI=function(t,e){h.apply(this,arguments),n&&(-1===n.m||!n.hl&&n.b)&&o(this.kj,t,e,n)}},z.Hhc=L,z.e6=B,z.qJc=function(t){return H(v([t,"sa"]))}}).call(this,W("./node_modules/webpack/buildin/global.js"))},"./dist/core/lc/lcRegister.js":function(t,e,o){"use strict";var u,n,r,i,a;function s(s){if(a=null,i[0])try{var l=i[0].tc;l&&l._host&&u.mJc(l,function(t){var e,o,n,r,i,a=l.getActiveSheet();if(a&&((e=a.l)&&(t=e),s||e||t.b||-1!==t.m||!t.d||(t.s=!1,u.Hhc(l,t)),t.nwm))for(o=0,n=t.disL||[];o<n.length;o++)(r=a[n[o]])&&((i=r.adrs)&&i.apply(r))},!0)}finally{i=[]}}Object.defineProperty(e,"__esModule",{value:!0}),u=o("./dist/core/lc/releaseLc.js"),r=(n=o("./dist/core/util/domUtil.js")).GC$.sd,i=[],n.GC$[r]=function(t,e){i.push(t),e?s(e):a=a||setTimeout(s,5e3*Math.random()+3e3)}},"./dist/core/lc/lcValidator.js":function(t,e){var o,n,r=(n={},i.m=o=[function(t,s){(function(t){"use strict";var n,m,y,b,f,e,o,v;function r(t,e,o,n){return 1==t.length||t.splice(o,1,n(t.splice(e,1,n(t[o]))[0])),t}function i(t){function e(t){return function(t,e){var o=1<arguments.length&&void 0!==e?e:1,n=t.charCodeAt(0);return 65<=n&&n<=90?t.toLowerCase():97<=n&&n<=122?t.toUpperCase():48<=n&&n<=57?y(48+(n-48+10+o)%10):t}(t,-1)}var o,n=t.split("");for(o=n.length-5;0<=o;o--)r(n,o+1,o+3,e),r(n,o,o+2,e);return n.join("")}function a(t){return(m&&window.atob||function(t){var e,o,n,r,i,a,s,l=[],u=f,c=t;for(s=0;s<c.length;s+=4)e=(a=u.indexOf(c.charAt(s))<<18|u.indexOf(c.charAt(s+1))<<12|(r=u.indexOf(c.charAt(s+2)))<<6|(i=u.indexOf(c.charAt(s+3))))>>>16&255,o=a>>>8&255,n=255&a,l[s/4]=y(e,o,n),64==i&&(l[s/4]=y(e,o)),64==r&&(l[s/4]=y(e));return l.join("")})(t)}function C(t){return(m&&window.btoa||function(t){var e,o,n,r,i,a,s=[],l="",u=f,c=t,h=c.length%3;if(0<h)for(;h++<3;)l+="=",c+="\0";for(h=0;h<c.length;h+=3)o=(e=c.charCodeAt(h)<<16|c.charCodeAt(h+1)<<8|c.charCodeAt(h+2))>>18&63,n=e>>12&63,r=e>>6&63,i=63&e,s[h/3]=u.charAt(o)+u.charAt(n)+u.charAt(r)+u.charAt(i);return(a=s.join("")).slice(0,a.length-l.length)+l})(t)}function w(t){var e,o,n;return t?(e=i(t),e=e.split("").reverse().join(""),o=Math.ceil(e.length/2),e=(e=(e=e.substr(o)+e.substr(0,o)).replace("#","=")).replace("&","=="),n=e,decodeURIComponent(Array.prototype.map.call(a(n),function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""))):""}function x(t){var e,o=a(t),n=o.length,r=new b(n);for(e=0;e<n;e++)r[e]=o.charCodeAt(e);return r.buffer}function T(t){var e,o,n=new ArrayBuffer(t.length),r=new b(n);for(e=0,o=t.length;e<o;e++)r[e]=t.charCodeAt(e);return n}function A(o){return"oncomplete"in o&&(o.then=function(t,e){o.resolve=t,o.reject=e},o.oncomplete=function(t){o.resolve(o.result)},o.onerror=function(){o.reject()}),o}Object.defineProperty(s,"__esModule",{value:!0}),n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m="undefined"!=typeof window,y=String.fromCharCode,b=m&&window.Uint8Array||function(t){var e,o;if("number"==typeof t)for(e=Array(t),o=0;o<t;++o)e[o]=0;else e=t.slice(0);return(e.buffer=e).byteLength=e.length,"object"===(void 0===t?"undefined":n(t))&&t.buffer&&(e.buffer=t.buffer),e},f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e="object"==(void 0===t?"undefined":n(t))&&t&&t.Object===Object&&t,o="object"==("undefined"==typeof self?"undefined":n(self))&&self&&self.Object===Object&&self,v=e||o||Function("return this")(),s.iDe=w,s.attorn=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p=m?window.msCrypto?window.msCrypto:window.crypto:void 0,d=function(t,e){try{e="#"+e;var o=t.indexOf(e);if(-1<o)return{prefix:t.substring(0,o),licData:JSON.parse(w(t.substr(o+e.length)))}}catch(t){}return!1}(t,e.aC);if(!d)return n();function g(){return function(t){var e,o,n,r=0,i=5381,a=0;for(e=t.length-1;0<=e;e--)r=(o=t.charCodeAt(e))+(r<<6)+(r<<16)-r,i=o+((i<<5)+i),a=o+((a<<5)-a),a&=a;return(n=r^i^a)<0&&(n=~n),n.toString(16).toUpperCase()}(i+JSON.stringify(r.D))===r.H?o(r.D):n()}return r=d.licData,i=d.prefix+"#"+e.aC,h=x((f=i+JSON.stringify(r.D),C(encodeURIComponent(f).replace(/%([0-9A-F]{2})/g,function(t,e){return y(parseInt(e,16))})))),a=y.apply(null,new b(h)),s=w("JYx3Gb#8Pb5R"),l=w("VdgJHc#wJb59"),(!v[s]||!v[s][l]||location.protocol.match(/^https/i))&&p&&p.subtle?(u={alg:"RS256",e:"AQAB",kty:"RSA",n:e.pK.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,"")},u=window.msCrypto?T(JSON.stringify(u)):u,c={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},void A(p.subtle.importKey("jwk",u,c,!1,["verify"])).then(function(t){A(p.subtle.verify(c,t,x(r.S),T(a))).then(function(t){return t?o(r.D):n()})},function(){return g()})):g()}}).call(s,function(){return this}())}],i.c=n,i.p="dist",i(0));function i(t){if(n[t])return n[t].exports;var e=n[t]={exports:{},id:t,loaded:!1};return o[t].call(e.exports,e,e.exports,i),e.loaded=!0,e.exports}t.exports={mJc:r.attorn,nJc:r.iDe}},"./dist/core/lc/releaseLc.js":function(t,e,o){"use strict";var b,n,v,C,w;function r(e,t,o,n){var r,i,a,s,l,u,c,h,f=e.am(),p=e.parent,d="11pt calibri",g=n.hl&&n.isVd(!1)&&n.d,m=p&&p.jDc,y="";for(g?r="l2":n.e?r="l5":n.hl&&!n.d?r="l6":(r="l1",i=b.qJc(r)),f=f||e.am(),a=b.e6(r,C,n),s=0,i&&a.forEach(function(t){s=w(s,e.dp(t,d))}),e.l=a[0]?n:void 0,l=0;l<a.length&&(203<f.width||203<f.height)&&!m;l++)y=a[l],u=s||e.dp(y,d),c=f.width-u-10,h=f.height-10-20*(a.length-l),o&&!o.intersect(c,h,u,20)||(t.save(),t.fillStyle="rgba(0, 0, 0, 0.5)",v(t,d),o&&(t.rect(o.x,o.y,o.width,o.height),t.clip(),t.beginPath()),t.fillText(y,c,20+h),y&&(e.l=n),t.restore())}Object.defineProperty(e,"__esModule",{value:!0}),b=o("./dist/core/lc/common.js"),n=o("./dist/core/util/common.js"),v=n.Ul.lZa,C=["LcneNtFud\no edavldlcnekyt u pedSet.\neprr esaeaalbefreauto.\nfyuprhsdalcne orkyi nyu ucaecnimto mi.\nmi sslsgaeiycmi o edassac.","ies o on\rYune  ai ies e ornSra.hes\rTmoayky r vial o vlain\rI o ucae  ies,yu e si orprhs ofraineal\rEalu.ae@rpct.o fyune sitne"],w=Math.max,e.Gb=function(t){b.Gb(r,t)},e.Soa=1,e.mJc=b.mJc,e.Hhc=b.Hhc},"./dist/core/util/basedialog.js":function(t,e,o){"use strict";var n,r,p,i,a,s,d,l,u;function c(t,e,o){this.c4="gc-popup",this.so="gc-overlay",this.AWa=null;var n=this;n._host=t,n.zWa=o,e=e||0,n.to={position:"fixed",width:"100%",height:"100%",margin:0,padding:0,top:0,left:0,border:"none",zIndex:e,backgroundColor:"rgba(0,0,0,0)"},n.uo={position:"absolute",padding:0,margin:0,height:"auto",zIndex:e+1,outline:"none"},n.ad()}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/util/common.js"),r=o("./dist/core/util/domUtil.js"),p=r.GC$,i=n.util.Nl,a=n.util.Ml,s=n.util.nl,d=document,l=window,u=l.Yl,c.prototype.ad=function(){var t=this;t.vo(t.Cj)?t.xo=p("#"+t.Cj):(t.Cj=t.wo(),t.xo=p(i("div")).addClass(t.c4+" ui-widget").attr({id:t.Cj,tabIndex:-1}).css(t.uo))},c.prototype.wo=function(){for(var t=0,e="gc-dialog";this.vo(e+t);)t++;return e+t},c.prototype.yo=function(){if(this.xo)return this.xo},c.prototype.zo=function(){return this._host?this._host:d.body},c.prototype.Ao=function(t){var e=this,o=e.xo;e.Bo()||e.Co(),u.Gm(),e.vo(e.Cj)||(p(e.zo()).append(o),e.Do(),o.css("display","none")),o.show(t)},c.prototype.cXa=function(){return"block"===this.xo.css("display")},c.prototype.close=function(){var t=this;t.vo(t.Cj)&&t.xo.remove(),p("."+t.c4).isVisible()||t.Eo(),u.Hm()},c.prototype.Eo=function(){p("."+this.so).remove(),this.AWa=null},c.prototype.Do=function(){var t,e,o,n,r,i,a,s,l,u,c,h=this.xo,f=this.zo();0!==h.length&&(t=p(f).offset(),e=parseInt(h.css("left"),10)+t.left,o=parseInt(h.css("top"),10)+t.top,n=h.width(),r=h.height(),isNaN(e)||isNaN(o)||isNaN(n)||isNaN(r)||(a=i=0,l=(s=d.documentElement).clientWidth,u=s.clientHeight,(c=h[0].getBoundingClientRect()).left+n>l&&(a=c.left+n-l),c.top+r>u&&(i=c.top+r-u),(e<0||o<0||0<i||0<a)&&((e-=a)<0&&(e=0),(o-=i)<0&&(o=0),h.css({left:e-t.left+"px",top:o-t.top+"px"}))))},c.prototype.vo=function(t){return 0<p("#"+t).length},c.prototype.Co=function(){var e,o,n=this,r=p(i("div")).addClass(n.so),t=n.xo;(this.AWa=r).css(n.to),p(n._host).append(r),(e=a&&a.mozilla)&&(o=(new Date).valueOf()),r.bind("mousedown",function(t){if(!n.zWa){if(e&&(new Date).valueOf()-o<100)return;n.close(),e&&n.Fo&&clearTimeout(n.Fo)}s(t)}),r.bind("contextmenu",function(t){n.zWa&&s(t)}),t.bind("contextmenu",function(t){s(t)}),"touchstart MSPointerDown pointerdown".split(" ").forEach(function(t){r.bind(t,function(t){n.zWa||(e?n.Fo=l.setTimeout(function(){n.close()},100):n.close()),s(t)})})},c.prototype.Bo=function(){return 0<p("."+this.so).length},e.Go=c},"./dist/core/util/common.js":function(t,n,e){"use strict";var p,o,r,E,d,C,i,g,h,m,y,D,a,s,u,f,b,l,v,j,c,_,O,w,x,F,T,A,S,M,I,N,R,k,P,L,H,B,V,z,W,G,U,J,Z,q,K,Y,Q;function X(t){return void 0!==t}function $(t){return b.createElement(t)}function tt(t){b.body&&b.body.insertBefore(t,j)}function et(t){return t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.cancelBubble=!1,t.returnValue=!1),!1}function ot(t){var e,o,n=!1;if(t)for(e=0;e<t.length;e++)if(11904<=(o=t.charCodeAt(e))&&o<12032||12288<=o&&o<40960||43360<=o&&o<43392||63744<=o&&o<64256){n=!0;break}return n}function nt(){}function rt(){}function it(t,e){var o=$("span");return o.className=t,e&&(o.id=e),o.style.display="none",tt(o),o}function at(t,e,o,n){t.addEventListener(e,o,n)}function st(t){var e=t.currentStyle,o=b.defaultView;return o&&o.getComputedStyle&&(e=o.getComputedStyle(t,"")),e}function lt(t){var e,o,n,r,i,a,s=f.Yl;0<s.jm||(16!==t.keyCode&&(s.XCb=!0),(o=(e=B.Xl())&&e.lm)&&C(o).isVisible()||e&&e._eventHandler&&e._eventHandler.nm&&(e._eventHandler.nm(t),e.isEditing()||(n=t.keyCode,r=t.ctrlKey,i=t.altKey,a=t.shiftKey,90!==n&&89!==n||!r||i?86!==n||!r||i||a||t.stopPropagation&&t.stopPropagation():et(t))))}function ut(t){var e,o=f.Yl;0<o.jm||(o.XCb=!1,(e=B.Xl())&&e._eventHandler&&e._eventHandler.om&&e._eventHandler.om(t))}function ct(t){var e;0<f.Yl.jm||(e=B.Xl())&&e._eventHandler&&e._eventHandler.pm&&e._eventHandler.pm(t)}function ht(t){var e,o=f.Yl;0<o.jm||(!0===o.XCb||(e=B.Xl())&&e._eventHandler&&e._eventHandler.pm&&e._eventHandler.pm(t))}function ft(t){return b.all===v&&B.Xl()&&et(t),!1}function pt(t,e,o,n){this.row=t,this.rowCount=o,this.col=e,this.colCount=n}function dt(t,e,o,n){this.x=t,this.y=e,this.width=o,this.height=n}function gt(t,e){this.x=t,this.y=e}function mt(){}function yt(){this.jm=0,this.km=[],this.XCb=!1,this.ad()}function bt(t,e){var o=O(t.row,e.row),n=O(t.col,e.col),r=w(t.row+t.rowCount-1,e.row+e.rowCount-1),i=w(t.col+t.colCount-1,e.col+e.colCount-1);return 0<=o&&0<=n?new z(o,n,r-o+1,i-n+1):0<=o?new z(o,-1,r-o+1,-1):0<=n?new z(-1,n,-1,i-n+1):new z(-1,-1,-1,-1)}function vt(){}function Ct(t){this.kj=t}function wt(){}function xt(){}function Tt(t){var e=t.An||{scaleX:1,scaleY:1,translateX:0,translateY:0,skewX:0,skewY:0,orgTranslateX:0,orgTranslateY:0};return t.An=e}function At(){}function St(t,e){t&&(t.Gn=e)}function Mt(t,e){t&&(t.Hn=e)}function It(){}function Nt(){return J.Yn||(J.Yn=$("canvas").getContext("2d")),J.Yn}function Rt(t){var e,o,n,r=[],i=0,a=M;for(e=0;e<t.length;e++)r[i]===v&&(r[i]=""),o=t.charAt(e),n="",e+1<t.length&&(n=t.charAt(e+1)),o===a&&n!==a||"-"===o&&"-"!==n?(r[i]+=o,i++):r[i]+=o;return r}function kt(t){for(var e=t.length-1;" "===t.charAt(e);)e--;return e!==t.length-1&&(t=t.substring(0,e+1)),t}function Et(t){var e,o=t instanceof Array?[]:{};for(e in t)t.hasOwnProperty(e)&&(o[e]="object"==typeof t[e]&&t[e]!==j?Et(t[e]):t[e]);return o}function Dt(t,e,o,n,r){var i,a,s,l,u,c,h,f,p=[],d=r||Nt();if(!d)return p;for(a=o?(s=t.length*n,_(e/n)):(i=(s=H(d,d.font,t))/t.length,_(e/i));e<s&&t;)for(l=!1,u=a;;){if(t.length<u){p.push(t),t="";break}if(c=t.substring(0,u),h=o?u*n:H(d,d.font,c),"-"===c.charAt(c.length-1)&&(h=o?u*n:H(d,d.font,c)-H(d,d.font,"-")),h===e||l&&h<e){p.push(c),t=t.substring(u),s-=h;break}if(e<h){if(1===c.length){t.substring(c.length).trim()?(p.push(c),t=t.substring(u),s-=h):(p.push(t),t="");break}--u,l=!0}else u+=f=1<=(f=o?(e-h)/n:(e-h)/i)?f:1}return t&&-1===t.search(/^[ ]*$/)&&p.push(t),p}function jt(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m=i||Nt();if(!m)return[t];for(a=[],l=e,u=[],c=s=0;c<t.length;c++)if(h=t[c].style&&t[c].style.font||r,f=L.fp(h),t[c].text&&0<t[c].text.length?s+=n?f*t[c].text.length:H(m,h,t[c].text):s=0,s<l)u.push(t[c]);else for(s-=n?f*t[c].text.length:H(m,h,t[c].text),p=0;p<t[c].text.length;p++){if(o<(d=n?f:H(m,h,t[c].text.charAt(p)))&&0===p){0<u.length&&(a.push(u),u=[]),u.push({style:t[c].style,text:t[c].text.substring(0,1)}),a.push(u),u=[],(g=t[c].text.substring(1,t[c].text.length)).length&&t.splice(c+1,0,{style:t[c].style,text:g}),s=0,l=o;break}if(l<(s+=d)){u.push({style:t[c].style,text:t[c].text.substring(0,p)}),a.push(u),u=[],(g=t[c].text.substring(p,t[c].text.length)).length&&t.splice(c+1,0,{style:t[c].style,text:g}),s=0,l=o;break}}return 0<u.length&&a.push(u),a}function _t(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y,b,v=[],C=Rt(t),w=r||Nt();if(!w)return v;for(i=H(w,w.font,t),a=o?n:i/t.length,s=F(e/a+"",10),h=c=u=l=0,p=!(f=[]);h<C.length;){if(!1===p){if(d=C[h],f.push(d),(u+=d.length)<s&&h<C.length-1){h++;continue}c=u,u=0}if(g=o?f.join("").length*n:J.Xn(f.join(""),w.font,!0,w),"-"===f.join("").charAt(f.join("").length-1)&&(g=o?f.join("").length*n:H(w,w.font,f.join(""))-H(w,w.font,"-")),e<g)if(m=f.pop(),0===f.length){for(y=Dt(m,e,o,n,w),b=0;b<y.length-1;b++)v[l]=y[b],l++;1===y.length&&(v[l]=y[0],l++),2<=y.length?C[h]=y[y.length-1]:h++,p=!1}else p=!0,h--;else g<e&&!0===p||g===e?(p=!1,v[l]=kt(f.join("")),l++,f=[],h++):g<e&&(h++,u=c)}return 0!==f.length&&(v[l]=kt(f.join(""))),v}function Ot(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g=[],m=r||Nt();if(!m)return g;if(0===t.length)return g.push({textLength:0,text:"",textInfos:[{style:{font:o},text:""}]}),g;for(a=[],s=i=0;s<t.length;s++){for(l=t[s],c=u=0;c<l.length;c++)h=l[c].style&&l[c].style.font?l[c].style.font:o,n?u+=L.fp(h)*l[c].text.length:D(l[c].text)||(u+=H(m,h,l[c].text));if(e<u){for(0<a.length&&(g.push({textLength:i,text:kt(Pt(a)),textInfos:Et(a)}),a=[],i=0),f=jt(l,e-i,e,n,o,m),a=a.concat(f[0]),D(f[0])||g.push({textLength:i+Ft(f[0],o,n,m),text:kt(Pt(a)),textInfos:Et(a)}),a=[],i=0,p=1;p<f.length-1;p++)D(f[p])||g.push({textLength:Ft(f[p],o,n,m),text:kt(Pt(f[p])),textInfos:Et(f[p])});1<f.length&&(d=f[f.length-1],a=a.concat(d),D(d)||(i+=Ft(d,o,n,m)))}else e<i+u?(g.push({textLength:i,text:kt(Pt(a)),textInfos:Et(a)}),a=(a=[]).concat(l),i=u):(a=a.concat(l),i+=u)}return 0<a.length&&g.push({textLength:i,text:kt(Pt(a)),textInfos:Et(a)}),g}function Ft(t,e,o,n){var r,i,a=0,s=n||Nt();for(r=0;r<t.length;r++)i=t[r].style&&t[r].style.font||e,a+=o?L.fp(i)*t[r].text.length:H(s,i,t[r].text);return a}function Pt(t){var e,o="";for(e=0;e<t.length;e++)o+=t[e].text;return o}function Lt(){}function Ht(){this.JTa={}}function Bt(){}function Vt(t){return t&&"SPAN"===t.tagName}function zt(t){return t&&"BR"===t.tagName}function Wt(t){return t instanceof Text}function Gt(t){if(t){var e=t.childNodes;return Vt(t)&&2===e.length&&zt(e[0])&&Ut(e[1])}return!1}function Ut(t){if(t&&Wt(t)){var e=t.textContent;if(1===e.length&&Zt(e[0]))return!0}return!1}function Jt(t,e,o,n){return t.substr(0,e)+n+t.substr(o,t.length-o)}function Zt(t){return t===P}function qt(t,e){for(var o=t&&t.previousSibling;o;){if(e(o))return o;o=o.lastChild}return j}Object.defineProperty(n,"__esModule",{value:!0}),p=e("@grapecity/js-sheets-common"),o=e("./dist/core/util/domUtil.js"),r=e("./dist/core/core.ns.js"),E=e("./dist/core/core.enum.js"),d=e("@grapecity/js-calc"),C=o.GC$,i=C.extend,g=p.Common.o,h=p.Common.k.Uo,m=p.Formatter&&p.Formatter.GeneralFormatter,y=p.Formatter&&p.Formatter.lxb,D=p.Common.j.Fa,a=p.Common.u,s=new p.Common.ResourceManager(r.SR),u=s.getResource.bind(s),n.FallbackFontFamily='"Helvetica Neue", Arial, sans-serif',f=window,b=document,l="boolean",v=void 0,j=null,c=Math.floor,_=Math.ceil,O=Math.min,w=Math.max,x=Math.round,F=parseInt,T=parseFloat,A=isNaN,S="px",M=" ",I="string",N="number",R=RegExp("^/Date\\((-?\\d+)([-+]{1}\\d+)?\\)/\\s*$"),k=RegExp("^/OADate\\(([-+]?(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)\\)/\\s*$"),P="​",n.productInfo={productVersion:"14.2.0"},n.CursorResource={ResizeCol:"col-Resize",ResizeRow:"row-resize",ResizeHiddenCol:"w-resize",ResizeHiddenRow:"n-resize"},n.getTypeFromString=function(t){var e,o,n,r=!1,i=f;if(typeof t==I){for(o=0,n=(e=t.split(".")).length;o<n&&i;o++)i=i[e[o]];i&&o===n&&0<n&&(r=!0)}return r?i:v},n.findControl=function(t){return typeof t==I&&(t=b.getElementById(t)),C(t).data("workbook")},rt.xq=function(t){for(var e,o="";0<t;t=parseInt((t-1)/26+"",10))e=(t-1)%26,o=String.fromCharCode(65+e)+o;return o},rt.ol=function(t,e,o,n){if(3===t){var r=C.getType(e);t=o&&"@"===o?0:r===l?1:r===N||"date"===r||r===I&&rt.YGb(e)?2:0,n&&0!==n&&(0<n?t=0:n<0&&(t=2),-90===n?t=0:90===n&&(t=2))}return t},rt.YGb=function(t){return rt.ZGb.test(t)},rt.bc=function(t){var e,o=C.getType(t);return t=t===j||t===v?"":o===l?(""+t).toUpperCase():"date"===o?(e=0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds(),p.Common.l.Vb(t,e?"M/d/yyyy":"M/d/yyyy h:mm:ss")):t.richText?rt.K_a(t):""+t},rt.ql=function(t,e,o,n,r,i,a){var s,l,u,c,h,f,p=C(t),d=e,g=o,m="background-position",y="background-size",b="auto",v="0%";switch(i){case 0:a?p.css(m,a.position).css(y,a.size):p.css(m,v+M+v).css(y,"100%"+M+"100%");break;case 1:l=s="50%",d<n&&(s=v),g<r&&(l=v),p.css(m,s+M+l).css(y,b+M+b);break;case 2:h=d,(c=u=0)<(f=g)&&0<r&&n/r<d/g?u=u+d/2-(h=n/r*g)/2:0<d&&0<n&&r/n<g/d&&(c=c+g/2-(f=r/n*d)/2),p.css(m,u+S+M+c+S).css(y,h+S+M+f+S);break;case 3:p.css(m,v+M+v).css(y,b+M+b)}},rt.device=function(){var t,e,o,n,r=navigator.userAgent,i=r.match(/iPad/i);if(i)(t=i[0])&&(e="ipad"===t.toLowerCase());else if((i=r.match(/Macintosh/i))&&(t=i[0]))try{document.createEvent("TouchEvent"),e="macintosh"===t.toLowerCase()}catch(t){}return(i=r.match(/iPhone/i))&&(t=i[0])&&(o="iphone"===t.toLowerCase()),(i=r.match(/android/i))&&(t=i[0])&&(n="android"===t.toLowerCase()),{ipad:e,iphone:o,android:n}},rt.sl=function(){var t=navigator.platform;return t&&-1<t.indexOf("Mac")},rt.tl=function(t){if(t===v||t===j)return!1;var e=""+t;return e=g.Oa(e),!A(+(""===e.trim()?NaN:e))||/^[1-9]\d{0,2}(?:(,\d{3})*|\d*)(?:\.\d*)?$/.test(e)},rt.ul=function(t,e,o,n,r){var i,a,s,l,u,c,h=j,f=!1;if(t&&((i=t.formatter)?(r?h=r:rt.lHb(i)||(h=i,f=!0),typeof h==I&&m&&(h=new m(h))):h=t._autoFormatter),h&&!h.isAuto){a=j;try{if(a=h.parse(e),f&&a instanceof Date&&(s=(new m).getPreferredDisplayFormatter(e,r))&&(a=s.parse(e)),typeof a==N)return a}catch(t){}return a===v||a===j?e:a}if(o){if(l=void 0,l={},u=void 0,c=j,m)try{c=(new m).getPreferredDisplayFormatter(e,l)}catch(t){}return typeof(u=l.value)==N?e=u:rt.tl(e)&&(u=l.value=e),n&&(n.value=c),u!==v&&u!==j?u:e}return e},rt.vl=function(t){for(var e,o,n=b.body,r=t;r&&r.parentElement&&r.parentElement!==n;)r=r.parentElement;return e=1e3,r&&r.parentElement===n&&(o=F(C(r).css("z-index")),A(o)||(e+=o)),e},rt.wl=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g;if(!t)return[];if(e=t.indexOf("("),o=t.lastIndexOf(")"),!(n=t.substring(e+1,o)))return[];for(r=[],a="",l=s=i=0;l<n.length;)s=n.indexOf("rgb",i),-1===(l=n.indexOf("rgb",i+1))&&(l=n.length),a=n.substring(s,l),r.push(a),i=l;for(u=[],c=0,h=r.length;c<h;c++)p=(f=r[c]).indexOf(")"),d=f.substring(0,p+1),g=T(f.substring(p+1,f.length)),A(g)&&(c===h-1?g=100:c<=1&&(g=0)),!d&&0===c||(g/=100,u.push({color:d,point:g}));return u},rt.xl=function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I=e._render,N=0,R=[o],k=e.zoom();for(n===E.AutoFitType.cellWithHeader&&(o===E.SheetArea.viewport?R.push(1):o===E.SheetArea.rowHeader&&R.push(0)),i=0;i<R.length;i++)for(a=0,s=R[i],l=r||e.getRowCount(s);0<=a&&a<l;)if((u=e._modelManager.findSpan(a,t,s))&&(u.col<t||1<u.colCount||u.row<a))a=u.row+u.rowCount;else{if(0<e.getRowHeight(a,s)){if(h=0,(f=(c=e.getActualStyle(a,t,s)).cellType||e.Al(s))&&(p=c.font||I.Bl(),c.font=I.Cl(p),(g=!(!(d=e.rowFilter&&e.rowFilter())||!d.Dl(a,t,s)))||3!==s||(m=e.tables?e.tables.find(a,t):j)&&m.showHeader()&&m.headerIndex()===a&&m.rowFilter()&&m.filterButtonVisible(t-m.range().col)&&(g=!0),y=c.formatter?c.formatter:c._autoFormatter,b={sheet:e,row:a,col:t,sheetArea:s,quotePrefix:c.quotePrefix},v={},C=e.getValue(a,t,s,E.ValueType.richText),w=e.xHb(a,t,o),x=C&&C.richText?e.getText(a,t,s):D(w)?f.format(C,y,v,b):w,h=f.X4(C,x,c,k,b),g&&(T=O(k,1),h+=F(""+e.defaults.rowHeight*T,10))),A=c.cellButtons,r&&A)for(S=0;S<A.length;S++)(M=A[S]).imageSize&&(h+=M.imageSize.width+7);N<h&&(N=h)}s===E.SheetArea.viewport?a=rt.El(a,t,e,s):a++}return 0===N?N=e.defaults.colWidth:N+=_(3),_(N)},rt.El=function(t,e,o,n){var r,i,a=-1,s=o.getRowCount(n);for(r=t+1;r<s;r++){if(o.getText(r,e,n)){a=r;break}if((i=o.getActualStyle(r,e,n))&&(i.cellType||i.cellButtons&&0<i.cellButtons.length)){a=r;break}}return a},rt.Fl=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g=e._render,m=0,y=[o],b=e.zoom();for(1===n&&(3===o?y.push(2):1===o&&y.push(0)),r=0;r<y.length;r++)for(o=y[r],i=0,a=e.getColumnCount(o);0<=i&&i<a;)(s=e._modelManager.findSpan(t,i,o))&&(s.row<t||1<s.rowCount||s.col<i)?i=s.col+s.colCount:(0<e.getColumnWidth(i,o)&&(u=(l=e.getActualStyle(t,i,o)).font||g.Bl(),l.font=g.Cl(u),c=0,(h=e.getCellType(t,i,o))&&(f=e.getText(t,i,o),p=e.getValue(t,i,o,1),d={sheet:e,row:t,col:i,sheetArea:o},c=h.Y4(p,f,l,b,d)),m<c&&(m=c)),3===o?i=rt.Gl(t,i,e,o):i++);return 0===m?m=e.defaults.rowHeight:m+=_(3),_(m)},rt.Gl=function(t,e,o,n){var r,i,a=-1,s=o.getColumnCount(n);for(r=e+1;r<s;r++){if(o.getText(t,r,n)){a=r;break}if((i=o.getActualStyle(t,r,n))&&i.cellType){a=r;break}}return a},rt.Il=function(t,e,o,n){var r,i,a,s,l,u,c,h,f;if(o&&(r=o.Jl,i=o.Kl,a=t.formatter?t.formatter:t._autoFormatter,s=n||{},m&&e!==j&&e!==v))if(l=void 0,a&&a.isAuto)l=typeof e==N,u=rt.tl(e),!l&&u&&(e=g.Oa(e)),e=a.getPreferredEditingFormatter?a.getPreferredEditingFormatter(e).format(e):e;else if(typeof a!=I||rt.lHb(a)||(a=new m(a)),a)try{e instanceof Date?((c=d&&d.Convert.Wh(e))&&(e=c),h=p.Common.CultureManager.q4().DateTimeFormat,f=p.Common.l.Ra(e),a=new m(!y.Lc(a.formatString(),["d","y"])&&0<=f&&f<1?h.longTimePattern:0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds()?h.shortDatePattern:h.shortDatePattern+M+h.longTimePattern),o.Ll=!0,e=a.format(e),s.formatter=a):typeof e==N&&(e=g.nb(""+e))}catch(t){e=o.getText(r,i)}else e=o.getText(r,i,3);return e!==j&&e!==v&&(e=rt.bc(e)),e},rt.ZXc=function(t,e,o,n){var r,i,a,s,l,u,c;if(o&&(r=t.formatter?t.formatter:t._autoFormatter,i=n||{},m&&e!==j&&e!==v))if(a=void 0,r&&r.isAuto)a=typeof e==N,s=rt.tl(e),!a&&s&&(e=g.Oa(e)),e=r.getPreferredEditingFormatter?r.getPreferredEditingFormatter(e).format(e):e;else if(typeof r!=I||rt.lHb(r)||(r=new m(r)),r)try{e instanceof Date?((l=d&&d.Convert.Wh(e))&&(e=l),u=p.Common.CultureManager.q4().DateTimeFormat,c=p.Common.l.Ra(e),e=(r=new m(!y.Lc(r.formatString(),["d","y"])&&0<=c&&c<1?u.longTimePattern:0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds()?u.shortDatePattern:u.shortDatePattern+M+u.longTimePattern)).format(e),i.formatter=r):typeof e==N&&(e=g.nb(""+e))}catch(t){}return e!==j&&e!==v&&(e=rt.bc(e)),e},rt.$Xc=function(t,e,o){var n,r,i,a,s,l="";if(t)if(r=(n=t.parent)&&n.options,(i=t.getFormulaInformation(e,o))&&i.hasFormula){if(l="="+i.formulaWithCulture,i.isDynamicArray)return""}else a=t.getActualStyle(e,o),l="string"==typeof(s=t.getValue(e,o))&&a.quotePrefix||0<l.length&&"="===l[0]&&r&&r.allowUserEditFormula?"'"+s:rt.ZXc(a,s,t)||"";return l},rt.yIc=function(t,e){var o=t,n=p.Common.CultureManager.q4(e).NumberFormat;return!(!n||!n.percentSymbol||!t)&&("object"==typeof t&&t.formatCached&&(o=t.formatCached),"object"!=typeof o&&"string"==typeof o&&0<g.Hja(o).fb)},rt._Va=function(t){var e,o=rt.Ml.msie||rt.Ml.edge,n=o&&f.MSPointerEvent&&1<(navigator.msMaxTouchPoints||0);return t?n:(e=o&&f.PointerEvent&&1<(navigator.maxTouchPoints||0),n||e)},rt.K_a=function(t){return t&&t.richText&&0<t.richText.length?(t.text||(t=rt.n0a(t)),t.text):t},rt.n0a=function(t){var e,o,n;if(!t)return t;if((e=t.richText)&&0<e.length){for(o=[],n=0;n<e.length;n++)o.push(e[n].text?e[n].text:"");t.text=o.join("")}return t},rt.lHb=function(t){return"string"==typeof t&&("="===t.charAt(0)||0<=t.indexOf("{{")&&0<=t.indexOf("}}"))},rt.Pl=function(t,e,i,a){function o(t,e){var o,n,r=this;return r.hasOwnProperty("_ps")||(r._ps={}),o=r._ps,0===arguments.length?o[s]!==v?o[s]:l:(!1!==e&&a&&!a.call(r,t)||(n=o[s]!==v?o[s]:l)!==t&&(o[s]=t,!1!==e&&i&&i.call(r,t,n)),r)}var s=t,l=e;return o.isDefault=function(t){return t===l},o},rt.Ql=function(t,r){var i={_ps:{}};return p.Common.j.H(t,function(t){var e,o,n;e=i,o=t,n=r,Object.defineProperty(e,o,{get:function(){return this._ps[o]},set:function(t){var e=this._ps[o];e!==t&&(this._ps[o]=t,n&&n(o,t,e))},enumerable:!0})}),i},rt.Rl=function(t,e,o,n,r){var i,a=O(e,o),s=w(e,o),l=0;for(i=a;i<s&&(l+=n?t.Sl(i,3):t.Tl(i,3),!(r&&r<l));i++);return l},rt.YIc=function(t,e,o,n,r){var i,a,s=O(e,o),l=w(e,o),u=0;for(i=s;i<l&&(n?(a=t.Er(i),t.getViewportTopRow(a)<=i&&t.getViewportBottomRow(a)>=i&&(u+=t.Sl(i,3))):(a=t.Fr(i),t.getViewportLeftColumn(a)<=i&&t.getViewportRightColumn(a)>=i&&(u+=t.Tl(i,3))),!(r&&r<u));i++);return u},rt.Z3=function(t,e){var o,n,r=0,i=0;return t!==e&&(o=C(t).offset(),n=C(e).offset(),r=o.left-n.left,i=o.top-n.top),{FB:i,EB:r}},rt.bq=function(t,e,o,n){var r,i,a,s,l=n||{};if(!t||"string"!=typeof t)return l.message=u().Exp_SheetNameInvalid,!1;for(i=0;i<t.length;i++)if("*"===(r=t.charAt(i))||":"===r||"["===r||"]"===r||"?"===r||"\\"===r||"/"===r)return l.message=u().Exp_SheetNameInvalid,!1;if("'"===t.charAt(0)||"'"===t.charAt(t.length-1))return l.message=u().Exp_SheetNameInvalid,!1;if(!e)return!0;for(a=e.length,i=0;i<a;i++)if(o!==(s=e[i])&&t.toUpperCase()===s.name().toUpperCase())return l.message=u().Exp_SheetNameConflict,!1;return!0},rt.Ika=function(t,e,o){var n,r,i;if(!t)return t;for(n=0,r=t.length,i=[];n<r;)t[n]===e?i[n]=o:i[n]=t[n],n++;return i.join("")},rt.tt=function(){var t,e,o,n=rt;return n.ct||(o="-10000px",(e=(t=$("span")).style).visibility="hidden",e.top=o,e.left=o,e.position="absolute",t.setAttribute("gcUIElement","gcStringWidthSpan"),b.body.insertBefore(t,j),n.ct=t),n.ct},rt.fp=function(t,e,o){var n,r,i,a=rt,s=a.st;if(!e)if(s){if(o&&(s=s.CJKFontCache),n=s[t])return n}else s=a.st={CJKFontCache:{}},o&&(s=s.CJKFontCache);return(r=a.tt()).style.font=rt.hZa(t),rt.Ml&&rt.Ml.safari&&(r.style.lineHeight="normal"),r.innerHTML=o?String.fromCharCode(20013):"H",i=r.offsetHeight,e||(s[t]=i),i},rt.Pxb=function(t){var e,o,n=rt,r=n.Qxb;if(r){if(r[t])return r[t]}else r=n.Qxb={};return(o=n.tt()).style.font=t,o.innerHTML="H",(e={}).fontFamily=o.style.fontFamily,e.fontSize=o.style.fontSize,e.fontStyle=o.style.fontStyle,e.fontWeight=o.style.fontWeight,r[t]=e},rt.Voa=function(t,e){var o=rt.tt();return o.style.font=rt.hZa(e),rt.Ml&&rt.Ml.safari&&(o.style.lineHeight="normal"),o.innerHTML=a.Ob(t||"H"),o.offsetHeight},rt.iZa=function(t){var e,o=rt;return 0<=t.indexOf(n.FallbackFontFamily)?t:(t=t.replace("("+String.fromCharCode(27491)+String.fromCharCode(25991)+")","").replace("(Body)","").replace("("+String.fromCharCode(26631)+String.fromCharCode(39064)+")",""),(e=o.tt().style).font=t,e.fontFamily=[].concat(e.fontFamily.split(","),n.FallbackFontFamily.split(",")).join(","),e.font)},rt.hZa=function(t){var e,o=rt;return t&&o.jZa?(e=(e=o.kZa)||(o.kZa={}))[t]||(e[t]=o.iZa(t)):t},rt.lZa=function(t,e){e&&(e=rt.hZa(e),t.font!==e&&(t.font=e))},rt.pL=function(t,e,o){return!e||D(o)?0:(rt.lZa(t,e),t.measureText(o).width)},rt.no=function(){var t=rt,e=t.ct;e&&(C(e).remove(),t.ct=v),t.st=v,t.Qxb=v,rt._0&&(rt._0=v),t.kZa=v},rt.Woa=function(t){var e,o=rt._0;return o=o||(rt._0=$("div")),e=t.innerHTML,o.innerHTML=e,o.innerText},rt.G$a=function(t){return t&&/^[A-Za-z_\\\u0080-\uFFFF][A-Za-z0-9_\.\\\?\u0080-\uFFFF]*$/.test(t)&&!(-1!==["C","c","R","r"].indexOf(t)||/^[A-Za-z]{1,3}(\$)?\d+$/.test(t)||/^[Rr]\d*[Cc]\d*$/.test(t)||255<=t.length)},rt.T$a=function(t){t&&(t.j_a(!0),t.initExpression(),t.k_a())},rt.l_a=function(t){var e,o,n=0,r=0,i=t.length;for(0<i&&(n=t[0].row,r=t[0].col),e=1;e<i;e++)n>(o=t[e]).row&&(n=o.row),r>o.col&&(r=o.col);return{r:n=n<0?0:n,c:r=r<0?0:r}},rt.w0a=function(t){var e;return typeof t==I&&"/"===t.charAt(0)?(e=void 0,k.test(t)?(e=t.match(k),p.Common.l.Xb(T(e[1]))):R.test(t)?(e=t.match(R),new Date(T(e[1]))):t):t},rt.x0a=function(t){return!D(t)&&p.Common.l.Ska(t)?p.Common.l.Daa(t):t},rt.yHb=function(t,e){var o,n,r=t.getImageData(e.x,e.y,e.width,e.height),i=r.data;for(o=0;o<i.length-4;o+=4)n=c((30*i[o]+59*i[o+1]+11*i[o+2]+50)/100),i[o]=n,i[o+1]=n,i[o+2]=n;t.putImageData(r,e.x,e.y)},rt.rXc=function(t,e,o){t.rowCount>e&&(t.rowCount=e),t.colCount>o&&(t.colCount=o)},rt.ZGb=/[\u0600-\u06FF\u0750-\u077F]/,rt.nl=et,rt.rl=rt.device,rt.Ml=(q=function(t){t=t.toLowerCase();var e=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:e[1]||"",version:e[2]||"0"}}(Z=navigator.userAgent),K={version:v,chrome:v,webkit:v,safari:v,mozilla:v,msie:v,metroMode:v,edge:v},q.browser&&(K[q.browser]=!0,K.version=q.version),K.chrome?K.webkit=!0:K.webkit&&(K.safari=!0),0<=Z.indexOf("PhantomJS")&&(K.safari=!1,K.chrome=!0),(Y=Z.toLowerCase()).indexOf("compatible")<0&&/(trident)(?:.*? rv ([\w.]+)|)/.exec(Y)!==j&&(K.mozilla=v,K.msie=!0),(Q=/Edge\/\d+/.exec(Z))!==j&&0<Q.length&&(K.webkit=v,K.chrome=v,K.msie=!0,K.edge=!0,K.version=Q[0].substr(Q[0].indexOf("/")+1)),K.msie&&function(){var t=j,e=!1;try{new ActiveXObject("")}catch(e){t=e.name}try{e=!!new ActiveXObject("htmlfile")}catch(t){e=!1}return!(e="ReferenceError"===t||!1!==e)}()&&(K.metroMode=!0),K),rt.browser=rt.Ml,rt.Nl=$,rt.Ol=X,rt.uWa=ot,rt.jZa=rt.sl(),rt.Fxb=function(t){return!1},L=rt,n.util=L,n.Ul=L,H=L.pL,nt.Wl=function(t){return!(nt.Xl()!==t||!t._eventHandler||!t._eventHandler.YH)},nt.Xl=function(){return f&&f.Yl&&f.Yl.activeElement},nt.kmb=function(n){var r,i,a,t,e,o,s;function l(t){var e,o;for(e=0;e<=2;e++)(o=t.call(r,e))&&0!==o.width&&0!==o.height&&(n.$l=!0,i._l(a,o))}if(n&&!nt.Wl(n)&&n.parent&&n.parent.options.hideSelection){for(r=n.am(),i=n._render,a=i.bm(),t=n.getSelections(),o=e=void 0,e=0;e<t.length;e++)s=t[e],0<=(o=n.cm(s)).width&&0<=o.height&&(o.x-=9,o.y-=9,o.width+=18,o.height+=30,i.dm(o));o=r.em(),n.$l=!0,i._l(a,o),l(r.fm),l(r.gm)}},nt.Zl=function(t,e){var o=Kt&&Kt._legacyWynbi&&Kt._legacyWynbi.spreadChartEditState&&Kt._legacyWynbi.spreadChartEditState.pivotTableManager,n=o&&o.getPivotTableBySheet(t),r=nt.Xl();n&&r&&r._formulaTextBox||(f.Yl.activeElement=t)===r||e||(r&&(r.endEdit(),nt.kmb(r),r.hm&&r.hm()),t&&t._render.im())},B=nt,n.Vl=B,yt.prototype.rm=function(){var t="gc-theme-version ui-widget-header ui-state-default wijmoThemeHelper btn-default",e="span."+t.split(M).join(".");return V.vm?C(b).find(e).length<=0&&tt(V.vm):V.vm=it(t),V.vm},yt.prototype.sm=function(){var t="gc-theme-version ui-widget-content wijmoThemeHelper btn-default",e="span."+t.split(M).join(".");return V.wm?C(b).find(e).length<=0&&tt(V.wm):V.wm=it(t),V.wm},yt.prototype.tm=function(){var t="gc-theme-version ui-state-hover wijmoThemeHelper btn-primary",e="span."+t.split(M).join(".");return V.xm?C(b).find(e).length<=0&&tt(V.xm):V.xm=it(t),V.xm},yt.prototype.um=function(){var t="gc-theme-version ui-state-highlight wijmoThemeHelper btn-warning",e="span."+t.split(M).join(".");return V.ym?C(b).find(e).length<=0&&tt(V.ym):V.ym=it(t),V.ym},yt.prototype.zm=function(){var t="gcDummyElement";return V.Am?C(b).find("#"+t).length<=0&&tt(V.Am):V.Am=it("gc-theme-version",t),V.Am},yt.prototype.qm=function(){V.rm(),V.sm(),V.tm(),V.um()},yt.prototype.ad=function(){var t,i,a=this;function o(t){var e,o,n,r=B.Xl();if(r&&(e=V.Bm(t.target),o=r._formulaTextBox&&r._formulaTextBox._isSelectMode,a.km.forEach(function(t){t&&t(r,e)}),!e||function(t,e){var o,n;if(!(Kt&&Kt._legacyWynbi&&Kt._legacyWynbi.spreadChartEditState&&Kt._legacyWynbi.spreadChartEditState.enableReferenceCrossSpread)){for(o=!1,n=t;n;){if("gcSpread"===C(n).attr("gcUIElement")){o=e.zo()!==n;break}n=n.parentElement}return o}}(e,r)))if(r._endEditImp(v,v,o))i&&(n=r._eventHandler)&&n.Cm&&n.Cm(),B.Zl(j);else if(t.cancelable)return!1}function e(t){var e=t.pointerType;e!==t.MSPOINTER_TYPE_TOUCH&&"touch"!==e||o(t)}a.jm=0,at(f,"keydown",lt,!0),at(f,"keyup",ut,!0),at(f,"compositionstart",ct,!0),at(f,"selectstart",ft,!0),t=L.rl(),i=t.ipad||t.iphone,L.browser.safari&&!i&&at(f,"textInput",ht,!0),L._Va()?(C(b).bind("MSPointerDown",e),C(b).bind("pointerdown",e)):C(b).bind("touchstart",o),at(b,"mousedown",function(t){!1===o(t)&&et(t)},!0),C(b).bind("DOMContentLoaded",function(){V.qm()})},yt.prototype.Bm=function(t){for(var e=t;e&&"BODY"!==e.tagName&&"function"==typeof e.getAttribute;){if(e.getAttribute("gcUIElement")||e.gcUIElement)return e;e=e.parentNode}return j},yt.prototype.Dm=function(t,e){var o,n,r,i,a=V.rm();return t===E.VisualState.highlight||t===E.VisualState.selected?a=V.um():t===E.VisualState.hover&&(a=V.tm()),o=a.className,C(a).removeClass(o).addClass(e),r={backgroundColor:(n=st(a)).backgroundColor,backgroundImage:n.backgroundImage},C(a).addClass(o),(i={backgroundColor:(n=st(a)).backgroundColor,backgroundImage:n.backgroundImage,color:n.color,zIndex:n.zIndex}).borderLeftColor=n.borderLeftColor,i.borderRightColor=n.borderRightColor,i.borderBottomColor=n.borderBottomColor,i.borderBottomWidth=n.borderBottomWidth,i.borderTopColor=n.borderTopColor,i.borderRightWidth=n.borderRightWidth,i.backgroundImage===r.backgroundImage&&i.backgroundColor!==r.backgroundColor&&(i.backgroundImage=v),C(a).removeClass(e),i},yt.prototype.Em=function(t){var e,o=V.zm();return C(o).removeClass(o.className).addClass("gc-theme-version "+t),e=st(o),i({},e)},yt.prototype.Fm=function(t){var e,o=V.sm();return C(o).removeClass(o.className).addClass("gc-theme-version ui-widget-content wijmoThemeHelper btn-default "+t),e=st(o),i({},e)},yt.prototype.Gm=function(){f.Yl.jm++},yt.prototype.Hm=function(){var t=f.Yl;t.jm--,t.jm<0&&(t.jm=0)},V=yt.prototype,f.Yl||(f.Yl=new yt),mt.Jm=function(t){return{0:"normal",1:"highlight",2:"selected",3:"active",4:"hover",5:"activeNotSelected"}[t]||""},mt.Km=function(t,e){var o=mt.Jm(t)+e,n=mt.styleCache;return n[o]||(n[o]=V.Dm(t,e)),n[o]},mt.Lm=function(t){var e=t,o=mt.styleCache;return o[e]||(o[e]=V.Em(t)),o[e]},mt.Mm=function(t){var e="content"+t,o=mt.styleCache;return o[e]||(o[e]=V.Fm(t)),o[e]},mt._ob=function(t,e){var o=t.Pm;return o&&o.getColor&&(e=o.getColor(e)),e},mt.Nm=function(){mt.styleCache={}},mt.styleCache={},n.Im=mt,gt.prototype.clone=function(){return new gt(this.x,this.y)},n.Point=gt,dt.prototype.intersect=function(t,e,o,n){return t<this.x+this.width&&this.x<t+o&&e<this.y+this.height&&this.y<e+n},dt.prototype.intersectRect=function(t){return this.intersect(t.x,t.y,t.width,t.height)},dt.prototype.contains=function(t,e,o){var n=this;return o?n.x<=t&&t<=n.x+n.width&&n.y<=e&&e<=n.y+n.height:n.x<t&&t<n.x+n.width&&n.y<e&&e<n.y+n.height},dt.prototype.containsRect=function(t,e){return this.contains(t.x,t.y,e)&&this.contains(t.x+t.width,t.y+t.height,e)},dt.prototype.getIntersectRect=function(t){return this.getIntersect(t.x,t.y,t.width,t.height)},dt.prototype.getIntersect=function(t,e,o,n){var r=this.x,i=this.y,a=this.x+this.width,s=this.y+this.height,l=e,u=t+o,c=e+n,h=w(r,t),f=w(i,l),p=O(a,u)-h,d=O(s,c)-f;return 0<p&&0<d?new dt(h,f,p,d):j},dt.prototype.round=function(){this.x=c(this.x),this.y=c(this.y),this.width=_(this.width),this.height=_(this.height)},dt.prototype.clone=function(){return new dt(this.x,this.y,this.width,this.height)},n.Rect=dt,pt.prototype.intersect=function(t,e,o,n){return(-1===t||-1===this.row||this.row<t+o&&t<this.row+this.rowCount)&&(-1===e||-1===this.col||this.col<e+n&&e<this.col+this.colCount)},pt.prototype.getIntersect=function(t,e,o){var n,r,i,a,s,l,u,c;return t&&this.intersect(t.row,t.col,t.rowCount,t.colCount)?(n=-1===this.col?o-1:this.col+this.colCount-1,r=-1===t.col?o-1:t.col+t.colCount-1,i=-1===this.row?e-1:this.row+this.rowCount-1,a=-1===t.row?e-1:t.row+t.rowCount-1,s=w(this.col,t.col),l=O(n,r),u=w(this.row,t.row),c=O(i,a),new pt(u,s,-1===u?-1:c-u+1,-1===s?-1:l-s+1)):j},pt.prototype.contains=function(t,e,o,n){var r=arguments.length,i=!1;return 2!==r&&4!==r||(2===r&&(n=o=1),i=(-1===this.row||this.row<=t&&t+o<=this.row+this.rowCount)&&(-1===this.col||this.col<=e&&e+n<=this.col+this.colCount)),i},pt.prototype.containsRange=function(t){return this.contains(t.row,t.col,t.rowCount,t.colCount)},pt.prototype.offset=function(t,e){var o=this.col,n=this.row;return-1!==o&&(o+=t),-1!==n&&(n+=e),new pt(n,o,this.rowCount,this.colCount)},pt.prototype.union=function(t){return bt(this,t)},pt.prototype.equals=function(t){return t instanceof pt&&this.row===t.row&&this.col===t.col&&this.rowCount===t.rowCount&&this.colCount===t.colCount},z=pt,n.Range=z,n.kf=function(t,e,o,n){return new z(t,e,o,n)},n.getUnionRange=bt,xt.Om=function(t,e){if(t&&e){var o=t.currentTheme();if(o)return o.getColor(e)}return e},xt.Qm=function(t,e){if(t&&e){var o=t.currentTheme();return o?o.getFont(e):e}return j},n.Rm=xt,wt.ValidationError="ValidationError",wt.CellClick="CellClick",wt.CellDoubleClick="CellDoubleClick",wt.ColumnChanging="ColumnChanging",wt.RowChanging="RowChanging",wt.EnterCell="EnterCell",wt.LeaveCell="LeaveCell",wt.ValueChanged="ValueChanged",wt.TopRowChanged="TopRowChanged",wt.SheetChanging="SheetChanging",wt.SheetChanged="SheetChanged",wt.PivotTableChanged="PivotTableChanged",wt.LeftColumnChanged="LeftColumnChanged",wt.InvalidOperation="InvalidOperation",wt.RangeFiltering="RangeFiltering",wt.RangeFiltered="RangeFiltered",wt.RangeFilterClearing="RangeFilterClearing",wt.TableFilterClearing="TableFilterClearing",wt.RangeFilterCleared="RangeFilterCleared",wt.TableFilterCleared="TableFilterCleared",wt.TableFiltering="TableFiltering",wt.TableFiltered="TableFiltered",wt.RangeSorting="RangeSorting",wt.RangeSorted="RangeSorted",wt.ClipboardChanging="ClipboardChanging",wt.ClipboardChanged="ClipboardChanged",wt.ClipboardPasting="ClipboardPasting",wt.ClipboardPasted="ClipboardPasted",wt.ColumnWidthChanging="ColumnWidthChanging",wt.ColumnWidthChanged="ColumnWidthChanged",wt.RowHeightChanging="RowHeightChanging",wt.RowHeightChanged="RowHeightChanged",wt.DragDropBlock="DragDropBlock",wt.DragDropBlockCompleted="DragDropBlockCompleted",wt.DragFillBlock="DragFillBlock",wt.DragFillBlockCompleted="DragFillBlockCompleted",wt.EditStarting="EditStarting",wt.EditStarted="EditStarted",wt.EditChange="EditChange",wt.EditEnding="EditEnding",wt.EditEnd="EditEnd",wt.EditEnded="EditEnded",wt.RangeGroupStateChanging="RangeGroupStateChanging",wt.RangeGroupStateChanged="RangeGroupStateChanged",wt.SelectionChanging="SelectionChanging",wt.SelectionChanged="SelectionChanged",wt.SheetTabClick="SheetTabClick",wt.SheetTabDoubleClick="SheetTabDoubleClick",wt.SheetNameChanging="SheetNameChanging",wt.SheetNameChanged="SheetNameChanged",wt.ViewZooming="ViewZooming",wt.ViewZoomed="ViewZoomed",wt.UserZooming="UserZooming",wt.UserFormulaEntered="UserFormulaEntered",wt.CellChanged="CellChanged",wt.ColumnChanged="ColumnChanged",wt.RowChanged="RowChanged",wt.ActiveSheetChanging="ActiveSheetChanging",wt.ActiveSheetChanged="ActiveSheetChanged",wt.SparklineChanged="SparklineChanged",wt.OutlineColumnCheckStatusChanged="OutlineColumnCheckStatusChanged",wt.RangeChanged="RangeChanged",wt.ButtonClicked="ButtonClicked",wt.EditorStatusChanged="EditorStatusChanged",wt.FloatingObjectChanged="FloatingObjectChanged",wt.DrawingElementZIndexChanged="DrawingElementZIndexChanged",wt.FloatingObjectSelectionChanged="FloatingObjectSelectionChanged",wt.ShapeChanged="ShapeChanged",wt.ShapeSelectionChanged="ShapeSelectionChanged",wt.PictureChanged="PictureChanged",wt.FloatingObjectRemoving="FloatingObjectRemoving",wt.ShapeRemoving="ShapeRemoving",wt.FloatingObjectRemoved="FloatingObjectRemoved",wt.ShapeRemoved="ShapeRemoved",wt.PictureSelectionChanged="PictureSelectionChanged",wt.FloatingObjectLoaded="FloatingObjectLoaded",wt.TouchToolStripOpening="TouchToolStripOpening",wt.CommentChanged="CommentChanged",wt.CommentRemoving="CommentRemoving",wt.CommentRemoved="CommentRemoved",wt.SlicerChanged="SlicerChanged",wt.BeforeDragDrop="BeforeDragDrop",wt.FormulatextboxActiveSheetChanging="FormulatextboxActiveSheetChanging",wt.FormulatextboxActiveSheetChanged="FormulatextboxActiveSheetChanged",wt.FormulatextboxEditStarted="FormulatextboxEditStarted",wt.FormulatextboxEnterCell="FormulatextboxEnterCell",wt.FormulatextboxEditEnded="FormulatextboxEditEnded",wt.FormulatextboxRangeChanged="FormulatextboxRangeChanged",wt.SheetMoving="SheetMoving",wt.SheetMoved="SheetMoved",wt.DragMerging="DragMerging",wt.DragMerged="DragMerged",wt.ChartClicked="ChartClicked",wt.FloatingElementSelected="FloatingElementSelected",wt.BeforePrint="BeforePrint",wt.TableResizing="TableResizing",wt.TableResized="TableResized",wt.TableRowsChanged="TableRowsChanged",wt.TableColumnsChanged="TableColumnsChanged",wt.DropdownSpreadMouseClick="DropdownSpreadMouseClick",wt.DropdownSpreadKeyboardEnter="DropdownSpreadKeyboardEnter",wt.PasteEnd="PasteEnd",n.Events=wt,Ct.prototype.no=function(){this.kj=j},Ct.prototype.Sm=function(t,e,o){var n,r=this.Tm,i=t<<4+e;return r?((n=r[i])||(n=o(),r[i]=n),n):o()},Ct.prototype.Um=function(t,e){var o,n=this.Vm;return n&&(o=n[t])?o[e]:j},Ct.prototype.Wm=function(t,e,o,n){var r=this.Vm;r&&(r[t]||(r[t]={}),r[t][e]={d:o,i:n})},Ct.prototype.zHb=function(t,e,o,n,r){var i,a=this.kj;return o===v&&(o=3),i=a.xHb(t,e,o),D(i)?!D(r)&&L.lHb(r.formatter)?W.vn(a,r,this.ge(t,e,o,0),{},{row:t,col:e,sheet:a}):this.ge(t,e,o,n):i},Ct.prototype.ge=function(t,e,o,n){var r,i,a,s=this.kj,l=this.Xm;return o===v&&(o=3),l?((r=l[o])||(r={},l[o]=r),(i=r[t])||(i={},r[t]=i),(a=i[e])===v&&(a=s.getValue(t,e,o,n),i[e]=a),a):s.getValue(t,e,o,n)},Ct.prototype.Ym=function(t,e,o){var n,r,i,a=this.kj,s=this.Zm;return o===v&&(o=3),s?((n=s[o])||(n={},s[o]=n),(r=n[t])||(r={},n[t]=r),(i=r[e])||(i=a.AHb(t,e,o,!1,!0),r[e]=i),i.clone(!0)):a.AHb(t,e,o,!1,!1)},Ct.prototype.Sl=function(t){var e,o=this.kj,n=this.$m;return n?((e=n[t])===v&&(e=n[t]=o.Sl(t)),e):o.Sl(t)},Ct.prototype._m=function(t){var e,o=this.kj,n=this.an;return n?((e=n[t])===v&&(e=n[t]=o.Tl(t)),e):o.Tl(t)},Ct.prototype.bn=function(t){return this.Xm?(this.cn||(this.cn=t()),this.cn):t()},Ct.prototype.dn=function(t){return this.Xm?(this.gn||(this.gn=t()),this.gn):t()},Ct.prototype.hn=function(){this.in=!0,this.Tm={},this.Vm={},this.Xm={},this.Zm={},this.$m={},this.an={}},Ct.prototype.jn=function(){this.in=!1},Ct.prototype.kn=function(){this.in=!1,this.Tm=j,this.Vm=j,this.Xm=j,this.Zm=j,this.an=j,this.$m=j,this.cn=j,this.gn=j},n.ln=Ct,vt.qn=function(t,e,o,n,r){var i,a,s,l;if(vt.nn=!0,(i=t.tables)&&i.rn(e,o,n-e+1,r-o+1))for(a=-1,s=vt.sn=[],l=0;l<=n;l++)t.getRowVisible(l)?(a++,s[l]=a):s[l]=-1},vt.Nm=function(){vt.sn=j,vt.nn=!1},vt.tn=function(t){var e=vt.on;return e[t]||(e[t]=m?new m(t):j),e[t]},vt.un=function(t,e,o){var n,r,i,a,s,l,u=vt.pn,c=t+"_"+typeof t;return m?(u[e]||(u[e]={}),(r=(n=u[e])[c])?(o&&(o.conditionalForeColor=o.value=r.color,o.content=h(r.content)),r.text):((i=vt.on)[e]||(i[e]=new m(e)),a={},s=i[e].format(t,a),(l=n[c]={}).text=s,l.color=a.conditionalForeColor,l.content=a.content,o&&(o.conditionalForeColor=o.value=a.conditionalForeColor,o.content=h(a.content)),s)):""+t},vt.vn=function(t,e,o,n,r){var i,a;return o&&"SparklineExValue"===o.typeName?"":(i=e.cellType||t.Al(),a=e.formatter||e._autoFormatter,i.format(o,a,n,r))},vt.wn=function(){vt.on={},vt.pn={}},vt.nn=!1,vt.on={},vt.pn={},vt.sn=[],W=vt,n.mn=W,At.Cn=function(t,e,o){var n=Tt(t);n.scaleX=e,n.scaleY=o,n.translateX=n.orgTranslateX*e,n.translateY=n.orgTranslateY*o,t.setTransform(n.scaleX,n.skewX,n.skewY,n.scaleY,n.translateX,n.translateY)},At.Dn=function(t,e,o){var n=Tt(t);n.orgTranslateX+=e,n.orgTranslateY+=o,n.translateX=n.orgTranslateX*n.scaleX,n.translateY=n.orgTranslateY*n.scaleY,t.setTransform(n.scaleX,n.skewX,n.skewY,n.scaleY,n.translateX,n.translateY)},G=At,n.Bn=G,U=G,It.npb=function(){var t=f.screen,e=t.deviceXDPI,o=f.devicePixelRatio||(e?e/t.logicalXDPI:1),n=20*o,r=x(n);return.82<r-n?r/20:x(100*o)/100},It.Kn=function(t,e,o){var n,r,i,a,s,l,u,c,h=It;if(St(t,1),Mt(t,1),(1!==(n=It.npb())||1!==h.dpr)&&(h.dpr=n,r=e||o&&o.parent)){for(i=h.Fn,a=void 0,s=0;s<i.length;s++)if(r===i[s].workbook){a=i[s];break}if(a||(a={workbook:r,sheets:[],canvases:[]},i.push(a)),e)a.canvases.push(t);else{for(l=void 0,u=a.sheets,c=0;c<u.length;c++)if(u[c].sheet===o){l=u[c];break}l||(l={sheet:o,canvases:[]},u.push(l)),l.canvases.push(t)}}},It.Ln=function(t){return t&&t.Gn||1},It.Mn=function(t){return t&&t.Hn||1},It.Nn=function(t){return t.In},It.On=function(t){return t.Jn},It.Pn=function(t,e,o){var n,r,i,a,s,l=It,u=l.dpr,c=l.Ln(t),h=l.Mn(t);s=e,t.In=s,a=o,t.Jn=a,1===u&&1===c&&1===h?(t.width=e,t.height=o):(n=t.getContext("2d"),U.Cn(n,1,1),L.Ml.mozilla?(t.width=_(e*u),t.height=_(o*u)):(t.width=x(e*u),t.height=x(o*u)),t.style.width=e+S,t.style.height=o+S,r=t.width/e,i=t.height/o,r===c&&i===h||(St(t,r),Mt(t,i)),U.Cn(n,r,i))},It.Qn=function(t,e){var o,n,r,i,a,s=It.Fn,l=t.parent;for(r=0;r<s.length;r++)if(!l||s[r].workbook===l)for(o=s[r].sheets,i=0;i<o.length;i++)if(o[i].sheet===t){for(n=o[i].canvases,a=0;a<n.length;a++)if(n[a]===e){n.splice(a,1);break}break}},It.Rn=function(t,e){var o,n,r,i=It.Fn;for(n=0;n<i.length;n++)if(i[n].workbook===t)for(o=i[n].canvases,r=0;r<o.length;r++)if(o[r]===e){o.splice(r,1);break}},It.Sn=function(t){var e,o,n,r=It.Fn,i=t.parent;for(o=0;o<r.length;o++)if(!i||r[o].workbook===i){for(e=r[o].sheets,n=0;n<e.length;n++)e[n].sheet===t&&e.splice(n,1);return}},It.Tn=function(t){var e,o=It.Fn;for(e=0;e<o.length;e++)if(o[e].workbook===t)return void o.splice(e,1)},It.Un=function(){var t,e,o,n,r,i,a,s,l=It,u=l.npb();if(l.dpr!==u)for(t=l.Fn,r=n=o=e=void 0,l.dpr=u,i=0;i<t.length;i++){for(n=(o=t[i]).canvases,e=o.sheets,a=0;a<e.length;a++)n=n.concat(e[a].canvases);for(s=0;s<n.length;s++)r=n[s],l.Pn(r,l.Nn(r),l.On(r))}},It.dpr=1,It.Fn=[],n.En=It,Bt.Wn=function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g=[];if(!t||0===t.length)return g;if(!(i=r||Nt()))return g;if(L.lZa(i,o),a=L.fp(o),e<=0){for(s=-1,l=!0,u=0;u<t.length;u++)(c=t.charAt(u))===M||l?c!==M&&l&&(s=n?a:H(i,i.font,c),l=!1):s=O(s,n?a:H(i,i.font,c));if((e=s)<=0)return[t]}for(h=t.split(/\r\n|\r|\n/),f=0;f<h.length;f++)if(p=_t(h[f],e,n,a,i))if(0===p.length)g.push("");else for(d=0;d<p.length;d++)g.push(p[d]);return g},Bt.oV=function(t,e,o,n,r){var i,a,s,l,u=[];if(0===e.length)return u;if(n)u=Bt.Wn(e,r,o,!0);else for(i=e.split(/\r\n|\r|\n/),a=0;a<i.length;a++){for(s=[],l=0;l<i[a].length;l++)s.push(i[a][l]);u.push(s)}return u},Bt.M_a=function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p=[];if(0===t.length)return p;if(!(a=i||Nt()))return p;if(e<=0&&(e=function(t,e,o,n){var r,i,a,s,l,u=-1,c=!0;for(r=0;r<e.length;r++)if(!D(e[r].text))for(i=0;i<e[r].text.length;i++)a=e[r].text.charAt(i),s=e[r].style?e[r].style.font:o,L.lZa(t,s),l=L.fp(s),a===M||c?a!==M&&c&&(u=n?l:H(t,o,a),c=!1):u=O(u,n?l:H(t,o,a));return u}(a,n,o,r))<=0){for(l=[],s=0;s<n.length;s++)D(n[s].text)||l.push({textLength:Bt.R_a([n[s]],o,1,r,!1,a),text:n[s].text,textInfos:[n[s]]});return l}for(u=Bt.N_a(t),c=Bt.O_a(u,Bt.P_a(n)),s=0;s<c.length;s++)if(h=Ot(c[s],e,o,r,a))if(0===h.length)p.push("");else for(f=0;f<h.length;f++)p.push(h[f]);return p},Bt.N_a=function(t){var e,o=[],n=t.split(/\r\n|\r|\n/);for(e=0;e<n.length;e++)o.push(Rt(n[e]));return o},Bt.O_a=function(t,e){var o,n,r,i,a,s,l=[],u=0,c=0;for(o=0;o<t.length;o++){for(n=[],r=0;r<t[o].length&&u<e.length;r++)if((i=t[o][r]).length<=e[u].text.length-c)n.push([{style:e[u].style,text:i}]),c+=i.length;else{for((a=[]).push({style:e[u].style,text:e[u].text.substring(c)}),s=i.length-(e[u].text.length-c),u++;u<e.length;u++){if(s<e[u].text.length){a.push({style:e[u].style,text:i.substring(i.length-s)}),c=s;break}if(s===e[u].text.length){a.push({style:e[u].style,text:i.substring(i.length-s)}),u++,c=0;break}a.push({style:e[u].style,text:e[u].text}),s-=e[u].text.length}n.push(a)}l.push(n)}return l},Bt.Xn=function(t,e,o,n){var r,i=n||Nt();return i?(e&&L.lZa(i,e),r=o?kt(t):t,H(i,i.font,r)):0},Bt.P_a=function(t){var e,o=[];for(e=0;e<t.length;e++)o.push({style:t[e].style,text:t[e].text?t[e].text.replace(/\r\n|\r|\n/g,""):t[e].text});return o},Bt.R_a=function(t,e,o,n,r,i){var a,s,l,u,c,h=i||Nt();if(!h)return 0;for(s=a=0;s<t.length;s++)l=t[s].style&&t[s].style.font?t[s].style.font:e,L.lZa(h,l),u=s===t.length-1&&r?kt(t[s].text):t[s].text,c=0,n?c=L.fp(l)*u.length/o:D(t[s].text)||(c=H(h,h.font,t[s].text)/o),t[s].style&&t[s].style.vertAlign&&(c*=.7),a+=c;return a},Bt.mHb=function(t,e,o,n,r,i,a,s){var l=0,u=L.fp(i),c=Bt.Wn(r,(a-4-u*n)/o,i),h=c.length,f=u*o;return l=u/o*(h-1),(l+=Bt.Xn(c[0],i)/2*n+f)+(Bt.Xn(c[h-1],i)/2*n+f)},Bt.Rvb=function(t){return kt(t)},Bt.bm=function(){return Nt()},J=Bt,n.Vn=J,n.Zn=function(l){l.$n=function(t,e){var o,n;for(l._features||(l._features=[]),l._fc={},o=l._features,e.name=t,e.priority=e.priority||5e3,n=0;;n++)if(n>=o.length||e.priority>o[n].priority){o.splice(n,0,e);break}},l.ao=function(t,e,o,n){var r,i,a,s=l._features;if(s){if(!(r=l._fc[e]))for(r=l._fc[e]=[],i=0;i<s.length;i++)(a=s[i][e])&&r.push(a);for(i=0;i<r.length&&(r[i].call(t,o),!n||!n());i++);}}},Ht.prototype.get=function(t,e){var o=this.JTa[t];return o?o[e]:v},Ht.prototype.set=function(t,e,o){var n=this.JTa[t];(n=n||(this.JTa[t]={}))[e]=o},n.KTa=Ht,Lt.processBackspaceAndLeftArrowKeyEvent=function(t,e){var o,n,r,i,a,s,l,u,c,h=f.getSelection();if(!(h.rangeCount<=0)){if(o=h.anchorNode,n=h.anchorOffset,r=t.target,L.browser.msie&&!L.browser.edge&&e&&function(t,e,o){if(1===e&&Vt(o.firstChild)&&Vt(o.firstChild.firstChild)){var n=o.firstChild.firstChild.lastChild,r=void 0;if(t===o)return 1===(r=n.textContent).length&&r[0]!==P&&zt(n.previousSibling);if(n===t||zt(n)&&t===n.previousSibling)return 1===(r=t.textContent).length&&r[0]!==P&&zt(t.previousSibling)}}(o,n,r))return i=(parseFloat(L.browser.version)<10?function t(e,o,n,r,i,a){var s,l,u,c,h,f="",p=e.childNodes,d=p.length;for(s=0;s<d;s++)Vt(l=p[s])?f+=t(l,o,n,r,i,a):Wt(l)?(u=o&&o.startContainer,c=o&&o.endContainer,h=l.textContent,l===u||l===c?u!==c?a=l===u?(f+=Jt(h,n,h.length,i),!0):(f+=Jt(h,0,r,""),!1):f+=Jt(h,n,r,i):a||(f+=h)):zt(l)&&!a&&(f+="\n");return f}(r):r.innerText).slice(0,-1),r.innerHTML=i.replace(/\r/g,"").replace(/\n/g,"<br>​"),h.selectAllChildren(r),0<h.rangeCount&&h.collapseToEnd(),void et(t);if((a=function(t,e){var o,n,r,i,a,s=t.childNodes.length;if(!Zt(t.textContent[0])||0!==e&&1!==e)if(0===e)(n=t)===t.parentNode.firstChild&&(n=t.parentNode),r=qt(n,Gt),o=r&&r.lastChild;else{if(function(t){return t&&"DIV"===t.tagName}(t))return 1===s&&1===e?o=t.firstChild.firstChild.lastChild:1<s&&e===s&&(o=t.lastChild),Ut(o)?{zeroWidthCharNode:o,previousTextNode:o.previousSibling.previousSibling}:Gt(o)?{zeroWidthCharNode:o,previousTextNode:qt(n,Wt)}:j;!Vt(t)||e!==s&&e!==s-1||(Gt(t)?o=t:Gt(t.lastChild)&&(o=t.lastChild))}else o=t;return o?(Vt(o)?n=o:Wt(o)&&(i=o.previousSibling,a=o.parentNode,n=i===a.firstChild?a:i),{zeroWidthCharNode:o,previousTextNode:qt(n,Wt)}):j}(o,n))&&a.zeroWidthCharNode){if(s=a.zeroWidthCharNode,l=a.previousTextNode,e)if(Vt(s))s.parentNode.removeChild(s);else{if(s.parentNode.removeChild(s.previousSibling),zt(l))return void et(t);(u=h.getRangeAt(0)).setStart(s,0),u.setEnd(s,1),u.deleteContents()}(c=b.createRange()).setStartAfter(l),c.setEndAfter(l),c.collapse(!1),h.removeAllRanges(),h.addRange(c),et(t)}}},Lt.processDeleteAndRightArrowKeyEvent=function(t,e){var o,n,r,i,a,s=f.getSelection();s.rangeCount<=0||(o=function(t){var e,o,n=t.anchorNode,r=t.anchorOffset,i=n.textContent.length;if(r!==i)return j;if(e=function(t){for(var e,o=t;o;){if(e=o.parentNode,o!==e.lastChild)return o.nextSibling;o=e}return j}(n),o=void 0,!e)return j;if(Vt(e)&&Zt(e.textContent[0])){for(;Vt(e.firstChild);)e=e.firstChild;o=e.childNodes[1]}else zt(e)&&Zt(e.nextSibling.textContent[0])&&(o=e.nextSibling);return{node:o,offset:1}}(s))&&o.node&&(n=o.node,r=o.offset,e?((i=s.getRangeAt(0)).setStart(n,0),i.setEnd(n,1),i.deleteContents(),n.parentNode.removeChild(n.previousSibling)):((a=b.createRange()).setStart(n,r),a.setEnd(n,r),a.collapse(!1),s.removeAllRanges(),s.addRange(a)),et(t))},n.uHb=Lt,n.Rxb={touch:!1},n.sJc=function(t){var e,o;return t&&((e=t.getActiveSheet())||(o=t.getActiveSheetTab())&&(e=o.kj)),e},n.tJc=function(t,e){t&&(t.getSheetFromName(e)?t.setActiveSheet(e):t.getSheetTab(e)&&t.setActiveSheetTab(e))},n.uJc=function(t,e){var o,n=t.getSheetFromName(e);return n||(o=t.getSheetTab(e))&&(n=o.kj),n}},"./dist/core/util/domUtil.js":function(t,e,o){"use strict";var n,r,g,f,m,s,h,p,d,l,u,c,y,b,v,a,C,w,x,T,A,S,M,i,I;function N(t,e){var o,n;for(Array.call(this),"string"==typeof t?o=(e||h).querySelectorAll(t):t&&(o=r.Ca(t)||t instanceof HTMLCollection?t:[t]),n=0;o&&n<o.length;n++)this.push(o[n])}function R(t){var e=getComputedStyle(t).zIndex;return"auto"===e||""===e?0:+e}function k(t){return M.isWindow(t)?t:9===t.nodeType&&(t.defaultView||t.parentWindow)}function E(t,e){var o=t.nodeName;return o&&o.toLowerCase()===e.toLowerCase()}function D(t,e){return 0<="top left right bottom width height border-radius border-width border-left-width border-right-width border-top-width border-bottom-width line-height padding padding-left padding-right padding-top padding-bottom margin margin-left margin-right margin-top margin-bottom".split(" ").indexOf(t)&&isFinite(e)?(0<="width height".split(" ").indexOf(t)&&e<0&&(e=0),e+"px"):e}function j(t,e,o){var n,r,i=t.nodeType;if(t&&3!==i&&8!==i&&2!==i)return 1!==i&&(r=C[e=a[e]||e]),V(o)?r&&"get"in r&&(n=r.get(t,e))!==m?n:t[e]:r&&"set"in r&&!V(n=r.set(t,o,e))?n:t[e]=o}function _(t){var e,o,n,r=t.nodeType;return(!r||1===r||9===r)&&(e={embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},!(n=(o=t.nodeName)&&e[o.toLowerCase()])||!0!==n&&t.getAttribute("classid")===n)}function O(t){return t.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(t,e){return e.toUpperCase()})}function F(t,e,o,n){if(_(t)){var r,i,a=T,s=H(e),l=t.nodeType,u=l?x:t,c=l?t[a]:t[a]&&a;if(c&&u[c]&&(n||u[c].data)||!s||!V(o))return c||(l?(t[a]=c=A,A++):c=a),u[c]||(u[c]={},l||(u[c].toJSON=function(){})),!B(e)&&"function"!=typeof e||(n?u[c]=M.extend(u[c],e):u[c].data=M.extend(u[c].data,e)),r=u[c],n||(r.data||(r.data={}),r=r.data),V(o)||(r[O(e)]=o),s?(i=r[e])!==m&&i!==f||(i=r[O(e)]):i=r,i}}function P(t){var e;for(e in t)if(("data"!==e||!M.isEmptyObject(t[e]))&&"toJSON"!==e)return!1;return!0}function L(t,e){for(var o,n,r,i,a,s,l,u,c,h=0,f=T,p=x,d=t[h];d!==m&&void 0!==d;){if((e||_(d))&&(n=(o=d[f])&&p[o])){if(r=n.events)for(i in r)if(g(r,i)&&(a=r[i]))for(s in a)if(g(a,s)&&(l=a[s]))for(u=0,c=l.length;u<c;u++)Z(d,i,l[u]);p[o]&&(delete p[o],delete d[f])}d=t[++h]}}function H(t){return"string"==typeof t}function B(t){return"object"==typeof t}function V(t){return typeof t==typeof f}function z(t){var a=t;return function(t){var e,o="border-box"===this.css("box-sizing"),n=a?l:u,r=a?"left":"top",i=a?"right":c;return 0===arguments.length?(e=Math.round(s(this.css(n)))||0,o&&(e-=s(this.css("padding-"+r))+s(this.css("padding-"+i))+s(this.css("border-"+r+"-"+l))+s(this.css("border-"+i+"-"+l))),e):(this.css(n,t),this)}}function W(t){var o=t;return function(){var t=o?"left":"top",e=o?"right":c;return o?this.width():this.height()+s(this.css("padding-"+t))+s(this.css("padding-"+e))}}function G(t){var r=t;return function(t){var e=r?"left":"top",o=r?"right":c,n=r?this.innerWidth():this.innerHeight();return n+=s(this.css("border-"+e+"-"+l))+s(this.css("border-"+o+"-"+l)),t&&(n+=s(this.css("margin-"+e))+s(this.css("margin-"+o))),n}}function U(t){var o=t;return function(e){return this.forEach(function(t){t.style[v]=o?"block":"none",e&&e.apply(t)}),this}}function J(t){var a=t;return function(t){var e="scrollLeft",o=a?e:"scrollTop",n=a?"pageXOffset":"pageYOffset",r=this[0],i=k(r);return V(t)?i?n in i?i[n]:h.documentElement[o]:r[o]:(i?i.scrollTo(a?t:M(i)[e](),a?M(i).scrollTop():t):r[o]=t,this)}}function Z(t,e,o){t.removeEventListener(e,o)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("@grapecity/js-sheets-common"),r=n.Common.j,g=n.Common.D,f=void 0,m=null,s=parseFloat,h=document,p="_nonamespace",d="events",l="width",u="height",c="bottom",y="position",b="visibility",v="display",a={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},C={tabIndex:{get:function(t){var e=t.getAttributeNode("tabindex"),o=t.nodeName;return e&&e.specified?parseInt(e.value,10):/^(?:input|select|textarea|button|object)$/i.test(o)||/^(?:a|area)$/i.test(o)&&t.href?0:f}}},w={option:{get:function(t){var e=t.attributes.value;return!e||e.specified?t.value:t.text}},select:{get:function(t){var e,o,n=t.options,r=t.selectedIndex,i="select-one"===t.type||r<0,a=i?m:[],s=i?r+1:n.length,l=i?r:0;for(r<0&&(l=s);l<s;l++)if(((o=n[l]).selected||l===r)&&!o.disabled&&(!o.parentNode.disabled||!E(o.parentNode,"optgroup"))){if(e=M(o).val(),i)return e;a.push(e)}return a},set:function(t,e){var o=M.makeArray(e);return M(t).find("option").getAll().forEach(function(t){t.selected=0<=M.inArray(M(t).val(),o)}),o.length||(t.selectedIndex=-1),o}}},x={},T="$"+(""+Math.random()).replace(/\D/g,""),A=1,S={},[u,l].forEach(function(c){S[c]={get:function(t){var e,o,n,r=getComputedStyle(t),i=t.style,a=i[y],s=i[b],l=i[v],u=0===t.offsetWidth&&/^(none|table(?!-c[ea]).+)/.test(r[v]);if(u&&(i[y]="absolute",i[b]="hidden",i[v]="block"),e=r&&r[c],u&&(i[y]=a,i[b]=s,i[v]=l),""===e){for(o=t.parentElement,n=h.body;o&&o!==n;)o=o.parentElement;o!==n&&(e=i[c])}return e}}}),M=function(t,e){return t instanceof N?t:new N(t,e)},e.GC$=M,i={get:function(t){return this[t]},getAll:function(){return this},bind:function(s,l,u){return V(u)&&(u=l,l=f),this.forEach(function(o){var t,e,n,r,i,a=F(o,d,f,!0);a||F(o,d,a={},!0),e=(t=s.split("."))[0],r=(r=a[n=t[1]||p])||(a[n]={}),(i=function(t){V(l)||(t.data=l);var e=u.apply(o,arguments);!1===(t.result=e)&&(t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.cancelBubble=!1,t.returnValue=!1))}).original=u,(r[e]||(r[e]=[])).push(i),o.addEventListener(e,i)}),this},unbind:function(c,h){return this.forEach(function(t){var e,o,n,r,i=c.split("."),a=i[0],s=i[1]||p,l=F(t,d,f,!0),u=l&&l[s];if(h){if(u&&a&&(e=u[a]))for(n=e.length,o=0;o<n;o++)if(e[o].original===h){Z(t,a,e[o]),e.splice(o,1);break}}else if(u)if(a){if(e=u[a])for(n=e.length,o=0;o<n;o++)Z(t,a,e[o]);u[a]=f}else{for(r in u)if(g(u,r)&&(e=u[r]))for(n=e.length,o=0;o<n;o++)Z(t,r,e[o]);l[s]=f}}),this},trigger:function(t,e){var o,n,r,i,a,s,l,u,c,h;for(o=0,n=this.length;o<n;o++)if(i=F(r=this[o],d,f,!0))for(s in a=t.split(".")[0],i)if(g(i,s)&&(u=(l=i[s])&&l[a]))for(c=0,h=u.length;c<h;c++)u[c].apply(r,[{type:a},e]);return this},css:function(o,n){var t,e,r,i=this,a=arguments.length;function s(e,o){i.forEach(function(t){t.style[e]=D(e,o)})}if(1===a){if(!B(o))return t=this[0],(e=S[o])&&"get"in e?e.get(t):(r=getComputedStyle(t))&&r[o];i.forEach(function(t){for(var e in o)g(o,e)&&(t.style[e]=D(e,o[e]))})}else 2===a&&(Array.isArray(o)&&Array.isArray(n)&&o.length===n.length?o.forEach(function(t,e){s(t,n[e])}):s(o,n));return this},width:z(!0),height:z(),innerWidth:W(!0),innerHeight:W(),outerWidth:G(!0),outerHeight:G(),append:function(t){var e,o=[t];return t instanceof M&&(o=t.getAll()),e=this[0],o.forEach(function(t){t&&e.appendChild(t)}),this},appendTo:function(t){var e=t;return t instanceof M&&(e=t[0]),this.forEach(function(t){e.appendChild(t)}),this},prepend:function(t){var e=this[0];return e.insertBefore(t,e.firstChild),this},insertBefore:function(e){var o=e.parentElement;return this.forEach(function(t){o.insertBefore(t,e)}),this},addClass:function(t){var e,o,n,r,i,a=0,s=this.length,l=/[\t\r\n]/g;for(e=(t||"").match(/\S+/g)||[];a<s;a++)if(n=1===(o=this[a]).nodeType&&(o.className?(" "+o.className+" ").replace(l," "):" ")){for(r=e[i=0];r;)n.indexOf(" "+r+" ")<0&&(n+=r+" "),r=e[++i];o.className=M.trim(n)}return this},removeClass:function(t){var e,o,n,r,i,a=0,s=this.length,l=/[\t\r\n]/g;for(e=(t||"").match(/\S+/g)||[];a<s;a++)if(n=1===(o=this[a]).nodeType&&(o.className?(" "+o.className+" ").replace(l," "):"")){for(r=e[i=0];r;){for(;0<=n.indexOf(" "+r+" ");)n=n.replace(" "+r+" "," ");r=e[++i]}o.className=t?M.trim(n):""}return this},hasClass:function(t){var e,o=0,n=this.length,r=/[\t\r\n]/g;for(t=" "+t+" ";o<n;o++)if(1===(e=this[o]).nodeType&&0<=(" "+e.className+" ").replace(r," ").indexOf(t))return!0;return!1},toggle:function(){return"none"===this[0].style[v]?this.show():this.hide(),this},show:U(!0),hide:U(),attr:function(o,e){var t=this,n=arguments.length;if(1===n){if(!B(o))return this[0].getAttribute(o);t.forEach(function(t){for(var e in o)g(o,e)&&t.setAttribute(e,o[e])})}else 2===n&&t.forEach(function(t){t.setAttribute(o,e)});return this},removeAttr:function(e){return this.forEach(function(t){t.removeAttribute(e)}),this},prop:function(o,e){var t=this,n=arguments.length;if(1===n){if(!B(o))return j(this[0],o);t.forEach(function(t){for(var e in o)g(o,e)&&j(t,e,o[e])})}else 2===n&&t.forEach(function(t){j(t,o,e)});return this},removeProp:function(e){e=a[e]||e;return this.forEach(function(t){try{t[e]=f,delete t[e]}catch(t){}}),this},text:function(e){var t=this;return 0===arguments.length?this[0].textContent:(t.forEach(function(t){t.textContent=e}),this)},val:function(n){var r,t,e,i;return arguments.length?(i=M.isFunction(n),this.forEach(function(t,e){var o;1===t.nodeType&&((o=i?n.call(t,e,M(t).val()):n)===m||o===f?o="":"number"==typeof o?o+="":M.isArray(o)&&(o=M.map(o,function(t){return t===m||t===f?"":t+""})),(r=w[t.type]||w[t.nodeName.toLowerCase()])&&"set"in r&&!V(r.set(t,o,"value"))||(t.value=o))}),this):(e=void 0,(t=this[0])?(r=w[t.type]||w[t.nodeName.toLowerCase()])&&"get"in r&&!V(e=r.get(t,"value"))?e:H(e=t.value)?e.replace(/\r/g,""):e===m||e===f?"":e:void 0)},position:function(){var t,e,o,n,r=this[0];if(r){if(t={top:0,left:0},e={top:0,left:0},"fixed"===M(r).css(y))try{t=r.getBoundingClientRect()}catch(t){}else o=this.offsetParent(),t=this.offset(),E(n=o[0],"html")||((e=o.offset()).left-=n.scrollLeft,e.top-=n.scrollTop),e.top+=s(M(n).css("borderTopWidth")),e.left+=s(M(n).css("borderLeftWidth"));return{top:t.top-e.top-s(M(r).css("marginTop")),left:t.left-e.left-s(M(r).css("marginLeft"))}}},offsetParent:function(){var t=M.map(this,function(t){for(var e=h.documentElement,o=t.offsetParent||e;o&&!E(o,"html")&&"static"===M(o).css(y);)o=o.offsetParent;return o||e});return M(t)},offset:function(){var t,e,o={top:0,left:0},n=this[0],r=n&&n.ownerDocument;if(r){if(t=r.documentElement,!V(n.getBoundingClientRect))try{o=n.getBoundingClientRect()}catch(t){}return e=k(r),{top:o.top+(e.pageYOffset||t.scrollTop)-(t.clientTop||0),left:o.left+(e.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}}},scrollLeft:J(!0),scrollTop:J(),html:function(e){var t=this;return 0===arguments.length?this[0].innerHTML:(t.forEach(function(t){t.innerHTML=e}),this)},remove:function(){this.forEach(function(t){var e=t.parentElement;e&&(e.removeChild(t),L([t]))})},empty:function(){return this.forEach(function(t){M(t.children).remove()}),this},find:function(o){var n=[];return H(o)&&this.forEach(function(t){var e=t.querySelectorAll(o);M.merge(n,e)}),M(n)},parent:function(){var o=[];return this.forEach(function(t){var e=t.parentElement;e&&o.push(e)}),M(o)},index:function(t){var e=this[0];return t?H(t)?M.inArray(e,M(t).getAll()):M.inArray(t,this):e&&e.parentElement?M.inArray(e,e.parentElement.children):-1},focus:function(){var t=this[0];return t!==h.activeElement&&t.focus&&t.focus(),this},isVisible:function(){var o=0;return this.forEach(function(t){var e=getComputedStyle(t);"hidden"!==e[b]&&"none"!==e[v]&&o++}),0<o},data:function(n,r){var i=this,a=V(r);return a&&(i=void 0),M.each(this,function(t,e){var o=F(e,n,r);if(a)return i=o,!1}),i},removeData:function(o){return M.each(this,function(t,e){!function(t,e,o){if(_(t)){var n,r,i,a=t.nodeType,s=a?x:t,l=a?t[T]:T;if(s[l]){if(e&&(i=o?s[l]:s[l].data)){e=M.isArray(e)?e.concat(M.map(e,O)):e in i?[e]:(e=O(e))in i?[e]:e.split(" "),r=e.length;for(n=0;n<r;n++)delete i[e[n]];if(!(o?P:M.isEmptyObject)(i))return}(o||(delete s[l].data,P(s[l])))&&(a?L([t],!0):s!==s.window?delete s[l]:s[l]=m)}}}(e,o)}),this}},I=N.prototype=[],r.Ia(I,i),M.prototype=I,M.each=r.H,M.isEmptyObject=r.za,M.isFunction=r.Aa,M.isArray=r.Ca,M.isNumeric=r.Da,M.getType=r.Ba,M.inArray=r.Ea,M.merge=r.Ga,M.map=r.Ha,M.extend=r.Ia,M.inherit=r.G,M.isPlainObject=r.Ja,M.isArraylike=r.ya,M.isWindow=r.Ka,M.makeArray=r.La,M.trim=function(t){if(t.trim)return t.trim();return t===m||t===f?"":(t+"").replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},M.Nl=function(t,e,o,n,r){var i=M(h.createElement(t));return e&&o&&i.css(e,o),n&&i.addClass(n),r&&(r instanceof M?r.append(i):M(r).append(i)),i},e.getHostMaxZIndex=function(t){for(var e,o=R(t);t.parentElement;)o<(e=R(t=t.parentElement))&&(o=e);return o}},"./dist/core/util/imageLoader.js":function(t,e,o){"use strict";var n,i,a;function r(t){this.bo=0,this.co=0,this.eo={};this.do=t}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/util/domUtil.js"),i=n.GC$,a=".gcSheet",r.prototype.fo=function(t){var e,o,n=this;function r(){n.ho(t,!1)}(e=n.eo)[t]||((o=i(document.createElement("img"))).bind("load"+a,function(){n.ho(t,!0)}),o.bind("error"+a,r),o.bind("abort"+a,r),n.bo++,e[t]={io:!1,jo:o[0],agc:!1},o[0].src=t)},r.prototype.ko=function(t){var e=this.eo[t];return!!e&&e.io},r.prototype.bgc=function(t){var e=this.eo[t];return!!e&&e.agc},r.prototype.lo=function(t){var e=this.eo[t];return e?e.jo:null},r.prototype.ho=function(t,e){this.co++,this.eo[t].io=!0,this.eo[t].agc=e,this.mo()&&this.do&&this.do()},r.prototype.mo=function(){return this.co>=this.bo},r.prototype.no=function(){var t,e=this.eo;if(e)for(t in e)e[t]&&i(e[t].jo).unbind(a);this.do=null},e.oo=r},"./dist/core/util/tasks.js":function(t,e,o){"use strict";var n;function r(t,e){this.tasks=[],this.nextTaskFunc=t.bind(this),this.isBusyFunc=e.bind(this)}function i(t,e){this.fn=t,this.args=e}Object.defineProperty(e,"__esModule",{value:!0}),i.prototype.run=function(){this.fn.apply(null,this.args)},n=i,e.Task=n,r.prototype.addTask=function(t,e){this.tasks.splice(0,0,new n(t,e))},r.prototype.pushTask=function(t,e){this.tasks.push(new n(t,e))},r.prototype.runNextTask=function(){var t=this,e=t.tasks;if(!t.isTerminated){if(e.length<1)return void(t.endingCallback&&t.endingCallback());if(t.isBusyFunc())return void setTimeout(function(){t.runNextTask()},100);t.nextTaskFunc().run(),setTimeout(function(){t.runNextTask()},10)}},r.prototype.start=function(){this.runNextTask()},r.prototype.terminate=function(){this.tasks=[],this.isTerminated=!0},e.Tasks=r},"./dist/core/util/theme.js":function(t,e,o){"use strict";var n,r,b,a,d,s,i,l,u,c,h,f,p,g,m,y;function v(e){var o=e;return function(t){return 0===arguments.length?this.po[o]:(this.po[e]=d(t),this)}}function C(){}function w(){}function x(t,e,o,n){this.name=i("name"),this.colors=i("colors"),this.headerFont=i("headerFont"),this.bodyFont=i("bodyFont");this.name(t),this.colors(e||new h(t)),this.headerFont(o),this.bodyFont(n)}function T(t,e,o,n,r,i,a,s,l,u,c,h,f){this.background1=v(0),this.background2=v(1),this.textColor1=v(2),this.textColor2=v(3),this.accent1=v(4),this.accent2=v(5),this.accent3=v(6),this.accent4=v(7),this.accent5=v(8),this.accent6=v(9),this.hyperlink=v(10),this.followedHyperlink=v(11),this.Cj=t,this.po=[];for(var p=1;p<13;p++)this.po.push(d(arguments[p]))}Object.defineProperty(e,"__esModule",{value:!0}),n=o("@grapecity/js-sheets-common"),r=o("./dist/core/util/common.js"),b=n.Common.j.Fa,a=n.Common.pc,d=a.ec,s=parseInt,i=r.util.Pl,l="Gill Sans MT",u="Franklin Gothic Book",c="Trebuchet MS",T.prototype.name=function(t){return 0===arguments.length?this.Cj:(this.Cj=t,this)},T.prototype.getColor=function(t){var e,o,n,r,i;if(t&&"string"==typeof t&&(o=void 0,e=t.split(" "))){if(n=-1,1<(r=e.length)){if(!e[0])return t;"background"===(o=e[0].toLowerCase())?n=s(e[1],10)-1:"text"===o?n=s(e[1],10)+1:"accent"===o&&(n=s(e[1],10)+3)}else 1===r&&("hyperlink"===(o=e[0].toLowerCase())?n=10:"followedhyperlink"===o&&(n=11));if(0<=n&&n<=11)return 2<r?(i=s(e[2],10)/100,a.bc(a.jc(this.po[n],i))):a.bc(this.po[n])}return t},T.prototype.toJSON=function(){var t=this.po;return{name:this.Cj,background1:t[0],background2:t[1],text1:t[2],text2:t[3],accent1:t[4],accent2:t[5],accent3:t[6],accent4:t[7],accent5:t[8],accent6:t[9],hyperlink:t[10],followedHyperlink:t[11]}},T.prototype.fromJSON=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d,g,m;function y(t,e){b(e)||(o.po[t]={a:e.a,r:e.r,g:e.g,b:e.b})}t&&(o=this,d=e?(g=t.name?t.name:t._name,b(g)||(o.Cj=g),n=(m=t.colorList?t.colorList:t._colorList)[0],r=m[1],i=m[2],a=m[3],s=m[4],l=m[5],u=m[6],c=m[7],h=m[8],f=m[9],p=m[10],m[11]):(b(t.name)||(o.Cj=t.name),n=t.background1,r=t.background2,i=t.text1,a=t.text2,s=t.accent1,l=t.accent2,u=t.accent3,c=t.accent4,h=t.accent5,f=t.accent6,p=t.hyperlink,t.followedHyperlink),y(0,n),y(1,r),y(2,i),y(3,a),y(4,s),y(5,l),y(6,u),y(7,c),y(8,h),y(9,f),y(10,p),y(11,d))},T.prototype.e4=function(t){var e,o,n,r;if(this.name()!==t.name())return!1;for(o=0,n=(e=["textColor1","textColor2","background1","background2","accent1","accent2","accent3","accent4","accent5","accent6","hyperlink","followedHyperlink"]).length;o<n;o++)if(r=e[o],!a.Pka(this[r](),t[r]()))return!1;return!0},h=T,e.ColorScheme=h,x.prototype.getColor=function(t){return this.colors().getColor(t)},x.prototype.getFont=function(t){return"Body"===t?this.bodyFont():"Headings"===t?this.headerFont():t},x.prototype.toJSON=function(){var t=this.name();return x.f4(this)?t:{name:t,themeColor:this.colors()?this.colors().toJSON():void 0,headingFont:this.headerFont(),bodyFont:this.bodyFont()}},x.f4=function(t){var e,o=t.name();return!!y[o]&&(e=y[o],t.bodyFont()===e.bodyFont()&&t.headerFont()===e.headerFont()&&t.colors().e4(e.colors()))},f=x,e.Theme=f,w.Default=new h("Default",g="#FFFFFF","#EEECE1",p="#000000","#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),w.Office2007=new h("Office2007",g,"#EEECE1",p,"#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),w.Office=new h("Office",g,"#E7E6E6",p,"#44546A","#5B9BD5","#ED7D31","#A5A5A5","#FFC000","#4472C4","#70AD47","#0563C1","#954F72"),w.Apex=new h("Apex",g,"#C9C2D1",p,"#69676D","#CEB966","#9CB084","#6BB1C9","#6585CF","#7E6BC9","#A379BB","#410082","#932968"),w.Aspect=new h("Aspect",g,"#E3DED1",p,"#323232","#F07F09","#9F2936","#1B587C","#4E8542","#604878","#C19859","#6B9F25","#B26B02"),w.Concourse=new h("Concourse",g,"#DEF5FA",p,"#464646","#2DA2BF","#DA1F28","#EB641B","#39639D","#474B78","#7D3C4A","#FF8119","#44B9E8"),w.Civic=new h("Civic",g,"#C5D1D7",p,"#646B86","#D16349","#CCB400","#8CADAE","#8C7B70","#8FB08C","#D19049","#00A3D6","#694F07"),w.Oriel=new h("Oriel",g,"#FFF39D",p,"#575F6D","#FE8637","#7598D9","#B32C16","#F5CD2D","#AEBAD5","#777C84","#D2611C","#3B435B"),w.Origin=new h("Origin",g,"#DDE9EC",p,"#464653","#727CA3","#9FB8CD","#D2DA7A","#FADA7A","#B88472","#8E736A","#B292CA","#6B5680"),w.Paper=new h("Paper",g,"#FEFAC9",p,"#444D26","#A5B592","#F3A447","#E7BC29","#D092A7","#9C85C0","#809EC2","#8E58B6","#7F6F6F"),w.Solstice=new h("Solstice",g,"#E7DEC9",p,"#4F271C","#3891A7","#FEB80A","#C32D2E","#84AA33","#964305","#475A8D","#8DC765","#AA8A14"),w.Technic=new h("Technic",g,"#D4D2D0",p,"#3B3B3B","#6EA0B0","#CCAF0A","#8D89A4","#748560","#9E9273","#7E848D","#00C8C3","#A116E0"),w.Trek=new h("Trek",g,"#FBEEC9",p,"#4E3B30","#F0A22E","#A5644E","#B58B80","#C3986D","#A19574","#C17529","#AD1F1F","#FFC42F"),w.Urban=new h("Urban",g,"#DEDEDE",p,"#424456","#53548A","#438086","#A04DA3","#C4652D","#8B5D3D","#5C92B5","#67AFBD","#C2A874"),w.Verve=new h("Verve",g,"#D2D2D2",p,"#666666","#FF388C","#E40059","#9C007F","#68007F","#005BD3","#00349E","#17BBFD","#FF79C2"),w.Equity=new h("Equity",g,"#E9E5DC",p,"#696464","#D34817","#9B2D1F","#A28E6A","#956251","#918485","#855D5D","#CC9900","#96A9A9"),w.Flow=new h("Flow",g,"#DBF5F9",p,"#04617B","#0F6FC6","#009DD9","#0BD0D9","#10CF9B","#7CCA62","#A5C249","#E2D700","#85DFD0"),w.Foundry=new h("Foundry",g,"#EAEBDE",p,"#676A55","#72A376","#B0CCB0","#A8CDD7","#C0BEAF","#CEC597","#E8B7B7","#DB5353","#903638"),w.Median=new h("Median",g,"#EBDDC3",p,"#775F55","#94B6D2","#DD8047","#A5AB81","#D8B25C","#7BA79D","#968C8C","#F7B615","#704404"),w.Metro=new h("Metro",g,"#D6ECFF",p,"#4E5B6F","#7FD13B","#EA157A","#FEB80A","#00ADDC","#738AC8","#1AB39F","#EB8803","#5F7791"),w.Module=new h("Module",g,"#D4D4D6",p,"#5A6378","#F0AD00","#60B5CC","#E66C7D","#6BB76D","#E88651","#C64847","#168BBA","#680000"),w.Opulent=new h("Opulent",g,"#F4E7ED",p,"#B13F9A","#B83D68","#AC66BB","#DE6C36","#F9B639","#CF6DA4","#FA8D3D","#FFDE66","#D490C5"),m=w,e.ThemeColors=m,C.Default=new f("Default",m.Default,"Cambria","Calibri"),C.Office=new f("Office",m.Office,"Calibri Light","Calibri"),C.Office2007=new f("Office2007",m.Office2007,"Cambria","Calibri"),C.Apex=new f("Apex",m.Apex,"Lucida Sans","Book Antiqua"),C.Aspect=new f("Aspect",m.Aspect,"Verdana","Verdana"),C.Concourse=new f("Concourse",m.Concourse,"Lucida Sans Unicode","Lucida Sans Unicode"),C.Civic=new f("Civic",m.Civic,"Georgia","Georgia"),C.Oriel=new f("Oriel",m.Oriel,"Century Schoolbook","Century Schoolbook"),C.Origin=new f("Origin",m.Origin,"Bookman Old Style",l),C.Paper=new f("Paper",m.Paper,"Constantia","Constantia"),C.Solstice=new f("Solstice",m.Solstice,l,l),C.Technic=new f("Technic",m.Technic,u,"Arial"),C.Trek=new f("Trek",m.Trek,"Franklin Gothic Medium",u),C.Urban=new f("Urban",m.Urban,c,"Georgia"),C.Verve=new f("Verve",m.Verve,"Century Gothic","Century Gothic"),C.Equity=new f("Equity",m.Equity,u,"Perpetua"),C.Flow=new f("Flow",m.Flow,"Calibri","Constantia"),C.Foundry=new f("Foundry",m.Foundry,"Rockwell","Rockwell"),C.Median=new f("Median",m.Median,"Tw Cen MT","Tw Cen MT"),C.Metro=new f("Metro",m.Metro,"Consolas","Corbel"),C.Module=new f("Module",m.Module,"Corbel","Corbel"),C.Opulent=new f("Opulent",m.Opulent,c,c),y=C,e.Themes=y},"./dist/core/workbook/sheettab.js":function(t,e,o){"use strict";var n,d,T,g,A,S,r,i,c,a,s,l=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function u(t){var e,o=s.call(this,t)||this;return o.vJc=4,o.wJc="white",(e=o).EC=13,e.GC=12,e.HC=0,e.kw=30,e.IC=28,e.JC=28,e.KC=g.NEW_TAB_SIZE_ASIDE,e.LC=0,e._font="10pt Segoe UI",o}Object.defineProperty(e,"__esModule",{value:!0}),n=o("@grapecity/js-sheets-common"),d=o("./dist/core/util/common.js"),T=o("./dist/core/worksheet/stylehelper.js"),g=o("./dist/core/workbook/sheettabbase.js"),A=o("./dist/core/core.enum.js"),S=n.Common.pc,r=S.ic,i=S.ec,c=null,s=g.DC,l(u,s),u.prototype.NC=function(){var t=this.OC,e=t&&t.options;return e&&e.tabNavigationVisible?this.IC*(e.useTouchLayout?1.5:1):0},u.prototype.PC=function(){var t=this.OC;return t&&t.options.tabNavigationVisible?t.xJc():0},u.prototype.QC=function(){return this.JC},u.prototype.RC=function(){return this.SC?0:this.JC},u.prototype.TC=function(){return!this.OC.options.newTabVisible||this.SC?0:this.KC},u.prototype.UC=function(){var t,e,o,n=this,r=n.OC.yJc(),i=n.VC(),a=n.WC,s=n.zJc(),l=n.Dr();for(t=s?l.x+l.width-n.AJc()-n.TC()-n.RC():l.y+l.height-n.PC(),e=n.gq,o=r.length;e<o;e++)if(r[e].visible()&&(i+=s?a[e]:n.BJc),t<i){i=t;break}return i},u.prototype.VC=function(){return this.zJc()?2*this.NC()+this.QC()+this.XC():this.TC()},u.prototype.XC=function(){var t=this.OC;return t&&t.options.tabNavigationVisible?this.AJc()/2:0},u.prototype.getResizeBarBounds=function(){var t=this.Dr();return{x:t.x+t.width-this.AJc(),y:c,width:this.AJc(),height:c}},u.prototype.getNavButtonBounds=function(){var t,e,o,n,r,i,a;return n=this.zJc()?(t=this.AJc()/2,e=c,o=this.NC(),c):(r=this.Dr(),i=this.PC(),a=this.NC(),t=r.width/2-a,e=r.height-i,o=a,i),{x:t,y:e,width:o,height:n,startIndex:1,endIndex:3}},u.prototype.getSheetTabBounds=function(){var t=this.Dr(),e=this.RC();return{x:this.VC(),y:c,height:c,secondMoreTabWidth:this.RC(),moreTabPos:t.x+t.width-this.AJc()-this.TC()-e}},u.prototype.getPreMoreTabBounds=function(){return{x:this.VC()-this.QC(),width:this.QC()}},u.prototype.YC=function(){return this.zJc()?this.ZC+this.WC[this.$C]>this._C():this.ZC+2*this.BJc>this._C()},u.prototype._C=function(){return this.zJc()?this.Dr().width-this.AJc()-this.TC()-this.RC():this.Dr().height-this.PC()},u.prototype.aD=function(){return 6},u.prototype.Via=function(){return["blank","nextButton"]},u.prototype.cD=function(){return this.VC()},u.prototype.CJc=function(t,e){var o;t.save(),t.beginPath(),o=d.Im.Km(0,"gc-tabStripBackground").backgroundColor,this.eD=i(o),t.fillStyle=o,t.fillRect(e.x,e.y,e.width,e.height),t.restore()},u.prototype.DJc=function(t,e){var o,n,r,i,a=this.OC,s=a&&a.options.tabStripPosition,l=d.Im.Km(0,"gc-tabStripBackground").borderTopColor;t.save(),t.beginPath(),t.strokeStyle=l,s===A.TabStripPosition.bottom?(o=e.x,n=e.y,r=e.x+e.width,i=e.y+.5):s===A.TabStripPosition.top?(o=e.x,n=e.height-.5,r=e.x+e.width,i=e.y+e.height-.5):s===A.TabStripPosition.left?(o=e.x+e.width-.5,n=e.y,r=e.x+e.width-.5,i=e.y+e.height):s===A.TabStripPosition.right&&(o=e.x+.5,n=e.y,r=e.x+.5,i=e.y+e.height),t.moveTo(o,n),t.lineTo(r,i),t.stroke(),t.restore()},u.prototype.dD=function(t,e){this.CJc(t,e),this.DJc(t,e)},u.prototype.fD=function(t,e,o){var n,r,i,a,s=this,l=s.OC.options.newTabVisible,u=s.zJc(),c=s.VC(),h=s.IC,f=o,p=h;u?(f+=r=s.RC(),(i=e.x+e.width-s.AJc()-s.TC())<f&&((a=(f=i)-r)<c&&(f=(a=c)+h),s.gD(t,a,0,r,e.height)),n=e.height):(f=(e.width-c)/2,p=n=c),l&&s.hD(t,f,0,p,n,-2===s.iD)},u.prototype.jD=function(t,e,o,n){var r=this.QC();this.gD(t,n-r,0,r,e.height)},u.prototype.kD=function(t,e){var o,n,r=this,i=r.zJc(),a=r.EJc,s=r.NC(),l=r.PC(),u=r.lD;i?(o=r.AJc()/2+s/2,n=l/2,r.mD(t,o,n,o+a,n+a,o+a,n-a,g.NavButtonDirection.left,c,1===u),o+=s,r.mD(t,o,n,o-a,n+a,o-a,n-a,g.NavButtonDirection.right,c,2===u)):(o=(e.width-s)/2,n=e.height-l/2,r.mD(t,o,n,o+a,n+a,o-a,n+a,g.NavButtonDirection.top,c,1===u),o+=s,r.mD(t,o,n,o-a,n+a,o-a,n-a,g.NavButtonDirection.bottom,c,2===u))},u.prototype.nD=function(t,e){var o,n,r=this.AJc(),i=d.Im.Km(0,"gc-tabStripResizeBarInner");this.OC.options.showHorizontalScrollbar&&(t.beginPath(),t.rect(e.x+e.width-r,0,r,e.height),t.clip(),o=e.x+e.width-r/2,n=e.y+e.height/2,t.fillStyle=i.color,t.fillRect(o,n,2,2),t.fillRect(o,n-4,2,2),t.fillRect(o,n+4,2,2))},u.prototype.FJc=function(t,e,o,n,r,i,a,s){var l=this.OC.options.tabStripPosition,u=this.GJc,c=this.wJc,h=this.vJc,f=this.HJc,p=this.zJc();t.save(),s&&a&&(t.fillStyle=c,l===A.TabStripPosition.bottom?t.fillRect(e,o,n,r-h):l===A.TabStripPosition.top?t.fillRect(e,o+h,n,r):l===A.TabStripPosition.left?t.fillRect(e+u,o,n-u,r):t.fillRect(e,o,n-u,r)),a?(t.fillStyle=c,l===A.TabStripPosition.bottom?t.fillRect(e,o+1,n,r-h):l===A.TabStripPosition.top?t.fillRect(e,o+h-1,n,r):s?l===A.TabStripPosition.left?t.fillRect(e+u,o,n-u,r+1):t.fillRect(e,o,n-u,r+1):t.fillRect(e+u,o,n-2*u,r+1)):s&&(t.fillStyle=c,l===A.TabStripPosition.bottom?t.fillRect(e,o,n,1):l===A.TabStripPosition.top?t.fillRect(e,o+r,n,1):l===A.TabStripPosition.left?t.fillRect(e+u,o,n-u,r+1):t.fillRect(e,o,n-u,r+1)),t.fillStyle=i,p?t.fillRect(e+f,o+f,n-2*f+1,r-2*f):s?l===A.TabStripPosition.left?t.fillRect(e+u,o,n-u,r+1):t.fillRect(e,o,n-u,r+1):t.fillRect(e+u,o,n-2*u,r+1),t.restore()},u.prototype.IJc=function(t,e,o,n,r,i,a){var s=this.OC.options.tabStripPosition,l=this.vJc,u=this.GJc,c=this.zJc();t.save(),c?(t.beginPath(),t.lineWidth=1,t.strokeStyle=i&&i.borderLeftColor,a?s===A.TabStripPosition.bottom?(t.moveTo(e+.5,o),t.lineTo(e+.5,o+r-l),t.moveTo(e+n+.5,o),t.lineTo(e+n+.5,o+r-l)):s===A.TabStripPosition.top&&(t.moveTo(e+.5,o+l),t.lineTo(e+.5,o+r),t.moveTo(e+n+.5,o+l),t.lineTo(e+n+.5,o+r)):(t.moveTo(e+.5,o+l),t.lineTo(e+.5,o+r-l),t.moveTo(e+n+.5,o+l),t.lineTo(e+n+.5,o+r-l))):(t.beginPath(),t.lineWidth=1,t.strokeStyle=i&&i.borderLeftColor,a?s===A.TabStripPosition.left?(t.moveTo(e+u,o+.5),t.lineTo(e+u+n,o+.5),t.moveTo(e+u,o+r+.5),t.lineTo(e+u+n,o+r+.5)):(t.moveTo(e,o+.5),t.lineTo(e+n-u,o+.5),t.moveTo(e,o+r+.5),t.lineTo(e+n-u,o+r+.5)):(t.moveTo(e+u,o+.5),t.lineTo(e-u+n,o+.5),t.moveTo(e+u,o+r+.5),t.lineTo(e-u+n,o+r+.5))),t.stroke(),t.restore()},u.prototype.JJc=function(t,e,o,n,r,i,a){var s=this.OC.options.tabStripPosition,l=this.vJc,u=this.GJc;a&&(t.save(),t.beginPath(),t.strokeStyle=i&&i.borderBottomColor,t.lineWidth=2,s===A.TabStripPosition.bottom?(t.moveTo(e,o+r-l),t.lineTo(e+n+1,o+r-l)):s===A.TabStripPosition.top?(t.moveTo(e,o+l),t.lineTo(e+n+1,o+l)):s===A.TabStripPosition.left?(t.moveTo(e+u,o),t.lineTo(e+u,o+r+1)):(t.moveTo(n-u,o),t.lineTo(n-u,o+r+1)),t.stroke(),t.restore())},u.prototype.KJc=function(t,e,o,n,r,i,a,s,l,u,c){var h,f,p,d,g,m,y=this.OC.options.tabStripPosition,b=this.GJc,v=this.HJc,C=this.LJc,w=this.OC.MJc(i),x=w&&w.options.sheetTabColor;t.save(),t.textBaseline="top","string"==typeof s&&(h=s),f=this.qD(a,h),t.fillStyle=f,(c||u||l)&&(t.font=T.To.Ro(t.font,"bold")),p=this.EC,t.textBaseline="middle",y===A.TabStripPosition.bottom?t.fillText(i,e+p,o+r/2-1):y===A.TabStripPosition.top?t.fillText(i,e+p,o+r/2+1):(t.beginPath(),d=e+n-2*b-2*v-2-1,t.rect(e+b,o+.5,d+v,r+.5),t.clip(),t.fillText(i,e+b+v,o+r/2+2),g=t.measureText(C).width,d<t.measureText(i).width-g&&(t.beginPath(),m=x?s:u||l?this.wJc:S.bc(this.eD),t.fillStyle=m,t.fillRect(e+b+v+d-g,o+1.5,d,r-1.5),t.fillStyle=f,t.fillText(C,e+b+v+d-g,o+r/2+2))),t.restore()},u.prototype.oD=function(t,e,o,n,r,i,a,s,l,u){var c,h,f,p=A.VisualState.normal;s&&(p=A.VisualState.hover),u&&(p=A.VisualState.selected),a&&(p=A.VisualState.active),a&&!u&&(p=A.VisualState.activeNotSelected),c=d.Im.Km(p,"gc-tab-"+d.Im.Jm(p)),h=d.Im.Km(0,"gc-tab-"+d.Im.Jm(0)),f=this.pD(t,a,l,h,o),this.FJc(t,e,o,n,r,f,u,a),this.IJc(t,e,o,n,r,h,a),this.JJc(t,e,o,n,r,c,u),this.KJc(t,e,o,n,r,l,c,f,u,a,s)},u.prototype.mD=function(t,e,o,n,r,i,a,s,l,u){var c,h,f,p;t.save(),c=s===g.NavButtonDirection.left||s===g.NavButtonDirection.top,h=A.VisualState.highlight,u&&(h=A.VisualState.hover),c?(s===g.NavButtonDirection.left?e-=2:o-=2,-1===this.rw(this.gq)&&(h=A.VisualState.normal)):(s===g.NavButtonDirection.right?e+=2:o+=2,-1===this.rD(this.sD())&&(h=A.VisualState.normal)),f=d.Im.Km(h,"gc-navButton-"+d.Im.Jm(h)),t.strokeStyle=this.tD(f.borderTopColor),t.beginPath(),p=c?1:-1,s===g.NavButtonDirection.left||s===g.NavButtonDirection.right?(t.moveTo(e-.5,o),t.lineTo(e-.5,o+1),t.moveTo(e+p-.5,o-1),t.lineTo(e+p-.5,o+2),t.moveTo(e+2*p-.5,o-2),t.lineTo(e+2*p-.5,o+3),t.moveTo(e+3*p-.5,o-3),t.lineTo(e+3*p-.5,o+4)):s!==g.NavButtonDirection.top&&s!==g.NavButtonDirection.bottom||(t.moveTo(e,o-.5),t.lineTo(e+1,o-.5),t.moveTo(e-1,o+p-.5),t.lineTo(e+2,o+p-.5),t.moveTo(e-2,o+2*p-.5),t.lineTo(e+3,o+2*p-.5),t.moveTo(e-3,o+3*p-.5),t.lineTo(e+4,o+3*p-.5)),t.stroke(),t.restore()},u.prototype.hD=function(t,e,o,n,r,i){var a,s,l;t.save(),t.beginPath(),a=(r-2*this.NJc)/2,s=A.VisualState.highlight,i&&(s=A.VisualState.hover),l=d.Im.Km(s,"gc-tabStripNewTab-"+d.Im.Jm(s)),t.lineWidth=1.5,t.strokeStyle=this.tD(l.borderTopColor),t.arc(e+n/2,o+r/2,a,0,2*Math.PI),t.stroke(),t.beginPath(),t.lineWidth=2,t.moveTo(e+n/2-4,o+r/2),t.lineTo(e+n/2+4,o+r/2),t.moveTo(e+n/2,o+r/2-4),t.lineTo(e+n/2,o+r/2+4),t.stroke(),t.restore()},u.prototype.gD=function(t,e,o,n,r){var i,a,s;t.save(),t.beginPath(),i=A.VisualState.highlight,5!==(a=this.lD)&&6!==a||(i=A.VisualState.hover),s=d.Im.Km(i,"gc-navMoreButton-"+d.Im.Jm(i)),t.fillStyle=this.tD(s.borderTopColor),t.fillRect(e+n/2,o+r/2,2,2),t.fillRect(e+n/2-4,o+r/2,2,2),t.fillRect(e+n/2+4,o+r/2,2,2),t.restore()},u.prototype.tD=function(t){var e=i(t),o=this.eD;return e.a<=.01?r(o):S.hc(o,e)?r(e):t},e.iv=u},"./dist/core/workbook/sheettab2007.js":function(t,e,o){"use strict";var n,r,A,S,T,M,I,N,R,k,E,D,i,h,a,s,l=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function u(t){var e=s.call(this,t)||this,o=e;return o.EC=12,o.GC=8,o.HC=3,o.kw=12,o.KC=48,o.LC=5,o._font="10pt Arial",e}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/core.ns.js"),r=o("@grapecity/js-sheets-common"),A=o("./dist/core/util/common.js"),S=o("./dist/core/workbook/sheettabbase.js"),T=o("./dist/core/worksheet/stylehelper.js"),M=o("./dist/core/core.enum.js"),I=A.Ul.wl,N=null,R=Math.min,k=Math.max,E="#92A5C7",D="linear-gradient",i=new r.Common.ResourceManager(n.SR),h=i.getResource.bind(i),s=S.DC,l(u,s),u.prototype.NC=function(){var t=this.OC,e=t&&t.options;return e&&e.tabNavigationVisible?t.Wv()*(e.useTouchLayout?2:1):0},u.prototype.PC=function(){var t=this.OC;return t&&t.options.tabNavigationVisible?t.Wv():0},u.prototype.VC=function(){return this.zJc()?4*this.NC()+this.lE():this.TC()},u.prototype.lE=function(){var t=this.OC;return t&&t.options.tabNavigationVisible?2:0},u.prototype.getResizeBarBounds=function(){var t=this.Dr();return{x:t.x+t.width-this.AJc(),y:N,width:this.AJc(),height:N}},u.prototype.getNavButtonBounds=function(){var t,e,o,n,r,i,a;return n=this.zJc()?(t=0,e=N,o=this.NC(),N):(r=this.Dr(),i=this.PC(),a=this.NC(),t=r.width/2-2*a,e=r.height-i,o=a,i),{x:t,y:e,width:o,height:n,startIndex:0,endIndex:4}},u.prototype.getSheetTabBounds=function(){return{x:this.VC(),y:N,height:N,secondMoreTabWidth:0,moreTabPos:0}},u.prototype.getPreMoreTabBounds=function(){return{x:this.VC(),width:this.HC+this.LC}},u.prototype.YC=function(){return this.zJc()?this.ZC+this.WC[this.$C]+this.TC()>this._C():this.ZC+2*this.BJc>this._C()},u.prototype._C=function(){return this.zJc()?this.Dr().width-this.AJc():this.Dr().height-this.PC()},u.prototype.aD=function(){return this.zJc()?1:4},u.prototype.Via=function(){return["newSheet"]},u.prototype.cD=function(){var t=this.zJc(),e=this.VC();return t&&(e+=this.Dr().height,this.OC.options.newTabVisible&&(e+=this.TC(),e+=this.HC)),e},u.prototype.dD=function(t,e){var o,n,r,i,a,s,l,u;if(t.save(),t.beginPath(),o=t.createLinearGradient(e.x,e.y,e.width,e.height),r=(n=A.Im.Km(0,"gc-tabStripBackground"))&&n.backgroundImage,i=n&&n.backgroundColor,r&&-1!==r.indexOf(D))for(s=0,l=(a=I(r)).length;s<l;s++)u=a[s],o.addColorStop(u.point,u.color);else i&&(o.addColorStop(0,"#DDDDDD"),o.addColorStop(1,i));t.fillStyle=o,t.fillRect(e.x,e.y,e.width,e.height),t.restore()},u.prototype.fD=function(t,e,o){var n,r,i,a,s,l=this.OC,u=h().NewTab,c=this.zJc();l.options.newTabVisible&&(i=r=n=void 0,a=-2===this.iD,c?(this.KC=t.measureText(u).width+this.EC,n=o,r=this.TC(),i=e.height,this.oD(t,n,0,r,i,void 0,!1,a,u,!1)):(s=S.NEW_TAB_SIZE_ASIDE,this.KC=s,n=(e.width-s)/2,i=r=s,this.OJc(t,n,0,r,i,a)))},u.prototype.OJc=function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d;if(t.save(),t.beginPath(),a=(r-2*this.NJc)/2,s=M.VisualState.normal,i&&(s=M.VisualState.hover),l=A.Im.Km(s,"gc-tab-"+A.Im.Jm(s)),(u=i?l.backgroundColor:l.backgroundImage)&&-1!==u.indexOf(D))for(c=t.createLinearGradient(e+.7*r,o+0,.7*r,r),f=0,p=(h=I(u)).length;f<p;f++)d=h[f],c.addColorStop(d.point,d.color);else c=u;t.lineWidth=1.5,t.strokeStyle=c,t.arc(e+n/2,o+r/2,a,0,2*Math.PI),t.stroke(),t.beginPath(),t.lineWidth=2,t.moveTo(e+n/2-4,o+r/2),t.lineTo(e+n/2+4,o+r/2),t.moveTo(e+n/2,o+r/2-4),t.lineTo(e+n/2,o+r/2+4),t.stroke(),t.restore()},u.prototype.jD=function(t,e,o,n){var r=o-1,i=this.WC[r];this.oD(t,n+this.LC-i-this.HC,0,i,e.height,r,this.$C===r,this.iD===r,"",!1)},u.prototype.kD=function(t,e){var o,n,r=this,i=r.zJc(),a=r.VC(),s=r.EJc,l=r.NC(),u=r.PC(),c=r.lD;t.fillStyle=E,i?t.fillRect(e.x,e.y,a-1,e.height):t.fillRect(e.x,e.height-u,e.width,u),i?(o=l/2,n=u/2,r.mD(t,o,n,o+s,n+s,o+s,n-s,S.NavButtonDirection.left,o-s,0===c),o+=l,r.mD(t,o,n,o+s,n+s,o+s,n-s,S.NavButtonDirection.left,N,1===c),o+=l,r.mD(t,o,n,o-s,n+s,o-s,n-s,S.NavButtonDirection.right,N,2===c),o+=l,r.mD(t,o,n,o-s,n+s,o-s,n-s,S.NavButtonDirection.right,o+4,3===c)):(o=e.width/2-1.5*l,n=e.height-u/2,r.mD(t,o,n,o+s,n+s,o-s,n+s,S.NavButtonDirection.top,n-s,0===c),o+=l,r.mD(t,o,n,o+s,n+s,o-s,n+s,S.NavButtonDirection.top,N,1===c),o+=l,r.mD(t,o,n,o+s,n-s,o-s,n-s,S.NavButtonDirection.bottom,N,2===c),o+=l,r.mD(t,o,n,o+s,n-s,o-s,n-s,S.NavButtonDirection.bottom,n+s,3===c))},u.prototype.nD=function(t,e){var o,n=this.OC,r=this.AJc(),i=A.Im.Km,a=i(4,"gc-tabStripResizeBarInner"),s=i(0,"gc-tabStripResizeBarOuter");n.options.showHorizontalScrollbar&&(o=e.x+e.width-r,t.fillStyle=s.backgroundColor,t.fillRect(o,e.y,r,e.height),t.fillStyle=a.backgroundColor,t.fillRect(1+o,e.y+1,r-2,e.height-2),t.fillStyle=a.color,t.fillRect(o+r/2-1,e.y+4,2,e.height-8))},u.prototype.oD=function(t,e,o,n,r,i,a,s,l,u){var c,h=this.zJc(),f=M.VisualState.normal;(s||u)&&(f=M.VisualState.hover),c=A.Im.Km(f,"gc-tab-"+A.Im.Jm(f)),h?this.PJc(t,e,o,n,r,l,c,u,a,s):this.QJc(t,e,o,n,r,i,l,c,u,a,s)},u.prototype.PJc=function(t,e,o,n,r,i,a,s,l,u){var c,h,f,p=this.OC.options.tabStripPosition,d=this.RJc;t.save(),t.beginPath(),p===M.TabStripPosition.bottom?(t.moveTo(e,o),t.lineTo(e,o+r-d),t.arcTo(e,o+r,e+n,o+r,d),t.lineTo(e+n,o+r),t.lineTo(e+n+r,o),l||t.lineTo(e,o)):(t.moveTo(e,o+r),t.lineTo(e,o-d),t.arcTo(e,o,e+n,o,d),t.lineTo(e+n,o),t.lineTo(e+n+r,o+r),l||t.lineTo(e,o+r)),c=this.pD(t,s||u,i,a),t.fillStyle=c,t.fill(),t.strokeStyle=E,t.stroke(),t.textBaseline="top","string"==typeof c&&(h=c),t.fillStyle=this.qD(a,h),l&&(t.font=T.To.Ro(t.font,"bold")),f=this.EC,t.textBaseline="middle",t.fillText(i,e+f,o+r/2),t.restore()},u.prototype.QJc=function(t,e,o,n,r,i,a,s,l,u,c){var h,f,p,d,g,m=this.OC.options.tabStripPosition,y=i===this.OC.sheets.length-1,b=this.RJc,v=this.GJc,C=this.EJc,w=this.HJc,x=this.LJc;t.save(),t.beginPath(),m===M.TabStripPosition.left?(e+=v,n-=v,t.moveTo(e+n,o),t.lineTo(e+b,o),t.arcTo(e,o,e,o+b,b),t.lineTo(e,o+r-b),t.arcTo(e,o+r,e+b,o+r,b),y?t.lineTo(e+n,o+r):(t.lineTo(e+n-C,o+r),t.lineTo(e+n,o+r+C)),u||t.lineTo(e+n,o)):(n-=v,t.moveTo(e,o),t.lineTo(e+n-b,o),t.arcTo(e+n,o,e+n,o+b,b),t.lineTo(e+n,o+r-b),t.arcTo(e+n,o+r,e+n-b,o+r,b),y?t.lineTo(e,o+r):(t.lineTo(e+C,o+r),t.lineTo(e,o+r+C)),u||t.lineTo(e,o)),h=this.pD(t,l||c,a,s,o),t.fillStyle=h,t.fill(),t.strokeStyle=E,t.stroke(),t.textBaseline="top","string"==typeof h&&(f=h),p=this.qD(s,f),t.fillStyle=p,u&&(t.font=T.To.Ro(t.font,"bold")),t.textBaseline="middle",t.beginPath(),d=n-2*v,t.rect(e,o,d,r),t.clip(),t.fillText(a,e+v+w,o+r/2+2),g=t.measureText(x).width,d<t.measureText(a).width-g&&(t.beginPath(),t.fillStyle=h,t.fillRect(e+d-g,o+1.5,d,r-2.5),t.fillStyle=p,t.fillText(x,e+d-g,o+r/2+2)),t.restore()},u.prototype.mD=function(t,e,o,n,r,i,a,s,l,u){var c,h,f,p,d,g,m,y,b,v,C,w,x,T;if(t.save(),c=this.zJc(),h=s===S.NavButtonDirection.left||s===S.NavButtonDirection.top,f=this.Dr(),p=this.NC(),g=(d=A.Im.Km)(4,"gc-navButton-hover"),y=(m=d(0,"gc-navButton-normal"))&&m.backgroundColor,(b=m&&m.backgroundImage)&&-1!==b.indexOf(D))for(v=t.createLinearGradient(f.x+.7*f.height,f.y+0,.7*f.height,f.height),w=0,x=(C=I(b)).length;w<x;w++)T=C[w],v.addColorStop(T.point,T.color);c&&(u?(t.fillStyle=g.backgroundColor,t.fillRect(e-p/2+2,f.y+2,p-4,f.height-4)):(v?t.fillStyle=v:y&&(t.fillStyle=y),t.fillRect(e-p/2,f.y+1,p,f.height-2))),t.fillStyle=c?u?g.color:m.color:!u&&v||y,void 0!==l&&l!==N&&(s===S.NavButtonDirection.left||s===S.NavButtonDirection.right?t.fillRect(l,R(r,a),1,k(r,a)-R(r,a)):t.fillRect(R(n,i),l,k(n,i)-R(n,i),1)),h?s===S.NavButtonDirection.left?(e-=2,n-=2,i-=2):(o-=2,r-=2,a-=2):s===S.NavButtonDirection.right?(e+=2,n+=2,i+=2):(o+=2,r+=2,a+=2),t.beginPath(),t.moveTo(e,o),t.lineTo(n,r),t.lineTo(i,a),t.lineTo(e,o),t.fill(),t.restore()},e.jv=u},"./dist/core/workbook/sheettabbase.js":function(t,e,o){"use strict";var n,r,A,T,a,S,i,w,s,M,I,l,h,N,R,u,k,m,y,g,c,f,p,d,b,v,C,x,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J;function Z(t,e,o){t.Wq(T.Events.SheetTabClick,{sheet:e,sheetName:e?e.name():k,sheetTabIndex:M(o)?-1:o})}function q(t,e,o,n,r){return(o<n&&n<t||n<=o&&t<n)&&(e=function(t,e,o,n){var r;if(o<e)for(r=o;r<e;r++)t-=n[r];else if(e<o)for(r=e;r<o;r++)t+=n[r];return t}(e,t,n,r),t=n),{index:t,position:e}}function K(t){this.Cj=t,this.SC=!1,this.LC=0,this.HC=0,this.GJc=6,this.SJc=3,this.RJc=5,this.EJc=5,this.HJc=3,this.NJc=7,this.LJc="...",this.buffer=null;var e=this;e.OC=k,e.$C=0,e.gq=0,e.ZC=70,e.lD=-1,e.iD=-1,e._font="",e.WC=[],e.BJc=0,e.uD=-1,e.vD=-1,e.wD=k,e.xD=0,e.Us(new T.Rect(0,0,200,28))}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/core.ns.js"),r=o("@grapecity/js-sheets-common"),A=o("./dist/core/util/domUtil.js"),T=o("./dist/core/util/common.js"),a=o("./dist/core/worksheet/stylehelper.js"),S=o("./dist/core/core.enum.js"),i=r.Common.pc,w=T.Ul.wl,s=T.Ul.bq,M=r.Common.j.Fa,I=T.Ul.Nl,l=T.Ul.fp,h=T.Ul.lZa,N=parseInt,R=window,u=document,k=null,m=Math.max,y=Math.min,g=Math.pow,Math.round,f="mousedown"+(c=".gcTab"),p="mousemove"+c,d="mouseup"+c,b="mouseout"+c,v="dblclick"+c,C="mousemove.spliter",x="mouseup.spliter",D="keydown"+(E=".tabNameEditor"),j="focus"+E,_="blur"+E,O="resize",P="tab",L="newSheet",H="blank",B="white",V=F="navButton",z="sheetTab",e.NEW_TAB_SIZE_ASIDE=28,W=new r.Common.ResourceManager(n.SR),G=W.getResource.bind(W),(J=e.NavButtonDirection||(e.NavButtonDirection={}))[J.left=0]="left",J[J.right=1]="right",J[J.top=2]="top",J[J.bottom=3]="bottom",K.prototype.getNewTabBounds=function(){var t,e,o,n,r=this.OC.options.useTouchLayout,i=this.Dr(),a=this.TC(),s=(a-2*this.NJc)/2;return n=r?(t=i.x,e=i.y,o=i.width,a):(t=(i.x+i.width-2*s)/2,e=(i.y+a-2*s)/2,o=2*s),{x:t,y:e,width:o,height:n}},K.prototype.zJc=function(){var t=this.OC.options.tabStripPosition;return t===S.TabStripPosition.bottom||t===S.TabStripPosition.top},K.prototype.ws=function(t){var e,o;t&&((e=this).Xs&&e.no(!0),o=I("canvas"),T.En.Kn(o,e.OC),o.setAttribute("id",e.Cj),e.yD=e.zD(),e.TJc(),t.appendChild(e.yD[0]),t.appendChild(o),e.Xs=o,A.GC$(o).bind(f,function(t){return e.AD(t)}).bind(p,function(t){return e.BD(t)}).bind(d,function(t){return e.CD(t)}).bind(b,function(t){return e.DD(t)}).bind(v,function(t){return e.ED(t)}).bind("mousewheel.gcTab",function(t){return e.Rw(t)}),e.fq(),K.ao(e,"setHost"))},K.prototype.Yv=function(t){var e;(this.OC=t)&&((e=t.options.font)&&0<e.length&&(this._font=e),this.TJc())},K.prototype.RIc=function(t){var e=this.OC;e.suspendPaint(),this.SIc(t),e.resumePaint()},K.prototype.SIc=function(t){var e,o,n,r=this,i=r.OC,a=r.zJc(),s=r.BJc,l=r._C(),u=0,c=r.WC,h=r.cD(),f=r.sD();if(r.TIc().tabsInfo[0].index>t)i.startSheetIndex(t);else{for(e=t-1;0<=e;e--)if(t=f[e],u+=a?c[t]:s,e!==f.length-1&&(u+=a?r.HC:0),n=h+u,0!==e&&(n+=a?r.LC:s),l<n){o=e=a?e+1:e;break}o&&i.startSheetIndex(o)}},K.prototype.Dr=function(){var t=this.Zs;return new T.Rect(t.x,t.y,t.width,t.height)},K.prototype.Us=function(t){var e=this.Zs=new T.Rect(0,0,0,0);e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height},K.prototype.TC=function(){return this.OC.options.newTabVisible?this.KC:0},K.prototype.UC=function(){var t=this.Dr();return this.zJc()?t.x+t.width-this.AJc():t.y+t.height-this.PC()},K.prototype.VC=function(){return 0},K.prototype.AJc=function(){var t=S.TabStripPosition.bottom,e=this.OC;return e&&(t=e.options.tabStripPosition),t===S.TabStripPosition.bottom?this.kw:0},K.prototype.fq=function(){var t,e,o,n,r=this.Ws();r&&r.parentNode&&0!==(t=A.GC$(r.parentNode)).width()&&0!==t.height()&&(e=m(t.width(),0),o=m(t.height(),0),r.style.display="none",r.width=e,r.height=o,r.style.display="",r.style.width=e+"px",r.style.height=o+"px",e=r.clientWidth||r.width,o=r.clientHeight||r.height,n=this.Dr(),this.Us(new T.Rect(n.x,n.y,e,o)),T.En.Pn(r,e,o),this.repaint())},K.prototype.YC=function(){return!1},K.prototype.PC=function(){return 0},K.prototype._C=function(){return 0},K.prototype.aD=function(){return 0},K.prototype.Via=function(){return[]},K.prototype.cD=function(){return 0},K.prototype.zD=function(){return this.yD?this.yD:A.GC$(I("div"))},K.prototype.TJc=function(){var t,e,o,n=this.yD;n&&(o=void 0,(e=(t=this.OC)?t.options.tabStripPosition:S.TabStripPosition.bottom)===S.TabStripPosition.bottom?o="gc-tab-indicator-bottom":e===S.TabStripPosition.top?o="gc-tab-indicator-top":e===S.TabStripPosition.left?o="gc-tab-indicator-left":e===S.TabStripPosition.right&&(o="gc-tab-indicator-right"),n.removeClass(),n.addClass(o))},K.prototype.no=function(t){var e,o=this.Xs;o&&(e=o.parentNode,A.GC$(o).unbind(f).unbind(p).unbind(d).unbind(v).unbind(b),e&&e.removeChild(o)),A.GC$(this.yD).remove(),K.ao(this,"dispose"),t||(this.OC=k)},K.prototype.UJc=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y=this,b=y.OC,v=b.options.scrollbarAppearance===S.ScrollbarAppearance.mobile,C=b.options.showHorizontalScrollbar,w=y.Dr();if(C&&!v&&(o=y.getResizeBarBounds(),b.options.showHorizontalScrollbar&&!v&&t>o.x&&t<w.x+w.width))return{type:"resize",element:O};for(r=-1,i=(n=y.getNavButtonBounds()).startIndex,a=n.x,s=n.endIndex,l=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],u=i;u<s;u++){if(a<t&&t<a+n.width){F=l[r=u];break}a+=n.width}if(-1!==r)return{type:V,element:F,index:u};if(a=(c=y.getPreMoreTabBounds()).x,h=0,-1!==y.rw(y.gq)){if(a<=t&&t<a+c.width)return{type:V,element:F=l[5],index:5,position:a};h=y.LC}if(f=y.getSheetTabBounds(),p=b.yJc(),d=y.WC,g=y.HC,m=0,a=f.x+h,-1<y.gq)for(u=y.gq;u<p.length&&u<d.length;u++)if(p[u].visible()){if(m=d[u],a<t&&t<a+m+g){if(0<f.moreTabPos&&t<f.moreTabPos)return{type:z,element:P,index:u,position:a};if(0===f.moreTabPos)return{type:z,element:P,index:u,position:a}}a+=m+g}if(a>f.moreTabPos&&0<f.moreTabPos&&(a=f.moreTabPos),-1!==y.rD(y.sD())){if(a<t&&t<a+f.secondMoreTabWidth)return{type:V,element:F=l[6],index:6,position:a}}else if(a<t&&t<a+f.secondMoreTabWidth)return{element:H,position:a};return a+=f.secondMoreTabWidth,b.options.newTabVisible&&a<t&&t<a+y.TC()?{type:z,element:L,position:a,index:-1}:{element:H}},K.prototype.VJc=function(t,e){var o,n,r,i,a,s=this,l=s.OC,u=s.getNavButtonBounds(),c=-1,h=u.x,f=u.y,p=u.startIndex,d=u.endIndex,g=["first","prevArrow","nextArrow","last","","prevButton","nextButton"];for(o=p;o<d;o++){if(h<t&&t<h+u.width&&f<e&&e<f+u.height){F=g[c=o];break}h+=u.width}if(-1!==c)return{type:V,element:F,index:o};if(f=s.TC(),n=l.yJc(),r=s.WC,i=s.BJc,-1<s.gq)for(o=s.gq;o<n.length&&o<r.length;o++)if(n[o].visible()){if(f<e&&e<f+i)return{type:z,element:P,index:o,position:f};f+=i}return a=s.getNewTabBounds(),l.options.newTabVisible&&a.x<t&&t<a.x+a.width&&a.y<e&&e<a.y+a.height?{type:z,element:L,position:f,index:-1}:f<e&&e<f+u.y?-1!==s.rD(s.sD())?{type:V,element:F=g[6],index:6,position:f}:{element:H,position:f}:{element:H}},K.prototype.hitTest=function(t,e){return this.zJc()?this.UJc(t,e):this.VJc(t,e)},K.prototype.AD=function(t){var e,o,n,r,i,a,s,l=this,u={e:t,r:k};return K.ao(l,"preProcessMouseDown",u),M(e=u.r)?(o=A.GC$(l.Ws()).offset(),n=t.pageX-o.left,r=t.pageY-o.top,i=l.OC.WJc(),l.FD&&l.GD(i,!1),s=(a=l.hitTest(n,r)).element,0===t.button&&(s===O?(l.HD=!0,l.ID=t.pageX,l.tC()):s===F?l.JD(a.index):s===P?(l.KD(a.index,a.position,t),l.LD(t,a)):s===L&&l.MD(a.position),(i=l.OC.WJc())&&!i.isEditing()&&i.zt()),!(l.ND=!0)):e},K.prototype.BD=function(t){var e,o,n,r,i,a,s,l,u,c,h,f=this,p=f.OC,d={e:t,r:k};if(K.ao(f,"preProcessMouseMove",d),!M(e=d.r))return e;if(o=f.Xs.style,f.OD&&!f.PD&&10<Math.sqrt(g(f.OD.x-t.pageX,2)+g(f.OD.y-t.pageY,2))&&(f.PD=!0),f.HD)o.cursor="w-resize",n=t.pageX-f.ID,r=f.OC.xs.clientWidth,p.options.tabStripRatio=p.Iv()+n/r,i=f.AJc()/r,p.Iv()<i?(p.options.tabStripRatio=i,f.ID=f.AJc()):1<=p.Iv()?(p.options.tabStripRatio=1,f.ID=r):f.ID=t.pageX,p.aq();else if(f.PD)f.QD(t.pageX,t.pageY),f.RD(t);else{if(f.lD=-1,f.iD=-1,a=A.GC$(f.Ws()).offset(),s=t.pageX-a.left,l=t.pageY-a.top,c=(u=f.hitTest(s,l)).element,f.OC&&f.OC.options.enableAccessibility&&(h=f.cgc(u),f.OC.dgc(h)),""===c)return o.cursor="default",f.repaint(),!1;c===O?o.cursor="w-resize":(o.cursor="default",c===F?f.lD=u.index:c===P?f.iD=u.index:c===L&&(f.iD=-2)),f.repaint()}return!1},K.prototype.cgc=function(t){var e,o=G(),n="",r=t.element;return r===O?n=o.ARIA_Resize:r===F?n={first:o.ARIA_First,prevArrow:o.ARIA_PreviousArrow,nextArrow:o.ARIA_NextArrow,last:o.ARIA_Last,prevButton:o.ARIA_PreviousButton,nextButton:o.ARIA_NextButton}[F]||"":r===P?(e=this.OC.XJc(t.index).name(),n=o.ARIA_SheetTab+" "+e.replace(/([0-9]+)/," $1 ")):r===L?n=o.ARIA_NewSheet:r===H&&(n=o.ARIA_Blank),n},K.prototype.CD=function(t){var e,o=this,n={e:t,r:k};return K.ao(o,"preProcessMouseUp",n),M(e=n.r)?(o.HD&&(o.HD=!1,o.OC.aq()),o.SD(),o.PD&&(o.PD=!1,o.TD.remove(),o.UD(),o.yD.hide()),o.OD=k,o.VD(),o.uC(),!o.ND||(o.ND=!1)):e},K.prototype.DD=function(t){var e,o,n,r={e:t,r:k};return K.ao(this,"preProcessMouseOut",r),M(e=r.r)?(this.VD(),o=this.lD,this.lD=-1,n=this.iD,this.iD=-1,this.lD===o&&this.iD===n||this.repaint(),!1):e},K.prototype.tC=function(){var t,e=this;e.WD||(A.GC$(u).bind(C,function(t){e.BD(t)}).bind(x,function(t){e.CD(t)}),(t=e.OC.getActiveSheet())&&(t.XD=!0),e.WD=!0)},K.prototype.uC=function(){if(this.WD){this.WD=!1,A.GC$(u).unbind(C).unbind(x);var t=this.OC.getActiveSheet();t&&delete t.XD}},K.prototype.JD=function(t,e){var o,n=this;n.VD(),(o=n.sD()).length<=0||(0==(t%=4)?n.YD(o):1===t?(e||(n.ZD=R.setTimeout(function(){n.JD(1)},200)),n.$D(o)):2===t?(e||(n.ZD=R.setTimeout(function(){n.JD(2)},200)),n._D(o)):3===t&&n.aE(o))},K.prototype.KD=function(t,e,o){var n,r,i,a=this.OC;this.$C=t,this.ZC=e,a.suspendPaint(),n=a.getActiveSheet(),(r=a.XJc(t))&&r.isEditing()&&r!==n&&(i=n&&n._formulaTextBox&&n._formulaTextBox._isSelectMode,!r._endEditImp(void 0,void 0,i))||(Z(a,r,t),this.iw(t,o),a.resumePaint(),this.repaint())},K.prototype.BHb=function(t,e,o,n,r,i){var a={oldValue:o,newValue:n,sheetName:r,propertyName:"isSelected",cancel:!1,sheetIndex:i};t.Wq(T.Events.SheetChanging,a),a.cancel||(e.DHb(n),t&&t.YJc&&t.YJc.repaint(),delete a.cancel,t.Wq(T.Events.SheetChanged,a))},K.prototype.MD=function(t){var e,o,n,r,i,a=this,s=a.OC,l=a.zJc(),u=s.getActiveSheet();if((!a.bE||a.bE(u))&&(Z(s,k,k),e=s.yJc(),o=s.getSheetCount(),n=s.vv(s._getDefaultSheetName(o)),e.forEach(function(t){t.DHb(!1,!0)}),i={sheetName:r=n.name(),propertyName:"insertSheet",cancel:!1,sheetIndex:o},a.BHb(s,n,!1,!0,r,o),s.Wq(T.Events.SheetChanging,i),!i.cancel)){for(s.ow(o,1,n),s.Wq(T.Events.SheetChanged,{sheetName:n.name(),propertyName:"insertSheet",sheetIndex:o}),a.$C=o,a.ZC=t,s.ZJc(s.sheets.length-1,1,!1,!0);a.$C>a.gq&&(a.YC()||a.gq<a.jw(-1));)a.hE(a.gq)&&(a.ZC-=l?a.WC[a.gq]:a.BJc),a.gq++;a.repaint()}},K.prototype.iw=function(t,e){var o,n,r,i,a,s,l,u=this,c=u.OC,h=c.yJc(),f=u.zJc(),p=c.getActiveSheet(),d=!1;p&&p._formulaTextBox&&p._formulaTextBox._isSelectMode&&(d=!0),e&&(o=T.Ul.sl()?e.metaKey:e.ctrlKey,n=e.shiftKey),t!==c.eq?(o?(r=h[t]).DHb()?r.DHb(!1,!0):(r.DHb(!0,!0),p&&!p.DHb()&&p.DHb(!0,!0)):n?(i=h.slice(y(c.eq,t),m(c.eq,t)+1),h.forEach(function(t){t.visible()&&(-1!==i.indexOf(t)?t.DHb()||t.DHb(!0,!0):t.DHb()&&t.DHb(!1,!0))})):(a=h.every(function(t){return!t.visible()||t.DHb()}),h[t].DHb()&&!a||h.forEach(function(t){t.DHb(!1,!0)}),(r=h[t]).DHb()||r.DHb(!0,!0),c.ZJc(t,1,d,!0)),s=u.jw(u.gq),l=f?u.ZC+u.WC[u.$C]>u._C():u.ZC+u.BJc>=u._C(),u.$C>u.gq&&l&&-1!==s&&(u.gq=s)):n&&h.forEach(function(t){var e=t.name();c.getSheetIndex(e)!==c.eq&&t.DHb()&&t.visible()&&t.DHb(!1,!0)}),u.$C<u.gq&&(u.gq=u.rw(u.gq))},K.prototype.cE=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y=this,b=y.OC,v=y.zJc(),C=b.options.tabStripPosition,w=N(T.Im.Lm("").zIndex),x=y.hitTest(t,e);if(x.element===P){if(o=y.$C,n=b.XJc(o),x.index!==o)return;if(b.Wq(T.Events.SheetTabDoubleClick,{sheet:n,sheetName:n.name(),sheetTabIndex:o}),!b.options.tabEditable)return!1;if((r=T.Vl.Xl())&&r.endEdit&&!r.endEdit())return;T.Vl.Zl(k),i=A.GC$(y.Ws()).offset(),a=b.xv(),s=A.GC$(a).offset(),l=A.GC$(a).width(),c=(u=I("input")).style,u.type="text",u.value=n.name(),u.setAttribute("contentEditable","true"),u.setAttribute("autocomplete","off"),c.position="absolute",c.margin="0px",c.padding="0px",d=p=f=h=void 0,g=y.WC[o],v?(d=g-y.EC-y.GC+2,p=i.top-s.top+y.aD(),h=i.left-s.left+y.ZC+y.EC):(m=y.Dr(),d=g-y.EC-y.GC+2,p=i.top-s.top+y.ZC+y.aD(),h=i.left-s.left+m.x+y.GJc+y.HJc,C===S.TabStripPosition.left&&2007===w&&(h+=y.GJc),C===S.TabStripPosition.right&&l<h+d&&(f=i.left+m.width-l+y.GJc+y.HJc)),f?c.right=f+"px":h&&(c.left=h+"px"),c.top=p+"px",c.width=d+"px",c.backgroundColor=B,c.borderWidth="0px",c.outline="none",c.zIndex="1",A.GC$(u).appendTo(a),y.FD=u,A.GC$(u).addClass("gc-sheetTabEditor").bind(D,function(t){return 13===t.keyCode?(y.GD(n,!1),!1):27===t.keyCode?(y.GD(n,!0),!1):void 0}).bind(j,function(){u.selectionStart=0,u.selectionEnd=u.value.length}).bind(_,function(){y.GD(n,!1)}),u.focus()}return!1},K.prototype.ED=function(t){var e,o,n,r,i={e:t,r:k};return K.ao(this,"preProcessMouseDbClick",i),M(e=i.r)?(o=A.GC$(this.Ws()).offset(),n=t.pageX-o.left,r=t.pageY-o.top,this.cE(n,r)):e},K.prototype.Rw=function(t){var e,o,n=this.zJc(),r=!M(this.FD);return n||r||(M(t.wheelDelta)&&M(t.detail)&&(t.wheelDelta=t.originalEvent.wheelDelta,t.detail=t.originalEvent.detail),e=t.detail?t.detail:t.wheelDelta,o=this.sD(),0<e?this.$D(o):this._D(o)),!1},K.prototype.GD=function(t,e){var o,n,r,i=this.FD;i&&(A.GC$(i).unbind(D).unbind(j).unbind(_),o=i.value,!1!==e||o!==(n=t.name())&&(r={message:""},s(o,this.OC.yJc(),t,r)&&!M(o)&&""!==o?t.getParent().commandManager().execute({cmd:"renameSheet",sheetName:n,name:o}):t.Wq(T.Events.InvalidOperation,{sheet:t,sheetName:t.name(),invalidType:5,message:r.message})),i.parentNode.removeChild(i),delete this.FD)},K.prototype.dE=function(){return this.OC.options.allowSheetReorder},K.prototype.LD=function(t,e){this.dE()?(this.vD=e.index,this.TD=this.eE(this.vD),this.OD=new T.Point(t.pageX,t.pageY),this.tC()):this.PD=!1},K.prototype.eE=function(t){var e,o,n=this.OC.yJc();if(!(n.length<=t||t<0))return e=(e=n[t].name())||"sheet",(o=A.GC$(I("span")).text(e).css({position:"absolute",cursor:"default","border-radius":"5px",opacity:".7"})).addClass("ui-widget-header gc-tab-tip-span btn-primary"),o},K.prototype.VD=function(){var t=this.ZD;t&&(clearTimeout(t),this.ZD=k)},K.prototype.QD=function(t,e){var o,n,r=this.TD;r&&0===A.GC$(".gc-tab-tip-span").length&&(r.appendTo(u.body),r.hide()),o=r.width(),n=r.height(),r.css({left:t-o/2,top:e-n/2}),r.show()},K.prototype.RD=function(t){var e,o,n,r,i,a,s=this,l=s.OC,u=A.GC$(s.Ws()),c=u.position(),h=u.offset(),f=t.pageX-h.left,p=t.pageY-h.top,d=s.hitTest(f,p),g=d.element,m=s.Dr(),y=s.VC(),b=s.OC.yJc().length,v=l.options.tabStripPosition,C=s.zJc(),w=s.TC(),x=s.yD,T=C?f:p;(C?m.x+s._C():m.y+s._C()+w)<T?s.wD===k&&s.uD<b&&(s.wD=R.setInterval(function(){s._D(s.sD()),s.uD===b?(s.SD(),v===S.TabStripPosition.bottom?(e=c.left+s.fE()-3.5,o=c.top-3.5):v===S.TabStripPosition.top?(e=c.left+s.fE()-3.5,o=c.top+m.height):v===S.TabStripPosition.left?(e=c.left+m.width,o=c.top+s.fE()-3.5):v===S.TabStripPosition.right&&(e=c.left-3.5,o=c.top+s.fE()-3.5),x.show()):(s.uD++,x.hide()),x.css({left:e,top:o})},100)):T<y?s.wD===k&&0<s.uD&&(s.wD=R.setInterval(function(){s.$D(s.sD()),0===s.uD?(s.SD(),v===S.TabStripPosition.bottom?(e=c.left+y-3.5,o=c.top-3.5):v===S.TabStripPosition.top?(e=c.left+y-3.5,o=c.top+m.height):v===S.TabStripPosition.left?(e=c.left+m.width,o=c.top+w-3.5):v===S.TabStripPosition.right&&(e=c.left-7,o=c.top+w-3.5),x.show()):(s.uD--,x.hide()),x.css({left:e,top:o})},100)):(s.SD(),g!==P&&-1===s.Via().indexOf(g)||(n=d.index,g===H&&(n=s.uD),g===P&&!M(n)||(n=b),i=(r=q(n,d.position,s.vD,s.OC.getSheetCount(),s.WC)).index,a=r.position,s.uD=i,v===S.TabStripPosition.bottom?(e=c.left+a-3.5,o=c.top-7):v===S.TabStripPosition.top?(e=c.left+a-3.5,o=c.top+m.height):v===S.TabStripPosition.left?(e=c.left+m.width,o=c.top+a-3.5):v===S.TabStripPosition.right&&(e=c.left-7,o=c.top+a-3.5),x.css({left:e,top:o}),x.show()))},K.prototype.fE=function(){var t,e=this.zJc(),o=this.WC,n=this.sD(),r=this.gE(this.gq,n),i=0,a=this.VC(),s=this.BJc,l=e?a+this.LC:a;for(t=r;t<n.length;t++)i=n[t],e?(l+=o[i],l+=this.HC):l+=s;return l},K.prototype.SD=function(){var t=this.wD;t&&(clearInterval(t),this.wD=k)},K.prototype.UD=function(){var t=this.OC,e=this.uD,o=this.vD,n=t.sheets[o];-1!==e&&-1!==o&&o!==e&&o!==e-1&&this.yD.isVisible()&&(o<e-1&&--e,t.commandManager().execute({cmd:"moveSheet",sheetName:n.name(),targetIndex:e}))},K.prototype.DXc=function(t,e){var o=this.OC,n=this.sD();return e===o.getSheetCount()?(this.aE(n),void this.fq()):0===e?(this.YD(n),void this.fq()):void(this.EXc(t,e)&&this.RIc(e))},K.prototype.EXc=function(t,e){var o,n=this.TIc().tabsInfo,r=!1,i=!1;for(o=0;o<n.length;o++)if(t===n[o].index&&(r=!0),e===n[o].index&&(i=!0),r&&i)return this.fq(),!1;return!0},K.prototype.sD=function(){var t,e=[],o=this.OC.yJc();for(t=0;t<o.length;t++)this.hE(t)&&e.push(t);return e},K.prototype.YD=function(t){0<t.length&&this.gq!==t[0]&&this.OC.startSheetIndex(t[0])},K.prototype.$D=function(t){var e;0<t.length&&this.gq>t[0]&&-1!==(e=this.rw(this.gq))&&this.OC.startSheetIndex(e)},K.prototype._D=function(t){0<t.length&&this.gq<t[t.length-1]&&-1!==this.rD(t)&&this.OC.startSheetIndex(this.jw(this.gq))},K.prototype.aE=function(t){if(0<t.length&&this.gq<t[t.length-1]){var e=this.rD(t);-1!==e&&this.OC.startSheetIndex(e)}},K.prototype.rD=function(t){var e,o,n,r,i,a,s,l,u,c,h,f;if(0<t.length)for(o=(e=this).zJc(),n=e.BJc,r=e._C(),i=0,a=e.WC,l=s=void 0,u=e.cD(),-1===(c=e.gE(e.gq,t))&&(c=0),s=t.length-1;c<=s;s--)if(l=t[s],i+=o?a[l]:n,s!==t.length-1&&(i+=o?e.HC:0),h=u+i,0!==s&&(h+=o?e.LC:n),r<h)return f=s+1<t.length?t[s+1]:t[t.length-1],e.gq<f?f:-1;return-1},K.prototype.rw=function(t){var e;for(e=t-1;0<=e;e--)if(this.hE(e))return e;return-1},K.prototype.jw=function(t){var e,o=this.OC.yJc().length;for(e=t+1;e<o;e++)if(this.hE(e))return e;return-1},K.prototype.gE=function(t,e){var o;for(o=0;o<=e.length-1;o++)if(t===e[o])return o;return-1},K.prototype.hE=function(t){var e=this.OC.XJc(t);return e&&e.visible()},K.prototype.fw=function(){this.xD++},K.prototype.gw=function(){this.xD--,this.xD<=0&&(this.xD=0,this.repaint())},K.prototype.repaint=function(t){var e=this.Ws();e&&e.getContext&&this.jp(e.getContext("2d"),t)},K.prototype.jp=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d,g=this;if(!(0<g.xD)){if(o=g.Dr(),n=g.Xs,e){if(e.x>=o.x+o.width)return;if(e.y>=o.y+o.height)return;if(e.x+e.width>o.width&&(e.width=o.width-e.x,e.width<=0))return;if(e.y+e.height>o.height&&(e.height=o.height-e.y,e.height<=0))return;if(e.width<=0||e.height<=0)return}if((i=g.buffer)&&(!i||i.width===n.width&&i.height===n.height)&&(i||i.width===o.width&&i.height===o.height)||(i&&T.En.Rn(g.OC,i),g.buffer=i=I("canvas"),T.En.Kn(i,g.OC),T.En.Pn(i,o.width,o.height)),!(o.width<=0||o.height<=0||e&&(e.width<=0||e.height<=0))){(r=g.buffer.getContext("2d")).clearRect(0,0,o.width,o.height),T.Bn.Dn(r,-o.x,-o.y),g.iE(r,e),T.Bn.Dn(r,o.x,o.y),l=a=0<=o.x?0:-o.x,u=s=0<=o.y?0:-o.y,e&&(l=o.x+e.x,u=o.y+e.y,o=new T.Rect(l,u,e.width,e.height)),a=0<=o.x?o.x:0,s=0<=o.y?o.y:0,f=k,p=T.En.Ln(n),d=T.En.Mn(n),n&&1!==p&&(l*=p,u*=d,o.x*=p,o.y*=d,o.width*=p,o.height*=d);try{h=n?e?(c=m(o.width-l,0),m(o.height-u,0)):(c=y(o.width-l,m(n.width-o.x,3)),y(o.height-u,m(n.height-o.y,3))):(l=e.x,u=e.y,c=e.width,e.height),n?(T.Bn.Cn(t,1,1),t.clearRect(a,s,c,h),t.drawImage(g.buffer,l,u,c,h,a,s,c,h),T.Bn.Cn(t,p,d)):f=(r=g.buffer.getContext("2d")).getImageData(l,u,c,h)}catch(t){return}!n&&f&&0<o.width&&0<o.height&&t.putImageData(f,a,s)}}},K.prototype._Jc=function(t,e){var o=this.Dr();e?t.rect(e.x,e.y,e.width,e.height):t.rect(o.x,o.y,o.width,o.height),t.clip()},K.prototype.aKc=function(t){var e,o,n,r=this.OC,i=this.zJc();for(t.save(),t.font=a.To.Ro(t.font,"bold"),this.WC=[],n=r.yJc(),o=0;o<n.length;o++)e=Math.round(t.measureText(n[o].name()).width)+this.GC+this.EC,this.WC.push(e);i||(this.BJc=l(t.font)+2*this.SJc),t.restore()},K.prototype.TIc=function(){var t,e,o,n=this,r=n.OC.yJc(),i=n.zJc(),a=n.Dr(),s=[],l=n.VC(),u=n.gq;for(i&&0<u&&0<=n.rw(u)&&(l+=n.LC),u<0&&(n.gq=0),e=n.gq;e<r.length;e++){if(o=r[e].visible(),t=n.WC[e],i){if(l>a.x+a.width)break}else if(l>a.y+a.height)break;s.push({index:e,position:l,width:t,text:r[e].name(),visible:o}),o&&(l+=i?t+n.HC:n.BJc)}return{tabsInfo:s,newTabStartPosition:l}},K.prototype.iE=function(t,e){var o,n,r,i,a=this,s=a.OC,l=s.options.scrollbarAppearance===S.ScrollbarAppearance.mobile,u=s.options.tabStripPosition,c=s.options.showHorizontalScrollbar;t&&s&&(o=a.Dr(),t.save(),h(t,a._font),a._Jc(t,e),t.beginPath(),a.aKc(t),r=(n=a.TIc()).tabsInfo,i=n.newTabStartPosition,a.dD(t,o),a.fD(t,o,i),a.jE(t,o,r),a.OC&&a.OC.options.tabNavigationVisible&&a.kD(t,o),c&&!l&&u===S.TabStripPosition.bottom&&a.nD(t,o),t.beginPath(),t.restore())},K.prototype.dD=function(t,e){},K.prototype.fD=function(t,e,o){},K.prototype.bKc=function(t,e){var o,n,r=this.zJc(),i=this.VC();r?(o=e.x+this._C(),t.rect(i,0,o-i,e.height)):(n=this.PC(),t.rect(0,i,e.width,e.height-i-n)),t.clip()},K.prototype.cKc=function(t,e,o){var n,r,i,a=this.OC,s=this.zJc(),l=this.$C,u=this.iD;for(n=o.length-1;0<=n;n--)(r=o[n]).index!==l&&r.visible&&(i=a.MJc(r.text).DHb(),s?this.oD(t,r.position,0,r.width,e.height,r.index,!1,r.index===u,r.text,i):this.oD(t,0,r.position,e.width,this.BJc,r.index,!1,r.index===u,r.text,i))},K.prototype.dKc=function(t,e,o){var n,r,i=this.OC,a=i.yJc(),s=this.zJc(),l=this.$C,u=this.gq,c=o[l-u];u<=l&&l<a.length&&c&&c.visible&&(n=i.WJc())&&(r=n.DHb(),s?this.oD(t,c.position,0,c.width,e.height,l,!0,!1,c.text,r):this.oD(t,0,c.position,e.width,this.BJc,l,!0,!1,c.text,r))},K.prototype.eKc=function(t,e){var o=this.gq,n=this.zJc(),r=this.VC();0<o&&0<=this.rw(o)&&n&&this.jD(t,e,o,r)},K.prototype.jE=function(t,e,o){var n=this.OC,r=n.yJc();this.$C=n.fKc(),0<r.length&&(t.save(),t.beginPath(),this.bKc(t,e),this.cKc(t,e,o),this.dKc(t,e,o),t.restore(),t.save(),t.beginPath(),this.eKc(t,e),t.restore())},K.prototype.jD=function(t,e,o,n){},K.prototype.kD=function(t,e){},K.prototype.nD=function(t,e){},K.prototype.mD=function(t,e,o,n,r,i,a,s,l,u){},K.prototype.oD=function(t,e,o,n,r,i,a,s,l,u){},K.prototype.Ws=function(){return this.Xs},K.prototype.kE=function(t,e){var o,n,r,i,a=t.createLinearGradient(e.x,e.y,e.width,e.height),s=T.Im.Km(S.VisualState.normal,"gc-tabStripBackground"),l=s&&s.backgroundImage,u=s&&s.backgroundColor;if(l&&-1!==l.indexOf("linear-gradient"))for(n=0,r=(o=w(l)).length;n<r;n++)i=o[n],a.addColorStop(i.point,i.color);else u&&(a.addColorStop(0,"#DDDDDD"),a.addColorStop(1,u));return a},K.prototype.pD=function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y,b,v=this.zJc(),C=this.Dr();if(i=v?t.createLinearGradient(C.x+.7*C.height,C.y+0,.7*C.height,C.height):(a=C.y,(s=0)<r&&(a=r,s=this.BJc),t.createLinearGradient(C.x+.7*s,a,.7*s,a+s)),l=this.OC.MJc(o),""===o&&0<this.gq&&(l=this.OC.XJc(this.gq-1)),c=(u=l&&l.options)&&u.sheetTabColor)t.fillStyle="rgba(0, 0, 0, 0)",h=t.fillStyle,t.fillStyle=T.Rm.Om(l,c),(f=t.fillStyle)!==h&&(e?(i.addColorStop(0,B),i.addColorStop(.45,"#F1F6FD"),i.addColorStop(.9,f),i.addColorStop(1,B)):i=f);else if(n)if(p=n.backgroundImage,d=n.backgroundColor,p&&-1!==p.indexOf("linear-gradient"))for(m=0,y=(g=w(p)).length;m<y;m++)b=g[m],i.addColorStop(b.point,b.color);else d&&i.addColorStop(0,d);return i},K.prototype.qD=function(t,e){var o="black";return t&&(o=t.color),e&&i.dc(i.ec(e))<127.5&&(o=B),o},U=K,e.DC=U,T.Zn(U)},"./dist/core/workbook/workbook-json.js":function(t,e,o){"use strict";var j,_,k,O,n,F,E,P,L,H,B,V,z,W,i;function G(t,e){return t.hasOwnProperty(e)}function U(t){var e,o,n,r;if(!t||"string"!=typeof t)return 1;if(3<(o=(e=t.split(".")).length))return 3;if(n=i(e[0]),o<=2)return isNaN(n)?1:n;if(r=i(e[1]),10<=n)return n;if(3<=n){if(20143<=r)return 3;if(20142<=r)return 2}return 1}function J(t,e){var o,n,r,i,a=e&&e.frozenColumnsAsRowHeaders,s=e&&e.frozenRowsAsColumnHeaders,l=0,u=t.sheets;if(s||a)for(n in u)"string"==typeof n&&(r=u[n],i=W(r.index)?r.index:r.mi,o=this.sheets[W(i)?i:l],s&&W(r.frozenRowCount)&&(o.$Bb=!0,o.deleteRows(0,r.frozenRowCount)),a&&W(r.frozenColCount)&&o.deleteColumns(0,r.frozenColCount),l++)}function Z(t,e){var o=e.sheetTabCount;W(o)&&t.gKc(o,0)}function q(t,e,o,n){var r,i,a=0,s=e.sheetTabs;if(s)for(r in s)"string"==typeof r&&(i=s[r],t.pJc[a].fromJSON(i,!1,o,n,!0),a++)}function K(t,e){var o,n=e.activeSheetTabIndex;W(n)&&(t.hKc(n,0),(o=t.pJc[n])&&o.DHb(!0,!1))}function Y(n,r,i){j.Workbook._features&&z(j.Workbook._features,function(t,e){var o=e[r];o&&o.call.apply(o,[n].concat(i))})}Object.defineProperty(e,"__esModule",{value:!0}),j=o("./dist/core/workbook/workbook.js"),_=o("./dist/core/worksheet/style.js"),k=o("./dist/core/util/domUtil.js"),O=o("./dist/core/util/tasks.js"),n=o("@grapecity/js-sheets-common"),F=o("./dist/core/util/common.js"),E=o("@grapecity/js-calc"),P=!!E,L=_.Style.kxb,H=n.Commands.UndoManager,B=n.Common.CultureManager,V=n.Common.j.C4,n.Common.j.Fa,z=k.GC$.each,W=F.Ul.Ol,i=parseFloat,j.Workbook.prototype.toJSON=function(o){var t,e,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S=this,M={version:F.productInfo.productVersion},I=o&&o.rowHeadersAsFrozenColumns,N=o&&o.columnHeadersAsFrozenRows,R=I||N;if(R&&(o.Yec=!0),S.EHb&&(M.docProps=V(S.EHb)),P&&((t=E.Functions.setLanguagepackage)&&(e=t(),t("en"))),(n=S.getSheetCount())!==j.Workbook.nv&&(M.sheetCount=n),R)for(r=new j.Workbook,i=o&&o.includeAutoMergedCells,r.fromJSON(S.toJSON({includeBindingSource:!0,includeAutoMergedCells:i})),S=r,a=0;a<n;a++)l=(s=S.getSheet(a)).getRowCount(1),u=s.getColumnCount(2),h=N&&0<l,(c=I&&0<u)&&s.addColumns(0,u),h&&s.addRows(0,l,h),c&&s.Zec(u,h?l:0),h&&s.$ec(l,c?u:0);for(S.mv=!0,S.suspendPaint(),S.suspendEvent(),P&&((f=S.Wu).calcOnDemand&&(f.calcOnDemand=!1,S.FHb(),f.suspend(!0),f.resume(!0),f.calcOnDemand=!0),f.suspend(!0)),(p=S.startSheetIndex())&&(M.startSheetIndex=p),z(S.options,function(t,e){"_ps"!==t&&j.Workbook.Qp[t]!==e&&(M[t]=e)}),(d=S.getActiveSheetIndex())!==j.Workbook.ov&&(M.activeSheetIndex=d),g={},m=0;m<n;m++)g[(s=S.getSheet(m)).name()]=s.toJSON(o),g[s.name()].index=m;for(k.GC$.isEmptyObject(g)||(M.sheets=g),0!==(y=S.getSheetTabCount())&&(M.sheetTabCount=y),-1!==(b=S.getActiveSheetTabIndex())&&(M.activeSheetTabIndex=b),v={},C=0;C<y;C++)v[(w=S.getSheetTab(C)).name()]=w.toJSON(o),v[w.name()].index=n+C;if(k.GC$.isEmptyObject(v)||(M.sheetTabs=v),x=[],T=S.Lq){for(A in T)G(T,A)&&x.push(T[A]);0<x.length&&(M.namedStyles=x)}return j.Workbook._features&&z(j.Workbook._features,function(t,e){e.toJson&&e.toJson.call(S,M,o)}),P&&t&&t(e),S.mv=!1,P&&S.Wu.resume(!1),S.resumeEvent(),S.resumePaint(),R&&delete o.Yec,M},j.Workbook.prototype.fromJSON=function(n,r){var t,i,e,o,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E=this;if(E.vXc(),n){if(r&&r.incrementalLoading)return!0===r.incrementalLoading&&(r.incrementalLoading={}),E.egc(n,r);t=U(n.version),e={noSchema:i=t<3,version:t},o=F.Vl.Xl(),E.mv=!0,E.suspendPaint(),E.suspendEvent(),a=B.culture(),B.culture("");try{for(h in E.T3(),E.pv=new H(E,-1,E.options.allowUndo),P&&E.qv(!0),P&&E.Wu.suspendAdjust(),E._availableSheetIndex=-1,E.clearSheets(),E.clearSheetTabs(),s=E.options,l=n.canUserEditFormula,W(l)&&(s.allowUserEditFormula=l),u=n.allowDragDrop,W(u)&&(s.allowUserDragDrop=u),c=n.allowDragFill,W(c)&&(s.allowUserDragFill=c),s)G(s,h)&&(f=n[h],W(f)&&(s[h]=f));if(E.EHb=V(n.docProps),Y(E,"preFromJson",[n,i,r]),p=n.sheetCount,W(p)||(p=j.Workbook.nv),E.sw(p,0),E.Lq={},E.dkc={},d=n.namedStyles)for(g=0,m=d;g<m.length;g++)y=m[g],b=new _.Style,L(y,E),b.fromJSON(y,i,E),E.Kq(b);if(v=0,C=n.sheets,x=w=void 0,A=!(T=!1),C)for(S in C)"string"==typeof S&&(M=C[S],I=W(M.index)?M.index:M.mi,E.sheets[W(I)?I:v].fromJSON(M,!1,e,r,!0),v++,x=M.allowUndo,T?A=A&&x===w:(w=x,T=!0));W(w)&&A&&(s.allowUndo=w),N=n.activeSheetIndex,W(N)||(N=j.Workbook.ov),E.dq(N,0),(R=E.sheets[N])&&R.DHb(!0,!1),Z(E,n),q(E,n,e,r),K(E,n),k=n.startSheetIndex,W(k)&&E.startSheetIndex(k),j.Workbook._features&&z(j.Workbook._features,function(t,e){var o=e.fromJson;o&&o.call(E,n,i,r)}),P&&E.Wu.resumeAdjust(),J.call(E,n,r),j.Workbook.ao(E,"initCustomName")}finally{P&&E.Wu.resumeAdjust(),B.culture(a),E.mv=!1,R=E.getActiveSheet(),o&&R&&R.zt(),E.resumeEvent(),E.fq(),E.resumePaint(),R&&E.Wq(F.Events.FormulatextboxActiveSheetChanged,{oldSheet:void 0,newSheet:R})}}},j.Workbook.prototype.egc=function(o,n){var t,e,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D=this;D.fgc&&D.fgc.terminate(),D.fgc=new O.Tasks(function(){var t,e,o,n=D.getActiveSheet();if(!n.loaded)for(t=this.tasks.length-1;0<=t;t--)if((e=this.tasks[t].args[0])&&e._modelManager&&e.name&&e.name()===n.name())return o=this.tasks[t],this.tasks.splice(t,1),o;return this.tasks.pop()},function(){var t=D.getActiveSheet();return t&&(D.ku.Gw||t.isEditing()||t._eventHandler._isWorking||t._eventHandler.xG||t._eventHandler.eG)}),t=U(o.version),r={noSchema:e=t<3,version:t},i=F.Vl.Xl(),D.mv=!0,D.suspendPaint(),D.suspendEvent(),a=B.culture(),B.culture("");try{for(h in D.T3(),D.pv=new H(D,-1,D.options.allowUndo),P&&D.qv(!0),P&&D.Wu.suspendAdjust(),D._availableSheetIndex=-1,D.clearSheets(),D.clearSheetTabs(),s=D.options,l=o.canUserEditFormula,W(l)&&(s.allowUserEditFormula=l),u=o.allowDragDrop,W(u)&&(s.allowUserDragDrop=u),c=o.allowDragFill,W(c)&&(s.allowUserDragFill=c),s)G(s,h)&&(f=o[h],W(f)&&(s[h]=f));if(D.EHb=V(o.docProps),Y(D,"preFromJson",[o,e,n]),p=o.sheetCount,W(p)||(p=j.Workbook.nv),D.sw(p,0),D.Lq={},d=o.namedStyles)for(g=0;g<d.length;g++)m=d[g],y=new _.Style,L(m,D),y.fromJSON(m,e,D),D.Kq(y);if(b=0,C=o.sheets,x=w=void 0,A=!(T=!1),C)for(M in S={total:0,valuesLoad:0,formulaLoad:0},b=0,n.incrementLoadTask=D.fgc,n.incrementalLoading.loadStatus=S,C)"string"==typeof M&&(I=C[M],N=W(I.index)?I.index:I.mi,(v=D.sheets[W(N)?N:b]).loading=!0,v.cq(I.name+"",!0),v.DHb(I.isSelected),v.setRowCount(I.rowCount),v.setColumnCount(I.columnCount),W(I.visible)&&v.visible(I.visible),S.total+=v.getRowCount(),D.fgc.addTask(function(t,e){t.egc(e,!1,r,n,!0)},[v,I]),b++,x=I.allowUndo,T?A=A&&x===w:(w=x,T=!0));W(w)&&A&&(s.allowUndo=w),R=o.activeSheetIndex,W(R)||(R=j.Workbook.ov),D.dq(R,0),(k=D.sheets[R])&&k.DHb(!0,!1),Z(D,o),q(D,o,r,n),K(D,o),E=o.startSheetIndex,W(E)&&D.startSheetIndex(E),D.fgc.endingCallback=function(){j.Workbook._features&&z(j.Workbook._features,function(t,r){r.egc?D.fgc.addTask(function(t,e,o,n){r.egc.call(t,e,o,n)},[D,o,e,n]):r.fromJson&&r.fromJson.call(D,o,e,n)}),D.fgc.endingCallback=function(){var t,e;for(P&&D.Wu.resumeAdjust(),J.call(D,o,n),j.Workbook.ao(D,"initCustomName"),t=0;t<D.sheets.length;t++)delete D.sheets[t].loading;(v=D.getActiveSheet())&&D.Wq(F.Events.FormulatextboxActiveSheetChanged,{oldSheet:void 0,newSheet:v}),n&&n.incrementalLoading&&n.incrementalLoading.loading&&n.incrementalLoading.loading(1,{sheet:v}),(e=n&&n.incrementalLoading&&n.incrementalLoading.loaded)&&e(),v&&v.repaint(),D.fgc.endingCallback=void 0},D.fgc.start()},D.fgc.start()}finally{B.culture(a),D.mv=!1,k=D.getActiveSheet(),i&&k&&k.zt(),D.resumeEvent(),D.fq(),D.resumePaint()}}},"./dist/core/workbook/workbook.js":function(t,e,o){"use strict";var u,n,r,H,B,c,s,i,a,h,l,f,p,d,V,g,m,y,b,v,C,z,w,x,T,A,S,M,W,I,G,N,U,R,J,k,E,D,j,_,O,F,P,L,Z,q,K,Y,Q,X,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ht,ft,pt;function dt(t){return t.getActiveSheet()}function gt(t,e){return B.En.npb()%1!=0||t.zoom()%1!=0||t.parent&&t.parent.options.scrollByPixel&&e&&t.mJb&&t.mJb.mgc(B.kf(t.lq,t.qq,1,1))}function mt(e,o){return W.setTimeout(function(){e.invalidateLayout(),e.repaint(),o.GHb=G;var t=e.Dr();o.pWc(e,t.x,t.width),o.sWc(e,t.y,t.height)},200)}function yt(t,e,o){t.Wq(B.Events.ActiveSheetChanged,{oldSheet:e,newSheet:o})}function bt(t,e){t.Wq(B.Events.ActiveSheetChanging,e)}function vt(t){this.yw=t}function Ct(t){var e=B.Im.Lm("gc-footer-corner"+Q);H.GC$(t).css({border:K,padding:0,margin:0,"background-color":e.backgroundColor})}function wt(t,e){var o=t.css(e);switch(o){case"thin":return 1;case"medium":return 3;case"thick":return 5;default:return parseFloat(o)}}function xt(t){var e,o,n,r,i=t.getBoundingClientRect().width,a=(n=t,{top:wt(r=H.GC$(n),"borderTopWidth"),right:wt(r,"borderRightWidth"),bottom:wt(r,"borderBottomWidth"),left:wt(r,"borderLeftWidth")}),s=a.left,l=a.right,u=(e=t,o=H.GC$(e),{top:parseFloat(o.css("paddingTop")),right:parseFloat(o.css("paddingRight")),bottom:parseFloat(o.css("paddingBottom")),left:parseFloat(o.css("paddingLeft"))});return i-s-l-u.left-u.right}function Tt(t,e){var o,n,r=this;r.name="",r.kv=!1,r._availableSheetIndex=-1,r.eq=0,r.xKc=-1,r.mv=!1,r.options=T(ft,function(t,e,o){r.Op(t,e,o)}),r.T3(e),e&&"white"===e.backColor?r.Sxb=!0:r.Sxb=!1,o=1,!e||typeof(n=e.sheetCount)==k&&(o=n),"string"==typeof t&&(t=I.getElementById(t)),r._host=t,r.ad(o,t)}Object.defineProperty(e,"__esModule",{value:!0}),u=o("./dist/core/workbook/workbookpanelex.js"),n=o("./dist/core/core.ns.js"),r=o("@grapecity/js-sheets-common"),H=o("./dist/core/util/domUtil.js"),B=o("./dist/core/util/common.js"),c=o("./dist/core/util/imageLoader.js"),s=o("./dist/core/worksheet/worksheet-actions.js"),i=o("./dist/core/workbook/sheettab.js"),a=o("./dist/core/workbook/sheettab2007.js"),h=o("./dist/core/worksheet/stylehelper.js"),l=o("./dist/core/worksheet/clipboardhelper.js"),f=o("./dist/core/worksheet/worksheet.js"),p=o("@grapecity/js-calc"),d=!!p,V=o("./dist/core/core.enum.js"),g=r.Common.u,m=r.Commands.UndoManager,y=r.Commands.CommandManager,b=H.GC$.each,v=H.GC$.extend,C=d,z=r.Common.j.Fa,w=B.Ul.Nl,x=B.Ul.Pl,T=B.Ul.Ql,A=B.Ul.hZa,S=r.Common.CultureManager,M=parseInt,W=window,I=document,G=null,N=Math.round,U=Math.min,R=Math.floor,J=Math.abs,k="number",E="mouseenter",D="mouseleave",j="resize",_=".gcSpread",O=".gcSpreadInternal",F=".gcScrollbar",P="div",L="px",Z="gc-scroll-handle",q="gc-scroll-bar",K="none",Y="content-box",Q=" ui-widget-header ui-state-default btn btn-default",X="gc-scroll-mobile-container",$="gc-scroll-mobile-container-horizontal",tt="gc-scroll-mobile-container-vertical",et="gc-scroll-mobile-spread-hovering",ot="gc-scroll-mobile-state-hide",nt="gc-scroll-mobile-state-hover",rt=W.jQuery,it="cultureChanged",at="workbook",st="gcUIElement",lt="gc-no-user-select",ut=new r.Common.ResourceManager(n.SR,"Sheets"),ct=ut.getResource.bind(ut),vt.Lv=function(t,e){var o,n=t.data,r=n.ku;r.HHb&&(W.clearTimeout(r.HHb),r.HHb=G),(o=n.WJc())&&e&&o.iKc(n,e)},vt.Mv=function(t){var e=t.data,o=e.WJc();o&&o.jKc(e)},vt.Nv=function(t){var e,o,n,r,i,a=t.data;a&&((e=dt(a))?((o=a.kKc.xR)&&o.mR&&(e.CH=!0),e.zt(),1!==(n=a.options.showScrollTip)&&3!==n||(i=(r=H.GC$(t.srcElement||t.target)).parent(),(r&&(r.hasClass(Z)||r.hasClass(q))||i&&(i.hasClass(Z)||i.hasClass(q)))&&a.ku.Dw(!1,t))):a.getActiveSheetTab().zt())},vt.Dv=function(t,e){var o,n=t.data,r=n.ku;r.HHb&&(W.clearTimeout(r.HHb),r.HHb=G),(o=n.WJc())&&e&&o.lKc(n,e)},vt.Ev=function(t){var e=t.data,o=e.WJc();o&&o.mKc(e)},vt.Fv=function(t){var e,o,n,r,i,a,s=t.data;s&&((e=dt(s))?((o=s.nKc.xR)&&o.mR&&(e.CH=!0),e.zt(),2!==(n=s.options.showScrollTip)&&3!==n||(r=H.GC$(t.srcElement||t.target))&&(i=r.parent(),(r.hasClass(Z)||i&&i.hasClass(Z)||r.hasClass(q)||i&&i.hasClass(q))&&s.ku.Dw(!0,t))):(a=s.getActiveSheetTab())&&a.zt())},vt.Gv=function(t){var e=t.data;e&&e.xw()},vt.ggc=function(t){var e,o,n,r=ct(),i=t.data,a=t.scrollbar;i.options.enableAccessibility&&(e=H.GC$(a.Bv()).offset(),o=a.hitTest(t.x-e.left,t.y-e.top),n={thumbButton:r.ARIA_Scrollbar_Thumb_Button,trackButton:r.ARIA_Scrollbar_TRACK_Button,leftButton:r.ARIA_Scrollbar_Left_Button,rightButton:r.ARIA_Scrollbar_Right_Button,upButton:r.ARIA_Scrollbar_Top_Button,downButton:r.ARIA_Scrollbar_Bottom_Button}[o.element],i.dgc(n))},vt.prototype.no=function(){this.yw=G},vt.prototype.Bw=function(t,e,o,n){var r=this;t&&(r.Gw=!0,r.Hw=n?t.lq:e,r.bCb=n?t.cCb:o,r.Iw=n?e:t.qq,r.dCb=n?o:t.eCb,W.setTimeout(function(){r.Kw(t)},0))},vt.prototype.Kw=function(t){t&&this.Gw&&(this.Gw=!1,this.Lw(t))},vt.prototype.Lw=function(t){var e,o,n,r,i,a,s=this;s.Mw||(s.Mw=!0,e=s.yw,t&&(o=e.options.showScrollTip,n=s.Hw,r=s.bCb,i=s.Iw,a=s.dCb,n!==t.lq||r!==t.cCb?(s.ju(t,n,r),2!==o&&3!==o||e.ww(s.Nw(!0))):i===t.qq&&a===t.eCb||(s.lu(t,i,a),1!==o&&3!==o||e.ww(s.Nw(!1)))),s.Mw=!1)},vt.prototype.ju=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H;if(this.GHb&&(W.clearTimeout(this.GHb),this.GHb=G),t){if(r=t.lq,i=t.cCb,!(a=!z(n))&&e===r&&o===i)return;if(a&&(r=n),t.lq=e,t.cCb=o,0<t.Xq)return void(r!==e&&t.Wq(B.Events.TopRowChanged,{sheet:t,sheetName:t.name(),oldTopRow:r,newTopRow:e}));if(s=!1,c=(u=(l=t.options).sheetAreaOffset.top)+2,h=t.Zs,p=(f=t.am()).qt,d=t.oKc(f),g=f.pKc,m=f.ot,y=f.gs,b=f.width+l.sheetAreaOffset.left,w=C=v=void 0,T=(x=t._render).bm(),A=t.qKc,t.tables&&0===t.frozenRowCount()&&(S=t.tables.KHb())&&(S.x=S.x-2,S.width=S.width+4,S.y=u,S.height=p,t.$l=!0,x._l(T,S)),r<e||e===r&&J(o)>J(i)){if(I=M=void 0,(N=t.Gr(1))&&0<N.length&&(M=N.findRow(e)),M){for(I=N[R=N.length-1];I&&I.y+I.height>p+d;)I=N[--R];I&&I.row>e&&(s=!0,C=h?h.x:f.x,w=M.y+J(o),v=I.y+I.height-w-c,x.Ow(C,w,b,v,C,p),l.colHeaderVisible||(t.invalidateLayout(),x._l(T,new B.Rect(C,0,b,u))),t.invalidateLayout(),k=A?d:d+y+g,x._l(T,new B.Rect(C,p+v,b,k-v)),k-=A?0:g,x.Pw(T,new B.Rect(C,p-2,b,k+2)),this.pWc(t,C,b))}}else{for(E=0,D=e;D<r&&E<d;D++)E+=t.Sl(D);(E+=J(i)-J(o))<d&&(s=!0,C=h?h.x:f.x,w=p,v=d-E,0<t.frozenTrailingRowCount()&&--v,j=0,!A&&0<g&&(j=y,_=U(h.height-j-1,m-1+E),x.Ow(C,m-1,b,j+1,C,_)),O=A?0:U(E,g)-1,x.Ow(C,w,b,v+O,C,w+E),t.invalidateLayout(),F=t.rowOutlines&&!t.rowOutlines.iT()?t.rowOutlines.s0a()+u+1:0,x._l(T,new B.Rect(C,w-u,b,E+u+F+5)),P=d+O+j+2,x.Pw(T,new B.Rect(C,w-2,b,P)),this.pWc(t,C,b))}s||(t.invalidateLayout(),t.repaint()),r!==e&&t.Wq(B.Events.TopRowChanged,{sheet:t,sheetName:t.name(),oldTopRow:r,newTopRow:e}),(L=t._eventHandler)&&L._updateEditingEditor(),H=r===t.lq&&i!==t.cCb,s&&gt(t,H)&&(this.GHb=mt(t,this))}},vt.prototype.pWc=function(t,n,r){var i=t._render,a=i.bm();this.qWc(t).concat(this.rWc(t)).forEach(function(t){var e=t.layout,o=new B.Rect(n,e.y,r,e.height);i.dm(o),i.Pw(a,o)})},vt.prototype.qWc=function(t){var e,o,n,r,i,a,s,l=t.getSelections();return 1===l.length?(e=this.yw.options.scrollByPixel,o=t.lq,n=t.cCb,r=l[0].row,i=l[0].row+l[0].rowCount-1,e&&i==o-1?[]:(a=[],(r===o+1||r<o&&o<=i||i==o-1||e&&r===o&&0!==n)&&(s=t.Gr(0))&&0<s.length&&a.push({layout:s[s.length-1]}),a)):[]},vt.prototype.rWc=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p=t.getSelections();return 1===p.length?(e=this.yw.options.scrollByPixel,o=t.getViewportBottomRow(1),n=p[0].row,r=p[0].row+p[0].rowCount-1,i=[],l=(s=(a=t.Gr(2))&&0<a.length)?a[0]:G,h=(c=(u=t.Gr(1))&&0<u.length)?u.findRow(o):G,f=s&&c&&l.y!==h.y+h.height,(r==o-1||n<=o&&o<r||n===o+1||e&&r===o&&f)&&s&&i.push({layout:l}),i):[]},vt.prototype.lu=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L;if(this.GHb&&(W.clearTimeout(this.GHb),this.GHb=G),t){if(r=t.qq,i=t.eCb,!(a=!z(n))&&e===r&&o===i)return;if(a&&(r=n),t.qq=e,t.eCb=o,0<t.Xq)return void(r!==e&&t.Wq(B.Events.LeftColumnChanged,{sheet:t,sheetName:t.name(),oldLeftCol:r,newLeftCol:e}));if(s=!1,c=(u=(l=t.options).sheetAreaOffset.left)+2,h=t.Zs,p=(f=t.am()).pt,d=t.rKc(f),g=f.sKc,m=f.lt,y=f.js,b=f.height+l.sheetAreaOffset.top,w=C=v=void 0,T=(x=t._render).bm(),A=t.tKc,r<e||e===r&&J(o)>J(i)){if(M=S=void 0,(I=t.Hr(1))&&0<I.length&&(S=I.findCol(e)),S){for(M=I[N=I.length-1];M&&M.x+M.width>p+d;)M=I[--N];M&&M.col>e&&(s=!0,v=S.x+J(o),C=h?h.y:f.y,w=M.x+M.width-v-c,x.Ow(v,C,w,b,p,C),l.rowHeaderVisible||(t.invalidateLayout(),x._l(T,new B.Rect(0,C,u,b))),t.invalidateLayout(),R=A?d:d+y+g,x._l(T,new B.Rect(p+w,C,R-w,b)),R-=A?0:g,x.Pw(T,new B.Rect(p-2,C,R+2,b)),this.sWc(t,C,b))}}else{for(k=0,E=e;E<r&&k<d;E++)k+=t.Tl(E);(k+=J(i)-J(o))<d&&(s=!0,v=p,C=h?h.y:f.y,w=d-k,0<t.frozenTrailingColumnCount()&&--w,D=0,!A&&0<g&&(D=y,j=U(h.width-D-1,m-1+k),x.Ow(m-1,C,D+1,b,j,C)),_=A?0:U(k,g)-1,x.Ow(v,C,w+_,b,v+k,C),t.invalidateLayout(),O=t.columnOutlines&&!t.columnOutlines.iT()?t.columnOutlines.s0a()+u+1:0,x._l(T,new B.Rect(v-u,C,k+u+O+5,b)),F=d+_+D+2,x.Pw(T,new B.Rect(p-2,C,F,b)),this.sWc(t,C,b))}s||(t.invalidateLayout(),t.repaint()),r!==e&&t.Wq(B.Events.LeftColumnChanged,{sheet:t,sheetName:t.name(),oldLeftCol:r,newLeftCol:e}),(P=t._eventHandler)&&P._updateEditingEditor(),L=r===t.qq&&i!==t.eCb,s&&gt(t,L)&&(this.GHb=mt(t,this))}},vt.prototype.sWc=function(t,n,r){var i=t._render,a=i.bm();this.tWc(t).concat(this.uWc(t)).forEach(function(t){var e=t.layout,o=new B.Rect(e.x,n,e.width,r);i.dm(o),i.Pw(a,o)})},vt.prototype.tWc=function(t){var e,o,n,r,i,a,s,l=t.getSelections();return 1===l.length?(e=this.yw.options.scrollByPixel,o=t.qq,n=t.eCb,r=l[0].col,i=l[0].col+l[0].colCount-1,e&&i==o-1?[]:(a=[],(r===o+1||r<o&&o<=i||i==o-1||e&&r===o&&0!==n)&&(s=t.Hr(0))&&0<s.length&&a.push({layout:s[s.length-1]}),a)):[]},vt.prototype.uWc=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p=t.getSelections();return 1===p.length?(e=this.yw.options.scrollByPixel,o=t.getViewportRightColumn(1),n=p[0].col,r=p[0].col+p[0].colCount-1,i=[],l=(s=(a=t.Hr(2))&&0<a.length)?a[0]:G,h=(c=(u=t.Hr(1))&&0<u.length)?u.findCol(o):G,f=s&&c&&l.x!==h.x+h.width,(r==o-1||n<=o&&o<r||n===o+1||e&&r===o&&f)&&s&&i.push({layout:l}),i):[]},vt.prototype.Rw=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S=this.yw,M=!1,I=S.nKc,N=S.kKc,R=S.options.scrollbarShowMax,k=S.options.scrollbarAppearance===V.ScrollbarAppearance.mobile;if(t){if(r=t.name(),e.ctrlKey){if(!S.options.allowUserZoom)return!0;if(i=t.zoom(),void 0===A&&(A=12),a=+parseFloat((i-.05*o).toPrecision(A)),t.isEditing()&&!t.endEdit())return;if(s={sheet:t,sheetName:t.name(),oldZoomFactor:i,newZoomFactor:a,cancel:!1},t.Wq(B.Events.ViewZooming,s),s&&!0===s.cancel)return!1;l={cmd:"zoom",sheetName:r,oldZoomFactor:i,zoomFactor:s.newZoomFactor},t.wu().execute(l),i!==(a=t.zoom())&&(delete s.cancel,t.Wq(B.Events.ViewZoomed,s),t.Wq(B.Events.UserZooming,s))}else n=n||0,u=t.lq,c=t.cCb,f=(h=this.ms(t,o)).cj,p=h.UP,u!==f||c!==p?(k&&(I.Jwa(V.ScrollbarState.show),this.Rdc(!0)),this.ju(t,f,p),t.os(),R||t.es()):M=!0,d=t.qq,g=t.eCb,y=(m=this.Sw(t,n)).dj,b=m.UP,d===y&&g===b||(k&&(N.Jwa(V.ScrollbarState.show),this.Rdc(!1)),this.lu(t,y,b),t.qs(),R||t.ds());v=t.Vs(),C=t.hitTest(e.pageX-v.left,e.pageY-v.top),(x=(w=t.yt)&&w.cellTypeHitInfo)&&(x.cellRect=t.getCellRect(w.row,w.col)),(T=t._eventHandler).Tw(C),T.Uw(C)}return M&&0===n},vt.prototype.aCb=function(t,e){var o,n,r,i,a,s,l,u,c=t.lq,h=t.cCb,f=t.parent,p=t.zoom(),d=N(e*f.options.scrollPixel*p),g=0,m=t.am().qt,y=t.jt(1).findRow(c);if(y)if(d<0){for(o=t.Rt(-1),g=-(m-y.y);o<c&&d<=g;)c--,g-=t.Sl(c);h=g-d,c===o&&0<h&&(h=0)}else if(0<d){for(n=t.ns(),g=y.y+y.height-m;c<n&&g<=d;)c++,g+=t.Sl(c);h=g-d-(r=t.Sl(c)),f.options.scrollbarMaxAlign?(i=t.am(),a=t.frozenRowCount(),s=t.getRowCount()-t.frozenTrailingRowCount()-1,n=(l=t.LHb(t.oKc(i),a,s)).cj,u=l.UP,n<c?(c=n,h=u):c===n&&J(h)>J(u)&&(h=u)):c<n&&g-d==0?(c++,h=0):c===n&&g-d<0&&(h=-r)}return{cj:c,UP:h}},vt.prototype.ms=function(t,e){var o,n,r,i,a=t.lq,s=t.cCb,l=t.parent;return l&&l.options.scrollByPixel?l.ku.aCb(t,e):(0<(o=t.frozenRowCount())&&(0===a&&0<e?a=o:e<0&&a===o-e&&(a=0)),-1!==(n=t.Rt(a+e,e<0))?a=n:a+=e,r=t._t(),i=t.ns(),t.getRowCount()-o-t.frozenTrailingRowCount()<=0||r===G?a=t.lq:(a<r?a=r:i<a&&(a=i),a===G&&(a=-1)),{cj:a,UP:s})},vt.prototype._Bb=function(t,e){var o,n,r,i,a,s,l,u,c=t.qq,h=t.eCb,f=t.parent,p=t.zoom(),d=N(e*f.options.scrollPixel*p),g=0,m=t.am().pt,y=t.it(1).findCol(c);if(y)if(d<0){for(o=t.Ot(-1),g=-(m-y.x);o<c&&d<=g;)c--,g-=t.Tl(c);h=g-d,c===o&&0<h&&(h=0)}else if(0<d){for(n=t.ps(),g=y.x+y.width-m;c<n&&g<=d;)c++,g+=t.Tl(c);h=g-d-(r=t.Tl(c)),f.options.scrollbarMaxAlign?(i=t.am(),a=t.frozenColumnCount(),s=t.getColumnCount()-t.frozenTrailingColumnCount()-1,n=(l=t.MHb(t.rKc(i),a,s)).dj,u=l.UP,n<c?(c=n,h=u):c===n&&J(h)>J(u)&&(h=u)):c<n&&g-d==0?(c++,h=0):c===n&&g-d<0&&(h=-r)}return{dj:c,UP:h}},vt.prototype.Sw=function(t,e){var o,n,r,i,a=t.qq,s=t.eCb,l=t.parent;return l&&l.options.scrollByPixel?l.ku._Bb(t,e):(0<(o=t.frozenColumnCount())&&(0===a&&0<e?a=o:e<0&&a===o-e&&(a=0)),-1!==(n=t.Ot(a+e,e<0))?a=n:a+=e,r=t.$t(),i=t.ps(),t.getColumnCount()-o-t.frozenTrailingColumnCount()<=0||r===G?a=t.qq:(a<r?a=r:i<a&&(a=i),a===G&&(a=-1)),{dj:a,UP:s})},vt.prototype.Dw=function(t,e){var o,n,r=this.yw;dt(r)&&(n=t?(o=e.pageY,e.pageX-100):(o=e.pageY-40,e.pageX-30),r.uw(g.Ob(this.Nw(t)),n,o,!0))},vt.prototype.Nw=function(t){var e,o=dt(this.yw),n=o.qq+1;return o&&(e=t?ct().Tip_Row+(o.lq+1):(1!==o.options.colHeaderAutoText&&(n=B.Ul.xq(n)),ct().Tip_Column+n)),e},vt.prototype.Sdc=function(t){H.GC$(t).addClass(ot)},vt.prototype.Tdc=function(t){H.GC$(t).removeClass(ot)},vt.prototype.Udc=function(t){H.GC$(t).addClass(nt)},vt.prototype.uKc=function(t){H.GC$(t).removeClass(nt)},vt.prototype.Rdc=function(t,e){var o,n,r,i;void 0===e&&(e=1e3),n=(o=this).yw,r=t?n.vKc:n.wKc,i=function(){o.uKc(r),o.Sdc(r)},(n.options.scrollbarAppearance=V.ScrollbarAppearance.mobile)&&(o.Wdc(t),t?o.Xdc=setTimeout(i,e):o.Ydc=setTimeout(i,e))},vt.prototype.Wdc=function(t){t&&this.Xdc?(clearTimeout(this.Xdc),this.Xdc=null):!t&&this.Ydc&&(clearTimeout(this.Ydc),this.Ydc=null)},ht=vt,ft={allowUserDragDrop:!0,allowUserDragFill:!0,allowUserZoom:!0,allowUserResize:!0,allowUndo:!0,allowSheetReorder:!0,allowContextMenu:!0,allowUserDeselect:!0,defaultDragFillType:5,showDragFillSmartTag:!0,showHorizontalScrollbar:!0,showVerticalScrollbar:!0,scrollbarShowMax:!0,scrollbarMaxAlign:!1,tabStripVisible:!0,tabStripRatio:.5,tabStripPosition:V.TabStripPosition.bottom,tabStripWidth:80,tabEditable:!0,newTabVisible:!0,cutCopyIndicatorVisible:!0,cutCopyIndicatorBorderColor:"#217346",tabNavigationVisible:!0,backColor:"white",backgroundImage:G,backgroundImageLayout:0,showResizeTip:V.ShowResizeTip.none,showDragDropTip:!0,showDragFillTip:!0,scrollIgnoreHidden:!1,highlightInvalidData:!1,showScrollTip:V.ShowScrollTip.none,grayAreaBackColor:G,useTouchLayout:!1,hideSelection:!1,resizeZeroIndicator:V.ResizeZeroIndicator.enhanced,allowUserEditFormula:!0,enableFormulaTextbox:!0,referenceStyle:0,allowDynamicArray:!1,iterativeCalculation:!0,iterativeCalculationMaximumIterations:1e3,iterativeCalculationMaximumChange:.01,calcOnDemand:!1,autoFitType:V.AutoFitType.cell,allowCopyPasteExcelStyle:!0,allowExtendPasteRange:!1,copyPasteHeaderOptions:V.CopyPasteHeaderOptions.allHeaders,allowUserDragMerge:!1,rowResizeMode:V.ResizeMode.normal,columnResizeMode:V.ResizeMode.normal,scrollByPixel:!1,scrollPixel:5,enableAccessibility:!1,allowAutoCreateHyperlink:!0,scrollbarAppearance:V.ScrollbarAppearance.skin,font:G,customList:[],numbersFitMode:V.NumbersFitMode.mask,pasteSkipInvisibleRange:!1},Tt.prototype.commandManager=function(){return this.wu},Tt.prototype.undoManager=function(){return this.pv},Tt.prototype.Txb=function(){var t=this.Uxb(),e=this.Vxb;return e instanceof Array?e.concat(t):t},Tt.prototype.Uxb=function(){var t=S.culture(),e=[],o=[],n=S.q4("en-US").DateTimeFormat,r=S.q4(t).DateTimeFormat;return e=this.Wxb(n),"en-US"!==t&&(o=this.Wxb(r)),e.concat(o)},Tt.prototype.Wxb=function(e){var o,n,r=[];return this.Xxb=["abbreviatedDayNames","dayNames","abbreviatedMonthNames","monthNames"],this.Xxb.forEach(function(t){(o=e[t])instanceof Array&&0<o.length&&(n=-1<t.indexOf("month")||-1<t.indexOf("Month"),o=n?o.slice(0,12):o,r.push(o))}),r},Tt.prototype.FHb=function(){var t=C&&this.Cf();t&&t.NHb(),this.sheets.forEach(function(t){t.yj().OHb()})},Tt.prototype.Op=function(t,e,o){var n,r=this,i=dt(r),a=C&&r.Cf();switch(t){case"allowUndo":r.pv&&(r.pv.zc=e);break;case"backColor":r.Sxb=!0,i&&i.$p();break;case"cutCopyIndicatorBorderColor":case"cutCopyIndicatorVisible":case"grayAreaBackColor":case"hideSelection":case"highlightInvalidData":case"resizeZeroIndicator":case"allowUserDragFill":case"allowUserDragMerge":case"numbersFitMode":case"pasteSkipInvisibleRange":i&&i.$p();break;case"backgroundImage":case"backgroundImageLayout":r.Ys(),i&&i.$p();break;case"newTabVisible":case"tabNavigationVisible":(n=r.YJc)&&n.repaint();break;case"tabStripPosition":e!==o&&r.yKc(e);break;case"tabStripWidth":e!==o&&r.zKc(e);break;case"showHorizontalScrollbar":case"showVerticalScrollbar":case"useTouchLayout":case"tabStripVisible":r.fq();break;case"tabStripRatio":r.aq();break;case"scrollIgnoreHidden":case"scrollbarMaxAlign":case"scrollbarShowMax":i&&(i.oq=!0,i.jq=!0,i.$p());break;case"scrollByPixel":i&&(i.oq=!0,i.jq=!0,i.cCb=0,i.eCb=0,i.$p());break;case"scrollPixel":e<=0&&(r.options.scrollPixel=o);break;case"scrollbarAppearance":r.ku&&e!==o&&r.Zdc(e);break;case"calcOnDemand":a&&(!e&&a.calcOnDemand&&r.FHb(),a.calcOnDemand=e);break;case"customList":r.Vxb=e;break;case"referenceStyle":case"allowDynamicArray":case"iterativeCalculation":case"iterativeCalculationMaximumIterations":case"iterativeCalculationMaximumChange":r.PHb(t,e),i&&i.$p()}},Tt.prototype.Zdc=function(t){var e;z(t)&&(t=V.ScrollbarAppearance.skin),e=t===V.ScrollbarAppearance.mobile,this.nKc.$dc(t),this.kKc.$dc(t),this.AKc(),e?this.BKc():this.CKc(),this.refresh()},Tt.prototype.yKc=function(t){z(t)&&(t=V.TabStripPosition.bottom,this.options.tabStripPosition=t),this.sj&&(this.DKc(),this.v8a(),this.fq())},Tt.prototype.zKc=function(t){z(t)?(t=80,this.options.tabStripWidth=t):t<80&&(this.options.tabStripWidth=80),this.sj&&(this.DKc(),this.v8a(),this.fq())},Tt.prototype.PHb=function(t,e){var o=C&&this.Cf();if(o)switch(t){case"referenceStyle":o.useR1C1=1===e;break;case"allowDynamicArray":case"iterativeCalculation":case"iterativeCalculationMaximumIterations":case"iterativeCalculationMaximumChange":o[t]=e}},Tt.prototype.ad=function(t,e){var o,n,r,i,a=this;for(C&&a.qv(),a.rv=[],a.sv=w("input"),a.jm=0,a.xD=0,a.tv={fromSheet:G,isCutting:!1},a.mmb={fromSheet:G,isCutting:!1},a.Ks=G,a.sheets=[],a.pJc=[],a.Lq={},a.Vxb=a.options.customList,a.pv=new m(a,-1,a.options.allowUndo),(o=a.wu=new y(a)).EKc("beforeWorkbookExecute",function(t){a.FKc(t)}),o.addListener("workbookUndo",function(t){var e,o=t.command,n=s.Commands.aWa(o),r=a.wu[o.cmd];r&&r.canUndo()&&!n&&!o.yTa&&((e=a.getSheetFromName(o.sheetName))&&(o.sheetId=e._id),a.undoManager().Cc(o,t.s4)),1!==t.s4&&2!==t.s4||a.GKc(t)}),s.Commands.uv(o),Tt.ao(a,"init"),n=0;n<t;n++)r=a.vv(a._getDefaultSheetName(n)),a.sheets.push(r),r.Ls(a);(i=a.sheets[a.eq])&&i.isSelected(!0),a.suspendPaint(),e&&a.ws(e),a.uu=new l.S4(a),a.resumePaint()},Tt.prototype.hitTest=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D=this,j=D.WJc(),_=D.YJc,O=D.kKc,F=D.nKc,P=H.GC$(D.getHost()).width(),L=H.GC$(D.getHost()).height();if(t<0||P<t||e<0||L<e)return G;if(n=D.oia(),D.options.scrollbarAppearance===V.ScrollbarAppearance.mobile){if(r=function(t,e,o,n,r){var i=t.pia(),a=e.left-o.left,s=e.top-o.top;if(a<n&&n<i.width+a&&s<r&&r<i.height+s)return{horizontalScrollBarHitInfo:{element:t.hitTest(n-a,r-s).element},x:n,y:r}}(O,H.GC$(D.wKc).offset(),n,t,e))return r;if(i=function(t,e,o,n,r){var i=t.pia(),a=e.left-o.left,s=e.top-o.top;if(a<n&&n<i.width+a&&s<r&&r<i.height+s)return{verticalScrollBarHitInfo:{element:t.hitTest(n-a,r-s).element},x:n,y:r}}(F,H.GC$(D.vKc).offset(),n,t,e))return i}if(j&&(a=j.Vs(),s=j.Dr(),l=a.left-n.left,u=a.top-n.top,l<t&&t<s.width+l&&u<e&&e<s.height+u))return{worksheetHitInfo:j.hitTest(t-l,e-u,!1,o),x:t,y:e};if(c=H.GC$(_.Ws()).offset(),h=_.Dr(),f=c.left-n.left,p=c.top-n.top,f<t&&t<h.width+f&&p<e&&e<h.height+p){switch(g={},m=(d=_.hitTest(t-f,e-p)).index,b=(y=D.XJc(m))&&y.name(),d.type){case"navButton":g={navButton:d.element};break;case"sheetTab":g={sheetTab:{sheetName:b||d.element,sheetIndex:m}};break;case"resize":g={resize:!0};break;default:g={blank:!0}}return{tabStripHitInfo:g,x:t,y:e}}return v=H.GC$(O.Bv()).offset(),C=O.pia(),w=v.left-n.left,x=v.top-n.top,w<t&&t<C.width+w&&x<e&&e<C.height+x?{horizontalScrollBarHitInfo:{element:O.hitTest(t-w,e-x).element},x:t,y:e}:(T=H.GC$(F.Bv()).offset(),A=F.pia(),S=T.left-n.left,M=T.top-n.top,S<t&&t<A.width+S&&M<e&&e<A.height+M?{verticalScrollBarHitInfo:{element:F.hitTest(t-S,e-M).element},x:t,y:e}:(I=H.GC$(D.HKc).offset(),N=parseInt(D.HKc.style.width.substr(0,D.HKc.style.width.indexOf("px")),10),R=parseInt(D.HKc.style.height.substr(0,D.HKc.style.height.indexOf("px")),10),k=I.left-n.left,E=I.top-n.top,k<t&&t<N+k&&E<e&&e<R+E?{footerCornerHitInfo:{element:"footerCorner"},x:t,y:e}:void 0))},Tt.prototype.oia=function(){var t;return(t=rt?rt(this._host).offset():H.GC$(this._host).offset())?(t.top+=I.body.clientTop||0,t.left+=I.body.clientLeft||0):t={top:0,left:0},t},Tt.prototype.T3=function(t){var o=this.options,e=t||{};e=v(!0,{},ft,e),b(e,function(t,e){o.hasOwnProperty(t)&&(o[t]=e)})},Tt.prototype.xv=function(){return!this.Ks&&this._host&&(this.Ks=w(P),H.GC$(this.Ks).css({position:"relative",left:0,top:0,height:0}),H.GC$(this._host).prepend(this.Ks)),this.Ks},Tt.prototype._getDefaultSheetName=function(t){var e,o,n,r,i,a,s=this.getSheetCount();this._availableSheetIndex<s?this._availableSheetIndex=s:this._availableSheetIndex++,(z(t)||t<this._availableSheetIndex)&&(t=this._availableSheetIndex),e=!1,n=this.sheets;do{for(o=(ct().SHEET_NAME||"Sheet")+(t+1),r=n.length,i=0;i<r;i++)if(a=n[i]){if(a.name().toUpperCase()===o.toUpperCase()){t++,e=!0;break}e=e&&!1}}while(e);return o},Tt.prototype.vv=function(t){return new f.Worksheet(t)},Tt.prototype.setHost=function(t){this.ws(t)},Tt.prototype.ws=function(t){var e=this;t&&(e._host=t,e.IKc(),e.qm(),e.JKc(),e.KKc(),e.LKc(),e.MKc(),e.NKc(),e.OKc(),e.PKc(),e.QKc(),e.RKc(),e.BKc(),e.SKc(),e.TKc(),e.UKc(),e.VKc(),e.v8a(),e.fq(),e.Rv(t),Tt.ao(e,"setHost",t))},Tt.prototype.IKc=function(){var t=this._host;rt&&rt(t).data(at,this),H.GC$(t).data(at,this).attr(st,"gcSpread").addClass(lt).css("overflow","visible")},Tt.prototype.qm=function(){W.Yl.qm()},Tt.prototype.JKc=function(){var t=this;t.cultureChangedHandler=function(){t.Av()},I.addEventListener(it,t.cultureChangedHandler)},Tt.prototype.KKc=function(){this.WKc(),this.XKc(),this.YKc()},Tt.prototype.XKc=function(){var t,e,o,n,r,i=this._host,a=w("table"),s=a.style;for(a.cellSpacing="0px",a.cellPadding="0px",a.border="0",s.width="100%",s.height="100%",s.border="0",s.margin="0",s.borderCollapse="collapse",s.tableLayout="fixed",s.float="left",t=0;t<3;t++){for(e=w("tr"),o=0;o<2;o++)(r=(n=w("td")).style).padding="0",r.border="0",e.appendChild(n);a.appendChild(e)}i.appendChild(a),this.sj=a},Tt.prototype.WKc=function(){var t=this._host,e=w(P),o=e.style;o.width="0",o.height="0",o.float="left",t.appendChild(e),this.ZKc=e},Tt.prototype.YKc=function(){var t=this._host,e=w(P),o=e.style;o.width="0",o.height="0",o.float="left",t.appendChild(e),this.$Kc=e},Tt.prototype.LKc=function(){var t=this._host,e=this.sj.rows[1].cells[0],o=w(P);o.id=t.id+"vp",H.GC$(e).append(o),this.xs=o},Tt.prototype.MKc=function(){var t=this,e=t.sj.rows[1].cells[1],o=t.options,n=o.scrollByPixel,r=o.scrollbarAppearance,i=n?V.ScrollType.pixels:V.ScrollType.continuous,a=new u.hv(!1,G,G,G,G,G,i,r,function(){t.cec(!0)}),s=w(P),l=a.Bv();H.GC$(s).append(l),t.nKc=a,t.vKc=s,t._Kc=e},Tt.prototype.aLc=function(){var n=this,t=n.nKc.Bv();H.GC$(t).bind("scroll"+F,function(t,e){var o=e.scrollEventType;t.data=n,e.scrollOrientation===u.ScrollOrientation.verticalScroll&&(o===V.Nxb.smallDecrement||o===V.Nxb.smallIncrement||o===V.Nxb.largeDecrement||o===V.Nxb.largeIncrement||o===V.Nxb.thumbTrack?ht.Dv(t,e):o===V.Nxb.thumbPosition&&ht.Ev(t))}).bind("mousedown"+F,function(t){t.data=n,ht.Fv(t)}).bind("mouseup"+F,function(t){t.data=n,ht.Gv(t)}).bind("mousemove"+F,function(t){t.data=n,t.scrollbar=n.nKc,ht.ggc(t)})},Tt.prototype.NKc=function(){var t,e,o,n,r=this.sj.rows[2].cells[0],i=w("table"),a=i.style;for(i.cellSpacing="0",i.cellPadding="0",i.border="0",a.border="0",a.margin="0",H.GC$(i).css("user-select",K),t=w("tr"),e=0;e<2;e++)(n=(o=w("td")).style).padding="0",n.border="0",t.appendChild(o);i.appendChild(t),H.GC$(r).append(i),this.bLc=i},Tt.prototype.OKc=function(){var t=this._host,e=w(P),o=e.style;o.width=this.Iv()*H.GC$(t).width()+L,o.height=this.xJc()+L,o.fontSize="10pt",o.fontFamily="Arial",this.cLc=e},Tt.prototype.PKc=function(){var t=this,e=t.bLc.rows[0].cells[1],o=t.options,n=o.scrollByPixel,r=o.scrollbarAppearance,i=n?V.ScrollType.pixels:V.ScrollType.continuous,a=new u.hv(!0,G,G,G,G,G,i,r,function(){t.cec(!1)}),s=a.Bv(),l=w(P);H.GC$(l).append(s),t.kKc=a,t.wKc=l,t.dLc=e},Tt.prototype.eLc=function(){var n=this,t=n.kKc.Bv();H.GC$(t).bind("scroll"+F,function(t,e){var o=e.scrollEventType;t.data=n,e.scrollOrientation===u.ScrollOrientation.horizontalScroll&&(o===V.Nxb.smallDecrement||o===V.Nxb.smallIncrement||o===V.Nxb.largeDecrement||o===V.Nxb.largeIncrement||o===V.Nxb.thumbTrack?ht.Lv(t,e):o===V.Nxb.thumbPosition&&ht.Mv(t))}).bind("mousedown"+F,function(t){t.data=n,ht.Nv(t)}).bind("mouseup"+F,function(t){t.data=n,ht.Gv(t)}).bind("mousemove"+F,function(t){t.data=n,t.scrollbar=n.kKc,ht.ggc(t)})},Tt.prototype.QKc=function(){this.fLc(),this.gLc()},Tt.prototype.fLc=function(){var t=this.sj.rows[0].cells[1],e=w(P);H.GC$(t).append(e),this.hLc=e},Tt.prototype.gLc=function(){var t=this.sj.rows[2].cells[1],e=w(P);H.GC$(t).append(e),this.HKc=e},Tt.prototype.SKc=function(){this.ku=new ht(this)},Tt.prototype.RKc=function(){this.aLc(),this.eLc()},Tt.prototype.BKc=function(){var t,e,o,n=this;n.options.scrollbarAppearance===V.ScrollbarAppearance.mobile&&(t=n._host,e=n.vKc,o=n.wKc,H.GC$(e).bind(E,function(){n.nKc.Jwa(V.ScrollbarState.active)}).bind(D,function(){n.nKc.Jwa(V.ScrollbarState.inactive)}),H.GC$(o).bind(E,function(){n.kKc.Jwa(V.ScrollbarState.active)}).bind(D,function(){n.kKc.Jwa(V.ScrollbarState.inactive)}),H.GC$(t).bind(E,n.fec).bind(D,n.gec))},Tt.prototype.CKc=function(){var t=this.vKc,e=this.wKc;t&&(H.GC$(t).unbind(E).unbind(D),this.ku.Wdc(!0)),e&&(H.GC$(e).unbind(E).unbind(D),this.ku.Wdc(!1)),H.GC$(this._host).unbind(E,this.fec).bind(D,this.gec)},Tt.prototype.fec=function(){H.GC$(this).find("."+X).addClass(et)},Tt.prototype.gec=function(){H.GC$(this).find("."+X).removeClass(et)},Tt.prototype.TKc=function(){this.DKc(),this.AKc()},Tt.prototype.AKc=function(){var t,e,o,n,r,i=this._host;this.ku&&(t=this.options.scrollbarAppearance===V.ScrollbarAppearance.mobile,e=this._Kc,o=this.dLc,n=this.vKc,r=this.wKc,H.GC$(n).removeAttr("style"),H.GC$(r).removeAttr("style"),t?(n.style.position="absolute",n.style.top="0px",n.style.left="0px",H.GC$(n).addClass(X+" "+tt),H.GC$(i).css("position","relative").append(n),r.style.position="absolute",r.style.top="0px",r.style.left="0px",H.GC$(r).addClass(X+" "+$),H.GC$(i).append(r)):(H.GC$(e).append(n),H.GC$(o).append(r),H.GC$(n).removeClass(X+" "+ot+" "+tt+" "+nt),H.GC$(r).removeClass(X+" "+ot+" "+$+" "+nt),H.GC$(i).css("position","auto")))},Tt.prototype.DKc=function(){var t,e=this.sj,o=this.bLc,n=this.cLc,r=this.options.tabStripPosition;r===V.TabStripPosition.bottom?t=o.rows[0].cells[0]:r===V.TabStripPosition.top?t=e.rows[0].cells[0]:r===V.TabStripPosition.left?t=this.ZKc:r===V.TabStripPosition.right&&(t=this.$Kc),H.GC$(t).append(n)},Tt.prototype.Rv=function(t){var e=this,o=M(H.GC$(t).attr("tabindex"),10)||0,n=w(P);H.GC$(n).css({position:"absolute",overflow:"hidden"}).attr(st,"gcSheetFocusElementForTab").attr("tabindex",o).bind("focus",function(){e.Sv||dt(e).zt(),e.Sv=!1}),t.insertBefore(n,G),e.Tv=n},Tt.prototype.UKc=function(){function t(){e.Pv()}var e=this;H.GC$(W).bind(j+_,t),e.oTa=t},Tt.prototype.VKc=function(){var t=dt(this);t&&t.ws(this.xs)},Tt.prototype.Uv=function(){var t=this.Tv;t&&(this.Sv=!0,t.focus())},Tt.prototype.hgc=function(){var t,e,o,n,r,i=this.getActiveSheet();if(i)if(B.Vl.Wl(i)){if(e=this._host)for(o=document.activeElement,n=document.body,r=o;r;){if(r===e){t=o;break}if(r===n)break;r=r.parentElement}}else i.Xs&&(t=i.Xs);return t},Tt.prototype.dgc=function(e){var o=this;o.igc&&(W.clearTimeout(o.igc),o.igc=G),o.igc=W.setTimeout(function(){var t=o.hgc();t&&t.setAttribute("aria-label",e),W.clearTimeout(o.igc),o.igc=G},50)},Tt.prototype.no=function(){var t,e,o,n,r,i,a=this,s=a.kKc,l=a.nKc,u=a.sheets,c=a.options.scrollbarAppearance===V.ScrollbarAppearance.mobile;for(a.vXc(),B.En.Tn(a),B.Ul.no(),a.oTa&&H.GC$(W).unbind(j+_,a.oTa),a.oTa=G,a.Zv&&clearTimeout(a.Zv),s&&s.dispose(),l&&l.dispose(),a.mu(),a.xw(),B.Vl.Xl()===a.getActiveSheet()&&B.Vl.Zl(G),t=0;t<u.length;t++)u[t].no(!0);for(u.splice(0,u.length),e=a.pJc,t=0;t<e.length;t++)e[t].no(!0);e.splice(0,e.length),(o=a.uu)&&(o.no(),a.uu=G),i="unselectable",(n=a._host)&&(r=H.GC$(n),I.removeEventListener(it,a.cultureChangedHandler),r.html("").removeAttr(st).removeClass(lt),r.attr("class")||r.removeAttr("class"),r.attr(i)||r.removeAttr(i),r.data(at)&&r.data(at,G),rt&&rt(n).data(at)&&rt(n).data(at,G)),c&&a.CKc(),a.wKc=G,a.vKc=G,a.pv&&(a.pv.no(),a.pv=G),a.YJc&&(a.YJc.no(),a.YJc=G),Tt.ao(a,"dispose"),a.Tv&&(H.GC$(a.Tv).unbind("focus"),a.Tv=G),a.Wu&&(a.Wu.dispose(),a.Wu=G,a.yv=G,a.zv=G),a.bt&&(a.bt.no(),a.bt=G),h.To.no(),a.wu&&(a.wu.no(),a.wu=G),a.ku&&(a.ku.no(),a.ku=G)},Tt.prototype.mu=function(){var t,e=this.sheets;for(H.GC$(this.sv).unbind(_),t=0;t<e.length;t++)e[t].mu()},Tt.prototype.vXc=function(){var t,e,o,n=this.wXc;if(n)for(t=0,e=n;t<e.length;t++)(o=e[t]).close&&o.close();this.wXc=[]},Tt.prototype.v8a=function(){var t=M(B.Im.Lm("").zIndex),e=t!==this.Vv;e&&this.iLc(t),this.jLc(e),this.aZ(),this.kLc()},Tt.prototype.iLc=function(t){this.Vv=t},Tt.prototype.jLc=function(t){var e=this._host,o=this.Vv,n=e.getAttribute("id")+"_tabStrip",r=this.YJc;r&&!t?(r.TJc(),r.repaint()):(r&&r.no(),r=2007<o?new i.iv(n):new a.jv(n),(this.YJc=r).Yv(this),r.ws(this.cLc))},Tt.prototype.aZ=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m=this.options.scrollbarAppearance===V.ScrollbarAppearance.mobile,y=this.xJc(),b=this.Wv(),v=this.Xv();m?this.hec():(l=this.vKc,u=v,c=b,p=B.Im.Lm("gc-vertical-scrollbar"+Q),d=2007<M(p.zIndex)?1:0,f=(g=u-c)%2==0?(h=g/2)-d:h=(g-d)/2,H.GC$(l).css({"box-sizing":Y,border:K,"border-color":K,"border-left-style":"solid","border-left-width":d+L,"border-left-color":p.borderLeftColor,"background-color":p.backgroundColor,width:c,padding:"0px "+h+"px 0px "+f+L,margin:0}),t=this.wKc,e=y,o=b,i=B.Im.Lm("gc-horizontal-scrollbar"+Q),a=2007<M(i.zIndex)?1:0,r=(s=e-o)%2==0?(n=s/2)-a:n=(s-a)/2,H.GC$(t).css({"box-sizing":Y,border:K,"border-color":K,"border-top-style":"solid","border-top-width":a+L,"border-top-color":i.borderTopColor,"background-color":i.backgroundColor,height:o,padding:r+"px 0px "+n+"px 0px",margin:0}))},Tt.prototype.kLc=function(){Ct(this.HKc),Ct(this.hLc)},Tt.prototype.Pv=function(){var t=this,e=t.Zv;e&&clearTimeout(e),t.Zv=W.setTimeout(function(){B.En.Un(),t.fq(),t.Zv=G},100)},Tt.prototype.fq=function(){this.kv||(this.kv=!0,this.$v(),this.kv=!1)},Tt.prototype.$v=function(){var t=this;t._host&&(t.lLc(),t.mLc(),t.nLc(),t.oLc(),t.pLc(),t.qLc(),t.rLc(),t.sLc(),t.tLc(),t.uLc(),t.vLc(),t.wLc())},Tt.prototype.lLc=function(){var t,e,o,n,r,i,a,s,l,u=this.ZKc;u&&(t=u.style,o=(e=this.options).tabStripVisible,n=e.tabStripPosition,r=o?e.tabStripWidth:0,i=this._host,a=H.GC$(i).height(),l=n===V.TabStripPosition.left?(s=r,a):s=0,t.width=s+L,t.height=l+L)},Tt.prototype.mLc=function(){var t,e,o,n,r,i,a,s=this.sj;s&&(t=s.style,o=(e=this.options).tabStripVisible,n=e.tabStripPosition,r=e.tabStripWidth,i=H.GC$(this._host).width(),a=!o||n!==V.TabStripPosition.left&&n!==V.TabStripPosition.right?i+L:R(xt(this._host))-r+L,t.width=a)},Tt.prototype.oLc=function(){var t,e,o,n,r,i,a,s,l,u=this.$Kc;u&&(t=u.style,o=(e=this.options).tabStripVisible,n=e.tabStripPosition,r=o?e.tabStripWidth:0,i=this._host,a=H.GC$(i).height(),l=n===V.TabStripPosition.right?(s=r,a):s=0,t.width=s+L,t.height=l+L)},Tt.prototype.nLc=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m=this._host,y=H.GC$(m),b=this.xs;b&&(t=b.style,e=y.width(),o=y.height(),n=this.Xv(),r=this.xJc(),a=(i=this.options).showVerticalScrollbar,s=i.showHorizontalScrollbar,l=i.scrollbarAppearance,u=i.tabStripVisible,c=i.tabStripPosition,h=u?i.tabStripWidth:0,f=l===V.ScrollbarAppearance.mobile,d=(p=c===V.TabStripPosition.left||c===V.TabStripPosition.right)?R(xt(m)):e,a&&!f&&(d-=n),p&&(d-=h),g=o,c===V.TabStripPosition.top?(s&&!f&&(g-=r),u&&(g-=r)):(s&&!f||u&&c===V.TabStripPosition.bottom)&&(g-=r),g<2&&(g=2),t.width=d+L,t.height=g+L)},Tt.prototype.pLc=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b=this,v=b._host,C=H.GC$(v),w=b.xs;w&&(t=C.width(),e=H.GC$(w).height(),o=b.kKc,n=b.nKc,i=(r=b.options).showVerticalScrollbar,a=r.showHorizontalScrollbar,s=r.scrollbarAppearance,l=r.tabStripVisible,u=r.tabStripPosition,c=l?r.tabStripWidth:0,h=s===V.ScrollbarAppearance.mobile,f=b.Wv(),p=b.Xv(),d=b.xLc(),i?(H.GC$(b.vKc).show(),H.GC$(n.Bv()).show()):(H.GC$(b.vKc).hide(),H.GC$(n.Bv()).hide()),a?(H.GC$(b.wKc).show(),H.GC$(o.Bv()).show()):(H.GC$(b.wKc).hide(),H.GC$(o.Bv()).hide()),g=e,n.Vo(f),n._v(g),m=t,u!==V.TabStripPosition.left&&u!==V.TabStripPosition.right||(m-=c),l&&!h&&u===V.TabStripPosition.bottom&&(m-=d),i&&!h&&(m-=p),m<=0&&(m=1),y=f,a||l||u!==V.TabStripPosition.bottom||(y=0),o.Vo(m),o._v(y))},Tt.prototype.xLc=function(){var t,e=this.xs,o=this.options,n=o.tabStripPosition,r=o.tabStripWidth,i=H.GC$(e).width();return n===V.TabStripPosition.bottom||n===V.TabStripPosition.top?(t=N(this.Iv()*i),n===V.TabStripPosition.bottom&&t===i&&(t=i-1)):t=r,t},Tt.prototype.qLc=function(){var t,e,o,n,r,i,a,s=this._host,l=H.GC$(s).height(),u=this.cLc;u&&(t=u.style,o=(e=this.options).tabStripVisible,n=e.tabStripPosition,r=this.xJc(),i=this.xLc(),a=n===V.TabStripPosition.bottom||n===V.TabStripPosition.top?r:l,o||(a=0),t.width=i+L,t.height=a+L)},Tt.prototype.rLc=function(){var t,e,o,n,r=this.hLc,i=this.HKc,a=this.options,s=a.showVerticalScrollbar,l=a.showHorizontalScrollbar,u=a.tabStripVisible,c=a.tabStripPosition,h=a.scrollbarAppearance===V.ScrollbarAppearance.mobile,f=this.Xv(),p=this.xJc();e=c===V.TabStripPosition.top?(t=s&&!h?f:0,u?p:0):t=0,H.GC$(r).css("width",t+L),H.GC$(r).css("height",e+L),o=s&&!h?f:0,l||u&&c===V.TabStripPosition.bottom?(n=p,h&&(!u||u&&c!==V.TabStripPosition.bottom)&&(n=0)):n=0,H.GC$(i).css("width",o+L),H.GC$(i).css("height",n+L)},Tt.prototype.sLc=function(){var t,e,o,n,r;this.xs&&(t=this.sj,o=(e=this.options).scrollbarAppearance===V.ScrollbarAppearance.mobile,n=e.showVerticalScrollbar,r=[H.GC$(this.xs).width(),this.Xv()],!o&&n||(r[1]=0),t.rows[0].cells[0].style.width=r[0]+L,t.rows[0].cells[1].style.width=r[1]+L)},Tt.prototype.uLc=function(){var t=this.options.scrollbarAppearance===V.ScrollbarAppearance.mobile;t&&this.hec(),this.Ut(),this.Xt(),t&&(this.nKc.Jwa(V.ScrollbarState.hide),this.kKc.Jwa(V.ScrollbarState.hide))},Tt.prototype.vLc=function(){this.options.tabStripVisible?H.GC$(this.cLc).show():H.GC$(this.cLc).hide(),this.YJc&&this.YJc.fq()},Tt.prototype.tLc=function(t){var e;void 0===t&&(t=!0),(e=B.sJc(this))&&(0===e.lq&&(e.lq=e._t()),0===e.qq&&(e.qq=e.$t()),t&&e.fq())},Tt.prototype.wLc=function(){var t,e,o,n,r=this,i=B.sJc(r);i&&(i.invalidateLayout(),i.repaint()),t=r._host,(o=(e=H.GC$(t)).width())!==(n=e.width())&&2<J(o-n)&&!r.aw&&(r.aw=!0,setTimeout(function(){delete r.aw,r.$v()},1))},Tt.prototype.hec=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S=this;z(S._host)||(t=H.GC$(S._host),(e=S.getActiveSheet())&&(o=H.GC$(S.vKc),n=H.GC$(S.wKc),r=e.am(),i=t.width(),a=t.height(),l=(s=S.options).tabStripVisible,u=s.showVerticalScrollbar,c=s.tabStripPosition,h=l?s.tabStripWidth:0,f=l?S.xJc():0,p=r.x+r.Br,d=r.y+r.Cr,g=u?o.width():0,m=a-d,c!==V.TabStripPosition.bottom&&c!==V.TabStripPosition.top||(m-=f),y=0,c===V.TabStripPosition.right&&(y+=h),b=d,c===V.TabStripPosition.top&&(b+=f),v=m-M(o.css("padding-top"))-M(o.css("padding-bottom")),C=i-g-p,c!==V.TabStripPosition.left&&c!==V.TabStripPosition.right||(C-=h),w=n.height(),x=0,c===V.TabStripPosition.bottom&&(x+=f),T=p,c===V.TabStripPosition.left&&(T+=h),A=C-M(n.css("padding-left"))-M(n.css("padding-right"))-2,S.nKc.Vo(g),S.nKc._v(v),S.kKc.Vo(A),S.kKc._v(w),o.css(["height","left","right","top"],[m,"auto",y,b]),n.css(["width","top","bottom","left"],[C,"auto",x,T])))},Tt.prototype.Ut=function(){var t=this.WJc(),e=this.options;t&&t.Ut(e.scrollbarMaxAlign,e.scrollbarShowMax,this.kKc)},Tt.prototype.Xt=function(){var t=this.WJc(),e=this.options;t&&t.Xt(e.scrollbarMaxAlign,e.scrollbarShowMax,this.nKc)},Tt.prototype.aq=function(){this._host&&(this.qLc(),this.pLc(),this.tLc(!1),this.uLc(),this.vLc())},Tt.prototype.suspendPaint=function(){var t,e,o,n,r=this.YJc,i=this.sheets,a=this.pJc;for(this.xD++,t=0,e=i;t<e.length;t++)e[t].suspendPaint();for(o=0,n=a;o<n.length;o++)n[o].suspendPaint();r&&r.fw()},Tt.prototype.resumePaint=function(){var t,e,o,n,r=this.YJc,i=this.sheets,a=this.pJc;for(this.xD-=0<this.xD?1:0,t=0,e=i;t<e.length;t++)e[t].resumePaint();for(o=0,n=a;o<n.length;o++)n[o].resumePaint();r&&r.gw()},Tt.prototype.isPaintSuspended=function(){return 0<this.xD},Tt.prototype.Ys=function(){var t,e,o,n,r,i=this,a=i.options.backgroundImage,s=i.options.backgroundImageLayout,l=dt(i);if(l&&a&&(t=void 0,H.GC$(l.Ws()).css({"background-image":"url('"+a+"')","background-repeat":"no-repeat"}),!z(s))){t=(t=i.bt)||(i.bt=new c.oo(function(){i.bt&&i.Ys()}));try{t.ko(a)?(e=t.lo(a),n=(o=l.Dr()).width,r=o.height,B.Ul.ql(l.Ws(),n,r,e.width,e.height,s)):t.fo(a)}catch(t){}}},Tt.prototype.hw=function(t){var e=t.name(),o=this.getSheetIndex(e);z(o)&&(o=this.getSheetCount()+this.getSheetTabIndex(e)),this.YJc.iw(o)},Tt.prototype.startSheetIndex=function(t){var e=this.YJc;return 0===arguments.length?e?e.gq:0:(e&&(e.hE(t)||-1===(t=e.jw(t))&&(t=e.rw(t)),e.gq=t),this.aq(),this)},Tt.prototype.Iv=function(){var t,e,o,n,r,i=this.options,a=this.options.scrollbarAppearance===V.ScrollbarAppearance.mobile,s=i.tabStripPosition;return i.showHorizontalScrollbar&&!a&&s===V.TabStripPosition.bottom?(t=i.tabStripRatio,isNaN(t)?.5:(e=0,o=this.xs,n=this.YJc,o&&n&&(r=H.GC$(o).width(),e=n.AJc()/r),t<e?t=e:1<t&&(t=1),t)):1},Tt.prototype.destroy=function(){this.oTa&&H.GC$(W).unbind(j+_,this.oTa),this.no()},Tt.prototype.repaint=function(){var t,e=this.YJc;e&&e.repaint(),(t=B.sJc(this))&&t.repaint()},Tt.prototype.refresh=function(){this._host&&(B.Im.Nm(),this.v8a(),this.fq(),this.repaint())},Tt.prototype.getHost=function(){return this._host},Tt.prototype.invalidateLayout=function(){var t=B.sJc(this);t&&t.invalidateLayout()},Tt.prototype.addNamedStyle=function(t){this.Kq(t);var e=B.sJc(this);e&&e.$p()},Tt.prototype.Kq=function(t){if(t){if(!t.name)throw Error(ct().Exp_EmptyNamedStyle);var e=t.name.toUpperCase();this.Lq[e]=t}},Tt.prototype.getNamedStyle=function(t){return this.Mq(t,!0)},Tt.prototype.Mq=function(t,e){var o,n=this.Lq;return n&&t?((o=n[t=t.toUpperCase()])&&e&&this.Jq(),o):G},Tt.prototype.Jq=function(){var t,e;for(t=0,e=this.sheets;t<e.length;t++)e[t].Jq()},Tt.prototype.removeNamedStyle=function(t){var e,o,n=this.Lq;n&&t&&(t=t.toUpperCase(),n.hasOwnProperty(t)&&((e=n[t].formatter)&&"string"==typeof e&&this.QHb[e]&&this.RHb(e),delete n[t],this.Jq(),(o=B.sJc(this))&&o.$p()))},Tt.prototype.getNamedStyles=function(){var o=[],t=this.Lq;return t&&b(t,function(t,e){o.push(e)}),this.Jq(),o},Tt.prototype.getActiveSheet=function(){return this.sheets&&0<this.sheets.length?this.sheets[this.eq]:G},Tt.prototype.getActiveSheetTab=function(){return this.pJc&&0<this.pJc.length?this.pJc[this.xKc]:G},Tt.prototype.setActiveSheet=function(t){var e=this.getActiveSheet(),o=this.getActiveSheetTab();this.lw(t,2),this.SHb(e),this.yLc(o)},Tt.prototype.setActiveSheetTab=function(t){var e=this.getActiveSheet(),o=this.getActiveSheetTab();"number"==typeof t?this.hKc(t,2):"string"==typeof t&&this.zLc(t,2),this.SHb(e),this.yLc(o)},Tt.prototype.lw=function(t,e){var o,n=this.sheets;for(o=0;o<n.length;o++)if(n[o].name()===t){this.dq(o,e);break}},Tt.prototype.zLc=function(t,e){var o,n=this.pJc;for(o=0;o<n.length;o++)if(n[o].name()===t){this.hKc(o,e);break}},Tt.prototype.getActiveSheetIndex=function(){return this.eq},Tt.prototype.getActiveSheetTabIndex=function(){return this.xKc},Tt.prototype.setActiveSheetIndex=function(t){var e=this.getActiveSheet(),o=this.getActiveSheetTab();this.dq(t,2),this.SHb(e),this.yLc(o)},Tt.prototype.dq=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p;typeof t==k&&(t===(r=this).eq||(i=r.sheets[t])&&i.visible()&&(((a=B.Ul.rl()).ipad||a.iphone)&&(s=r.mw)&&(new Date).valueOf()-s<300||((u=l=dt(r))||(u=(c=r.getActiveSheetTab())&&c.kj),f={oldSheet:u,newSheet:i,cancel:!(h={oldSheet:u,newSheet:i,needTriggerSheetChange:!0})},(p=h.needTriggerSheetChange&&n)&&bt(r,f),!1===f.cancel&&(r.eq=t,r.ALc(),i!==l&&(l&&(l.no(!1),l.charts&&l.charts.all().forEach(function(t){t.clearflexDVs()})),r.nw(i,e,!1,p,o)),r.fq(),p&&yt(r,u,i)),(a.ipad||a.iphone)&&(r.mw=(new Date).valueOf()))))},Tt.prototype.hKc=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p;typeof t==k&&(t===(r=this).xKc||(i=r.pJc[t])&&i.visible()&&(a=i.kj,((s=B.Ul.rl()).ipad||s.iphone)&&(l=r.mw)&&(new Date).valueOf()-l<300||(f={oldSheet:c=(u=r.getActiveSheetTab())?u.kj:r.getActiveSheet(),newSheet:a,cancel:!(h={oldSheet:c,newSheet:a,needTriggerSheetChange:!0})},(p=h.needTriggerSheetChange&&n)&&bt(r,f),!1===f.cancel&&(r.xKc=t,r.BLc(),i!==u&&(u&&u.no(!1),r.CLc(i,e,!1,p,o)),r.fq(),p&&yt(r,c,a)),(s.ipad||s.iphone)&&(r.mw=(new Date).valueOf()))))},Tt.prototype.nw=function(t,e,o,n,r){var i,a,s;o||t.ws(this.xs),a=(i=B.Vl.Xl())&&i.parent===this,s=2===e?a:1===e,B.Vl.Zl(G),!this.mv&&s&&t.zt(r),t.qs(),t.os()},Tt.prototype.CLc=function(t,e,o,n,r){var i,a,s;o||t.ws(this.xs),a=(i=B.Vl.Xl())&&i.parent===this,s=2===e?a:1===e,B.Vl.Zl(G),!this.mv&&s&&t.zt(r),t.qs(),t.os()},Tt.prototype.SHb=function(t){var e=this.getActiveSheet();t&&t.DHb(!1,!1),e&&e.DHb(!0,!1)},Tt.prototype.yLc=function(t){var e=this.getActiveSheetTab();t&&t.DHb(!1,!1),e&&e.DHb(!0,!1)},Tt.prototype.addSheet=function(t,e){var o=this.getActiveSheet(),n=this.getActiveSheetTab();this.ow(t,2,e),this.SHb(o),this.yLc(n)},Tt.prototype.addSheetTab=function(t,e,o){var n=this.getActiveSheet(),r=this.getActiveSheetTab(),i=this.DLc(e,o);if(i)return this.ELc(t,2,i),this.SHb(n),this.yLc(r),i},Tt.prototype.ow=function(t,e,o){var n,r,i,a,s,l,u,c,h=this;if(o=o||h.vv(h._getDefaultSheetName(t)),i=(r=h.sheets).length,o.name()){for(n=0;n<i;n++)if(r[n].name()===o.name())throw ct().Exp_NotSupported}else o.cq(h._getDefaultSheetName(t));for(h.pw(o),a=dt(h),s=h.eq,l=i-t,u=[],n=0;n<l&&0<i;n++)u.push(r.pop());for(r.push(o),o.Ls(h);0<u.length;)r.push(u.pop());1===(i=r.length)?(h.xs&&o.ws(h.xs),h.eq=0):(s<0&&h.YJc&&(s=h.YJc.jw(s)),h.eq=s),h.ALc(),(c=dt(h))!==a&&(a&&a.no(!1),c&&h.nw(c,e,1===i,!0),h.fq()),h.YJc&&(h.YJc.gq<0&&(h.YJc.gq=h.eq),h.YJc.repaint())},Tt.prototype.ELc=function(t,e,o){var n,r,i,a,s,l,u,c,h;if(o){for(a=(i=(n=this).pJc).length,r=0;r<a;r++)if(i[r].name()===o.name())throw ct().Exp_NotSupported;for(n.pw(o),s=n.getActiveSheetTab(),l=n.xKc,u=a-t,c=[],r=0;r<u&&0<a;r++)c.push(i.pop());for(i.push(o),o.Ls(n);0<c.length;)i.push(c.pop());1===(a=i.length)?(n.xs&&o.ws(n.xs),n.xKc=0):(l<0&&n.YJc&&(l=n.YJc.jw(l)),n.xKc=l),n.BLc(),(h=n.getActiveSheetTab())!==s&&(s&&s.no(!1),h&&n.CLc(h,e,1===a,!0),n.fq()),n.YJc&&(n.YJc.gq<0&&(n.YJc.gq=n.xKc),n.YJc.repaint())}},Tt.prototype.removeSheet=function(t){this.qw(t,2)},Tt.prototype.removeSheetTab=function(t){"string"==typeof t&&(t=this.getSheetTabIndex(t)),this.FLc(t,2)},Tt.prototype.qw=function(t,e){var o,n,r,i,a,s,l,u,c,h,f=this,p=f.sheets,d=f.Wu,g=f.YJc,m=p.length;if(isNaN(t)||t<0||m<=t)throw Error(ct().Exp_IndexOutOfRange);if(o=t<=f.eq||t===m-1,n=dt(f),t<f.eq&&f.eq--,(r=p[t]).mu(),p.splice(t,1),0===(m=p.length))f.eq=-1;else if(f.eq>=m)f.eq=g.rw(m);else{for(i=void 0,i=f.eq;i<m;i++)if(p[i].visible()){f.eq=i;break}m<=i&&(f.eq=g.rw(m))}f.ALc(),!o||n!==(a=p[f.eq])&&(n&&n.no(!1),a&&f.nw(a,e,!1,!0)),d&&((s=r.yj()).VDc=t,d.removeSource(s),l=r.fDc,d.removeSource(l),u=r.hDc,d.removeSource(u),c=r.Vva,z(c)||d.removeSource(c)),r.no(!0,-1!==f.eq),C&&!d._parserContext&&f.sheets&&0<f.sheets.length&&(h=f.sheets[0],d.initParserContext(h.yj())),g&&(g.gq>=m?f.startSheetIndex(g.rw(m)):g.gq<0?f.startSheetIndex(g.jw(-1)):f.fq())},Tt.prototype.FLc=function(t,e){var o,n,r,i,a,s=this,l=s.pJc,u=s.YJc,c=l.length;if(isNaN(t)||t<0||c<=t)throw Error(ct().Exp_IndexOutOfRange);if(o=t<=s.xKc||t===c-1,n=s.getActiveSheetTab(),t<s.xKc&&s.xKc--,(r=l[t]).mu(),l.splice(t,1),0===(c=l.length))s.xKc=-1;else if(s.xKc>=c)s.xKc=u.rw(c);else{for(i=void 0,i=s.xKc;i<c;i++)if(l[i].visible()){s.xKc=i;break}c<=i&&(s.xKc=u.rw(c))}s.BLc(),!o||n!==(a=l[s.xKc])&&(n&&n.no(!1),a&&s.CLc(a,e,!1,!0)),r.no(!0,-1!==s.xKc),u&&(u.gq>=c?s.startSheetIndex(u.rw(c)):u.gq<0?s.startSheetIndex(u.jw(-1)):s.fq())},Tt.prototype.clearSheets=function(){var t,e,o,n=this.sheets,r=this.Wu,i=this.YJc;for(t=0,e=n;t<e.length;t++)(o=e[t]).mu(),o.no(!0);n.splice(0,n.length),r&&r.clearSource(),this.eq=-1,i&&(i.gq=-1,i.repaint())},Tt.prototype.clearSheetTabs=function(){var t,e,o,n=this.pJc,r=this.YJc;for(t=0,e=n;t<e.length;t++)(o=e[t]).mu(),o.no(!0);n.splice(0,n.length),this.xKc=-1,r&&(r.gq=-1,r.repaint())},Tt.prototype.getSheet=function(t){var e=this.sheets;return 0<=t&&t<e.length?e[t]:G},Tt.prototype.getSheetTab=function(t){var e,o,n,r=this.pJc;if("number"==typeof t)return 0<=t&&t<r.length?r[t]:G;if("string"==typeof t)for(e=0,o=r;e<o.length;e++)if((n=o[e]).name()===t)return n;return G},Tt.prototype.getSheetFromName=function(t){var e,o,n;for(e=0,o=this.sheets;e<o.length;e++)if((n=o[e]).name()===t)return n;return G},Tt.prototype.getSheetIndex=function(t){var e,o=this.sheets;for(e=0;e<o.length;e++)if(o[e].name()===t)return e;return G},Tt.prototype.getSheetTabIndex=function(t){var e,o=this.pJc;for(e=0;e<o.length;e++)if(o[e].name()===t)return e;return G},Tt.prototype.getSheetCount=function(){return this.sheets.length},Tt.prototype.getSheetTabCount=function(){return this.pJc.length},Tt.prototype.setSheetCount=function(t){var e=this.getActiveSheet(),o=this.getActiveSheetTab();this.sw(t,2),this.SHb(e),this.yLc(o)},Tt.prototype.sw=function(t,e){var o,n;if(t<0)throw ct().Exp_ArgumentOutOfRange;if(0===t&&this.clearSheets(),t<(o=this.sheets.length))for(n=o-1;t<=n;n--)this.qw(n,e);else if(o<t)for(n=o;n<t;n++)this.ow(n,e)},Tt.prototype.gKc=function(t,e){var o,n,r,i,a;if(t<0)throw ct().Exp_ArgumentOutOfRange;if(0===t&&this.clearSheetTabs(),o=this.getActiveSheet(),n=this.getActiveSheetTab(),t<(r=this.pJc.length))for(i=r-1;t<=i;i--)this.FLc(i,e);else if(r<t)for(i=r;i<t;i++)a=this.DLc(G,V.SheetType.tableSheet),this.ELc(i,e,a);this.SHb(o),this.yLc(n)},Tt.prototype.DLc=function(t,e){return G},Tt.prototype.bind=function(t,e,o){var n,r,i,a,s=this.sheets;for(this.rv&&this.rv.push({type:t,data:e,fn:o}),H.GC$(this.sv).bind(t+_,e,o),n=0,r=s;n<r.length;n++)r[n].bind(t,e,o);for(i=0,a=this.pJc;i<a.length;i++)a[i].bind(t,e,o)},Tt.prototype.unbind=function(t,e){var o,n,r,i,a,s,l=this.sheets,u=this.rv;if(u)for(o=u.length-1;0<=o;o--)(n=u[o]).type!==t&&!this.bJc(n.type,t)||u.splice(o,1);for(H.GC$(this.sv).unbind(t+_,e),r=0,i=l;r<i.length;r++)i[r].unbind(t,e);for(a=0,s=this.pJc;a<s.length;a++)s[a].unbind(t,e)},Tt.prototype.bJc=function(t,e){return 0===e.indexOf(".")&&t.substring(t.length-e.length)===e},Tt.prototype.unbindAll=function(){var t,e,o,n,r=this.sheets;for(this.rv.length=0,H.GC$(this.sv).unbind(_),t=0,e=r;t<e.length;t++)e[t].unbindAll();for(o=0,n=this.pJc;o<n.length;o++)n[o].unbindAll()},Tt.prototype._bind=function(t,e,o){var n,r,i,a,s=this.sheets;for(this.rv.push({type:t,data:e,fn:o}),H.GC$(this.sv).bind(t+O,e,o),n=0,r=s;n<r.length;n++)r[n]._bind(t,e,o);for(i=0,a=this.pJc;i<a.length;i++)a[i]._bind(t,e,o)},Tt.prototype._unbind=function(t,e){var o,n,r,i,a,s,l=this.sheets,u=this.rv;for(o=0;o<u.length;o++)(n=u[o]).type!==t&&!this.bJc(n.type,t)||u.splice(o,1);for(H.GC$(this.sv).unbind(t+O,e),r=0,i=l;r<i.length;r++)i[r]._unbind(t,e);for(a=0,s=this.pJc;a<s.length;a++)s[a]._unbind(t,e)},Tt.prototype.nu=function(){var t,e,o,n,r=this.sheets;for(this.rv.length=0,H.GC$(this.sv).unbind(O),t=0,e=r;t<e.length;t++)e[t].nu();for(o=0,n=this.pJc;o<n.length;o++)n[o].nu()},Tt.prototype.Wq=function(t,e){0===this.jm&&H.GC$(this.sv).trigger(t,e)},Tt.prototype.tw=function(t,e,o,n){this.Wq(B.Events.ButtonClicked,{sheet:t,sheetName:t.name(),row:e,col:o,sheetArea:n})},Tt.prototype.pw=function(t){var e,o,n;for(e=0,o=this.rv;e<o.length;e++)n=o[e],t.bind(n.type,n.data,n.fn)},Tt.prototype.suspendEvent=function(){var t,e,o,n,r=this.sheets;for(this.jm++,t=0,e=r;t<e.length;t++)e[t].suspendEvent();for(o=0,n=this.pJc;o<n.length;o++)n[o].suspendEvent()},Tt.prototype.resumeEvent=function(){var t,e,o,n,r=this.sheets;for(this.jm--,this.jm<0&&(this.jm=0),t=0,e=r;t<e.length;t++)e[t].resumeEvent();for(o=0,n=this.pJc;o<n.length;o++)n[o].resumeEvent()},Tt.prototype.focus=function(t){var e,o;!1===t?B.Vl.Zl(G):(e=dt(this))?e.zt():(o=this.getActiveSheetTab())&&o.zt()},Tt.prototype.Wv=function(){return 2007<this.Vv?15:18},Tt.prototype.Xv=function(){return 2007<this.Vv?22:this.Wv()},Tt.prototype.cec=function(t){var e,o=t?this.vKc:this.wKc,n=t?this.nKc:this.kKc,r=this.options.scrollbarAppearance===V.ScrollbarAppearance.mobile;if(o&&n&&r)switch(e=this.ku,n.iec){case V.ScrollbarState.hide:e.Rdc(t);break;case V.ScrollbarState.show:e.Tdc(o),e.Wdc(t);break;case V.ScrollbarState.active:e.Tdc(o),e.Wdc(t),e.Udc(o);break;case V.ScrollbarState.inactive:e.uKc(o),e.Rdc(t)}},Tt.prototype.xJc=function(){return 2007<this.Vv?28:this.Wv()},Tt.prototype.uw=function(t,e,o,n,r){var i,a;this.vw||(i=H.getHostMaxZIndex(this._host)+1,a=w(P),r?H.GC$(a).addClass("gc-spread-pivot-toolTip"):H.GC$(a).addClass("gc-spread-toolTip"),H.GC$(a).addClass("ui-state-default ui-widget-content btn-default").css({position:"absolute",padding:"0px 3px 0px 3px",font:A("normal normal normal 11pt calibri"),"box-shadow":"1px 2px 5px rgba(0,0,0,0.4)","white-space":"pre-wrap","z-index":i}).width("auto").height("auto").appendTo(I.body),this.vw=a),this.ww(t,e,o,n)},Tt.prototype.ww=function(t,e,o,n){var r,i,a,s,l,u,c=this.WJc();!c||(r=this.vw)&&(i=H.GC$(r),t?(i.html(t),i.show()):i.hide(),a=c.Vs(),n&&(o-=a.top,e-=a.left),l=(s=c.Dr()).x+s.width-i.outerWidth(),u=s.y+s.height-i.outerHeight(),l<0?e=0:u<0?o=0:(o=U(o,u),e=U(e,l)),z(o)||i.css("top",o+a.top),z(e)||i.css("left",e+a.left))},Tt.prototype.xw=function(){var t=this.vw;t&&(H.GC$(t).remove(),this.vw=G)},Tt.prototype.Av=function(){var t,e,o=this.yJc();for(B.mn.wn(),this.invalidateLayout(),t=0,e=o.length;t<e;t++)o[t].Av();ct(),r.Common.FXc(),d&&p.sR(),this.repaint(),Tt.ao(this,"onCultureChanged")},Tt.prototype.getTab=function(){return this.YJc},Tt.prototype.changeSheetIndex=function(t,e){var o,n=this,r=n.getSheetIndex(t),i=n.getTab();return!("number"!=typeof e||-1===r||r===e||e<0||e>=n.sheets.length||e%1!=0||n.GXc(t)||((o=n.getActiveSheet().name())!==t?(n.suspendPaint(),n.setActiveSheet(t),n.UD(r,e),n.setActiveSheet(o),n.resumePaint()):(n.UD(r,e),i.DXc(r,e)),0))},Tt.prototype.GXc=function(t){var e,o;for(e=0,o=this.sheets;e<o.length;e++)if(o[e].name()===t)return!1;return!0},Tt.prototype.UD=function(t,e){var o,n,r=-1,i=this.yJc(),a=i[t];if(e<t){for(o=t;e<o;o--)i[o]=i[o-1];i[e]=a,r=e}else if(t<e-1){for(e+=1,o=t;o<e-1;o++)i[o]=i[o+1];i[e-1]=a,r=e-1}else t===e-1&&(i[t]=i[e],i[e]=a,r=e);this.$Jc(i),r<(n=this.sheets.length)?this.eq=r:this.xKc=r-n},Tt.prototype.clone=function(t,e,o,n){var r,i,a,s,l,u,c=this.vv(o),h=this.getSheetFromName(t);if(z(n)&&(n=!0),!(z(h)||z(o)||this.getSheetFromName(o))){for(this.suspendPaint(),this.suspendCalcService(),r=JSON.stringify(h.toJSON({newWorkSheetName:o})),e<0&&(e=0),this.addSheet(e,c),c.yj().q$a=!0,c.fromJSON(JSON.parse(r)),this.setActiveSheet(c.name()),i=h.tables.l$,a=c.tables.l$,u=0;u<i.length;u++)i[u].wq&&n&&(s=i[u].LZ(),a[u].p$(s)),l=a[u].range(),c.t4&&c.t4(l.row,l.col,l.rowCount,l.colCount,V.SheetArea.viewport);return(s=h.wq.Ou)&&n&&c.wq.bind(s),this.resumeCalcService(),this.resumePaint(),c}},Tt.prototype.FKc=function(t){var e,o,n,r,i=t.command;0!==t.s4&&i.yTa||(o=(e=i.sheetName?B.uJc(this,i.sheetName):B.sJc(this)).getActiveRowIndex(),n=e.getActiveColumnIndex(),r=e.getSelections(),i.xC={GLc:r,HLc:{row:o,col:n}})},Tt.prototype.GKc=function(t){var e,o,n,r,i,a,s,l,u,c,h=t.command,f=h.xC,p=B.sJc(this);if((p&&p.name())!==h.sheetName&&(B.tJc(this,h.sheetName),p=B.sJc(this)),!z(f)){if(p.suspendPaint(),e=f.HLc,o=f.GLc,n=f.ILc,r=f.JLc,z(e)||p.Sr(e.row,e.col),!z(o))if(1===(i=o.length))p.setSelection(o[0].row,o[0].col,o[0].rowCount,o[0].colCount);else for(a=0;a<i;a++)s=o[a].row,l=o[a].col,u=o[a].rowCount,c=o[a].colCount,p.addSelection(s,l,u,c);if(Tt.ao(this,"onCommandExecuting",p),!z(n)){for(a=0;a<n.length;a++)n[a].isSelected&&n[a].isSelected(!0);r||p.EJ()}p.showCell(e.row,e.col,3,3),p.resumePaint()}},Tt.prototype.changeSelectionInCommandExecuting=function(t,e,o,n,r){if(t&&t.xC){var i=t.xC,a=i.HLc;z(a)||(z(e)||(a.row=e),z(o)||(a.col=o)),z(n)||(i.GLc=n),z(r)||(i.ILc=r)}},Tt.prototype.BLc=function(){var t=this.getActiveSheet();t&&t.no(!1),this.eq=-1},Tt.prototype.ALc=function(){var t=this.getActiveSheetTab();t&&t.no(!1),this.xKc=-1},Tt.prototype.yJc=function(){return[].concat(this.sheets).concat(this.pJc)},Tt.prototype.$Jc=function(t){var e,o,n,r,i;for(this.sheets.length=0,this.pJc.length=0,e=this.sheets,o=this.pJc,n=0,r=t;n<r.length;n++)(i=r[n])instanceof f.Worksheet?e.push(i):o.push(i)},Tt.prototype.MJc=function(t){return this.getSheetFromName(t)||this.getSheetTab(t)},Tt.prototype.XJc=function(t){return this.yJc()[t]},Tt.prototype.WJc=function(){return this.getActiveSheet()||this.getActiveSheetTab()},Tt.prototype.ZJc=function(t,e,o,n){var r=this.sheets.length;t<r?this.dq(t,e,o,n):(t-=r,this.hKc(t,e,o,n))},Tt.prototype.fKc=function(){var t=this.eq;return t<0&&(t=this.sheets.length+this.xKc),t},Tt.Qp=ft,Tt.nv=1,Tt.ov=0,pt=Tt,e.Workbook=pt,B.Zn(pt),pt.prototype.nextControl=x("nextControl",G),pt.prototype.previousControl=x("previousControl",G)},"./dist/core/workbook/workbookpanelex.js":function(t,e,o){"use strict";var _,n,r,O,i,p,b,s,F,a,l,c,P,v,L,H,B,V,u,z,W,G,h,U,J,Z,q,K,Y,Q,X,$,tt,et,ot,nt,f,d,g,m,y,C,w,rt,it,x,T,A,S,M,I,N,R;function k(t){t.preventDefault?t.preventDefault():t.returnValue=!1}function E(t,e,o,n,r,i,a,s,l){this.updateStateFn=l;var u=this;u.jec=s,u.JB=!1,u.KB=!1,u.LB=null,u.MB=null,u.NB=300,u.OB=70,u.PB=t,u.Jwa(O.ScrollbarState.show),u.Vo("number"==typeof e?e:0),u._v("number"==typeof o?o:0),u.dw("number"==typeof n?n:0),u.cw("number"==typeof r?r:0),u.bw("number"==typeof i?i:0),u.QB="number"==typeof a?a:1,u.RB=!1,u.SB=0,u.Qb=u.bw(),u.ew()}function D(t,e){this.fB=!0,this.gB=!0,this.hB=18,this.iB=t&&_.GC$(t),this.jB=e&&_.GC$(e),this.ew(!0)}Object.defineProperty(e,"__esModule",{value:!0}),_=o("./dist/core/util/domUtil.js"),n=o("./dist/core/util/common.js"),r=o("@grapecity/js-sheets-common"),O=o("./dist/core/core.enum.js"),i=o("./dist/core/workbook/sheettabbase.js"),p=r.Common.j.Fa,b=n.Ul.Ml,s=n.Ul.nl,F=n.Ul.Nl,a=n.Ul.Pl,l=document,c=window,P=Math.round,v=Math.ceil,L="gc-scroll-arrow",H="gc-scrollbar-wrapper",B="gc-scroll-mobile-track",V="gc-scroll-mobile-thumb",u="gc-scroll-mobile-state-active",z="gc-no-user-select",W="width",G="height",h="gc-scrollbar-stateActive ui-state-active",U="left",J="top",Z="position",q="border",K="padding",Y="margin",Q="overflow",X="display",$="100%",tt="borderWidth",et="boxSizing",ot="absolute",nt="relative",d="mousedown"+(f=".gcScrollbar"),g="mouseup"+f,m="mousemove"+f,y="mouseover"+f,C="mouseout"+f,w="mousewheel",rt="inline-block",it="content-box",x="DOMMouseScroll",T="scroll"+f,(R=A=e.ScrollOrientation||(e.ScrollOrientation={}))[R.horizontalScroll=0]="horizontalScroll",R[R.verticalScroll=1]="verticalScroll",E.prototype.Bv=function(){return this.TB},E.prototype.Jwa=function(t){t===O.ScrollbarState.inactive&&this.JB||(this.iec=t,this.updateStateFn&&this.updateStateFn())},E.prototype.value=function(t){var e;return 0===arguments.length?this.Qb:("number"==typeof t&&t<=this.cw()&&t>=this.bw()&&(e=((this.Qb=t)-this.bw())*this.UB,this.scrollTo(e,!0)),this)},E.prototype.ew=function(){var t,e,o,n,r,i,a,s,l,u,c=this,h=0,f=0,p=!1,d=c.jec===O.ScrollbarAppearance.mobile,g=d?0:2,m="ui-widget ui-corner-all",y=c._v(),b=c.Vo(),v=d?0:y,C=b-2*v,w=v,x=U,T="right",A="gc-scroll-arrowLeft",S="gc-scroll-arrowRight",M="gc-scrollbar-horizontal",I="margin-left",N="ui-button ui-state-default ui-corner-bl btn btn-default",R="ui-icon ui-icon-triangle-1-w",k="gc-scroll-handle ui-button ui-state-default ui-corner-all ui-draggable btn btn-default",E="ui-icon ui-icon-grip-solid-vertical",D="ui-button ui-state-default ui-corner-br btn btn-default",j="ui-icon ui-icon-triangle-1-e";c.VB=C,c.PB||(w=y-2*(C=v=d?0:b),x=J,T="bottom",A="gc-scroll-arrowUp",S="gc-scroll-arrowDown",M="gc-scrollbar-vertical",I="margin-top",N="ui-button ui-state-default ui-corner-tr btn btn-default",R="ui-icon ui-icon-triangle-1-n",k="gc-scroll-handle ui-button ui-state-default ui-corner-all ui-draggable btn btn-default",E="ui-icon ui-icon-grip-solid-horizontal",D="ui-button ui-state-default ui-corner-br btn btn-default",j="ui-icon ui-icon-triangle-1-s",c.VB=w),t=c.VB,e=c.cw()-c.bw(),c.dC=c.dw()*t/(e+c.dw()),c.dC>t&&(c.dC=t),c.dC<10&&(c.dC=10),o=c.dC,c.UB=0==e?1:(t-o)/e,f=c.PB?(h=o,v):(h=v,o),c.WB||(p=!0,c.TB=F("div"),c.WB=_.GC$(c.TB),c.WB.css([Z,U,J,Q,"outline",K,Y],[nt,0,0,"hidden","none",0,0]).addClass("gc-scroll-container gc-scroll-corner-all "+m+" ")),d?c.WB.addClass(B):c.WB.removeClass(B),c.XB||(u=c.WB,c.XB=_.GC$.Nl("div",[Z,X,tt,K,Y,et],[ot,rt,"1px",0,0,it],L+" "+N,u),c.YB=_.GC$.Nl("span",[X,q,K,Y],["block","none",0,0],A+" "+R,c.XB)),c.ZB||(l=c.WB,c.ZB=_.GC$.Nl("div",[Z,X,et,q,K,Y],[ot,rt,it,"none",0,0],H+" "+H,l)),c.$B?c.$B.removeAttr("style"):(s=c.ZB,c.$B=_.GC$.Nl("div",[],[],z+" "+k+" gc-scroll-bar",s),c._B=_.GC$.Nl("span",[X,q,K,Y],["block","none",0,0],M+" "+E,c.$B)),d?c.$B.css(Z,ot).addClass(V):c.$B.css([Z,tt,K,Y,et],[ot,"1px",0,0,it]).removeClass(V),c.aC||(a=c.WB,c.aC=_.GC$.Nl("div",[Z,X,tt,K,Y,et],[ot,rt,"1px",0,0,it],L+" "+D,a),c.bC=_.GC$.Nl("span",[X,q,K,Y],["block","none",0,0],S+" "+j,c.aC)),d?(n=c.WB,r="border",(i=n.get(0))&&(i.style[r]=""),c.PB?(c.WB.css([W,G],[$,$]),c.ZB.css([x,W,G],[v,$,$]),c.$B.css([x,W,G],[c.SB,P(h-g),$])):(c.WB.css([W,G],[$,$]),c.ZB.css([x,W,G],[v,$,$]),c.$B.css([x,W,G],[c.SB,$,P(f-g)])),c._B.remove(),c.XB.remove(),c.aC.remove()):(c.WB.css([W,G,q],[b,y,"none"]),c.ZB.css([x,W,G],[v,C,w]),c.$B.css([x,W,G],[c.SB,P(h-g),P(f-g)]),c.XB.css([x,W,G],[0,v-g,v-g]),c.YB.css([W,G],[$,$]),c.aC.css([T,W,G],[0,v-g,v-g]),c.bC.css([W,G],[$,$]),c._B.css([W,G,I],[v-g,v-g,Math.floor((c.dC-v)/2)]),c.$B.append(c._B),c.WB.append(c.XB),c.WB.append(c.aC)),p&&c.eC()},E.prototype.eC=function(){var n=this;function t(t,e){t.bind(d,function(t){n.fC(t,e)}).bind(g,function(t){n.gC(t,e)}).bind(y,function(t){n.hC(t,e)}).bind(C,function(t){n.iC(t,e)})}t(n.XB,!0),t(n.aC,!1),n.$B.bind(d,function(t){n.jC(t)}).bind(m,function(t){n.kC(t)}).bind(g,function(t){n.lC(t)}).bind(y,function(t){n.mC(t)}).bind(C,function(t){n.nC(t)}),n.ZB.bind(d,function(t){var e,o;b&&b.mozilla&&(e=(new Date).valueOf(),o=n.oC,n.oC=e,o&&e-o<100)||n.pC(t)}).bind(g,function(t){n.qC(t)}),n.GB=function(t){n.sC(t)},n.WB.bind(w,n.GB),n.WB.bind(x,n.GB),E.ao(n,"initEvents",n.TB)},E.prototype.$dc=function(t){this.jec=t},E.prototype.dispose=function(){var t=this;function e(t){t&&t.unbind(f)}e(t.aC),e(t.$B),e(t.XB),e(t.ZB),t.WB&&(t.GB&&(t.WB.unbind(w,t.GB),t.WB.unbind(x,t.GB)),E.ao(t,"dispose",t.TB),t.WB.unbind(f).remove())},E.prototype.tC=function(){var e=this;e.RB||(_.GC$(l).bind(m,function(t){e.kC(t)}).bind(g,function(t){e.lC(t)}),e.RB=!0)},E.prototype.uC=function(){this.RB&&(this.RB=!1,_.GC$(l).unbind(m).unbind(g))},E.prototype.fC=function(t,e){var o,n=0,r=this,i=!0;r.KB=!0,null===r.LB&&(e?(r.XB.addClass(h),n=0-r.qB(),r.vC=O.Nxb.smallDecrement):(r.aC.addClass(h),n=r.qB(),r.vC=1),(o=function(){r.scrollTo(r.SB+n*r.UB,!1),r.LB=c.setTimeout(o,i?r.NB:r.OB),i=!1})(),k(t))},E.prototype.gC=function(t,e){(e?this.XB:this.aC).removeClass(h),this.wC(),k(t)},E.prototype.hC=function(t,e){(e?this.XB:this.aC).addClass("gc-scroll-arrow-hover ui-state-hover"),k(t)},E.prototype.iC=function(t,e){(e?this.XB:this.aC).removeClass("gc-scroll-arrow-hover ui-state-hover "+h),this.wC(),k(t)},E.prototype.jC=function(t){var e,o,n,r,i,a,s=this;0===t.button&&(s.JB=!0,s.xC={x:t.pageX,y:t.pageY},s.Jwa(O.ScrollbarState.show),s.tC(),s.WB.addClass(u),s.$B.addClass(h),e=s.$B.offset(),o=s.$B.outerWidth(!0),n=s.$B.outerHeight(!0),r=s.ZB.offset(),i=s.ZB.outerWidth(!0),a=s.ZB.outerHeight(!0),s.yC={isBeyondEdge:!1,startEdgePosition:{x:r.left+t.pageX-e.left,y:r.top+t.pageY-e.top},endEdgePosition:{x:r.left+i-(o-t.pageX+e.left),y:r.top+a-(n-t.pageY+e.top)}}),k(t)},E.prototype.kC=function(t){this.JB&&(this.Jwa(O.ScrollbarState.active),this.zC={x:t.pageX,y:t.pageY},this.AC(),this.xC=this.zC,_.GC$(l.body).attr("unselectable","on").addClass(z)),k(t)},E.prototype.lC=function(t){var e,o,n,r,i=this;i.JB=!1,i.vC=O.Nxb.thumbPosition,i.yC=null,i.WB.trigger(T,{newValue:i.Qb,oldValue:i.Qb,scrollOrientation:i.PB?A.horizontalScroll:A.verticalScroll,scrollEventType:i.vC}),e=(i.Qb-i.bw())*i.UB,o="left",r=(n=t.target.classList)&&n.contains(V),i.PB||(o="top"),r?i.Jwa(O.ScrollbarState.hide):i.Jwa(O.ScrollbarState.inactive),i.SB=e,i.$B.css(o,P(e)),i.uC(),_.GC$(l.body).removeClass(z),_.GC$(l.body).attr("unselectable")&&_.GC$(l.body).removeAttr("unselectable"),i.$B.removeClass(h),i.WB.removeClass(u),i.vC=6,i.WB.trigger(T,{newValue:i.Qb,oldValue:i.Qb,scrollOrientation:i.PB?A.horizontalScroll:A.verticalScroll,scrollEventType:i.vC}),k(t)},E.prototype.mC=function(t){this.$B.addClass("gc-scrollbar-stateHover ui-state-hover"),k(t)},E.prototype.nC=function(t){this.$B.removeClass("gc-scrollbar-stateHover ui-state-hover"),k(t)},E.prototype.sC=function(t){var e,o,n=this;p(t.wheelDelta)&&p(t.detail)&&(t.wheelDelta=t.originalEvent.wheelDelta,t.detail=t.originalEvent.detail),e=(t.detail?t.detail:t.wheelDelta/-40)/3*n.qB()*n.UB,n.vC=0<=e?1:0,n.scrollTo(n.SB+e,!1),n.vC=6,o={newValue:n.Qb,oldValue:n.Qb,scrollOrientation:n.PB?A.horizontalScroll:A.verticalScroll,scrollEventType:n.vC},n.WB.trigger(T,o),k(t)},E.prototype.pC=function(t){var o,n=this,r=!0,i=t.pageX,a=t.pageY,s=0,l=n.ZB.offset(),u=n.rB();null===n.MB&&(s=n.PB?i-l.left-n.SB:a-l.top-n.SB,(o=function(){var t,e=n.SB;if((t=n.PB?i-l.left-e:a-l.top-e)*s<0||0<=t&&t<n.dC)n.CC();else{if(s<0)n.vC=O.Nxb.largeDecrement,n.scrollTo(e-u*n.UB,!1);else{if(!(0<s))return void n.CC();n.vC=O.Nxb.largeIncrement,n.scrollTo(e+u*n.UB,!1)}n.MB=c.setTimeout(o,r?n.NB:n.OB),r=!1}})(),k(t))},E.prototype.qC=function(t){this.CC(),k(t)},E.prototype.CC=function(){var t;this.MB&&clearTimeout(this.MB),this.MB=null,this.vC=O.Nxb.endScroll,t={newValue:this.Qb,oldValue:this.Qb,scrollOrientation:this.PB?A.horizontalScroll:A.verticalScroll,scrollEventType:this.vC},this.WB.trigger(T,t)},E.prototype.wC=function(){var t,e=this;e.KB&&(e.KB=!1,e.LB&&clearTimeout(e.LB),e.LB=null,e.vC=6,t={newValue:e.Qb,oldValue:e.Qb,scrollOrientation:e.PB?A.horizontalScroll:A.verticalScroll,scrollEventType:e.vC},e.WB.trigger(T,t))},E.prototype.AC=function(){var t,e,o,n,r,i=this,a=i.SB,s=i.zC,l=i.yC;function u(t){return i.PB?t.x:t.y}function c(t,e){i.PB?t.x=e:t.y=e}if(t=u(s),e=u(i.xC),l&&l.isBeyondEdge){if(o=u(l.startEdgePosition),n=u(l.endEdgePosition),t<o||n<t)return;e<o&&c(i.xC,o),n<e&&c(i.xC,n)}(r=a+(t-e))!==a&&(i.vC=5,i.scrollTo(r,!1))},E.prototype.scrollTo=function(t,e){var o,n,r,i,a,s,l,u,c=this,h=J,f=c.VB-c.dC;c.PB&&(h=U),r=n=o=!1,f<t&&(t=f,n=r=!0),t<0&&(o=r=!(t=0)),c.yC&&(c.yC.isBeyondEdge=r),i=c.QB===O.ScrollType.continuous?P(t/c.UB)+c.bw():t/c.UB+c.bw(),a=c.Qb,s=!1,e||(u={newValue:i,oldValue:a,scrollOrientation:c.PB?A.horizontalScroll:A.verticalScroll,scrollEventType:c.vC,isBeyondMaxEdge:n,isBeyondMinEdge:o},c.WB.trigger(T,u),s=u.ignoreUpdatePosition,u.newValue>c.cw()&&(u.newValue=c.cw()),i=u.newValue,l=u.newValueWithOffset),p(l)&&(l=i),c.Qb=i,5!==c.vC&&(t=(l-c.bw())*c.UB),c.SB=t,s||c.$B.css(h,P(t))},E.prototype.hitTest=function(t,e){var o,n,r,i,a=this.$B.outerWidth(),s=this.XB.outerWidth(),l=this.ZB.outerWidth(),u=this.$B.offset(),c=_.GC$(this.Bv()).offset(),h=u.left-c.left-18;return this.PB?t<0+l+s&&0+s<t?t<h+a+s&&h<t?{element:O.Oxb.ThumbButton,x:t,y:e}:{element:O.Oxb.TrackButton}:t<=0+s&&0<t?{element:O.Oxb.LeftButton,x:t,y:e}:{element:O.Oxb.RightButton,x:t,y:e}:(o=this.$B.outerHeight(),n=this.XB.outerHeight(),r=this.ZB.outerHeight(),i=u.top-c.top-18,e<0+r+n&&0+n<e?e<i+o+n&&i<e?{element:O.Oxb.ThumbButton,x:t,y:e}:{element:O.Oxb.TrackButton}:e<=0+n&&0<e?{element:O.Oxb.UpButton,x:t,y:e}:{element:O.Oxb.DownButton,x:t,y:e})},E.prototype.pia=function(){return{x:0,y:0,width:this.Vo(),height:this._v()}},E.prototype.show=function(){this.ZB.show()},E.prototype.hide=function(){this.ZB.hide()},E.prototype.wDc=function(t){var e=this.WB.parent()&&this.WB.parent().parent();return e?t?e.height():e.width():null},S=E,e.hv=S,n.Zn(S),(M=S.prototype).qB=a("smallChange",1),M.rB=a("largeChange",10),M.dw=a("pageValue",10,function(t){t<=0&&this.dw(1)}),M.cw=a("maximum",100,function(t){t<=0&&this.cw(0)}),M.bw=a("minimum",0,function(t){t<=0&&this.bw(0)}),M.Vo=a("width",0),M._v=a("height",0),D.prototype.ew=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d=this;function g(t){return t===ot?_.GC$.Nl("div",[Z,U,J,q,K,Y],[ot,0,0,"none",0,0]):t===nt?_.GC$.Nl("div",[Z,U,J,q,K,Y],[nt,0,0,"none",0,0]):null}function m(t,e){var o,n,r,i=e?d.mB:d.nB;return i||(o=new S(e),n=_.GC$.Nl("div"),e?(d.oB=n,d.mB=o,n.css([Z,U,"bottom",q,K,Y],[ot,0,0,"none",0,0])):(d.pB=n,d.nB=o,n.css([Z,"right",J,q,K,Y],[ot,0,0,"none",0,0])),r=(e?d.mB:d.nB).Bv(),n.append(r),t.append(n),o)}function y(t,e,o,n,r,i){i?(d.oB.css([W,G],[e,n]),t.Vo(e),t._v(n)):(d.pB.css([W,G],[n,e]),t.Vo(n),t._v(e)),t.bw(0),t.cw(r-e),t.dw(e),t.qB(i?d.kB():d.lB()),t.rB(e),t.ew(),_.GC$(t.Bv()).bind(T,function(t,e){o.css(i?U:J,0-e.newValue)}),i?d.oB.show():d.pB.show()}d.iB&&d.jB&&(e=d.hB,o=d.jB.width(),n=d.jB.height(),a=(r=d.iB.width())-e,s=(i=d.iB.height())-e,l=!1,d.uB||(d.uB=g(nt),d.uB.css([Z,Q],[nt,"hidden"]),l=!0),d.uB.css(G,i),p=d.uB,d.sB||(d.sB=g(nt),d.sB.css([Q,X,W],["hidden",rt,$]),p.append(d.sB)),f=d.sB,d.tB||(d.tB=_.GC$.Nl("div",Z,nt,null,f)),t&&d.tB.append(d.jB).css([J,U],[0,0]),b.chrome&&(o=P(o),n=P(n),r=v(r),i=v(i)),c=(u=d.vB(o,n,r,i)).wB,(h=u.xB)?(c||(a+=e),y(m(d.uB,!0),a,d.tB,e,o,!0)):d.oB&&d.oB.hide(),c?(h||(s+=e),y(m(d.uB,!1),s,d.tB,e,n,!1)):d.pB&&d.pB.hide(),h||c||(a+=e,s+=e),d.fB=h,d.gB=c,d.yB=a,d.zB=s,d.sB.css(G,s),l&&(d.iB.append(d.uB),d.AB()))},D.prototype.BB=function(t){var e=this.CB(t),o=e.EB,n=e.FB;!p(o)&&this.mB&&this.lu(o),!p(n)&&this.nB&&this.ju(n)},D.prototype.lu=function(t){var e,o;this.mB.value(t),e=this.yB,o=this.jB.width(),0<=t&&t<=o-e&&this.tB.css(U,0-t)},D.prototype.ju=function(t){var e,o;this.nB.value(t),e=this.zB,o=this.jB.height(),0<=t&&t<=o-e&&this.tB.css(J,0-t)},D.prototype.vB=function(t,e,o,n){var r=o,i=n-this.hB,a={xB:!1,wB:!1};return o<t&&(a.xB=!0,a.wB=i<e),n<e&&(a.wB=!0,a.xB=r<t),a},D.prototype.CB=function(t){var e,o,n,r,i,a,s,l=_.GC$(t),u=this.sB,c=this.tB,h={EB:null,FB:null};return t&&(e=l.offset(),o=c.offset(),n=u.offset(),e.leftWidth=e.left+l.outerWidth(),e.topHeight=e.top+l.outerHeight(),n.leftWidth=n.left+u.outerWidth(),n.topHeight=n.top+u.outerHeight(),r=e.left-o.left,e.left<n.left?h.EB=r:e.leftWidth>n.leftWidth&&(i=e.leftWidth-o.left-u.innerWidth(),h.EB=r<i?r:i),a=e.top-o.top,e.top<n.top?h.FB=a:e.topHeight>n.topHeight&&(s=e.topHeight-o.top-u.innerHeight(),h.FB=a<s?a:s)),h},D.prototype.AB=function(){var e=this;this.tB&&(e.GB=function(t){e.HB(t)},e.tB.bind(w,e.GB),e.tB.bind(x,e.GB))},D.prototype.HB=function(t){var e,o,n,r,i,a;p(t.wheelDelta)&&p(t.detail)&&(t.wheelDelta=t.originalEvent.wheelDelta,t.detail=t.originalEvent.detail),e=t.detail?t.detail:t.wheelDelta/-40,o=this.nB,n=parseInt(this.tB.css(J),10),r=this.zB,(i=this.jB.height())<r&&(i=r),isNaN(n)&&(n=0),0<=(a=n-e*this.lB())&&(a=0),a<0&&i-r<0-a&&(a=0-(i-r)),a!==n&&(this.tB.css(J,a),this.gB&&o.value(0-a)),s(t)},D.prototype.dispose=function(){var t=this;t.uB&&(t.mB&&t.mB.dispose(),t.nB&&t.nB.dispose(),t.tB&&t.GB&&(t.tB.unbind(w,t.GB),t.tB.unbind(x,t.GB)),_.GC$(t.uB).remove())},I=D,(N=(e.IB=I).prototype).kB=a("horizontalSmallChange",10),N.lB=a("verticalSmallChange",10),i.DC.$n("scrollbar",{preProcessMouseMove:function(t){var e=this.OC;(e.nKc.JB||e.kKc.JB)&&(t.r=!0)}})},"./dist/core/worksheet/clipboardhelper.js":function(t,e,o){"use strict";var $,n,C,w,k,tt,h,et,ot,nt,rt;function a(t){return t&&t.options.allowCopyPasteExcelStyle}function p(t,e){var o,n;if(et.msie){for(o=[],n=0;n<t.length;n++)e&&""===t[n].trim()||o.push(t[n]);return o.join("")}return t.join("")}function E(t,e,o,n){var r,i,a=[];for(r=0,i=o;r<i;r++)a[r]=t.getRowHeight(e+r,n);return a}function D(t,e,o,n){var r,i,a=[];for(r=0,i=o;r<i;r++)a[r]=t.getColumnWidth(e+r,n);return a}function it(t,e,o){var n,r=-1;if(o)for(n=r=0;n<e;n++)r+=o[t+n]||0;return r}function at(t,e,o){var n,r=-1;if(o)for(n=r=0;n<e;n++)r+=o[t+n]||0;return r}function st(t){this.PA=rt,this.n5=rt,this.G4=!1,this.tc=t,this.Nl()}Object.defineProperty(e,"__esModule",{value:!0}),$=o("./dist/core/util/common.js"),n=o("@grapecity/js-sheets-common"),C=o("./dist/core/worksheet/stylehelper.js"),w=o("./dist/core/worksheet/style.js"),k=o("./dist/core/core.enum.js"),tt=n.Common.u,h=/<img[^>]+>/g,et=$.Ul.Ml,ot=n.Common.j.Fa,nt=n.Common.k.Bb,rt=null,st.prototype.Nl=function(){var t,e,o,c=this,n=document.createElement("div");n.style.position="fixed",n.style.top="0px",n.style.left="0px",n.style.width="0px",n.style.height="0px",n.style.overflow="hidden",(t=document.createElement("div")).setAttribute("contenteditable","true"),t.setAttribute("gcUIElement","gcSheetClipboard"),t.setAttribute("tabindex","-1"),t.style.position="absolute",t.style.overflow="hidden",t.style.background="white",t.style.webkitUserSelect="text",n.appendChild(t),c.KM=t,(e=document.createElement("textarea")).setAttribute("gcUIElement","gcSheetClipboard"),c.tc&&c.tc.options.enableAccessibility&&e.setAttribute("aria-hidden","true"),e.setAttribute("tabindex","-1"),e.style.position="absolute",e.style.overflow="hidden",e.style.background="white",e.style.webkitUserSelect="text",n.appendChild(e),c.qka=e,(o=c.tc.getHost())&&o.appendChild(n),et.msie||et.edge||(c.H4=function(t){var o,e,n,r,i,a,s,l=$.sJc(c.tc),u=t.clipboardData;if(u)if(o=(o=u.getData("text/html")).replace(h,""),(e=c.I4()).innerHTML=o,n=o?c.EZa(e,!0):st.formatClipboardData(u.getData("text/plain")),e.innerHTML="",n||o&&0<=o.indexOf("<table"))l.J4(n,o);else{for(r=void 0,i=u.items,a=0;a<i.length;a++)if(0===i[a].type.indexOf("image")){r=i[a].getAsFile();break}r&&((s=new FileReader).onload=function(t){var e=new Image;e.src=t.target.result,e.onload=function(){l.J4(n,o,e.src)}},s.readAsDataURL(r))}t.preventDefault()},t.addEventListener("paste",c.H4),c.rka=function(t){var e,o,n,r=$.sJc(c.tc),i=t.clipboardData;i&&((e=st.formatClipboardData(i.getData("text/plain")))||(o=i.getData("text/html"))&&((n=c.I4()).innerHTML=o,e=c.EZa(n,!1),n.innerHTML=""),r.J4(e,"")),t.preventDefault()},e.addEventListener("paste",c.rka))},st.prototype.no=function(){var t,e,o,n,r,i,a=this,s=a.KM;s&&(et.msie||et.edge||(s.removeEventListener("paste",a.H4),a.qka.removeEventListener("paste",a.rka)),!(t=s.parentElement)||(e=t.parentElement)&&e.removeChild(t),a.KM=rt,a.qka=rt),(o=a.K4)&&((n=o.parentElement)&&n.removeChild(o),a.K4=rt),(r=a.FZa)&&((i=r.parentElement)&&i.removeChild(r),a.FZa=rt),a.tc=rt},st.prototype.ska=function(t){a(this.tc)?this.KM.innerHTML=t:this.qka.value=t},st.prototype.M4=function(){a(this.tc)?this.KM.focus():this.qka.focus()},st.prototype.N4=function(){a(this.tc)?document.execCommand("selectAll"):this.qka.select()},st.prototype.wx=function(){var t,e,o,n="",r="",i="";return r=a(this.tc)?((t=this.KM)&&(0<(e=t.getElementsByTagName("table")).length?n=e[0].outerHTML:0<(o=t.getElementsByTagName("img")).length&&(i=o[0].src)),this.EZa(this.KM,!0)):st.formatClipboardData(this.qka.value),{html:n,text:r,image:i}},st.Q4=function(t,e,o,n,r,i,a,s,l,u,c,h,f,p){var d,g,m,y,b,v,C,w,x,T,A,S=t.Tq($.kf(o,r,n,i),a),M=RegExp(String.fromCharCode(32),"g"),I="&nbsp;",N=!1,R=!1;return a===k.SheetArea.viewport&&(o<0&&2==(2&e)&&(N=!0),r<0&&1==(1&e)&&(R=!0)),o=S.row,r=S.col,n=S.rowCount,i=S.colCount,d=c?t.options.gridline:rt,g=c?{color:"#d4d4d4",showHorizontalGridline:!0,showVerticalGridline:!0}:rt,m=f?E(t,o,n,a):rt,y=f?D(t,r,i,a):rt,a===k.SheetArea.viewport?(v=b=void 0,w=C=rt,x=st.Ema(t,o,n,r,i,3,l,u,s,S,M,I,d,h,m,y,p),R&&(b=f?D(t,r,i,2):rt,T=t.getColumnCount(2),C=st.Ema(t,o,n,0,T,2,l,[],s,S,M,I,g,h,m,b,p)),N&&(v=f?E(t,o,n,1):rt,A=t.getRowCount(1),w=st.Ema(t,0,A,r,i,1,[],u,s,S,M,I,g,h,v,y,p)),st.yb(x,C,w,p)):a===k.SheetArea.rowHeader?(C=st.Ema(t,o,n,r,i,2,l,u,s,S,M,I,g,h,m,y,p),st.yb(C,rt,rt,p)):a===k.SheetArea.colHeader?(w=st.Ema(t,o,n,r,i,1,l,u,s,S,M,I,g,h,m,y,p),st.yb(w,rt,rt,p)):void 0},st.yb=function(t,e,o,n){function r(t,e){var o,n=[],r=t.length;for(o=0;o<r;o++)n.push(t[o].concat(e[o]));return n}var i,a=t,s=0;return e&&(s=e[0].length,a=r(e,t)),o&&(i=o.length,s&&(o=r(st.Ema(rt,0,i,0,s,rt,[],[],!1,rt,rt,rt,rt,!1,[],[],n),o)),a=o.concat(a)),st.Fma(a,n)},st.Fma=function(t,e){var o,n,r="",i=t.length;for(r+=e?'<table style="border-collapse: collapse">':"<table>",o=0;o<i;o++){for(r+="<tr>",n=0;n<t[o].length;n++)r+=t[o][n];r+="</tr>"}return r+"</table>"},st.Ema=function(t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m){var y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J,Z,q,K,Y,Q,X;for(f&&(y=f.color,b=f.showHorizontalGridline,v=f.showVerticalGridline),C=[],w=0;w<o;w++)if(!nt(a,x=e+w)){for(T=[],A=0;A<r;A++)nt(s,S=n+A)||(M="",N=I=void 0,k=R=1,l&&t&&((I=t.getSpan(x,S,i))&&st.isPartSpan(I,u,a,s)&&(I=rt),I&&(I.row!==x||I.col!==S))||(M+="<td",E=t&&t.getValue(x,S,i),l&&t&&(I&&(1<(R=I.rowCount)&&(M+=" rowSpan="+R),1<(k=I.colCount)&&(M+=" colSpan="+k)),N=t.getActualStyle(x,S,i),D=st.convertVAlign,j=st.convertHAlign,_=st.convertLineBorder,M+=m?' style="padding: 0; word-break: break-all; ':' style="',O=b,F=v,(P=N.backColor)&&(M+="background-color: "+P+";",F=O=!1),(L=N.foreColor)&&(M+="color: "+L+";"),(H=N.font)&&(p&&(H=H+", "+$.FallbackFontFamily),M+="font: "+H.replace(/"/g,"'")+";"),B=N.vAlign,ot(B)||(M+="vertical-align: "+D(B)+";"),V=N.hAlign,ot(V)||(m&&(V=$.Ul.ol(V,E)),(z=j(V))&&(M+="text-align: "+z+";")),(W=N.borderLeft)&&(M+="border-left: "+_(W)+";",F=!1),(G=N.borderRight)&&(M+="border-right: "+_(G)+";",F=!1),(U=N.borderTop)&&(M+="border-top: "+_(U)+";",O=!1),(J=N.borderBottom)&&(M+="border-bottom: "+_(J)+";",O=!1),O&&F?M+="border: 1px solid "+y+";":O?(M+="border-top: 1px solid "+y+";",M+="border-bottom: 1px solid "+y+";"):F&&(M+="border-left: 1px solid "+y+";",M+="border-right: 1px solid "+y+";"),M+='"'),M+=">",q=Z=void 0,l&&t&&((Z=2==(2&(K=N.textDecoration)))&&(M+="<s>"),(q=(q=1==(1&K))||8==(8&K))&&(M+="<u>")),(Y=t?t.getText(x,S,i):"")?(" "!==Y[0]&&" "!==Y[Y.length-1]||"number"!=typeof E||(Y=Y.trim()),Y=tt.Ob(Y).replace(c,h)):et.chrome?Y=" ":et.safari&&(Y="&nbsp;"),0<(Q=it(w,R,d))&&--Q,0<(X=at(A,k,g))&&--X,M+=0<=Q&&0<=X?'<div style="overflow: hidden; height: '+Q+"px; width: "+X+'px;">'+Y+"</div>":Y,l&&(q&&(M+="</u>"),Z&&(M+="</s>")),M+="</td>",T.push(M)));C.push(T)}return C},st.prototype.I4=function(){var t,e;return this.K4||((t=document.createElement("div")).style.display="none",(e=this.tc.getHost())&&e.appendChild(t),this.K4=t),this.K4},st.prototype.GZa=function(){var t,e;return this.FZa||((t=document.createElement("div")).style.display="none",(e=this.tc.getHost())&&e.appendChild(t),this.FZa=t),this.FZa},st.prototype.R4=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m=this.I4();if(m.innerHTML=t,r=m.getElementsByTagName("table"),i=e.KLc(),0<r.length)for(a=this.HZa(r[0],!0),l=o+(s=0);s<a.length;s++,l++){if(u=a[s],i)for(;0===e.getRowHeight(l);)l++;for(h=n+(c=0);c<u.length;c++,h++)if(f=u[c]){if(i)for(;0===e.getColumnWidth(h);)h++;e.Pq(l,h,f.style),p=f.rowSpan,d=f.colSpan,(1<p||1<d)&&((g=e.getSpan(l,h))?(g.row=l,g.col=h,g.rowCount=p,g.colCount=d):e.addSpan(l,h,p,d))}}m.innerHTML=""},st.prototype.lgc=function(t,e,o,n){var r,i,a=e.pictures;a&&(r=function(t){for(var e=1,o="picture"+e;t.get(o);)o="picture"+ ++e;return o}(a),(i=a.add(r,t,0,0)).startRow(o),i.startColumn(n))},st.prototype.HZa=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p=this.GZa(),d=[],g=/ +/g;for(o=0;o<t.rows.length;o++)for(n=t.rows[o],d[o]||(d[o]=[]),r=d[o],a=i=0;i<n.cells.length;i++){for(s=n.cells[i];r[a];)a++;for(l=r[a]={},u=void 0,e&&(u=st.getStyleFromDOM(s),l.style=u),p.innerHTML=s.innerHTML.replace(g," "),l.text=p.innerText,l.rowSpan=s.rowSpan,(c=s.getAttribute("style"))&&0<=c.indexOf("mso-ignore:colspan;")?l.colSpan=1:l.colSpan=s.colSpan,h=0;h<s.rowSpan;h++)for(f=0;f<s.colSpan;f++)0===h&&0===f||(d[o+h]||(d[o+h]=[]),d[o+h][a+f]={style:u,text:"",rowSpan:1,colSpan:1});a+=s.colSpan}return p.innerHTML="",d},st.prototype.EZa=function(t,e){var o,n,r,i,a,s,l,u,c,h,f=[];if(t)if(0<(o=t.getElementsByTagName("table")).length)for(n=this.HZa(o[0],!1),r=RegExp(String.fromCharCode(160),"g"),i=String.fromCharCode(32),a=0,s=n.length;a<s;a++){for(u=0,c=(l=n[a]).length;u<c;u++)0<=(h=l[u]?l[u].text:"").indexOf("\n")&&(h=e?(0<=h.indexOf("\r\n")&&(h=p(h.split("\r\n"),!0)),p(h.split("\n"),!0)):'"'+h+'"'),f.push(h.replace(r,i)),u<c-1&&f.push("\t");a<s-1&&f.push("\r\n")}else f.push(function(t){var e,o,n;if(!t)return t;for(e=0;e<t.length&&!((o=t.indexOf("\x3c!--",e))<0)&&(e=o,!((n=t.indexOf("--\x3e",e))<0));)e=n,t=t.substring(0,o)+t.substring(n+3);return t}(t.innerText).trim());return f.join("")},st.prototype.hZ=function(t){this.PA=rt,this.n5=rt,this.G4=!1,this.tc.Wq("ClipboardStatusChanged",{isReset:!0,isSystemPasted:!!t})},st.isPartSpan=function(t,e,o,n){var r,i,a,s,l,u;if(!e.containsRange(t))return!0;for(r=0,i=o;r<i.length;r++)if(a=i[r],t.row<=a&&a<t.row+t.rowCount)return!0;for(s=0,l=n;s<l.length;s++)if(u=l[s],t.col<=u&&u<t.col+t.colCount)return!0;return!1},st.formatClipboardData=function(t){var e,o,n,r,i=[];if(t){for(e=!1,o=0;o<t.length;o++)n=0<o?t[o-1]:"",'"'===(r=t[o])?(e=!e,i.push('"')):e||"\n"!==r||"\r"===n?i.push(r):i.push("\r\n");return i.join("")}return""},st.convertHAlign=function(t){return{0:"left",1:"center",2:"right"}[t]},st.convertVAlign=function(t){return{0:"top",1:"middle",2:"bottom"}[t]},st.convertLineBorder=function(t){return{9:.5,1:.5,3:.5,4:.5,7:.5,11:.5,2:1,10:1,12:1,8:1,13:1,5:1.5,6:1.5}[t.style]+"pt "+{0:"none",1:"solid",2:"solid",3:"dashed",4:"dotted",5:"solid",6:"double",7:"dotted",8:"dashed",9:"dashed",10:"dashed",11:"dashed",12:"dashed",13:"dashed"}[t.style]+" "+t.color},st.convertToHAlign=function(t){return{left:0,center:1,right:2}[t]},st.convertToVAlign=function(t){return{top:0,middle:1,bottom:2}[t]},st.convertToLineBorder=function(t,e,o){var n={none:0,solid:1,dashed:3,dotted:4,double:6};return(et.msie||et.edge)&&"2px"===o?n.solid=5:(o=Math.round(10*parseFloat(o)*3/4)/10)<=.8?n.solid=1:o<=1?(n.solid=2,n.dashed=8):o<=1.5&&(n.solid=5),new w.LineBorder(t,n[e])},st.convertToTextDecoration=function(t){return{underline:1,"line-through":2,none:0}[t]},st.isTransparent=function(t){return 0===n.Common.pc.ec(t).a},st.isBlack=function(t){var e=n.Common.pc.ec(t);return 0!==e.a&&0===e.r&&0===e.g&&0===e.b},st.getStyleFromDOM=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g=t.getElementsByTagName("font")[0],m=getComputedStyle(t),y=t.style,b=new w.Style,v=m.backgroundColor;return v&&!st.isTransparent(v)&&(b.backColor=v),e=m.color,g&&(e=g.color),e&&!st.isBlack(e)&&(b.foreColor=e),g?b.font=C.To.F4(getComputedStyle(g)):(o=C.To.F4(m))&&(b.font=o),n=m.verticalAlign,r=st.convertToVAlign,i=st.convertToHAlign,a=st.convertToLineBorder,s=st.convertToTextDecoration,n&&(b.vAlign=r(n)),l=y.textAlign,u=m.textAlign,et.msie||et.edge?b.hAlign=i(""!==l?l:"general"):u&&(b.hAlign=i(u)),"none"!==(c=m.borderLeftStyle)&&(b.borderLeft=a(m.borderLeftColor,c,m.borderLeftWidth)),"none"!==(h=m.borderRightStyle)&&(b.borderRight=a(m.borderRightColor,h,m.borderRightWidth)),"none"!==(f=m.borderTopStyle)&&(b.borderTop=a(m.borderTopColor,f,m.borderTopWidth)),"none"!==(p=m.borderBottomStyle)&&(b.borderBottom=a(m.borderBottomColor,p,m.borderBottomWidth)),d=s(m.textDecorationLine||m.textDecoration),0<t.getElementsByTagName("u").length&&(d|=s("underline")),0<t.getElementsByTagName("s").length&&(d|=s("line-through")),0!==d&&(b.textDecoration=d),b},e.S4=st},"./dist/core/worksheet/style.js":function(t,e,o){"use strict";var l,c,u,h,f,p,n,r,s,m,y,a,d,g,b,i,v,C,w,x,T;function A(t){var e,o,n;return e={},t&&t.option&&t.option.dataSource?(o=t.option.dataSource,t.option.dataSource=y,e=m(t),o.fetchRows&&!o.LLc&&(n=o).fetchRows().then(function(t){n.LLc=t}),e.option.dataSource=o,t.option.dataSource=o):e=m(t),e}function S(t,e,o){this.color=t||"black",this.style=e||0,this.level=o}function M(t){return t?new v(t.color,t.style&&i[t.style]||y):y}function I(t){return t?t.map(function(t){return{type:t.type&&p.DropDownType[t.type]||y,option:(e=t.option,l=c.GC$.extend(!0,{},e),(u=e.calendarPage)&&(l.calendarPage=p.CalendarPage[u]),(o=e.startDay)&&(l.startDay=p.CalendarStartDay[o]),(n=e.layout)&&((r=n.direction)&&(l.layout.direction=p.LayoutDirection[r]),(i=n.displayAs)&&(l.layout.displayAs=p.LayoutDisplayAs[i])),(a=e.valueType)&&(l.valueType=p.DropdownListValue[a]),(s=e.direction)&&(l.direction=p.LayoutDirection[s]),l),submitCommand:t.submitCommand};var e,o,n,r,i,a,s,l,u}):y}function N(){var t,e,o,n,r=[];for(t=0;t<arguments.length;t++)r[t]=arguments[t];if(this._id=N.Wo,N.Wo++,0!==r.length)if(e=r[0],1!==r.length||(!(n=e)||"object"!=typeof n||n.patternColor||n.stops))for(o=0;o<C.length;o++)this[C[o]]=r[o];else this.lJc(e)}function R(t,e,o,n){var r,i,a,s=e;if(o&&e){if(e.gQa&&e.gQa())return void(t.cellType=s);e.toJSON&&(e=e.toJSON()),r=f._o,i=e.typeName,(a=r[e.type]||r[i]||u.getTypeFromString(i))?(s=new a).fromJSON(e,n):s=y}t.cellType=s}function k(t,e,o){var n,r,i,a,s=e;o&&e&&"object"==typeof e&&(e.toJSON&&(e=e.toJSON()),(r=(n=l.Formatter)&&n.GeneralFormatter)&&((i=e.typeName)?(a=u.getTypeFromString(i))&&(s=new a).fromJSON(e):s=new r(e.formatCached,e.customerCultureName))),t.formatter=s}function E(t,e,o){var n,r,i=e;o&&e&&(e.toJSON&&(e=e.toJSON()),(r=(n=l.Formatter)&&n.GeneralFormatter)&&((i=new r(e.formatCached,e.customerCultureName)).isAuto=!0)),t._autoFormatter=i}function D(t,e,o){e&&((e=t.getColor(e))&&o(e))}function j(t,e,o){return"hAlign"===t?2===o||1===o?1===e:3===e:"vAlign"===t?2===o||1===o?1===e:0===e:"imeMode"===t?1===e:t===a&&e===y}Object.defineProperty(e,"__esModule",{value:!0}),l=o("@grapecity/js-sheets-common"),c=o("./dist/core/util/domUtil.js"),u=o("./dist/core/util/common.js"),h=o("./dist/core/worksheet/stylehelper.js"),f=o("./dist/core/celltype/celltype.ns.js"),p=o("./dist/core/core.enum.js"),n=c.GC$.each,r=u.Ul,s=r.Ol,m=l.Common.j.C4,y=void 0,Math.sin,Math.cos,Math.abs,Math.max,a="autoFormatter",d="labelOptions",g="cellButtons",b={borderLeft:!0,borderRight:!0,borderTop:!0,borderBottom:!0,diagonalDown:!0,diagonalUp:!0},(T=i=e.LineStyle||(e.LineStyle={}))[T.empty=0]="empty",T[T.thin=1]="thin",T[T.medium=2]="medium",T[T.dashed=3]="dashed",T[T.dotted=4]="dotted",T[T.thick=5]="thick",T[T.double=6]="double",T[T.hair=7]="hair",T[T.mediumDashed=8]="mediumDashed",T[T.dashDot=9]="dashDot",T[T.mediumDashDot=10]="mediumDashDot",T[T.dashDotDot=11]="dashDotDot",T[T.mediumDashDotDot=12]="mediumDashDotDot",T[T.slantedDashDot=13]="slantedDashDot",(x=e.LineBorderComposeLevel||(e.LineBorderComposeLevel={}))[x.conditionalFormat=1]="conditionalFormat",x[x.cell=10]="cell",x[x.table=20]="table",x[x.row=30]="row",x[x.column=40]="column",x[x.sheet=50]="sheet",S.prototype.Uo=function(){return new S(this.color,this.style,this.level)},S.prototype.toJSON=function(){var t={},e=this.color,o=this.style;return"black"!==e&&(t.color=e),0!==o&&(t.style=o),t},S.prototype.fromJSON=function(t,e){if(t){var o=t.color,n=t.style;s(o)&&(this.color=o),s(n)&&(this.style=n)}},S.Vo=function(t){return{9:1,1:1,3:1,4:1,7:1,11:1,2:2,10:2,12:2,8:2,13:2,5:3,6:3}[t&&t.style]||0},v=S,e.LineBorder=v,C=["backColor","foreColor","hAlign","vAlign","font","themeFont","formatter","borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","_showTip","shrinkToFit","backgroundImage","cellType","backgroundImageLayout","tabStop","textDecoration","imeMode","name","parentName","watermark","cellPadding",d,"quotePrefix","diagonalDown","diagonalUp","isVerticalText",g,"dropDowns","textOrientation"],N.kxb=function(t,e){var o=t.parentName;o&&!e.getNamedStyle(o)&&delete t.parentName},N.prototype.Yo=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p=this,d=t.labelOptions,g=t.cellButtons;if(t.cellButtons&&0<t.cellButtons.length)for(g=[],c=0;c<t.cellButtons.length;c++)g.push(m(t.cellButtons[c]));if(h=t.dropDowns,t.dropDowns&&0<t.dropDowns.length)for(h=[],c=0;c<t.dropDowns.length;c++)h.push(A(t.dropDowns[c]));e?(p._autoFormatter=t._autoFormatter,p.backgroundImage=t.backgroundImage,p.backgroundImageLayout=t.backgroundImageLayout,p.backColor=t.backColor,p.foreColor=t.foreColor,p.hAlign=t.hAlign,p.vAlign=t.vAlign,p.font=t.font,p.themeFont=t.themeFont,p.formatter=t.formatter,p.showEllipsis=t.showEllipsis,p.THb=t.THb,r=t.borderLeft,p.borderLeft=r&&r.Uo()||r,p.borderLeft&&o&&(p.borderLeft.level=o),i=t.borderTop,p.borderTop=i&&i.Uo()||i,p.borderTop&&o&&(p.borderTop.level=o),a=t.borderRight,p.borderRight=a&&a.Uo()||a,p.borderRight&&o&&(p.borderRight.level=o),s=t.borderBottom,p.borderBottom=s&&s.Uo()||s,p.borderBottom&&o&&(p.borderBottom.level=o),l=t.diagonalDown,p.diagonalDown=l&&l.Uo()||l,p.diagonalDown&&o&&(p.diagonalDown.level=o),u=t.diagonalUp,p.diagonalUp=u&&u.Uo()||u,p.diagonalUp&&o&&(p.diagonalUp.level=o),p.locked=t.locked,p.textIndent=t.textIndent,p.wordWrap=t.wordWrap,p.shrinkToFit=t.shrinkToFit,p.cellType=t.cellType,p.name=t.name,p.parentName=t.parentName,p.tabStop=t.tabStop,p.textDecoration=t.textDecoration,p.imeMode=t.imeMode,p.watermark=t.watermark,p.cellPadding=t.cellPadding,p.isVerticalText=t.isVerticalText,p.textOrientation=t.textOrientation,d&&(p.labelOptions={alignment:d.alignment,font:d.font,foreColor:d.foreColor,visibility:d.visibility,margin:d.margin}),p.quotePrefix=t.quotePrefix,p.cellButtons=g,p.dropDowns=h):(p.backgroundImage===y&&(p.backgroundImage=t.backgroundImage),p.backgroundImageLayout===y&&(p.backgroundImageLayout=t.backgroundImageLayout),p.backColor===y&&(p.backColor=t.backColor),p.foreColor===y&&(p.foreColor=t.foreColor),p.hAlign===y&&(p.hAlign=t.hAlign),p.vAlign===y&&(p.vAlign=t.vAlign),p.themeFont===y&&p.font===y?(p.themeFont=t.themeFont,p.font=t.font):p.themeFont!==y&&p.font===y&&(p.font=t.font),p.formatter===y&&(p.formatter=t.formatter),p.showEllipsis===y&&(p.showEllipsis=t.showEllipsis),p.THb===y&&(p.THb=t.THb),p._autoFormatter===y&&(p._autoFormatter=t._autoFormatter),p.borderLeft===y&&(r=t.borderLeft,p.borderLeft=r&&r.Uo()||r,p.borderLeft&&o&&(p.borderLeft.level=o)),p.borderTop===y&&(i=t.borderTop,p.borderTop=i&&i.Uo()||i,p.borderTop&&o&&(p.borderTop.level=o)),p.borderRight===y&&(a=t.borderRight,p.borderRight=a&&a.Uo()||a,p.borderRight&&o&&(p.borderRight.level=o)),p.borderBottom===y&&(s=t.borderBottom,p.borderBottom=s&&s.Uo()||s,p.borderBottom&&o&&(p.borderBottom.level=o)),p.diagonalDown===y&&(l=t.diagonalDown,p.diagonalDown=l&&l.Uo()||l,p.diagonalDown&&o&&(p.diagonalDown.level=o)),p.diagonalUp===y&&(u=t.diagonalUp,p.diagonalUp=u&&u.Uo()||u,p.diagonalUp&&o&&(p.diagonalUp.level=o)),p.locked===y&&(p.locked=t.locked),p.textIndent===y&&(p.textIndent=t.textIndent),p.wordWrap===y&&(p.wordWrap=t.wordWrap),p.shrinkToFit===y&&(p.shrinkToFit=t.shrinkToFit),p.cellType===y&&(p.cellType=t.cellType),p.tabStop===y&&(p.tabStop=t.tabStop),p.textDecoration===y&&(p.textDecoration=t.textDecoration),p.imeMode===y&&(p.imeMode=t.imeMode),p.name===y&&(p.name=t.name),p.parentName===y&&(p.parentName=t.parentName),p.watermark===y&&(p.watermark=t.watermark),p.cellPadding===y&&(p.cellPadding=t.cellPadding),!p.labelOptions&&d&&(p.labelOptions={}),(f=p.labelOptions)&&d&&(f.alignment===y&&(f.alignment=d.alignment),f.font===y&&(f.font=d.font),f.foreColor===y&&(f.foreColor=d.foreColor),f.visibility===y&&(f.visibility=d.visibility),f.margin===y&&(f.margin=d.margin)),n||p.quotePrefix!==y||(p.quotePrefix=t.quotePrefix),p.isVerticalText===y&&(p.isVerticalText=t.isVerticalText),p.textOrientation===y&&(p.textOrientation=t.textOrientation),p.cellButtons===y&&(p.cellButtons=g),p.dropDowns===y&&(p.dropDowns=h))},N.prototype.$b=function(t){var o=this;0===arguments.length?n(C,function(t,e){o[e]=y}):o[t]=y},N.prototype.clone=function(t){var e=this,o=e.borderLeft,n=e.borderTop,r=e.borderRight,i=e.borderBottom,a=e.diagonalDown,s=e.diagonalUp,l=new N;return l.backColor=e.backColor,l.foreColor=e.foreColor,l.hAlign=e.hAlign,l.vAlign=e.vAlign,l.font=e.font,l.themeFont=e.themeFont,l.formatter=y,l.borderLeft=o&&!t&&o.Uo()||o,l.borderTop=n&&!t&&n.Uo()||n,l.borderRight=r&&!t&&r.Uo()||r,l.borderBottom=i&&!t&&i.Uo()||i,l.locked=e.locked,l.textIndent=e.textIndent,l.wordWrap=e.wordWrap,l.shrinkToFit=e.shrinkToFit,l.backgroundImage=e.backgroundImage,l.cellType=y,l.backgroundImageLayout=e.backgroundImageLayout,l.tabStop=e.tabStop,l.textDecoration=e.textDecoration,l.imeMode=e.imeMode,l.name=e.name,l.parentName=e.parentName,l.watermark=e.watermark,l.cellPadding=e.cellPadding,l.labelOptions=e.labelOptions,l.quotePrefix=e.quotePrefix,l.diagonalDown=a&&!t&&a.Uo()||a,l.diagonalUp=s&&!t&&s.Uo()||s,l.isVerticalText=e.isVerticalText,l.showEllipsis=e.showEllipsis,l.THb=e.THb,l.textOrientation=e.textOrientation,k(l,e.formatter,!t),E(l,e._autoFormatter,!t),R(l,e.cellType,!t,!0),function(t,e,o){var n,r;if(null===e&&(t.cellButtons=e),e){if(n=e,o)for(n=[],r=0;r<e.length;r++)n.push(m(e[r]));t.cellButtons=n}}(l,e.cellButtons,!t),function(t,e,o){var n,r;if(null===e&&(t.dropDowns=e),e){if(n=e.slice(),o)for(n=[],r=0;r<e.length;r++)n.push(m(e[r]));t.dropDowns=n}}(l,e.dropDowns,!t),l},N.prototype.Zo=function(n){var o,t,e,r,i,a,s,l,u=this;if(n&&n.getColor){if(D(n,u.foreColor,function(t){u.foreColor=t}),"string"==typeof(o=u.backColor))D(n,o,function(t){u.backColor=t});else if(o&&(o.backgroundColor&&D(n,o.backgroundColor,function(t){o.backgroundColor=t}),o.patternColor&&D(n,o.patternColor,function(t){o.patternColor=t}),o.stops))for(t=function(e){D(n,o.stops[e].color,function(t){o.stops[e].color=t})},e=0;e<o.stops.length;e++)t(e);for(i=function(t,e){var o=r[t];o&&o.color&&D(n,o.color,function(t){o.color=t})},e=0,a=(r=[u.borderLeft,u.borderTop,u.borderRight,u.borderBottom,u.diagonalDown,u.diagonalUp]).length;e<a;e++)i(e)}return s=u.themeFont,l=u.font,n&&n.getFont&&(s?u.font=h.To.Io(l,n.getFont(s)):l||(u.font=h.To.Io(l,n.bodyFont()))),u},N.prototype.$o=function(t){var e,o=this._autoFormatter;o&&null!==t&&((e=o.getPreferredEditingFormatter(t)).isAuto=!0,this._autoFormatter=e)},N.prototype.toJSON=function(t,e){var o,n,r={},i=this._autoFormatter;for(!s(i)||e&&j(a,i,t)||(i.toJSON&&(i=i.toJSON()),c.GC$.isEmptyObject(i)||(r[a]=i)),o=0;o<C.length;o++)i=this[n=C[o]],n!==d||c.GC$.isEmptyObject(i)?"dropDowns"!==n&&n!==g||c.GC$.isEmptyObject(i)?!s(i)||e&&j(n,i,t)||(r[n]=i&&i.toJSON?i.toJSON():i):r[n]=i:r[d]=i;return c.GC$.isEmptyObject(r)?y:r},N.prototype.fromJSON=function(t,e,o){var n,r,i,a;if(t)for(n in t)if(t.hasOwnProperty(n)){if(r=t[n],!s(r))continue;(i={p:n,v:r,r:!1}).noSchema=e,i.context=o,N.ao(this,"fromJson",i),i.r||("formatter"===n?k(this,r,!0):"autoFormatter"===n?E(this,r,!0):"cellType"===n?R(this,r,!0,e):b[n]?null===r?this[n]=null:((a=new v).fromJSON(r,e),this[n]=a):this[n]=r)}},N.prototype.lJc=function(t){var e,o,n,r,i,a,s,l=this;l.backColor=(s=t.backColor)&&s.type?{type:s.type&&p.PatternType[s.type]||y,patternColor:s.patternColor,backgroundColor:s.backgroundColor}:s,l.foreColor=t.foreColor,l.hAlign=t.hAlign&&p.HorizontalAlign[t.hAlign]||y,l.vAlign=t.vAlign&&p.VerticalAlign[t.vAlign]||y,l.font=t.font,l.themeFont=t.themeFont,l.formatter=t.formatter,l.borderLeft=M(t.borderLeft),l.borderTop=M(t.borderTop),l.borderRight=M(t.borderRight),l.borderBottom=M(t.borderBottom),l.diagonalDown=M(t.diagonalDown),l.diagonalUp=M(t.diagonalUp),l.locked=t.locked,l.textIndent=t.textIndent,l.wordWrap=t.wordWrap,l.shrinkToFit=t.shrinkToFit,l.backgroundImage=t.backgroundImage,l.cellType=(n=t.cellType)&&(r={checkbox:"5",combobox:"7",hyperlink:"8",radioButtonList:"11",checkboxList:"12"}[n.type])&&(i=f._o[r])?((a=new i).lJc(n),a):y,l.backgroundImageLayout=t.backgroundImageLayout&&p.ImageLayout[t.backgroundImageLayout]||y,l.tabStop=t.tabStop,l.textDecoration=t.textDecoration&&p.TextDecorationType[t.textDecoration]||y,l.imeMode=t.imeMode&&p.ImeMode[t.imeMode]||y,l.name=t.name,l.parentName=t.parentName,l.watermark=t.watermark,l.cellPadding=t.cellPadding,l.labelOptions=(o=t.labelOptions)?{alignment:o.alignment&&p.LabelAlignment[o.alignment]||y,visibility:o.visibility&&p.LabelVisibility[o.visibility]||y,font:o.font,foreColor:o.foreColor,margin:o.margin}:y,l.isVerticalText=t.isVerticalText,l.textOrientation=t.textOrientation,l.showEllipsis=t.showEllipsis,l.cellButtons=(e=t.cellButtons)?e.map(function(t){return{position:t.position&&p.ButtonPosition[t.position]||y,useButtonStyle:t.useButtonStyle,enabled:t.enabled,width:t.width,caption:t.caption,imageSrc:t.imageSrc,imageSize:t.imageSize,captionAlign:t.captionAlign&&p.CaptionAlignment[t.captionAlign]||y,command:t.command,imageType:t.imageType&&p.ButtonImageType[t.imageType]||y,visibility:t.visibility&&p.ButtonVisibility[t.visibility]||y,hoverBackColor:t.hoverBackColor,buttonBackColor:t.buttonBackColor}}):y,l.dropDowns=I(t.dropDowns)},w=N,e.Style=w,u.Zn(w),w.Wo=0},"./dist/core/worksheet/stylehelper.js":function(t,s,e){"use strict";var l,u,f,p,o,g,m,y,b,v,C,w,x,T;function n(t){return t=p(t=t||0,0),o(t,1)}function d(){}Object.defineProperty(s,"__esModule",{value:!0}),l=e("./dist/core/util/domUtil.js"),u=e("./dist/core/util/common.js"),f=document,p=Math.max,o=Math.min,g="#FFFFFF",m="#000000",y=Math.abs,b=Math.PI,v=Math.cos,C=Math.sin,w=Math.atan,x=Math.tan,s.Ho="11pt",T={1:[[1]],2:[[1,0,1,1],[1,1,1,0]],3:[[0,1],[1,0]],4:[[0,0,1,0],[1,0,0,0]],5:[[0,0,0,0],[0,0,1,0],[0,0,0,0],[1,0,0,0]],6:[[0,0,0,0,0,0,0,0],[1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0]],7:[[0],[1],[1],[0]],8:[[1,1,0,0]],9:[[0,1,1,0],[0,0,1,1],[1,0,0,1],[1,1,0,0]],10:[[0,1,1,0],[1,1,0,0],[1,0,0,1],[0,0,1,1]],11:[[0,0,1,1],[0,0,1,1],[1,1,0,0],[1,1,0,0]],12:[[0,1,1,0],[1,1,1,1],[1,0,0,1],[1,1,1,1]],13:[[0],[1],[0],[0]],14:[[1,0,0,0]],15:[[0,1,0,0],[0,0,1,0],[0,0,0,1],[1,0,0,0]],16:[[0,0,1,0],[0,1,0,0],[1,0,0,0],[0,0,0,1]],17:[[0,0,1,0],[1,1,1,1],[0,0,1,0],[0,0,1,0]],18:[[1,0,1,0],[0,0,0,1],[1,0,1,0],[0,1,0,0]]},d.Io=function(t,e){return e?d.Jo(t,e):t},d.Ko=function(t){var e,o;return t?((e=d.Lo()).style.font=t,{fontFamily:(o=e.style).fontFamily,fontSize:o.fontSize,fontStyle:o.fontStyle,fontWeight:o.fontWeight}):{}},d.F4=function(t){var e,o,n,r,i,a;return u.Ul.Ml.safari?t.font:(e="",o="normal",n=t.fontStyle,r=t.fontVariant,i=t.fontWeight,a=t.lineHeight,n&&n!==o&&(e=n),r&&r!==o&&(e+=(e?" ":"")+r),i&&i!==o&&"400"!==i&&(e+=(e?" ":"")+i),e+=(e?" ":"")+(t.fontSize||"11pt"),a&&a!==o&&(e+="/"+a),e+=" "+(t.fontFamily||"Calibri"))},d.Jo=function(t,e){var o,n,r,i,a;if(!t&&!e)return t;if(t){if(r=d.Mo[n=e?t+"+"+e:t])return r;o=d.Lo(),l.GC$(o).css("font",t)}else{if(r=d.Mo[n=e])return r;o=d.Lo(),l.GC$(o).css("fontSize",s.Ho)}return e&&l.GC$(o).css("fontFamily",e),i=o.currentStyle,(a=f.defaultView)&&a.getComputedStyle&&(i=a.getComputedStyle(o,"")),r=d.F4(i),d.Mo[n]=r,d.Mo[r]=r},d.No=function(t,e,o,n){var r,i,a,s,l,u,c,h=d.Oo[e];if(!n)if(h){if(r=h[t])return r}else h=d.Oo[e]={};return(i=d.Lo()).style.font=t,a=i.currentStyle,(s=f.defaultView)&&s.getComputedStyle&&(a=s.getComputedStyle(i,"")),-1!==(l=a.fontSize).indexOf("px")&&(u=p(1,parseFloat(l.replace("px",""))*e),o&&1===u&&(o.value=!0),l=u+"px"),-1!==(c=a.lineHeight).indexOf("px")&&(c=p(1,parseFloat(c.replace("px",""))*e)+"px"),r=1===e?{font:t,fontFamily:i.style.fontFamily,fontSize:u}:(i.style.fontSize=l,i.style.lineHeight=c,{font:i.style.font,fontFamily:i.style.fontFamily,fontSize:u}),n||(h[t]=r),r},d.Lo=function(){var t,e;return d.Po?d.Po.style.cssText=d.Qo:((e=(t=u.Ul.Nl("span")).style).visibility="hidden",e.top="-10000px",e.left="-10000px",e.lineHeight="normal",e.position="absolute",e.fontWeight="normal",e.fontStretch="normal",e.fontVariant="normal",e.fontStyle="normal",f.body.insertBefore(t,null),d.Po=t,d.Qo=e.cssText),d.Po},d.no=function(){var t=d.Po;t&&(l.GC$(t).remove(),d.Po=void 0,d.Qo=void 0)},d.stringFontCatch={},d.Ro=function(t,e){var o,n=t+","+e,r=d.stringFontCatch,i=r[n];return i||((o=d.Lo()).style.font=t,e&&(o.style.fontWeight=e),i=r[n]=o.style.font),i},d.Mo={},d.Oo={},d.So=function(t){if(t<=0)return"none";var e="";return(1|t)===t&&(e+="underline "),(2|t)===t&&(e+="line-through "),(4|t)===t&&(e+="overline "),e.trim()},d.setFillStyle=function(t,e,o,n,r,i,a){"string"==typeof e?(t.fillStyle!==e&&(t.fillStyle=e),a()):"path"===e.type?d.setFillStyle_Path(t,e,o,n,r,i,a):e.stops?d.setFillStyle_Gradient(t,e,o,n,r,i,a):e.type&&d.setFillStyle_patternFill(t,e,o,n,r,i,a)},d.setFillStyle_patternFill=function(t,e,o,n,r,i,a){var s,l,u,c,h=T[e.type],f=h.length,p=h[0].length,d=document.createElement("canvas");for(d.width=p,d.height=f,(s=d.getContext("2d")).fillStyle=e.backgroundColor||g,s.fillRect(0,0,p,f),s.fillStyle=e.patternColor||m,l=0;l<f;l++)for(u=0;u<p;u++)h[l][u]&&s.fillRect(u,l,1,1);t.createPattern(d,"repeat"),c=t.createPattern(d,"repeat"),t.fillStyle=c,a()},d.processStops=function(t){var e,o;if(t.stops||"path"===t.type){if(e=t.stops)if(0===e.length)e=[{position:0,color:m},{position:1,color:m}];else{for((e=e.filter(function(t,e,o){return t.position<=1&&0<=t.position})).sort(function(t,e){return t.position-e.position}),o=0;o<e.length;o++)e[o].color=e[o].color||m;0!==e[0].position&&e.splice(0,0,{position:0,color:m}),1!==e[e.length-1].position&&e.push({position:1,color:m})}else e=[{position:0,color:g},{position:1,color:g}];t.stops=e}"path"===t.type?(t.left=n(t.left),t.right=n(t.right),t.top=n(t.top),t.bottom=n(t.bottom)):t.stops&&(delete t.type,t.degree=t.degree||0)},d.setFillStyle_Gradient=function(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d=e.degree||0;for(d%90==0?(l=d/180*b,u=y(d%180/180*b)-w(i/r)):(l=w(r/i*x(d/180*b)),u=y(l)-w(i/r),l=Math.round(d/180)*b+l),c=Math.sqrt(r*r+i*i)/2,s=t.createLinearGradient(o+r/2-c*v(u)*v(l),n+i/2-c*v(u)*C(l),o+r/2+c*v(u)*v(l),n+i/2+c*v(u)*C(l)),f=0,p=(h=e.stops).length;f<p;f++)s.addColorStop(h[f].position,h[f].color||g);t.fillStyle=s,a()},d.setFillStyle_Path=function(t,e,o,n,r,i,a){var s,l,u,c=e.left||0,h=e.right||0,f=e.top||0,p=e.bottom||0,d=e.stops;if(h<c&&(h=c),p<f&&(p=f),0<c){for(t.save(),t.beginPath(),s=t.createLinearGradient(o+r*c,0,o,0),l=0,u=d.length;l<u;l++)s.addColorStop(d[l].position,d[l].color||g);t.fillStyle=s,t.moveTo(o,n-1),t.lineTo(o+r*c+1,n+i*f),t.lineTo(o+r*c+1,n+i*p),t.lineTo(o,n+i+1),t.clip(),a(),t.restore()}if(h<1){for(t.save(),t.beginPath(),s=t.createLinearGradient(o+r*h,0,o+r,0),l=0,u=d.length;l<u;l++)s.addColorStop(d[l].position,d[l].color||g);t.fillStyle=s,t.moveTo(o+r,n-1),t.lineTo(o+r,n+i+1),t.lineTo(o+r*h-1,n+i*p),t.lineTo(o+r*h-1,n+i*f),t.clip(),a(),t.restore()}if(0<f){for(t.save(),t.beginPath(),s=t.createLinearGradient(0,n+i*f,0,n),l=0,u=d.length;l<u;l++)s.addColorStop(d[l].position,d[l].color||g);t.fillStyle=s,t.moveTo(o,n),t.lineTo(o+r,n),t.lineTo(o+r*h,n+i*f+1),t.lineTo(o+r*c,n+i*f+1),t.clip(),a(),t.restore()}if(p<1){for(t.save(),t.beginPath(),s=t.createLinearGradient(0,n+i*p,0,n+i),l=0,u=d.length;l<u;l++)s.addColorStop(d[l].position,d[l].color||g);t.fillStyle=s,t.moveTo(o+r,n+i),t.lineTo(o,n+i),t.lineTo(o+r*c,n+i*p-1),t.lineTo(o+r*h,n+i*p-1),t.clip(),a(),t.restore()}c<h&&f<p&&(t.save(),t.beginPath(),t.fillStyle=d[0].color,t.rect(o+r*c,n+i*f,r*(h-c),i*(p-f)),t.clip(),a(),t.restore())},s.To=d},"./dist/core/worksheet/worksheet-actions.js":function(t,e,o){"use strict";var n,_,g,C,w,Z,f,r,q,m,O,x,F,P,L,i,T,a,y,b,v,A,S,s,l,H,K,B,M,V,p,u,c,Y,Q,h,d,I,N,R,k,E,D,j,z,W,G,U,J,X,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ht,ft,pt,dt,gt,mt,yt,bt,vt,Ct,wt,xt,Tt,At,St,Mt,It,Nt,Rt,kt,Et,Dt,jt,_t,Ot,Ft,Pt,Lt,Ht,Bt,Vt,zt,Wt,Gt,Ut,Jt,Zt,qt,Kt,Yt,Qt,Xt,$t,te,ee,oe,ne,re,ie,ae,se,le,ue,ce,he,fe,pe,de,ge,me=this&&this.__extends||(ee=function(t,e){return(ee=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}ee(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function ye(t,e){return t.getRowCount(e)}function be(t,e){return t.getColumnCount(e)}function ve(t){return t.rowCount}function Ce(t){return t.colCount}function we(t){var e=t.parent;return e&&e.options.allowExtendPasteRange}function xe(t){var e=t.parent;return e&&e.options.allowCopyPasteExcelStyle}function Te(t){var e=t.parent;return e&&e.options.copyPasteHeaderOptions}function Ae(t,e,o,n){throw Error(i.Kb(Y().Exp_InvalidAndSpace,[t,e,o,n]))}function Se(t){t.suspendPaint()}function Me(t){t.resumePaint()}function Ie(t){t.suspendEvent()}function Ne(t){t.resumeEvent()}function Re(t,e){t&&F&&t.suspendCalcService(e)}function ke(t,e){t&&F&&t.resumeCalcService(e)}function Ee(t){this.Vw=1==(1&t),this.Ww=2==(2&t),this.Xw=8==(8&t),this.Yw=F&&16==(16&t),this.Zw=!0,this.$w=!0}function De(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y,b,v;if(P(t)||""===t)return H;for(!P(e)&&""!==e||(e="\r\n"),!P(o)&&""!==o||(o="\t"),!P(n)&&""!==n||(n='"'),T(t,e)||(t+=e),i=!r,a=[],l="",c=!(s=[]),h=n.length,f=e.length,p="\n".length,d=o.length,g=t.length,m=0;m<g;m++)u=(l+=t[m]).length,i&&h<=u&&n===l.substr(u-h,h)?c&&m+1+h<=g&&n===t.substr(m+1,h)?m+=h:c?(l=l.substr(0,u-h),c=!1):0===l.indexOf(n)&&(l=l.substr(0,u-h),c=!0):!c&&d<=u&&o===l.substr(u-d,d)?(l=l.substr(0,u-d),s.push(""+l),l=""):!c&&f<=u&&e===l.substr(u-f,f)?(l=l.substr(0,u-f),s.push(""+l),a.push(s),s=[],l=""):!c&&p<=u&&"\n"===l.substr(u-p,p)?(l=l.substr(0,u-p),s.push(""+l),a.push(s),s=[],l=""):c&&m+1+d<=g&&o===t.substr(m+1,d)&&","!==o&&(m+=h);if(c){if(0<s.length){for(y=void 0,y=0;y<a.length&&a[y]!==s;y++);y>=a.length&&a.push(s)}(b=""+l)&&(b=b.replace(RegExp(o,"g"),""),T(b,e)&&(b=b.substr(0,b.length-f)),0===a.length&&a.push([b]))}return 0===a.length&&(T(v=t,e)&&(v=v.substr(0,v.length-f)),a.push([v])),function(t){var e,o;if(t){for(e=0;e<t.length&&((o=t[e])&&1===o.length);e++);if(e===t.length)return 1}return}(a)&&/^(\s)*$/.test(t)&&"\n"===t.substr(t.length-p,p)&&a.push([""]),a}function je(t,e,o,n,r,i,a,s){var l,u,c=be(t,i);for(l=0,u=n;l<e.length;l++,u++)0<r&&u<c&&(s&&(u=t.Zq(u-1,3)),_e(t,i,o,u,e[l],a))}function _e(e,o,n,r,i,t){var a,s,l,u,c,h,f,p=i,d=H;if(!1===t.Xw&&(a={value:H},p=Z.Ul.ul(H,i,!t.Xw,a),d=a.value),P(p))e.setValue(n,r,p,o);else if(""!==i)if(t.Yw&&"="===i[0]&&1<i.length)try{e.setFormula(n,r,i.substr(1))}catch(t){e.setText(n,r,i,o)}else s=e.tq(n,r,"formatter",o),!1===t.Xw&&d?s?s&&("string"==typeof s&&g.Formatter&&(s=new g.Formatter.GeneralFormatter(s)),f=s.parse&&s.parse(i),p=P(f)?p:f):(d.isAuto=!0,e.getCell(n,r,o)._w("_autoFormatter",d),l=i,u=e.getCellType(n,r,o),c=d.formatString(),u&&"7"===u.typeName&&(h={sheet:e,row:n,col:r,sheetArea:o},l=u.parse(i,c,h),p=P(l)?i:l)):s&&e.getCell(n,r,o).formatter(H),e.setValue(n,r,p,o);else e.setValue(n,r,H,o)}function Oe(t){var e,o,n=0;for(e=0;e<(t&&t.length);e++)o=t[e],n=B(o.length,n);return n}function Fe(t,e,o,n,r,i,a,s,l){if(!t)throw Error(Y().Exp_SheetIsNull);if((e<-1||e>=ye(t))&&Ae("row",e,"-1",ye(t)-1),(o<-1||o>=be(t))&&Ae("column",o,"-1",be(t)-1),!P(n)&&""!==n){-1===e&&(e=0),-1===o&&(o=0);var u=De(n,r,i,a,l);u&&0<u.length&&function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p=n.length,d=Oe(n);if(0!==p&&0!==d)for(i=new Ee(r),t&&(be(t,2)<=0&&(i.Vw=!1),ye(t,1)<=0&&(i.Ww=!1)),(d-=a=i.Vw?be(t,2):0)<=(l=0)&&(d=0),(p-=s=i.Ww?ye(t,1):0)<=0&&(l=0),(p-=l)<=0&&(p=0),i.Zw&&e+p>ye(t)&&t.setRowCount(e+p),i.$w&&o+d>be(t)&&t.setColumnCount(o+d),c=u=0;u<n.length;u++,c++)h=n[u],f=t.KLc(),h.length<=0||(0<s&&u<s?je(t,h,c,o,d,1,i):0<p&&c<ye(t)&&(u===s&&(c=e),je(t,h,c,0,a,2,i),h.splice(0,a),f&&(c=t._q(c-1,3)),je(t,h,c,o,d,3,i,f)))}(t,e,o,u,s)}}function Pe(t,e,o,n,r,i,a,s,l,u,c,h,f,p){var d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_;if(!t)throw Error(Y().Exp_SheetIsNull);return d=ye(t),g=be(t),(e<-1||d<=e)&&Ae("row",e,"-1",d-1),(o<-1||d<e+o)&&Ae("rowCount",o,"-1",d-e),(n<-1||g<=n)&&Ae("column",n,"-1",g-1),(r<-1||g<n+r)&&Ae("columnCount",r,"-1",g-n),v=b=!(y=m=-1),y=-1===e&&-1===n&&-1===o&&-1===r?(n=e=0,m=ye(t)-1,be(t)-1):(-1===e&&(e=0,2==(2&Te(t))&&(b=!0)),-1===n&&(n=0,1==(1&Te(t))&&(v=!0)),-1===o&&(o=ye(t)-e),-1===r&&(r=be(t)-n),m=e+o-1,n+r-1),!P(i)&&""!==i||(i="\r\n"),!P(a)&&""!==a||(a="\t"),!P(s)&&""!==s||(s='"'),x=w=null,T=Le(t,e,m,n,y,3,u,c,i,a,s,C=RegExp(s,"g"),l,h,f,p),v&&(A=t.getColumnCount(2),w=Le(t,e,m,0,A-1,2,u,c,i,a,s,C,l,h,f,p)),b&&(S=t.getRowCount(1),x=Le(t,0,S-1,n,y,1,u,c,i,a,s,C,l,h,f,p)),N=x,R=i,k=a,j=M=T,_=0,(I=w)&&(_=I[0].length,j=O(I,M)),N&&(E=N.length,D=null,_&&(D=Le(null,0,E-1,0,_-1,null,[],[],R,k,null,null,null,!1,!1),N=O(D,N)),j=N.concat(j)),function(t,e,o){var n,r,i="",a=t.length;for(n=0;n<a;n++){for(r=0;r<t[n].length;r++)0!==r&&(i+=o),i+=t[n][r];i+=e}return i}(j,R,k);function O(t,e){var o,n=[],r=t.length;for(o=0;o<r;o++)n.push(t[o].concat(e[o]));return n}}function Le(t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g){var m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O=[],F=t&&xe(t);for(m=e;m<=o;m++)if(!a||!L(a,m)){for(b=[],y=n;y<=r;y++)s&&L(s,y)||(v="",t&&(k=m,E=y,D=i,j=p,!(_=t.getSpan(k,E,D))||!j||_.row===k&&_.col===E)&&(v=t.getText(m,y,i),g&&F&&v&&(v=" "!==v[0]&&" "!==v[v.length-1]||"number"!=typeof t.getValue(m,y,i)?v.replace(/[\r\n]+/g,"\n"):v.trim())),w=p,x=F,T=h,A=c,S=d,M=f,I=u,N=l,R=void 0,R="",P(C=v)||(R=C,w||(R=R.replace(T,A+A))),S&&!R&&(R=" "),w&&x?R=R.replace(/\n/g," "):!M&&-1===R.indexOf(A)&&-1===R.indexOf(I)&&-1===R.indexOf(N)&&-1===R.indexOf("\n")||(R=A+R+A),v=R,b.push(v));O.push(b)}return O}function He(m,t){var y=[];return t.forEach(function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g=(o=t,s=(e=m).row,l=e.col,u=e.row+e.rowCount,c=e.col+e.colCount,h=o.row,f=o.col,p=o.row+o.rowCount,d=o.col+o.colCount,!!(B(s,h)<=M(u,p)&&B(l,f)<=M(c,d))&&(n=B(s,h),r=B(l,f),i=M(u,p)-n,a=M(c,d)-r,new Z.Range(n,r,i,a)));g&&y.push(g)}),y}function Be(t,e){if(t.sheets){var o=Z.uJc(t,e.sheetName);if(o)return o}return t}function Ve(t,e,o,n){var r=Be(t,o),i=new e(r,o,n);return n?i.undo(r):i.execute(r)}function ze(t){var n=t;return function(t,e){var o=Be(t,e);return Q.Ox(o,n)}}function We(t,e){var n=t,r=e;return function(t,e){var o=Be(t,e);return Q.Rx(o,n,r)}}function Ge(t,e){var o,n,r,i=t.parent;i&&(o=i.getSheetCount(),r=void 0,n=r=i.getActiveSheetIndex(),e?r<o-1&&r++:0<r&&r--,n!==r&&(i.dq(r,1),i.repaint()))}function Ue(t,e){t.Tx=!0,t.Hx?t.Ex(e):t.yx(e,!0),t.Tx=!1}function Je(t,e){var o,n,r,i;return!!t.endEdit()&&((o=t._eventHandler).Ux(),o.Vx(),Z.Vl.Zl(H),n=!1,(r=t.parent)&&((i=e.call(r))&&i.focus?(i.focus(),n=!0):r.Uv()),{ignoreCancelDefault:!n})}function Ze(t,e,o){this.kj=t,this.my=e,this.ny=o,this.oy=[],this.Iu=[],this.py()}function qe(e,t){var o=[];return"string"==typeof t?o.push(e.getSheetFromName(t)):Array.isArray(t)&&t.forEach(function(t){o.push(e.getSheetFromName(t))}),o}function Ke(t,e){Se(t),e||Ie(t)}function Ye(t,e){e||Ne(t),Me(t)}function Qe(t,e){this.Lz=Ke,this.Mz=Ye;this.kj=t,this.VQ=e}function Xe(t,e){P(t.lq)&&(t.lq=e.lq,t.qq=e.qq)}function $e(t,e){var o=ne.call(this,t,e)||this,n=o,r=t.parent;return n.Wz=e.columnHeader?1:3,s(e.autoFitType)||(e.autoFitType=r?r.options.autoFitType:0),o}function to(t,e){var o=re.call(this,t,e)||this,n=o,r=t.parent;return n.Wz=e.rowHeader?2:3,s(e.autoFitType)||(e.autoFitType=r?r.options.autoFitType:0),o}function eo(t,e){var o=ie.call(this)||this,n=o;return n.kj=t,n.VQ=e,o}function oo(t,e){var o=ae.call(this)||this,n=o;return n.kj=t,n.VQ=e,o}function no(t,e){var o=se.call(this,t,e)||this;return Xe(e,t),o}function ro(t,e){var o=le.call(this,t,e)||this;return Xe(e,t),o}function io(t,e){"value"===e.propertyName&&t.xu(e.row,e.col,e.oldValue,e.newValue)}function ao(t,e){var o,n,r=ue.call(this,t,e)||this;return F&&e.ranges&&1===e.endEditType&&(o=t.Tq(e.ranges[0]),1===ve(e.ranges[0]=o)&&1===Ce(o)&&((n=t.Ms(o.row,o.col,1,1))&&n.ranges&&0<n.ranges.length&&(e.ranges=[n.ranges[0]]))),r}function so(t){var e=t.parent,o=e&&e.YJc;o&&o.repaint()}function lo(t,e){return ce.call(this,t,e)||this}function uo(t,e){return he.call(this,t,e)||this}function co(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N=fe.call(this,t,e)||this;if(!o){if(n=t,r=e.fromSheet,!n)throw Error(Y().Exp_DestSheetIsNull);if(a=(i=e).pastedRanges,s=n.KLc(),a&&0<a.length)if(e.MA=[],u=(l=i.fromRanges||[i.fromRange]).length,c=i.isCutting,h=i.clipboardText,f=i.clipboardHtml,p=i.clipboardImage,d=i.pasteOption,g={},m=a[0],!c&&r&&r.r5(l,g)&&m.equals(r.q5(l,m))){for(b=g.inSameCol,(y=g.inSameRow)?l.sort(function(t,e){return t.col-e.col}):b&&l.sort(function(t,e){return t.row-e.row}),v=m.row,C=m.col,w=0;w<u;w++)T=(x=l[w]).rowCount,A=x.colCount,s&&(T+=t.MLc(v,T,!0),A+=t.MLc(C,A)),S={sourceRange:x,targetRange:Z.kf(v,C,T,A),isCutting:c,clipboardText:h,clipboardHtml:f,clipboardImage:p,includeFilteredOutRow:!0},e.MA[w]=new $t(t,{fromSheet:r,toSheet:n,pasteExtent:S,pasteOption:d}),y?C+=A:b&&(v+=T);e.s5=!0}else for(M=0;M<a.length;M++)I={sourceRange:l[0],targetRange:a[M],isCutting:c,clipboardText:h,clipboardHtml:f,clipboardImage:p},e.MA[M]=new $t(t,{fromSheet:r,toSheet:n,pasteExtent:I,pasteOption:d})}return N}function ho(t,e){return pe.call(this,t,e)||this}function fo(t,e,o){var n,r,i=de.call(this,t,e)||this;if(!o&&(e.MA=[],(n=e.ranges)&&0<n.length))for(r=0;r<n.length;r++)e.MA[r]=new Qt(t,{clearRange:n[r]});return i}function po(t,e){return ge.call(this,t,e)||this}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/core.ns.js"),_=o("@grapecity/js-sheets-common"),g=o("@grapecity/js-sheets-common"),C=o("./dist/core/worksheet/style.js"),w=o("./dist/core/worksheet/worksheet.js"),Z=o("./dist/core/util/common.js"),f=o("./dist/core/worksheet/clipboardhelper.js"),r=o("./dist/core/util/domUtil.js"),q=o("./dist/core/core.enum.js"),m=r.GC$,O=o("./dist/core/worksheet/worksheet-static.js"),x=o("@grapecity/js-calc"),F=!!x,P=_.Common.j.Fa,L=_.Common.k.Bb,i=_.Common.u,T=i.jb,a=Z.Events.CellChanged,y=Z.Events.ColumnWidthChanging,b=Z.Events.ColumnWidthChanged,v=Z.Events.RowHeightChanging,A=Z.Events.RowHeightChanged,S=Z.Ul.Ml,s=Z.Ul.Ol,l=m.extend,m.inherit,H=null,K=void 0,B=Math.max,M=Math.min,V=Math.floor,p=Math.ceil,Number.MAX_VALUE,isNaN,(oe=u=e.CopyToOptions||(e.CopyToOptions={}))[oe.value=1]="value",oe[oe.formula=2]="formula",oe[oe.comment=4]="comment",oe[oe.outline=8]="outline",oe[oe.sparkline=16]="sparkline",oe[oe.span=32]="span",oe[oe.style=64]="style",oe[oe.tag=128]="tag",oe[oe.bindingPath=256]="bindingPath",oe[oe.conditionalFormat=512]="conditionalFormat",oe[oe.hyperlink=1024]="hyperlink",oe[oe.all=2047]="all",c=new _.Common.ResourceManager(n.SR),Y=c.getResource.bind(c),l(w.Worksheet.prototype,{autoFitColumn:function(t){0<=t&&t<be(this)&&this.wu().execute({cmd:"autoFitColumn",sheetName:this.name(),columns:[{col:t}],rowHeader:!1})},autoFitRow:function(t){0<=t&&t<ye(this)&&this.wu().execute({cmd:"autoFitRow",sheetName:this.name(),rows:[{row:t}],columnHeader:!1})},setCsv:function(t,e,o,n,r,i,a){Se(this),Ie(this),Fe(this,t,e,o,n,r,'"',i,a),Ne(this),Me(this)},getCsv:function(t,e,o,n,r,i){return Pe(this,t,o,e,n,r,i,'"',!0)},copyTo:function(t,e,o,n,r,i,a){this.ax(t,e,o,n,r,i,a)},ax:function(t,e,o,n,r,i,a,s,l){Se(this),Ie(this),O.staticMembers.copyTo(this,t,e,this,o,n,r,i,a,s,0,l),Ne(this),Me(this)},moveTo:function(t,e,o,n,r,i,a,s){if(!(F&&a&u.formula)||this.Vq(t,e,r,i,!0)&&this.Vq(o,n,r,i,!0))try{Se(this),Ie(this),O.staticMembers.moveTo(this,t,e,this,o,n,r,i,a,s)}finally{Ne(this),Me(this)}},bx:function(t,e,o){var n,r,i,a,s,l,u,c=this,h=c.o5(t);if(h){n=c.J5(t),r=c._eventHandler,i=Pe(c,h.row,ve(h),h.col,Ce(h),"\r\n","\t",'"',!1,n.rows,n.cols,!0),(a=c.tu()).PA=c,a.n5=t,a.G4=e,c.tu().UHb=!0,s=Te(c),l=f.S4.Q4(c,s,h.row,ve(h),h.col,Ce(h),q.SheetArea.viewport,xe(c),n.rows,n.cols,!1,!1,!1,!1),c.ex&&c.ex(),c.Sob&&c.Sob();try{if(u={sheet:c,sheetName:c.name(),copyData:{text:i,html:l},cancel:!1},c.Wq(Z.Events.ClipboardChanging,u),!1===u.cancel)return r&&!o&&r.gx(xe(c)?l:i),c.Wq(Z.Events.ClipboardChanged,{sheet:c,sheetName:c.name(),copyData:{text:i,html:l}}),setTimeout(function(){!r||o||c.Js||r.hx()},100),{copyText:i,copyHtml:l};a.hZ()}catch(t){}}},ix:function(t,e,o,n,r,i,a,s,l,u){var c,h,f=Y().Exp_PasteSourceCellsLocked;if(a.pastedInternal=!1,a.pastedRange=H,c=!i&&!l,!t&&c)return!1;if(h=this.J5(e),this.jx(t,this.o5(e),this,i,h.rows,h.cols,u)||c){if(a.pastedInternal=!0,r&&t.options.isProtected&&t.p5(e))return this.Os(1,f),!1;a.pastedRange=this.kx(t,e,this,o,n,r)}else a.pastedRange=this.lx(this,o,i);return this.mx(t,e,o,n,r,a,s)},mx:function(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m,y,b,v,C,w=Y().Exp_InvalidCopyPasteSize,x=Y().Exp_PasteDestinationCellsLocked,T=Y().Exp_PasteChangeMergeCell,A=Y().Exp_ChangePartOfArray,S=this,M=S,I=i.pastedRange,N=M.KLc();if(!I)return S.Os(1,w),!1;if(!M.Y3(I.row,I.col,ve(I),Ce(I),x,A,K,a))return!1;if(i.pastedInternal){if(1===(s=e.length)){if(l=e[0],r&&!t.Y3(l.row,l.col,ve(l),Ce(l),x,A))return!1;if(t.qu(l.row,l.col,ve(l),Ce(l)))return S.Os(1,T),!1;if(u=I.row<0?ye(M):ve(I),c=I.col<0?be(M):Ce(I),h=l.row<0?ye(t):ve(l),f=l.col<0?be(t):Ce(l),N&&(u=(u-=M.MLc(o.row,B(u,h),!0))<1?1:u,c=(c-=M.MLc(o.col,B(c,f)))<1?1:c),(h<u||f<c)&&!(2===n)){for(p=o.row,d=o.col,o.row<0&&h<ye(M)&&(p=0),o.col<0&&f<be(M)&&(d=0),u%h==0&&1===c?(c=f,I=i.pastedRange=new Z.Range(p,d,u,c)):1===u&&c%f==0?(u=h,I=i.pastedRange=new Z.Range(p,d,u,c)):u%h==0&&c%f==0||(u=h,c=f,I=i.pastedRange=new Z.Range(p,d,u,c)),g=V(u/h),m=V(c/f),y=0;y<g;y++)for(b=0;b<m;b++)if(!S.nx(l,I)&&M.qu(p<0?-1:p+y*h,d<0?-1:d+b*f,p<0?-1:h,d<0?-1:f))return S.Os(1,T),!1}else if(a===K&&!S.nx(l,I)&&M.qu(I.row,I.col,ve(I),Ce(I)))return S.Os(1,T),!1}else if(1<s){for(v=0;v<s;v++)if(C=e[v],t.qu(C.row,C.col,ve(C),Ce(C)))return S.Os(1,T),!1;if(M.qu(I.row,I.col,ve(I),Ce(I)))return S.Os(1,T),!1}}else{if(M.qu(I.row,I.col,ve(I),Ce(I)))return S.Os(1,T),!1;if(!M.l5(I.row,I.col,ve(I),Ce(I)))return S.Os(1,w),!1}return!0},nx:function(t,e){if(t&&1===ve(t)&&1===Ce(t)){var o=this.getSpan(e.row,e.col);if(o&&o.equals(e))return!0}return!1},jx:function(t,e,o,n,r,i,a){var s,l;if(t&&e&&o)try{return(l=(s=Pe(t,e.row,ve(e),e.col,Ce(e),"\r\n","\t",'"',!1,r,i,!0,S.safari,!0))===n)||(!(l=s===n+"\r\n")&&S.chrome&&(l=s===n+"\t\r\n"),l||!(S.safari||S.mozilla||a)&&xe(o)||(l=s.replace(/\s/g,"")===n.replace(/\s/g,"")),l=l||s.replace(/\s+$/,"")===n.replace(/\s+$/,"")),l}catch(t){return!1}return!1},kx:function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y,b=e.length,v=o.KLc();if(1!==b)return 1<b?this.q5(e,n):H;if(s=(a=e[0]).row<0?0:a.row,l=a.col<0?0:a.col,u=a.row<0?ye(t):ve(a),c=a.col<0?be(t):Ce(a),h=n.row<0?0:n.row,f=n.col<0?0:n.col,p=n.row<0?ye(o):ve(n),d=n.col<0?be(o):Ce(n),m=g=void 0,v&&(p=(p-=g=o.MLc(h,B(p,u),!0))<1?1:p,d=(d-=m=o.MLc(f,B(d,c)))<1?1:d),i||1===p&&1===d)p=u,d=c;else if(!(2===r)&&(p%u==0&&1===d?d=c:1===p&&d%c==0?p=u:p%u==0&&d%c==0||(p=u,d=c),!this.pu(s,l,u,c,ye(t),be(t))))return H;if(y=new Z.Range(h,f,p,d),!i&&t.name()===o.name())if(y.contains(s,l,u,c)){if((s-h)%u!=0||(l-f)%c!=0)return H}else if(y.intersect(s,l,u,c)&&(u<p||c<d))return H;return v&&(p+=g,d+=m),o.l5(h,f,p,d)?(-1===n.row&&(p=h=-1),-1===n.col&&(d=f=-1),new Z.Range(h,f,p,d)):H},q5:function(t,e){var o,n,r,i,a,s,l,u,c=this.KLc();if(1<t.length){if(o=t[0],n=t[1],r=o.rowCount,i=o.colCount,o.row===n.row&&r===n.rowCount)return a=0,s=r,t.forEach(function(t){a+=t.colCount}),c&&(s+=this.MLc(e.row,s,!0),a+=this.MLc(e.col,a)),Z.kf(e.row,e.col,s,a);if(o.col===n.col&&i===n.colCount)return l=0,u=i,t.forEach(function(t){l+=t.rowCount}),c&&(l+=this.MLc(e.row,l,!0),u+=this.MLc(e.col,u)),Z.kf(e.row,e.col,l,u)}return H},lx:function(t,e,o){var n,r,i=e.row<0?0:e.row,a=e.col<0?0:e.col,s=new Z.Range(i,a,1,1),l=function(t,e,o,n){var r,i,a,s,l,u=H,c=De(t,e,o,n,!0);if(c){for(r=c.length,i=Oe(c),a=[],s=0;s<r;s++)for(a[s]=[],l=0;l<i;l++)l<c[s].length?a[s][l]=c[s][l]:a[s][l]=H;u=a}return u}(o,"\r\n","\t",'"');return l&&(n=l.length,r=Oe(l),0<n&&0<r&&(t.KLc()&&(n+=t.MLc(i,n,!0),r+=t.MLc(a,r)),s=new Z.Range(i,a,n,r))),s},ox:function(){var t=this.tu();t&&t.hZ()},HXc:function(t,o,n,e,r,i,a,s,l,u){var c,h,f,p,d,g,m,y,b,v,C,w,x=$t.qx(l),T=e.row<0?ye(n):ve(e),A=e.col<0?be(n):Ce(e),S=o.row<0?ye(t):ve(o),M=o.col<0?be(t):Ce(o),I=e.row,N=e.col;for(e.row<0&&S<ye(n)&&(I=0),e.col<0&&M<be(n)&&(N=0),c=V(T/S),h=V(A/M),f=0;f<c&&c&&h;f++)for(p=0;p<h;p++)O.staticMembers.copyTo(t,o.row,o.col,n,I+S*f,N+M*p,S,M,x,u,Te(t));for(v=-33&x,d=I+S*c,g=N,m=T-S*c,y=M,b=He(new Z.Range(o.row,o.col,m,y),t.getSpans(o)),C=function(e){b.forEach(function(t){n.addSpan(d+t.row-o.row,g+M*e+t.col-o.col,t.rowCount,t.colCount)}),O.staticMembers.copyTo(t,o.row<0?0:o.row,o.col<0?0:o.col,n,d,g+M*e,m,y,v,u,Te(t))},p=0;p<h&&m&&y;p++)C(p);for(d=I,g=N+M*h,m=S,y=A-M*h,b=He(new Z.Range(o.row,o.col,m,y),t.getSpans(o)),w=function(e){b.forEach(function(t){n.addSpan(d+S*e+t.row-o.row,g+t.col-o.col,t.rowCount,t.colCount)}),O.staticMembers.copyTo(t,o.row<0?0:o.row,o.col<0?0:o.col,n,d+S*e,g,m,y,v,u,Te(t))},f=0;f<c&&m&&y;f++)w(f);d=I+S*c,g=N+M*h,m=T-S*c,y=A-M*h,b=He(new Z.Range(o.row,o.col,m,y),t.getSpans(o)),m&&y&&(b.forEach(function(t){n.addSpan(d+t.row-o.row,g+t.col-o.col,t.rowCount,t.colCount)}),O.staticMembers.copyTo(t,o.row<0?0:o.row,o.col<0?0:o.col,n,d,g,m,y,v,u,Te(t)))},px:function(t,e,o,n,r,i,a,s,l,u){var c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j;if(!t||o.name()!==t.name()||!o.parent||t.xUc||L(o.parent.sheets,t)){c=o.KLc(),y=$t.qx(l),Re(t),Re(o);try{if(t&&e){if(0!=(2&y)&&r&&F&&(t.Ns(e.row,e.col,ve(e),Ce(e))||o.Ns(n.row,n.col,ve(n),Ce(n))))throw Y().Exp_ChangePartOfArray;if(b=2===l,r)O.staticMembers.moveTo(t,e.row,e.col,o,n.row,n.col,ve(e),Ce(e),y,!0),t.ox();else if(b)this.HXc(t,e,o,n,r,i,a,s,l,u);else if(v=n.row<0?ye(o):ve(n),C=n.col<0?be(o):Ce(n),p=e.row<0?ye(t):ve(e),d=e.col<0?be(t):Ce(e),c&&(v-=o.MLc(n.row,B(v,p),!0),C-=o.MLc(n.col,B(C,d)),v=v<1?1:v,C=C<1?1:C),p<v||d<C)for(h=n.row,f=n.col,n.row<0&&p<ye(o)&&(h=0),n.col<0&&d<be(o)&&(f=0),v%p==0&&1===C?C=d:1===v&&C%d==0?v=p:v%p==0&&C%d==0||(v=p,C=d),w=V(v/p),x=V(C/d),T=p,A=d,N=I=M=S=void 0,g=0;g<w;g++){for(S=P(I)?h<0?-1:h+g*p:I,m=0;m<x;m++)M=P(N)?f<0?-1:f+m*d:N,p=h<0?-1:T,d=f<0?-1:A,c&&(p=h<0?-1:p+o.MLc(S,T,!0),d=f<0?-1:d+o.MLc(M,A)),O.staticMembers.copyTo(t,e.row,e.col,o,S,M,T,A,y,u,Te(t)),N=M+(d<0?0:d);I=S+(p<0?0:p),N=null}else O.staticMembers.copyTo(t,e.row,e.col,o,n.row,n.col,ve(e),Ce(e),y,u,Te(t))}else{if(h=n.row,f=n.col,p=ve(n),d=Ce(n),i)for(E=(k=(R=o._modelManager).getSpans(Z.kf(h,f,p,d))).length-1;0<=E;E--)R.do("removeSpan",k[E]);if(F&&0<(1&y)&&o.clearFormula(h,f,p,d,function(t,e){return!t.Ps||!t.Ps(e)}),D=o.tu(),j=0===l||2===l,i&&""!==i)o.parent&&o.parent.options.allowAutoCreateHyperlink&&1===p&&1===d&&(_.Common.q.qb("^(((ht|f)tp(s?)):\\/\\/(?:www.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|www\\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|((ht|f)tp(s?)):\\/\\/(?:www\\.|(?!www))[a-zA-Z0-9]+\\.[^\\s]{2,}|www\\.[a-zA-Z0-9]+\\.[^\\s]{2,})$").test(i)||_.Common.q.qb("^(mailto:\\/\\/)?([A-Za-z0-9_\\-\\.\\!\\#$%&'*\\+/=?^`{|}~])+\\@([A-Za-z0-9\\-])+\\.([A-Za-z0-9\\-]){2,63}(\\?subject=.+)?$").test(i))&&o.setHyperlink&&o.setHyperlink(h,f,{url:i,tooltip:i}),o.setCsv(h,f,i,"\r\n","\t",16,!0);else{for(g=0;g<p;g++)for(m=0;m<d;m++)o.setValue(h+g,f+m,H);D&&j&&s&&D.lgc(s,o,h,f)}D&&j&&a&&D.R4(a,o,h,f)}}finally{ke(t,!1),ke(o,!1)}}else t.ox()},sx:function(t){if(!this.isEditing()){var e=this.getSelections();if(e&&1===e.length)return this.bx(e,!0,t)}return H},r5:function(t,e){var o,n,r,i,a,s,l;if(t&&1<(o=t.length)){for(n=void 0,n=0;n<o;n++)for(r=t[n],i=n+1;i<o;i++)if(a=t[i],r.intersect(a.row,a.col,a.rowCount,a.colCount))return!1;for(s=t[0],l=void 0,n=1;n<o&&(l=t[n],s.row===l.row&&s.rowCount===l.rowCount);n++);if(o<=n)return e&&(e.inSameRow=!0),!0;for(n=1;n<o&&(l=t[n],s.col===l.col&&s.colCount===l.colCount);n++);if(o<=n)return e&&(e.inSameCol=!0),!0}return!1},o5:function(t){var e,o,n,r,i;if(t){if(1===(e=t.length))return t[0];if(1<e){if(o=t[0],n=t[e-1],i=r=void 0,o.row===n.row&&o.rowCount===n.rowCount){for(r=0;r<e;r++)(i=t[r]).col<o.col&&(o=i),i.col>n.col&&(n=i);return Z.kf(o.row,o.col,o.rowCount,n.col+n.colCount-o.col)}if(o.col===n.col&&o.colCount===n.colCount){for(r=0;r<e;r++)(i=t[r]).row<o.row&&(o=i),i.row>n.row&&(n=i);return Z.kf(o.row,o.col,n.row+n.rowCount-o.row,o.colCount)}}}return H},J5:function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p=[],d=[];if(t&&(1<(e=t.length)&&(o=t[0],n=t[e-1],r=o.row===n.row&&o.rowCount===n.rowCount,i=o.col===n.col&&o.colCount===n.colCount,r||i)))for(t.sort(r?function(t,e){return t.col-e.col}:function(t,e){return t.row-e.row}),a=1;a<e;a++)for(s=t[a-1],l=t[a],u=r?s.col+s.colCount:s.row+s.rowCount,c=r?l.col:l.row,h=r?d:p,f=u;f<c;f++)h.push(f);return{rows:p,cols:d}},ux:function(t){var e,o,n,r,i,a,s=this;if(!s.isEditing()){if((e=s.getSelections())&&1===e.length){if(s.tu().UHb=!0,-1!==(o=e[0]).row&&s.Nu&&s.Nu()){for(n=[],r=-1,i=0;i<o.rowCount;i++)a=o.row+i,s.Ps(a)?-1!==r&&(n.push(Z.kf(r,o.col,a-r,o.colCount)),r=-1):-1===r&&(r=a);-1!==r&&n.push(Z.kf(r,o.col,o.row+o.rowCount-r,o.colCount)),e=n}return s.bx(e,!1,t)}if(s.r5(e))return s.bx(e,!1,t);s.Os(1,Y().Exp_MultipleSelections)}return H},vx:function(t){var a,s,l,u,c,h,f,p=this,d=p._eventHandler;p.isEditing()||(t&&(a=t.pasteText,s=t.pasteHtml,l=void 0===t.pasteOption?p.options.clipBoardOptions:t.pasteOption,u=t.shiftCells,c=p.getSelections()[0],h=t.isFromDesigner),d&&!a&&d.gx(""),(f=p.tu())&&(f.VHb=!1),setTimeout(function(){var t,e,o,n,r,i;p.Js||(t=a||"",e=s||"",d&&!a&&(f&&(r=f.wx(),i=f.PA,t=r.text,e=r.html,n=r.image,o=f.n5&&f.n5[0],i&&Z.Ul.rXc(o,i.getRowCount(),i.getColumnCount())),d.hx()),(S.msie||S.edge||a||!t&&!e&&!f.VHb)&&p.J4(t,e,n,l,u,c,o,h),p._eventHandler.Qq(),p.Wq(Z.Events.PasteEnd))},100))},J4:function(t,e,o,n,r,i,a,s){var l,u=this.tu();if(u&&(u.VHb=!0),!(l=this.xx(t,n,r,e,s))){if(!o)return;l={pasteOption:void 0===n?this.options.clipBoardOptions:n,pastedRanges:[Z.kf(this.getActiveRowIndex(),this.getActiveColumnIndex(),1,1)],clipboardText:""}}r!==K&&(l.WHb=r),i&&(l.XHb=i),a&&(l.YHb=a),l.cmd="clipboardPaste",l.sheetName=this.name(),xe(this)&&(l.clipboardHtml=e,l.clipboardImage=o),this.wu().execute(l)},xx:function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g=this,m=Y().Exp_InvalidPastedArea,y=g.tu(),b=y.PA,v=y.n5,C=y.G4;if(C&&b&&v&&b.options.isProtected&&b.p5(v)&&(C=!1),i={pastedRange:H,pastedInternal:!1},a=[],1<(s=g.getSelections()).length)for(u=2===e,c=0;c<s.length;c++){if(l=s[c],!g.ix(b,v,l,e,C,t,i,K,n,r))return;if(l.containsRange(i.pastedRange)&&!l.equals(i.pastedRange)&&!u)return void g.Os(1,m);a.push(i.pastedRange)}else{if(l=0<s.length?s[0]:g._modelManager.getSpan(g.Jl,g.Kl),!g.ix(b,v,l,e,C,t,i,o,n,r))return;a.push(i.pastedRange)}if((h=g.at)&&h.jx(i.pastedInternal),i.pastedInternal||(v=b=H,C=!1),f=void 0===e?g.options.clipBoardOptions:e,C&&(f=0),v&&1===v.length)for(p=0;p<a.length;p++)d=a[p],g.nx(v[0],d)&&(d.rowCount=1,d.colCount=1);return(!v||1<v.length)&&1<a.length?void g.Os(1,Y().Exp_MultipleSelections):{fromSheet:b,fromRanges:v,isCutting:C,pasteOption:f,pastedRanges:a,clipboardText:t}},l5:function(t,e,o,n,r){var i=ye(this),a=be(this);return we(this)?-1<=t&&(r||t<i)&&-1<=e&&(r||e<a):this.pu(t,e,o,n,i,a)},p5:function(t){for(var e=0;e<t.length;e++)if(this.ou(t[e]))return!0;return!1},yx:function(t,e,o,n){var r,i,a,s=this;s.endEdit&&!s.endEdit()||(r={sheet:s,sheetName:s.name(),row:s.Jl,col:s.Kl,cancel:!1},s.Wq(Z.Events.LeaveCell,r),!0!==r.cancel&&(i=s.Jl,a=s.Kl,P(o)&&(o=s.Jl),P(n)&&(n=s.Kl),3===t?s.zx(o,n,e):4===t?s.Rs(o,n,e):1===t?s.Ax(o,n,e):2===t?s.Bx(o,n,e):5===t?s.Cx():6===t&&s.Dx(),s.Ss(t,i,a)))},Ex:function(t){var e,o,n,r=this;r.endEdit()&&(e={sheet:r,sheetName:r.name(),row:r.Jl,col:r.Kl,cancel:!1},r.Wq(Z.Events.LeaveCell,e),!0!==e.cancel&&(o=r.Jl,n=r.Kl,3===t?r.Fx(r.Jl,r.Kl):4===t&&r.Gx(r.Jl,r.Kl),r.Ss(t,o,n)))},Ss:function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x=this,T=x._eventHandler,A=x._modelManager.getSelections(),S=!1;x.Hx||(n=x.Tq(x._getActiveSelectedRange()),(1<A.length||1<ve(n)||1<Ce(n))&&(S=!0),!S&&x.mJb&&x.mJb.mgc(n)&&(S=!0),x.Tr()),r=x.Jl,i=x.Kl,a=x._modelManager.getSpan(r,i),x.Lr=ve(a),x.Mr=Ce(a),x.Hx||(s=x.Jx(r,i),l=x.selectionPolicy(),u=x.selectionUnit(),0!==l&&1!==l||x._modelManager.do("clearSelection"),1===u?(s.col=-1,s.colCount=-1):2===u&&(s.row=-1,s.rowCount=-1),x.Kx(s.row,s.col,ve(s),Ce(s),!1),c=x._modelManager.getSelections(),T.zu(A,c)&&(x.yu(A,c),x.Au(A))),x.Yq(r,i),e===r||(h=x.wq)&&h.Lx(),f=x._render,S?(d=(p=x.am()).zr,g=p.Ar,m=p.width-d,y=p.height-g,f.Mx(d,g,m,y),f.repaint(new Z.Rect(d,g,m,p.Cr)),f.repaint(new Z.Rect(d,g,p.Br,y)),f.Pw(f.bm())):(v=ve(b=x._modelManager.getSpan(e,o)),C=Ce(b),f.im(new Z.Range(r,i,x.Lr,x.Mr).union(new Z.Range(e,o,v,C)))),w={sheet:x,sheetName:x.name(),row:r,col:i},x.Wq(Z.Events.EnterCell,w),x.Wq(Z.Events.FormulatextboxEnterCell,w),T.cs&&T.cs(r,i)},Nx:function(t,e){var o=this.getDataValidator&&this.getDataValidator(t,e),n={sheet:this,sheetName:this.name(),row:t,col:e,validator:o,validationResult:0};return this.Wq(Z.Events.ValidationError,n),n.validationResult}}),Q={},(e.Commands=Q).Ox=function(t,e){return!!t&&2!==t._editorStatus&&(t.yx(e,!1),!0)},Q.Qx=function(t,e,o,n){return!!t&&2!==t._editorStatus&&(t.yx(e,!1,o,n),!0)},Q.Rx=function(t,e,o){return!(!t||2===t._editorStatus||t.endEdit&&!t.endEdit()||(t.Sx(e,o),0))},h="navigationLeft",d="navigationRight",I="navigationUp",N="navigationDown",R="navigationHome2",k="navigationEnd2",E="navigationTop",D="navigationBottom",j="navigationHome",z="navigationFirst",W="navigationEnd",G="navigationLast",U="moveToNextCell",J="moveToPreviousCell",X="navigationPageUp",$="navigationPageDown",tt="navigationPreviousSheet",et="navigationNextSheet",ot="clear",nt="clearAndEditing",rt="commitInputNavigationDown",it="commitInputNavigationUp",at="cancelInput",st="commitArrayFormula",lt="selectionLeft",ut="selectionRight",ct="selectionUp",ht="selectionDown",ft="selectionHome",pt="selectionEnd",dt="selectionPageUp",gt="selectionPageDown",mt="selectionTop",yt="selectionBottom",bt="selectionFirst",vt="selectionLast",Ct="redo",wt="resizeColumn",xt="resizeRow",Tt="splitResizeRow",At="splitResizeColumn",St="autoFitColumn",Mt="autoFitRow",It="editCell",Nt="renameSheet",Rt="clearValues",kt="clipboardPaste",Et="selectNextControl",Dt="selectPreviousControl",jt="moveToNextCellThenControl",_t="moveToPreviousCellThenControl",Ot="changeFormulaReference",Ft="moveSheet",Pt="copySheet",Q.bT=Be,Q.h4=Ve,Q.uv=function(t){var e=Z.Ul.sl(),o=!e,n=e;t.register(h,Q[h],37,!1,!1,!1,!1),t.register(d,Q[d],39,!1,!1,!1,!1),t.register(I,Q[I],38,!1,!1,!1,!1),t.register(N,Q[N],40,!1,!1,!1,!1),t.register(R,Q[R],37,o,!1,!1,n),t.register(k,Q[k],39,o,!1,!1,n),t.register(E,Q[E],38,o,!1,!1,n),t.register(D,Q[D],40,o,!1,!1,n),t.register(j,Q[j],36,!1,!1,!1,!1),t.register(z,Q[z],36,!0,!1,!1,!1),t.register(W,Q[W],35,!1,!1,!1,!1),t.register(G,Q[G],35,!0,!1,!1,!1),t.register(U,Q[U],9,!1,!1,!1,!1),t.register(J,Q[J],9,!1,!0,!1,!1),t.register(X,Q[X],33,!1,!1,!1,!1),t.register($,Q[$],34,!1,!1,!1,!1),t.register(tt,Q[tt],33,o,!1,!1,n),t.register(et,Q[et],34,o,!1,!1,n),t.register(ot,Q[ot],46,!1,!1,!1,!1),t.register(nt,Q[nt],8,!1,!1,!1,!1),t.register(rt,Q[rt],13,!1,!1,!1,!1),t.register(it,Q[it],13,!1,!0,!1,!1),t.register(at,Q[at],27,!1,!1,!1,!1),t.register(st,Q[st],13,!0,!0,!1,!1),t.register(lt,Q[lt],37,!1,!0,!1,!1),t.register(ut,Q[ut],39,!1,!0,!1,!1),t.register(ct,Q[ct],38,!1,!0,!1,!1),t.register(ht,Q[ht],40,!1,!0,!1,!1),t.register(ft,Q[ft],36,!1,!0,!1,!1),t.register(pt,Q[pt],35,!1,!0,!1,!1),t.register(dt,Q[dt],33,!1,!0,!1,!1),t.register(gt,Q[gt],34,!1,!0,!1,!1),t.register(ft,Q[ft],37,o,!0,!1,n),t.register(pt,Q[pt],39,o,!0,!1,n),t.register(mt,Q[mt],38,o,!0,!1,n),t.register(yt,Q[yt],40,o,!0,!1,n),t.register(bt,Q[bt],36,!0,!0,!1,!1),t.register(vt,Q[vt],35,!0,!0,!1,!1),t.register("copy",Q.copy,67,o,!1,!1,n),t.register("cut",Q.cut,88,o,!1,!1,n),t.register("paste",Q.paste,86,o,!1,!1,n),t.register("undo",Q.undo,90,o,!1,!1,n),t.register(Ct,Q.redo,89,o,!1,!1,n),e&&t.register(Ct,Q.redo,90,o,!0,!1,n),t.register(Et,Q[Et]),t.register(Dt,Q[Dt]),t.register(jt,Q[jt]),t.register(_t,Q[_t]),t.register(Ot,Q[Ot]),t.register(wt,Q[wt]),t.register(xt,Q[xt]),t.register(At,Q[At]),t.register(Tt,Q[Tt]),t.register(St,Q[St]),t.register(Mt,Q[Mt]),t.register(It,Q[It]),t.register(Nt,Q[Nt]),t.register("zoom",Q.zoom),t.register(Rt,Q[Rt]),t.register(kt,Q[kt]),t.register(Ft,Q[Ft]),t.register(Pt,Q[Pt])},Lt={256:"bindingPath",4:"comment",2:"formula",16:"sparkline",64:"style",128:"tag",1024:"hyperlink",1:"value"},Ht=".cellEditAction",Q[h]={canUndo:!1,execute:ze(3)},Q[d]={canUndo:!1,execute:ze(4)},Q[I]={canUndo:!1,execute:ze(1)},Q[N]={canUndo:!1,execute:ze(2)},Q[st]={canUndo:!1,execute:function(t,e){var o=Be(t,e),n=Q.Wx;return n&&(o=n.fv(o)),o.fv&&o.fv(),!0}},Q[rt]={canUndo:!1,execute:function(t,e){var o=Be(t,e),n=Q.Wx;return n&&(o=n.Xx(o)),o.yx(2,!1),!0}},Q[it]={canUndo:!1,execute:function(t,e){var o=Be(t,e),n=Q.Wx;return n&&(o=n.Yx(o)),o.yx(1,!1),!0}},Q[j]={canUndo:!1,execute:function(t,e){var o=Be(t,e);return Q.Qx(o,4,H,o.frozenColumnCount()-1)}},Q[R]={canUndo:!1,execute:function(t,e){var o=Be(t,e);return Q.Qx(o,4,H,-1)}},Q[W]={canUndo:!1,execute:function(t,e){var o=Be(t,e);return Q.Qx(o,3,H,be(o)-o.frozenTrailingColumnCount())}},Q[k]={canUndo:!1,execute:function(t,e){var o=Be(t,e);return Q.Qx(o,3,H,be(o))}},Q[E]={canUndo:!1,execute:function(t,e){var o=Be(t,e);return Q.Qx(o,2,-1,H)}},Q[D]={canUndo:!1,execute:function(t,e){var o=Be(t,e);return Q.Qx(o,1,ye(o),H)}},Q[X]={canUndo:!1,execute:function(t,e){var o,n,r,i,a,s=Be(t,e);if(!s||2===s._editorStatus)return!1;if((o=s.Ew())===H||o===s.lq)return!0;if(n=s.Gr(1,3),(r=s._q(s.Jl-n.length))<o&&(r=o),i=Q.Wx){if((a=i.Zx(s,r,o)).r)return!0;s=a.sheet}return!!s.endEdit()&&(s.Qs(r,s.getActiveColumnIndex())&&(s.Jr(r,H),s.Qr=r,s.yx()),s.mq(o,0),!0)}},Q[$]={canUndo:!1,execute:function(t,e){var o,n,r,i,a,s=Be(t,e);if(!s||2===s._editorStatus)return!1;if((o=s.$x())===H||o===s.lq)return!0;if(n=s.Gr(1,3),(r=s.gr(s.Jl+n.length))<o&&(r=o),i=Q.Wx){if((a=i._x(s,r,o)).r)return!0;s=a.sheet}return!!s.endEdit()&&(s.Qs(r,s.getActiveColumnIndex())&&(s.Jr(r,H),s.Qr=r,s.yx()),s.mq(o,0),!0)}},Q[et]={canUndo:!1,execute:function(t,e){Ge(Be(t,e),!0)}},Q[tt]={canUndo:!1,execute:function(t,e){Ge(Be(t,e),!1)}},Q[z]={canUndo:!1,execute:function(t,e){var o,n,r=Be(t,e);if(!r||2===r._editorStatus)return!1;if(o=Q.Wx){if((n=o.ay(r)).r)return!0;r=n.sheet}return r.yx(5,!1,r.Jl,r.Kl),!0}},Q[G]={canUndo:!1,execute:function(t,e){var o,n,r=Be(t,e);if(!r||2===r._editorStatus)return!1;if(o=Q.Wx){if((n=o.by(r)).r)return!0;r=n.sheet}return r.yx(6,!1,r.Jl,r.Kl),!0}},Q[Et]={canUndo:!1,execute:function(t,e){var o=Be(t,e);return!!o.parent&&Je(o,o.parent.nextControl)}},Q[Dt]={canUndo:!1,execute:function(t,e){var o=Be(t,e);return!!o.parent&&Je(o,o.parent.previousControl)}},Q[U]={canUndo:!1,execute:function(t,e){var o=Be(t,e),n=Q.Wx;return n&&(o=n.ey(o)),Ue(o,4),!0}},Q[J]={canUndo:!1,execute:function(t,e){var o=Be(t,e),n=Q.Wx;return n&&(o=n.gy(o)),Ue(o,3),!0}},Q[jt]={canUndo:!1,execute:function(t,e){var o,n=Be(t,e),r=n.Qr,i=n.getActiveColumnIndex();return n.Tx=!0,o=n.hy(n.getActiveRowIndex(),i,!0,r),n.Tx=!1,!o||o.leadingCellRow<r||o.leadingCellRow===r&&i>o.col?Q[Et].execute(t,e):Q[U].execute(t,e)}},Q[_t]={canUndo:!1,execute:function(t,e){var o,n=Be(t,e),r=n.Qr,i=n.getActiveColumnIndex();return n.Tx=!0,o=n.iy(n.getActiveRowIndex(),i,!0,r),n.Tx=!1,!o||o.leadingCellRow>r||o.leadingCellRow===r&&i<o.col?Q[Dt].execute(t,e):Q[J].execute(t,e)}},Q[at]={canUndo:!1,execute:function(t,e){var o,n,r,i,a,s,l,u,c,h=Be(t,e),f=Q.Wx;return f&&(o=f.jy(h)),h.isEditing()?(n=h.Jl,r=h.Kl,i=h.getValue(n,r,3,1),s=(a=h.getCellType(n,r)).getEditorValue(h._editor,t),!!h.endEdit(!0)&&((u=(l=h._modelManager)&&l.ZHb)&&u.getAnchorCell(n,r)||a.isEditingValueChanged(i,s,t)&&h.setValue(n,r,i,3,!0),!0)):P(o)?(Q.Yxb(h.parent),h.uu=H,h.parent.uu.hZ(),(c=h).ex&&c.ex(),void(c.Sob&&c.Sob())):o}},Q.Yxb=function(t){var e,o,n,r=t&&t.sheets;if(r)for(e=0,o=r.length;e<o;e++)(n=r[e])&&n.at&&n.at.ky()},Q[ot]={canUndo:!1,execute:function(t,e){var o,n=Be(t,e);return!n.isEditing()&&(o=n.getSelections(),n.wu().execute({cmd:Rt,sheetName:n.name(),ranges:o}),!0)}},Q[nt]={canUndo:!1,execute:function(t,e){var o=Be(t,e);return!o.isEditing()&&(Z.Ul.sl()?Q[ot].execute(t,e):o.startEdit(!0,""),!0)}},Q.copy={canUndo:!1,execute:function(t,e){var o=Be(t,e),n=e.copyData=o.ux(e.ignoreClipboard);return e.callback&&e.callback(),!n||K}},Q.cut={canUndo:!1,execute:function(t,e){var o=Be(t,e),n=e.cutData=o.sx(e.ignoreClipboard);return e.callback&&e.callback(),!n||K}},Q.paste={canUndo:!1,execute:function(t,e){Be(t,e).vx(e)}},Q[lt]={canUndo:!1,execute:We(37)},Q[ut]={canUndo:!1,execute:We(39)},Q[ct]={canUndo:!1,execute:We(38)},Q[ht]={canUndo:!1,execute:We(40)},Q[ft]={canUndo:!1,execute:We(37,!0)},Q[pt]={canUndo:!1,execute:We(39,!0)},Q[dt]={canUndo:!1,execute:We(33)},Q[gt]={canUndo:!1,execute:We(34)},Q[mt]={canUndo:!1,execute:We(38,!0)},Q[yt]={canUndo:!1,execute:We(40,!0)},Q[bt]={canUndo:!1,execute:We(36,!0)},Q[vt]={canUndo:!1,execute:We(35,!0)},Q[Ot]={canUndo:!1,execute:function(t,e){var o=Be(t,e),n=o&&o._eventHandler;if(n){Se(o);try{n.ly&&n.ly()}finally{Me(o)}}}},Q.undo={canUndo:!1,execute:function(t){var e;!t||(e=t.undoManager())&&e.canUndo()&&e.undo()}},Q.redo={canUndo:!1,execute:function(t){var e;!t||(e=t.undoManager())&&e.canRedo()&&e.redo()}},Q[wt]={canUndo:!0,execute:function(t,e,o){return Ve(t,zt,e,o)}},Q[xt]={canUndo:!0,execute:function(t,e,o){return Ve(t,Wt,e,o)}},Q[At]={canUndo:!0,execute:function(t,e,o){return Ve(t,Gt,e,o)}},Q[Tt]={canUndo:!0,execute:function(t,e,o){return Ve(t,Ut,e,o)}},Q[St]={canUndo:!0,execute:function(t,e,o){return Ve(t,Jt,e,o)}},Q[Mt]={canUndo:!0,execute:function(t,e,o){return Ve(t,Zt,e,o)}},Q[It]={canUndo:!0,execute:function(t,e,o){return Ve(t,qt,e,o)}},Q[Nt]={canUndo:!0,execute:function(t,e,o){return Ve(t,Kt,e,o)}},Q.zoom={canUndo:!0,execute:function(t,e,o){return Ve(t,Yt,e,o)}},Q[Rt]={canUndo:!0,execute:function(t,e,o){return Ve(t,Xt,e,o)}},Q[kt]={canUndo:!0,execute:function(t,e,o){return Ve(t,te,e,o)}},Q[Ft]={canUndo:!1,execute:function(t,e){var o,n=e.sheetName,r=e.targetIndex,i=t.getSheetIndex(n),a=t.WJc(),s=i,l=r,u={sheet:a,sheetName:a.name(),oldIndex:s,newIndex:l,cancel:!1};return t.Wq(Z.Events.SheetMoving,u),!u.cancel&&(o=t.changeSheetIndex(n,r),t.Wq(Z.Events.SheetMoved,{sheet:a,sheetName:a?a.name():H,oldIndex:s,newIndex:l}),o)}},Q[Pt]={canUndo:!1,execute:function(t,e){var o,n=e.sheetName,r=e.targetIndex,i=e.newName,a=e.includeBindingSource,s=t.getSheetFromName(n);t.Wq(Z.Events.SheetChanging,{sheetName:i,propertyName:"insertSheet",cancel:!1,sheetIndex:r}),t.Wq(Z.Events.ActiveSheetChanging,{oldSheet:s,newSheet:o,cancel:!1}),o=t.clone(n,r,i,a),P(o)||(t.Wq(Z.Events.SheetChanged,{sheetName:o.name(),propertyName:"insertSheet",sheetIndex:r}),t.Wq(Z.Events.ActiveSheetChanged,{oldSheet:s,newSheet:o}))}},Ze.prototype.py=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M=this,I=M.my,N=M.kj;if(N&&I){if(t=M.ny,e=I.row,o=I.col,n=ve(I),r=Ce(I),i=M.oy,a=!1,-1===e&&(a=!0,e=0,n=ye(N)),-1===o&&(a=!0,o=0,r=be(N)),l=[],0<(64&t))for(c=0;c<r;c++)l[c]=N.Aj(-1,c)||H;for(h=0;h<n;h++)for(f=e+h,0<(64&t)&&(s=N.Aj(f,-1)||H),p=0;p<r;p++){if(d=void 0,g=o+p,F&&0<(2&t)&&N.getFormulaInformation&&(d=N.getFormulaInformation(f,g)).hasFormula)if(d.isArrayFormula){if((m=d.baseRange).row===f&&m.col===g)for(y=m.row,b=m.row+ve(m);y<b;y++)for(v=m.col,C=m.col+Ce(m);v<C;v++)M.qy(i,y-e,v-o,d,2)}else M.qy(i,h,p,d.formula,2);!(0<(1&t))||d&&d.hasFormula||M.qy(i,h,p,N.getValue(f,g,3),1),0<(16&t)&&N.getSparkline&&(w=N.getSparkline(f,g),x=H,w&&(x=w.data()),w&&x&&M.qy(i,h,p,w,16)),0<(64&t)&&(T=void 0,T=a?N.getActualStyle(f,g,3):(u=N.Aj(f,g)||H,N.getCompositeStyle(f,g,3,u,s,l[p])),A=K,T&&T.toJSON&&(A=JSON.stringify(T.toJSON(3,!0))),M.qy(i,h,p,A,64)),S=N._modelManager.Ky,0<(4&t)&&S&&M.qy(i,h,p,S.get(f,g),4),0<(128&t)&&M.qy(i,h,p,N.getTag(f,g,3),128),0<(256&t)&&M.qy(i,h,p,N.getBindingPath&&N.getBindingPath(f,g,3),256),0<(1024&t)&&M.qy(i,h,p,N.getHyperlink&&N.getHyperlink(h,p,3),1024)}}},Ze.prototype.sy=function(){return this.oy},Ze.prototype.qy=function(t,e,o,n,r){!P(n)&&t&&(t[e]===K&&(t[e]=[]),t[e][o]===K&&(t[e][o]={}),t[e][o][Lt[r]]=n)},Ze.prototype.uy=function(t){var e,o,n,r,i,a,s,l;if(t)for(e=this.oy,o=0,n=t.length;o<n;o++)if(r=t[o])for(i=0,a=r.length;i<a;i++)(s=r[i])&&(e[o]||(e[o]=[]),(l=e[o][i])?this.vy(s,l)&&(e[o][i]=K):e[o][i]=s)},Ze.prototype.vy=function(t,e){var o,n,r,i=this.ny,a=[];for(256&i&&a.push(Lt[256]),4&i&&a.push(Lt[4]),2&i&&a.push(Lt[2]),16&i&&a.push(Lt[16]),64&i&&a.push(Lt[64]),128&i&&a.push(Lt[128]),1024&i&&a.push(Lt[1024]),1&i&&a.push(Lt[1]),o=0,n=a.length;o<n;o++)if(t[r=a[o]]!==e[r])return!1;return!0},Ze.prototype.wy=function(){var t,e,o,n,r,i=this.my.row,a=this.my.col,s=this.oy,l=this.Iu;if(l&&0<l.length)return l;for(l=[],i=-1===i?0:i,a=-1===a?0:a,t=0,e=s.length;t<e;t++)if(o=s[t])for(n=0,r=o.length;n<r;n++)o[n]&&l.push({row:t+i,col:n+a});return this.Iu=l},Bt=Ze,Q.xy=Bt,Q.Bu=function(t,e,o,n,r,i,a,s,l){t&&(e<0&&(e=0,n=ye(t)),o<0&&(o=0,r=be(t)),t.Bu(e,o,n,r,i,a,K,K,s,l))},Q.bWa=function(t){return"changes"+t},Q.cWa=function(t){return t&&(0!==t.length||!m.isEmptyObject(t))},Q.aWa=function(n){var t,e=n.sheetName;return"string"==typeof e?t=[e]:Array.isArray(e)&&(t=e),!!t&&t.every(function(t){var e=Q.bWa(t),o=n[e];return o&&0===o.length&&m.isEmptyObject(o)})},Q.startTransaction=function(t,e){qe(t,e.sheetName).forEach(function(t){t._modelManager.startTransaction()})},Q.endTransaction=function(t,o){qe(t,o.sheetName).forEach(function(t){var e=Q.bWa(t.name());o[e]=t._modelManager.endTransaction()})},Q.undoTransaction=function(t,o){qe(t,o.sheetName).forEach(function(t){var e=Q.bWa(t.name());t._modelManager.undo(o[e]),t.$p()})},Q.Zxb=function(t){t.forEach(function(t){t._modelManager.startTransaction()})},Q.$xb=function(t,o){t.forEach(function(t){var e=Q.bWa(t.name());o[e]=t._modelManager.endTransaction()})},Q._xb=function(t,o){t.forEach(function(t){var e=Q.bWa(t.name());t._modelManager.undo(o[e])})},Qe.prototype.execute=function(){},Qe.prototype.canExecute=function(){return!0},Qe.prototype.canUndo=function(){return!0},Qe.prototype.undo=function(){return!0},Vt=Qe,Q.ActionBase=Vt,me(ro,le=Vt),ro.prototype.execute=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d=!1;if(this.canExecute()&&(t=this.VQ,e=this.kj,o=t.columns,n=t.rowHeader,r=o&&o.length,e&&0<r)){if(i=this.Sz(o),a={sheet:e,sheetName:e.name(),colList:i,header:n,cancel:!1},e.Wq(y,a),!0===a.cancel)return d;t.Tz=!0,e._modelManager.startTransaction(),Ke(e);try{for(s=be(e,n?2:3),e.qq=t.qq,l=t.size,u=0;u<r;u++)for(h=(c=o[u]).firstCol,f=c.lastCol,p=h;p<=f;p++)0<=p&&p<s&&(n&&e.getColumnResizable(p,2)&&l!==e.$r(p,2)?(e.setColumnWidth(p,l,2),d=!0):!n&&e.getColumnResizable(p,3)&&l!==e.$r(p,3)&&(e.setColumnWidth(p,l,3),d=!0))}finally{Ne(e),m[m.sd]({tc:e.parent}),e.Wq(b,{sheet:e,sheetName:e.name(),colList:i,header:t.rowHeader}),Me(e),t[Q.bWa(e.name())]=e._modelManager.endTransaction()}e.qs()}return d},ro.prototype.undo=function(){var t,e,o,n,r,i,a,s,l=!1;if(this.canUndo()&&(t=this.VQ,e=this.kj,o=t.columns,n=t.rowHeader,r=o&&o.length,e&&0<r)){if(i=this.Sz(o),a={sheet:e,sheetName:e.name(),colList:i,header:n,cancel:!1},e.Wq(y,a),!0===a.cancel)return l;Ke(e);try{s=Q.bWa(e.name()),e._modelManager.undo(t[s]),e.oq=!0,e.showCell(e.getActiveRowIndex(),e.getActiveColumnIndex(),1,1),l=!0}finally{Ne(e),m[m.sd]({tc:e.parent}),e.Wq(b,{sheet:e,sheetName:e.name(),colList:i,header:t.rowHeader}),Me(e)}}return l},ro.prototype.Sz=function(t){var e,o,n,r,i,a,s=[];for(e=0,o=t.length;e<o;e++)for(r=(n=t[e]).firstCol,i=n.lastCol,a=r;a<=i;a++)s.push(a);return s},ro.prototype.canUndo=function(){return this.VQ.Tz},zt=ro,me(no,se=Vt),no.prototype.execute=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d=!1;if(this.canExecute()&&(t=this.kj,n=(o=(e=this.VQ).rows)&&o.length,t&&0<n)){if(r=this.Vz(o),i={sheet:t,sheetName:t.name(),rowList:r,header:e.columnHeader,cancel:!1},t.Wq(v,i),!0===i.cancel)return d;e.Tz=!0,t._modelManager.startTransaction(),Ke(t);try{for(s=ye(t,(a=e.columnHeader)?1:3),t.lq=e.lq,l=e.size,u=0;u<n;u++)for(h=(c=o[u]).firstRow,f=c.lastRow,p=h;p<=f;p++)0<=p&&p<s&&(a&&t.getRowResizable(p,1)&&l!==t.Yr(p,1)?(t.setRowHeight(p,l,1),d=!0):!a&&t.getRowResizable(p,3)&&l!==t.Yr(p,3)&&(t.setRowHeight(p,l,3),d=!0))}finally{Ne(t),m[m.sd]({tc:t.parent}),t.Wq(A,{sheet:t,sheetName:t.name(),rowList:r,header:e.columnHeader}),Me(t),e[Q.bWa(t.name())]=t._modelManager.endTransaction()}t.os()}return d},no.prototype.undo=function(){var t,e,o,n,r,i,a,s=!1;if(this.canUndo()&&(t=this.kj,n=(o=(e=this.VQ).rows)&&o.length,t&&0<n)){if(r=this.Vz(o),i={sheet:t,sheetName:t.name(),rowList:r,header:e.columnHeader,cancel:!1},t.Wq(v,i),!0===i.cancel)return s;Ke(t);try{a=Q.bWa(t.name()),t._modelManager.undo(e[a]),t.jq=!0,t.showCell(t.getActiveRowIndex(),t.getActiveColumnIndex(),1,1),s=!0}finally{Ne(t),m[m.sd]({tc:t.parent}),t.Wq(A,{sheet:t,sheetName:t.name(),rowList:r,header:e.columnHeader}),Me(t)}}return s},no.prototype.Vz=function(t){var e,o,n,r,i,a,s=[];for(e=0,o=t.length;e<o;e++)for(r=(n=t[e]).firstRow,i=n.lastRow,a=r;a<=i;a++)s.push(a);return s},no.prototype.canUndo=function(){return this.VQ.Tz},Wt=no,me(oo,ae=Vt),oo.prototype.execute=function(){var t,e,o,n,r,i,a,s=!1,l=this.VQ,u=this.kj,c=l.columns,h=l.rowHeader,f=this.Sz(c);if(u&&c&&0<c.length){if(t={sheet:u,sheetName:u.Cj,colList:f,header:h,cancel:!1},u.Wq(y,t),!0===t.cancel)return s;u._modelManager.startTransaction(),this.Lz(u);try{e=p(l.size),o=h?2:3,n=c[0].firstCol,a=i=void 0,e!==(r=u.$r(n,o))&&(i=e-r,a=u.Zq(n,o),u.setColumnWidth(n,e,o),u.setColumnWidth(a,u.$r(a,o)-i,o)),s=!0}finally{Ne(u),m[m.sd]({tc:u.parent}),u.Wq(b,{sheet:u,sheetName:u.Cj,colList:f,header:l.rowHeader}),Me(u),l[Q.bWa(u.name())]=u._modelManager.endTransaction()}}return s},oo.prototype.undo=function(){var t,e=this.kj,o=this.VQ.columns,n=!1,r=this.VQ,i=this.VQ.rowHeader,a=this.Sz(o),s={sheet:e,sheetName:e.Cj,colList:a,header:i,cancel:!1};if(e.Wq(y,s),!0===s.cancel)return n;Ke(e);try{t=Q.bWa(e.name()),e._modelManager.undo(r[t]),n=!0}finally{Ne(e),m[m.sd]({tc:e.parent}),e.Wq(b,{sheet:e,sheetName:e.Cj,colList:a,header:r.rowHeader}),Me(e)}return n},oo.prototype.Sz=function(t){var e,o,n,r,i,a,s=[];for(e=0,o=t.length;e<o;e++)for(r=(n=t[e]).firstCol,i=n.lastCol,a=r;a<=i;a++)s.push(a);return s},Gt=oo,me(eo,ie=Vt),eo.prototype.execute=function(){var t,e,o,n,r,i,a,s=!1,l=this.VQ,u=this.kj,c=l.rows,h=l.columnHeader,f=this.Vz(c);if(u&&c&&0<c.length){if(t={sheet:u,sheetName:u.Cj,rowList:f,header:h,cancel:!1},u.Wq(v,t),!0===t.cancel)return s;u._modelManager.startTransaction(),this.Lz(u);try{e=p(l.size),o=h?1:3,n=c[0].firstRow,a=i=void 0,e!==(r=u.Yr(n,o))&&(i=e-r,a=u._q(n,o),u.setRowHeight(n,e,o),u.setRowHeight(a,u.Yr(a,o)-i,o)),s=!0}finally{Ne(u),m[m.sd]({tc:u.parent}),u.Wq(A,{sheet:u,sheetName:u.Cj,rowList:f,header:l.columnHeader}),Me(u),l[Q.bWa(u.name())]=u._modelManager.endTransaction()}}return s},eo.prototype.undo=function(){var t,e=this.kj,o=this.VQ.rows,n=!1,r=this.VQ,i=this.VQ.columnHeader,a=this.Vz(o),s={sheet:e,sheetName:e.Cj,rowList:a,header:i,cancel:!1};if(e.Wq(v,s),!0===s.cancel)return n;Ke(e);try{t=Q.bWa(e.name()),e._modelManager.undo(r[t]),n=!0}finally{Ne(e),m[m.sd]({tc:e.parent}),e.Wq(A,{sheet:e,sheetName:e.Cj,rowList:a,header:r.columnHeader}),Me(e)}return n},eo.prototype.Vz=function(t){var e,o,n,r,i,a,s=[];for(e=0,o=t.length;e<o;e++)for(r=(n=t[e]).firstRow,i=n.lastRow,a=r;a<=i;a++)s.push(a);return s},Ut=eo,me(to,re=Vt),to.prototype.canExecute=function(){var t=this.VQ;return this.kj&&t.columns&&0<t.columns.length},to.prototype.execute=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d=!1;if(this.canExecute()){if(t=this.VQ,e=this.kj,o=this.Wz,n=this.Sz(t.columns),r=2===o,i={sheet:e,sheetName:e.name(),colList:n,header:r,cancel:!1},e.Wq(y,i),!0===i.cancel)return d;for(t.Tz=!0,s=(a=be(e,o))-1,u=void(l=0),c=0,h=t.columns.length;c<h;c++)s=(u=t.columns[c].col)<s?u:s,l=l<u?u:l;Z.mn.qn(e,0,s,ye(e)-1,l),e._modelManager.startTransaction(),Ke(e);try{for(f=void 0,c=0,h=t.columns.length;c<h;c++)0<=(p=t.columns[c].col)&&p<a&&e.getColumnResizable(p,o)&&((f=this.xl(p))===e.getColumnWidth(p,o)&&P(e.getColumnWidth(p,o,!0))||(e.setColumnWidth(p,f,o),d=!0))}finally{Z.mn.Nm(),Ne(e),m[m.sd]({tc:e.parent}),e.Wq(b,{sheet:e,sheetName:e.name(),colList:n,header:r}),Me(e),t[Q.bWa(e.name())]=e._modelManager.endTransaction()}}return d},to.prototype.undo=function(){var t,e,o,n,r,i,a,s=!1;if(this.canUndo()){if(t=this.VQ,e=this.kj,o=this.Wz,n=this.Sz(t.columns),r=2===o,i={sheet:e,sheetName:e.name(),colList:n,header:r,cancel:!1},e.Wq(y,i),!0===i.cancel)return s;Ke(e);try{a=Q.bWa(e.name()),e._modelManager.undo(t[a]),s=!0}finally{Ne(e),m[m.sd]({tc:e.parent}),e.Wq(b,{sheet:e,sheetName:e.name(),colList:n,header:r}),Me(e)}}return s},to.prototype.Sz=function(t){var e,o,n=[];for(e=0;e<t.length;e++)o=t[e],n.push(o.col);return n},to.prototype.xl=function(t){return Z.Ul.xl(t,this.kj,this.Wz,this.VQ.autoFitType)},to.prototype.canUndo=function(){return this.VQ.Tz},Jt=to,me($e,ne=Vt),$e.prototype.canExecute=function(){var t=this.VQ;return this.kj&&t.rows&&0<t.rows.length},$e.prototype.execute=function(){var t,e,o,n,r,i,a,s,l,u,c,h=!1;if(this.canExecute()){if(t=this.VQ,e=this.kj,o=this.Vz(t.rows),n=this.Wz,r=1===this.Wz,i={sheet:e,sheetName:e.name(),rowList:o,header:r,cancel:!1},e.Wq(v,i),!0===i.cancel)return h;t.Tz=!0,e._modelManager.startTransaction(),Ke(e);try{for(a=ye(e,n),s=void 0,l=0,u=t.rows.length;l<u;l++)0<=(c=t.rows[l].row)&&c<a&&e.getRowResizable(c,n)&&((s=this.Fl(c))===e.getRowHeight(c,n)&&P(e.getRowHeight(c,n,!0))||(e.setRowHeight(c,s,n),h=!0))}finally{Ne(e),m[m.sd]({tc:e.parent}),e.Wq(A,{sheet:e,sheetName:e.name(),rowList:o,header:r}),Me(e),t[Q.bWa(e.name())]=e._modelManager.endTransaction()}}return h},$e.prototype.undo=function(){var t,e,o,n,r,i,a=!1;if(this.canUndo()){if(t=this.VQ,e=this.kj,o=this.Vz(t.rows),n=1===this.Wz,r={sheet:e,sheetName:e.name(),rowList:o,header:n,cancel:!1},e.Wq(v,r),!0===r.cancel)return a;Ke(e);try{i=Q.bWa(e.name()),e._modelManager.undo(t[i]),a=!0}finally{Ne(e),m[m.sd]({tc:e.parent}),e.Wq(A,{sheet:e,sheetName:e.name(),rowList:o,header:n}),Me(e)}}return a},$e.prototype.Vz=function(t){var e,o,n,r=[];for(e=0,o=t.length;e<o;e++)n=t[e],r.push(n.row);return r},$e.prototype.Fl=function(t){return Z.Ul.Fl(t,this.kj,this.Wz,this.VQ.autoFitType)},$e.prototype.canUndo=function(){return this.VQ.Tz},Zt=$e,me(ao,ue=Vt),ao.prototype.canExecute=function(){var t,e,o=this.kj,n=this.VQ,r=n.ranges,i=n.row,a=n.col;if(r){for(t=0;t<r.length;t++)if(e=r[t],!o.Y3(e.row,e.col,ve(e),Ce(e)))return!1}else if(!o.Y3(i,a,1,1))return!1;return!0},ao.prototype.yA=function(t){var e,o,n,r,i=this.VQ,a=i.ranges;if(a)for(e=0;e<a.length;e++)for(n=(o=a[e]).row;n<o.row+ve(o);n++)for(r=o.col;r<o.col+Ce(o);r++)t(n,r);else t(i.row,i.col)},ao.prototype.undo=function(){var o,t,e;if(this.canUndo()){o=this.kj,t=this.VQ,Ke(o,!0);try{o._bind(a+Ht,function(t,e){io(o,e)}),e=Q.bWa(o.name()),o._modelManager.undo(t[e])}catch(o){return!1}finally{o._unbind(a+Ht),Ye(o,!0)}return!0}return!1},ao.prototype.execute=function(){var o,t,e=!1;if(this.canExecute()){(o=this.kj)._modelManager.startTransaction(),Ke(o,!0);try{o._bind(a+Ht,function(t,e){io(o,e)}),this.VQ.applyResult=this.AA(),e=!0}catch(o){e=!1}finally{o._unbind(a+Ht),t=Q.bWa(o.name()),this.VQ[t]=o._modelManager.endTransaction(),Ye(o,!0)}}return e},ao.prototype.zA=function(t,e){return t+"_"+e},ao.prototype.BA=function(t){var e,o,n,r,i,a=0,s=this.kj,l=this.VQ,u=l.row,c=l.col,h=l.newValue,f=!l.hasOwnProperty("autoFormat")||l.autoFormat;return F&&h&&0<h.length&&"="===h[0]?s.getDataValidator&&s.getDataValidator(u,c)&&""!==(e=h.substring(1))&&e!==s.getFormula(u,c)&&(o=s.Cf())&&(n=o.parse(s.yj(),e,0<=u?u:0,0<=c?c:0,!0))&&(r=o._evaluateParsedFormula(s.yj(),n,{row:u,col:c}),s.isValid&&!s.isValid(u,c,r)&&(a=s.Nx(u,c))):(i=this.CA(u,c,h,f,t),!s.isValid||s.isValid(u,c,i)||(a=s.Nx(u,c),s._eventHandler.DA=!0)),a},ao.prototype.AA=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d=this.kj,g=this.VQ,m=g.newValue,y=g.ignoreValidate,b={tka:!1,uka:!1,_autoFormatter:K,quotePrefix:K},v=0;if(!0!==y&&(1===(v=this.BA(b))||2===v))return v;if(e=!g.hasOwnProperty("autoFormat")||g.autoFormat,o=0<=(o=g.row)?o:0,n=0<=(n=g.col)?n:0,F&&x&&x.Parser)if(a=d.Cf(),l=(s=d.parent)&&s.options.allowUserEditFormula,"@"!==d.getFormatter(o,n)&&l&&a&&m&&0<m.length&&"="===m[0])try{if(g.ranges&&1===g.endEditType)return i=g.ranges[0],d.setArrayFormula(i.row,i.col,ve(i),Ce(i),m.substring(1)),v;r=a.parse(d.yj(),m.substring(1),o,n,!0)}catch(t){throw d.Os(0,"string"==typeof t?t:t.message),t}else g.ranges&&1===g.endEditType&&(i=g.ranges[0],d.getRange(i.row,i.col,ve(i),Ce(i),3).clear(1));return r||(m&&"'"===m[0]?this.Uia(o,n,!0,b):this.Uia(o,n,K,b),t=this.CA(o,n,m,e,b)),this.yA(function(e,o){if(r)try{d._u(e,o,a.unparse(d.yj(),r,e,o),r),d.Wq(Z.Events.UserFormulaEntered,{sheet:d,sheetName:d.name(),row:e,col:o,isCircularReference:d.ngc(e,o),formula:m.substring(1).toUpperCase()})}catch(t){throw d.Os(0,"string"==typeof t?t:t.message),t}else{try{d.hasFormula&&d.hasFormula(e,o)&&d.setFormula(e,o,H)}catch(t){throw d.Os(0,"string"==typeof t?t:t.message),t}try{d.uq(e,o,t,g.sheetArea),"string"!=typeof t&&null!==t||w.Worksheet.ao(d,"setHyperlinkWhenEditing",{url:t,row:e,col:o,sheetArea:g.sheetArea})}catch(t){d.setValue(e,o,m)}}}),c=b.uka,((u=b.tka)||c)&&(f="string"==typeof(h=d.Aj(o,n)),h&&!f||(p=new C.Style,f&&(p.parentName=h),h=p),u&&(h._autoFormatter=b._autoFormatter),c&&(h.quotePrefix=b.quotePrefix),d.setStyle(o,n,h)),v},ao.prototype.canUndo=function(){return 0===this.VQ.applyResult},ao.prototype.CA=function(t,e,o,n,r){var i,a,s,l=this.kj,u=this.VQ,c=u.ignoreFormatting,h=l.getActualStyle(t,e),f={};return i="string"!=typeof o||c?o:o&&"'"===o[0]?o.substring(1):Z.Ul.ul(h,o,n,f,u.editingFormatter),r.quotePrefix?(r._autoFormatter=K,r.tka=!0):(a=f.value,n&&a&&((i===(s=H)||"General"===a.formatString())&&h._autoFormatter||(a.isAuto=!0,s=a),s&&(r.tka=!0,r._autoFormatter=s))),i},ao.prototype.Uia=function(t,e,o,n){var r,i=this.kj.Aj(t,e),a="string"==typeof i;i&&!a||(r=new C.Style,a&&(r.parentName=i),i=r),i.quotePrefix!==o&&(n.uka=!0,n.quotePrefix=o)},qt=ao,me(uo,he=Vt),uo.prototype.canUndo=function(){return!!this.VQ.FA},uo.prototype.canExecute=function(){var t=this.VQ;return this.kj&&t.name&&t.name!==t.FA},uo.prototype.execute=function(){var t,e,o,n,r=this.kj,i=this.VQ,a=i.name,s=!1;return this.canExecute()&&(t=r.name(),o={sheet:r,oldValue:t,newValue:e=a,cancel:!1},r.Wq(Z.Events.SheetNameChanging,o),!1===o.cancel&&(i.FA=t,r._modelManager.startTransaction(),Ke(r,!0),Re(r),r.cq(a),so(r),i[Q.bWa(r.name())]=r._modelManager.endTransaction(),s=!0,i.sheetName=a,ke(r,!1),Ye(r,!0),n={sheet:r,oldValue:t,newValue:e},r.Wq(Z.Events.SheetNameChanged,n))),s},uo.prototype.undo=function(){var t,e,o,n,r,i,a;return!(!this.canUndo()||(r={sheet:t=this.kj,oldValue:o=(e=this.VQ).name,newValue:n=e.FA,cancel:!1},t.Wq(Z.Events.SheetNameChanging,r),!1!==r.cancel)||(Ke(t,!0),Re(t),i=Q.bWa(t.name()),t._modelManager.undo(e[i]),so(t),e.sheetName=e.FA,ke(t,!1),Ye(t,!0),a={sheet:t,oldValue:o,newValue:n},t.Wq(Z.Events.SheetNameChanged,a),0))},Kt=uo,me(lo,ce=Vt),lo.prototype.canExecute=function(){return this.kj&&this.kj.parent.options.allowUserZoom&&this.kj.zoom()!==this.VQ.zoomFactor},lo.prototype.execute=function(){var t,e,o,n,r,i=this.VQ,a=!1;return this.canExecute()&&(e=(t=this.kj)._modelManager,o=i.zoomFactor,e.startTransaction(),r=o,a=!(!0===(n=t).isEditing()&&!n.endEdit()||(n.suspendPaint(),n.zoom(r),n.resumePaint(),0)),e.ZVa(["zoomChanged",o,i.oldZoomFactor]),i[Q.bWa(t.name())]=t._modelManager.endTransaction()),a},lo.prototype.undo=function(){var t,e=this.kj;if(this.canUndo())return!(!0===e.isEditing()&&!e.endEdit()||(e.suspendPaint(),t=Q.bWa(e.name()),e._modelManager.undo(this.VQ[t]),e.resumePaint(),0))},Yt=lo,me(po,ge=Vt),po.prototype.execute=function(){var t,e,o,n,r,i,a,s,l,u;this.canExecute()&&(t=this.kj,e=this.VQ.clearRange,o=t.tables&&t.tables.$Hb&&t.tables.$Hb(e.row,e.col,e.rowCount,e.colCount),t.isDirtySuspended()||(this.VQ.Iu=new Bt(t,t.Tq(e),3)),o&&0<o.length&&(this.VQ.tableNames=o),r=(n=t.Tq(e)).row,i=n.col,a=ve(n),0<(s=Ce(n))&&0<a&&(t._modelManager.startTransaction(),Ke(t),t.vxb=!0,t.cg(r,i,a,s,3,1,!0),Ye(t),t.vxb=!1,l=Q.bWa(t.name()),this.VQ[l]=t._modelManager.endTransaction(),u=this.VQ.Iu,Q.Bu(t,r,i,a,s,u?u.wy():[],2,o)))},po.prototype.canExecute=function(){var t=this.VQ.clearRange;return this.kj.Y3(t.row,t.col,ve(t),Ce(t))},po.prototype.canUndo=function(){var t=Q.bWa(this.kj.name()),e=this.VQ[t];return Q.cWa(e)},po.prototype.undo=function(){var t,e,o,n=this.kj;if(this.canUndo()&&n&&0<Ce(t=n.Tq(this.VQ.clearRange))&&0<ve(t)){Ke(n);try{e=Q.bWa(n.name()),n._modelManager.undo(this.VQ[e])}finally{Ye(n)}return o=this.VQ.Iu,Q.Bu(n,t.row,t.col,ve(t),Ce(t),o?o.wy():[],2,this.VQ.tableNames,!0),!0}return!1},Qt=po,me(fo,de=Vt),fo.prototype.canExecute=function(){var t,e=this.VQ.MA;if(e){for(t=0;t<e.length;t++)if(!e[t].canExecute())return!1;return!0}return!1},fo.prototype.execute=function(){var t,e,o;if(this.canExecute()&&(t=this.VQ.MA,e=this.kj,t)){for(Ke(e,!0),o=0;o<t.length;o++)t[o].execute();return Ye(e,!0),!0}return!1},fo.prototype.canUndo=function(){var t,e=this.VQ.MA;if(e){for(t=0;t<e.length;t++)if(!e[t].canUndo())return!1;return!0}return!1},fo.prototype.undo=function(){var t,e,o,n,r=this.VQ.MA;if(this.canUndo()){for(t=this.kj,e=r.length-1;0<=e;e--)if(o=r[e],Ke(t,!0),n=o.undo(),Ye(t,!0),!n)return!1;return!0}return!1},Xt=fo,Q.OA=Xt,me(ho,pe=Vt),ho.qx=function(t){var e=0;return 0!==t&&1!==t||(e|=1),0!==t&&2!==t||(e|=64,e|=32,e|=512),0!==t&&3!==t||(e|=2),0!==t&&4!==t||(e|=1,e|=64,e|=32),0!==t&&5!==t||(e|=64,e|=32,e|=2),0===t&&(e|=32,e|=16,e|=256,e|=4,e|=512,e|=128,e|=1024),e},ho.prototype.canExecute=function(){var t=this.VQ,e=t.pasteExtent,o=e.targetRange,n=e.sourceRange;return t.toSheet.Y3(o.row,o.col,ve(o),Ce(o))&&(!e.isCutting||t.fromSheet.Y3(n.row,n.col,ve(n),Ce(n)))},ho.prototype.oUa=function(){var t=this.VQ.pasteExtent,e=this.VQ.io={},o=t.isCutting,n=ho.qx(this.VQ.pasteOption),r=t.sourceRange,i=t.targetRange,a=this.VQ.fromSheet,s=this.VQ.toSheet;a&&r&&o&&!a.isDirtySuspended()&&(e.cA=new Bt(a,r,n)),s.isDirtySuspended()||(e.fA=new Bt(s,i,n))},ho.prototype.VA=function(){return this.VQ.pasteExtent.targetRange},ho.prototype._Hb=function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y,b=!1,v=e.row,C=e.col,w=e.rowCount,x=e.colCount,T=!1,A=!1,S=!1,M=!1,I=we(r),N=!1,R=!1,k=r.KLc(),E=r.getRowCount(),D=r.getColumnCount(),j=w,_=x,O=0,F=0,P=0,L=0;if(k&&(j-=r.NLc(v,j,!0),_-=r.NLc(C,_)),t||j%o.rowCount!=0&&_%o.colCount!=0){if(n===q.InsertShiftCell.right){if(f=o.rowCount,p=void 0,i=v,s=o.rowCount,k&&(f+=p=r.MLc(v,f),s+=p),v!==o.row&&o.intersect(v,C,f,r.getColumnCount()-C))return r.Os(1,Y().Exp_InsertCopiedCutCells),{returnFunc:R=!0};if(C>o.col&&C<=o.col+o.colCount-1&&v>o.row&&v<=o.row+o.rowCount-1)return r.Os(1,Y().Exp_InsertCopiedCutCells),{returnFunc:R=!0};if(this.aIb(r,v,C,f,r.getColumnCount()-C))return r.Os(1,Y().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:R=!0};if(v===o.row&&C<=o.col&&(k?(o.col+=o.colCount,o.col=r.Zq(o.col-1),F=r.MLc(o.col,o.colCount),o.colCount+=F):o.col=o.col+o.colCount,T=!0),a=r.getColumnCount()-o.colCount,l=o.colCount,k&&(L=r.MLc(C,o.colCount),a=D-(l=(d=o.colCount+L)+r.OLc(D-1,d)),T&&(o.col+=L)),(N=this.bIb(r,i,a,s,l))&&!I)return r.Os(1,Y().Exp_InsertCopiedCutCellsNoRange),{returnFunc:R=!0}}else if(n===q.InsertShiftCell.down){if(g=o.colCount,m=void 0,a=C,l=o.colCount,k&&(g+=m=r.MLc(C,g),l+=m),C!==o.col&&o.intersect(v,C,r.getRowCount()-v,g))return r.Os(1,Y().Exp_InsertCopiedCutCells),{returnFunc:R=!0};if(v>o.row&&v<=o.row+o.rowCount-1&&C>o.col&&C<=o.col+o.colCount-1)return r.Os(1,Y().Exp_InsertCopiedCutCells),{returnFunc:R=!0};if(this.cIb(r,v,C,r.getRowCount()-v,g))return r.Os(1,Y().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:R=!0};if(C===o.col&&v<=o.row&&(k?(o.row=o.row+o.rowCount,o.row=r._q(o.row-1),O=r.MLc(o.row,o.rowCount,!0),o.rowCount+=O):o.row=o.row+o.rowCount,A=!0),i=E-o.rowCount,s=o.rowCount,k&&(P=r.MLc(v,o.rowCount,!0),i=E-(s=(y=o.rowCount+P)+r.OLc(E-1,y,!0)),A&&(o.row+=P)),(N=this.bIb(r,i,a,s,l))&&!I)return r.Os(1,Y().Exp_InsertCopiedCutCellsNoRange),{returnFunc:R=!0}}}else if(c=u=0,j%o.rowCount==0&&_%o.colCount!=0?(x=e.colCount=o.colCount,k&&(x+=u=r.MLc(C,x),e.colCount=x)):j%o.rowCount!=0&&_%o.colCount==0&&(w=e.rowCount=o.rowCount,k&&(w+=c=r.MLc(v,w,!0),e.rowCount=w)),b=!0,n===q.InsertShiftCell.right){if(h=!1,v<=o.row&&v+w>=o.row+o.rowCount&&(h=!0),C>o.col&&C<=o.col+o.colCount-1&&v>o.row&&v<=o.row+o.rowCount-1)return r.Os(1,Y().Exp_InsertCopiedCutCells),{returnFunc:R=!0};if(!h&&o.intersect(v,C,w,r.getColumnCount()-C))return r.Os(1,Y().Exp_InsertCopiedCutCells),{returnFunc:R=!0};if(this.aIb(r,v,C,w,r.getColumnCount()-C))return r.Os(1,Y().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:R=!0};if(h&&C<=o.col&&(k?(o.col+=x,o.col=r.Zq(o.col-1),F=r.MLc(o.col,x),o.colCount+=F):o.col+=x,S=!0),i=v,s=w,a=r.getColumnCount()-x,l=x,k&&(a=D-(l=x+(L=r.OLc(D-1,x))+u)),(N=this.bIb(r,i,a,s,l))&&!I)return r.Os(1,Y().Exp_InsertCopiedCutCellsNoRange),{returnFunc:R=!0}}else if(n===q.InsertShiftCell.down){if(h=!1,C<=o.col&&C+x>=o.col+o.colCount&&(h=!0),v>o.row&&v<=o.row+o.rowCount-1&&C>o.col&&C<=o.col+o.colCount-1)return r.Os(1,Y().Exp_InsertCopiedCutCells),{returnFunc:R=!0};if(!h&&o.intersect(v,C,r.getRowCount()-v,x))return r.Os(1,Y().Exp_InsertCopiedCutCells),{returnFunc:R=!0};if(this.cIb(r,v,C,r.getRowCount()-v,x))return r.Os(1,Y().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:R=!0};if(h&&v<=o.row&&(k?(o.row+=w,o.row=r._q(o.row-1),O=r.MLc(o.row,w,!0),o.rowCount+=O):o.row+=w,M=!0),i=r.getRowCount()-w,s=w,a=C,l=x,k&&(i=E-(s=w+(P=r.OLc(E-1,w,!0))+c)),(N=this.bIb(r,i,a,s,l))&&!I)return r.Os(1,Y().Exp_InsertCopiedCutCellsNoRange),{returnFunc:R=!0}}return{changePasteDataRangeCol:T,changePasteDataRangeRow:A,changePasteDataRangeCols:S,changePasteDataRangeRows:M,moveRangeHaveValue:N,returnFunc:R,selectRange:b,changePasteDataRangeRowInvisibleCount:O,changePasteDataRangeColInvisibleCount:F,invisibleRowCountInAcRange:P,invisibleColCountInAcRange:L}},ho.prototype.dIb=function(t,e,o,n,r,i,a,s,l){var u,c,h,f,p,d,g,m,y,b,v,C,w=!1,x=!1,T=o.KLc();if(t){if(e===q.InsertShiftCell.right)if(o.Vq(i,a+l,s,o.getColumnCount()-a-l,!0))if(a+l<o.getColumnCount()){if(T)if(u=s,c=l+o.OLc(o.getColumnCount()-1,l),i<0)o.moveTo(i,a,i,a+l,s,o.getColumnCount()-a-l,1023,!0);else for(h=i;h<i+u&&h<o.getRowCount();h++)0!==o.getRowHeight(h)&&o.moveTo(h,a,h,a+l,1,o.getColumnCount()-a-c,1023,!0);else o.moveTo(i,a,i,a+l,s,o.getColumnCount()-a-l,1023,!0);(p=(f=o.rowFilter())&&f.range)&&-1===i&&1<p.colCount&&a>p.col&&a<=p.col+p.colCount-1&&(p.colCount=p.colCount+r.colCount)}else a+l>o.getColumnCount()&&(x=w=!0);else x=w=!0;else if(e===q.InsertShiftCell.down)if(o.Vq(i+s,a,o.getRowCount()-i-s,l,!0))if(i+s<o.getRowCount())if(T)if(d=l,g=s+o.OLc(o.getRowCount()-1,s,!0),a<0)o.moveTo(i,a,i+s,a,o.getRowCount()-i-g,r.colCount,1023,!0);else for(m=a;m<a+d&&m<o.getColumnCount();m++)0!==o.getColumnWidth(m)&&o.moveTo(i,m,i+s,m,o.getRowCount()-i-g,1,1023,!0);else o.moveTo(i,a,i+s,a,o.getRowCount()-i-s,l,1023,!0);else i+s>o.getRowCount()&&(x=w=!0);else x=w=!0}else if(e===q.InsertShiftCell.right)if(o.Vq(i,a+r.colCount,r.rowCount,o.getColumnCount()-a-r.colCount,!0))if(a+r.colCount<o.getColumnCount()){if(T)if(y=r.rowCount,c=(b=r.colCount+o.MLc(a,r.colCount))+o.OLc(o.getColumnCount()-1,b),i<0)o.moveTo(i,a,i,a+b,r.rowCount,o.getColumnCount()-a-c,1023,!0);else for(h=i;h<i+y&&h<o.getRowCount();h++)0!==o.getRowHeight(h)?o.moveTo(h,a,h,a+b,1,o.getColumnCount()-a-c,1023,!0):y++;else o.moveTo(i,a,i,a+r.colCount,r.rowCount,o.getColumnCount()-a-r.colCount,1023,!0);(p=(f=o.rowFilter())&&f.range)&&-1===i&&1<p.colCount&&a>p.col&&a<=p.col+p.colCount-1&&(p.colCount=p.colCount+r.colCount)}else a+r.colCount>o.getColumnCount()&&(x=w=!0);else x=w=!0;else if(e===q.InsertShiftCell.down)if(o.Vq(i+r.rowCount,a,o.getRowCount()-i-r.rowCount,r.colCount,!0))if(i+r.rowCount<o.getRowCount())if(T)if(v=r.colCount,g=(C=r.rowCount+o.MLc(i,r.rowCount,!0))+o.OLc(o.getRowCount()-1,C,!0),a<0)o.moveTo(i,a,i+C,a,o.getRowCount()-i-g,r.colCount,1023,!0);else for(m=a;m<a+v&&m<o.getColumnCount();m++)0!==o.getColumnWidth(m)?o.moveTo(i,m,i+C,m,o.getRowCount()-i-g,1,1023,!0):v++;else o.moveTo(i,a,i+r.rowCount,a,o.getRowCount()-i-r.rowCount,r.colCount,1023,!0);else i+r.rowCount>o.getRowCount()&&(x=w=!0);else x=w=!0;return{raiseInvalidOperation:w,returnFunc:x}},ho.prototype.ogc=function(t,e,o,n,r,i,a,s){var l=s.changePasteDataRangeRowInvisibleCount,u=s.changePasteDataRangeColInvisibleCount,c=s.invisibleRowCountInAcRange,h=s.invisibleColCountInAcRange,f=this.VQ.pasteExtent.targetRange;t&&(e.colCount-=u,e.col-=e.colCount,e.col-=h,f.colCount-=u),o&&(e.rowCount-=l,e.row-=e.rowCount,e.row-=c,f.rowCount-=l),n&&(e.colCount-=u,e.col-=i,e.col-=h,f.colCount-=u),r&&(e.rowCount-=l,e.row-=a,e.row-=c,f.rowCount-=l),s.changePasteDataRangeRowInvisibleCount=0,s.changePasteDataRangeColInvisibleCount=0,s.invisibleRowCountInAcRange=0,s.invisibleColCountInAcRange=0},ho.prototype.PLc=function(t,e){var o=[].concat(e.parent.sheets);return t&&t.xUc&&o.push(t),e&&e!==t&&e.xUc&&o.push(e),o},ho.prototype.execute=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J=this;if(J.canExecute()){if(t=J.VQ.fromSheet,e=J.VQ.toSheet,o=J.VQ.pasteExtent,n=J.VQ.pasteOption,r=o.sourceRange,i=o.targetRange,a=o.isCutting,t&&r&&!t.pu(r.row,r.col,ve(r),Ce(r),ye(t),be(t)))return;if(!(e&&i&&e.l5(i.row,i.col,ve(i),Ce(i),!0)))return;if(e.tables&&e.tables.zxb(t,r,e,i,a))return;if(e.pivotTables&&e.pivotTables.OOc(r,i,e))return;if(c=u=l=s=void 0,t&&(u=t.tu(),s=J.WHb,c=(l=J.YHb)&&new Z.Range(l.row,l.col,l.rowCount,l.colCount)),g=d=p=f=h=void 0,J.XHb&&(h=J.XHb.row,f=J.XHb.col,p=J.XHb.rowCount,d=J.XHb.colCount),v=b=y=m=!1,C=we(e),w=!1,S=A=T=x=0,s!==K&&l){if((M=this._Hb(a,J.XHb,l,s,e)).returnFunc)return;m=M.changePasteDataRangeCol,y=M.changePasteDataRangeRow,x=M.changePasteDataRangeRowInvisibleCount,T=M.changePasteDataRangeColInvisibleCount,A=M.invisibleRowCountInAcRange,S=M.invisibleColCountInAcRange,b=M.changePasteDataRangeCols,v=M.changePasteDataRangeRows,w=M.moveRangeHaveValue,g=M.selectRange,p=J.XHb.rowCount,d=J.XHb.colCount,i.rowCount+=x,i.colCount+=T}J.oUa(),I=J.PLc(t,e),Q.Zxb(I),Se(e),Ie(e),N=!(e.vxb=!0),t&&(Ie(t),t.vxb=!0);try{if(C&&((k=R=-1)!==i.row?R=i.row+ve(i):-1===r.row&&(R=ye(t)),D=R-(E=ye(e)),E<R&&J.vTa(r,i)?s===q.InsertShiftCell.down&&w?e.addRows(E,E-h+D):e.addRows(E,D):w||h+i.rowCount!==ye(e)||s!==q.InsertShiftCell.down?w&&s===q.InsertShiftCell.down&&e.addRows(E,E-h+D):e.addRows(E,E-h+D-c.rowCount),-1!==i.col?k=i.col+Ce(i):-1===r.col&&(k=be(t)),k>be(e)&&J.vTa(r,i)?s===q.InsertShiftCell.right&&w?e.setColumnCount(k+e.getColumnCount()-f):e.setColumnCount(k):w||f+i.colCount!==be(e)||s!==q.InsertShiftCell.right?w&&s===q.InsertShiftCell.right&&e.setColumnCount(k+e.getColumnCount()-f):e.setColumnCount(k+e.getColumnCount()-f-c.colCount)),N=(j=s!==K&&this.dIb(g,s,e,J.XHb,c,h,f,p,d)).raiseInvalidOperation,j.returnFunc)return;r&&Z.mn.qn(t,r.row,r.col,r.row+ve(r)-1,r.col+Ce(r)-1);try{if(_=!1,t)for(O=r.row;O<r.row+r.rowCount&&!_;O++)for(F=r.col;F<r.col+r.colCount;F++)if(t.getValue(O,F)){_=!0;break}e.tables&&(_||o.clipboardText.replace(/[\r\n\t]/gi,""))&&e.tables.fIb(i,r)}catch(t){return e.Os(6,t.message),void e.resumePaint()}e.px(t,r,e,i,o.isCutting,o.clipboardText,o.clipboardHtml,o.clipboardImage,n,!o.includeFilteredOutRow)}finally{r&&Z.mn.Nm(),Ne(e),e.vxb=!1,t&&(Ne(t),t.vxb=!1),Me(e),Q.$xb(I,J.VQ),P=J.VQ.io,L=ho.qx(n),o.isCutting&&t&&(H=[],t.isDirtySuspended()||((B=new Bt(t,r,L)).uy(P.cA.sy()),H=(P._z=B).wy()),Q.Bu(t,r.row,r.col,ve(r),Ce(r),H,3)),e&&(V=[],e.isDirtySuspended()||((z=new Bt(e,i,L)).uy(P.fA.sy()),V=(P.dA=z).wy()),W=e.tables&&e.tables.$Hb&&e.tables.$Hb(i.row,i.col,i.rowCount,i.colCount),G=ve(i),U=Ce(i),Q.Bu(e,i.row,i.col,G,U,V,3,W),J.tableNamesObj={r:i.row,c:i.col,rc:G,cc:U,tableNames:W}),J.pgc={changePasteDataRangeCol:m,changePasteDataRangeRow:y,changePasteDataRangeCols:b,changePasteDataRangeRows:v,acColCount:d,acRowCount:p,changePasteDataRangeRowInvisibleCount:x,changePasteDataRangeColInvisibleCount:T,invisibleRowCountInAcRange:A,invisibleColCountInAcRange:S},u&&delete u.UHb,N&&e.Os(1,Y().Exp_InsertCopiedCutCellsNoRange)}}},ho.prototype.aIb=function(t,e,o,n,r){var i,a,s,l=t._modelManager.getSpans(),u=t.tables.l$;for(i=0;i<l.length;i++)if(!(e<=(a=l[i]).row&&o<=a.col&&e+n>=a.row+a.rowCount&&o+r>=a.col+a.colCount||a.row>e+n||a.row+a.rowCount-1<e||a.row>e+n-1||a.row+a.rowCount-1<e||a.col+a.colCount-1<o))return!0;for(i=0;i<u.length;i++)if(!(e<=(s=u[i]).cj&&o<=s.dj&&e+n>=s.cj+s.Xj&&o+r>=s.dj+s.OZ||s.cj>e+n||s.cj+s.Xj-1<e||s.cj>e+n-1||s.cj+s.Xj-1<e||s.dj+s.OZ-1<o))return!0;return!1},ho.prototype.cIb=function(t,e,o,n,r){var i,a,s,l=t._modelManager.getSpans(),u=t.tables.l$;for(i=0;i<l.length;i++)if(!(e<=(a=l[i]).row&&o<=a.col&&e+n>=a.row+a.rowCount&&o+r>=a.col+a.colCount||a.col>o+r||a.col+a.colCount-1<o||a.col>o+r-1||a.col+a.colCount-1<o||a.row+a.rowCount-1<e))return!0;for(i=0;i<u.length;i++)if(!(e<=(s=u[i]).cj&&o<=s.dj&&e+n>=s.cj+s.Xj&&o+r>=s.dj+s.OZ||s.dj>o+r||s.dj+s.OZ-1<o||s.dj>o+r-1||s.dj+s.OZ-1<o||s.cj+s.Xj-1<e))return!0;return!1},ho.prototype.bIb=function(t,e,o,n,r){var i,a,s,l,u,c,h,f=t._modelManager.getSpans(),p=t.tables.l$;for(i=e;i<e+n;i++)for(a=o;a<o+r;a++){if(s=t.getCell(i,a),!P(s.value())||s.backColor()||s.comment()||s.tag())return!0;for(l=0;l<f.length;l++)if(i>=(u=f[l]).row&&i<=u.row+u.rowCount-1&&a>=u.col&&a<=u.col+u.colCount-1)return!0;for(c=0;c<p.length;c++)if(i>=(h=p[c]).cj&&i<=h.cj+h.Xj-1&&a>=h.dj&&a<=h.dj+h.OZ-1)return!0}return!1},ho.prototype.vTa=function(t,e){var o,n,r,i;return!t||(o=t.row,n=t.col,r=e.row,i=e.col,-1!==o&&-1!==n||-1===o&&-1!==n&&r<=0||-1===n&&-1!==o&&i<=0||-1===o&&-1===n&&r<=0&&i<=0)},ho.prototype.undo=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T=this;if(T.canUndo()){if(t=T.VQ.fromSheet,e=T.VQ.toSheet,n=(o=T.VQ.pasteExtent).sourceRange,r=o.targetRange,!e||!r)return!1;if(T.pgc&&(i=T.pgc,this.ogc(i.changePasteDataRangeCol,n,i.changePasteDataRangeRow,i.changePasteDataRangeCols,i.changePasteDataRangeRows,i.acColCount,i.acRowCount,i)),!e.pu(r.row,r.col,ve(r),Ce(r),ye(e),be(e)))return!1;if(t&&n){if(!t.pu(n.row,n.col,ve(n),Ce(n),ye(t),be(t)))return!1;if(t&&t.name()===e.name()&&e.parent&&!t.xUc&&!L(e.parent.sheets,t))return!1}a=T.VQ.io,Se(e);try{s=r.row<0?0:r.row,l=r.col<0?0:r.col,u=r.row<0?ye(e):ve(r),c=r.col<0?be(e):Ce(r),h=T.PLc(t,e),Q._xb(h,T.VQ),(p=(f=e.rowFilter())&&f.range)&&-1===r.row&&p.col<r.col&&p.col+p.colCount>=r.col+r.colCount&&(p.colCount=p.colCount-r.colCount),y=m=g=d=0,t&&n&&(d=n.row<0?0:n.row,g=n.col<0?0:n.col,m=n.row<0?ye(t):ve(n),y=n.col<0?be(t):Ce(n)),b=[],v=[],(C=T.tableNamesObj)&&(e&&C.r===s&&C.c===l&&C.rc===u&&C.cc===c&&(v=C.tableNames),t&&C.r===d&&C.c===g&&C.rc===m&&C.cc===y&&(b=C.tableNames)),e&&(w=a.dA,Q.Bu(e,s,l,u,c,w?w.wy():[],3,b,!0)),t&&(x=a._z,Q.Bu(t,d,g,m,y,x?x.wy():[],3,v,!0))}finally{Me(e)}}return!0},$t=ho,me(co,fe=Vt),co.prototype.execute=function(){var t,e,o,n,r,i,a,s,l=this.VQ,u=l.MA,c=!1;if(this.canExecute()&&u){Ke(e=(t=this.kj).parent.WJc(),!0);try{for(o=!1,n=0;n<u.length;n++)(r=u[n]).WHb=l.WHb,r.XHb=l.XHb,r.YHb=l.YHb,t?(i=r.VQ.pasteExtent,a={sheet:t,sheetName:t.name(),cellRange:r.VA(),pasteOption:r.VQ.pasteOption,pasteData:{text:i.clipboardText,html:i.clipboardHtml},shiftCells:l.WHb,cancel:!1},(s=i.clipboardImage)&&(a.pasteData.image=s),t.Wq(Z.Events.ClipboardPasting,a),a.cancel||(c=r.execute(),delete a.cancel,o=!0,t.Wq(Z.Events.ClipboardPasted,a))):c=r.execute();o&&this.WA()}finally{Ye(e,!0)}}return c},co.prototype.WA=function(){var t,e,o,n,r,i,a,s=this.VQ,l=s.MA,u=this.kj;if(u&&l){if(t=u.getSelections(),o=u.parent,u.Tr(),s.s5)n=s.pastedRanges[0],u.addSelection(n.row,n.col,ve(n),Ce(n));else if(1<l.length)for(r=0;r<l.length;r++)i=l[r].VA(),u.addSelection(i.row,i.col,ve(i),Ce(i));else 0<l.length&&(a=l[0].VA(),u.addSelection(a.row,a.col,ve(a),Ce(a)),a.contains(u.Jl,u.Kl)||u.Jr(a.row,a.col));e=u.getSelections(),u.yu(t,e)&&u.Au(t),o&&s.xC&&o.changeSelectionInCommandExecuting(s,null,null,e)}},co.prototype.canExecute=function(){var t,e=this.VQ.MA;if(e){for(t=0;t<e.length;t++)if(!e[t].canExecute())return!1;return!0}return!1},co.prototype.canUndo=function(){var t,e=this.VQ.MA;if(e){for(t=0;t<e.length;t++)if(!e[t].canUndo())return!1;return!0}return!1},co.prototype.undo=function(){var t,e,o,n,r=this.VQ.MA;if(this.canUndo()&&r){t=!0,Ke(e=this.kj.parent.WJc(),!0);try{for(o=r.length-1;0<=o;o--)n=r[o],t=t&&n.undo()}finally{Ye(e,!0)}return t}return!1},te=co},"./dist/core/worksheet/worksheet-border.js":function(t,e,o){"use strict";var n,r,_,E,p,d,g,O,F,P,i,C,x,a,c,s,l,h,u,D,f,m,y,b,v,w,T=this&&this.__extends||(f=function(t,e){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function A(t,e,o,n,r,i){var a=m.call(this)||this,s=a,l=0,u=0;return t===o&&(l=1),e===n&&(u=1),t!==o&&e!==n?i?(l=2,s.AE=new c(t-l,e,o-l,n,r,1,i),s.BE=new c(t+l,e,o+l,n,r,1,i)):(u=l=2,o<t?(s.AE=new h(t-l,e,o,n-u,r,!1,i),s.BE=new h(t,e+u,o+l,n,r,!1,i)):(s.AE=new h(t,e+u,o-l,n,r,!0,i),s.BE=new h(t+l,e,o,n-u,r,!0,i))):(s.AE=new c(t-l,e-u,o-l,n-u,r,1,i),s.BE=new c(t+l,e+u,o+l,n+u,r,1,i)),s.gIb=i,s.tE=r,s.uE=1,a}function S(t,e,o,n,r,i,a){var s=y.call(this)||this,l=s;return l.qE=t,l.sE=e,l.oE=o,l.rE=n,l.tE=r,l.iWa=i,l.gIb=a,l.AE=new c(l.qE,l.sE,l.oE,l.rE,r,1,a),l.BE=null,s}function M(t,e,o,n,r,i,a,s,l){var u,c=b.call(this)||this;return i?(--t,--o):(--e,--n),(u=c).qE=t,u.sE=e,u.oE=o,u.rE=n,u.tE=r,u.xE=i,u.uE=1,u.yE=a,u.zE=s,u.gIb=l,c}function I(t,e,o,n,r,i,a,s){var l,u=v.call(this)||this;return i%2||(t!==o?(e-=.5,n-=.5):(t-=.5,o-=.5)),(l=u).qE=t,l.sE=e,l.oE=o,l.rE=n,l.tE=r,l.uE=i,l.wE=a,l.gIb=s,u}function N(t,e,o,n,r,i,a){var s,l=w.call(this)||this;return i%2||(t!==o?(e-=.5,n-=.5):(t-=.5,o-=.5)),(s=l).qE=t,s.sE=e,s.oE=o,s.rE=n,s.tE=r,s.uE=i,s.gIb=a,l}function R(){}function L(t,e,o,n,r,i,a){switch(i!==_&&i!==E||(i=1),i){case 1:return new c(t,e,o,n,r,1,a);case 2:return new c(t,e,o,n,r,2,a);case 5:return new c(t,e,o,n,r,3,a);case 3:return new s(t,e,o,n,r,1,[3,1],a);case 9:return new s(t,e,o,n,r,1,[8,2,2,2],a);case 4:return new s(t,e,o,n,r,1,[2,2],a);case 11:return new s(t,e,o,n,r,1,[9,3,3,3,3,3],a);case 13:return new l(t,e,o,n,r,t!==o,[11,1,5,1],[10,2,4,2],a);case 10:return new s(t,e,o,n,r,2,[9,3,3,3],a);case 12:return new s(t,e,o,n,r,2,[9,3,3,3,3,3],a);case 8:return new s(t,e,o,n,r,2,[9,3],a);case 7:return new s(t,e,o,n,r,1,[1],a);case 6:return new u(t,e,o,n,r,a)}return E}function k(t,e,o,n){this.UE=!1,this.VE=!1,this.kj=t,this.Wz=n,this.hIb=e,this.pJ=o}function j(){}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/worksheet/style.js"),r=o("./dist/core/util/domUtil.js"),_=void 0,E=null,p=Math.sqrt,d=Math.pow,g=Math.min,O=Math.abs,F=Math.tan,Math.floor,P=Math.PI,r.GC$.inherit,i=r.GC$.isEmptyObject,C={LEFT_TOP:0,RIGHT_TOP:1,RIGHT_BOTTOM:2,LEFT_BOTTOM:3},x={H_TOP_LEFT:0,H_TOP_Right:1,V_RIGHT_TOP:2,V_RIGHT_BOTTOM:3,H_BOTTOM_RIGHT:4,H_BOTTOM_LEFT:5,V_LEFT_BOTTOM:6,V_LEFT_TOP:7},R.prototype.mE=function(t){0===t._orientation?(t.nE&&(this.oE+=t.nE),t.pE&&(this.qE+=t.pE)):(t.nE&&(this.rE+=t.nE),t.pE&&(this.sE+=t.pE))},R.prototype.jp=function(t){var e=this.tE||"#9eb6ce",o=this.uE,n=t.lineWidth,r=t.strokeStyle;n===o&&r===e||(n!==o&&(t.lineWidth=o),r!==e&&(t.strokeStyle=e)),this.hWa(t)},R.prototype.hWa=function(t){var e,o,n=this,r=n.qE===n.oE,i=n.sE===n.rE;r&&i||(r||i?(t.beginPath(),n.vE(t),t.stroke()):(t.save(),e=Math.min(n.qE,n.oE),o=Math.min(n.sE,n.rE),t.rect(e,o,Math.abs(n.oE-n.qE),Math.abs(n.rE-n.sE)),t.clip(),t.beginPath(),n.vE(t),t.stroke(),t.beginPath(),t.restore()))},R.prototype.vE=function(t){t.moveTo(this.qE,this.sE),t.lineTo(this.oE,this.rE)},T(N,w=a=R),c=N,T(I,v=a),I.prototype.vE=function(t){I._render(t,this.qE,this.sE,this.oE,this.rE,this.wE)},I._render=function(t,e,o,n,r,i){var a,s,l=p(d(n-e,2)+d(r-o,2)),u=(n-e)/l,c=(r-o)/l,h=0,f=0;for(i=i&&i.length?i:[4,4];h<l;)h+=a=g(i[f%i.length],l-h),(s=++f%2)&&t.moveTo(e,o),e+=a*u,o+=a*c,s&&t.lineTo(e,o)},s=I,T(M,b=a),M.prototype.vE=function(t){var e=this,o=e.xE?0:1,n=e.xE?1:0;s._render(t,e.qE-o,e.sE-n,e.oE-o,e.rE-n,e.yE),s._render(t,e.qE,e.sE,e.oE,e.rE,e.zE)},l=M,T(S,y=a),S.prototype.hWa=function(t){this.AE&&this.AE.hWa(t),this.BE&&this.BE.hWa(t)},S.prototype.mE=function(t){this.BE?(t.pE&&this.AE&&this.AE.mE(t),t.nE&&this.BE.mE(t)):this.AE&&this.AE.mE(t)},S.prototype.jWa=function(t){var e,o,n,r,i,a,s,l,u=this;t&&t.severX&&t.severY?(e=t.severX||0,o=t.severY||0,e=u.iWa?e:-e,i=(n=parseInt(u.qE+(u.oE-u.qE)/2,10))-e,a=(r=parseInt(u.sE+(u.rE-u.sE)/2,10))-o,s=n+e,l=r+o,u.AE=new c(u.qE,u.sE,i,a,u.tE,1,u.gIb),u.BE=new c(s,l,u.oE,u.rE,u.tE,1,u.gIb)):(u.AE=new c(u.qE,u.sE,u.oE,u.rE,u.tE,1,u.gIb),u.BE=null)},h=S,T(A,m=a),A.prototype.hWa=function(t){this.AE.hWa(t),this.BE.hWa(t)},A.prototype.mE=function(t){t.CE?1===t.CE?this.AE.mE(t):2===t.CE&&this.BE.mE(t):(this.AE.mE(t),this.BE.mE(t))},A.prototype.jWa=function(){var t={severX:1,severY:1},e=this.AE,o=this.BE;e.jWa(t),o.jWa(t)},u=A,e.zF=L,j.DE=function(t,e,o){var n,r;return t?e?0!=(r=(n=j.EE)[t.style]-n[e.style])||o?r:e.level-t.level:1:e?-1:0},j.FE=function(t){if(t){if(t.isGridLine)return 1;if(t.style)return n.LineBorder.Vo(t.style)}return 0},j.GE=function(t){return t&&6===t.style},j.HE=function(t){return t&&13===t.style},j.IE=function(t,e){return t&&(!e||0<=j.DE(t.style,e.style))?t:e},j.JE=function(t,e){t&&t.line&&t.line.mE(e)},j.KE=function(t,e,o){return t===e?0:t?e?t.isGridLine?e.isGridLine?0:-1:e.isGridLine?1:j.DE(t.style,e.style,o):1:-1},j.LE=function(t){return t&&t.style&&6===t.style.style},j.ME=function(t,e,o,n){if(t.style&&6===t.style.style)return!0;var r=0;return r+=e&&e.style&&6===e.style.style?1:0,r+=o&&o.style&&6===o.style.style?1:0,(r+=n&&n.style&&6===n.style.style?1:0)<2},j.NE=function(t,e,o,n,r,i){var a={_orientation:i?1:0,pE:0,nE:0},s=this.KE(t,o),l=this.KE(t,n);0<=s&&0<=l?0===s&&0===l?-1!==r&&1===r&&(a.nE-=r):-1===r?a.pE-=r:1===r&&(a.nE-=2*r):0<=l?(a.CE=2,a.pE+=r):0<=s&&(a.CE=1,a.pE+=r),this.JE(t,a)},j.OE=function(t,e,o,n,r,i,a,s,l){var u,c,h,f,p,d,g,m,y={_orientation:s?1:0,CE:l?2:1,pE:0,nE:0},b={_orientation:s?1:0,CE:l?1:2,pE:0,nE:0},v=1===i?n:r,C=1===a?o:e;this.LE(C)?0===(u=this.KE(t,v))?0===(c=this.KE(t,C))?1===a&&(b.nE-=a):0<c&&(-1===a?b.pE-=2*a:1===a&&(b.nE-=2*a)):0<u?0===(h=this.KE(t,C))?1===a&&(b.nE-=a):0<h&&(-1===a?b.pE-=2*a:1===a&&(b.nE-=2*a)):0===(f=this.KE(t,C))?-1===a?y.pE+=2*a:1===a&&(y.nE+=2*a):0<f&&(-1===a?y.pE-=3*a:1===a&&(y.nE-=3*a)):0<=this.KE(t,v)?-1===a?b.pE-=2*a:1===a&&(b.nE-=2*a):-1===a?y.pE+=2*a:1===a&&(y.nE+=2*a),p=1==(1===i?2:1)?n:r,d=!1,g=0,this.LE(p)&&0<this.KE(p,t)&&(d=!0,m=j.FE(p),0<this.KE(p,v)?0<m&&(g=1===a&&this.LE(o)?2<=m?2:1:-1===a&&this.LE(e)?3<=m?2:1:3===m?3:2):g=3===m?3:2),d||this.LE(C)||!(C&&!C.isGridLine||p&&!p.isGridLine)||(d=!0,g=-1===a?2:1),d&&(-1===a?(y.pE+=a*g,b.pE+=a*g):1===a&&(y.nE+=a*g,b.nE+=a*g)),(y.pE||y.nE)&&this.JE(t,y),(b.pE||b.nE)&&this.JE(t,b)},j.PE=function(t,e,o,n,r,i){if(0<=this.KE(t,o)&&0<=this.KE(t,n)){var a={_orientation:i?1:0,pE:0,nE:0};-1===r?(a.pE-=2*r,this.LE(t)&&0<this.KE(e,t)&&--a.pE):1===r&&(a.nE-=2*r,this.LE(t)&&0<this.KE(e,t)&&(a.nE+=1)),this.JE(t,a)}},j.QE=function(t,e,o,n,r,i){var a,s,l;this.LE(t)&&(!(a=this.IE(o,n))||a.isGridLine||0<(s=j.FE(a))&&(l={_orientation:i?1:0,pE:0,nE:0},-1===r?l.pE+=s*r:l.nE+=s*r,(l.pE||l.nE)&&this.JE(t,l)))},j.RE=function(t,e,o,n,r,i,a){var s,l,u,c,h=j;(e||o||n)&&(u=h.IE(o,n),h.ME(t,e,o,n)?0<(l=h.KE(u,t,!0))?(s=h.FE(u),h.LE(t)&&(h.LE(o)||h.LE(n)||h.LE(e))||3===s&&h.JE(t,{_orientation:0,pE:1})):u&&l<0?0<(l=h.KE(t,e,!0))?3===(s=h.FE(u))||2===s?h.JE(t,{_orientation:0,pE:-2}):1===s&&h.JE(t,{_orientation:0,pE:-1}):0!==l&&0<h.KE(e,u,!0)&&3===(s=h.FE(u))&&h.JE(t,{_orientation:0,pE:1}):0===l&&(!e||0<h.KE(t,e,!0))&&(3===(s=h.FE(u))||2===s?h.JE(t,{_orientation:0,pE:-2}):1===s&&h.JE(t,{_orientation:0,pE:-1})):h.JE(t,{_orientation:0,pE:1})),(r||i||a)&&(c=h.IE(i,a),h.ME(t,r,i,a)?0<(l=h.KE(c,t,!0))?(s=h.FE(c),h.LE(t)&&(h.LE(i)||h.LE(a)||h.LE(r))||(3===s?h.JE(t,{_orientation:0,nE:-2}):2!==s&&1!==s||h.JE(t,{_orientation:0,nE:-1}))):l<=0&&(0<(l=h.KE(t,r,!0))?3===(s=h.FE(c))&&h.JE(t,{_orientation:0,nE:1}):0!==l&&h.JE(t,{_orientation:0,nE:-1})):h.JE(t,{_orientation:0,nE:-2}))},j.SE=function(t,e,o,n,r,i,a){var s,l,u,c,h=j;(e||o||n)&&(u=h.IE(o,n),l=h.KE(u,t,!0),h.ME(t,e,o,n)?0<l?(s=h.FE(u),h.LE(t)&&(h.LE(o)||h.LE(n)||h.LE(e))||3===s&&h.JE(t,{_orientation:1,pE:1})):l<0?0<(l=h.KE(t,e,!0))?3===(s=h.FE(u))||2===s?h.JE(t,{_orientation:1,pE:-2}):1===s&&h.JE(t,{_orientation:1,pE:-1}):0!==l&&0<h.KE(e,u,!0)&&3===(s=h.FE(u))&&h.JE(t,{_orientation:1,pE:1}):0===l&&0<h.KE(t,e,!0)&&(3===(s=h.FE(u))||2===s?h.JE(t,{_orientation:1,pE:-2}):1===s&&h.JE(t,{_orientation:1,pE:-1})):h.JE(t,{_orientation:1,pE:1})),(r||i||a)&&(c=h.IE(i,a),l=h.KE(t,c,!0),h.ME(t,r,i,a)?l<0?(s=h.FE(c),h.LE(t)&&(h.LE(i)||h.LE(a)||h.LE(r))||(3===s||2===s?h.JE(t,{_orientation:1,nE:-2}):1===s&&h.JE(t,{_orientation:1,nE:-1}))):c!==E&&0<=l&&(0<(l=h.KE(t,r,!0))?3===(s=h.FE(c))&&h.JE(t,{_orientation:1,nE:1}):0!==l&&h.JE(t,{_orientation:1,nE:-1})):h.JE(t,{_orientation:1,nE:-2}))},j.TE=function(t,e,o,n,r,i,a,s){var l,u,c,h,f=j;s?this.SE(t,e,o,n,r,i,a):this.RE(t,e,o,n,r,i,a),l=f.LE(o),u=f.LE(n),c=f.LE(e),l&&u&&c?f.NE(t,e,o,n,-1,s):l&&!u?f.OE(t,e,r,o,n,1,-1,s,!0):!l&&u?f.OE(t,e,r,o,n,2,-1,s,!1):l&&u&&!c?f.PE(t,e,o,n,-1,s):c&&f.QE(t,e,o,n,-1,s),l=f.LE(i),u=f.LE(a),h=f.LE(r),l&&u&&h?f.NE(t,r,i,a,1,s):l&&!u?f.OE(t,e,r,i,a,1,1,s,!0):!l&&u?f.OE(t,e,r,i,a,2,1,s,!1):l&&u&&!h?f.PE(t,r,i,a,1,s):h&&f.QE(t,r,i,a,1,s)},j.EE=[0,101,199,100,100,300,90,100,198,100,198,100,198,198],j.kWa=function(t,e){return!(!t||!e||t.color!==e.color||t.level!==e.level||t.style!==e.style)},D=j,k.prototype.YE=function(){var t,e,o,n,r,i,a,s,l,u,c=this;if(c.ZE=[],c.$E=[],c._E=[],c.aF=[],c.bF=[],c.cF={},c.dF={},c.eF={},c.fF={},c.lWa={},c.mWa={},c.C$a={},t=c.hIb,e=c.pJ,t&&0<t.length&&e&&0<e.length){for(o=c.$E,n=t.length,r=void 0,i=0;i<n;i++)0<(r=t[i]).height&&o.push(r.row);for(o.push(o[o.length-1]+1),a=c._E,s=e.length,l=void 0,u=0;u<s;u++)0<(l=e[u]).width&&a.push(l.col);a.push(a[a.length-1]+1)}c.UE=!0},k.prototype.gF=function(t,e,o,n,r,i,a,s){if(o){var l={cj:t,dj:e,hF:o.startColumn,iF:o.endColumn,Wqa:n,XHa:r,YHa:i,Vo:a,_v:s};this.aF.push(l)}},k.prototype.jF=function(t,e,o,n,r,i,a,s,l,u,c){var h,f,p,d,g,m,y,b,v,C;this.UE||this.YE(),s?this.ZE.push(s):(C=v=b=y=m=g=d=p=f=h=void 0,a&&(h=a.borderLeft,f=a.borderTop,p=a.borderRight,d=a.borderBottom,C=a.backColor,g=a.diagonalDown,m=a.diagonalUp,y=a.textOrientation,b=a.isVerticalText,v=a.textIndent),!C||h||p||f||d||this.bF.push({r:t,c:e,rc:1,cc:1}),this.kF(t,e,o,n,r,i,h,f,p,d,g,m,C,!1,!1,l,u,y,b,v&&0!==v,c))},k.prototype.kF=function(t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C){var w,x,T,A,S,M,I=this,N=!1,R=!1,k=!1,E=!1,D=y!==_&&y&&-90<=y&&y<=90,j=o;D&&(a||s||l||u)&&!b&&!v&&C&&(w=O(y*P/180),x=F(w),T=Math.floor(i/x),-90<y&&y<0&&(j=o-T),0<y&&y<90&&(j=o+T)),c&&!D&&I.lF(t,e,o-1,n-1,o+r,n+i,c,I.lWa),h&&!D&&I.lF(t,e,o+r,n-1,o-1,n+i,h,I.mWa),s&&0<i&&(N=I.lF(t,e,j,n-.5,j+r,n-.5,s,I.eF,D)),a&&0<r&&(R=I.lF(t,e,j-.5,n,o-.5,n+i,a,I.fF,D)),l&&0<r&&(E=I.lF(t,e+1,j+r-.5,n,o+r-.5,n+i,l,I.fF,D)),u&&0<i&&(k=I.lF(t+1,e,o,n+i-.5,o+r,n+i-.5,u,I.eF,D)),A=I.kj,f&&0!==A.ss.Sl(t)&&0!==A.ss._m(e)||(M=!E&&!d,((S=!k&&!p)||M||!N&&!p||!R&&!d)&&I.mF(t,e,o,n,r,i,S,M,g,m)),!N&&!f||D||I.nF(t-1,e,I.cF),(R||f)&&I.nF(t,e-1,I.dF),!f||a||l||s||u||(I.oF(t-1,e-1,I.dF,!1),I.oF(t-1,e-1,I.cF,!0))},k.prototype.lF=function(t,e,o,n,r,i,a,s,l){var u,c;return!!a&&((u=this.pF(t,e,s,!0))?(l||6!==u.style.style&&(6===a.style||0<D.DE(a,u.style)))&&(u.line=L(o,n,r,i,a.color,a.style,l),u.style=a):(c=L(o,n,r,i,a.color,a.style,l))&&((u=this.pF(t,e,s)).line=c,u.style=a),u&&u.line!==E)},k.prototype.mF=function(t,e,o,n,r,i,a,s,l,u){var c,h,f,p,d,g=this,m=3===g.Wz,y=g.kj.options.gridline;m&&y&&(c=y.color,y.showHorizontalGridline&&(a&&((h=g.pF(t,e,g.cF)).isGridLine=!0,h.line=L(o,n+i-.5,o+r,n+i-.5,c)),l&&((f=g.pF(-1,e,g.cF,!1,!0)).isGridLine=!0,f.line=L(o,n-.5,o+r,n-.5,c))),y.showVerticalGridline&&(s&&((p=g.pF(t,e,g.dF)).isGridLine=!0,p.line=L(o+r-.5,n,o+r-.5,n+i,c)),u&&((d=g.pF(t,-1,g.dF,!1,!0)).isGridLine=!0,d.line=L(o-.5,n,o-.5,n+i,c))))},k.prototype.oF=function(t,e,o,n){var r=this.pF(t,e,o,!0);!r||r.line&&r.line.mE({_orientation:n?0:1,nE:-1})},k.prototype.nF=function(t,e,o){var n;(0<=t&&0<=e||0===t&&-1===e||-1===t&&0===e)&&(!(n=o[t])||n[e]&&delete n[e])},k.prototype.pF=function(t,e,o,n,r){var i,a;if(!r&&(-1===t||-1===e))return E;if(!(i=o[t])){if(n)return E;o[t]=i={}}if(!(a=i[e])){if(n)return E;i[e]=a={}}return a},k.prototype.qF=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I=this,N=I.aF,R=N.length,k=I.fF,E=I.eF,D=I.dF,j=I.cF;for(t=0;t<R;t++)if(o=(e=N[t]).cj,n=e.dj,r=e.hF,i=e.Wqa,a=e.iF,s=e.XHa,l=e.Vo,u=e._v,c=s,h=void 0,f=i.textOrientation,p=i.borderTop,!(d=N[t-1])||d.cj!==o||d.hF!==r||d.iF!==a){for(g=r;g<a;g++)I.pF(o,g+1,k,!0)&&!f?I.nF(o,g+1,k):I.pF(o,g,D,!0)&&I.nF(o,g,D);if(m=I.pF(o,n,E,!0),f&&p&&!m)for(y=u/Math.tan(Math.abs(f*Math.PI/180)),-90<f&&f<0&&(c=s-y),0<f&&f<90&&(c=s+y),h=c+l,b=r;b<a+1;b++)if(C=(v=I.pF(o-1,b,j,!0))&&v.line)for(v.splitLines||(v.splitLines=[],v.splitLines.push(C)),w=0;w<v.splitLines.length;w++)if(T=(x=v.splitLines[w]).qE,A=x.oE,S=x.sE,M=x.rE,T<c&&A<h&&c<A)x.oE=c;else if(c<T&&A<h)I.nF(o-1,b,I.cF);else if(c<T&&h<A&&T<h)x.qE=h;else if(T<c&&h<A){v.splitLines.splice(w,1,L(T,S,c,S,x.color),L(h,M,A,M,x.color));break}}},k.prototype.rF=function(){var t,e,o=this.ZE,n=o.length;if(0<n)for(e=0;e<n;e++)t=o[e],this.sF(t)},k.prototype.D$a=function(){var t,e,o,n,r,i,a,s;if(this.C$a={},0<(e=(t=this.ZE).length))for(n=0;n<e;n++)for(o=t[n],r=0;r<o.rowCount;r++)for(i=r+o.row,this.C$a[i]=this.C$a[i]||{},a=0;a<o.colCount;a++)s=a+o.col,this.C$a[i][s]=o},k.prototype.sF=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y=this,b=t.row,v=t.col,C=t.x,w=t.y,x=t.spanSizeInfo,T=x.styleList[0][0],A=T?T.backColor:E,S=C,M=w,I=null,N=!0,R=null,k=!0;if(1===t.rowCount){for(a=b,l=x.rowSizes[0],i=0;i<t.colCount;i++)c=0===i,f=i===t.colCount-1,s=v+i,u=x.colSizes[i],d=x.styleList[0][i],a===t.row&&s===t.col&&(I=(g=d)&&g.diagonalDown,R=g&&g.diagonalUp),d?(e=d.borderLeft,o=d.borderTop,n=d.borderRight,r=d.borderBottom,N=N&&D.kWa(I,d.diagonalDown),k=k&&D.kWa(R,d.diagonalUp)):e=o=n=r=E,c?y.kF(a,s,S,M,u,l,e,o,E,r,E,E,A,!1,!0):f?y.kF(a,s,S,M,u,l,E,o,n,r,E,E,A,!1,!1):y.kF(a,s,S,M,u,l,E,o,E,r,E,E,A,!1,!0),S+=u;I=N?I:null,R=k?R:null,y.kF(t.row,t.col,t.x,t.y,t.width,t.height,E,E,E,E,I,R,E,!0,!0)}else if(1===t.colCount){for(s=v,u=x.colSizes[0],i=0;i<t.rowCount;i++)h=0===i,p=i===t.rowCount-1,a=b+i,l=x.rowSizes[i],d=x.styleList[i][0],a===t.row&&s===t.col&&(I=(g=d)&&g.diagonalDown,R=g&&g.diagonalUp),d?(e=d.borderLeft,o=d.borderTop,n=d.borderRight,r=d.borderBottom,N=N&&D.kWa(I,d.diagonalDown),k=k&&D.kWa(R,d.diagonalUp)):e=o=n=r=E,h?y.kF(a,s,S,M,u,l,e,o,n,E,E,E,A,!0,!1):p?y.kF(a,s,S,M,u,l,e,E,n,r,E,E,A,!1,!1):y.kF(a,s,S,M,u,l,e,E,n,E,E,E,A,!0,!1),M+=l;I=N?I:null,R=k?R:null,y.kF(t.row,t.col,t.x,t.y,t.width,t.height,E,E,E,E,I,R,E,!0,!0)}else{for(i=0;i<t.rowCount;i++){for(a=b+i,h=0===i,p=i===t.rowCount-1,l=x.rowSizes[i],m=0;m<t.colCount;m++)s=v+m,c=0===m,f=m===t.colCount-1,u=x.colSizes[m],d=x.styleList[i][m],a===t.row&&s===t.col&&(I=(g=d)&&g.diagonalDown,R=g&&g.diagonalUp),d?(e=d.borderLeft,o=d.borderTop,n=d.borderRight,r=d.borderBottom,N=N&&D.kWa(I,d.diagonalDown),k=k&&D.kWa(R,d.diagonalUp)):e=o=n=r=E,h?c?y.kF(a,s,S,M,u,l,e,o,E,E,E,E,A,!0,!0):f?y.kF(a,s,S,M,u,l,E,o,n,E,E,E,A,!0,!1):y.kF(a,s,S,M,u,l,E,o,E,E,E,E,A,!0,!0):p?c?y.kF(a,s,S,M,u,l,e,E,E,r,E,E,A,!1,!0):f?y.kF(a,s,S,M,u,l,E,E,n,r,E,E,A,!1,!1):y.kF(a,s,S,M,u,l,E,E,E,r,E,E,A,!1,!0):c?y.kF(a,s,S,M,u,l,e,E,E,E,E,E,A,!0,!0):f&&y.kF(a,s,S,M,u,l,E,E,n,E,E,E,A,!0,!1),S+=u;S=C,M+=l}I=N?I:null,R=k?R:null,y.kF(t.row,t.col,t.x,t.y,t.width,t.height,E,E,E,E,I,R,E,!0,!0)}!A||e||n||o||r||y.bF.push({r:b,c:v,rc:t.rowCount,cc:t.colCount})},k.prototype.mE=function(){var t=!1,e=!1,o=!1,n=!1;i(this.fF)||(t=!0),i(this.eF)||(e=!0),(t||e)&&(this.tF(),this.tWa()),i(this.lWa)||(o=!0),i(this.mWa)||(n=!0),(o||n)&&this.oWa(),0<this.bF.length&&this.uF()},k.prototype.E$a=function(t,e,o,n,r){var i=this.C$a[t]?this.C$a[t][e]:null;if(i)switch(r){case x.H_TOP_LEFT:return this.vF(t,e,o,n);case x.H_TOP_Right:case x.V_RIGHT_TOP:return this.vF(t,e+i.colCount-1,o,n);case x.V_RIGHT_BOTTOM:case x.H_BOTTOM_RIGHT:return this.vF(t+i.rowCount-1,e+i.colCount-1,o,n);case x.H_BOTTOM_LEFT:case x.V_LEFT_BOTTOM:return this.vF(t+i.rowCount-1,e,o,n);case x.V_LEFT_TOP:return this.vF(t,e,o,n)}return this.vF(t,e,o,n)},k.prototype.oWa=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g=this,m=g.$E,y=g._E,b=m.length,v=y.length,C={},w={};for(t=0;t<b;t++)for(o=m[t],e=0;e<v;e++)n=y[e],f=g.pF(o,n,g.lWa,!1),p=g.pF(o,n,g.mWa,!1),(f||p)&&(D.LE(f)&&D.LE(p)&&(f.line.jWa(),p.line.jWa()),d=[],(r=g.E$a(o,n,!1,C,x.H_TOP_LEFT))&&r.line&&!r.isGridLine&&(d=[1,1,2],g.pWa(d,r,f,!0,1)),(l=g.E$a(o,n,!1,C,x.H_TOP_Right))&&l.line&&!l.isGridLine&&(d=[1,1,2],g.pWa(d,l,p,!0,1)),(i=g.E$a(o,n,!0,w,x.V_LEFT_TOP))&&i.line&&!i.isGridLine&&(d=[1,1,2],g.pWa(d,i,f,!0,0)),(u=g.E$a(o,n,!0,w,x.V_LEFT_BOTTOM))&&u.line&&!u.isGridLine&&(d=[1,1,2],g.pWa(d,u,p,!1,0)),(a=g.E$a(o+1,n,!1,C,x.H_BOTTOM_LEFT))&&a.line&&!a.isGridLine&&(d=[-1,-2,-2],g.pWa(d,a,p,!1,1)),(c=g.E$a(o+1,n,!1,C,x.H_BOTTOM_RIGHT))&&c.line&&!c.isGridLine&&(d=[-1,-2,-2],g.pWa(d,c,f,!1,1)),(s=g.E$a(o,n+1,!0,w,x.V_RIGHT_TOP))&&s.line&&!s.isGridLine&&(d=[-1,-2,-2],g.pWa(d,s,p,!0,0)),(h=g.E$a(o,n+1,!0,w,x.V_RIGHT_BOTTOM))&&h.line&&!h.isGridLine&&(d=[-1,-2,-2],g.pWa(d,h,f,!1,0)))},k.prototype.pWa=function(t,e,o,n,r){var i,a,s=D.LE(e),l=D.HE(e),u=e.line.uE;s&&(u=3),l&&(u=2),i=t[u-1],o&&o.line&&(a={_orientation:r},n?a.pE=i:a.nE=i,o.line.mE(a))},k.prototype.uF=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f=this.bF,p=f.length;for(t=0;t<p;t++){for(i=(r=o=(e=f[t]).r)-1,a=(n=e.c)-1,s=n,1<e.rc&&(r+=e.rc-1),1<e.cc&&(s+=e.cc-1),u=l=!1,c=t+1;c<p&&((h=f[c]).c===s+1&&h.r===o&&(u=!0),h.r===r+1&&h.c===n&&(l=!0),!l||!u)&&!(h.r>o+1&&h.c>n+1);c++);l||this.oF(r,a,this.cF,!0),u||this.oF(i,s,this.dF,!1)}},k.prototype.tF=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b=this,v=b.$E,C=b._E,w=v.length,x=C.length,T={},A={};for(t=0;t<w;t++)for(o=v[t],e=0;e<x;e++){if(n=C[e],g=d=0,m=b.pF(o,n,b.fF,!0)){if(m.line&&m.line.gIb)continue;d++}else m=b.pF(o,n-1,b.dF,!0);(y=b.pF(o,n,b.eF,!0))?g++:y=b.pF(o-1,n,b.cF,!0),(m||y)&&((r=0===t?E:b.vF(v[t-1],n,!0,A))&&r.line&&!r.isGridLine&&(d++,g++),(i=0===e?E:b.vF(o,C[e-1],!1,T))&&i.line&&!i.isGridLine&&(d++,g++),m&&((a=b.vF(o,n,!1,T))&&a.line&&!a.isGridLine&&d++,t!==w-1&&(l=b.vF(v[t+1],n,!0,A))&&l.line&&!l.isGridLine&&d++,0!==e&&t!==w-1&&(u=b.vF(v[t+1],C[e-1],!1,T))&&u.line&&!u.isGridLine&&d++,t!==w-1&&(c=b.vF(v[t+1],n,!1,T))&&c.line&&!c.isGridLine&&d++,0<d&&(D.GE(m.style)?D.TE(m,r,i,a,l,u,c,!0):D.HE(m.style)||D.SE(m,r,i,a,l,u,c))),y&&((s=b.vF(o,n,!0,A))&&s.line&&!s.isGridLine&&g++,e!==x-1&&(h=b.vF(o,C[e+1],!1,T))&&h.line&&!h.isGridLine&&g++,0!==t&&e!==x-1&&(f=b.vF(v[t-1],C[e+1],!0,A))&&f.line&&!f.isGridLine&&g++,e!==x-1&&(p=b.vF(o,C[e+1],!0,A))&&p.line&&!p.isGridLine&&g++,0<g&&(D.GE(y.style)?D.TE(y,i,r,s,h,f,p,!1):D.HE(y.style)||D.RE(y,i,r,s,h,f,p))))}},k.prototype.F$a=function(t,e,o,n){var r=this.C$a[t]?this.C$a[t][e]:null,i=o?this.mWa:this.lWa;return r?t===r.row&&e===r.col&&n===C.LEFT_TOP||t===r.row&&e===r.col+r.colCount-1&&n===C.RIGHT_TOP||t===r.row+r.rowCount-1&&e===r.col+r.colCount-1&&n===C.RIGHT_BOTTOM||t===r.row+r.rowCount-1&&e===r.col&&n===C.LEFT_BOTTOM?this.pF(r.row,r.col,i,!1):void 0:this.pF(t,e,i,!1)},k.prototype.tWa=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g=this,m=g.$E,y=g._E,b=m.length,v=y.length;for(t=0;t<b;t++)for(o=m[t],e=0;e<v;e++)n=y[e],(p=g.pF(o,n,g.fF,!0))&&p.line&&p.line._noNeedAdjust||(p&&p.line&&D.LE(p)&&(r=g.F$a(o,n,!1,C.LEFT_TOP),i=g.F$a(o,n,!0,C.LEFT_BOTTOM),a=D.LE(r),s=D.LE(i),l=g.F$a(o,n-1,!1,C.RIGHT_BOTTOM),u=g.F$a(o,n-1,!0,C.RIGHT_TOP),c=D.LE(l),h=D.LE(u),r&&a&&(f={CE:2,_orientation:1,pE:2},p.line.mE(f)),i&&s&&(f={CE:2,_orientation:1,nE:-2},p.line.mE(f)),l&&c&&(f={CE:1,_orientation:1,nE:-2},p.line.mE(f)),u&&h&&(f={CE:1,_orientation:1,pE:2},p.line.mE(f))),(d=g.pF(o,n,g.eF,!0))&&d.line&&D.LE(d)&&(r=g.F$a(o,n,!1,C.LEFT_TOP),i=g.F$a(o,n,!0,C.RIGHT_TOP),a=D.LE(r),s=D.LE(i),l=g.F$a(o-1,n,!1,C.RIGHT_BOTTOM),u=g.F$a(o-1,n,!0,C.LEFT_BOTTOM),c=D.LE(l),h=D.LE(u),r&&a&&(f={CE:2,_orientation:0,pE:2},d.line.mE(f)),i&&s&&(f={CE:2,_orientation:0,nE:-2},d.line.mE(f)),l&&c&&(f={CE:1,_orientation:0,nE:-2},d.line.mE(f)),u&&h&&(f={CE:1,_orientation:0,pE:2},d.line.mE(f))))},k.prototype.vF=function(t,e,o,n){var r,i=n[t];return(r=(i=i||(n[t]={}))[e])===_&&(r=i[e]=this.wF(t,e,o)),r},k.prototype.wF=function(t,e,o){var n,r;if(t===_||t<0||e===_||e<0)return E;if(n=o?this.fF:this.eF,r=this.pF(t,e,n,!0))return r;if(n=o?this.dF:this.cF,o){if(--e<0)return E}else if(--t<0)return E;return(r=this.pF(t,e,n,!0))||E},k.prototype.paint=function(t){this.UE&&(this.VE||(this.D$a(),this.rF(),this.qF(),this.mE(),this.VE=!0),t.save(),this.jp(t),t.restore())},k.prototype.jp=function(t){this.xF(t),this.yF(t)},k.prototype.xF=function(t){this._d(t,this.cF),this._d(t,this.dF)},k.prototype.yF=function(t){this._d(t,this.eF),this._d(t,this.fF),this._d(t,this.lWa),this._d(t,this.mWa)},k.prototype._d=function(t,e){var o,n,r,i,a,s;for(o in e)if(e[o])for(n in r=e[o])if(r[n])if(i=r[n].line,(a=r[n].splitLines)&&0<a.length)for(s=0;s<a.length;s++)a[s]&&a[s].jp(t);else i&&i.jp(t)},e.AF=k},"./dist/core/worksheet/worksheet-edit.js":function(t,e,o){"use strict";var n,U,J,r,Z,i,q,a,K,Y,Q,X,g,$,m,s,y,l;Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/core.ns.js"),U=o("./dist/core/worksheet/worksheet.js"),J=o("./dist/core/util/common.js"),r=o("./dist/core/util/domUtil.js"),Z=r.GC$,i=o("@grapecity/js-sheets-common"),q=o("./dist/core/core.enum.js"),a=o("@grapecity/js-calc"),K=!!a,Y=J.Ul.Ml,Q=J.Ul.rl(),X=i.Common.j.Fa,g=i.Common.u,$=i.Common.CultureManager,m=J.Ul.K_a,s=new i.Common.ResourceManager(n.SR),y=s.getResource.bind(s),l={startEdit:function(t,e){this.EF(this.Ws(),this.Jl,this.Kl,null,null,t,e)},editorStatus:function(){return this._editorStatus||0},isEditing:function(){var t=this._editorStatus;return 1===t||2===t},endEdit:function(t){return this._endEditImp(t)},_endEditImp:function(t,e,o,n){if(!this.isEditing())return!0;this.suspendPaint();try{return this.Yoa(t,e,o,n)}finally{this.resumePaint()}},Yoa:function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y,b=this,v=b._eventHandler,C=b._editor,w=b.name(),x=b.Jl,T=b.Kl,A=b.getCellType(x,T),S={sheet:b,row:x,col:T,sheetArea:3,klb:C&&C.klb};if(A.isImeAware(S)||v.Qq(),C&&C.parentNode){if(a={sheet:b,sheetName:w,row:x,col:T,editor:C,editingText:i=A.getEditorValue(C,S),cancel:!1},b.Wq(J.Events.EditEnd,a),a.cancel&&!n)return;if(b.Wq(J.Events.EditEnding,a),a.cancel&&!n)return;if(l=(s=b.parent)&&s.CF,document.activeElement===(l&&l._host)&&v.Qq(),0<=x&&0<=T&&(u=C.Ep,c=b.getFormulaInformation&&b.getFormulaInformation(x,T),A.isEditingValueChanged(u,i,S)||1===e||c&&c.isArrayFormula&&1!==e))if(t)A.setEditorValue(C,u,S),A.selectAll(C,S);else if(h=A.DF,X(h)&&(h=!0),f={cmd:"editCell",sheetName:w,row:x,col:T,newValue:i,autoFormat:h,editingFormatter:C.oja},1===e&&(f.ranges=[b._getActiveSelectedRange()],f.endEditType=e),null===i||t||b.tables&&b.tables.find&&(b.tables.find(x-1,T)||b.tables.find(x,T-1))&&b.tables.fIb(new J.Range(x,T,1,1),null,i,!0),b.wu().execute(f),2===(r=f.applyResult)&&(A.focus(C,S),!n))return!1;if(b.$l=!0,A.XBb(C,S,b.getCellRect(x,T)),A.isImeAware(S))Y.msie&&9===parseFloat(Y.version)?v.Qq():Z(C.parentNode.parentNode).css({width:0,height:0,overflow:"hidden",border:"none"});else for(p=b.zo(),d=C;d;)d.parentNode===p?p.removeChild(d):d=d.parentNode}return b.Ll=!1,g={sheet:b,sheetName:w,row:x,col:T,editingText:i},m=Z.extend({},g),b.Wq(J.Events.EditEnded,g),b.Wq(J.Events.FormulatextboxEditEnded,m),!(!0!==o&&m.ignore&&!n)&&(0!==b._editorStatus&&(y=b._editorStatus,b._editorStatus=0,b._raiseEditorStatusChanged(y,0)),b._modelManager.setCellState(x,T,q.CellStatesType.edit,!1,q.SheetArea.viewport),U.Worksheet.ao(b,"endEdit"),b._editor=null,1!==r)},FF:function(t,e,o){var n,r,i,a,s,l,u,c,h=this,f=h.hitTest(e,o);!f||f.cellTypeHitInfo&&(f.cellTypeHitInfo.outlineColumnHitInfo||f.cellTypeHitInfo.cellButtonHitInfo)||(n=f.row,r=f.col,0<=n&&0<=r&&0<=f.rowViewportIndex&&0<=f.colViewportIndex&&!f.resizeInfo&&!f.dragInfo&&n===h.Jl&&r===h.Kl&&(i=h.isEditing(),h.EF(t,n,r),!i&&h.isEditing()&&(a=f.hitTestType,(s=h.getCellType(n,r)).tw&&(l=h.getCellRect(n,r,1===a?-1:void 0,2===a?-1:void 0),u=h.getActualStyle(n,r,a),(c=s.h5(e,o,u,l,{sheet:h,row:n,col:r,sheetArea:a}))&&c.isReservedLocation&&s.tw(h,n,r,3)))))},inputFormulaAndSelectFormulaRange:function(t,e,o,n){var r,i,a,s,l,u=this,c=u.options,h=u.getCellRect(t,e),f=u.getActualStyle(t,e),p=u.getCellType(t,e),d=u._eventHandler;d.zt(),r={sheet:u,row:t,col:e,sheetArea:3},(i=d.GF)&&i.firstChild&&(a=i.firstChild.firstChild),a&&(u._editor=a,s=u.am(),p.isImeAware(r)&&d.JF(),p._activateEditorWrapper(i,f,h,r),u.KF(p,a,t,e,f,void 0,void 0),p._updateEditorWrapper(i,f,h,r),c.allowCellOverflow&&((l=h.clone()).y-=2,l.height+=4,l.x=s.kt,l.width=u.rKc(s),u.repaint(l)),U.Worksheet.ao(u,"startEdit",{element:p.getEditingElement()}),u._editorStatus=2,u._formulaTextBox.text(n),u._formulaTextBox.caret(n.length-1),o&&u._formulaTextBox.iIb(3,4),u._formulaTextBox._openFuncHelp(),J.Vl.Zl(u))},EF:function(t,e,o,n,r,i,a,s,l){var u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G;if(Z[Z.sd]({tc:this.parent}),!(e<0||o<0||(c=(u=this).name(),h=u.options,u.isEditing()||(!(f=u.getCellRect(e,o))||X(f.width)||X(f.height)||X(f.x)||X(f.y)||f.width<=0||f.height<=0)))){if((p=u._modelManager).setCellState(e,o,q.CellStatesType.edit,!0,q.SheetArea.viewport),d=u.getActualStyle(e,o),h.isProtected&&!1!==d.locked)return void p.setCellState(e,o,q.CellStatesType.edit,!1,q.SheetArea.viewport);if(!(g=u.getCellType(e,o)))return void p.setCellState(e,o,q.CellStatesType.edit,!1,q.SheetArea.viewport);if(u.pivotTables)for(m=u.pivotTables.all(),y=0;y<m.length;y++)if(v=(b=m[y].getRange()).page,C=b.content,v&&v.contains(e,o)||C&&C.contains(e,o))return void p.setCellState(e,o,q.CellStatesType.edit,!1,q.SheetArea.viewport);if((w=u._eventHandler).zt(),x={sheet:u,row:e,col:o,sheetArea:3},(T=g.isImeAware(x)?w.GF:g._createCellTypeElement(x))&&T.firstChild&&(A=T.firstChild.firstChild),!A)return void p.setCellState(e,o,q.CellStatesType.edit,!1,q.SheetArea.viewport);if(S=u.getActualStyle(e,o),M=!1,N=$.culture(),(S.formatter&&J.util.yIc(S.formatter,N)||S._autoFormatter&&S._autoFormatter.formatCached&&J.util.yIc(S._autoFormatter,N))&&(R=l&&l.keyCode,k=l&&l.code,l&&R&&!l.shiftKey&&(96<=R&&R<=105||48<=R&&R<=57)&&(M=!0),(109===R||107===R||l&&(!l.shiftKey&&189===R||l.shiftKey&&187===R))&&(g.probabilityAddPercent=!0),229===R&&!l.shiftKey&&0<k.length-k.replace(/[0-9]/,"").length&&(M=!0),229===R&&!l.shiftKey&&(0<k.length-k.replace("Minus","").length||0<k.length-k.replace("Subtract","").length||0<k.length-k.replace("Add","").length)&&(g.probabilityAddPercentSpec=!0),229===R&&l.shiftKey&&0<k.length-k.replace("Equal","").length&&(g.probabilityAddPercentSpec=!0),E=T.innerText,Y.msie&&(E=E.replace("\r\n","")),D=$.q4($.culture()).NumberFormat.numberDecimalSeparator,j=RegExp("^[-]?[0-9]+(\\"+D+"[0-9]+)?$"),!l&&E&&j.test(E)&&(I=!0)),u._editor=A,_={sheet:u,sheetName:c,row:e,col:o,cancel:!1},u.Wq(J.Events.EditStarting,_),_.cancel)return Q.ipad&&w.Qq(),void p.setCellState(e,o,q.CellStatesType.edit,!1,q.SheetArea.viewport);u.showCell(u.Jl,u.Kl,3,3),u.jIb=!0,O=u.getValue(e,o),F=K&&u.getFormula(e,o),P=u._editorStatus,u.HF||X(O)&&X(F)?u._editorStatus=1:u._editorStatus=2,u._raiseEditorStatusChanged(P,u._editorStatus),L=u.am(),f=u.getCellRect(e,o,n,r),g.isImeAware(x)&&w.JF(),g._activateEditorWrapper(T,d,f,x),u.KF(g,A,e,o,d,a,s,M,I),H=u.zo(),g.isImeAware(x)||H.insertBefore(T,null),delete u.jIb,g._updateEditorWrapper(T,d,f,x),g.isImeAware(x)&&i||g.focus(A,x),h.allowCellOverflow&&((B=f.clone()).y-=2,B.height+=4,u.QLc&&u.QLc.isEnable(q.StatesType.edit,!1)&&(B.y=L.nt,B.height=L.jr),B.x=L.kt,B.width=u.rKc(L),u.repaint(B)),U.Worksheet.ao(u,"startEdit",{element:g.getEditingElement()}),!M&&i&&g.selectAll(A,x),M&&(V=window.getSelection(),(z=document.createRange()).setStart(A,0),V.removeAllRanges(),V.addRange(z)),I&&(V=window.getSelection(),(W=document.createElement("span")).innerText="%",z=document.createRange(),u.parent.options.enableFormulaTextbox&&u.parent.options.allowUserEditFormula?(A.firstChild.appendChild(W),z.setStart(A.firstChild,1),u._formulaTextBox&&u._formulaTextBox.BXc()):(A.appendChild(W),z.setStart(A,1)),V.removeAllRanges(),V.addRange(z)),J.Vl.Zl(u),G={sheet:u,sheetName:c,row:e,col:o},u.Wq(J.Events.EditStarted,G),u.Wq(J.Events.FormulatextboxEditStarted,G)}},KF:function(t,e,o,n,r,i,a,s,l){var u,c,h,f,p,d=K&&this.getFormula(o,n,3,!0);c={sheet:this,row:o,col:n,sheetArea:3,isImeInput:a},(u=d=d&&"="+d)&&0!==d.length||((d=this.getValue(o,n,3,1))&&d.richText&&(e.klb=!0,d=m(d)),h=this.parent,f=K&&h&&h.options.allowUserEditFormula,"string"==typeof d&&r.quotePrefix||d&&0<d.length&&"="===d[0]&&f?u=d="'"+d:(u=d,d=t.kp(e,r,d,c))),e.Ep=d,X(i)||(d=i),l&&d&&(d=this.dJc(d,r.formatter)),t.setEditorValue(e,d,c,s),this.parent&&this.parent.options.enableAccessibility&&(p=y(),e.setAttribute("aria-label",p.ARIA_Cell+"("+o+","+n+") "+g.Kb(p.ARIA_HasValue,[d]))),e.LF=u},dJc:function(t,e){var o,n,r,i,a,s,l,u,c=$.q4($.culture()).NumberFormat,h=c.negativeSign,f=c.numberDecimalSeparator,p="%"===e[0],d=e.split(";");if(p?o=d[0].split("%")[1].split(".")[1]:-1<d[0].indexOf("%")&&(o="00"),void 0===o&&(o=""),1<t.split("e").length)return n=t.split("e")[0],r=t.split("e")[1],n+"e+"+(parseInt(r.split("+")[1],10)+2);if(1<t.split(f).length){for(i=!1,t.charAt(0)===h&&(t=t.substr(1,t.length-1),i=!0),a=(t+=o).indexOf(f),l=(s=(t=(t=t.split(f).join("")).substr(0,a+2)+f+t.substr(a+2,t.length-1)).split(f))[0],u=s[1];l&&"0"===l.charAt(0);)l=l.substr(1,l.length-1);for(;u&&"0"===u.charAt(u.length-1);)u=u.substr(0,u.length-1);return i&&l&&(l=h+l),l&&u?l+f+u:!l&&u?(i?h+"0"+f:"0"+f)+u:l&&!u?l:"0"}return"0"===t?t:t+o}},Z.extend(U.Worksheet.prototype,l)},"./dist/core/worksheet/worksheet-event.js":function(t,e,o){"use strict";var n,A,p,h,w,S,g,x,d,b,v,m,y,C,f,r,s,M,i,l,u,c,T,I,N,R,k,E,D,j,_,O,F,P,L,a,H,B,V,z,W,G,U,J,Z,q,K,Y,Q,X,$,tt,et,ot,nt,rt;function it(t,e,o){var n,r,i,a,s,l,u,c,h,f,p=!1,d=t.am();return e&&(n=ft(e),r=pt(e),(n<0||r<0)&&((i=t.getCellRect(e.row,e.col,n,r))&&0<i.width&&0<i.height&&(a=d.x,s=d.y,(i.x<d.Br+a||i.y<d.Cr+s||i.y>=d.height-d.Bt)&&(l=new S.Rect(i.x-2,i.y-2,i.width+4,i.height+4),u=n<0&&r<0?d.em():n<0?d.gm(r):d.fm(n),l=l.getIntersectRect(u),o.VF(l.x,l.y,l.width,l.height),c=t,f=3,ft(h=e)<0&&(f=1),pt(h)<0&&(f=2),p=!(3===f||!c.vp(h.row,h.col,f,!0)))))),p}function at(t){return t.isEditing()}function st(t){return t.endEdit()}function lt(t){return t.frozenRowCount()}function ut(t){return t.frozenColumnCount()}function ct(t,e){return t.getRowCount(e)}function ht(t,e){return t.getColumnCount(e)}function ft(t){return t.rowViewportIndex}function pt(t){return t.colViewportIndex}function dt(t){return t.hitTestType}function gt(t){return t.getActiveRowIndex()}function mt(t){return t.getActiveColumnIndex()}function yt(t){return t.keyCode}function bt(t){return t.ctrlKey}function vt(t){return t.shiftKey}function Ct(t){return t.altKey}function wt(t){return t.metaKey}function xt(t){return t.colCount}function Tt(t){return t.rowCount}function At(t,e,o){return{action:t,index:e,sheetArea:o}}function St(t,e,o,n,r,i){var a={sheet:t,sheetName:e,sheetArea:r,row:o,col:n};return i&&(a.cancel=!1),a}function Mt(t,e,o,n,r,i){var a=t.kj,s=St(a,a.name(),a.Jl,a.Kl,D,!0);return a.Wq(S.Events.LeaveCell,s),!(!s||!0!==s.cancel)||(a.Kr(e,o,n,r,i),a.Wq(S.Events.EnterCell,St(a,a.name(),e,o)),a.Wq(S.Events.FormulatextboxEnterCell,St(a,a.name(),e,o)),void(t.cs&&t.cs(e,o)))}function It(t,e,o,n,r,i,a){var s=t.kj,l=e.call(s,i.sheetArea);return(a&&!s.getRowVisible(i.index,i.sheetArea)||!a&&!s.getColumnVisible(i.index,i.sheetArea))&&(i.index=o.call(t,i.index,i.sheetArea)),n.call(l,i.index)||n.call(l,r)}function Nt(t,e,o,n,r){var i,a=n?"movingY":"movingX",s=n?"startY":"startX";t[a]=e,t[a]<t[s]&&(t[a]=t[s]),i=n?o.y+o.height:o.x+o.width,t[a]>i&&(t[a]=i),r!==E&&t[a]>t[s]+r&&(t[a]=t[s]+r)}function Rt(t,e){var o=e.row,n=e.rowCount,r=e.col,i=e.colCount,a=t.getColumnCount(),s=t.getRowCount();return a<i+r&&(i=a-r),s<n+o&&(n=s-o),{row:o,col:r,rowCount:n,colCount:i}}function kt(t,e,o){var n=t.parent.options.rowResizeMode;return o&&0===n&&(n=1),e.action!==K&&1===n&&!function(t,e){var o,n=t.getViewportBottomRow(t.Er(e));if(-1===n&&(n=t.ir()),e<n)for(o=n;e<o;o--)if(0!==t.getRowHeight(o))return;return 1}(t,e.index)&&!(!t.getRowResizable(e.index,e.sheetArea)||!t.getRowResizable(e.index+1,e.sheetArea))&&function(r){var i,a,t=r._modelManager.getSelections();if(0<t.length)return i=0,a=r.getRowCount(),t.every(function(t){var e,o=Rt(r,t),n=!1;return 1===o.rowCount&&(n=(i+=1)<=1),e=o.row<a,-1!==o.col||n&&e})}(t)}function Et(t,e,o){var n=t.parent.options.columnResizeMode;return o&&0===n&&(n=1),e.action!==X&&1===n&&!function(t,e){var o,n=t.getViewportRightColumn(t.Fr(e));if(-1===n&&(n=t.dr()),e<n)for(o=n;e<o;o--)if(0!==t.getColumnWidth(o))return;return 1}(t,e.index)&&!(!t.getColumnResizable(e.index,e.sheetArea)||!t.getColumnResizable(e.index+1,e.sheetArea))&&function(r){var i,a,t=r._modelManager.getSelections();if(0<t.length)return i=0,a=r.getColumnCount(),t.every(function(t){var e,o=Rt(r,t),n=!1;return 1===o.colCount&&(n=(i+=1)<=1),e=o.col<a,-1!==o.row||n&&e})}(t)}function Dt(t,e,o){var n,r,i,a=o?t.frozenRowCount():t.frozenColumnCount(),s=o?t.lq:t.qq,l=!1,u=s-1;if(0<a&&a<s)for(n=s-1;a<=n;){if(o?t.getRowVisible(n):t.getColumnVisible(n)){if(r=o?t.getRowHeight(n):t.getColumnWidth(n),n===u&&0===r)break;if(0<r){l=!0;break}}else u--;n--}for(i=l?a:e,i--;0<=i;){if(o?t.getRowVisible(i):t.getColumnVisible(i))return i;i--}return-1}function jt(t){this.mIb=0;this.WF=0,this.XF=!1,this.Gma=!1,this.gA={},this.kj=t,this.nIb="gcEvent"+t._id}function _t(t){this._host=t,this.jI=E,this.kI=E,this.lI=E,this.Fi=E,this.mI=!1,this.nI=!1}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/core.ns.js"),A=o("./dist/core/worksheet/worksheet.js"),p=o("@grapecity/js-sheets-common"),h=o("./dist/core/worksheet/worksheet-model.js"),w=o("./dist/core/util/domUtil.js"),S=o("./dist/core/util/common.js"),g=o("./dist/core/core.enum.js"),x=window,d=document,b=w.GC$.each,v=S.Ul.Ml,m=S.Ul.rl(),y=S.Ul.nl,C=S.Ul.Nl,f=p.Common.u,r=p.Common.u.Kb,s=S.kf,M=p.Common.j.Fa,l="mousedown"+(i={lIb:".handler"}).lIb,u="mouseup"+i.lIb,c="mousemove"+i.lIb,T="mousewheel"+i.lIb,I="DOMMouseScroll"+i.lIb,N="wheel"+i.lIb,R="mouseout"+i.lIb,k="dblclick"+i.lIb,E=null,D=void 0,j=isNaN,_=parseInt,O=Math.max,F=Math.floor,P=Math.min,L=Math.abs,a=Math.ceil,H="position",B="absolute",V="border",z="overflow",W="left",G="height",U="hidden",J="none",Z="gcUIElement",q="corner",K="sizeHiddenRow",Y="sizeRow",Q="sizeCol",X="sizeHiddenCol",$="default",tt=m.iphone||m.ipad||m.android,et=new p.Common.ResourceManager(n.SR),ot=et.getResource.bind(et),_t.prototype.tG=function(t){"function"==typeof t&&(this.kI=t)},_t.prototype.PG=function(t){j(t)||0===t?this.SG():(this.nI=0<t,t=L(t),this.jI!==(this.jI=t)&&this.oI())},_t.prototype.oI=function(){var t=this;t.$b(),j(t.jI)||(t.lI=x.setInterval(function(){t.pI()},t.jI))},_t.prototype.pI=function(){var t=this.kI;this.mI=!0,"function"==typeof t&&(this.Fi=t.call(this._host,this.nI))},_t.prototype.SG=function(){this.$b(),this.jI=E,this.lI=E,this.Fi=E,this.mI=!1},_t.prototype.$b=function(){var t=this.lI;t&&clearInterval(t)},_t.prototype.no=function(){this.SG()},nt=_t,jt.prototype.no=function(){this.YF&&this.YF.no(),this.ZF&&this.ZF.no(),this.$F=E},jt.prototype._F=function(){return this.YF||(this.YF=new nt(this)),this.YF},jt.prototype.aG=function(){return this.ZF||(this.ZF=new nt(this)),this.ZF},jt.prototype.Vs=function(){return this.kj.Vs()},jt.prototype.bG=function(){var t=w.GC$(this.kj.Ws()).position();return t=t||{top:0,left:0}},jt.prototype.AD=function(t){var e,o,n,r,i,a,s,l,u,c=S.Ul.sl(),h=bt(t),f=c&&!0===h&&0===t.button;return!(2!==t.button&&!f&&(e=this.kj,this.tC(),v&&v.msie&&t.offsetX!==D&&t.offsetY!==D&&(n=o=0,r=e.Xs,t.target!==r&&(o=(i=S.Ul.Z3(t.target,r)).EB,n=i.FB),r&&(a=t.pageX-(t.offsetX+o),s=t.pageY-(t.offsetY+n),r.canvasOffset={top:s,left:a})),l=e.Vs(),u=this.cG(t,t.pageX-l.left,t.pageY-l.top),at(e)||u||this.zt(),e.dG=!0))},jt.prototype.tC=function(){var e=this;e.RB||(w.GC$(d).bind("mousemove.gcSheet."+e.nIb,function(t){e.BD(t)}).bind("mouseup.gcSheet."+e.nIb,function(t){e.CD(t)}),e.RB=!0)},jt.prototype.uC=function(){this.RB&&(this.RB=!1,w.GC$(d).unbind("mousemove.gcSheet."+this.nIb).unbind("mouseup.gcSheet."+this.nIb))},jt.prototype.cG=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d=this,g=d.kj,m=g.hitTest(e,o),y=m.row,b=m.col,v=m.dragInfo,C=m.formulaRangeHitInfo,w=m.cellTypeHitInfo,x=m.resizeTableHitInfo,T={hitInfo:m,e:t,r:E};if(A.Worksheet.ao(g,"processMouseDown",T),e>=(n=g.am()).x&&o>=n.y){if(g.yt=m,T.r)return;if(d.eG=!0,m.tableSelectInfo&&!g._formulaTextBox)this.oIb(m,g);else if(m.resizeInfo){if(!st(g))return;d.fG(m)}else if(m.dragMergeInfo){if(!st(g))return;d.Zia&&d.Zia(m)}else if(v&&v.side&&v.side!==q){if(!st(g))return;d.gG&&d.gG(m),d.lG(t)}else if(v&&v.side===q){if(!st(g))return;d.hG&&d.hG(m)}else if(m.filterButtonHitInfo)st(g);else if(C)C.inBorder?d.iG(m):(C.inTopLeft||C.inTopRight||C.inBottomLeft||C.inBottomRight)&&d.jG(m);else if(x)d.pIb&&d.pIb(m);else if(g.Qs(ft(m)<0?-1:y,pt(m)<0?-1:b)){if(m.tableSelectInfo&&g._formulaTextBox&&(r=g._formulaTextBox,i=this.qgc(m,g),m.tableSelectInfo.tableSelection=i,r.rgc(i)),d.kG&&d.kG(g,m))return;if(a=gt(g),s=mt(g),w){if(l=g.getCellType(w.row,w.col,dt(m)),w.sheet||(w.sheet=g),d.Sia(l,w)&&(u=w.sheetArea,(M(u)||3===u)&&(y!==a||b!==s))){g.suspendPaint();try{if(!st(g))return;if(c=St(g,g.name(),a,s,D,!0),g.Wq(S.Events.LeaveCell,c),c&&!0===c.cancel)return;h=g._modelManager.getSelections(),f=g._modelManager.getSpan(y,b),p=[new S.Range(f.row,f.col,f.rowCount,f.colCount)],g.Wq(S.Events.FloatingElementSelected,{type:"worksheet"}),g.yu(h,p),g.Sr(y,b,D,D,1),g.Wq(S.Events.EnterCell,St(g,g.name(),y,b)),g.Wq(S.Events.FormulatextboxEnterCell,St(g,g.name(),y,b)),g.Au(h),g.Uja=!0,d.cs&&d.cs(y,b)}finally{g.resumePaint()}}l.processCellAndPaddingMouseDown(w)}if(w&&w.isReservedLocation)return!0;d.lG(t),d.Ala(g,m,y,b)}}},jt.prototype.Ala=function(t,e,o,n){var r,i;try{if(this.mG=e,at(t)&&!st(t))return}finally{this.mG=E}M(o)||M(n)||(3===dt(e)&&this.cs&&this.cs(o,n),t.Wq(S.Events.FloatingElementSelected,{type:"worksheet"}),r=t._modelManager.getSelections(),this.nG(e,r),i=t._modelManager.getSelections(),t.yu(r,i))},jt.prototype.Sia=function(t,e){return t&&e&&e.isReservedLocation&&(!t.activeOnClick||t.activeOnClick())},jt.prototype.oG=function(t){var e,o=this.kj;return!o||(e=o.am(),M(t.x)||M(t.y)||M(t.width)||M(t.height)||t.x+t.width>e.pt+o.rKc(e)+e.js||t.y+t.height>e.qt+o.oKc(e)+e.gs)},jt.prototype.pG=function(t,e,o,n,r){var i,a,s,l,u,c,h,f=this.kj;for(a=0,l=(s=t.options).length;a<l;a++)if(s[a].selected){i=n[a].value;break}u=!1,!f.options.isProtected||(c=f.getActualStyle(e,o))&&(u=c.locked),i===D||u||(h={cmd:"editCell",sheetName:f.name(),row:e,col:o,newValue:i,autoFormat:!0,ignoreFormatting:r},f.wu().execute(h)),w.GC$(t).hide()},jt.prototype.qG=function(){var t;this.rG&&(3!==(t=this.rG.sG)&&2!==t||this.aG().tG(this.uG),3!==t&&1!==t||this._F().tG(this.vG))},jt.prototype.wG=function(){var t=this;t.xG&&t.yG(),t.$ia&&t._ia&&t._ia(),t.zG&&t.AG&&t.AG(),t.BG&&t.CG&&t.CG(),t.DG&&t.EG(),t.FG&&t.GG(),t.HG&&t.IG(),t.qIb&&t.rIb&&t.rIb()},jt.prototype.uG=function(t){var e,o,n,r,i,a,s,l;this.JG()||(e=this.rG,o=this.kj,n=e.KG,r=o.getViewportTopRow(n),i=o.getViewportBottomRow(n),t?i<ct(o)-o.frozenTrailingRowCount()-1?o.mq(o._q(r)):(a=o.Gr(n))&&0<a.length&&(s=o.am(),(l=a[a.length-1]).y+l.height>=s.qt+o.oKc(s)&&o.mq(o._q(r))):r>lt(o)&&o.mq(o.gr(r))),this.wG()},jt.prototype.vG=function(t){var e,o,n,r,i,a,s;this.LG()||(e=this.kj,o=this.rG.MG,n=e.getViewportLeftColumn(o),r=e.getViewportRightColumn(o),t?r<ht(e)-e.frozenTrailingColumnCount()-1?e.rq(e.Zq(n)):(i=e.Hr(o))&&0<i.length&&(a=e.am(),(s=i[i.length-1]).x+s.width>=a.pt+e.rKc(a)&&e.rq(e.Zq(n))):n>ut(e)&&e.rq(e.br(n))),this.wG()},jt.prototype.JG=function(){var t,e,o,n,r,i,a=this.kj,s=a.am(),l=lt(a),u=a.frozenTrailingRowCount(),c=this.$F,h=this.rG,f=h.KG;if(0===f){if(c.y>s.qt)return a.mq(a._t()),h.KG=1,!0}else if(1===f){if((t=a.Gr(1))&&0<t.length){if(e=t[0],0<l&&c.y<s.qt&&e.row<=a._t())return!(h.KG=0);if(e=t[t.length-1],0<u&&c.y>s.ot&&e.row>=a.ir()&&e.y+e.height<=s.ot)return h.KG=2,!0}}else if(2===f&&(t=a.Gr(1))&&0<t.length&&c.y<s.ot){if((e=t[t.length-1]).y+e.height>s.ot){for(o=a.oKc(s),r=0,i=n=ct(a)-u-1;l<=i;i--)if(o<(r+=a.Sl(i))){n=P(i+1,n);break}a.mq(a._q(n-1))}return h.KG=1,!0}return!1},jt.prototype.LG=function(){var t,e,o,n,r,i,a=this.kj,s=a.frozenTrailingColumnCount(),l=ut(a),u=a.am(),c=this.$F,h=this.rG,f=h.MG;if(0===f){if(c.x>u.pt)return a.rq(a.$t()),h.MG=1,!0}else if(1===f){if((t=a.Hr(1))&&0<t.length){if(e=t[0],0<l&&c.x<u.pt&&e.col<=a.$t())return!(h.MG=0);if(e=t[t.length-1],0<s&&c.x>u.lt&&e.col>=a.dr()&&e.x+e.width<=u.lt)return h.MG=2,!0}}else if(2===f&&(t=a.Hr(1))&&0<t.length&&c.x<u.lt){if((e=t[t.length-1]).x+e.width>u.lt){for(o=a.rKc(u),r=0,i=n=ht(a)-s-1;l<=i;i--)if(o<(r+=a.Tl(i))){n=P(i+1,n);break}a.rq(a.Zq(n-1))}return h.MG=1,!0}return!1},jt.prototype.NG=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d=this;(d._isWorking||d.O3||d.lV)&&(e=(t=d.kj).am(),o=d.rG,M(o)||(n=o.KG,r=o.MG,i=d.$F,a=E,0<=n&&0<=r?(a=e.Ft(n,r),0===n&&t.lq===t.frozenRowCount()&&(s=e.Ft(1,r),a.height+=s.height),0===r&&t.qq===t.frozenColumnCount()&&(s=e.Ft(n,1),a.width+=s.width)):0<=n?a=e.fm(n):0<=r&&(a=e.gm(r)),a&&(u=(l=t.parent)&&l.options.scrollbarAppearance===g.ScrollbarAppearance.mobile,h=c=0,p=f=!1,i.x<=a.x?(c=i.x-a.x,u&&(p=!0)):i.x>=a.x+a.width?(0==(c=i.x-(a.x+a.width))&&(c=50),u&&(p=!0)):u&&i.x===a.x+a.width-1&&(c=50,p=!0),i.y<=a.y?(h=i.y-a.y,u&&(f=!0)):i.y>=a.y+a.height&&(h=i.y-(a.y+a.height),u&&(f=!0)),l&&u&&(f&&(l.nKc.Jwa(g.ScrollbarState.show),l.ku.Rdc(!0)),p&&(l.kKc.Jwa(g.ScrollbarState.show),l.ku.Rdc(!1))),d._F().PG(d.QG(c)),d.aG().PG(d.QG(h)))))},jt.prototype.RG=function(){this._F().SG(),this.aG().SG()},jt.prototype.fG=function(t){var e,o,n,r,i,a,s=this,l=h.yp.prototype,u=s.kj,c=t.resizeInfo;c.action===Y||c.action===K?(e=It(s,u.Jt,s.TG,l.findRow,t.row,c,!0),c.startY=e.y):(o=It(s,u.Kt,s.UG,l.findCol,t.col,c,!1),c.startX=o.x),n=u.parent,r=t.x,i=t.y,n&&((1!==(a=n.options.showResizeTip)||c.action!==Q&&c.action!==X)&&(2!==a||c.action!==Y&&c.action!==K)&&3!==a||(i-30<0?i+=15:i-=30,n.uw(f.Ob(s.VG()),r,i))),s.isResizing=!0,s._isWorking=!0,s.ctrl&&(s.fCb=!0)},jt.prototype.WG=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v=this.kj,C=v.yt,w=C.resizeInfo,x=this.$F,T=x.x,A=x.y,S=v.am(),M=v.parent,I=w.sheetArea;w&&this._isWorking&&this.isResizing&&(C.x===T&&C.y===A||(w.action===Y||w.action===K?(h=v,f=w,p=I,d=A,g=this.fCb,y=f.index,b=h.am(),kt(h,f,g)?(m=h._q(y,p),Nt(f,d,b,!0,h.Sl(y,p)+h.Sl(m,p))):Nt(f,d,b,!0)):(n=v,r=w,i=I,a=T,s=this.fCb,u=r.index,c=n.am(),Et(n,r,s)?(l=n.Zq(u,i),Nt(r,a,c,!1,n.Tl(u,i)+n.Tl(l,i))):Nt(r,a,c,!1)),e=(t=v._render).bm(),t.Mx(S.x,S.y,S.width,S.height),t.Pw(e),M&&((1!==(o=M.options.showResizeTip)||w.action!==Q&&w.action!==X)&&(2!==o||w.action!==Y&&w.action!==K)&&3!==o||M.ww(this.XG(w)))))},jt.prototype.YG=function(){var t,n,e,r,o,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C=this;C.isResizing=!1,t=!(C._isWorking=!1),e=(n=C.kj).yt,(r=e.resizeInfo)&&(C.xw(),r.action===Y||r.action===K?M(r.movingY)?t=!1:(o=O(0,(r.movingY-r.startY)/n.zoom()),i=[],a="resizeRow",n.tp(r.index)?w.GC$.each(n._modelManager.getSelections(),function(t,e){if(-1===e.col)if(1===r.sheetArea)i.push({firstRow:r.index,lastRow:r.index});else{var o=n.Tq(e);i.push({firstRow:o.row,lastRow:o.row+Tt(o)-1})}}):i.push({firstRow:r.index,lastRow:r.index}),m=n,y=r,b=i,v=C.fCb,kt(m,y,v)&&1===b.length&&b[0].firstRow===b[0].lastRow&&(a="splitResizeRow"),s=1===r.sheetArea,n.wu().execute({cmd:a,sheetName:n.name(),rows:i,size:o,columnHeader:s})):M(r.movingX)?t=!1:(o=O(0,(r.movingX-r.startX)/n.zoom()),l=[],u="resizeColumn",n.sp(r.index)?w.GC$.each(n._modelManager.getSelections(),function(t,e){if(-1===e.row){var o=n.Tq(e);2===r.sheetArea?l.push({firstCol:r.index,lastCol:r.index}):l.push({firstCol:o.col,lastCol:o.col+xt(o)-1})}}):l.push({firstCol:r.index,lastCol:r.index}),f=n,p=r,d=l,g=C.fCb,Et(f,p,g)&&1===d.length&&d[0].firstColumn===d[0].lastColumn&&(u="splitResizeColumn"),c=2===r.sheetArea,n.wu().execute({cmd:u,sheetName:n.name(),columns:l,size:o,rowHeader:c})),(h=n.hitTest(C.$F.x,C.$F.y))&&C.Tw(h),t||n.repaint(),C.fCb=!1)},jt.prototype.ZG=function(t,e){var o,n,r,i,a,s,l=0,u=0,c=0,h=0,f=this,p=f.kj,d=p.wq,g=lt(p),m=ut(p),y=dt(t);if(f.o4=f.$G=p._modelManager.getSelections(),p.isCtrlPressed(y)||f.shift||p.Tr(),0===y){if(!f.shift&&Mt(f,o=g?p.ar():p.lq,m?p.$q():p.qq,1,1,e))return;p.isCtrlPressed(y)||p.Tr(),p.Ur(-1,-1,ct(p),ht(p),!0)}else if(1===y){if(!f.shift&&(o=g?p.ar():p.lq,n=f._G(o,t.col,!1),Mt(f,n.row,n.col,1,pt(t),e)))return;f.shift||p.n_a?(l=P(p.Kl,t.col),h=L(p.Kl-t.col)+1,p.Kx(-1,l,ct(p),h,!0)):p.Ur(-1,p.Kl,ct(p),1,!0)}else if(2===y){if(!f.shift){if(i=m?p.$q():p.qq,n=f._G(t.row,i,!0),r=p.Jl!==n.row,Mt(f,n.row,n.col,ft(t),1,e))return;r&&d&&d.Lx()}f.shift||p.n_a?(u=P(p.Jl,t.row),c=L(p.Jl-t.row)+1,p.Kx(u,-1,c,ht(p),!0)):p.Ur(p.Jl,-1,1,ht(p),!0)}else if(3===y)if(j(t.row)||j(t.col))at(p)&&(s=p.getCellRect(p.Jl,p.Kl,p.Nr,p.Pr),p._render.VF(s.x,s.y,s.width,s.height));else{if(!f.shift&&(p.Jl!==t.row||p.Kl!==t.col)){if(r=p.Jl!==t.row,Mt(f,t.row,t.col,ft(t),pt(t),e))return;r&&d&&d.Lx()}f.shift?p.aH(t.row,t.col,!0):(a=p._modelManager.getSpan(t.row,t.col),p.n_a||p.Ur(a.row,a.col,Tt(a),xt(a),!0))}},jt.prototype.bH=function(t){!t||3===dt(t)&&(j(t.row)||j(t.col))||(this._isWorking=!0,this.xG=!0,this.rG={KG:ft(t),MG:pt(t),sG:dt(t)},this.qG())},jt.prototype.ayb=function(t,e){var o=this.kj,n=o.getSpan(t,e),r=t,i=e,a=1,s=1,l=o.selectionUnit(),u=!1;return 1===l?(s=i=-1,r=n?n.row:r,a=n?n.rowCount:a):2===l?(a=r=-1,i=n?n.col:i,s=n?n.colCount:s):u=!0,n&&u?n:new S.Range(r,i,a,s)},jt.prototype.nG=function(t,e){var o=this.kj,n=t.row,r=t.col;o.n_a=this.I0a(n,r,e,dt(t))&&o.parent.options.allowUserDeselect,o.n_a&&(o.s_a=o.Jl,o.t_a=o.Kl,o.p_a=this.ayb(n,r)),this.ZG(t),this.bH(t)},jt.prototype.I0a=function(t,e,o,n){var r=this.kj;return this.o_a(t,e,o,n)&&2===r.selectionPolicy()},jt.prototype.o_a=function(t,e,o,n){var r,i,a,s=this.kj,l=s.getRowCount(),u=s.getColumnCount();if(!s.isCtrlPressed(n))return!1;for(r=!1,i=o.length,a=0;a<i;a++)if(3===n){if(o[a].contains(t,e,1,1)){r=!0;break}}else if(2===n){if(o[a].contains(t,-1,1,u)||o[a].contains(t,0,1,u)){r=!0;break}}else if(1===n&&(o[a].contains(-1,e,l,1)||o[a].contains(0,e,l,1))){r=!0;break}return r},jt.prototype.yG=function(){var t;this.rG&&this._isWorking&&!0!==this.DA&&(3===(t=this.rG.sG)?this.cH():2===t?this.dH():1===t&&this.eH())},jt.prototype.cH=function(){var t,e,o,n,r=this.kj,i=this.fH(),a=this.gH();if(0<=i&&0<=a&&r.Qs(i,a)){if(this.NG(),1===(t=r._modelManager.getSelections()).length&&(e=r.Jx(i,a,r.Jl,r.Kl),o=t[0],!r.n_a&&e.equals(o)))return;r.aH(i,a,!0),n=r._modelManager.getSelections(),r.yu(t,n)}},jt.prototype.dH=function(){var t,e,o,n,r,i=this.kj,a=this.fH(!0);if(0<=a&&i.Qs(a,-1)){if(t=P(i.Jl,a),e=O(i.Jl,a)-t+1,o=ht(i),0===i.selectionPolicy())return;2===i.selectionUnit()&&(e=t=-1),n=i._modelManager.getSelections(),i.Kx(t,-1,e,o,!0),r=i._modelManager.getSelections(),i.yu(n,r)}this.NG()},jt.prototype.eH=function(){var t,e,o,n,r,i=this.kj,a=this.gH(!0);if(0<=a&&i.Qs(-1,a)){if(t=P(i.Kl,a),e=O(i.Kl,a)-t+1,o=ct(i),0===i.selectionPolicy())return;1===i.selectionUnit()&&(e=t=-1),n=i._modelManager.getSelections(),i.Kx(-1,t,o,e,!0),r=i._modelManager.getSelections(),i.yu(n,r)}this.NG()},jt.prototype.hH=function(){var t,e,o,n,r=this;r.rG=E,r.RG(),r.DA=E,r._isWorking=!1,r.xG=!1,0!==(t=r.kj)._modelManager.getSelections().length&&(t.n_a&&(t.n_a=!1,e=t.p_a,t.p_a=null,t.u_a(t._modelManager.getSelections(),e),delete t.s_a,delete t.t_a),t.Uja?delete t.Uja:((o=!r.$G)||(n=t._modelManager.getSelections(),o=r.zu(r.$G,n)),o&&t.Au(r.o4)),r.$G=t._modelManager.getSelections())},jt.prototype.iH=function(){var t,e,o,n=this.kj,r=(t=n,e=this.$F.y,o=t.am(),0<lt(t)&&e<o.nt+o.fs?0:0<t.frozenTrailingRowCount()&&e>o.ot?2:1),i=this.rG.KG,a=n.Gr(1);return(0===r&&0<i&&0<a.length&&a[0].row>n._t()||2===r&&i<2&&0<a.length&&a[a.length-1].row<n.ir())&&(r=1),r},jt.prototype.jH=function(){var t,e,o,n=this.kj,r=(t=n,e=this.$F.x,o=t.am(),0<ut(t)&&e<o.kt+o.hs?0:0<t.frozenTrailingColumnCount()&&e>o.lt?2:1),i=this.rG.MG,a=n.Hr(1);return(0===r&&0<i&&0<a.length&&a[0].col>n.$t()||2===r&&i<2&&0<a.length&&a[a.length-1].col<n.dr())&&(r=1),r},jt.prototype.fH=function(t){var e,o,n,r,i,a,s=this.kj,l=this.$F.y,u=this.iH(),c=(r=u,i=l,(a=s.Gr(r))?a.findNearY(i):E);if(c){if(e=s.am(),o=c.row,1===u&&l<e.qt){if((n=s._t())<o)return s._q(o-1)||o;if(o===n&&t)return 0}else if(0===u&&l<e.nt&&t)return 0;return 1===u&&l>e.ot&&o>s.hr()&&s.gr(o)||o}return-1},jt.prototype.gH=function(t){var e,o,n,r,i,a,s=this.kj,l=this.$F.x,u=this.jH(),c=(r=u,i=l,(a=s.Hr(r))?a.findNearX(i):E);if(c){if(e=s.am(),o=c.col,1===u&&l<e.pt){if((n=s.$t())<o)return s.Zq(o-1)||o;if(o===n&&t)return 0}else if(0===u&&l<e.kt&&t)return 0;return 1===u&&l>e.lt&&o>s.cr()&&s.br(o)||o}return-1},jt.prototype.QG=function(t){var e,o=0;return j(t)||0===t||(e=t<0,o=a(500/L(t)),200<(o=O(20,10*o))&&(o=200),e&&(o=-o)),o},jt.prototype.TG=function(t,e){var o=this.kj.gr(t,e);return o!==E?o:t},jt.prototype.UG=function(t,e){var o=this.kj.br(t,e);return o!==E?o:t},jt.prototype.kH=function(t,e,o){for(var n=this.kj;e<t;)if(t--,n.getRowVisible(t,o))return t;return t},jt.prototype.lH=function(t,e,o){for(var n=this.kj;e<t;)if(t--,n.getColumnVisible(t,o))return t;return t},jt.prototype.mH=function(t,e,o,n,r){var i,a,s,l,u,c,h,f=E;return(h=t).options.isProtected&&!h.options.protectionOptions.allowResizeRows||(!(i=t.Gr(ft(e),n))||j(e.row)||j(e.col)||(t.getRowVisible(e.row,n)||(e.row=this.TG(e.row,n)),(a=i.findRow(e.row))&&(a.y+a.height-o<=r&&r<=a.y+a.height+o?(f=At(Y,e.row,n),0<=(s=i[i.length-1].row)&&(l=t.ir(n),f.index===l&&f.index!==s&&a.y+a.height-o/2<=r&&(f=At(this.nH(t,s,n),s,n)))):a.y-o<=r&&r<=a.y+o&&0<p.Common.k.Cb(i,a)&&(u=this.kH(e.row,0,n),f=At(this.nH(t,u,n),u,n))),!f&&1===ft(e)&&0<i.length&&(a=i[0],O(0,a.y-o)<=r&&r<=a.y+o&&0<=(c=Dt(t,e.row,!0))&&(f=At(this.nH(t,c,n),c,n)))),f&&!t.getRowResizable(f.index,n)&&(f=E)),f},jt.prototype.nH=function(t,e,o){var n=t.parent;return n&&1===n.options.resizeZeroIndicator&&t.getRowVisible(e)&&0===t.Yr(e,o)?K:Y},jt.prototype.oH=function(t,e,o,n,r){var i,a,s,l,u,c,h,f=E;return(h=t).options.isProtected&&!h.options.protectionOptions.allowResizeColumns||(!(i=t.Hr(pt(e),n))||j(e.col)||j(e.row)||(t.getColumnVisible(e.col,n)||(e.col=this.UG(e.col,n)),(a=i.findCol(e.col))&&(a.x+a.width-o<=r&&r<=a.x+a.width+o?(f=At(Q,e.col,n),0<=(s=i[i.length-1].col)&&(l=t.dr(n),f.index===l&&f.index!==s&&a.x+a.width-o/2<=r&&(f=At(this.pH(t,s,n),s,n)))):a.x-o<=r&&r<=a.x+o&&0<p.Common.k.Cb(i,a)&&(u=this.lH(e.col,0,n),f=At(this.pH(t,u,n),u,n))),!f&&1===pt(e)&&0<i.length&&(a=i[0],O(0,a.x-o)<=r&&r<=a.x+o&&0<=(c=Dt(t,e.col,!1))&&(f=At(this.pH(t,c,n),c,n)))),f&&!t.getColumnResizable(f.index,n)&&(f=E)),f},jt.prototype.pH=function(t,e,o){var n=t.parent;return n&&1===n.options.resizeZeroIndicator&&t.getColumnVisible(e)&&0===t.$r(e,o)?X:Q},jt.prototype.ur=function(t,e,o,n){var r,i,a,s,l,u,c,h=this.kj,f=h.parent,p=h.options,d=p.colHeaderVisible,g=p.rowHeaderVisible,m=E;return f&&!f.options.allowUserResize||(a=h.am(),ft(t)<0&&0<=pt(t)&&d?m=(m=this.oH(h,t,n,1,e))||this.mH(h,t,n,1,o):0<=ft(t)&&pt(t)<0&&g?m=(m=this.mH(h,t,n,2,o))||this.oH(h,t,n,2,e):ft(t)<0&&pt(t)<0?h.ir(2)===E&&L(o-a.Cr)<=n?(s=h.Gr(1))&&0<s.length&&0<=(r=s[s.length-1].row)&&h.getRowResizable(r,2)&&(m=At(this.nH(h,r,2),r,2)):h.dr(1)===E&&L(e-a.Br)<=n&&(l=h.Hr(1))&&0<l.length&&0<=(i=l[l.length-1].col)&&h.getColumnResizable(i,1)&&(m=At(this.pH(h,i,1),i,1)):0<=ft(t)&&0<=pt(t)&&(r=ct(h,1)-1,i=ht(h,2)-1,u=h.options.sheetAreaOffset.top,c=h.options.sheetAreaOffset.left,0<=r&&0===a.Cr&&u<=o&&o<=n+u&&d?m=At(this.nH(h,r,1),r,1):0<=i&&0===a.Br&&c<=e&&e<=n+c&&g&&(m=At(this.pH(h,i,2),i,2)))),m},jt.prototype.qH=function(t,e,o,n){var r,i,a,s,l=this.kj,u=l.am().Ft(1,1);if(1===e)if((r=l.Hr(e))&&0<r.length){if((i=r[r.length-1]).x+i.width<=o&&o<u.x+u.width)return!0}else if(u.contains(o,n))return!0;if(1===t)if((a=l.Gr(t))&&0<a.length){if((s=a[a.length-1]).y+s.height<=n&&n<u.y+u.height)return!0}else if(u.contains(o,n))return!0;return!1},jt.prototype.BD=function(t){var e=this.Vs();this.sH(t,t.pageX-e.left,t.pageY-e.top)},jt.prototype.DD=function(){var t,e,o,n,r,i=this.kj,a=i.yt;!a||(t=a.cellTypeHitInfo)&&i.getCellType(t.row,t.col,dt(a)).ZBb(t),this._isWorking||(e={x:-1e4,y:-1e4,rowViewportIndex:E,colViewportIndex:E,row:-1,col:-1,resizeInfo:E,hitTestType:E},this.Uw(e),a&&(o=a.row,n=a.col,r=i.getActualStyle(o,n),i.RLc&&(clearTimeout(i.RLc),delete i.RLc),i.parent&&r&&r.showEllipsis&&i.parent.xw()))},jt.prototype.sH=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g=this;return g.$F={e:t,x:e,y:o},n=g.kj,g.eG&&!S.Vl.Wl(n)&&S.Vl.Zl(n),g.eG&&g._isWorking?void(g.isResizing?g.WG():g.$ia?g._ia&&g._ia():g.zG?g.AG&&g.AG():g.BG?g.CG&&g.CG():g.DG?g.EG():g.FG?g.GG():g.HG?g.IG():g.qIb?g.rIb&&g.rIb():g.xG&&g.yG()):(r=n.hitTest(e,o),g.sIb(n,r,g),void(r&&(0===g.mIb&&r.tableSelectInfo&&g.eG&&g.tIb(n,g,r),i=n.parent,a=r.row,s=r.col,l=n.sr(r.rowViewportIndex,r.colViewportIndex),h=r.pivotTableInfo,f=!M(h)&&h.options.showToolTip,i?(c=n.getActualStyle(a,s,l),p=n.getCellRect(a,s,r.rowViewportIndex,r.colViewportIndex),!f||n.isEditing&&n.isEditing()?(clearTimeout(n.RLc),delete n.RLc,(u=n._modelManager.uIb(a,s,l))&&!1!==c.THb&&l?i.uw(u,p.x+p.width+5,p.y+p.height+5,!1):i.options.showScrollTip&&(i.nKc.JB||i.kKc.JB)||i.xw()):(u=h.UOc(a,s),clearTimeout(n.RLc),delete n.RLc,i.xw(),u&&!1!==c.THb&&(n.RLc=setTimeout(function(t,e){i.uw(u,t,e+15,!1,"gc-spread-pivot-toolTip")}.bind(void 0,r.x,r.y),700)))):(clearTimeout(n.RLc),delete n.RLc),g.Tw(r),i&&i.options.enableAccessibility&&(d=n.cgc(r),i.dgc(d)),g.Uw(r))))},jt.prototype.sIb=function(t,e,o){var n,r,i,a,s;1===o.mIb?(n=o.vIb.row,r=o.vIb.col,i=e.col,a=t.getSelections()[0],t.Kx(n,i<r?i:r,a.rowCount,0<r-i?r-i+1:i-r+1,!0)):2===o.mIb&&(n=o.vIb.row,r=o.vIb.col,s=e.row,a=t.getSelections()[0],t.Kx(s<n?s:n,r,0<n-s?n-s+1:s-n+1,a.colCount,!0))},jt.prototype.tIb=function(t,e,o){var n,r=t.getActiveRowIndex(),i=t.getActiveColumnIndex();e.vIb={row:r,col:i},"tableColSelect"===(n=o.tableSelectInfo.action)?e.mIb=1:"tableRowSelect"===n&&(e.mIb=2)},jt.prototype.Tw=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y=this.kj,b=y.Ws();b&&(n=!(e=y.yt)||t.row!==e.row||t.col!==e.col||dt(t)!==dt(e)||t.resizeInfo&&!e.resizeInfo||!t.resizeInfo&&e.resizeInfo||t.resizeInfo&&t.resizeInfo.action!==e.resizeInfo.action||t.dragInfo&&!e.dragInfo||!t.dragInfo&&e.dragInfo||t.dragInfo&&t.dragInfo.action!==e.dragInfo.action||t.resizeTableHitInfo&&!e.resizeTableHitInfo||!t.cellTypeHitInfo&&e.cellTypeHitInfo,e&&n&&(r=e.cellTypeHitInfo)&&(o=y.getCellType(r.row,r.col,dt(e))).ZBb(r),i=t.resizeInfo,a=t.dragMergeInfo,s=t.dragInfo,l=t.formulaRangeHitInfo,u=t.cellTypeHitInfo,c=y._render,h=t.resizeTableHitInfo,(f=t.tableSelectInfo)?"tableRowSelect"===f.action?b.style.cursor="url(data:image/ico;base64,AAABAAEACAgAAAEAIABIAQAAFgAAACgAAAAIAAAAEAAAAAEAIAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAATQAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAACtAAAAkAAAAAsAAAAAAAAAeAAAAHkAAAB5AAAAewAAANcAAAD9AAAAjAAAAA0AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD5AAAAngAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAPkAAACeAAAAeAAAAHkAAAB5AAAAewAAANcAAAD9AAAAjAAAAA0AAAAAAAAAAAAAAAAAAAAFAAAArQAAAJAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAUAAABNAAAAEQAAAAAAAAAA4wAAAOEAAAAAAAAAAAAAAAAAAAAAAAAA4QAAAOMAAAA=) 8 4,auto":"tableColSelect"===f.action?b.style.cursor="url(data:image/ico;base64,AAABAAEACAgAAAEAIABIAQAAFgAAACgAAAAIAAAAEAAAAAEAIAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAACKAAAAigAAAAgAAAAAAAAAAAAAAAAAAAAHAAAAfAAAAPYAAAD2AAAAewAAAAcAAAAAAAAACAAAAHwAAAD3AAAA/wAAAP8AAAD3AAAAfAAAAAgAAAAVAAAAVwAAAJ8AAAD/AAAA/wAAAJ4AAABXAAAAFQAAAAAAAAAAAAAAYAAAAP8AAAD/AAAAYAAAAAAAAAAAAAAAAAAAAAAAAABgAAAA/wAAAP8AAABgAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAD/AAAA/wAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAXwAAAPwAAAD8AAAAXwAAAAAAAAAAwwAAAIEAAAAAAAAAAAAAAMMAAADDAAAAwwAAAMMAAAA=) 8 4,auto":"tableCornerSelect"===f.action?b.style.cursor="url(data:image/ico;base64,AAABAAEACgoAAAEAIADgAQAAFgAAACgAAAAKAAAAFAAAAAEAIAAAAAAAkAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAACTAAAA/QAAAP8AAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAEwAAAJ8AAAD8AAAA/wAAAP8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAoAAAA3AAAAP8AAAD/AAAA/wAAAP8AAAAAAAAAAAAAAAAAAAATAAAAngAAAPwAAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAASAAAAnwAAAP0AAAD/AAAA+gAAANwAAAD6AAAA/wAAAAAAAAASAAAAnwAAAP0AAAD/AAAA/QAAAJ4AAAAlAAAAnwAAAP0AAAAVAAAAngAAAP0AAAD/AAAA/QAAAJ8AAAASAAAAAAAAABQAAACTAAAApwAAAP0AAAD/AAAA/QAAAJ8AAAASAAAAAAAAAAAAAAAAAAAACgAAAG0AAADqAAAA/gAAAJ4AAAASAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAbQAAAKgAAAAWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAOAAAADwAAAA4AAAAMAAAACAAAAAAQAAAAOAAAAHwAAAD8AAAA==) 10 5,auto":"tableSelect"===f.action?b.style.cursor="move":"default"===f.action&&(b.style.cursor=""):i?i.action===Q?b.style.cursor=S.CursorResource.ResizeCol:i.action===Y?b.style.cursor=S.CursorResource.ResizeRow:i.action===X?b.style.cursor=S.CursorResource.ResizeHiddenCol:i.action===K?b.style.cursor=S.CursorResource.ResizeHiddenRow:b.style.cursor=$:a?a.left||a.right?b.style.cursor="w-resize":(a.top||a.bottom)&&(b.style.cursor="n-resize"):s&&"drag"===s.action?s.side===q?b.style.cursor="crosshair":s.side?b.style.cursor="move":b.style.cursor=$:l?(l.inBorder?b.style.cursor="move":l.inTopLeft?b.style.cursor="nw-resize":l.inTopRight?b.style.cursor="ne-resize":l.inBottomLeft?b.style.cursor="sw-resize":l.inBottomRight&&(b.style.cursor="se-resize"),p=this.isFormulaRangeHoving,g=(d=this.tH)&&d.paramRange,m=l.paramRange,this.isFormulaRangeHoving=!0,this.tH={paramRange:m},p&&m.index===g.index||c._paintFormulaTextBox()):h?b.style.cursor="se-resize":(u&&(o=y.getCellType(u.row,u.col,dt(t)),u.sheet=y,n&&o.processMouseEnter(u),o.YBb(u)),!n&&u&&u.isReservedLocation||(b.style.cursor=$),this.isFormulaRangeHoving&&(this.isFormulaRangeHoving=!1,this.tH=E,c._paintFormulaTextBox())))},jt.prototype.CD=function(t){var e=this.kj;return this.uC(),!e.dG||(e.dG=!1,this.vH(t),!1)},jt.prototype.vH=function(t){var e,o,n,r=this,i=r.kj,a=S.Vl.Xl();r.eG=!1,r.mIb=0,a&&a!==i&&a.endEdit&&(Kt&&Kt._legacyWynbi&&Kt._legacyWynbi.spreadChartEditState&&Kt._legacyWynbi.spreadChartEditState.enableReferenceCrossSpread||a._formulaTextBox&&a._formulaTextBox._isSelectMode||(a.endEdit(),a.repaint())),S.Vl.Zl(i),r.isResizing?r.YG():r.$ia?r.aja&&r.aja():r.zG?r.wH&&r.wH():r.BG?r.xH&&r.xH():r.DG?r.yH():r.FG?r.zH():r.HG?r.AH():r.qIb?r.wIb&&r.wIb():i.yt&&(o=(e=i.yt).cellTypeHitInfo,!e.filterButtonHitInfo&&!e.resizeInfo&&0<=e.row&&0<=e.col&&(o&&(n=i.getCellType(o.row,o.col,dt(e)),o.sheet||(o.sheet=i),n.XGb(o)),o&&o.isReservedLocation||i.Wq(S.Events.CellClick,St(i,i.name(),e.row,e.col,dt(e))),r.hH(),i.sgc&&i.tgc&&i.tgc())),r.SLc=!1,r.lG(t)},jt.prototype._startEdit=function(t,e,o){var n,r=this.kj;r.isEditing&&r===S.Vl.Xl()&&(n=r.Ws(),vt(t)||bt(t)||r.FF(n,e,o))},jt.prototype.nm=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p=this.kj;if(p){if(e=gt(p),o=mt(p),n=p.getCellType(e,o),r={isEditing:at(p),sheet:p,row:e,col:o,sheetArea:3},i={sheet:p,row:e,col:o,sheetArea:3},n&&n.isReservedKey(t,r))return void(at(p)||n.processKeyDown(t,i));if((a=p._formulaTextBox)&&a.BH(t))return;if((s=p.parent&&p.parent.CF)&&s.BH(t,r))return}if(l=!(at(p)||bt(t)||wt(t)||34!==yt(t)&&33!==yt(t)&&37!==yt(t)&&39!==yt(t)&&9!==yt(t)&&13!==yt(t)&&38!==yt(t)&&40!==yt(t)),p.CH&&(p.CH=!1,p._render.DH()),h=13===(c=yt(t)),f=27===c,p.sgc&&p.ugc&&(h||f)?p.ugc(f):u=this.EH(t),l&&u&&S.Vl.Wl(p)){if(this.Uoa=new Date,this.FH)return this.GH<25&&this.GH++,void y(t);this.FH=!0,this.GH=1,this.HH(t,!0)}},jt.prototype.VG=function(){var t,e,o=this.kj,n=o.yt.resizeInfo;return n.action===Y||n.action===K?(t=o.getRowHeight(n.index),r(ot().Tip_Height,[t])):(e=o.getColumnWidth(n.index),r(ot().Tip_Width,[e]))},jt.prototype.XG=function(t){var e=this.kj;return t.action===Y||t.action===K?r(ot().Tip_Height,[O(0,F((t.movingY-t.startY)/e.zoom()))]):r(ot().Tip_Width,[O(0,F((t.movingX-t.startX)/e.zoom()))])},jt.prototype.HH=function(t,e){var o=this;if(o.FH){if(100<new Date-o.Uoa)return void o.Ux();e||o.EH(t),o.FH&&(o.WF=x.setTimeout(function(){o.HH(t)},500/o.GH))}},jt.prototype.IH=function(t,e){var o,n,r,i=this.kj,a=i.Ws();if(a){i.HF=!0;try{o=at(i),i.EF&&i.EF(a,i.Jl,i.Kl,E,E,!0,E,e,t),!o&&at(i)&&(!(n=i.getCellType(i.Jl,i.Kl)).tw||32!==yt(t)||bt(t)||vt(t)||Ct(t)||n.tw(i,i.Jl,i.Kl,3),n.JH&&n.JH(t))}finally{i.HF=!1,(r=i.tu()).UHb&&delete r.UHb}}},jt.prototype.EH=function(t){var e,o,n,r,i,a,s,l,u,c,h=this.kj;if(this.lG(t),at(h)||27!==yt(t)||Ct(t)||bt(t)||vt(t)||!h.KH||(w.GC$(h.KH).remove(),h.KH=E),e=h.tu(),at(h)||27!==yt(t)||Ct(t)||bt(t)||vt(t)||!e.UHb||delete e.UHb,at(h)||34!==yt(t)&&33!==yt(t)&&35!==yt(t)&&36!==yt(t)&&38!==yt(t)&&40!==yt(t)||y(t),at(h)||37!==yt(t)&&39!==yt(t)||y(t),at(h)&&bt(t)&&(89===yt(t)||90===yt(t)))return y(t),!1;if(n=(o=h.wu()).getShortcutKey(yt(t),bt(t),vt(t),Ct(t),wt(t)),r=o.getCommands(n))for(i=0;i<r.length;i++)if(a={sheetName:h.name()},(s=r[i].execute(h.parent,a))||a.vgc)return s.ignoreCancelDefault||y(t),!0;return l={e:t,r:E},A.Worksheet.ao(h,"processKeyDown",l),!!l.r||(this.LH(t)&&((u=h._formulaTextBox)&&u.MH&&u._stopAppending(),at(h)||(c=x.Yl.Bm(t.target))&&"gcAttachedFormulaTextBox"===c.getAttribute(Z)||this.IH(t)),!1)},jt.prototype.Ux=function(){this.FH=!1,0<this.WF&&(clearTimeout(this.WF),this.WF=0)},jt.prototype.om=function(t){var e,o,n,r,i,a,s,l;if(this.Ux(),e=this.kj){if(o=gt(e),n=mt(e),r=e.getCellType(o,n),i={isEditing:at(e),sheet:e,row:o,col:n,sheetArea:3},a={sheet:e,row:o,col:n,sheetArea:3},r&&r.isReservedKey(t,i))return void(at(e)||r.processKeyUp(t,a));if((s=e._formulaTextBox)&&s.BH(t))return;if((l=e.parent&&e.parent.CF)&&l.BH(t))return}this.lG(t)},jt.prototype.pm=function(t){var e=this.kj,o={e:t,r:E};A.Worksheet.ao(e,"processCompositionStart",o),o.r||this.IH(t,!0)},jt.prototype.LH=function(t){return!(bt(t)||Ct(t)||wt(t))&&(65<=yt(t)&&yt(t)<=90||48<=yt(t)&&yt(t)<=59||96<=yt(t)&&yt(t)<=105||186<=yt(t)&&yt(t)<=192||220<=yt(t)&&yt(t)<=222||219===yt(t)||106<=yt(t)&&yt(t)<=111||32===yt(t)||61===yt(t)||173===yt(t)||229===yt(t)||0===yt(t)||8===yt(t))},jt.prototype.lG=function(t){var e,o,n,r,i,a=this,s=a.kj,l=(S.Ul.sl()?wt:bt)(t);a.ctrl=l&&!vt(t),a.shift=vt(t)&&!l,s.Hx=!1,9===yt(t)&&(1<(e=s._modelManager.getSelections().length)?s.Hx=!0:(o=s._getActiveSelectedRange())&&0<e&&(s.Hx=!(s.Jl===o.row&&s.Kl===o.col&&s.Lr>=Tt(o)&&s.Mr>=xt(o)))),!0===a.zG&&(n=s._getActiveSelectedRange(),r=a.OH,i=a.PH,-1===n.row||-1===n.col?a.OH=vt(t):a.OH=!1,a.PH=l,r===a.OH&&i===a.PH||s._render.QH&&s._render.QH()),a.RH=l},jt.prototype.Vx=function(){this.shift=!1,this.ctrl=!1,this.kj.Hx=!1,this.zG=!1,this.OH=!1,this.PH=!1,this.RH=!1},jt.prototype._updateEditingEditor=function(t){var e,o,n,r,i,a,s,l,u,c,h,f;t&&t.sheet?(e=t.sheet,o=t.editor,n=t.canvasOffset):o=(e=this.kj)._editor,at(e)&&(r=e.Jl,i=e.Kl,a=e.getCellType(r,i),s=e.am(),l=e.getActualStyle(r,i),u=e.getCellRect(r,i),o&&o.parentNode&&(c=o.parentNode.parentNode,u&&0<u.width&&0<u.height&&u.x>=s.kt&&u.y>=s.nt&&u.x+u.width<=s.lt+s.js&&u.y+u.height<=s.ot+s.gs?(h={sheet:e,row:r,col:i,sheetArea:3,canvasOffset:n},a._updateEditorWrapper(c,l,u,h)):w.GC$(c).css({top:-1e4,left:-1e4})),(f=e._formulaTextBox)&&f._position())},jt.prototype.TH=function(t,e){var o,n;if(!t)return E;for(o=t.firstChild;o;){if(o.id===e||o.name===e)return o;if(n=this.TH(o,e))return n;o=o.nextSibling}return E},jt.prototype.zu=function(t,e){var o,n,r,i=!0;if(t.length===e.length)for(o=0;o<t.length;o++){if(n=t[o],r=e[o],n.row!==r.row||n.col!==r.col||Tt(n)!==Tt(r)||xt(n)!==xt(r)){i=!0;break}i=!1}return i},jt.prototype.UH=function(t,e,o,n){var r,i,a,s,l,u,c,h=this,f=h.kj,p={sheet:f,row:e,col:o,sheetArea:3},d=f.zo(),g=t.isImeAware(p),m=tt?B:"fixed";return n&&h.VH(),g&&!h.GF&&(i=(r=t._createCellTypeElement(p)).style,h.WH||(h.WH={overflow:"visible",border:J,position:B}),h.WH.overflow=i.overflow,h.WH.border=i.border,h.WH.position=i.position,w.GC$(r).css([H,z,"top",W,"width",G,V],[m,U,"0px","0px","0px","0px",J]),f.KF&&r.firstChild&&(a=r.firstChild.firstChild,f.KF(t,a,e,o,f.getActualStyle(e,o)),s=t.getEditorValue(a,p),v.safari&&(""===s||M(s))&&t.setEditorValue(a," ",p)),d&&d.insertBefore(r,E),h.GF=r),h.XH||(r=C("div"),w.GC$(r).css([H,z,"top",W,"width",G],[m,U,"0px","0px","0px","0px"]),h.XH=r,l=C("textarea"),w.GC$(l).attr(Z,"gcSheetFocusInput").attr("tabindex",-1).css([H,z,V,"resize"],[B,U,J,J]),l.value=" ",r.insertBefore(l,E),h.YH=l,u=C("div"),w.GC$(u).css(H,B).css(z,U).attr(Z,"gcSheetFocusInput").attr("tabindex",-1),r.insertBefore(u,E),h.ZH=u,d&&d.insertBefore(r,E)),c=x.location!==x.parent.location,(tt||v.mozilla&&c)&&(h.GF&&h.$H(f,h.GF),h.$H(f,h.XH)),g?h.GF:h.YH},jt.prototype.JF=function(){this.GF&&this.WH&&w.GC$(this.GF).css(z,this.WH.overflow).css(V,this.WH.border).css(H,this.WH.position)},jt.prototype.VH=function(){this.GF&&(this.GF.parentElement&&this.GF.parentElement.removeChild(this.GF),this.GF.comboBox&&(this.GF.comboBox=E),this.GF=E)},jt.prototype.zt=function(t){S.Vl.Wl(this.kj)||this._H(!0,!0,t)},jt.prototype.Cm=function(){var t=this.ZH;t&&t.focus()},jt.prototype.Qq=function(){this._H(!0,!0)},jt.prototype.aI=function(){this.bI&&(clearTimeout(this.bI),this.bI=E)},jt.prototype._H=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p;0===arguments.length&&(t=!0),(n=this).Gma||(n.XF=!1,n.aI(),r=n.kj,i=gt(r),a=mt(r),s=r.getCellType(i,a),n.UH(s,i,a,e),l={sheet:r,row:i,col:a,sheetArea:3},u=s.isImeAware(l)&&n.GF.firstChild?n.GF.firstChild.firstChild:n.YH,c=u,e&&!v.msie&&s.setImeMode(c,r.getActualStyle(i,a).imeMode,l),d.body.focus(),h=function(){e&&v.msie&&s.setImeMode(c,r.getActualStyle(i,a).imeMode,l),function(){try{s.isImeAware(l)?(s.focus(c,l),s.selectAll(c,l)):(u.focus(),u.select())}catch(t){}}()},f=v.metroMode||m.ipad||m.iphone||m.android,!r.CH&&!f||!t&&s.isImeAware(l)?!1===r._enhanceIme||o||n.TLc(r)||h():!at(r)&&f?e&&(p=n.GF&&n.GF.firstChild&&n.GF.firstChild.firstChild,s.setImeMode(p,r.getActualStyle(i,a).imeMode,l)):n.bI=x.setTimeout(function(){n.TLc(r)||(n.aI(),at(r)||!1===r._enhanceIme||o||h())},200),S.Vl.Wl(r)||n.TLc(r)||S.Vl.Zl(r),n.byb(r)||n.cs&&n.cs(r.Jl,r.Kl))},jt.prototype.$H=function(t,e){var o,n,r,i,a,s,l,u=gt(t),c=mt(t),h=t.Nr,f=t.Pr,p=t.getCellRect(u,c,h,f),d=t.Vs(),g=this.bG(),m=this.GF,y=0,b=0,v=0,C=0;m&&(r=w.GC$(m),y=parseInt(r.css("top"),10),b=parseInt(r.css(W),10),v=parseInt(r.css(G),10),C=parseInt(r.css("width"),10)),n=this.oG(p)?(o=y,b):(o=p.y+g.top-2,p.x+g.left-2),i=x.pageYOffset-d.top+g.top,a=x.innerHeight+i-v,s=x.pageXOffset-d.left+g.left,l=x.innerWidth+s-C,(j(o)||o<i||a<o)&&(o=i),(j(n)||n<s||l<n)&&(n=s),w.GC$(e).css("top",o).css(W,n)},jt.prototype.cI=function(t){var e,o,n,r;this.aI(),at(this.kj)||this.XF&&d.activeElement===this.ZH||(e=this.kj,n=t?(o=t.row,t.col):(o=e.Jl,e.Kl),r=e.getCellType(o,n),this.UH(r,o,n,!1),this.ZH.focus(),this.XF=!0)},jt.prototype.dI=function(t,e){this.XF&&(this.XF=!1,e||this._H(t))},jt.prototype.gx=function(t){var e=this.kj.tu();e&&(e.ska(t),e.M4(),this.Gma=!0,t&&e.N4())},jt.prototype.hx=function(){var t=this.kj.tu();t&&t.ska(""),this.Gma=!1,this._H(!0,!1)},jt.prototype.MF=function(){var t;this.aI(),(t=this.GF)&&(w.GC$(t).remove(),this.GF=D),(t=this.XH)&&(w.GC$(t).remove(),this.YH=D,this.XH=E,this.ZH=E)},jt.prototype.uw=function(t,e,o,n){var r=this.kj.parent;r&&r.uw(f.Ob(t),e,o,n)},jt.prototype.ww=function(t,e,o,n){var r=this.kj.parent;r&&r.ww(t,e,o,n)},jt.prototype.xw=function(){var t=this.kj.parent;t&&t.xw()},jt.prototype.Uw=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d;o=(e=this.kj).hCb,n=e.iCb,i=!1,(r=e.yt)||(i=!0),i||t||(i=!0),i=i||t.col!==r.col||t.row!==r.row||pt(t)!==pt(r)||ft(t)!==ft(r)||dt(t)!==dt(r)||(f=t.resizeInfo,p=r.resizeInfo,d=!1,f||p?f&&p&&(d=f.action===p.action&&f.index===p.index&&f.sheetArea===p.sheetArea):d=!0,!d),e.yt=t,i&&(s=(a=e.QLc)&&a.isEnable(g.StatesType.hover,!0),l=a&&a.isEnable(g.StatesType.hover,!1),r&&!M(r.hitTestType)&&(e.hCb=null,e.iCb=null,e._modelManager.setCellState(o,n,g.CellStatesType.hover,!1,r.hitTestType),s&&e.ULc(o),l&&e.VLc(n),s||l||e.xIb&&e.xIb(g.CellStatesType.hover,o,n,r.hitTestType,r.rowViewportIndex,r.colViewportIndex)),t&&!M(t.hitTestType)&&(e.hCb=t.row,e.iCb=t.col,t.resizeInfo||(e._modelManager.setCellState(t.row,t.col,g.CellStatesType.hover,!0,t.hitTestType),s&&e.ULc(t.row),l&&e.VLc(t.col),s||l||e.xIb&&e.xIb(g.CellStatesType.hover,t.row,t.col,t.hitTestType,t.rowViewportIndex,t.colViewportIndex))),e.fI=!0,c=it(e,r,u=e._render),h=it(e,t,u),c=c||h,e.fI=!1,c&&u.im())},jt.prototype._G=function(t,e,o){var n=this.gI(t,e,o);return this.hI(n)},jt.prototype.gI=function(t,e,o){var n=this.kj._modelManager.getSpan(t,e),r=Tt(n),i=xt(n);return 1===r&&1===i||o&&1===r||!o&&1===i?n:(o?e++:t++,this.gI(t,e,o))},jt.prototype.hI=function(t){var e,o,n,r=this.kj,i=t.row,a=ct(r);for(e=i;e<a&&!0!==r.getRowVisible(e);e++);for(e<a&&(i=e),o=t.col,n=ht(r),e=o;e<n&&!0!==r.getColumnVisible(e);e++);return e<n&&(o=e),s(i,o,Tt(t),xt(t))},jt.prototype.byb=function(t){var e,o,n=t.floatingObjects&&t.floatingObjects.all(),r=t.shapes&&t.shapes.all();if(!M(n))for(e=0;e<n.length;e++)if(n[e].isSelected())return!0;if(!M(r))for(o=0;o<r.length;o++)if(r[o].isSelected())return!0},jt.prototype.TLc=function(t){return"function"==typeof t.isShapeTextEditorOpened&&t.isShapeTextEditorOpened()},rt=jt,e.iI=rt,A.Worksheet.$n("eventHandler",{beforeSetHost:function(){this._eventHandler=new rt(this)},dispose:function(t){var e,o,n,r,i=this,a=i._eventHandler;a&&(a.uC(),e=a.nIb,w.GC$(i.Ws()).unbind(l+"."+e).unbind(u+"."+e).unbind(c+"."+e).unbind(T+"."+e).unbind(R+"."+e).unbind(k+"."+e),v.mozilla&&(o="onwheel"in document?N:I,w.GC$(i.Ws()).unbind(o+"."+e)),a.no(),a.MF()),(n=i._editor)&&w.GC$(n).remove(),(r=i.NF)&&(r.close(),i.NF=null),!1!==t.clearCache&&(i.OF=E,i.PF=E,i.QF=E,i.RF=E,i.SF=E,i.TF=E,i._eventHandler=E)},setHost:function(t){var m,y,e,o;t&&(y=(m=this)._eventHandler,m.OF=function(t){var e={e:t,r:E};if(A.Worksheet.ao(m,"preProcessMouseDown",e),!e.r)return y.AD(t)},m.PF=function(t){var e={e:t,r:E};A.Worksheet.ao(m,"preProcessMouseMove",e),e.r||y.RB||y.BD(t)},m.QF=function(t){var e={e:t,r:E};if(A.Worksheet.ao(m,"preProcessMouseUp",e),!e.r&&!m.XD){if(y.RB)return;return y.CD(t)}},m.RF=function(t){var e,o,n,r,i,a,s,l,u,c,h;if(e={e:t=t||x.event,r:E},A.Worksheet.ao(m,"preProcessMouseWheel",e),!e.r)return n=(o=m.parent)&&o.options.scrollByPixel,r=t.detail?t.detail:t.wheelDelta/-40,i=0,"wheel"===t.type?(a=v.mozilla&&88<=+v.version?17:1,r=t.deltaY/a,i=t.deltaX/a,n||(L(r)>=L(i)?i=0:r=0)):(s=(new Date).valueOf(),l=t.wheelDeltaY,u=t.wheelDeltaX,n||(L(l)>=L(u)?u=0:l=0),c=!m.nka||200<s-m.nka,(v.safari||v.chrome)&&(a=v.safari?-4:-40,M(l)||(c?(r=(0<=(r=l/a)?1:-1)*F(L(r)),m.oka=0):(r=l/a,m.oka+=r,r=(0<=r?1:-1)*F(L(m.oka)),m.oka-=r)),M(u)||(c?(i=(0<=(i=u/a)?1:-1)*F(L(i)),m.pka=0):(i=u/a,m.pka+=i,i=(0<=i?1:-1)*F(L(m.pka)),m.pka-=i))),m.nka=s),(0!==r||0!==i)&&(h=m.parent.ku.Rw(m,t,_(r,10)||0,_(i,10)||0),o.xw(),!!h&&void 0)},m.SF=function(t){var e={e:t,r:E};if(A.Worksheet.ao(m,"preProcessMouseOut",e),!e.r)return y.DD(t)},m.TF=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g={e:t,r:E};A.Worksheet.ao(m,"preProcessMouseDbClick",g),g.r||(e=m.yt)&&(o=!1,3===dt(e)?(l=y,u=t,c=m.Vs(),h=u.pageX-c.left,f=u.pageY-c.top,p=m.hitTest(h,f),d=p.dragInfo,p.tableSelectInfo||(d&&l.cyb&&"corner"===d.side?l.cyb():l._startEdit(u,h,f))):(n=e,a=y.kj,o=!!(s=n.resizeInfo)&&(s.action===Y||s.action===K?(r=[],a.tp(s.index)?b(a._modelManager.getSelections(),function(t,e){var o,n;if(-1===e.col)for(o=a.Tq(e),n=0;n<Tt(o);n++)r.push({row:o.row+n})}):r.push({row:s.index}),a.wu().execute({cmd:"autoFitRow",sheetName:a.name(),rows:r,columnHeader:1===s.sheetArea})):(i=[],a.sp(s.index)?b(a._modelManager.getSelections(),function(t,e){var o,n;if(-1===e.row)for(o=a.Tq(e),n=0;n<xt(o);n++)i.push({col:o.col+n})}):i.push({col:s.index}),a.wu().execute({cmd:"autoFitColumn",sheetName:a.name(),columns:i,rowHeader:2===s.sheetArea})),!0)),o||m.Wq(S.Events.CellDoubleClick,St(m,m.name(),e.row,e.col,dt(e))))},e=y.nIb,t.bind(l+"."+e,function(t){return m.OF(t)}).bind(u+"."+e,function(t){return m.QF(t)}).bind(c+"."+e,function(t){return m.PF(t)}).bind(T+"."+e,function(t){return m.RF(t)}).bind(R+"."+e,function(t){return m.SF(t)}).bind(k+"."+e,function(t){return m.TF(t)}),v.mozilla&&(o="onwheel"in document?N:I,t.bind(o+"."+e,function(t){return m.RF(t)})))}})},"./dist/core/worksheet/worksheet-formatter.js":function(t,e,o){"use strict";var n,r,i,a,s;Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/util/domUtil.js"),r=o("./dist/core/worksheet/worksheet.js"),i=o("./dist/core/worksheet/style.js"),a=o("./dist/core/util/common.js"),s=o("@grapecity/js-sheets-common"),n.GC$.extend(r.Worksheet.prototype,{getFormatter:function(t,e,o){return this.tq(t,e,"formatter",o)},setFormatter:function(t,e,o,n){var r=this.Iq(t,e,n);(r=r||new i.Style).formatter=o,this.setStyle(t,e,r,n)}}),r.Worksheet.$n("formatter",{settingText:function(t){var e,o=a.util.tl(t.value),n=s.Formatter&&s.Formatter.GeneralFormatter;n&&o&&(e={},(new n).getPreferredDisplayFormatter(t.value,e),"number"==typeof e.value&&(t.value=e.value))}})},"./dist/core/worksheet/worksheet-json.js":function(t,e,o){"use strict";var n,B,V,z,A,W,r,S,G,i,U,J,M,Z,I,N,q,R,K,Y,Q;function d(t,e,o,n){var r,i;if(t.dataTable&&(e.dataTable||(e.dataTable={}),r=t.dataTable[o])){if(e.dataTable[o]||(e.dataTable[o]={}),!(i=r[n]))return;e.dataTable[o][n]||(e.dataTable[o][n]={}),i.formula&&(e.dataTable[o][n].formula=i.formula)}}function X(t,e,o,n){var r,i,a=t._modelManager,s=a._getSheetModel(),l=a._getSheetModel(G.SheetArea.colHeader),u=a.YTa(!0),c=a.YTa(!0,G.SheetArea.colHeader),h=a.zl(),f=a.zl(G.SheetArea.colHeader),p=s.getColumnCount();for(R(e.colHeaderData)&&(e.colHeaderData={}),l.setRowCount(o),r=0;r<o;r++)for(l.setNode(r,-1,s.RTa(r,-1)),c.Kp(r,u.Jp(r)),i=n;i<p;i++)l.setNode(r,i,s.RTa(r,i)),d(e.data,e.colHeaderData,r,i);h.getSpans(A.kf(0,0,o,p)).forEach(function(t){f.add(t)}),t.frozenRowCount(0)}function $(t,e,o,n){var r,i,a=t._modelManager,s=a._getSheetModel(),l=a._getSheetModel(G.SheetArea.rowHeader),u=a.YTa(!1),c=a.YTa(!1,G.SheetArea.rowHeader),h=a.zl(),f=a.zl(G.SheetArea.rowHeader),p=s.getRowCount();for(R(e.rowHeaderData)&&(e.rowHeaderData={}),l.setColumnCount(o),r=0;r<o;r++)for(l.setNode(-1,r,s.RTa(-1,r)),c.Kp(r,u.Jp(r)),i=n;i<p;i++)l.setNode(i,r,s.RTa(i,r)),d(e.data,e.rowHeaderData,i,r);h.getSpans(A.kf(0,0,p,o)).forEach(function(t){f.add(t)}),t.frozenColumnCount(0)}function k(t,e){switch(t){case"frozenRowCount":case"frozenColCount":case"frozenTrailingRowCount":case"frozenTrailingColCount":case"activeRow":case"activeCol":return 0===e;case"rowCount":return 200===e;case"columnCount":return 20===e;case"zoomFactor":case"rowHeaderColCount":case"colHeaderRowCount":return 1===e;case"visible":return!0===e}}function tt(t,e){return Z(t)?t:e}function et(t,e,o){Z(o)&&e.call(t,o,!1)}function ot(n,r,i,a,s,l){M&&I(M,function(t,e){var o=e.fromJson;o&&o.call(n,r,i,a,!Z(s)||s,l)})}Object.defineProperty(e,"__esModule",{value:!0}),n=o("@grapecity/js-sheets-common"),B=o("./dist/core/worksheet/worksheet.js"),V=o("./dist/core/worksheet/style.js"),z=V.Style.kxb,A=o("./dist/core/util/common.js"),W=o("./dist/core/util/theme.js"),r=o("./dist/core/util/domUtil.js"),S=o("./dist/core/worksheet/stylehelper.js"),G=o("./dist/core/core.enum.js"),i=o("@grapecity/js-calc"),U=!!i,J=n.Common.CultureManager,M=B.Worksheet._features,Z=A.util.Ol,I=r.GC$.each,N=r.GC$.isEmptyObject,q=n.Common.D,R=n.Common.j.Fa,K=parseInt,Y=isNaN,Q=void 0,r.GC$.extend(B.Worksheet.prototype,{qI:function(t,e,o,n){var r;t[e]||(t[e]={}),(r=t[e])[o]||(r[o]={}),r[o].value=n},$ec:function(t,e){var o,n,r,i,a=this._modelManager,s=a._getSheetModel(),l=a._getSheetModel(G.SheetArea.colHeader),u=a.YTa(!0),c=a.YTa(!0,G.SheetArea.colHeader),h=a.zl(),f=a.zl(G.SheetArea.colHeader),p=this.rowFilter(),d=s.getColumnCount();for(o=0;o<t;o++)for(s.setNode(o,-1,l.RTa(o,-1)),u.Kp(o,c.Jp(o)),n=e;n<d;n++)(r=(r=l.RTa(o,n))||{}).style=this.getActualStyle(o,n,G.SheetArea.colHeader),s.setNode(o,n,r),(i=this.getFormula(o,n,G.SheetArea.colHeader))&&this.setFormula(o,n,i,G.SheetArea.viewport);f.getSpans().forEach(function(t){h.add(t)}),p&&p.range&&-1===p.range.row&&(p.jXc=!0),this.frozenRowCount(t),a.dWa(B.Worksheet.Vp,d,G.SheetArea.colHeader),a.fWa(!1,G.SheetArea.colHeader),a.eWa(G.SheetArea.colHeader),this.Bj(G.SheetArea.colHeader).clearAll()},Zec:function(t,e){var o,n,r,i,a=this._modelManager,s=a._getSheetModel(),l=a._getSheetModel(G.SheetArea.rowHeader),u=a.YTa(!1),c=a.YTa(!1,G.SheetArea.rowHeader),h=a.zl(),f=a.zl(G.SheetArea.rowHeader),p=s.getRowCount();for(o=0;o<t;o++)for(s.setNode(-1,o,l.RTa(-1,o)),u.Kp(o,c.Jp(o)),n=e;n<p;n++)(r=(r=l.RTa(n,o))||{}).style=this.getActualStyle(n,o,G.SheetArea.rowHeader),s.setNode(n,o,r),(i=this.getFormula(n,o,G.SheetArea.rowHeader))&&this.setFormula(n,o,i,G.SheetArea.viewport);f.getSpans().forEach(function(t){h.add(t)}),this.frozenColumnCount(t),a.dWa(p,B.Worksheet.Tp,G.SheetArea.rowHeader),a.fWa(!1,G.SheetArea.rowHeader),a.eWa(G.SheetArea.rowHeader),this.Bj(G.SheetArea.rowHeader).clearAll()},toJSON:function(o){var t,e,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x=this,T=o&&o.ignoreStyle;for(f in o&&!o.Yec&&(t=x.getRowCount(G.SheetArea.colHeader),e=x.getColumnCount(G.SheetArea.rowHeader),n=o.rowHeadersAsFrozenColumns,i=o.columnHeadersAsFrozenRows&&0<t,(r=n&&0<e)&&x.addColumns(0,e),i&&x.addRows(0,t,i),r&&x.Zec(e,i?t:0),i&&x.$ec(t,r?e:0)),a=x.getRowCount(),s=x.getColumnCount(),l=x.getRowCount(G.SheetArea.colHeader),u=x.getColumnCount(G.SheetArea.rowHeader),c={name:o&&o.newWorkSheetName||x.name(),isSelected:x.DHb(),rowCount:a,columnCount:s,activeRow:x.Jl,activeCol:x.Kl,zoomFactor:x.zoom(),rowHeaderColCount:u,colHeaderRowCount:l,visible:x.visible()},T||(c.frozenRowCount=x.frozenRowCount(),c.frozenColCount=x.frozenColumnCount(),c.frozenTrailingRowCount=x.frozenTrailingRowCount(),c.frozenTrailingColCount=x.frozenTrailingColumnCount(),c.frozenTrailingRowStickToEdge=x.qKc,c.frozenTrailingColumnStickToEdge=x.tKc,c.theme=x.Pm.toJSON()),h=x._modelManager.toJSON(o))c[f]=h[f];for(d in M&&I(M,function(t,e){e.toJson&&e.toJson.call(x,c,o)}),p={},c)q(c,d)&&(g=c[d],R(g)||k(d,g)||(p[d]=g));if(function(t,e){var o,n,r,i,a,s,l,u,c,h=t._modelManager.ZHb.anchors;for(o in h)if(n=+o,r=h[o],i=e[n],r&&i)for(a in r)s=+a,(l=r[a])&&((u=i[s])&&(c={row:l.row,rowCount:l.rowCount,col:l.col,colCount:l.colCount,isDynamicArray:!0},l.isValid||(c.isInvalid=!0),u.arrayInfo=c))}(x,c.data.dataTable),I(x.options,function(t,e){var o,n,r,i=e;"gridline"===t&&(i={},o=e.color,n=e.showHorizontalGridline,r=e.showVerticalGridline,o&&o!==A.Im.Lm("gc-gridlineColor").borderTopColor&&(i.color=o),!1===n&&(i.showHorizontalGridline=n),!1===r&&(i.showVerticalGridline=r)),"sheetAreaOffset"===t&&(i={},e.left&&(i.left=e.left),e.top&&(i.top=e.top)),"_ps"===t||R(i)||B.Worksheet.Qp[t]===i||"object"==typeof i&&N(i)||(p[t]=i)}),m=[],y=x.Lq){for(b in y)q(y,b)&&((v=y[b])&&(C=v.toJSON(),w=v.font,N(C)||(w&&(C.font=S.To.Jo(w)),m.push(C))));0<m.length&&(p.namedStyles=m)}return p},fromJSON:function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H;if(o&&(i=o.noSchema,a=o.version),t){l=(s=this)._modelManager,u=n&&n.ignoreStyle,s.T3(),B.Worksheet.ao(s,"preFromJson"),s.suspendPaint(),l.wgc(),l.xgc(),c=J.culture(),J.culture(""),h=tt(t.rowCount,B.Worksheet.Rp),f=tt(t.columnCount,B.Worksheet.Sp);try{if(s.cq(t.name+"",!0),s.DHb(t.isSelected),s.setRowCount(h),s.setColumnCount(f),s.Lq={},p=t.namedStyles)for(d=0;d<p.length;d++)g=p[d],m=new V.Style,z(g,s),m.fromJSON(g,i,s),s.Kq(m);for(b in y=s.options)if(q(y,b)&&(v=t[b],"protectionOptions"===b?v=v||t.protectionOption:"allowCellOverflow"===b&&(v=Z(t[b])?t[b]:!a||11<=a),Z(v)))if("object"==typeof v)for(C in v)q(v,C)&&(y[b][C]=v[C]);else"borderWidth"===b?(y.sheetAreaOffset.left=v,y.sheetAreaOffset.top=v):y[b]=v;if(w=tt(t.activeRow,s.Jl),x=tt(t.activeCol,s.Kl),s.Kr(w,x,Q,Q,!0),u||(et(s,s.frozenRowCount,t.frozenRowCount),et(s,s.frozenColumnCount,t.frozenColCount),et(s,s.frozenTrailingRowCount,t.frozenTrailingRowCount),et(s,s.frozenTrailingColumnCount,t.frozenTrailingColCount),s.qKc=!Z(t.frozenTrailingRowStickToEdge)||t.frozenTrailingRowStickToEdge,s.tKc=!Z(t.frozenTrailingColumnStickToEdge)||t.frozenTrailingColumnStickToEdge),!u){if(T=t.colStyles)for(A in T)Y(A)||s.setStyle(-1,K(A,10),T[A],G.SheetArea.viewport);if(S=t.rowStyles)for(M in S)Y(M)||s.setStyle(K(M,10),-1,S[M],G.SheetArea.viewport)}I=tt(t.rowHeaderColCount,B.Worksheet.Tp),N=tt(t.colHeaderRowCount,B.Worksheet.Vp),s.setColumnCount(I,G.SheetArea.rowHeader),s.setRowCount(N,G.SheetArea.colHeader),s.XSa(tt(t._zoomFactor||t.zoomFactor,s.zoom())),et(s,s.visible,t.visible),R=s.uja,k={sheet:s,setValidator:function(t,e,o){R&&R.vja(t,e,o)},ignoreStyle:u},l.fromJSON(t,i,k),s.defaults=l.defaults,R&&R.QV(!0),(E=t.theme)&&!u&&("string"!=typeof(D=E)&&Z(D)&&(j=D.themeColor||D._themeColor,(_=new W.ColorScheme(j.name||j._name)).fromJSON(j,i),D=new W.Theme(D.name||D.Cj,_,D.headingFont||D.Vaa,D.bodyFont||D.Waa)),s.currentTheme(D)),ot(s,t,i,n,e,r),O=n&&n.frozenColumnsAsRowHeaders,P=(F=n&&n.frozenRowsAsColumnHeaders)&&t.frozenRowCount||0,L=O&&t.frozenColCount||0,F&&0<P&&X(s,t,P,L),O&&0<L&&$(s,t,L,P),U&&(H=s.yj(),0<P&&(H.cDc=P),0<L&&(H.dDc=L)),r||(0<P&&s.deleteRows(0,P),0<L&&s.deleteColumns(0,L)),s.clearPendingChanges()}finally{J.culture(c),l.ygc(),s.resumePaint()}}},egc:function(u,c,t,h,f){var p,e,d,g,m,y,o,n,r,i,a,s,l,b,v,C,w,x,T,A,S,M,I,N;if(t&&(p=t.noSchema,e=t.version),u){g=(d=this)._modelManager,m=h.ignoreStyle,d.T3(),B.Worksheet.ao(d,"preFromJson"),g.wgc(),g.xgc(),y=J.culture(),J.culture(""),tt(u.rowCount,B.Worksheet.Rp),tt(u.columnCount,B.Worksheet.Sp);try{if(d.Lq={},o=u.namedStyles)for(n=0;n<o.length;n++)r=o[n],i=new V.Style,z(r,d),i.fromJSON(r,p,d),d.Kq(i);for(s in a=d.options)if(q(a,s)&&(l=u[s],"protectionOptions"===s?l=l||u.protectionOption:"allowCellOverflow"===s&&(l=Z(u[s])?u[s]:!e||11<=e),Z(l)))if("object"==typeof l)for(b in l)q(l,b)&&(a[s][b]=l[b]);else"borderWidth"===s?(a.sheetAreaOffset.left=l,a.sheetAreaOffset.top=l):a[s]=l;if(v=tt(u.activeRow,d.Jl),C=tt(u.activeCol,d.Kl),d.Kr(v,C,Q,Q,!0),m||(et(d,d.frozenRowCount,u.frozenRowCount),et(d,d.frozenColumnCount,u.frozenColCount),et(d,d.frozenTrailingRowCount,u.frozenTrailingRowCount),et(d,d.frozenTrailingColumnCount,u.frozenTrailingColCount),d.qKc=!Z(u.frozenTrailingRowStickToEdge)||u.frozenTrailingRowStickToEdge,d.tKc=!Z(u.frozenTrailingColumnStickToEdge)||u.frozenTrailingColumnStickToEdge),!m){if(w=u.colStyles)for(x in w)Y(x)||d.setStyle(-1,K(x,10),w[x],G.SheetArea.viewport);if(T=u.rowStyles)for(A in T)Y(A)||d.setStyle(K(A,10),-1,T[A],G.SheetArea.viewport)}S=tt(u.rowHeaderColCount,B.Worksheet.Tp),M=tt(u.colHeaderRowCount,B.Worksheet.Vp),d.setColumnCount(S,G.SheetArea.rowHeader),d.setRowCount(M,G.SheetArea.colHeader),d.XSa(tt(u._zoomFactor||u.zoomFactor,d.zoom())),I=d.uja,N={sheet:d,setValidator:function(t,e,o){I&&I.vja(t,e,o)},ignoreStyle:m,incrementalLoading:h.incrementalLoading,incrementLoadTask:h.incrementLoadTask},g.fromJSON(u,p,N,function(){var t,e,o,n,r,i,a,s,l;d.defaults=g.defaults,I&&I.QV(!0),(t=u.theme)&&!m&&("string"!=typeof(e=t)&&Z(e)&&(o=e.themeColor||e._themeColor,(n=new W.ColorScheme(o.name||o._name)).fromJSON(o,p),e=new W.Theme(e.name||e.Cj,n,e.headingFont||e.Vaa,e.bodyFont||e.Waa)),d.currentTheme(e)),ot(d,u,p,h,c,f),r=h&&h.frozenColumnsAsRowHeaders,a=(i=h&&h.frozenRowsAsColumnHeaders)&&u.frozenRowCount||0,s=r&&u.frozenColCount||0,i&&0<a&&X(d,u,a,s),r&&0<s&&$(d,u,s,a),U&&(l=d.yj(),0<a&&(l.cDc=a),0<s&&(l.dDc=s)),f||(0<a&&d.deleteRows(0,a),0<s&&d.deleteColumns(0,s)),d.clearPendingChanges(),J.culture(y),g.ygc(),d.loaded=!0})}finally{}}}})},"./dist/core/worksheet/worksheet-model.js":function(t,e,o){"use strict";var n,y,v,R,A,b,r,I,i,h,k,d,N,a,E,D,j,C,w,_,s,O,c,p,g,x,l,f,F,u,T,P,L,m,S,M,H,B,V,z,W,G,U,J,Z,q,K=this&&this.__extends||(J=function(t,e){return(J=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}J(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),Y=this&&this.__rest||function(t,e){var o,n,r={};for(o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(r[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(n=0,o=Object.getOwnPropertySymbols(t);n<o.length;n++)e.indexOf(o[n])<0&&(r[o[n]]=t[o[n]]);return r};function Q(t,e){return F(t)?e:t}function X(t,e){return t.hasOwnProperty(e)}function $(t){return t.rowCount}function tt(t){return t.colCount}function et(t,o,e,n){var r=e;Object.defineProperty(t,o,{get:function(){return r},set:function(t){var e=r;n(this,r=t,o,e)}})}function ot(e,t){e.cache={},t&&t.forEach(function(t){nt(e,t)})}function nt(t,e){var o,n;if(t.Ef=s(t.Ef,e.row+$(e)-1),t.Ff=s(t.Ff,e.col+tt(e)-1),!t.suspendUpdatingCache)for(o=0;o<e.rowCount;o++)for(n=0;n<e.colCount;n++)t.cache[e.row+o+"_"+(e.col+n)]=e}function rt(t,e){var o,n;if(!t.suspendUpdatingCache)for(o=0;o<e.rowCount;o++)for(n=0;n<e.colCount;n++)t.cache[e.row+o+"_"+(e.col+n)]=j}function it(t,e,o,n,r,i,a,s){this.column=t,this.startColumn=e,this.endColumn=o,this.valueWidth=n,this.columnWidth=r,this.backgroundWidth=i,this.backgroundLeftWidth=a,this.backgroundRightWidth=s}function at(){var t=Z.call(this)||this;return t.headingOverflowlayouts=D,t.trailingOverflowLayouts=D,t}function st(){Array.apply(this,arguments)}function lt(){et(this,"spans",[],ot),this.Ff=-1,this.Ef=-1,this.cache={},this.suspendUpdatingCache=!1}function ut(){this.selections=[],this.selectionPolicy=2,this.selectionUnit=0}function ct(t,e,o,n,r){var i,a,s=t.length;for(a=0;a<s;a++)if(i=t[a],F(e)||F(o)?F(e)?F(o)?F(n)?i.containsY(r):i.containsX(n):i.col===o:i.row===e:i.contains(e,o))return i;return D}function ht(t,e,o){var n=D,r=t.length,i=!F(e);return 0<r&&(n=(n=i?t.findX(e):t.findY(o))||(i&&e<t[0].x||!i&&o<t[0].y?t[0]:t[r-1])),n}function ft(t,e,o,n,r,i,a,s,l){this.rowCount=a,this.colCount=s,this.row=t,this.col=e,this.x=o,this.y=n,this.width=r,this.height=i,this.isAutoMerge=l}function pt(){return q.call(this)||this}function dt(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d,g,m,y,b,v,C,w,x=r&&r.incrementLoadTask;if(x&&!x.isTerminated){for(l=x.isBusyFunc,u=a=a||0,c=!1,h=new Date;u<o;){if(f=e[u])for(p=0;p<n;p++)(d=f[p])&&(c=!0,vt(d,t.RTa(u,p,!0),i,u,p,r));if(u++,l&&l())break;if(30<new Date-h)break}if(c){if(g=r&&r.sheet,0!==a&&g.parent.getActiveSheet()===g)for(m=a;m<u;m++)if(g.as.viewport[1].findRow(m)){g.repaint();break}(y=r&&r.incrementalLoading)&&y.loading&&(y.loadStatus.valuesLoad+=u-a,v=y.loadStatus,C=r.doNotRecalculateAfterLoad,w=v.valuesLoad/v.total,b=C?.4*w+.1:.3*w+.1,y.loading(b,{sheet:g}))}u<o?r.incrementLoadTask.pushTask(dt,[t,e,o,n,r,i,u,s]):s&&r.incrementLoadTask.pushTask(s,[])}}function gt(t,e,o,n,r,i,a,s){0<=o&&0<=n?(i[o]||(i[o]={}),i[o][n]=r):0<=o&&-1===n&&0<=t&&-1===e?a[o]=r:0<=n&&-1===o&&0<=e&&-1===t&&(s[n]=r)}function mt(t,e,o,n,r,i,a){if(0<=o&&0<=n){i[o]||(i[o]={}),i[o].rs="e";var s=i[o];s.originalItem=a,s[n]=r}}function yt(){this.infos=[]}function bt(t,e){this.Xj=t,this.OZ=e,this.ad()}function vt(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m;t&&((a=t.value)!==j&&((a=a)===D||!(a._calcError||a._error&&!F(a._code))||(s=k&&R.CalcError.parse(a._calcError||a._error))!==j&&(a=s=T(s)),e.value=a),l=t.style,u=i&&i.sheet,l===j||i.ignoreStyle||(c=D,typeof l===C?(e.style=l,c=u&&(u.Mq(l,!1)||u.parent&&u.parent.Mq(l,!1))):l&&((c=new y.Style).fromJSON(l,o),c.name=j,e.style=c),c&&c.validator&&i&&i.setValidator&&i.setValidator(n,r,c.validator)),(h=t.visualState)!==j&&(e.visualState=h),(f=t.bindingPath)!==j&&(e.bindingPath=f),(p=t.tag)!==j&&(typeof(d=p.typeName)===C&&(!(g=b.getTypeFromString(d))||(p=new g).fromJSON&&p.fromJSON(t.tag)),e.tag=p),(m=t.hyperlink)!==j&&(e.hyperlink=L(m)))}function Ct(t,e){for(var o,n,r,i,a,s=e[0],l=t,u=0;u<s.length-1;u++)l=(o=s[u])===c?l.Ap:(l[o]||(l[o]={}),l[o]);l[s[u]]=e[1],n=s[s.length-1],i=s[s.length-2],a=s[1],"size"===n?r=s[0]===p?I.AxisInfoChangeType.setRowHeight:I.AxisInfoChangeType.setColumnWidth:"visible"===n&&(r=s[0]===p?I.AxisInfoChangeType.setRowVisible:I.AxisInfoChangeType.setColumnVisible),F(r)||t.zgc({type:r,index:i,sheetArea:a})}function wt(t,e,o){var n=0<t.WTa?[["selectionModel"],j]:j;t.selectionModel.setProperty(e,o,n),n&&t.zTa.push(n)}function xt(t,e,o,n,r){void 0===r&&(r=!1);var i=t[e];return r?void(i&&delete i[o]):void((i=i||(t[e]={}))[o]=n)}function Tt(t,e,o,n){xt(t,e,o,{value:n})}function At(t,e,o,n,r,i){xt(t,e,o,{value:n,oldValue:r,isAnchorCell:i})}function St(t,e,o,n){var r,i=t[e],a=i&&i[o];return a?a.value:(Tt(t,e,o,r=n.getValue(e,o)),r)}function Mt(t,e){return[t,e].join(",")}function It(t,e){var o,n=Array(e);for(o=0;o<e;o++)n[o]=t;return n}function Nt(t,e,o){var n=t[e];return n&&n[o]}function Rt(t,e){var o=e.split(",").map(function(t){return+t}),n=o[0],r=o[1],i=t[n];return i&&i[r]}function kt(t,e,o,n){var r=t[e];r&&delete r[o],n&&N(r)&&delete t[e]}function Et(t){this.modelManager=t,this.anchors={},this.cells={},this.invalidAnchors={}}function Dt(t,e,o,n,r){var i,a,s,l,u,c,h,f,p=t._getSheetModel(3),d=t.ZHb,g=d.anchors,m=[];for(i in g)if(g.hasOwnProperty(i)&&(a=g[i]))for(s in a)a.hasOwnProperty(s)&&((l=a[s])&&(u=l.row,c=l.col,h=l.rowCount,f=l.colCount,e<=(r?u+h:c+f)&&(l.isValid&&p.yIb(l),(r?u:c)<e&&m.push(l))));m.length&&R.markAnchorCellDirty(m,t.kj.Bj(),d)}function jt(t){return t?t.filter(function(t){return!t.isAutoMerge}):t}function _t(t,e,o,n,r,i){var a,s,l,u;function c(t,e,o,n){0<a.WTa&&a.zTa.push([["defaults",o],n]),a.kj.$p()}this.LIb=[],(a=this).kj=t,a.sheetModels=[j,new V(n,o),new V(e,r),new V(e,o)],(s=a.rowInfos=[])[0]=s[1]=new z,s[2]=s[3]=new z,(l=a.colInfos=[])[0]=l[2]=new z,l[1]=l[3]=new z,a.spanModels=[j,new M,new M,new M],a.selectionModel=new B,a.ZHb=new G(a),a.name=i||"",a.isSelected=!1,a.zoomFactor=1,et(u=a.defaults={},"rowHeight",20,c),et(u,"colWidth",62,c),et(u,"rowHeaderColWidth",40,c),et(u,"colHeaderRowHeight",20,c),et(u,"_isExcelDefaultColumnWidth",!1,c),a.WTa=0,_t.ao(this,"init"),a.Agc(e,o)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/core.ns.js"),y=o("./dist/core/worksheet/style.js"),v=o("@grapecity/js-sheets-common"),R=o("@grapecity/js-calc"),A=o("./dist/core/util/common.js"),b=o("./dist/core/util/common.js"),r=o("./dist/core/util/domUtil.js"),I=o("./dist/core/core.enum.js"),i=o("@grapecity/js-calc"),h=o("./dist/core/celltype/celltype.ns.js"),k=!!i,d=r.GC$.each,N=r.GC$.isEmptyObject,a=r.GC$.extend,E=RegExp("^\\d*(\\.\\d+)?\\*$"),D=null,j=void 0,C="string",w=Math.min,_=Math.floor,s=Math.max,O=Math.ceil,c="dirtyNodes",p="rowInfos",g="colInfos",x="default_size",l=v.Common.A,f=v.Common.B,F=v.Common.j.Fa,u=A.util.K_a,T=A.util.n0a,P=A.util.lHb,L=v.Common.j.C4,m=new v.Common.ResourceManager(n.SR),S=m.getResource.bind(m),lt.prototype.find=function(t,e){return this.cache[t+"_"+e]||D},lt.prototype.get=function(t,e){return this.find(t,e)||A.kf(t,e,1,1)},lt.prototype.remove=function(t,e){var o=this.spans.indexOf(t);0<=o?(e&&(e[0].push("spans"),e[1]=[].concat(this.spans)),this.removeSpan(o,1)):e&&(e.length=0)},lt.prototype.removeSpan=function(t,e){for(var o=0;o<e;o++)rt(this,this.spans[t+o]);this.spans.splice(t,e)},lt.prototype.update=function(t,e){rt(this,this.spans[t]),this.spans[t]=e,nt(this,e)},lt.prototype.add=function(t,e){e&&(e[0].push("spans"),e[1]=[].concat(this.spans)),nt(this,t),this.spans.push(t)},lt.prototype.Zz=function(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d=!1;for(a&&(s=[].concat(this.spans)),l=this.spans.length,p=[],f=0;f<l;f++)h=(u=this.spans[f]).col,c=u.row,(-1===t||t<=c&&c<t+r)&&(-1===e||e<=h&&h<e+i)?(p.push(A.kf(-1===t?c:o+c-t,-1===e?h:n+h-e,$(u),tt(u))),d=!0):(-1===t||o<=c&&c<o+r)&&(-1===e||n<=h&&h<n+i)&&(this.removeSpan(f,1),f--,l--,d=!0);for(f=0;f<p.length;f++){if(u=p[f],!this.LTa(this.spans,0,this.spans.length,u))throw Error(S().Exp_OverlappingSpans);this.add(u)}a&&(d?(a[0].push("spans"),a[1]=s):a.length=0)},lt.prototype.LTa=function(t,e,o,n){for(var r=e;r<o&&r<t.length;r++)if(t[r].intersect(n.row,n.col,$(n),tt(n)))return!1;return!0},lt.prototype.getSpans=function(t){var e,o,n,r=this.spans;if(!t)return[].concat(r);for(e=[],o=0;o<r.length;o++)(n=r[o]).intersect(t.row,t.col,$(t),tt(t))&&e.push(n);return e},lt.prototype.qu=function(t,e,o,n){var r,i,a=this.spans;for(r=0;r<a.length;r++)if((i=a[r]).intersect(t,e,o,n)&&(-1!==t&&(i.row<t||i.row+$(i)>t+o)||-1!==e&&(i.col<e||i.col+tt(i)>e+n)))return!0;return!1},lt.prototype.MTa=function(t,e,o,n){var r,i,a=!1,s=this.spans;for(r=0,i=s.length;r<i;r++){if(0<=t||0<=e)for(;r<i&&!s[r].intersect(t,e,o,n);)r++;if(r<i){a=!0;break}}return a},lt.prototype.$b=function(t,e,o,n,r){var i,a,s,l,u,c=this.spans,h=!1;for(r&&(i=[].concat(c)),a=0;a<c.length;a++)l=(s=c[a]).row,u=s.col,(-1===t||t<=l&&l<t+o)&&(-1===e||e<=u&&u<e+n)&&(this.removeSpan(a,1),a--,h=!0);r&&(h?(r[0].push("spans"),r[1]=i):r.length=0)},lt.prototype.aB=function(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m=!1;for(a&&(s=[].concat(this.spans)),l=[],u=[],c=this.spans.length,d=0;d<c;d++)f=(h=this.spans[d]).row,p=h.col,(-1===t||t<=f&&f<t+r)&&(-1===e||e<=p&&p<e+i)?(g=A.kf(-1===t?f:o+f-t,-1===e?p:n+p-e,$(h),tt(h)),u.push(g),m=!0):(-1===t||o<=f&&f<o+r)&&(-1===e||n<=p&&p<n+i)?m=!0:l.push(h);if(m){if(0<u.length)for(d=0;d<u.length;d++){if(g=u[d],!this.LTa(l,0,l.length,g))throw Error(S().Exp_OverlappingSpans);l.push(g)}for(this.spans.length=0,this.cache={},d=0;d<l.length;d++)this.add(l[d]);a&&(a[0].push("spans"),a[1]=s)}else a&&(a.length=0)},lt.prototype.NTa=function(t,e,o){var n,r,i,a,s,l,u,c,h,f=this.spans;for(n=!(this.suspendUpdatingCache=!0),o&&(r=[].concat(f)),i=f.length,a=0;a<i;a++)l=(s=f[a]).row,u=s.col,c=$(s),h=tt(s),t<=l?(this.update(a,A.kf(l+e,u,c,h)),n=!0):t<l+c&&(this.update(a,A.kf(l,u,c+e,h)),n=!0);this.suspendUpdatingCache=!1,n&&ot(this,f),o&&(n?(o[0].push("spans"),o[1]=r):o.length=0)},lt.prototype.OTa=function(t,e,o){var n,r,i,a,s,l,u,c,h,f=this.spans;for(n=!(this.suspendUpdatingCache=!0),o&&(r=[].concat(f)),i=f.length,a=0;a<i;a++)l=(s=f[a]).row,u=s.col,c=$(s),h=tt(s),t<=u?(this.update(a,A.kf(l,u+e,c,h)),n=!0):t<u+h&&(this.update(a,A.kf(l,u,c,h+e)),n=!0);this.suspendUpdatingCache=!1,n&&ot(this,f),o&&(n?(o[0].push("spans"),o[1]=r):o.length=0)},lt.prototype.PTa=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g=this.spans;for(n=!(this.suspendUpdatingCache=!0),o&&(r=[].concat(g)),i=[],a=g.length,s=0;s<a;s++)u=(l=g[s]).row,c=l.col,h=$(l),f=tt(l),t<=u?(u<t+e?u+h<=t+e?i.push(s):this.update(s,A.kf(t,c,u+h-(t+e),f)):this.update(s,A.kf(u-e,c,h,f)),n=!0):t<u+h&&(p=A.kf(u,c,h-w(u+h-t,e),f),this.update(s,p),1===p.rowCount&&1===p.colCount&&i.push(s),n=!0);for(s=i.length-1;0<=s;s--)d=i[s],this.removeSpan(d,1);this.suspendUpdatingCache=!1,n&&ot(this,g),o&&(n?(o[0].push("spans"),o[1]=r):o.length=0)},lt.prototype.QTa=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g=this.spans;for(n=!(this.suspendUpdatingCache=!0),o&&(r=[].concat(g)),i=[],a=g.length,s=0;s<a;s++)u=(l=g[s]).row,c=l.col,h=$(l),f=tt(l),t<=c?(c<t+e?c+f<=t+e?i.push(s):this.update(s,A.kf(u,t,h,c+f-(t+e))):this.update(s,A.kf(u,c-e,h,f)),n=!0):t<c+f&&(p=A.kf(u,c,h,f-w(c+f-t,e)),this.update(s,p),1===p.rowCount&&1===p.colCount&&i.push(s),n=!0);for(s=i.length-1;0<=s;s--)d=i[s],this.removeSpan(d,1);this.suspendUpdatingCache=!1,n&&ot(this,g),o&&(n?(o[0].push("spans"),o[1]=r):o.length=0)},lt.prototype.toJSON=function(){var t=[].concat(this.spans);return 0===t.length?j:t},lt.prototype.fromJSON=function(t){var e,o,n;if(t)for(this.spans=[],e=t,o=0;o<e.length;o++)n=e[o],this.add(A.kf(n.row,n.col,$(n),tt(n)))},M=lt,st.prototype.pop=function(){return D},st.prototype.push=function(t){return 0},st.prototype.splice=function(t,e){var o,n=[];for(o=2;o<arguments.length;o++)n[o-2]=arguments[o];return D},st.prototype.slice=function(t,e){return null},(H=st).prototype=[],K(at,Z=H),at.prototype.find=function(t){var e,o,n=this.length,r=[];for(o=0;o<n;o++)(e=this[o]).contains(t)&&r.push(e);return r},e.np=at,it.prototype.contains=function(t){return t>=this.startColumn&&t<=this.endColumn},e.op=it,ut.prototype.getProperty=function(t){return this[t]},ut.prototype.setProperty=function(t,e,o){o&&(o[0].push(t),o[1]=this[t]),this[t]=e},ut.prototype.clear=function(t){t&&(t.push(["selections",this.get()]),t.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex])),this.selections=[],this.activeSelectedRangeIndex=-1},ut.prototype.add=function(t,e,o,n,r){r&&(r.push(["selections",this.get()]),r.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex]));var i=this.selectionPolicy,a=this.selectionUnit;0===i?(o=w(o,1),n=w(n,1),this.clear()):1===i&&this.clear(),1===a?n=e=-1:2===a&&(o=t=-1),this.selections.push(A.kf(t,e,o,n)),this.activeSelectedRangeIndex=this.selections.length-1},ut.prototype.get=function(){return[].concat(this.selections)},ut.prototype.set=function(t,e){e&&(e.push(["selections",this.get()]),e.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex])),this.selections=t,this.activeSelectedRangeIndex>=t.length&&(this.activeSelectedRangeIndex=0)},ut.prototype.toJSON=function(){var t,e={},o=this.selectionPolicy,n=this.selectionUnit,r=this.activeSelectedRangeIndex,i=this.selections.length;for(2!==o&&(e.selectionPolicy=o),0!==n&&(e.selectionUnit=n),0!==r&&(e.activeSelectedRangeIndex=r),e.length=i,t=0;t<i;t++)e[t]=this.selections[t];return N(e)?j:e},ut.prototype.fromJSON=function(t,e,o){var n,r,i,a,s,l,u,c=e||200,h=o||20;if(t){for(this.clear(),i=t.selectionPolicy,a=t.selectionUnit,s=t.length,F(s)&&(s=1),l=0;l<s;l++)u=t[l],n=w(u?$(u):1,c),r=w(u?tt(u):1,h),this.selections.push(A.kf(u?u.row:0,u?u.col:0,n,r));this.activeSelectedRangeIndex=t.activeSelectedRangeIndex||0,F(i)||(this.selectionPolicy=i),F(a)||(this.selectionUnit=a)}},ut.prototype.sp=function(t){var e,o,n,r=this.selections;for(e=0;e<r.length;e++)if(n=-1===(o=r[e]).col?0:o.col,-1===o.row&&n<=t&&t<n+tt(o))return!0;return!1},ut.prototype.tp=function(t){var e,o,n,r=this.selections;for(e=0;e<r.length;e++)if(n=-1===(o=r[e]).row?0:o.row,-1===o.col&&n<=t&&t<n+$(o))return!0;return!1},ut.prototype.vp=function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w=!1,x=this.selections,T=i?1:0;for(a=0,s=x.length;a<s&&(l=x[a],p=l,d=n,g=r,C=v=b=y=m=void 0,C=A.kf(-1,-1,-1,-1),p&&(m=p.col,b=-1===(y=p.row),v=-1===m,C.row=b?0:y,C.rowCount=b?d:$(p),C.col=v?0:m,C.colCount=v?g:tt(p)),u=C.row,c=C.col,h=u-T<=t&&t<u+$(C)+T,f=c-T<=e&&e<c+tt(C)+T,3===o||F(o)?w=h&&f:2===o?w=h:1===o?w=f:0===o&&(w=-1===l.row&&-1===l.col),!w);a++);return w},ut.prototype.wp=function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g=this.selections,m=!1;for(i=0;i<g.length&&(s=(a=g[i]).row,l=a.col,u=$(a),c=tt(a),h=-1===l,f=-1===s,F(o)||3===o||(2===o?(p=f?0:s,m=h&&p<=t&&t<p+u):1===o?(d=h?0:l,m=f&&d<=e&&e<d+c):0===o&&(m=f&&h&&u===n&&c===r),!m));i++);return m},B=ut,K(pt,q=H),pt.prototype.findCell=function(t,e){var o,n,r=this.length;for(n=0;n<r;n++)if((o=this[n]).contains(t,e))return o;return D},pt.prototype.findRow=function(t){var e,o,n=this.length;for(o=0;o<n;o++)if((e=this[o]).row===t)return e;return D},pt.prototype.findCol=function(t){var e,o,n=this.length;for(o=0;o<n;o++)if((e=this[o]).col===t)return e;return D},pt.prototype.findX=function(t){return ct(this,j,j,t)},pt.prototype.findY=function(t){return ct(this,j,j,j,t)},pt.prototype.findNearX=function(t){return ht(this,t)},pt.prototype.findNearY=function(t){return ht(this,j,t)},e.yp=pt,ft.prototype.contains=function(t,e){return t<this.row+$(this)&&this.row<=t&&e<this.col+tt(this)&&this.col<=e},ft.prototype.intersect=function(t){return(this.x<0||t.x<this.x+this.width&&this.x<t.x+t.width)&&(this.y<0||t.y<this.y+this.height&&this.y<t.y+t.height)},ft.prototype.containsX=function(t){return this.x<=t&&t<this.x+this.width},ft.prototype.containsY=function(t){return this.y<=t&&t<this.y+this.height},e.zp=ft,bt.prototype.ad=function(){this.dataTable={},this.rowDataArray=[],this.columnDataArray=[],this.defaultDataNode=D,this.Ap={},this.gga=0,this.Ff=-1,this.Ef=-1},bt.prototype.getRowCount=function(){return this.Xj},bt.prototype.getColumnCount=function(){return this.OZ},bt.prototype.setRowCount=function(t){this.Xj=t},bt.prototype.setColumnCount=function(t){this.OZ=t},bt.prototype.Cp=function(t,e,o,n){var r,i,a,s,l=this.Ap;0<this.gga||0<=t&&0<=e&&(n&&(n.type="updateDirty",n.row=t,n.col=e,l[t]?l[t][e]||(n.isEmptyCol=!0):n.isEmptyRow=!0),l[t]||(l[t]={}),(r=l[t])[e]||(r[e]={}),i=r[e],"n"!==r.rs&&(r.rs="e"),a=o.Dp,s=o.Ep,F(a)||(n&&(n.originalItem=r.originalItem),r.originalItem=a),F(s)||(n&&(n.oldValue=i.oldValue),i.oldValue=s))},bt.prototype.gWa=function(t){var e=this.Ap,o=t.row,n=t.col;t.isEmptyRow&&e?delete e[o]:t.isEmptyCol&&e[o]?delete e[o][n]:(t.hasOwnProperty("originalItem")&&(F(t.originalItem)&&!F(e[o].originalItem)?delete e[o].originalItem:e[o].originalItem=t.originalItem),t.hasOwnProperty("oldValue")&&e[o]&&(F(t.oldValue)&&!F(e[o][n].oldValue)?delete e[o][n].oldValue:e[o][n].oldValue=t.oldValue))},bt.prototype.getValue=function(t,e,o){var n=this.RTa(t,e);return n&&!F(n.value)?1!==o?u(n.value):F(n.value.richText)?n.value:a(!0,{},n.value):D},bt.prototype.setValue=function(t,e,o,n,r){var i,a=this.RTa(t,e,!0,n?n[0]:j);!a||F(a.value)&&F(o)||a.value===o?n&&(n.length=0):(i=a.value,a.value=o,this.Cp(t,e,{Ep:i},r),n&&(n[0].push("value"),n[1]=i))},bt.prototype.getStyle=function(t,e,o){var n=this.RTa(t,e),r=n&&n.style;return r&&o&&r.clone&&(r=r.clone(!0)),r},bt.prototype.setStyle=function(t,e,o,n){var r,i=this.RTa(t,e,!0,n?n[0]:j);i&&i.style!==o?(r=i.style,i.style=o,n&&(n[0].push("style"),n[1]=r)):n&&(n.length=0)},bt.prototype.getCellState=function(t,e){var o=this.RTa(t,e);return o?o.cellState:D},bt.prototype.setCellState=function(t,e,o,n){var r,i,a=this.getCellState(t,e)||0;0!=(r=n?a|o:a&~o)?(i=this.RTa(t,e,!0,j,!0))&&(i.cellState=r):((i=this.RTa(t,e))&&delete i.cellState,N(i)&&(kt(this.dataTable,t,e),N(this.dataTable[t])&&delete this.dataTable[t]))},bt.prototype.getValueForKey=function(t,e,o){var n=this.RTa(t,e);return n&&n[o]},bt.prototype.setValueForKey=function(t,e,o,n,r){var i,a=this.RTa(t,e,!0,r?r[0]:j);a&&a[o]!==n?(i=a[o],a[o]=n,r&&(r[0].push(o),r[1]=i)):r&&(r.length=0)},bt.prototype.NTa=function(t,e,o){var n,r=this.Xj,i=this.dataTable,a=this.Ap;if(0<=t&&t<=r&&0<=e&&(l(i,r,t,e),l(this.rowDataArray,r,t,e),l(a,r,t,e),this.Xj+=e,!o))for(n=0;n<e;n++)i[t+n]={rs:"n"},a[t+n]={rs:"n"}},bt.prototype.STa=function(t,e,o){var n,r,i=this.Xj;if(0<=t&&t<i&&0<e){if(i<t+e&&(e=i-t),o)for(n=0;n<e;n++)r=t+n,o.push([["dataTable",r],this.dataTable[r]]),o.push([["rowDataArray",r],this.rowDataArray[r]]),o.push([[c,r],this.Ap[r]]);f(this.dataTable,i,t,e),f(this.rowDataArray,i,t,e),f(this.Ap,i,t,e),this.Xj-=e}},bt.prototype.OTa=function(t,e){var o,n,r=this.OZ;if(0<=t&&t<=r&&0<=e){for(o=0;o<this.Xj;o++)(n=this.dataTable[o])&&t<r&&l(n,r,t,e);l(this.columnDataArray,r,t,e),this.OZ+=e}},bt.prototype.TTa=function(t,e,o){var n,r,i,a,s,l,u=this.OZ;if(0<=t&&t<u&&0<e){for(n=0;n<this.Xj;n++)if(r=this.dataTable[n]){if(o)for(i=0;i<e;i++)a=t+i,o.push([["dataTable",n,a],r[a]]);f(r,u,t,e)}if(o)for(s=0;s<e;s++)l=t+s,o.push([["columnDataArray",l],this.columnDataArray[l]]);f(this.columnDataArray,u,t,e),u<t+e&&(e=u-t),this.OZ-=e}},bt.prototype.RTa=function(t,e,o,n,r){var i,a=this,s=a.dataTable,l=a.columnDataArray,u=a.rowDataArray,c=D;return t<a.Xj&&e<a.OZ&&(0<=t&&0<=e?(i=s[t],o&&(i=i||(s[t]={}),!r&&t>a.Ef&&(a.Ef=t)),i&&(c=i[e],o&&(c=c||(i[e]={}),!r&&a.Ff<e&&(a.Ff=e))),n&&n.push("dataTable",t,e)):-1===t&&0<=e?(c=l[e],o&&(c=c||(l[e]={}),!r&&a.Ff<e&&(a.Ff=e)),n&&n.push("columnDataArray",e)):0<=t&&-1===e?(c=u[t],o&&(c=c||(u[t]={}),!r&&a.Ef<t&&(a.Ef=t)),n&&n.push("rowDataArray",t)):-1===t&&-1===e&&(c=a.defaultDataNode,o&&!c&&(c=a.defaultDataNode={}),n&&n.push("defaultDataNode"))),c},bt.prototype.setNode=function(t,e,o){var n=this.dataTable,r=this.columnDataArray,i=this.rowDataArray;t<this.Xj&&e<this.OZ&&(0<=t&&0<=e?(n[t]||(n[t]={}))[e]=o:-1===t&&0<=e?r[e]=o:-1===e&&0<=t&&(i[t]=o))},bt.prototype._f=function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m;r&&(i=[],a=[]),s=this.dataTable,l=this.rowDataArray,u=this.columnDataArray,c=this.Ap,h=this.RTa(t,e,j,i),f=c[t]&&c[t][e],p=c[t]&&c[t].originalItem,d=this.RTa(o,n,j,a),g=c[o]&&c[o][n],m=c[o]&&c[o].originalItem,r&&(r.push([i,h]),r.push([a,d])),h?gt(t,e,o,n,h,s,l,u):d&&gt(t,e,o,n,D,s,l,u),d?gt(o,n,t,e,d,s,l,u):h&&gt(o,n,t,e,D,s,l,u),f?mt(0,0,o,n,f,c,p):g&&mt(0,0,o,n,D,c,p),g?mt(0,0,t,e,g,c,m):f&&mt(0,0,t,e,D,c,m)},bt.prototype.Yea=function(t){t++;for(var e=this.Xj,o=this.dataTable;0<=t&&t<e&&!o[t];)t++;return t<e?t:-1},bt.prototype.Hl=function(t,e){var o=D,n=this.OZ;if(0<=t&&t<this.Xj&&(o=this.dataTable[t]),o){for(e++;0<=e&&e<n&&!o[e];)e++;if(e<n)return e}return-1},bt.prototype.yIb=function(t){var e,o,n,r,i,a=t.row,s=t.col,l=t.rowCount,u=t.colCount;for(e=a,o=0;o<l;o++,e++)for(n=s,r=0;r<u;r++,n++)(i=this.RTa(e,n))&&(i.value=D)},bt.prototype._Sb=function(t,e,o){var n=o&&o.getFormatter(t,e);return!!P(n)&&n},bt.prototype.clear=function(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d=this.Xj,g=this.OZ,m=[],y=!!a,b=[];if(0<=t&&0<=e){if(o=w(o,d-t),n=w(n,g-e),0<o&&0<n)for(u=t;u<t+o;u++)if(!i||v.Common.k.Cb(i,u)<0)for(l=e;l<e+n;l++)y&&(c=[]),(s=this.RTa(u,l,j,c))&&(m.push(s),y&&b.push(c),0<(1&r)&&!F(s.value)&&(h=void 0,y&&(h={}),this.Cp(u,l,{Ep:s.value},h),h&&a.push(h)))}else if(0<=t&&-1===e){if(0<(o=w(o,d-t)))for(u=t;u<t+o;u++)y&&(c=[]),(s=this.RTa(u,-1,j,c))&&(m.push(s),y&&b.push(c))}else if(-1===t&&0<=e){if(0<(n=w(n,g-e)))for(l=e;l<e+n;l++)y&&(c=[]),(s=this.RTa(-1,l,j,c))&&(m.push(s),y&&b.push(c))}else-1===t&&-1===e&&(y&&(c=[]),(s=this.RTa(-1,-1,j,c))&&(m.push(s),y&&b.push(c)));for(f=function(o){if(s=m[o]){var t=y?[]:j;0<(8&r)&&(t&&t.push(["tag",s.tag]),s.tag=D),0<(2&r)&&(t&&t.push(["style",s.style]),s.style=D),0<(1&r)&&(t&&t.push(["value",s.value]),s.value=D),0<(16&r)&&(t&&t.push(["sparkline",s.sparkline]),s.sparkline=D),0<(64&r)&&(t&&t.push(["bindingPath",s.bindingPath]),s.bindingPath=D),0<(256&r)&&(t&&t.push(["hyperlink",s.hyperlink]),s.hyperlink=D),0<(4&r)&&(t&&t.push(["comment",s.comment]),s.comment=D),y&&t.forEach(function(t){var e=[].concat(b[o]);e.push(t[0]),t[0]=e,a.push(t)})}},p=0;p<m.length;p++)f(p)},bt.prototype.toJSON=function(t,g,m){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,y,b,v,C,w,x,T,A,S,M=m&&m.parent&&!N(m.parent.QHb);function I(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d;return o?(a={},s=o.value,F(s)||(a.value=s),g&&g.saveAsView&&(l=void 0,i?l=i:M&&(l=m&&m.getFormatter(t,e)),P(l)&&(u=m.aHb(t,e,l,s),F(u)||(a.value=u))),g&&g.ignoreStyle||("string"==typeof(c=o.style)?a.style=c:c&&(h=c.toJSON(n,r))&&(h.name=j,h.fontForColumnWidth=c.fontForColumnWidth,a.style=h)),f=o.bindingPath,F(f)||(a.bindingPath=f),p=o.tag,F(p)||(a.tag=p),d=o.hyperlink,F(d)||(a.hyperlink=L(d),delete a.hyperlink.isVisited),a):D}if(o={},n={},r=(e=this).Xj,i=e.OZ,a=e.dataTable,s=e.rowDataArray,l=e.columnDataArray,g&&g.saveAsView)for(h=0;h<r;){for(p=!(f={}),d=a[h],y=0;y<i;)b={},d&&d[y]||l[y]?b=I(h,y,e.RTa(h,y,!0)):3===t&&M&&(v=this._Sb(h,y,m))&&(b=I(h,y,e.RTa(h,y,!0),3,!1,v)),N(b)||(f[y]=b,p=!0),y++;p&&(n[h]=f),h++}else for(u=e.Yea(-1);0<=u;){for(p=!(f={}),c=e.Hl(u,-1);0<=c;)(C=e.RTa(u,c))&&(b=I(u,c,C),N(b)||(f[c]=b,p=!0)),c=e.Hl(u,c);p&&(n[u]=f),u=e.Yea(u)}for(N(n)||(o.dataTable=n),w=[],u=0;u<r;u++)X(s,u)&&s[u]&&(x=I(u,-1,s[u]),N(x)||(w[u]=x));for(0<w.length&&(o.rowDataArray=w),T=[],c=0;c<i;c++)X(l,c)&&l[c]&&(A=I(-1,c,l[c]),N(A)||(T[c]=A));return 0<T.length&&(o.columnDataArray=T),S=I(-1,-1,e.defaultDataNode,t,!0),N(S)||(o.defaultDataNode=S),o},bt.prototype.fromJSON=function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d=o&&o.incrementalLoading;if(t){if((i=this).ad(),i.gga++,a=t.dataTable,u=i.Xj,c=i.OZ,a?d&&3===n?dt(i,a,u,c,o,e,j,r):function(t,e,o,n,r,i){var a,s,l,u;for(a=0;a<o;a++)if(s=e[a])for(l=0;l<n;l++)(u=s[l])&&vt(u,t.RTa(a,l,!0),i,a,l,r)}(i,a,u,c,o,e):d&&r&&setTimeout(r,0),h=t.rowDataArray||t.Hf)for(s=0;s<u;s++)X(h,s)&&h[s]&&vt(h[s],i.RTa(s,-1,!0),e,s,-1,o);if(f=t.columnDataArray||t.If)for(l=0;l<c;l++)X(f,l)&&f[l]&&vt(f[l],i.RTa(-1,l,!0),e,-1,l,o);(p=t.defaultDataNode||t.Jf)&&vt(p,i.RTa(-1,-1,!0),e,-1,-1,o),i.gga--}else d&&r&&setTimeout(r,0)},V=bt,yt.prototype.WLc=function(t,e){var o=this.infos,n=o[t];return!n&&e&&(n=o[t]={}),n},yt.prototype.uL=function(t,e){var o=this.infos,n=o.length;0<=t&&t<=n&&0<e&&l(o,n,t,e)},yt.prototype.UTa=function(t,e,o){var n,r,i=this.infos,a=i.length;if(0<=t&&t<a&&0<e){if(e=w(e,a-t),o)for(n=0;n<e;n++)r=t+n,o.push([["infos",r],i[r]]);f(i,a,t,e)}},yt.prototype.VTa=function(){return this.infos.length},yt.prototype.Hp=function(){return this.infos},yt.prototype.Jp=function(t){return this.infos[t]},yt.prototype.Kp=function(t,e,o){var n=this.infos[t];this.infos[t]=e,o&&(o[0].push("infos",t),o[1]=n)},yt.prototype.getSize=function(t){var e=this.infos[t],o=D;return e&&(!1===e.visible?o=0:"number"==typeof e.size&&(o=_(e.size))),o},yt.prototype.getActualSize=function(t){var e=this.infos[t];return e?_(e.size):D},yt.prototype.setSize=function(t,e,o){var n=this.WLc(t,!0),r=n.size;r!==e&&(n.size=e),o&&(o[0].push("infos",t,"size"),o[1]=r)},yt.prototype.getStarSize=function(t){var e=this.infos[t];return e?e.starSize:j},yt.prototype.setStarSize=function(t,e,o){var n=this.WLc(t,!0),r=n.starSize;F(e)&&F(r)||(r!==e&&(F(e)?delete n.starSize:n.starSize=e),o&&(o[0].push("infos",t,"starSize"),o[1]=r))},yt.prototype.toJSON=function(t){var e,o,n,r,i,a,s,l,u=this.infos,c=[];if(t&&t.ignoreStarSize)for(e=0;e<u.length;e++)F(u[e])||(n=(o=u[e]).cellType,r=Y(o,["cellType"]),c[e]=L(r),n&&(n.toJSON&&(n=n.toJSON()),i=h._o,a=n.typeName,(s=i[n.type]||i[a]||b.getTypeFromString(a))&&((l=new s).fromJSON(n,t),c[e].cellType=l)),delete c[e].starSize);else for(e=0;e<u.length;e++)F(u[e])||(c[e]=u[e]);return 0<c.length?c:j},yt.prototype.fromJSON=function(t){t&&(this.infos=t)},W=(z=yt).prototype,d({visible:!0,resizable:!0,pageBreak:!1},function(i,n){var t=i[0].toUpperCase()+i.substr(1);W["get"+t]=function(t){var e=n,o=this.infos[t];return o&&!F(o[i])&&(e=o[i]),e},W["set"+t]=function(t,e,o){var n=this.WLc(t,!0),r=n[i];r!==e&&(n[i]=e),o&&(o[0].push("infos",t,i),o[1]=r)}}),Et.prototype.no=function(){this.modelManager=D},Et.prototype.getAnchorCell=function(t,e){return Nt(this.anchors,t,e)},Et.prototype.getAnchorItem=function(t,e){return Nt(this.cells,t,e)},Et.prototype.getAnchorInfo=function(t,e,o){var n,r,i,a,s=this.anchors,l=this.getAnchorCell(t,e);if(l)return l;if(n=this.getAnchorItem(t,e))for(i in r=n.anchorRefs)if(r[i]&&(a=Rt(s,i),o||a.isValid))return a},Et.prototype.isCellHasItsOwnValue=function(t,e,o){var n,r,i,a,s=this.getAnchorItem(t,e);if(s){if(!F(s.value)||s.AIb)return!0;for(i in n=s.anchorRefs,r=this.anchors,n)if(o!==i&&n[i]&&(a=Rt(r,i))&&a.isValid)return!0}return!1},Et.prototype.removeRef=function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y=this.cells,b=e.isValid,v=e.row,C=e.col,w=e.rowCount,x=e.colCount,T=1;for(a=0,s=v;a<w;a++,s++){for(l=C+T;T<x;T++,l++){if(c=(u=Nt(y,s,l))&&u.anchorRefs,h=!0,b){if(f=t.getValue(s,l),p=u&&u.value,F(p)){if(g=!(d=u&&u.AIb)||d===o,c)for(m in c)if(m!==o&&c[m]){h=!1;break}g?At(n,s,l,D,f,e.row===s&&e.col===l):p=f}r&&Tt(r,s,l,p)}c&&(delete c[o],h&&i&&N(c)&&kt(y,s,l,!0))}T=0}},Et.prototype.BIb=function(t,e,o,n,r){var i,a,s,l=t.getRowCount(),u=t.getColumnCount();return!(l<e+n||u<o+r||5e5<n*r||(i=t.getSheet(),a=A.kf(e,o,n,r),i._modelManager.getSpans(a).length||(s=i.tables)&&s.rn&&s.rn(e,o,n,r)))},Et.prototype.setArray=function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A=this,S=Mt(e,o),M=A.anchors,I=Nt(M,e,o),N=A.cells;if(I&&!i)return[I,(a=A.updateItem(t,e,o))[0],a[1]];if(s={},u=!(l={}),I&&I.isValid&&(u=!0,A.removeRef(t,I,S,s,l,!0)),c=I,xt(M,e,o,I={row:e,col:o,rowCount:n,colCount:r,values:i,isValid:!1}),h=t.getCalcService().CIb,I.CIb=h,f=c&&c.CIb===h&&(n!==c.rowCount||r!==c.colCount),(p=t.q$a)&&Nt(A.invalidAnchors,e,o))At(s,e,o,k&&R.Errors.Spill,D,I.row===e&&I.col===o),A.DIb(e,o,n,r,N,p,l,t,S,!0);else if(i){if(d=St(l,e,o,t),(g=!f&&A.BIb(t,e,o,n,r))&&(A.DIb(e,o,n,r,N,p,l,t,S),!p))for(m=1,y=0,b=e;y<n;y++,b++){for(v=o+m;m<r;m++,v++)if(C=St(l,b,v,t),!F(C)&&A.isCellHasItsOwnValue(b,v,S)){if(g=!1,!u)break;xt(s,b,v,C,!0)}if(!u&&!g)break;m=0}if(g)for(y=0,b=e;y<n;y++,b++)for(w=i[y],m=0,v=o;m<r;m++,v++)C=St(l,b,v,t),x=w[m],F(T=x)?T=0:k&&(R.Convert.Ca(x)||R.Convert._isReference(x))&&(T=1===x.getRowCount()&&1===x.getColumnCount()?R.Convert.Ca(x)?x.getValue(0,0):x.getValue(0,0,0):R.Errors.Calc),At(s,b,v,T,C,I.row===b&&I.col===v),(y||m)&&(Nt(N,b,v).AIb=S);else At(s,e,o,k&&R.Errors.Spill,d,I.row===e&&I.col===o);I.isValid=g,c&&g!==c.isValid&&A.modelManager.EIb(e,o,!g)}return[I,s,[c]]},Et.prototype.DIb=function(t,e,o,n,r,i,a,s,l,u){var c,h,f,p,d=1;for(c=0;c<o;c++){for(h=t+c;d<n;d++)f=e+d,(p=!u&&Nt(r,h,f))||(p={anchorRefs:{}},i&&!u||(p.value=St(a,h,f,s)),xt(r,h,f,p)),p.anchorRefs[l]=!0;d=0}},Et.prototype.updateItem=function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d;if(void 0===r&&(r={}),void 0===i&&(i=[]),a=Mt(e,o),(l=Nt(s=this.anchors,e,o))&&(this.removeRef(t,l,a,r,j,!0),kt(r,e,o),kt(s,e,o,!0)),u=Nt(this.cells,e,o))for(h in this.modelManager.FIb(e,o,u.value),u.value=n,delete u.AIb,c=u.anchorRefs)c[h]&&(f=Rt(s,h),d=f,-1===(p=i).indexOf(d)&&p.push(d));if(l||u)return[l&&r,i]},Et.prototype.GIb=function(t,e){xt(this.invalidAnchors,t,e,!0)},Et.prototype.HIb=function(){this.invalidAnchors={}},Et.prototype.IIb=function(e,t,o){var n,r,i,a,s,l,u,c=this,h=c.anchors,f=[];for(n in h)if(h.hasOwnProperty(n))for(s in i=t<=(r=+n),a=h[n])a.hasOwnProperty(s)&&(l=+s,(i=i||(u=a[s])&&u.rowCount+r>=t)&&f.push([r,l]));f.length&&f.forEach(function(t){c.updateItem(e,t[0],t[1],j)})},Et.prototype.NTa=function(t,e,o){this.IIb(t,e,o)},Et.prototype.PTa=function(t,e,o){this.IIb(t,e,o)},Et.prototype.JIb=function(e,t){var o,n,r,i,a,s,l,u=this,c=u.anchors,h=[];for(o in c)if(c.hasOwnProperty(o))for(i in n=+o,r=c[o])r.hasOwnProperty(i)&&((s=t<=(a=+i))||(s=(l=r[i])&&l.colCount+a>=t),s&&h.push([n,a]));h.length&&h.forEach(function(t){u.updateItem(e,t[0],t[1],j)})},Et.prototype.OTa=function(t,e,o){this.JIb(t,e)},Et.prototype.QTa=function(t,e,o){this.JIb(t,e)},G=Et,e.KIb=G,e.clearSpillValuesOnAddRemove=Dt,_t.prototype.Agc=function(t,e){this.zgc({type:I.AxisInfoChangeType.setRowCount,count:t}),this.zgc({type:I.AxisInfoChangeType.setColumnCount,count:e})},_t.prototype.zgc=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d=this.kj,g=t.type,m=t.sheetArea;if((void 0===m?I.SheetArea.viewport:m)===I.SheetArea.viewport){if(F(this.Bgc)&&(this.Bgc=[]),F(this.Cgc)&&(this.Cgc=[]),this.Dgc)return void this.Egc(t);switch(e=this.Bgc,o=this.Cgc,g){case I.AxisInfoChangeType.setRowCount:if(0<(i=(n=t.count)-(r=e.length)))for(a=It(x,i),s=0;s<a.length;s++)e.splice(r+s,0,a[s]);else e.length=n;break;case I.AxisInfoChangeType.setColumnCount:if(0<(i=(n=t.count)-(r=o.length)))for(a=It(x,i),s=0;s<a.length;s++)o.splice(r+s,0,a[s]);else o.length=n;break;case I.AxisInfoChangeType.addRows:for(l=t.index,n=t.count,u=It(x,n),s=0;s<u.length;s++)e.splice(l+s,0,u[s]);break;case I.AxisInfoChangeType.deleteRows:l=t.index,n=t.count,e.splice(l,n);break;case I.AxisInfoChangeType.addColumns:for(l=t.index,n=t.count,u=It(x,n),s=0;s<u.length;s++)o.splice(l+s,0,u[s]);break;case I.AxisInfoChangeType.deleteColumns:l=t.index,n=t.count,o.splice(l,n);break;case I.AxisInfoChangeType.setRowHeight:case I.AxisInfoChangeType.setRowVisible:l=t.index,c=t.value,e[l]=c;break;case I.AxisInfoChangeType.setColumnWidth:case I.AxisInfoChangeType.setColumnVisible:l=t.index,c=t.value,o[l]=c;break;case I.AxisInfoChangeType.filterRows:for(f=0,p=h=t.index;f<p.length;f++)l=p[f],c=d.getRowHeight(l),e[l]=c;break;case I.AxisInfoChangeType.outlineExpandRows:for(h=t.index,s=0;s<h.length;s++)l=h[s],c=d.getRowHeight(l),e[l]=c;break;case I.AxisInfoChangeType.outlineExpandColumns:for(h=t.index,s=0;s<h.length;s++)l=h[s],c=d.getColumnWidth(l),o[l]=c}}},_t.prototype.Fgc=function(t){if(this.Bgc){var e=this.Bgc[t];return e===x?this.defaults.rowHeight:e}},_t.prototype.Ggc=function(t){if(this.Cgc){var e=this.Cgc[t];return e===x?this.defaults.colWidth:e}},_t.prototype.wgc=function(){this.Dgc=[]},_t.prototype.ygc=function(){var t,e,o,n=this.Dgc;if(this.Dgc=D,n)for(t=0,e=n;t<e.length;t++)o=e[t],this.zgc(o)},_t.prototype.Egc=function(t){this.Dgc&&this.Dgc.push(t)},_t.prototype.xgc=function(){this.Bgc=D,this.Cgc=D},_t.prototype.no=function(t){!1!==t&&(this.kj=D,this.sheetModels=D,this.ZHb&&(this.ZHb.no(),this.ZHb=D),this.xgc()),_t.ao(this,"dispose",{clearCache:t})},_t.prototype.addRows=function(t,e,o,n){var r,i=this;0<i.WTa&&(r={row:t,rowCount:e,type:"addRows"},i.zTa.push(r)),i._getSheetModel(3).NTa(t,e,n),i._getSheetModel(2).NTa(t,e,n),i.zl(3).NTa(t,e),i.zl(2).NTa(t,e),i.YTa(!0,3).uL(t,e),k&&i.ZHb.NTa(i.kj.yj(),t,e),o||_t.ao(i,"addRows",{row:t,rowCount:e,changes:i.zTa}),i.zgc({type:I.AxisInfoChangeType.addRows,index:t,count:e})},_t.prototype.ZTa=function(t){var e=t.row,o=t.rowCount;Dt(this,e,0,0,!0),this.deleteRows(e,o,!0),_t.ao(this,"undoAddRows",{row:e,rowCount:o})},_t.prototype.deleteRows=function(t,e,o){var n,r,i,a,s,l,u,c,h,f=this;if(0<f.WTa&&(r=[],i=[],a=[["spanModels",3],j],s=[["spanModels",2],j],l=[],n={row:t,rowCount:e,type:"deleteRows"},f.zTa.push(n)),f._getSheetModel(3).STa(t,e,r),f._getSheetModel(2).STa(t,e,i),f.zl(3).PTa(t,e,a),f.zl(2).PTa(t,e,s),f.YTa(!0,3).UTa(t,e,l),k&&f.ZHb.PTa(f.kj.yj(),t,e),o||_t.ao(f,"deleteRows",{row:t,rowCount:e,changes:f.zTa}),n){for(u=n.changes=[],c=["sheetModels",3],h=0;h<r.length;h++)r[h][0]=c.concat(r[h][0]),u.push(r[h]);for(c=["sheetModels",2],h=0;h<i.length;h++)i[h][0]=c.concat(i[h][0]),u.push(i[h]);for(0<a.length&&u.push(a),0<s.length&&u.push(s),c=[p,3],h=0;h<l.length;h++)l[h][0]=c.concat(l[h][0]),u.push(l[h])}f.zgc({type:I.AxisInfoChangeType.deleteRows,index:t,count:e})},_t.prototype.$Ta=function(t){var e,o,n,r=t.row,i=t.rowCount;for(Dt(this,r,0,0,!0),this.addRows(r,i,!0,!0),o=(e=t.changes).length-1;0<=o;o--)Ct(this,e[o]);(n=this.kj&&this.kj.Ts)&&n.splice(n.length-i,i)},_t.prototype.addColumns=function(t,e,o){var n,r=this;0<r.WTa&&(n={col:t,colCount:e,type:"addColumns"},r.zTa.push(n)),r._getSheetModel(3).OTa(t,e),r._getSheetModel(1).OTa(t,e),r.zl(3).OTa(t,e),r.zl(1).OTa(t,e),r.YTa(!1,3).uL(t,e),k&&r.ZHb.OTa(r.kj.yj(),t,e),o||_t.ao(r,"addColumns",{col:t,colCount:e,changes:r.zTa}),r.zgc({type:I.AxisInfoChangeType.addColumns,index:t,count:e})},_t.prototype._Ta=function(t){var e=t.col,o=t.colCount;Dt(this,e,0,0,!1),this.deleteColumns(e,o,!0)},_t.prototype.deleteColumns=function(t,e,o){var n,r,i,a,s,l,u,c,h,f=this;if(0<f.WTa&&(r=[],i=[],a=[["spanModels",3],j],s=[["spanModels",1],j],l=[],n={col:t,colCount:e,type:"deleteColumns"},f.zTa.push(n)),f._getSheetModel(3).TTa(t,e,r),f._getSheetModel(1).TTa(t,e,i),f.zl(3).QTa(t,e,a),f.zl(1).QTa(t,e,s),f.YTa(!1,3).UTa(t,e,l),k&&f.ZHb.QTa(f.kj.yj(),t,e),o||_t.ao(f,"deleteColumns",{col:t,colCount:e,changes:f.zTa}),n){for(u=n.changes=[],c=["sheetModels",3],h=0;h<r.length;h++)r[h][0]=c.concat(r[h][0]),u.push(r[h]);for(c=["sheetModels",1],h=0;h<i.length;h++)i[h][0]=c.concat(i[h][0]),u.push(i[h]);for(0<a.length&&u.push(a),0<s.length&&u.push(s),c=[g,3],h=0;h<l.length;h++)l[h][0]=c.concat(l[h][0]),u.push(l[h])}f.zgc({type:I.AxisInfoChangeType.deleteColumns,index:t,count:e})},_t.prototype.aUa=function(t){var e,o,n=t.col,r=t.colCount;for(Dt(this,n,0,0,!1),this.addColumns(n,r,!0),o=(e=t.changes).length-1;0<=o;o--)Ct(this,e[o])},_t.prototype.getRowCount=function(t){return this._getSheetModel(t).getRowCount()},_t.prototype.setRowCount=function(t,e,o){var n=this.getRowCount(e);0<this.WTa&&this.zTa.push({oldRowCount:n,sheetArea:e,type:"setRowCount"}),3===e||2===e?(t<n&&this.deleteRows(t,n-t,o),this._getSheetModel(3).setRowCount(t),this._getSheetModel(2).setRowCount(t)):1===e&&(t<n&&this.YTa(!0,e).UTa(t,n-t),this._getSheetModel(e).setRowCount(t)),this.zgc({type:I.AxisInfoChangeType.setRowCount,count:t,sheetArea:e})},_t.prototype.bUa=function(t){this.setRowCount(t.oldRowCount,t.sheetArea,!0)},_t.prototype.getColumnCount=function(t){return this._getSheetModel(t).getColumnCount()},_t.prototype.setColumnCount=function(t,e,o){var n=this.getColumnCount(e);0<this.WTa&&this.zTa.push({oldColCount:n,sheetArea:e,type:"setColumnCount"}),3===e||1===e?(t<n&&this.deleteColumns(t,n-t,o),this._getSheetModel(3).setColumnCount(t),this._getSheetModel(1).setColumnCount(t)):2===e&&(t<n&&this.YTa(!1,e).UTa(t,n-t),this._getSheetModel(e).setColumnCount(t)),this.zgc({type:I.AxisInfoChangeType.setColumnCount,count:t,sheetArea:e})},_t.prototype.cUa=function(t){this.setColumnCount(t.oldColCount,t.sheetArea,!0)},_t.prototype.getLastNonNullRow=function(t,e){var o=e?0:this.YTa(!0,t).VTa()-1;return s(this._getSheetModel(t).Ef,this.zl(t).Ef,o)},_t.prototype.getLastNonNullCol=function(t,e){var o=e?0:this.YTa(!1,t).VTa()-1;return s(this._getSheetModel(t).Ff,this.zl(t).Ff,o)},_t.prototype.$Gb=function(){var s=this.kj,t=0!==s.Dr().height&&this._Gb(!0,s.defaults.rowHeight),e=0!==s.Dr().width&&this._Gb(!1,s.defaults.colWidth);function o(t,e){var o,n,r,i,a=e.length;for(o=0;o<a;o++)n=e[o][0],r=e[o][1],(i=e[o][2])!==r&&(t?s.kq(n,3,"height",r,i):s.pq(n,3,"width",r,i))}t&&o(!0,t),e&&o(!1,e)},_t.prototype._Gb=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C=this.kj,w=[],x=C.zoom(),T=t?C.getRowCount():C.getColumnCount(),A=this.YTa(t,3),S=0,M=0;if(C.Gt&&(M=t?C.Gt().height:C.Gt().width),t){if(C.options.colHeaderVisible)for(n=0;n<C.getRowCount(1);n++)S+=O(x*C.getRowHeight(n,1));o=C.Dr().height-C.options.sheetAreaOffset.top-M-S}else{if(C.options.rowHeaderVisible)for(n=0;n<C.getColumnCount(2);n++)S+=O(x*C.getColumnWidth(n,2));o=C.Dr().width-C.options.sheetAreaOffset.left-M-S}for(r=[],i=[],a=[],s=0,l=t?C.getRowVisible:C.getColumnVisible,n=0;n<T;n++)if(u=l.call(C,n),c=C._modelManager.getSize(t,3,n),h=C._modelManager.getStarSize(t,3,n),E.test(h))f="*"===h?1:parseFloat(h.replace("*","")),u&&0<f?(s+=f,r.push(n),i.push(f),a.push(c)):w.push([n,0,c]);else if(c="number"==typeof c?Math.floor(c):e,u&&(o-=O(x*c))<1)return;if(!(s+w.length===0||o<1)){for(p=r.length,n=0;n<p-1;n++)if(d=o/s/x,f=i[n],c=_(d*f),g=O(x*c),w.push([r[n],c,a[n]]),o-=g,s-=f,g<1||o<1)return;for(m=O((o-1e-4)/x),w.push([r[p-1],m,a[p-1]]),n=0;n<w.length;n++)y=w[n][0],b=w[n][1],A.setSize(y,b),v=t?I.AxisInfoChangeType.setRowHeight:I.AxisInfoChangeType.setColumnWidth,this.zgc({type:v,index:y});return w}},_t.prototype.setCellState=function(t,e,o,n,r){var i=this._getSheetModel(r);i&&i.setCellState(t,e,o,n)},_t.prototype.toJSON=function(t){var e,o,n,r=this,i={};return i.data=r._getSheetModel(3).toJSON(3,t,r.kj),i.rowHeaderData=r._getSheetModel(2).toJSON(2,t),i.colHeaderData=r._getSheetModel(1).toJSON(1,t),i.rows=r.YTa(!0,3).toJSON(t),i.columns=r.YTa(!1,3).toJSON(t),i.rowHeaderColInfos=r.YTa(!1,2).toJSON(t),i.colHeaderRowInfos=r.YTa(!0,1).toJSON(t),e=r.kj,i.leftCellIndex=e.getViewportLeftColumn(1),i.topCellIndex=e.getViewportTopRow(1),t&&t.ignoreStyle||(i.spans=jt(r.zl(3).toJSON()),i.rowHeaderSpan=jt(r.zl(2).toJSON()),i.colHeaderSpan=jt(r.zl(1).toJSON())),i.selections=r.selectionModel.toJSON(),20===(n={colHeaderRowHeight:(o=r.defaults).colHeaderRowHeight,colWidth:o.colWidth,rowHeaderColWidth:o.rowHeaderColWidth,rowHeight:o.rowHeight,_isExcelDefaultColumnWidth:o._isExcelDefaultColumnWidth}).rowHeight&&62===n.colWidth&&40===n.rowHeaderColWidth&&20===n.colHeaderRowHeight||(i.defaults=n),i},_t.prototype.fromJSON=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g=this;if(g._getSheetModel(3).fromJSON(t.data,e,o,3,n),g._getSheetModel(2).fromJSON(t.rowHeaderData,e,o),g._getSheetModel(1).fromJSON(t.colHeaderData,e,o),g.kj.showCell(t.topCellIndex||0,t.leftCellIndex||0,I.VerticalPosition.top,I.HorizontalPosition.left),g.YTa(!0,3).fromJSON(t.rows),g.YTa(!1,3).fromJSON(t.columns),g.YTa(!1,2).fromJSON(t.rowHeaderColInfos),g.YTa(!0,1).fromJSON(t.colHeaderRowInfos),t&&t.rows)for(r=0,i=Object.keys(t.rows);r<i.length;r++)a=i[r],s=t.rows[a],F(s)||g.zgc({type:I.AxisInfoChangeType.setRowHeight,index:+a});if(t&&t.columns)for(l=0,u=Object.keys(t.columns);l<u.length;l++)a=u[l],s=t.columns[a],F(s)||g.zgc({type:I.AxisInfoChangeType.setColumnWidth,index:+a});o&&o.ignoreStyle||(g.zl(3).fromJSON(t.spans),g.zl(2).fromJSON(t.rowHeaderSpan),g.zl(1).fromJSON(t.colHeaderSpan)),g.selectionModel.fromJSON(t.selections,t.rowCount,t.columnCount),(c=t.tag)!==j&&(typeof(h=c.typeName)===C&&(!(f=b.getTypeFromString(h))||(c=new f).fromJSON&&c.fromJSON(t.tag)),g.do("setValueForKey",-1,-1,"tag",c,3)),(p=t.defaults)!==j&&((d=g.defaults).colHeaderRowHeight=Q(p.colHeaderRowHeight,20),d.colWidth=Q(p.colWidth,62),d.rowHeaderColWidth=Q(p.rowHeaderColWidth,40),d.rowHeight=Q(p.rowHeight,20),d._isExcelDefaultColumnWidth=p._isExcelDefaultColumnWidth)},_t.prototype.startTransaction=function(){0===this.WTa&&(this.zTa=[],this.kj.isEventSuspended()||(this.zTa.events=[]),_t.ao(this,"startTransaction")),this.WTa++},_t.prototype.endTransaction=function(){var t,e;return this.WTa--,0===this.WTa?(_t.ao(this,"endTransaction"),t=this.zTa,this.zTa=j,(e=t.events)&&0===e.length&&delete t.events,t):[]},_t.prototype.dUa=function(){var t=this.zTa;if(t)return t.calc||(t.calc=[]),t.calc},_t.prototype.EIb=function(t,e,o){var n=this.zTa;n&&n.push({type:"setIsValid",value:[t,e,o]})},_t.prototype.FIb=function(t,e,o){var n=this.zTa;n&&n.push({type:"dirtyItem",value:[t,e,o]})},_t.prototype.MIb=function(t){var e,o,n=t.value;!n||(e=this.ZHb.getAnchorCell(n[0],n[1]))&&(o=n[2],e.isValid=o)},_t.prototype.NIb=function(t){var e,o,n,r,i=t.value;i&&(e=i[0],o=i[1],n=i[2],(r=this.ZHb.getAnchorItem(e,o))&&(r.value=n))},_t.prototype.undo=function(t){var e,o,n,r,i,a,s,l,u=[],c=t&&t.events;if(c&&this.YVa(c,!0),t)for(e=t.length-1;0<=e;e--)(n=(o=t[e]).type)?"addRows"===n?this.ZTa(o):"addColumns"===n?this._Ta(o):"deleteRows"===n?this.$Ta(o):"deleteColumns"===n?this.aUa(o):"setRowCount"===n?this.bUa(o):"setColumnCount"===n?this.cUa(o):"setZoomFactor"===n?this.fUa(o.value):"updateDirty"===n?(this.gWa(o),u.push(o)):"setName"===n?this.pZa(o.value):"sortRange"===n?this.yxb(o):"setIsValid"===n?this.MIb(o):"dirtyItem"===n&&this.NIb(o):Ct(this,o);(r=this.kj).Oq={},r.Jq(),(i=0<u.length)&&((a=r.Wu)&&a.suspend(),u.forEach(function(t){r.eyb(t.row,t.col,3,!1)})),(s=t&&t.uVa)&&0<s.length&&(_t.ao(this,"undo",{uVa:s}),delete t.uVa),(l=t&&t.calc)&&l.length&&r.gUa(l),i&&(a&&a.resume(!1),r.fyb()),t&&_t.ao(this,"undo",t),c&&this.YVa(c,!1)},_t.prototype.do=function(t){var e,o,n=[];for(e=1;e<arguments.length;e++)n[e-1]=arguments[e];!t||(o=this[t])&&o.apply(this,n)},_t.prototype._getSheetModel=function(t){return F(t)&&(t=3),this.sheetModels[t]},_t.prototype.dWa=function(t,e,o){F(o)&&(o=3),this.sheetModels[o]=new V(t,e)},_t.prototype.ZVa=function(t){var e=this.zTa,o=e&&e.events;o&&o.push(t)},_t.prototype.YVa=function(t,e){var o,n,r,i,a=this.kj;for(a.OIb=!0,o=t.length-1;0<=o;o--)i=void 0,"cellChanged"!==(r=(n=t[o])[0])||e?"rowChanged"!==r||e?"columnChanged"!==r||e?"zoomChanged"!==r||e?"rowChanging"===r&&e?i=a.pCb:"columnChanging"===r&&e?i=a.qCb:"tableRowsChanged"!==r||e?"tableColumnsChanged"!==r||e?"rangeChanged"!==r||e||(i=a.RIb):i=a.QIb:i=a.PIb:i=a.gyb:i=a.pq:i=a.kq:i=a.Bq,i&&([].splice.call(t,o,1),i.apply(a,[].slice.call(n,1)));a.OIb=!1},_t.prototype.getValue=function(t,e,o,n,r){var i,a,s,l,u;if(F(o)&&(o=3),a=!1,s=!!this.kj.xUc,!n&&(l={row:t,col:e,sheetArea:o,isValueGet:!1,value:j},_t.ao(this,"getValue",l,function(){return l.isValueGet}),l.isValueGet)){if(!s)return l.value;i=l.value,a=!0}return u=this._getSheetModel(o).getValue(t,e,r),s&&a&&!this.XLc(t,e,o)&&(u=i),u},_t.prototype.setValue=function(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m,y,b;F(n)&&(n=3),u=(l=this).kj,(c=!i&&!u.isEventSuspended())&&(s=u.getValue(t,e,n,1)),h=!1,k&&u.getCalcService().allowDynamicArray&&!l.SIb&&3===n&&(l.LIb.push(l.ZHb.updateItem(u.yj(),t,e,o)),h=!0),f=!1,r||(p={row:t,col:e,value:o,sheetArea:n,isValueSet:!1,changes:l.zTa},_t.ao(l,"setValue",p,function(){return p.isValueSet}),f=p.isValueSet),f||(g=d=void 0,0<l.WTa&&!a&&(d=[["sheetModels",n],j],g={sheetArea:n}),l._getSheetModel(n).setValue(t,e,o,d,g),d&&0<d.length&&l.zTa.push(d),g&&g.type&&l.zTa.push(g),u.fyb()),c?(m=s!==o,y=!1,b=void 0,typeof o===C&&((b=A.util.w0a(o))instanceof Date&&(y=!0),s instanceof Date&&(m=s.valueOf()!==b.valueOf())),m&&u.Bq("value",t,e,n,s,y&&b?b:o)):u.WXc(u,[{row:t,col:e}],0),h&&l.applyDynamicChanges()},_t.prototype.applyDynamicChanges=function(){var t,e,o,n,r,i=this.LIb,a=this.kj;if(!this.SIb&&i.length){for(this.SIb=!0,t=a.yj(),e=a.Bj(),o=0,n=i;o<n.length;o++)(r=n[o])&&(R.setSpillValues(r[0],t),R.markAnchorCellDirty(r[1],e,this.ZHb));i.length=0,this.SIb=!1}},_t.prototype.getDynamicArrayInfo=function(t,e){return this.ZHb.getAnchorInfo(t,e)},_t.prototype.getStyle=function(t,e,o){return this._getSheetModel(o).getStyle(t,e,0<this.WTa)},_t.prototype.setStyle=function(t,e,o,n){F(n)&&(n=3);var r=0<this.WTa?[["sheetModels",n],j]:j;this._getSheetModel(n).setStyle(t,e,o,r),r&&0<r.length&&this.zTa.push(r)},_t.prototype.getValueForKey=function(t,e,o,n){return this._getSheetModel(n).getValueForKey(t,e,o)},_t.prototype.setValueForKey=function(t,e,o,n,r){F(r)&&(r=3);var i=0<this.WTa?[["sheetModels",r],j]:j;this._getSheetModel(r).setValueForKey(t,e,o,n,i),i&&0<i.length&&this.zTa.push(i)},_t.prototype.clear=function(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m,y,b,v;if(F(a)&&(a=3),s=0<this.WTa?[]:j,l=!1,k&&!this.SIb&&3===a){for(u=this.kj.yj(),c=this.LIb,h=this.ZHb,f={},p=[],d=0;d<o;d++)for(g=0;g<n;g++)h.updateItem(u,t+d,e+g,D,f,p);c.push([f,p]),l=!0}if(this._getSheetModel(a).clear(t,e,o,n,r,i,s),_t.ao(this,"clear",{row:t,col:e,rowCount:o,colCount:n,type:r,ignoredRowList:i,sheetArea:a,changes:this.zTa}),s)for(m=["sheetModels",a],y=0,b=s.length;y<b;y++)(v=s[y])[0]=m.concat(v[0]),this.zTa.push(v);l&&this.applyDynamicChanges()},_t.prototype.swapNode=function(t,e,o,n,r){var i,a,s,l,u;if(F(r)&&(r=3),i=0<this.WTa?[]:j,this._getSheetModel(r)._f(t,e,o,n,i),i)for(a=["sheetModels",r],s=0,l=i.length;s<l;s++)(u=i[s])[0]=a.concat(u[0]),this.zTa.push(u)},_t.prototype.Cp=function(t,e,o,n){var r;0<this.WTa&&(r={sheetArea:n},F(n)&&(r.sheetArea=3)),this._getSheetModel(n).Cp(t,e,o,r),r&&this.zTa.push(r)},_t.prototype.gWa=function(t){this._getSheetModel(t.sheetArea).gWa(t)},_t.prototype.hUa=function(t){return this._getSheetModel(t).Ap},_t.prototype.XLc=function(t,e,o){var n=this.hUa(o)[t];return!(!n||!n[e])},_t.prototype.YLc=function(t,e,o){var n,r,i=this._getSheetModel(o).Ap;for(n=0;n<e;n++)(r=t+n)in i&&delete i[r]},_t.prototype.ZLc=function(t,e){var o,n,r=this.kj.Ts;if(r)for(o=r.length-1;0<=o;o--)t<=(n=r[o].row)&&n<t+e&&r.splice(o)},_t.prototype.iUa=function(t){this._getSheetModel(t).Ap={}},_t.prototype.Lec=function(t,e,o,n){var r,i,a,s=this.hUa();if(s)for(r in s)X(s,r)&&(i=s[r],a=parseInt(r,10),i&&"n"===i.rs&&(t||e&&o<=a&&a<o+n)&&(s[r]={}))},_t.prototype.Mec=function(i,t,a,e,s){var o,n,r,l,u,c,h=this.hUa(),f=this.kj,p=f.tables;if(!N(h)){if(o=[],0<=t)for(n=t;n<t+e;n++)o.push(n);else for(r in h)X(h,r)&&o.push(parseInt(r,10));l=[],u=[],p&&(l=p.Nec(t,a,e,s),u=p.Oec(t,a,e,s),0<l.length&&_t.ao(this,"clearPendingChanges",{tableList:l})),d(o,function(t,e){var o,n,r;if((c=h[e])&&"e"===c.rs)if(o=u.length,i)if(p&&0!==o&&p.Pec(u,e,-1))for(n=f.getColumnCount(),r=0;r<n;r++)p&&0!==o&&p.Pec(u,e,r)||c[r]&&delete c[r];else h[e]={};else for(r=a;r<a+s;r++)p&&0!==o&&p.Pec(u,e,r)||c[r]&&delete c[r]})}},_t.prototype.Qec=function(){var t,e=this.hUa();for(t in e)X(e,t)&&"e"===e[t].rs&&(e[t]={})},_t.prototype.jUa=function(t){this._getSheetModel(t).gga++},_t.prototype.kUa=function(t){var e=this._getSheetModel(t);e.gga--,e.gga<0&&(e.gga=0)},_t.prototype.getName=function(){return this.name||""},_t.prototype.setName=function(t){0<this.WTa&&this.zTa.push({type:"setName",value:this.name}),this.name=t},_t.prototype.TIb=function(){return this.isSelected},_t.prototype.CHb=function(t){this.isSelected=t},_t.prototype.pZa=function(t){this.kj.name(t)},_t.prototype.yxb=function(t){var o,n=[];o=t.byRows?t.row:t.column,t.array.map(function(t,e){n[t-o]=e+o}),this.kj.sortRange(t.row,t.column,t.rowCount,t.columnCount,t.byRows,t.sortInfo,D,n)},_t.prototype.getZoomFactor=function(){return this.zoomFactor},_t.prototype.setZoomFactor=function(t){0<this.WTa&&this.zTa.push({type:"setZoomFactor",value:this.zoomFactor}),this.zoomFactor=t},_t.prototype.fUa=function(t){this.kj.zoom(t)},_t.prototype.zl=function(t){return F(t)&&(t=3),this.spanModels[t]},_t.prototype.eWa=function(t){F(t)&&(t=3),this.spanModels[t]=new M},_t.prototype.getSpans=function(t,e,o){var n=this.zl(e).getSpans(t);return o&&(n=n.filter(function(t){return!t.isAutoMerge})),n},_t.prototype.getSpan=function(t,e,o){return this.zl(o).get(t,e)},_t.prototype.uIb=function(t,e,o){var n,r;return F(o)&&(o=3),(n=this._getSheetModel(o))&&n.RTa&&(r=n.RTa(t,e))&&r.tipContent?r.tipContent:null},_t.prototype.qHb=function(t,e,o,n){F(n)&&(n=3);var r=this._getSheetModel(n).RTa(t,e);!o&&r?delete r.tipContent:o&&r?r.tipContent=o:o&&!r&&((r=this._getSheetModel(n).RTa(t,e,!0)).tipContent=o)},_t.prototype.MTa=function(t,e,o,n,r){return this.zl(r).MTa(t,e,o,n)},_t.prototype.qu=function(t,e,o,n,r){return this.zl(r).qu(t,e,o,n)},_t.prototype.findSpan=function(t,e,o){return this.zl(o).find(t,e)},_t.prototype.removeSpan=function(t,e){F(e)&&(e=3);var o=0<this.WTa?[["spanModels",e],j]:j;this.zl(e).remove(t,o),o&&0<o.length&&this.zTa.push(o)},_t.prototype.addSpan=function(t,e){F(e)&&(e=3);var o=0<this.WTa?[["spanModels",e],j]:j;this.zl(e).add(t,o),o&&0<o.length&&this.zTa.push(o)},_t.prototype.clearSpan=function(t,e,o,n,r){F(r)&&(r=3);var i=0<this.WTa?[["spanModels",r],j]:j;this.zl(r).$b(t,e,o,n,i),i&&0<i.length&&this.zTa.push(i)},_t.prototype.moveSpan=function(t,e,o,n,r,i,a){F(a)&&(a=3);var s=0<this.WTa?[["spanModels",a],j]:j;this.zl(a).aB(t,e,o,n,r,i,s),s&&0<s.length&&this.zTa.push(s)},_t.prototype.copySpan=function(t,e,o,n,r,i,a){F(a)&&(a=3);var s=0<this.WTa?[["spanModels",a],j]:j;this.zl(a).Zz(t,e,o,n,r,i,s),s&&0<s.length&&this.zTa.push(s)},_t.prototype.addSelection=function(t,e,o,n){var r,i,a=0<this.WTa?[]:j;if(this.selectionModel.add(t,e,o,n,a),a)for(r=0;r<a.length;r++)(i=a[r])[0]=["selectionModel"].concat(i[0]),this.zTa.push(i)},_t.prototype.getSelections=function(){return this.selectionModel.get()},_t.prototype.setSelections=function(t){var e,o,n=0<this.WTa?[]:j;if(this.selectionModel.set(t,n),n)for(e=0;e<n.length;e++)(o=n[e])[0]=["selectionModel"].concat(o[0]),this.zTa.push(o)},_t.prototype.clearSelection=function(){var t,e,o=0<this.WTa?[]:j;if(this.selectionModel.clear(o),o)for(t=0;t<o.length;t++)(e=o[t])[0]=["selectionModel"].concat(e[0]),this.zTa.push(e)},_t.prototype.getActiveSelectedRangeIndex=function(){return this.selectionModel.getProperty("activeSelectedRangeIndex")},_t.prototype.setActiveSelectedRangeIndex=function(t){var e=0<this.WTa?[["selectionModel"],j]:j;this.selectionModel.setProperty("activeSelectedRangeIndex",t,e),e&&this.zTa.push(e)},_t.prototype.getSelectionPolicy=function(){return this.selectionModel.getProperty("selectionPolicy")},_t.prototype.setSelectionPolicy=function(t){wt(this,"selectionPolicy",t)},_t.prototype.getSelectionUnit=function(){return this.selectionModel.getProperty("selectionUnit")},_t.prototype.setSelectionUnit=function(t){wt(this,"selectionUnit",t)},_t.prototype.sp=function(t){return this.selectionModel.sp(t)},_t.prototype.tp=function(t){return this.selectionModel.tp(t)},_t.prototype.vp=function(t,e,o,n,r,i){return this.selectionModel.vp(t,e,o,n,r,i)},_t.prototype.wp=function(t,e,o,n,r){return this.selectionModel.wp(t,e,o,n,r)},_t.prototype.YTa=function(t,e){return F(e)&&(e=3),(t?this.rowInfos:this.colInfos)[e]},_t.prototype.fWa=function(t,e){F(e)&&(e=3),(t?this.rowInfos:this.colInfos)[e]=new z},_t.prototype.getPageBreak=function(t,e,o){return this.YTa(t,e).getPageBreak(o)},_t.prototype.setPageBreak=function(t,e,o,n){var r;F(e)&&(e=3),r=0<this.WTa?[[t?p:g,e],j]:j,this.YTa(t,e).setPageBreak(o,n,r),r&&this.zTa.push(r)},_t.prototype.getVisible=function(t,e,o){return this.YTa(t,e).getVisible(o)},_t.prototype.setVisible=function(t,e,o,n){var r,i;F(e)&&(e=3),r=0<this.WTa?[[t?p:g,e],j]:j,this.YTa(t,e).setVisible(o,n,r),r&&this.zTa.push(r),i=t?I.AxisInfoChangeType.setRowVisible:I.AxisInfoChangeType.setColumnVisible,this.zgc({type:i,index:o,sheetArea:e})},_t.prototype.getResizable=function(t,e,o){return this.YTa(t,e).getResizable(o)},_t.prototype.setResizable=function(t,e,o,n){var r;F(e)&&(e=3),r=0<this.WTa?[[t?p:g,e],j]:j,this.YTa(t,e).setResizable(o,n,r),r&&this.zTa.push(r)},_t.prototype.getSize=function(t,e,o){return this.YTa(t,e).getSize(o)},_t.prototype.getStarSize=function(t,e,o){return this.YTa(t,e).getStarSize(o)},_t.prototype.getActualSize=function(t,e,o){return this.YTa(t,e).getActualSize(o)},_t.prototype.setSize=function(t,e,o,n){var r,i;F(e)&&(e=3),r=0<this.WTa?[[t?p:g,e],j]:j,this.YTa(t,e).setSize(o,n,r),r&&this.zTa.push(r),this.setStarSize(t,e,o,D),i=t?I.AxisInfoChangeType.setRowHeight:I.AxisInfoChangeType.setColumnWidth,this.zgc({type:i,index:o,value:n,sheetArea:e})},_t.prototype.setStarSize=function(t,e,o,n){var r;F(e)&&(e=3),r=0<this.WTa?[[t?p:g,e],j]:j,this.YTa(t,e).setStarSize(o,n,r),r&&!F(r[1])&&this.zTa.push(r)},_t.prototype.VTa=function(t,e){return this.YTa(t,e).VTa()},_t.prototype.Hp=function(t,e){return this.YTa(t,e).Hp()},_t.prototype.Jp=function(t,e,o){return this.YTa(t,e).Jp(o)},_t.prototype.setItem=function(t,e,o,n){var r,i;F(e)&&(e=3),r=0<this.WTa?[[t?p:g,e],j]:j,this.YTa(t,e).Kp(o,n,r),n&&(F(n.size)||(i=t?I.AxisInfoChangeType.setRowHeight:I.AxisInfoChangeType.setColumnWidth,this.zgc({type:i,index:o,value:n.size,sheetArea:e})),F(n.visible)||(i=t?I.AxisInfoChangeType.setRowVisible:I.AxisInfoChangeType.setColumnVisible,this.zgc({type:i,index:o,sheetArea:e}))),r&&this.zTa.push(r)},U=_t,e.lUa=U,A.Zn(U)},"./dist/core/worksheet/worksheet-render.js":function(t,e,bt){"use strict";var o,vt,J,n,D,Ct,j,wt,xt,_,Z,q,Tt,At,S,r,K,Y,N,R,k,E,O,I,F,v,P,s,g,Q,L,St,i,l,h,f,p,d,m,y,b,C,w,x,a;function Mt(t){return t.height}function It(t){return t.width}function T(t,e,o,n,r,i,a){t.beginPath(),t.lineWidth=e,t.strokeStyle=o,t.moveTo(n,r),t.lineTo(i,a),t.stroke()}function H(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d,g,m,y,b,v,C,w=r.zoom(),x=o.font,T=o.textIndent,A=o.textOrientation,S=o.isVerticalText,M=o.textIndent&&0!==o.textIndent,I=0!==A&&!At(A);return x=x?K(x,w).font:n,typeof s===Q&&1!==s&&(x=K(x,s).font),h=0,h=t&&t.richText?(function(t,e,o){var n,r,i,a,s;for(n=0,r=t;n<r.length;n++)(i=r[n]).style=i.style||{},s=i.style,a=s.font?K(s.font,o).font:e,s.font=a}(v=t.richText,C=x,w),J.Vn.R_a(v,C,1)):t&&I&&!S&&!M?(l=k(A*Math.PI/180),u=E(l),c=O(l),o.wordWrap?(f=r.ss.Sl(i),J.Vn.mHb(i,a,u,c,e,x,f)):(p=Z(x),J.Vn.Xn(e,x)*c+p*u)):J.Vn.Xn(e,x),(h+=function(t,e,o,n){if(!At(o)&&!At(n)&&t.outlineColumn){var r=t.outlineColumn.LRa(o,n);if(r)return r}return e?8*e:0}(r,T,i,a)+L)+(d=o.cellPadding,g=w,b=0,"string"==typeof d&&(1===(y=(m=d.split(" ",4)).length)?b=2*P(m[0]):2===y||3===y?b=2*P(m[1]):4===y&&(b=P(m[1])+P(m[3]))),b*g)}function u(t,e,o,n,r,i,a,s,l){var u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A;if(S(r.data)&&t.parent&&t.parent.options.numbersFitMode!==j.NumbersFitMode.overflow)return Y;if(u=t.ss,c=It(r),h=It(r),p=r.style,g=r.text,m=r.printZoomFactor,y=p.watermark,b=p.wordWrap,v=p.textOrientation,x=t.options.allowCellOverflow,e.findCell(i,a))return Y;if(p.cellButtons&&0<p.cellButtons.length)return Y;if(!(p.cellType||o).allowOverflow||!g&&!y||!v&&b&&t.parent&&t.parent.options.numbersFitMode!==j.NumbersFitMode.overflow)return Y;if(g=g||y,!x&&!v)return Y;if((C=H(r.data,g,p,n,t,i,a,m))<=h)return Y;for(d=(A=T=a)+(l?1:-1);(l?d<=s:s<=d)&&!e.findCell(i,d)&&(w=u.Ym(i,d),f=u.zHb(i,d,3,1,w),w.textOrientation||At(f))&&!w.watermark&&!(w.cellType&&"1"!==w.cellType.typeName||w.cellButtons&&0<w.cellButtons.length)&&(l?A=d:T=d,!(C<=(h+=u._m(d))));d+=l?1:-1);return l&&A===a||!l&&T===a?Y:new D.op(a,T,A,C,c,h,l?-1:h,l?h:-1)}function c(t,e,o){this.kj=t,this.pJ=t.Hr(o),this.qJ=t.Ir(e,o,j.SheetArea.viewport,!0),this.yI=K(t._render.Bl(),t.zoom()).font,this.Rq=t.Al(),this.rJ={}}function B(t){var e=t.parent,o={nps:!0};return vt.Worksheet.ao(t,"needPaintSelection",o),(J.Vl.Wl(t)||e&&!e.options.hideSelection)&&o.nps}function X(t){var e=t.parent;return e&&e.options.backColor||"white"}function A(t){this.yJ=!1,this.zJ=!1,this.kj=t,this.AJ()}function M(t){this.kj=t}Object.defineProperty(e,"__esModule",{value:!0}),o=bt("@grapecity/js-sheets-common"),vt=bt("./dist/core/worksheet/worksheet.js"),J=bt("./dist/core/util/common.js"),n=bt("./dist/core/worksheet/stylehelper.js"),D=bt("./dist/core/worksheet/worksheet-model.js"),Ct=bt("./dist/core/worksheet/worksheet-border.js"),j=bt("./dist/core/core.enum.js"),wt=function(t){return t.getSparkline},xt=o.Common.k,_=J.Ul.ol,Z=J.Ul.fp,q=J.Ul.lZa,Tt=J.Ul.lHb,At=o.Common.j.Fa,S=J.Ul.Fxb,r=n.Ho,K=n.To.No,Y=null,N=Math.min,R=Math.max,k=Math.abs,E=Math.sin,O=Math.cos,I=Math.tan,F=Math.floor,v=Math.round,P=parseInt,s="transparent",g="columnHeader",Q="number",L=2,c.prototype.nJ=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k=this,E=k.rJ[t];if(E)return E;if(r=(n=k.kj).ss,a=(i=k.pJ).length,b=new D.np,e=e||J.Vn.bm(),0<a){for(b.headingOverflowlayouts=k.sJ(t,e),C=i[0].col,w=i[a-1].col,x=0;x<a;x++)It(c=i[x])<=0||(h=c.col,f=r.Ym(t,h),p=r.zHb(t,h,3,1),s=f.textOrientation,l=f.isVerticalText,u=f.textIndent&&0!==f.textIndent,T=f&&(f.borderLeft||f.borderTop||f.borderRight||f.borderBottom),At(p)&&!f.watermark||f.shrinkToFit||!s&&f.wordWrap&&n.parent&&n.parent.options.numbersFitMode===j.NumbersFitMode.mask||l||(A=n.conditionalFormats)&&(M=(S=A.oRa(n,t,h,p)).dataBar,I=S.iconSet,M&&M.showBarOnly||I&&I.showIconOnly)||(d=r._m(h),g=r.Sl(t),N=f.cellType||k.Rq,R={},y=J.mn.vn(n,f,p,R,{row:t,col:h,sheet:n}),R.content&&0<R.content.length&&!f.shrinkToFit&&s&&(y=N.sHb(e,R.content,g-4,f.font)),3===(m=f.hAlign)&&(m=_(m,p,f.formatter,s)),T&&s&&!l&&!u?s<0&&-90<s?(v=k.UIb({data:p,style:f,width:d,text:y,printZoomFactor:o},t,h,C))&&b.push(v):0<s&&s<90&&(v=k.UIb({data:p,style:f,width:d,text:y,printZoomFactor:o},t,h,w,!0))&&b.push(v):0===m?(v=k.tJ({data:p,style:f,width:d,text:y,printZoomFactor:o},t,h,w))&&b.push(v):2===m?(v=k.uJ({data:p,style:f,width:d,text:y,printZoomFactor:o},t,h,C))&&b.push(v):1===m&&(v=k.vJ({data:p,style:f,width:d,text:y,printZoomFactor:o},t,h,C,w))&&b.push(v)));b.trailingOverflowLayouts=k.wJ(t,e)}return k.rJ[t]=b},c.prototype.tJ=function(t,e,o,n){return u(this.kj,this.qJ,this.Rq,this.yI,t,e,o,n,!0)},c.prototype.uJ=function(t,e,o,n){return u(this.kj,this.qJ,this.Rq,this.yI,t,e,o,n)},c.prototype.UIb=function(t,e,o,n,r){var i,a,s,l,u,c=this.kj,h=this.qJ,f=this.Rq,p=this.yI,d=c.ss,g=It(t),m=It(t),y=t.style,b=t.text,v=t.printZoomFactor,C=y.watermark,w=y.wordWrap,x=y.textOrientation,T=y&&(y.borderLeft||y.borderTop||y.borderRight||y.borderBottom),A=y.isVerticalText,S=y.textIndent&&0!==y.textIndent,M=c.options.allowCellOverflow;if(h.findCell(e,o))return Y;if(y.cellButtons&&0<y.cellButtons.length)return Y;if(!(y.cellType||f).allowOverflow||!b&&!C||!x&&w)return Y;if(b=b||C,!M&&!x)return Y;if((a=!T||A||S?H(t.data,b,y,p,c,e,o,v):function(t,e,o){if(t&&-90<=t&&t<=90)return F(o/I(k(t*Math.PI/180)))+e+4}(x,d._m(o),d.Sl(e)))<=m)return Y;for(i=(u=l=o)+(r?1:-1);!(!(r?i<=n:n<=i)||h.findCell(e,i)||(s=d.Ym(e,i)).watermark||s.cellType&&"1"!==s.cellType.typeName||s.cellButtons&&0<s.cellButtons.length||(r?u=i:l=i,a<=(m+=d._m(i))));i+=r?1:-1);return r&&u===o||!r&&l===o?Y:new D.op(o,l,u,a,g,m,r?-1:m,r?m:-1)},c.prototype.vJ=function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A;if(S(t.data)&&this.kj.parent&&this.kj.parent.options.numbersFitMode!==j.NumbersFitMode.overflow)return Y;if(a=(i=this.kj).ss,s=this.qJ,l=It(t),u=It(t),h=t.style,p=t.text,d=t.printZoomFactor,g=h.textOrientation,m=h.watermark,y=h.wordWrap,C=i.options.allowCellOverflow,s.findCell(e,o))return Y;if(h.cellButtons&&0<h.cellButtons.length)return Y;if(!(h.cellType||this.Rq).allowOverflow||!p&&!m||!g&&y&&i.parent&&i.parent.options.numbersFitMode!==j.NumbersFitMode.overflow)return Y;if(p=p||m,!C&&!g)return Y;if((b=H(t.data,p,h,this.yI,i,e,o,d))<=u)return Y;for(x=u/2,f=(w=o)-1;n<=f&&!s.findCell(e,f)&&(v=a.Ym(e,f),c=a.zHb(e,f,3,1,v),v.textOrientation||At(c))&&!v.watermark&&!(v.cellType&&"1"!==v.cellType.typeName||v.cellButtons&&0<v.cellButtons.length)&&(w=f,!(b/2<=(x+=a._m(f))));f--);for(A=u/2,f=(T=o)+1;f<=r&&!s.findCell(e,f)&&(v=a.Ym(e,f),c=a.zHb(e,f,3,1,v),v.textOrientation||At(c))&&!v.watermark&&!(v.cellType&&"1"!==v.cellType.typeName||v.cellButtons&&0<v.cellButtons.length)&&(T=f,!(b/2<=(A+=a._m(f))));f++);return w===T?Y:new D.op(o,w,T,b,l,x+A,x,A)},c.prototype.sJ=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d=this.kj,g=d.ss,m=this.pJ,y=m[0].col,b=m[m.length-1].col,v=d._modelManager,C=[];for(p=1;p<100;p++){if((s=y-p)<0)return C;if(v.findSpan(t,s)||d.mJb&&d.mJb.oJb(t,s,j.SheetArea.viewport))return C;n=g.zHb(t,s,3,1),0<(r=g._m(s))&&!At(n)&&(3===(a=(o=g.Ym(t,s)).hAlign)&&(a=_(a,n,void 0,o.textOrientation)),i=g.Sl(t),h=o.cellType||this.Rq,f={},u=J.mn.vn(d,o,n,f,{row:t,col:s,sheet:d}),f.content&&0<f.content.length&&!o.shrinkToFit&&o.textOrientation&&(u=h.sHb(e,f.content,i-4,o.font)),c={data:n,style:o,width:r,text:u},0<o.textOrientation&&o.textOrientation<90?l=this.UIb(c,t,s,b,!0):0===a?l=this.tJ(c,t,s,b):1===a&&(l=this.vJ(c,t,s,y,b)),l&&l.endColumn>=y&&C.push(l))}return C},c.prototype.wJ=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d=this.kj,g=d.ss,m=this.pJ,y=m[0].col,b=m[m.length-1].col,v=d._modelManager,C=d.getColumnCount(),w=[];for(p=1;p<100;p++){if(C<=(u=b+p))return w;if(v.findSpan(t,u)||d.mJb&&d.mJb.oJb(t,u,j.SheetArea.viewport))return w;n=g.zHb(t,u,3,1),0<(r=g._m(u))&&!At(n)&&(3===(a=(o=g.Ym(t,u)).hAlign)&&(a=_(a,n,void 0,o.textOrientation)),i=g.Sl(t),s=o.cellType||this.Rq,l={},h=J.mn.vn(d,o,n,l,{row:t,col:u,sheet:d}),l.content&&0<l.content.length&&!o.shrinkToFit&&o.textOrientation&&(h=s.sHb(e,l.content,i-4,o.font)),f={data:n,style:o,width:r,text:h},o.textOrientation<0&&-90<o.textOrientation?c=this.UIb(f,t,u,y,!1):2===a?c=this.uJ(f,t,u,y):1===a&&(c=this.vJ(f,t,u,y,b)),c&&c.startColumn<=b&&w.push(c))}return w},St=c,e.xJ=St,e.needPaintSelection=B,M.prototype.bm=function(){var t=this.kj,e=Y,o=t.Ws();return o&&o.getContext&&(e=o.getContext("2d")),e},M.prototype.vI=function(){var t,e=this.kj,o=e.Dr(),n=e.Xs,r=It(n),i=Mt(n),a=this.wI;return a&&It(a)===r&&Mt(a)===i||(a&&J.En.Qn(e,a),this.wI=a=J.Ul.Nl("canvas"),a.getContext&&(this.xI=a.getContext("2d"),J.En.Kn(a,Y,e),J.En.Pn(a,It(o),Mt(o)))),(t=this.xI)&&(t.beginPath(),q(t,this.Cl(this.Bl())),t.name="bufferContext"),t},M.prototype.Bl=function(){return this.yI||(this.yI=r+" "+this.kj.currentTheme().bodyFont()),this.yI},M.prototype.us=function(){this.yI=Y},M.prototype.zI=function(t){var e=this.kj,o=e.parent,n=o?o.options.grayAreaBackColor||J.Im.Mm("gc-grayArea").backgroundColor:"gray",r=J.Rm.Om(e,n);return t&&(o?o.options.backgroundImage:Y)&&(r=s),r},M.prototype.Cl=function(t){var e=this.kj.zoom();return 1===e?t:K(t,e).font},M.prototype.Mx=function(t,e,o,n,r){var i,a,s,l,u,c=this.wI,h=this.bm();o<=0||n<=0||!c||!h||(r=r||this.kj.Dr(),i=J.En.Ln(c),a=J.En.Mn(c),1!==i&&(t*=i,e*=a,o*=i,n*=a,r=new J.Rect(r.x*i,r.y*a,It(r)*i,Mt(r)*a)),(s=r.getIntersect(t,e,o,n))&&(s.round(),t=s.x,e=s.y,o=It(s),n=Mt(s),(l=It(c))&&l<t+o&&(t=l-o)<0&&(o+=t,t=0),(u=Mt(c))&&u<e+n&&(e=u-n)<0&&(n+=e,e=0),J.Bn.Cn(h,1,1),h.clearRect(t,e,o,n),h.drawImage(c,t,e,o,n,t,e,o,n),J.Bn.Cn(h,i,a)))},M.prototype.dm=function(t,e){t&&this.Mx(t.x,t.y,It(t),Mt(t),e)},M.prototype.Ow=function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y,b;if(0<o&&0<n)try{a=this.kj,s=this.bm(),l=a.Ws(),u=this.vI(),c=this.wI,h=r,f=i,p=o,d=n,g=J.En.Ln(l),m=J.En.Mn(l),t=v(t*g),e=v(e*m),o=v(o*g),n=v(n*m),h=v(h*g),f=v(f*m),p=v(p*g),d=v(d*m),y=It(c),b=Mt(c),y&&y<t+o&&(t=y-o)<0&&(o+=t,t=0),b&&b<e+n&&(e=b-n)<0&&(n+=e,e=0),y&&y<h+p&&(h=y-p)<0&&(p+=h,h=0),b&&b<f+d&&(f=b-d)<0&&(d+=f,f=0),J.Bn.Cn(s,1,1),J.Bn.Cn(u,1,1),s.clearRect(h,f,p,d),s.drawImage(c,t,e,o,n,h,f,p,d),u.clearRect(h,f,p,d),u.drawImage(l,h,f,p,d,h,f,p,d),J.Bn.Cn(s,g,m),J.Bn.Cn(u,g,m)}catch(t){}},M.prototype.im=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I;if(o=o||this.bm(),r=!1,i=this.kj,a=J.kf(-1,-1,-1,-1),s=i.Hx,l=i._modelManager,t&&(a=i.options.allowCellOverflow?J.kf(t.row,0,t.rowCount,i.getColumnCount()):J.kf(t.row,t.col,t.rowCount,t.colCount),!s)){if(0<=a.col){for(c=a.col,h=a.col+a.colCount-1,f=i.getRowCount(1),p=0;p<f;p++)(u=l.findSpan(p,a.col,1))?c=N(u.col,c):i.p_a&&(c=N(i.p_a.col,c)),(u=l.findSpan(p,a.col+a.colCount-1,1))?h=R(u.col+u.colCount-1,h):i.p_a&&(h=R(i.p_a.col+i.p_a.colCount-1,h));a.col=c,a.colCount=h-c+1}if(0<=a.row){for(d=a.row,g=a.row+a.rowCount-1,m=i.getColumnCount(2),y=0;y<m;y++)(u=l.findSpan(a.row,y,2))?d=N(u.row,d):i.p_a&&(d=N(i.p_a.row,d)),(u=l.findSpan(a.row+a.rowCount-1,y,2))?g=R(u.row+u.rowCount-1,g):i.p_a&&(g=R(i.p_a.row+i.p_a.rowCount-1,g));a.row=d,a.rowCount=g-d+1}}if(b=i.cm(a),i.cellStates&&i.cellStates.hasIntersectInSeletionState(a.row,a.col,a.rowCount,a.colCount)&&i.repaint(b),C=(v=i.QLc)&&v.isEnable(j.StatesType.selected,!0),w=v&&v.isEnable(j.StatesType.selected,!1),t&&(C&&(b=i.cm(J.kf(t.row,-1,t.rowCount,-1))),w&&(x=i.cm(J.kf(-1,t.col,-1,t.colCount)),b.x=N(b.x,x.x),b.y=N(b.y,x.y),b.width=R(b.width,x.width),b.height=R(b.height,x.height))),T=It(b),A=Mt(b),S=b.x,M=b.y,0<=T||0<=A){if(b.x+=-9,b.y+=-9,b.width+=18,b.height+=30,e&&!(b=b.getIntersectRect(e)))return;I=i.am(),0<A&&!s&&(i.$l=!0,this.jp(o,new J.Rect(I.x,R(I.nt,M),I.Br,A),n)),0<T&&!s&&(i.$l=!0,this.jp(o,new J.Rect(R(I.kt,S),I.y,T,I.Cr),n)),-1!==a.row||-1!==a.col||s||(i.$l=!0,this.jp(o,I.em(),n)),0<T&&0<A&&((C||w)&&(i.$l=!0),this.jp(o,b,n)),r=!0}return r},M.prototype.VF=function(t,e,o,n,r){var i,a=this.kj;a.Xq<=0&&(i=this.bm())&&(r||(a.$l=!0),this.jp(i,new J.Rect(t,e,o,n)))},M.prototype.repaint=function(t){var e,o=this.kj;0<o.Xq||(e=this.bm())&&(o.$l=!0,this.jp(e,t))},M.prototype.jp=function(t,e,o){t&&this.kj.Xq<=0&&(o||this._l(t,e),this.Pw(t,e))},M.prototype._l=function(t,e,o){var n,r,i,a=this.kj;t&&a.Xq<=0&&(r=(n=this.vI())||t,i=a.Dr(),(e=e||i)&&e.round(),o&&o.round(),a.$l&&(a.$l=!1,n&&(n.clearRect(e.x,e.y,It(e),Mt(e)),o&&n.clearRect(o.x,o.y,It(o),Mt(o)),J.Bn.Dn(n,-i.x,-i.y)),this.AI(r,e),o&&this.AI(r,o),n&&J.Bn.Dn(n,i.x,i.y)),n&&(this.dm(e),o&&this.dm(o)))},M.prototype.Pw=function(t,e){var o,n,r,i,a,s=this.kj,l=s.CH;if(t&&!(0<s.Xq)&&(e&&e.round(),o=s.am(),vt.Worksheet.ao(s,"beforePaintAdornment",{ctx:t,clipRect:e}),!s.fI)){if(l){for(n=o.em(),this.dm(n),i=0;i<=2;i++)(n=o.fm(i))&&0!==It(n)&&0!==Mt(n)&&this.dm(n);for(a=0;a<=2;a++)(n=o.gm(a))&&0!==It(n)&&0!==Mt(n)&&this.dm(n)}for(i=0;i<=2;i++)for(a=0;a<=2;a++)(n=o.Ft(i,a))&&0!==It(n)&&0!==Mt(n)&&(r=e,(l&&(1!==i||1!==a)||s.parent&&s.parent.options.allowUserDragMerge)&&(this.dm(n),r=n),r&&!n.intersectRect(r)||this.BI(t,i,a,r));this.CI(t),vt.Worksheet.ao(s,"paintAdornment",{ctx:t,clipRect:e})}},M.prototype.dD=function(t,e){var o=this.kj,n=o.parent,r=n?n.options:{},i=X(o),a=J.Rm.Om(o,i);r.backgroundImage&&(a=s),t.save(),t.fillStyle=a,t.fillRect(e.x,e.y,It(e),Mt(e)),t.restore()},M.prototype.z0a=function(t){var e=this.kj;return 0===e.am().Cr&&t===e.ar(3)},M.prototype.A0a=function(t){var e=this.kj;return 0===e.am().Br&&t===e.$q(3)},M.prototype.DI=function(t,e,o,n){var r,i,a,s,l,u,c,h=this.kj,f=h.options,p=h.am(),d=f.sheetAreaOffset.top,g=f.sheetAreaOffset.left,m=0!==p.Cr,y=0!==p.Br,b=h.Gt&&h.Gt()||{x:f.sheetAreaOffset.left,y:f.sheetAreaOffset.top,width:0,height:0},v=0===b.width,C=0===b.height;for(i=0;i<=2;i++)(s=p.gm(i))&&(m&&C&&(s.y=s.y-d,s.height=s.height+d,!y&&v&&(s.x=s.x-g,s.width=s.width+g)),(a=e?s.getIntersectRect(e):s)&&this.EI(t,i,a,o,n));for(r=0;r<=2;r++)for((l=p.fm(r))&&(y&&v&&(l.x=l.x-g,l.width=l.width+g,!m&&C&&(l.y=l.y-d,l.height=l.height+d)),(a=e?l.getIntersectRect(e):l)&&this.FI(t,r,a,o,n)),i=0;i<=2;i++)u=p.Ft(r,i),this.z0a(h.jCb(r))&&C&&(u.y=u.y-d,u.height=u.height+d),this.A0a(h.kCb(i))&&v&&(u.x=u.x-g,u.width=u.width+g),u&&(a=e?u.getIntersectRect(e):u)&&this.GI(t,r,i,a,o,n);!(c=p.em())||(a=e?c.getIntersectRect(e):c)&&this.HI(t,a,o,n)},M.prototype.II=function(t){var e=this.kj,o=e.am(),n=o.zr,r=o.Ar,i=It(o),a=o.ot,s=o.gs,l=o.$Lc,u=o.sKc,c=o._Lc,h=o.pKc;0<h&&(t.fillStyle=this.zI(!1),t.fillRect(n,c,i,h)),0<u&&(t.fillStyle=this.zI(!1),t.fillRect(l,r,u,c),e.qKc&&t.fillRect(l,a,u,s))},M.prototype.B0a=function(t,e){var o=this.kj,n=this.zI(!1),r=o.options,i=r.sheetAreaOffset.left,a=r.sheetAreaOffset.top,s=e.x,l=e.y,u=It(e),c=Mt(e);t.save(),0<i&&T(t,i,n,s+i/2,0<a?l+a:l,s+i/2,l+R(0,c)),0<a&&T(t,a,n,0<i?s+i:s,l+a/2,s+R(0,u),l+a/2),0<i&&0<a&&(t.fillStyle=this.zI(!1),t.fillRect(s,l,i,a)),t.beginPath(),t.restore()},M.prototype.AI=function(t,e){var o,n=this.kj;!t||0<n.Xq||(o=n.Dr(),t.save(),e?t.rect(e.x,e.y,It(e),Mt(e)):t.rect(o.x,o.y,It(o),Mt(o)),t.clip(),t.beginPath(),this.dD(t,o),vt.Worksheet.ao(n,"paint",{ctx:t,clipRect:e}),this.B0a(t,o),this.DI(t,e,!1),this.II(t),this.KI(t),vt.Worksheet.ao(n,"paintSheetEnd",{ctx:t,clipRect:e}),t.beginPath(),t.restore())},M.prototype.LI=function(t,e,o){var n,r,i=this.kj;t&&(n=i.Dr(),t.save(),r=e||new J.Rect(n.x,n.y,It(n),Mt(n)),t.rect(r.x,r.y,It(r),Mt(r)),t.clip(),t.beginPath(),this.dD(t,n),this.DI(t,r,!0,o),t.beginPath(),t.restore())},M.prototype.CI=function(t){var e,o,n,r,i,a,s,l,u=this.kj,c=u._eventHandler,h=u.yt;if(c&&c.isResizing&&h&&(s=h.resizeInfo)){if(l=u.am(),t.save(),"black"!==t.strokeStyle&&(t.strokeStyle="black"),1!==t.lineWidth&&(t.lineWidth=1),t.beginPath(),"sizeRow"===s.action||"sizeHiddenRow"===s.action)for(o=R(0,s.startY-.5),r=s.movingY-.5,i=l.x+It(l),e=l.x;e<i;e+=2)t.moveTo(e,o),t.lineTo(e+1,o),t.moveTo(e,r),t.lineTo(e+1,r);else for(e=R(0,s.startX-.5),n=s.movingX-.5,a=l.y+Mt(l),o=l.y;o<a;o+=2)t.moveTo(e,o),t.lineTo(e,o+1),t.moveTo(n,o),t.lineTo(n,o+1);t.stroke(),t.beginPath(),t.restore()}},M.prototype.HI=function(t,e,o,n){var r,i,a,s,l,u,c,h=this.kj;t.beginPath(),i=(r=h.am().em()).x,a=r.y,s=It(r),l=Mt(r),u=h.getActualStyle(-1,-1,0),this.SI(t,[{data:Y,row:-1,col:-1,x:i,y:a,width:s,height:l,style:u.clone()}],0,o,n),(c=new Ct.AF(h,h.Gr(0,0),h.Hr(0,0),0)).jF(0,0,i,a,s,l),c.paint(t)},M.prototype.KI=function(t){var e,o,n,r,i,a,s,l,u,c=this.kj,h=c.frozenRowCount(),f=c.frozenColumnCount(),p=c.frozenTrailingRowCount(),d=c.frozenTrailingColumnCount();(h||f||p||d)&&(o=(e=c.am()).pt,n=e.qt,r=e.lt,i=e.ot,a=e.x,s=e.y,l=It(e),u=Mt(e),t.save(),t.strokeStyle=J.Rm.Om(c,c.options.frozenlineColor),t.lineWidth=1,t.beginPath(),f&&(t.moveTo(o-.5,s),t.lineTo(o-.5,s+u)),h&&(t.moveTo(a,n-.5),t.lineTo(a+l,n-.5)),d&&(t.moveTo(r-.5,s),t.lineTo(r-.5,s+u)),p&&(t.moveTo(a,i-.5),t.lineTo(a+l,i-.5)),t.stroke(),t.restore())},M.prototype.EI=function(t,e,o,n,r){this.TI(t,-1,e,1,o,n,r)},M.prototype.FI=function(t,e,o,n,r){this.TI(t,e,-1,2,o,n,r)},M.prototype.GI=function(t,e,o,n,r,i){var a,s,l,u=this.kj.et;!u||(a=u.getCalcService())&&a.calcOnDemand&&(s=u._source).clearValueCache&&s.clearValueCache(),this.TI(t,e,o,3,n,r,i),(l=this.kj.at)&&l.UI(t,n,e,o)},M.prototype.VIb=function(t,e,o,n,r){var i,a,s,l=this.kj,u=l.getRangeRect(e,o,J.kf(r.row,r.col,r.rowCount,r.colCount));(u=u.getIntersectRect(l.am().Ft(e,o)))&&(u.round(),i=r.isValid,t.save(),t.lineWidth=1,t.strokeStyle="mediumblue",i||t.setLineDash([6,2]),a=u.x+.5,s=u.y+.5,t.strokeRect(a,s,It(u),Mt(u)),t.beginPath(),t.restore())},M.prototype.BI=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E=this.kj;if(B(E)){if(!E.addSelection)return;if(s=E._modelManager,l=E._eventHandler,c=(u=s.getSelections()).length,!(n=this.VI(e,o,n)))return;if(h=J.Im.Lm("gc-selection"),2007<(f=P(h.zIndex))&&this.WI(t,e,o,n),(p=s.WIb=s.ZHb.getAnchorInfo(E.getActiveRowIndex(),E.getActiveColumnIndex()))&&this.VIb(t,e,o,n,p),m=void 0,(g=(d=this.XI(e,o,u,n)).length)<=0)return;for(y=this.XI(e,o,[E.p_a],n)[0],b=!1,v=void 0,v=0;v<g;v++)if(m=d[v],!n.containsRect(m)){b=!0;break}if(y&&!n.containsRect(y)&&(b=!0),t.save(),b&&(t.rect(n.x,n.y,It(n),Mt(n)),t.clip()),t.beginPath(),0<g)for(a=J.Rm.Om(E,E.getSelectionBackColor()),t.fillStyle!==a&&(t.fillStyle=a),i=r=0,2007<f&&(r=1,i=-3),v=0;v<g;v++)m=d[v],t.fillRect(m.x+r,m.y+r,It(m)+i,Mt(m)+i);E.sgc||(C=E.Jl,w=E.Kl,y&&(C=E.s_a,w=E.t_a),M=S=A=T=void 0,(x=E.getCellRect(C,w,e,o))&&x.intersectRect(n)&&(T=x.x,A=x.y,S=It(x),M=Mt(x),r=1,i=-2,2007<f&&(i=r=0),this.Mx(T+r,A+r,S+i,M+i),1<c&&(t.strokeStyle="black",t.lineWidth=1,t.strokeRect(T+1.5,A+1.5,S-4,M-4)))),t.restore(),t.save(),t.beginPath(),1===c&&(l&&l.BG&&l.ZI&&l.ZI()&&!l.$I&&(I=l._I&&l._I(),R=It(N=E.getRangeRect(e,o,I)),k=Mt(N),N&&0<R&&0<k&&(t.fillStyle=h&&h.color,t.fillRect(N.x,N.y,R,k))),m&&0<=It(m)&&0<=Mt(m)&&(this.YI(n,E,e,o,f),this.aJ(t,e,o,m,n,u[0]))),y&&(t.save(),b&&(t.rect(n.x,n.y,It(n),Mt(n)),t.clip()),t.beginPath(),t.fillStyle="rgba(255,255,255,0.4)",t.fillRect(y.x+r,y.y+r,It(y)+i,Mt(y)+i),t.fillStyle=a,t.strokeStyle="rgb(124,124,124)",t.lineWidth=1,t.strokeRect(y.x-.5,y.y-.5,It(y),Mt(y)),t.restore()),t.beginPath(),t.restore()}},M.prototype.YI=function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m=e.frozenTrailingRowCount(),y=e.frozenTrailingColumnCount(),b=e.getSelections(),v=e.am(),C=e.getRowCount()-m-1,w=e.getColumnCount()-y-1,x=e.Hr(1,3),T=e.Gr(1,3);1===b.length&&2007<r&&(i=e.frozenRowCount(),a=e.frozenColumnCount(),l=(s=b[0]).row,u=s.col,c=s.rowCount,h=s.colCount,0<i&&(i<=l&&e.gr(l)<i?(t.y-=2,t.height+=2):l+c<=i&&e._q(l+c-1)===e.lq&&(t.height+=2)),0<a&&(a<=u&&e.br(u)<a?(t.x-=2,t.width+=2):u+h<=a&&e.Zq(u+h-1)===e.qq&&(t.width+=2)),0===l&&0===u&&(t.x-=2,t.y-=2,t.width+=2,t.height+=2),-1===l&&(l=0,c=e.getRowCount()),-1===u&&(u=0,h=e.getColumnCount()),p=f=!1,d=T.findRow(C),g=x.findCol(w),d&&d.y+Mt(d)<v.qt+e.oKc(v)&&(f=!0),g&&g.x+It(g)<v.pt+e.rKc(v)&&(p=!0),f&&l+c-1==C&&(t.height+=2),p&&u+h-1==w&&(t.width+=2))},M.prototype.WI=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E=this.kj,D=E._modelManager.getSelections(),j=E.am(),_=j.kt,O=j.nt,F=D.length,P=0!==j.Cr,L=0!==j.Br;if(!(F<=0)){if(i=(r=D[0]).row,a=r.rowCount,s=r.col,l=r.colCount,-1===i&&(i=0),-1===s&&(s=0),-1===a&&(a=E.getRowCount()),-1===l&&(l=E.getColumnCount()),t.save(),t.beginPath(),t.lineWidth=2,t.strokeStyle=E.getSelectionBorderColor(),u=n.x,c=n.y,h=It(n),f=Mt(n),p=E.frozenRowCount(),P&&(1!==F||0!==p||E.lq<=i||E.lq>=i+a))for(g=0,m=(d=this.bJ(o)).length;g<m;g++)v=b=0,C=(y=d[g]).x,w=y.x+It(y),y.x<u+h&&u<y.x+It(y)&&(1===F&&(0===p&&E.lq===i||0<p&&0===i)&&(b=-1,v=1),y.x<u&&(b=0,C=u),y.x+It(y)>u+h&&(v=0,w=u+h),t.moveTo(C+b-1,O-1),t.lineTo(w+v,O-1),t.stroke());if(x=E.frozenColumnCount(),L&&(1!==F||0!==x||E.qq<=s||E.qq>=s+l))for(A=0,S=(T=this.cJ(e)).length;A<S;A++)N=I=0,R=(M=T[A]).y,k=M.y+Mt(M),M.y<c+f&&c<M.y+Mt(M)&&(1===F&&(0===x&&E.qq===s||0<x&&0===s)&&(I=-1,N=1),M.y<c&&(I=0,R=c),M.y+Mt(M)>c+f&&(N=0,k=c+f),t.moveTo(_-1,R+I-1),t.lineTo(_-1,k+N),t.stroke());t.beginPath(),t.restore()}},M.prototype.bJ=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p=this.kj,d=p._modelManager.getSelections(),g=d.length,m=p.Hr(t),y=[],b={};for(o=0;o<g;o++)if(n=d[o])if(-1===(r=n.col))i=p.Hr(0,3),a=p.Hr(1,3),s=p.Hr(2,3),u=l=-1,0<i.length&&(l=i[0].x,u=i[i.length-1].x+i[i.length-1].width-l,y.push(new J.Rect(l,-1,u,-1))),0<a.length&&(l=a[0].x,u=a[a.length-1].x+a[a.length-1].width-l,y.push(new J.Rect(l,-1,u,-1))),0<s.length&&(l=s[0].x,u=s[s.length-1].x+s[s.length-1].width-l,y.push(new J.Rect(l,-1,u,-1)));else if(m&&(c=m.findCol(r),h=m.findCol(r+n.colCount-1),c||h)){if((f=new J.Rect(-1,-1,-1,-1)).x=c?c.x:m[0].x,f.width=h?h.x+It(h)-f.x:m[m.length-1].x+m[m.length-1].width-f.x,b[e=[f.x,f.width].join("_")])continue;b[e]=!0,y.push(f)}return y},M.prototype.cJ=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p=this.kj,d=p._modelManager.getSelections(),g=d.length,m=p.Gr(t),y=[],b={};for(o=0;o<g;o++)if(n=d[o])if(-1===(r=n.row))i=p.Gr(0,3),a=p.Gr(1,3),s=p.Gr(2,3),u=l=-1,0<i.length&&(l=i[0].y,u=i[i.length-1].y+i[i.length-1].height-l,y.push(new J.Rect(-1,l,-1,u))),0<a.length&&(l=a[0].y,u=a[a.length-1].y+a[a.length-1].height-l,y.push(new J.Rect(-1,l,-1,u))),0<s.length&&(l=s[0].y,u=s[s.length-1].y+s[s.length-1].height-l,y.push(new J.Rect(-1,l,-1,u)));else if(m&&(c=m.findRow(r),h=m.findRow(r+n.rowCount-1),c||h)){if((f=new J.Rect(-1,-1,-1,-1)).y=c?c.y:m[0].y,f.height=h?h.y+Mt(h)-f.y:m[m.length-1].y+m[m.length-1].height-f.y,b[e=[f.y,f.height].join("_")])continue;b[e]=!0,y.push(f)}return y},M.prototype.aJ=function(t,e,o,n,r,i){var a,s=this.kj,l=s.parent,u=s._eventHandler,c=n.x,h=n.y,f=It(n),p=Mt(n),d=s.getViewportTopRow(e),g=s.getViewportLeftColumn(o),m=s.getViewportBottomRow(e),y=s.getViewportRightColumn(o),b=0,v=0,C=s.am(),w=0!==C.Cr;0!==C.Br||i.col!==g&&-1!==i.col||(b=2),w||i.row!==d&&-1!==i.row||(v=2),i.row+i.rowCount===m+1&&(r.height=r.height+1),i.col+i.colCount===y+1&&(r.width=r.width+1),0<=f&&0<=p&&(!r||n.intersect(r.x-1,r.y-1,It(r)+2,Mt(r)+2))&&(t.save(),r&&!r.containsRect(n)&&(t.rect(r.x-b,r.y-v,It(r),Mt(r)),t.clip()),t.beginPath(),t.strokeStyle=J.Rm.Om(s,s.getSelectionBorderColor()),t.lineWidth=2,0<f&&0<p?(u&&u.BG?2===(a=u.dJ)?(t.moveTo(c+.5,h-.5),t.lineTo(c+f-1,h-.5)):3===a?(t.moveTo(c+.5,h+p-.5),t.lineTo(c+f-1,h+p-.5)):0===a?(t.moveTo(c-.5,h+.5),t.lineTo(c-.5,h+p-1)):1===a&&(t.moveTo(c+f-.5,h+.5),t.lineTo(c+f-.5,h+p-1)):2007<(l&&l.Vv)?t.rect(c-1,h-1,f+1,p+1):t.rect(c-.5,h-.5,f,p),t.stroke(),l&&l.options.allowUserDragFill&&this.eJ&&this.eJ(t,e,o,n,r)):0!==f&&0!==p||t.strokeRect(c-1,h-1,f+1,p+1),t.beginPath(),t.restore())},M.prototype.VI=function(t,e,o){var n,r,i,a,s=this.kj,l=s.am(),u=l.Ft(t,e);return 1===e&&(r=0<(n=s.Hr(e)).length?n[n.length-1]:Y)&&(u.width=N(It(u),r.x+It(r)-l.pt)),1===t&&(a=0<(i=s.Gr(t)).length?i[i.length-1]:Y)&&(u.height=N(Mt(u),a.y+Mt(a)-l.qt)),o?o.getIntersect(u.x,u.y,It(u),Mt(u)):u},M.prototype.XI=function(t,e,o,n){var r,i,a,s,l=this.kj,u=l._modelManager,c=o.length,h=[];for(s=0;s<c;s++)(i=o[s])&&((r=u.findSpan(i.row,i.col))&&r.containsRange(i)&&(i=r),(a=l.getRangeRect(t,e,i))&&a.x<=n.x+It(n)&&a.y<=n.y+Mt(n)&&n.x<=a.x+It(a)&&n.y<=a.y+Mt(a)&&h.push(a));return h},M.prototype.fJ=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p;if(t.save(),n=e.x,r=e.y,i=It(e),a=Mt(e),s=[6,6],t.setLineDash)t.beginPath(),t.lineWidth=2,t.strokeStyle=o,t.setLineDash(s),t.rect(n,r,i-1,a-1),t.stroke();else{for(t.beginPath(),t.lineWidth=2,t.strokeStyle=o,l=s[0],u=s[1],p=f=h=c=void 0,c=n,h=r,f=i;0<f;)if(l+u<=f)t.moveTo(c,h),t.lineTo(c+l,h),c=c+l+u,f=f-l-u;else{if(l<=f){t.moveTo(c,h),t.lineTo(c+l,h),f=f-l-u;break}if(0<f){t.moveTo(c,h),t.lineTo(c+f,h),f=f-l-u;break}}for(c=n+i-1,h=r+1,p=a-1,f<0&&(u<(f=k(f))&&(t.moveTo(c,h-2),t.lineTo(c,h+(f-u))),h+=f,p-=f);0<p;)l+u<=p?(t.moveTo(c,h),t.lineTo(c,h+l),h=h+l+u,p=p-l-u):l<=p?(t.moveTo(c,h),t.lineTo(c,h+l),p=p-l-u):0<p&&(t.moveTo(c,h),t.lineTo(c,h+p),p=p-l-u);for(c=n+i-2,h=r+a-1,f=i-1,p<0&&(u<(p=k(p))&&(t.moveTo(c+2,h),t.lineTo(c-(p-u),h)),c-=p,f-=p);0<f;)if(l+u<=f)t.moveTo(c,h),t.lineTo(c-l,h),c=c-l-u,f=f-l-u;else{if(l<=f){t.moveTo(c,h),t.lineTo(c-l,h),f=f-l-u;break}if(0<f){t.moveTo(c,h),t.lineTo(c-f,h),f=f-l-u;break}}for(c=n,h=r+a-2,p=a-1,f<0&&(u<(f=k(f))&&(t.moveTo(c,h+2),t.lineTo(c,h-(f-u))),h-=f,p-=f);0<p;)l+u<=p?(t.moveTo(c,h),t.lineTo(c,h-l),h=h-l-u,p=p-l-u):l<=p?(t.moveTo(c,h),h-l===r?t.lineTo(c,h-l-1):t.lineTo(c,h-l),p=p-l-u):0<p&&(r<h&&(t.moveTo(c,h),t.lineTo(c,h-p)),p=p-l-u);t.stroke()}t.beginPath(),t.restore()},M.prototype.XIb=function(t,e,o,n,r,i,a){var s,l,u,c,h;0!==e.length&&(s=e[0].col-1,l=e[e.length-1].col+1,u=o.zHb(n.row,s,a,1),r&&0<=s&&i.isValid&&!i.isValid(n.row,s,u)&&t.push({style:i.getDataValidator(n.row,s).highlightStyle(),x:e[0].x-i.getColumnWidth(s),y:n.y,width:i.getColumnWidth(s),height:n.height}),c=o.zHb(n.row,l,a,1),r&&i.isValid&&!i.isValid(n.row,l,c)&&(h=e[e.length-1],t.push({style:i.getDataValidator(n.row,l).highlightStyle(),x:h.x+h.width,y:n.y,width:i.getColumnWidth(l),height:n.height})))},M.prototype.YIb=function(t,e,o){var n,r,i,a,s=e.ss,l=t.row,u=t.col,c={},h={},f=[],p=t.rowCount,d=t.colCount;for(n=0;n<d;n++)h[n]=e.Tl(n+u,o);for(r=0;r<p;r++){for(c[r]=e.Sl(r+l,o),i=[],a=0;a<d;a++)i.push(s.Ym(l+r,u+a,o));f.push(i)}return{rowSizes:c,colSizes:h,styleList:f}},M.prototype.TI=function(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J,Z,q,K,Y,Q,X,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ht,ft,pt,dt,gt,mt,yt;if(At(n)&&(n=3),l=(s=this.kj).parent,u=s.am().Ft(e,o),c=l&&l.options.resizeZeroIndicator,h=s.Gr(e,n),f=s.Hr(o,n),p=s.options.sheetAreaOffset,d=s.Gt&&s.Gt()||{x:p.left,y:p.top,width:0,height:0},g=h.length,m=f.length,!(g<0||m<0)){for(b=0<(y=s.Ir(e,o,n,!0)).length,x=s.ss,N=I=M=S=0,E=new Ct.AF(s,h,f,n),D=[],j=[],_=[],O=[],F=!i&&3===n&&l&&l.options.highlightInvalidData,t.save(),t.beginPath(),P=[],H=L=-1,B=s.ar(3),V=s.$q(3),W=0===(z=s.am()).Cr&&0===d.height,G=0===z.Br&&0===d.width,U=!!wt(this.kj),J=bt("SheetsCalc"),Z=s.getActiveRowIndex(),q=s.getActiveColumnIndex(),K=this.ZIb(n,s,Z,q),Y=0;Y<g;Y++)for(v=h[Y],this.XIb(O,f,x,v,F,s,n),Q=0;Q<m;Q++)if(C=f[Q],(w=b&&y.findCell(v.row,C.col))?(T=w.row,A=w.col,S=w.x,M=w.y,I=It(w),N=Mt(w),w.isAutoMerge&&(S=(X=this.$Ib(w,e,o,n)).x,M=X.y,I=X.width,N=X.height),w.spanSizeInfo||(w.spanSizeInfo=this.YIb(w,s,n))):(T=v.row,A=C.col,S=C.x,M=v.y,I=It(C),N=Mt(v)),1===c&&(-1===e&&s.getColumnVisible(A)&&0===s.$r(A)&&((H<0||H!==A-1)&&P.push({x1:S,y1:M,x2:S,y2:M+N,horizontal:!1}),H=A),-1===o&&s.getRowVisible(T)&&0===s.Yr(T)&&((L<0||L!==T-1)&&P.push({x1:S,y1:M,x2:S+I,y2:M,horizontal:!0}),L=T)),!(r&&(S+I<=r.x||S>=r.x+It(r)||M+N<=r.y||M>=r.y+Mt(r))||0===I||0===N||($=!1,w&&xt.Bb(D,w)))){if(tt=!1,R=x.zHb(T,A,n,1),et=s.jZ&&s.jZ(),K&&0===T&&A>=K.dj&&K.cj+K.Xj>s.lq&&A<K.dj+K.OZ){if(R=s.getCell(K.cj,A).text()+"",$=!0,tt=K.filterButtonVisible(),et)for(ot=0;ot<et.length;ot++)if(et[ot].col===A&&et[ot].rowFilter.sj===K){this._Ib(et[ot],1,0,!0);break}}else if(et&&0<et.length)for(nt=et[0].rowFilter&&et[0].rowFilter.sj,ot=et.length-1;0<=ot;ot--)if(et[ot].tableColumnHeaderFilter&&et[ot].col===A){this._Ib(et[ot],3,nt.cj,!1);break}k=x.Ym(T,A,n),F&&s.isValid&&!s.isValid(T,A,R)&&O.push({style:s.getDataValidator(T,A).highlightStyle(),x:S,y:M,width:I,height:N}),3===n&&(rt=k.formatter,J&&!i&&rt&&Tt(rt)&&(it=s.parent&&s.parent.aJb(rt))&&(at=it.getExpression(),R=J.evaluateExpression(s,at,T,A))),E.jF(T,A,S,M,I,N,k,w,T===B&&W,A===V&&G,R),$&&(k.hAlign=0),j.push({data:R,row:T,col:A,x:S,y:M,width:I,sparkline:U&&s.getSparkline(T,A),height:N,style:k,cellLayout:w,tableFilter:tt}),w&&D.push(w)}if(0<j.length){if(3===n&&s.options.allowCellOverflow&&(st=x.Sm(e,o,function(){return new St(s,e,o)}),0<(_=this.hJ(t,st,j,E,a)).length)){for(lt=r.x,ut=r.x+r.width,Y=0;Y<_.length;Y++)(ct=_[Y])&&(ht=ct.row,ft=ct.col,(pt=ct.cellOverflowLayout&&ct.cellOverflowLayout.layout)&&((dt=pt.x)<lt&&(lt=dt),ut<(gt=dt+pt.width)&&(ut=gt)),E.jF(ht,ft,ct.x,ct.y,ct.width,ct.height,ct.style,ct.cellLayout,ht===B&&W,ft===V&&G,ct.data));j=j.concat(_),i||(r.x=lt,r.width=ut-lt,u&&(r=r?u.getIntersectRect(r):u))}r&&(mt=s.printInfo&&s.printInfo(),i&&mt&&(0<mt.columnStart()||0<mt.rowStart())&&!mt.showBorder()?t.rect(r.x-(0<mt.columnStart()?2:0),r.y-(0<mt.rowStart()?2:0),It(r)+(0<mt.columnStart()?4:0),Mt(r)+(0<mt.rowStart()?4:0)):t.rect(r.x,r.y,It(r),Mt(r)),t.clip()),this.SI(t,j,n,i,a)}vt.Worksheet.ao(s,"paintViewport",{ctx:t,rowViewportIndex:e,colViewportIndex:o,sheetArea:n,clipRect:r,isPrinting:i}),E.paint(t),0<P.length&&this.iJ(t,P,1,3),0<O.length&&(yt=u.getIntersectRect(r),t.rect(yt.x,yt.y,It(yt),Mt(yt)),t.clip(),this.jJ(t,O)),t.restore()}},M.prototype._Ib=function(t,e,o,n){t.sheetArea=e,t.row=o,t.tableColumnHeaderFilter=n},M.prototype.ZIb=function(t,e,o,n){if(e.tables&&1===t&&0===e.frozenRowCount()&&0===e.frozenColumnCount()){var r=e.tables.find(o,n);if(r&&r.MZ&&r.cj<e.lq)return r}return null},M.prototype.$Ib=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p=t.row,d=t.col,g=t.x,m=t.y,y=t.width,b=t.height,v=this.kj,C=v.am();return 1!==e||3!==n&&2!==n||(r=C.fm(e),i=v.frozenRowCount(),a=v.getRowCount(n)-v.frozenTrailingRowCount()-1,m<(s=r.y)&&i<=p&&p<=a&&(b-=s-m,m=s),s+(l=r.height)<m+b&&i<=p+t.rowCount-1&&p+t.rowCount-1<=a&&(b-=m+b-(s+l))),1!==o||3!==n&&1!==n||(r=C.gm(o),u=v.frozenColumnCount(),c=v.getColumnCount(n)-v.frozenTrailingColumnCount()-1,g<(h=r.x)&&u<=d&&d<=c&&(y-=h-g,g=h),h+(f=r.width)<g+y&&u<=d+t.colCount-1&&d+t.colCount-1<=c&&(y-=g+y-(h+f))),new J.Rect(g,m,y,b)},M.prototype.iJ=function(t,e,o,n){var r,i,a,s,l,u,c,h;if(0!==e.length)for(r=0,i=e.length;r<i;r++)s=(a=e[r]).x1,l=a.y1,u=a.x2,c=a.y2,h=a.horizontal,t.beginPath(),t.save(),t.lineWidth=o,t.strokeStyle=this.kJ(t,h,s,l,u,c),t.fillStyle=this.lJ(t,h,s,l,u,c),h?(t.fillRect(s,l+-3,u-s-1,n+2*o),l+=.5,c+=.5,t.moveTo(s+-1,l+-3),t.lineTo(u+-2,c+-3),t.moveTo(s+-1,l+1),t.lineTo(u+-2,c+1)):(t.fillRect(s+-3,l+0,n+2*o,c-l-1),s+=.5,u+=.5,t.moveTo(s+-3,l+0),t.lineTo(u+-3,c+-1),t.moveTo(s+1,l+0),t.lineTo(u+1,c+-1)),t.stroke(),t.restore()},M.prototype.lJ=function(t,e,o,n,r,i){var a,s,l,u,c,h=e?"rowHeader":g,f=J.Im.Km(0,"gc-"+h+"-normal"),p=f&&f.backgroundColor,d=f&&f.backgroundImage;if(!e&&d&&-1!==d.indexOf("linear-gradient"))for(s=J.Ul.wl(d),a=t.createLinearGradient(o,n,r,i),l=0,u=s.length;l<u;l++)c=s[l],a.addColorStop(c.point,c.color);else p&&(a=p);return a},M.prototype.kJ=function(t,e,o,n,r,i){var a=t.createLinearGradient(o,n,r,i),s=e?"rowHeader":g,l=J.Im.Km(0,"gc-"+s+"-normal");return e?(a.addColorStop(0,l.borderTopColor),a.addColorStop(1,l.borderBottomColor)):(a.addColorStop(0,l.borderLeftColor),a.addColorStop(1,l.borderRightColor)),a},M.prototype.jJ=function(t,e){var o,n,r,i,a,s,l,u,c,h=this.kj.vu();if(e)for(o=e.length,n=0;n<o;n++)i=(r=e[n]).x,a=r.y,s=r.width,l=r.height,0===(c=(u=r.style).type)&&this.hyb(t,i,a,s,l,u),1===c&&this.iyb(t,i,a,s,l,u),2===c&&this.jyb(t,i,a,s,l,u,h)},M.prototype.hyb=function(t,e,o,n,r,i){var a=i.color,s=e-4,l=o-4,u=n+8,c=r+8,h=u/2*.5522848,f=c/2*.5522848,p=s+u,d=l+c,g=s+u/2,m=l+c/2;t.save(),t.lineWidth=2,t.strokeStyle=a,t.beginPath(),t.moveTo(s,m),t.bezierCurveTo(s,m-f,g-h,l,g,l),t.bezierCurveTo(g+h,l,p,m-f,p,m),t.bezierCurveTo(p,m+f,g+h,d,g,d),t.bezierCurveTo(g-h,d,s,m+f,s,m),t.closePath(),t.stroke(),t.restore()},M.prototype.iyb=function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d;e-=.5,o-=.5,f=Math.min(n/2,r/2),p=i.color,d=i.position,t.save(),t.lineWidth=2,t.strokeStyle=p,t.beginPath(),t.rect(e,o,n,r),t.stroke(),t.restore(),t.save(),t.beginPath(),0===d?(l=a=e,u=(s=o)+f,c=a+f,h=s):2===d?(u=(s=o+r)-f,c=(l=a=e+n)-f,h=s):3===d?(l=a=e,u=(s=o+r)-f,c=a+f,h=s):1===d&&(u=(s=o)+f,c=(l=a=e+n)-f,h=s),t.moveTo(a,s),t.lineTo(l,u),t.lineTo(c,h),t.fillStyle=p,t.fill(),t.closePath(),t.restore()},M.prototype.jyb=function(t,e,o,n,r,i,a){var s,l,u,c,h,f,p;if(e-=.5,o-=.5,s=this.kj.zoom(),c=i.image,h=i.position,f=i.color,t.save(),t.beginPath(),t.lineWidth=2,t.strokeStyle=f,t.rect(e,o,n,r),t.stroke(),c&&"none"!==c&&a){4===h?l=e-18:5===h&&(l=e+n+3);try{a.ko(c)?(p=a.lo(c),u=o+r/2-7.5,t.drawImage(p,l,u,15,15)):a.fo(c)}catch(t){}}else 4===h?l=e-18*s:5===h&&(l=e+n+3*s),u=o+r/2-15*s/2,t.translate(l,u),t.scale(.015*s,.015*s),t.beginPath(),t.moveTo(512,0),t.bezierCurveTo(229.248,0,0,229.184,0,512),t.bezierCurveTo(0,794.816,229.248,1024,512,1024),t.bezierCurveTo(794.752,1024,1024,794.752,1024,512),t.bezierCurveTo(1024,229.24800000000005,794.752,0,512,0),t.closePath(),t.moveTo(783.488,692.992),t.lineTo(692.9920000000001,783.4879999999999),t.lineTo(512,602.496),t.lineTo(331.00800000000004,783.4879999999999),t.lineTo(240.51200000000006,692.992),t.lineTo(421.504,512),t.lineTo(240.512,330.944),t.lineTo(331.008,240.44800000000004),t.lineTo(512,421.44),t.lineTo(692.992,240.384),t.lineTo(783.4879999999999,330.88),t.lineTo(602.496,512),t.lineTo(783.488,692.992),t.closePath(),t.fillStyle=f,t.fill(),t.stroke();t.restore()},M.prototype.SI=function(t,e,o,n,r,i,a,s,l){var u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U;for(void 0===a&&(a=0),void 0===s&&(s=0),void 0===l&&(l=1),u=this.kj,c=3===o,h=(i?i.zoom():u.zoom())*l,f=K(this.Bl(),h),p=u.getDefaultStyle(o),d=u.Al(o),g=this.kj.conditionalFormats,m=X(u),y=u.$q(2),b=u.ar(1),v=i?i.vu():u.vu(),t.save(),t.beginPath(),t.fillStyle=p&&p.foreColor||"black",q(t,f.font),t.textAlign=c?"right":"center",x=e.length,L=[],B={sheet:u,row:-1,col:-1,fontInfo:Y,lineHeight:-1,imageLoader:v,conditionalFormats:g,sheetArea:o,parentBackColor:m},C=0;C<x;C++)S=(T=e[C]).data,j=T.tableFilter,M=T.row,I=T.col,N=T.x,R=T.y,k=It(T),E=Mt(T),D=T.style,_=T.cellOverflowLayout,F=D.font?K(D.font,h):f,n&&typeof r===Q&&1!==r&&(F=K(F.font,r)),D.font=F.font,0<k&&0<E&&(A=D.cellType||d,N--,R--,k++,E++,c?B.sparkline=T.sparkline:(O=n?0:this.mJ(M,I,o),B.visualState=O),P=Z(F.font),B.lineHeight=P,B.row=M+a,B.col=I+s,B.fontInfo=F,B.cellOverflowLayout=_,B.needTopGridline=1===o&&M===b||0===o,B.needLeftGridline=2===o&&I===y||0===o,B.isPrinting=n,B.printZoomFactor=r,A.jp(t,S,N,R,k,E,D,B,j),_&&!B.showBarIconOnly&&(V=new J.Rect(N,R,k,E),z=A.Ama?A.Ama(t,V,D,B):V,L.push({cellType:A,data:S,x:z.x,y:z.y,width:z.width,height:z.height,style:D,richText:void 0,options:{sheet:u,row:M,col:I,fontInfo:F,lineHeight:P,cellOverflowLayout:_,parentBackColor:m,imageLoader:v}})));if(0<(x=L.length))for(W=u.isEditing(),G=u.Jl,U=u.Kl,w=0;w<x;w++)S=(H=L[w]).data,B=H.options,W&&B.row===G&&B.col===U||wt(this.kj)&&S&&"SparklineExValue"===S.typeName||this.BWa(t,H);for(t.restore(),x=e.length,C=0;C<x;C++)T=e[C],vt.Worksheet.ao(u,"paintCell",{ctx:t,sheetArea:o,cell:T,isPrinting:n})},M.prototype.BWa=function(t,e){var o,n,r=e.cellType,i=e.data,a=e.x,s=e.y,l=It(e),u=Mt(e),c=e.style,h=e.options,f=h.cellOverflowLayout;f&&r.uxb&&(o=f.layout,n=new J.Rect(o?o.x:a,o?o.y:s,o?o.width:l,o?o.height:u),r.uxb(t,n,h,i)),r.paintValue&&r.paintValue(t,i,a,s,l,u,c,h)},M.prototype.mJ=function(t,e,o){var n=this.kj,r=0;return B(n)&&(3===o||At(o)?!n.isEditing()&&n.wt(t,e)?r=3:n.vp(t,e,o)&&(r=2):(n.vp(t,e,o)&&(r=1,n.wp(t,e,o)&&(r=2)),n.xt(t,e,o)&&(r=4))),r},M.prototype.hJ=function(m,y,b,v,C){function t(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g;if(w=b[t],A=w.row,S=w.col,M=w.y,N=Mt(w),j=y.nJ(A,m,C),_=j.headingOverflowlayouts,O=j.trailingOverflowLayouts,!B[A]){for(e={},o=0,n=j;o<n.length;o++)r=n[o],e[r.column]=!1;_&&_.forEach(function(t){e[t.column]=!1}),O&&O.forEach(function(t){e[t.column]=!1}),B[A]=e}for(i=B[A],F=j.find(S),a=0;a<F.length;a++)if(s=F[a]){if(l=P.getCellRect(A,s.column,Y,Y,!0),!i[s.column]){if(u=s.column,(T=L.Ym(A,u)).showEllipsis)continue;x=L.zHb(A,u,3,1,T),I=s.columnWidth,R=s.backgroundWidth,k=s.backgroundLeftWidth<0?l.x:s.backgroundRightWidth<0?l.x+It(l)-R:l.x+It(l)/2-s.backgroundLeftWidth,D={data:x,row:A,col:u,x:l.x,y:M,width:I,height:N,cellOverflowLayout:s,style:T},H.push(D),s.layout=new J.Rect(k,M,R,N),T=L.Ym(A,u),v.gF(A,u,s,T,l.x,M,I,N),i[s.column]=!0}s.column===S&&i[s.column]&&V.push(t)}if(_)for(c=0;c<_.length;c++)if((h=_[c])&&!i[h.column]&&h.contains(w.col)){if(S=h.column,(T=L.Ym(A,S)).showEllipsis)continue;x=L.zHb(A,S,3,1,T),I=h.columnWidth,R=h.backgroundWidth,f=P.getCellRect(A,h.endColumn,Y,Y,!0),k=f.x+It(f)-R,D={data:x,row:A,col:S,x:k,y:M,width:I,height:N,style:T,cellOverflowLayout:h},H.push(D),h.layout=new J.Rect(k,M,R,N),i[h.column]=!0,v.gF(A,S,h,T,k,M,I,N)}if(O)for(p=0;p<O.length;p++)if((d=O[p])&&!i[d.column]&&d.contains(w.col)){if(S=d.column,(T=L.Ym(A,S)).showEllipsis)continue;x=L.zHb(A,S,3,1,T),I=d.columnWidth,R=d.backgroundWidth,g=P.getCellRect(A,d.startColumn,Y,Y,!0),k=g.x,E=g.x+R-I,D={data:x,row:A,col:S,x:E,y:M,width:I,height:N,style:T,cellOverflowLayout:d},H.push(D),d.layout=new J.Rect(k,M,R,N),v.gF(A,S,d,T,k,M,I,N),i[d.column]=!0}}var w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,e,o,P=this.kj,L=P.ss,n=b.length,H=[],B={},V=[];for(e=0;e<n;e++)t(e);if(0<V.length)for(o=V.length-1;0<=o;o--)b.splice(V[o],1);return 0<H.length&&H.sort(function(t,e){var o=t.row,n=e.row,r=t.col,i=e.col;return o!==n?o-n:r!==i?r-i:void 0}),H},i=M,e.oJ=i,l=".cutCopyIndicator",h=J.Events.CellChanged,f=J.Events.ClipboardChanged,p=J.Events.ValueChanged,d=J.Events.ColumnChanged,m=J.Events.RowChanged,y=J.Events.RangeChanged,b=J.Events.ClipboardPasting,C=J.Events.ClipboardPasted,w=J.Events.DragMerging,x=J.Events.FloatingElementSelected,A.prototype.jx=function(t){return 0===arguments.length?this.zJ:void(this.zJ=t)},A.prototype.BJ=function(t,e){var o,n=this;return 0===arguments.length?n.yJ:void((n.yJ!==t||t||e)&&(n.yJ=t,(o=n.kj)&&(o.$p(),At(n.Lfc)||clearTimeout(n.Lfc),n.Lfc=setTimeout(function(){if(!n.yJ){var t=o.tu();t&&t.hZ(e)}n.Lfc=Y}))))},A.prototype.AJ=function(){var u=this,o=u.kj,c=!1,n="resizable",r="isVisible";function i(){u.yJ&&u.BJ(!1)}function a(t,e){t!==n&&t!==e&&t!==r&&i()}o._bind(f+l,function(){u.BJ(!0)}),o._bind(p+l,i),o._bind(h+l,i),o._bind(d+l,function(t,e){a(e.propertyName,"width")}),o._bind(m+l,function(t,e){a(e.propertyName,"height")}),o._bind(y+l,function(t,e){6===e.action&&o.Wu&&o.Wu.calcOnDemand||i()}),o._bind(b+l,function(){c=u.BJ()}),o._bind(C+l,function(t,e){var o,n,r,i=e.cellRange,a=e.sheet.tu(),s=a.n5,l=c;if(i&&s&&a.PA){if(u.jx()){for(n=0,r=s;n<r.length;n++)if(r[n].intersect(i.row,i.col,i.rowCount,i.colCount)){l=!1;break}}else o=!(l=!1);u.BJ(l,o)}}),o._bind(w+l,i),o._bind(x+l,function(t,e){"worksheet"!==e.type&&(o.endEdit(),J.Vl.kmb(o))})},A.prototype.UI=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m;if(this.yJ&&(i=(r=this.kj)._render,s=(a=r.parent)?a.options:{},u=(l=r.tu()).n5,c=s.cutCopyIndicatorVisible,At(c)&&(c=!0),h=J.Rm.Om(r,s.cutCopyIndicatorBorderColor||"blue"),c&&l.PA===r&&u&&(f=i.VI(o,n,Y),(p=i.XI(o,n,u,e))&&f))){for(t.save(),t.rect(f.x,f.y,It(f),Mt(f)),t.clip(),d=0,g=p;d<g.length;d++)m=g[d],i.fJ(t,m,h);t.beginPath(),t.restore()}},A.prototype.rI=function(){this.BJ(!1)},A.prototype.sI=function(){this.BJ(!1)},A.prototype.tI=function(){this.BJ(!1)},A.prototype.uI=function(){this.BJ(!1)},A.prototype.ky=function(){this.BJ(!1)},A.prototype.no=function(){var t=this.kj;t._unbind(h+l),t._unbind(f+l),t._unbind(p+l),t._unbind(d+l),t._unbind(m+l),t._unbind(y+l),t._unbind(b+l),t._unbind(C+l),t._unbind(w+l),t._unbind(x+l)},a=A,e.CJ=a,vt.Worksheet.$n("render",{init:function(){this._render=new i(this),this.at=new a(this)},dispose:function(t){var e;!1!==t.clearCache&&(this._render&&(this._render.kj=Y,this._render=Y),(e=this.at)&&(e.no(),this.at=Y))},onLayoutChanged:function(t){var e,o=this.at;o&&("addRows"===(e=t.changeType)?o.rI():"deleteRows"===e?o.sI():"addColumns"===e?o.tI():"deleteColumns"===e&&o.uI())}})},"./dist/core/worksheet/worksheet-selection.js":function(t,e,o){"use strict";var n,C,r,i,a,g,m,w,x,T,s;function A(t,e){return t.getColumnCount(e)}function S(t,e){return t.getRowCount(e)}function M(t){return t.rowCount}function I(t){return t.colCount}function h(t,e,o){var n,r,i=[],a=t.length;for(r=0;r<a;r++)n=t[r],r===e?i=i.concat(o):i.push(n);return i}function N(t,e,o){for(var n=o-1;0<=n;n--)if(t.getColumnVisible(e+n))return e+n;return e+o-1}function R(t,e,o){for(var n=o-1;0<=n;n--)if(t.getRowVisible(e+n))return e+n;return e+o-1}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/worksheet/worksheet.js"),C=o("./dist/core/util/common.js"),r=o("@grapecity/js-sheets-common"),i=o("./dist/core/util/domUtil.js"),a=o("./dist/core/core.enum.js"),g=r.Common.j.Fa,m=r.Common.k.ac,w=null,x=Math.max,T=Math.min,s="gc-selection",i.GC$.extend(n.Worksheet.prototype,{addSelection:function(t,e,o,n){var r,i,a=t,s=e,l=o,u=n;-1===a||-1===s||(r=this._modelManager.getSpans())&&0<m(r)&&(a=(i=this.su(r,C.kf(t,e,o,n))).row,s=i.col,l=M(i),u=I(i)),this._modelManager.do("addSelection",a,s,l,u),this.$p()},setSelection:function(t,e,o,n){this.DJ(t,e,o,n,2)},DJ:function(t,e,o,n,r){var i,a,s,l=S(this),u=A(this);l<=t&&(t=l-1),u<=e&&(e=u-1),i=x(0,t),a=x(0,e),this.Tr(),s=2===r?C.Vl.Wl(this):1===r,this.Kr(i,a,this.Er(i),this.Fr(a),!s),this.addSelection(t,e,o,n)},getSelections:function(){return this._modelManager.getSelections()},clearSelection:function(){this.Tr(),this.Kr(0,0),n.Worksheet.ao(this,"clearSelection"),this.$p()},Tr:function(){this._modelManager.do("clearSelection")},Qs:function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p=this.options,d=p.protectionOptions,g=!1!==d.allowSelectLockedCells,m=!1!==d.allowSelectUnlockedCells;if(!p.isProtected||g&&m)return!0;if(!g&&!m)return!1;if(r=e<0,i=t<0,g===(n=o?o.locked:this.tq(t,e,"locked"))&&(i||r)){for(a=i?S(this):1,t=i?0:t,s=r?A(this):1,e=r?0:e,l=this._modelManager,u=t+a-1,c=e+s-1,f=h=void 0,h=t;h<=u;h++)for(f=e;f<=c;f++)if((o=l.getStyle(h,f))&&g!==o.locked)return!1;if(i)for(h=t;h<=u;h++)if((o=l.getStyle(h,-1))&&g!==o.locked)return!1;if(r)for(f=e;f<=c;f++)if((o=l.getStyle(-1,f))&&g!==o.locked)return!1}return g===n},SZa:function(t,e,o,n){var r,i;for(e=e<0?0:e,r=t=t<0?0:t;r<t+o;r++)for(i=e;i<e+n;i++)if(this.tq(r,i,"locked"))return!0},ZZa:function(){var t,e=this.getSelections();for(t=0;t<e.length;t++)if(-1!==e[t].col)return!1;return!0},$Za:function(){var t,e=this.getSelections();for(t=0;t<e.length;t++)if(-1!==e[t].row)return!1;return!0},selectionPolicy:function(t){var e=this._modelManager;return 0===arguments.length?e.getSelectionPolicy():(e.do("setSelectionPolicy",t),this)},selectionUnit:function(t){var e=this._modelManager;return 0===arguments.length?e.getSelectionUnit():(e.do("setSelectionUnit",t),this)},getSelectionBackColor:function(){return this.options.selectionBackColor||C.Im.Lm(s).backgroundColor},getSelectionBorderColor:function(){return this.options.selectionBorderColor||C.Im.Lm(s).borderTopColor},m_a:function(t){return t?void(this.options.m_a=t):this.options.m_a},EJ:function(){var t,e,o=this._modelManager.getSelections();0<m(o)&&(t={selections:o},0!==(e=this._modelManager.getActiveSelectedRangeIndex())&&(t.activeSelectedRangeIndex=e),this.FJ=t,this.Tr(),this._render.im())},GJ:function(){var t=this.FJ,e=t&&t.selections;e&&(this._modelManager.do("setSelections",e),this._modelManager.do("setActiveSelectedRangeIndex",t.activeSelectedRangeIndex||0))},Ax:function(t,e,o){var n,r,i,a=this.HJ(t,e,o,this.Rr||0);a&&(n=a.row,r=a.col,i=a.leadingCellCol,this.IJ(n,r)&&(this.Qr=n,this.Rr=i,this.Jr(n,r)))},HJ:function(t,e,o,n){var r,i,a=S(this),s=A(this),l=t;return 0===l&&!o||0===a||0===s?w:(i=this.JJ(l,n),o||this.KJ(i),l=i.r,r=i.c,l<0&&o&&(((r=this.br(r))<0||g(r))&&(r=this.br(s)),n=r,l=(i=this.JJ(a,r)).r,(r=i.c)===e&&l<=t)?w:{row:l,col:r,leadingCellCol:n})},Bx:function(t,e,o){var n,r,i,a=this.LJ(t,e,o,this.Rr||0);!a||a.row===t&&a.col===e||(n=a.row,r=a.col,i=a.leadingCellCol,this.IJ(n,r)&&(this.Qr=n,this.Rr=i,this.Jr(n,r)))},LJ:function(t,e,o,n){var r,i,a=S(this),s=A(this),l=t;if((l!==a-1||o)&&0!==a&&0!==s&&(i=this.MJ(l,n),o||this.KJ(i),l=i.r,r=i.c,!(l===a&&o&&((s<=(r=this.Zq(r))||g(r))&&(r=this.Zq(-1)),n=r,l=(i=this.MJ(-1,r)).r,(r=i.c)===e&&t<=l))))return{row:l,col:r,leadingCellCol:n}},Dx:function(){var t,e,o=this.NJ();o&&(t=o.row,e=o.col,this.Qr=t,this.Rr=e,this.Jr(t,e))},NJ:function(){var t,e,o,n,r=this.ir(),i=this.dr(),a=i;if(!r&&!a)return w;if(o=!1!==(e=(t=this.options).protectionOptions).allowSelectLockedCells,n=!1!==e.allowSelectUnlockedCells,!t.isProtected||o&&n)return{row:r,col:a};if(!o&&!n)return w;for(;r!==w&&0<=r;r=this.gr(r))for(a=i;a!==w&&0<=a;a=this.br(a))if(o===this.tq(r,a,"locked"))return{row:r,col:a};return w},Cx:function(){var t,e,o=this.OJ();o&&(t=o.row,e=o.col,this.Qr=t,this.Rr=e,this.Jr(t,e))},OJ:function(){var t,e,o,n,r=this,i=r._q(r.frozenRowCount()-1),a=r.Zq(r.frozenColumnCount()-1),s=a,l=r.ir(),u=r.dr();if(i===w||s===w)return w;if(o=!1!==(e=(t=r.options).protectionOptions).allowSelectLockedCells,n=!1!==e.allowSelectUnlockedCells,!t.isProtected||o&&n)return{row:i,col:s};if(!o&&!n)return w;for(;i!==w&&i<=l;i=r._q(i))for(s=a;s!==w&&s<=u;s=r.Zq(s))if(o===r.tq(i,s,"locked"))return{row:i,col:s};return w},zx:function(t,e,o){var n,r,i,a,s=this.tables;(n=o?(n=s&&s.bJb(t,e))||this.iy(t,e,o,this.Qr||0):this.iy(t,e,o,this.Qr||0))&&(r=n.row,i=n.col,a=n.leadingCellRow,this.IJ(r,i)&&(this.Qr=a,this.Rr=i,this.Jr(r,i)))},iy:function(t,e,o,n){var r,i,a,s=S(this),l=A(this),u=e;if(0===u&&!o||0===s||0===l)return w;for(i=this.PJ(n,u),a=n,o||this.KJ(i),r=i.r,u=i.c;u<0&&o;){if(((r=this.gr(r,3,!0))<0||g(r))&&(r=this.gr(s,3,!0)),n=r,r=(i=this.PJ(n,l)).r,u=i.c,r===t&&u<e)return w;if(r===t&&u===e){if(n===a)return w;r=(i=this.PJ(n,u)).r,u=i.c}}return{row:r,col:u,leadingCellRow:n}},KJ:function(t){var e,o=!1;t.r<0?t.r=this.ar():t.r>=S(this)&&(t.r=this.ir(),o=!0),t.c<0?t.c=this.$q():t.c>=A(this)&&(t.c=this.dr(),o=!0),o&&((e=this._modelManager.getSpan(t.r,t.c)).row!==t.r&&(t.r=e.row),e.col!==t.c&&(t.c=e.col))},Fx:function(t,e){for(var o,n,r=this._modelManager,i=r.getActiveSelectedRangeIndex(),a=-1,s=this.Tq(this._getActiveSelectedRange()),l=s.row,u=s.col,c=s.col+I(s)-1,h=t,f=e;h=(o=this.QJ(h,f)).r,!(u<=(f=o.c));){if(a===i&&h===t&&f<=e)return;f=l<=--h?c+1:(n=this.Tq(this._getActiveSelectedRange(3)),a=r.getActiveSelectedRangeIndex(),l=n.row,u=n.col,c=n.col+I(n)-1,h=n.row+M(n)-1,n.col+I(n))}0<=h&&(this.Jr(h,f),this.Qr=h,this.Rr=f)},Gx:function(t,e){for(var o,n,r=this._modelManager,i=r.getActiveSelectedRangeIndex(),a=-1,s=this.Tq(this._getActiveSelectedRange()),l=s.col,u=s.row+M(s)-1,c=s.col+I(s)-1,h=t,f=e;h=(o=this.RJ(h,f)).r,!((f=o.c)<=c);){if(a===i&&h===t&&e<=f)return;f=++h<=u?l-1:(n=this.Tq(this._getActiveSelectedRange(4)),a=r.getActiveSelectedRangeIndex(),l=n.col,u=n.row+M(n)-1,c=n.col+I(n)-1,h=n.row,n.col-1)}0<=h&&(this.Jr(h,f),this.Qr=h,this.Rr=f)},Rs:function(t,e,o){var n,r,i,a,s=this.tables;!(n=o?(n=s&&s.cJb(t,e))||this.hy(t,e,o,this.Qr||0):this.hy(t,e,o,this.Qr||0))||n.row===t&&n.col===e||(r=n.row,i=n.col,a=n.leadingCellRow,this.IJ(r,i)&&(this.Qr=a,this.Rr=i,this.Jr(r,i)))},hy:function(t,e,o,n){var r,i,a,s=this,l=S(s),u=A(s),c=e;if(c===u-1&&!o||0===l||0===u)return w;for(i=s.SJ(n,c),a=n,o||s.KJ(i),r=i.r,c=i.c;c===u&&o;){if(!(t!==l-1||t!==r||s.getRowVisible(r,3)&&0<s.Sl(r,3)))return w;if((l<=(r=s._q(r,3,!0))||g(r))&&(r=s._q(-1,3,!0)),n=r,r=(i=s.SJ(n,-1)).r,c=i.c,r===t&&e<c)return w;if(r===t&&c===e){if(n===a)return w;r=(i=s.SJ(n,c)).r,c=i.c}}return{row:r,col:c,leadingCellRow:n}},PJ:function(t,e){for(var o,n,r,i=e;0<=i&&(o=t,!(--i<0));)if((n=this._modelManager.getSpans(C.kf(o,i,1,1)))&&0<m(n)&&(i>=(r=n[0]).col&&(i=r.col,o=r.row)),this.IJ(o,i))return{r:o,c:i};return{r:o,c:i}},QJ:function(t,e){for(var o,n;0<=e&&!(--e<0);){if(o=this._modelManager.findSpan(t,e)){if(!((n=this._getActiveSelectedRange()).row<=o.row&&o.row+M(o)<=n.row+M(n)&&n.col<=o.col&&o.col+I(o)<=n.col+I(n)))continue;if(o.row!==t||o.col!==e)continue;e>=o.col&&(e=o.col,t=o.row)}if(this.IJ(t,e))return{r:t,c:e}}return{r:t,c:e}},SJ:function(t,e){for(var o,n,r,i,a=A(this),s=e;s<a&&(o=t,!(a<=(s=(n=this._modelManager.getSpan(o,s)).col+I(n))));)if((r=this._modelManager.getSpans(C.kf(o,s,1,1)))&&0<m(r)&&(s>(i=r[0]).col?s=x(s,i.col+I(i)):o=i.row),this.IJ(o,s))return{r:o,c:s};return{r:o,c:s}},RJ:function(t,e){for(var o,n,r,i=this._modelManager,a=A(this);e<a&&!(a<=(e=(o=i.getSpan(t,e)).col+I(o)));){if(n=i.findSpan(t,e)){if(!((r=this._getActiveSelectedRange()).row<=n.row&&n.row+M(n)<=r.row+M(r)&&r.col<=n.col&&n.col+I(n)<=r.col+I(r)))continue;if(n.row!==t||n.col!==e)continue;e>n.col?e=x(e,n.col+I(n)):t=n.row}if(this.IJ(t,e))return{r:t,c:e}}return{r:t,c:e}},IJ:function(t,e){var o,n;return!!this.Qs(t,e)&&(o=0<=t&&t<S(this)&&0<=e&&e<A(this)&&this.getRowVisible(t)&&this.getColumnVisible(e)&&0<this.Sl(t)&&0<this.Tl(e),n=!!this.Tx,!0===o&&!0==n&&(!1===this.tq(t,e,"tabStop")&&(o=!1)),o)},JJ:function(t,e){for(var o,n;0<=t&&!(--t<0);)if((o=this._modelManager.getSpans(C.kf(t,e,1,1)))&&0<m(o)&&(t>=(n=o[0]).row&&(t=n.row,e=n.col)),this.IJ(t,e))return{r:t,c:e};return{r:t,c:e}},MJ:function(t,e){for(var o,n,r,i=S(this);t<i&&!(i<=(t=(o=this._modelManager.getSpan(t,e)).row+M(o)));)if((n=this._modelManager.getSpans(C.kf(t,e,1,1)))&&0<m(n)&&(t>(r=n[0]).row?t=x(t,r.row+M(r)):e=r.col),this.IJ(t,e))return{r:t,c:e};return{r:t,c:e}},Ur:function(t,e,o,n,r){this._modelManager.do("addSelection",t,e,o,n),r&&this.Xq<=0&&this._render.im()},aH:function(t,e,o){var n=this.Jx(t,e,this.Jl,this.Kl),r=n.row,i=n.col,a=M(n),s=I(n),l=this.selectionPolicy(),u=this.selectionUnit();0!==l&&(1===l&&this._modelManager.do("clearSelection"),1===u?s=i=-1:2===u&&(a=r=-1),this.Kx(r,i,a,s,o))},Jx:function(t,e,o,n,r){var i,a,s,l,u;return g(o)&&(o=this.Jl),g(n)&&(n=this.Kl),a=(i=this._modelManager).getSpan(o,n),s=i.getSpan(t,e),r&&a.equals(s)?new C.Range(a.row,a.col,1,1):(l=a.union(s),(u=this._modelManager.getSpans())&&0<m(u)&&(l=this.TJ(u,l)),l)},Kx:function(t,e,o,n,r){var i,a,s,l,u,c,h=this,f=h._modelManager,p=h._getActiveSelectedRange();if(0<m(f.getSelections())?(a=C.kf(t,e,o,n),h.n_a?(i=h.p_a,h.p_a=a):((s=f.getSelections())[f.getActiveSelectedRangeIndex()]=a,f.do("setSelections",s))):h.n_a||f.do("addSelection",t,e,o,n),r&&h.Xq<=0){if(l=h._getActiveSelectedRange(),!h.n_a&&l.row===p.row&&l.col===p.col&&M(l)===M(p)&&I(l)===I(p))return;u=h._render,h.n_a&&(c=h.p_a,i&&i.containsRange(c)?c=i:i&&(c=i.union(c)),p=(c=c.union(C.kf(h.getActiveRowIndex(),h.getActiveColumnIndex(),1,1))).union(p),l=c.union(l)),p.containsRange(l)?u.im(p):l.containsRange(p)?u.im(l):(u.im(p),u.im(l),u.im(h.p_a))}},kyb:function(t){var e=[];return t&&(e=this._modelManager.getSpans(t)),e},lyb:function(t,e){var o=t.row,n=t.col,r=t.rowCount,i=t.colCount,a=e.row,s=e.col,l=e.rowCount,u=e.colCount,c=o+r,h=n+i,f=a+l,p=s+u,d=!1,g=!1;return t.intersect(a,s,l,u)&&(g=!(d=a<o||s<n||c<f||h<p)),e.myb=e.myb||g,d},nyb:function(t,e,o,n){var r,i=[],a=[];for(r=0;r<t.length;r++)a=this.oyb(t[r],e,o,n),i=i.concat(a);return i},oyb:function(t,e,o,n){var r,i,a,s,l,u=[],c=e.length;for(u.push(t),s=c-1;0<=s;s--)for(i=e[s],l=0;l<u.length;)r=u[l],this.lyb(r,i)?(u=h(u,l,a=this.v_a(r,i,o,n)),l+=a.length):l++;return u},pyb:function(t,e){var o=e.row,n=e.col,r=e.rowCount,i=e.colCount;return t.intersect(o,n,r,i)},qyb:function(t,e){var o,n,r=[];for(n=t.length-1;0<=n;n--)o=t[n],this.pyb(o,e)||r.push(o);return r},ryb:function(t){var e=!1,o=this._modelManager.getSpans(t);return 1===o.length&&(e=t.equals(o[0])),e},syb:function(t,e){var o,n,r,i=t,a=e.length,s=i.length,l=!0;for(n=a-1;0<=n;n--){for(o=e[n],r=s-1;0<=r;r--)if(i[r].equals(o)){l=!1;break}l&&i.push(o)}return i},tyb:function(t){var e,o,n,r,i=[];for(o=t.length-1;0<=o;o--)(e=t[o]).myb&&(delete e.myb,i.push(o));for(n=i.length,r=0;r<n;r++)t.splice(i[r],1)},v_a:function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m;return e=this.Tq(e),r=[],i=t.getIntersect(e,o,n),t&&i?(a=0<=t.row?t.row:0,s=0<=t.col?t.col:0,l=t.rowCount,u=t.colCount,c=i.row,h=i.col,f=i.rowCount,d=s+u,m=h+i.colCount,0<(p=a+l)-(g=c+f)&&r.push(C.kf(g,s,p-g,u)),0<d-m&&r.push(C.kf(c,m,f,d-m)),0<h-s&&r.push(C.kf(c,s,f,h-s)),0<c-a&&r.push(C.kf(a,s,c-a,u))):r.push(t),r},u_a:function(t,e){var o,n,r,i,a,s,l,u,c,h,f=[],p=this.getRowCount(3),d=this.getColumnCount(3),g=this.deselectIgnoreSpan();if(t&&0<t.length){for(n=[],r=[],s=a=void 0,o=!(i=[]),l=t.length-1;0<=l;l--)a=t[l],g||!this.ryb(a)||this.pyb(a,e)?(n=this.v_a(a,e,p,d),g||0<(s=this.kyb(a)).length&&(n=this.nyb(n,s,p,d),i=this.qyb(s,e),r=this.syb(r,i),this.tyb(r)),u=m(n),!o&&0<u&&(this.setSelection(n[u-1].row,n[u-1].col,1,1),o=!0),f=n.concat(f)):r=this.syb(r,[a]);g||(f=r.concat(f))}for(this.Tr(),c=f.length,this.suspendPaint(),h=0;h<c;h++)this.addSelection(f[h].row,f[h].col,f[h].rowCount,f[h].colCount);o||this.setActiveCell(this.Jl,this.Kl),this.resumePaint()},Sx:function(t,e){var o,n,r,i,a,s,l,u,c,h=this,f=h._modelManager.getSelections();if(!(m(f)<=0)&&(o=h._getActiveSelectedRange(),n=h.UJ(o,t,e))){if(r=n.row,i=n.col,a=M(n),s=I(n),l=h.selectionPolicy(),u=h.selectionUnit(),0===l)return;1===l&&h._modelManager.do("clearSelection"),1===u?s=i=-1:2===u&&(a=r=-1),h.Kx(r,i,a,s,!0),c=h._modelManager.getSelections(),h._eventHandler.zu(f,c)&&(h.yu(f,c),h.Au(f))}},UJ:function(t,e,o,n,r){var i=this,a=i.Tq(t),s=w;return 37===e?s=o?i.VJ(a,!1,n,r):i.WJ(a,n,r):39===e?s=o?i.XJ(a,!1,n,r):i.YJ(a,n,r):38===e?s=o?i.ZJ(a,!1,n,r):i.$J(a,n,r):40===e?s=o?i._J(a,!1,n,r):i.aK(a,n,r):36===e?s=o?i.bK(a,n,r):i.cK(a,n,r):35===e?s=o?i.dK(a,n,r):i.eK(a,n,r):33===e?s=i.fK(a,n,r):34===e&&(s=i.gK(a,n,r)),s&&(t.row<0&&(s.row=-1,s.rowCount=i.getRowCount()),t.col<0&&(s.col=-1,s.colCount=i.getColumnCount())),s},WJ:function(t,e,o){for(var n,r,i,a,s,l,u,c,h=this,f=t.row,p=t.col,d=M(t),g=I(t),m=p+g-1,y=R(h,f,d);0<m;)if(m--,h.IJ(y,m)&&(n=h.Jx(y,m,e,o),r=T(f,n.row),i=T(p,n.col),s=x(f+d-1,n.row+M(n)-1)-r+1,l=(a=T(p+g-1,n.col+I(n)-1))-i+1,r!==f||i!==p||s!==d||l!==g))return u=h.qq,p<(c=h.Kl)?i<=u&&h.rq(i):p===c&&a<=u&&h.rq(a),h.parent&&h.parent.options.scrollByPixel&&i===u&&0!==h.eCb&&h.rq(i,0),C.kf(r,i,s,l);return w},VJ:function(t,e,o,n){var r,i,a,s,l,u=t.row,c=t.col,h=this.frozenColumnCount(),f=h?this.Zq(h-1):this.$q(),p=e?f:this.$q();if(!g(p))return(h<=0||e)&&this.rq(p),r=this.Jx(u,p,o,n),i=T(u,r.row),a=T(c,r.col),s=x(u+M(t)-1,r.row+M(r)-1)-i+1,l=T(c+I(t)-1,r.col+I(r)-1)-a+1,C.kf(i,a,s,l)},lCb:function(t){var e,o,n,r,i;if(this.parent&&this.parent.options.scrollByPixel){for(n=this.ss,r=this.Fr(t),i=this.getViewportWidth(r);0<=t&&!((i-=n._m(t))<0);t--);e=t,o=i}else e=this.gXc(t,2).col,o=0;return{dj:e,UP:o}},YJ:function(t,e,o){for(var n,r,i,a,s,l,u,c,h,f=this,p=t.row,d=t.col,g=M(t),m=I(t),y=d,b=A(f)-1,v=R(f,p,g);y<b;)if(y++,f.IJ(v,y)&&(n=f.Jx(v,y,e,o),r=T(p,n.row),i=x(d,n.col),s=x(p+g-1,n.row+M(n)-1)-r+1,l=(a=x(d+m-1,n.col+I(n)-1))-i+1,r!==p||i!==d||s!==g||l!==m))return u=f.Aw(),d<(c=f.Kl)?u<=i&&(h=f.lCb(i),f.rq(h.dj,h.UP)):d===c&&u<=a&&(h=f.lCb(a),f.rq(h.dj,h.UP)),C.kf(r,i,s,l);return w},XJ:function(t,e,o,n){var r,i,a,s,l,u,c=t.row,h=t.col,f=this.lr();if(!g(f))return this.rq(f),r=this.dr(),e||(r+=this.frozenTrailingColumnCount()),i=this.Jx(c,r,o,n),a=T(c,i.row),s=x(h,i.col),l=x(c+M(t)-1,i.row+M(i)-1)-a+1,u=x(h+I(t)-1,i.col+I(i)-1)-s+1,C.kf(a,s,l,u)},$J:function(t,e,o){for(var n,r,i,a,s,l,u,c,h=this,f=t.row,p=t.col,d=M(t),g=I(t),m=f+d-1,y=N(h,p,g);0<m;)if(m--,h.IJ(m,y)&&(n=h.Jx(m,y,e,o),r=T(f,n.row),i=T(p,n.col),s=(a=T(f+d-1,n.row+M(n)-1))-r+1,l=x(p+g-1,n.col+I(n)-1)-i+1,r!==f||i!==p||s!==d||l!==g))return u=h.lq,f<(c=h.Jl)?r<=u&&h.mq(r):f===c&&a<=u&&h.mq(a),h.parent&&h.parent.options.scrollByPixel&&r===u&&0!==h.cCb&&h.mq(r,0),C.kf(r,i,s,l);return w},ZJ:function(t,e,o,n){var r,i,a,s,l,u=t.row,c=t.col,h=this.frozenRowCount(),f=h?this._q(h-1):this.ar(),p=e?f:this.ar();if(!g(p))return(h<=0||e)&&this.mq(p),r=this.Jx(p,c,o,n),i=T(u,r.row),a=T(c,r.col),s=T(u+M(t)-1,r.row+M(r)-1)-i+1,l=x(c+I(t)-1,r.col+I(r)-1)-a+1,C.kf(i,a,s,l)},mCb:function(t){var e,o,n,r,i;if(this.parent&&this.parent.options.scrollByPixel){for(n=this.ss,r=this.Er(t),i=this.getViewportHeight(r);0<=t&&!((i-=n.Sl(t))<0);t--);e=t,o=i}else e=this.ms(t,2),o=0;return{cj:e,UP:o}},aK:function(t,e,o){for(var n,r,i,a,s,l,u,c,h,f=this,p=t.row,d=t.col,g=M(t),m=I(t),y=p,b=S(f)-1,v=N(f,d,m);y<b;)if(y++,f.IJ(y,v)&&(n=f.Jx(y,v,e,o),r=x(p,n.row),i=T(d,n.col),s=(a=x(p+g-1,n.row+M(n)-1))-r+1,l=x(d+m-1,n.col+I(n)-1)-i+1,r!==p||i!==d||s!==g||l!==m))return u=f.Fw(),p<(c=f.Jl)?u<=r&&(h=f.mCb(r),f.mq(h.cj,h.UP)):p===c&&u<=a&&(h=f.mCb(a),f.mq(h.cj,h.UP)),C.kf(r,i,s,l);return w},_J:function(t,e,o,n){var r,i,a,s,l,u,c=t.row,h=t.col,f=this.kr();if(!g(f))return this.mq(f),r=this.ir(),e||(r+=this.frozenTrailingRowCount()),i=this.Jx(r,h,o,n),a=x(c,i.row),s=T(h,i.col),l=x(c+M(t)-1,i.row+M(i)-1)-a+1,u=x(h+I(t)-1,i.col+I(i)-1)-s+1,C.kf(a,s,l,u)},cK:function(t,e,o){for(var n,r,i,a,s,l=t.row,u=t.col,c=M(t),h=I(t),f=this.frozenColumnCount()-1,p=this.Kl,d=l+c-1;f<p;)if(f++,this.IJ(d,f)){if(u<=f&&u+h-1===this.Kl)break;return n=this.Jx(d,f,e,o),r=T(l,n.row),i=T(u,n.col),a=x(l+c-1,n.row+M(n)-1)-r+1,s=T(u+h-1,n.col+I(n)-1)-i+1,this.rq(this.$q()),C.kf(r,i,a,s)}return w},bK:function(t,e,o){return t=this.VJ(t,!0,e,o),this.ZJ(t,!0,e,o)},eK:function(t,e,o){for(var n,r,i,a,s,l=t.row,u=t.col,c=M(t),h=I(t),f=A(this),p=this.Kl,d=l+c-1;p<f;)if(f--,this.IJ(d,f)){if(f<=u+h-1&&u===this.Kl)break;return n=this.Jx(d,f,e,o),r=T(l,n.row),i=x(u,n.col),a=x(l+c-1,n.row+M(n)-1)-r+1,s=x(u+h-1,n.col+I(n)-1)-i+1,this.rq(this.lr()),C.kf(r,i,a,s)}return w},dK:function(t,e,o){return t=this.XJ(t,!0,e,o),this._J(t,!0,e,o)},fK:function(t,e,o){var n,r,i,a,s,l,u,c=this,h=t.row,f=t.col,p=M(t),d=c.Ew();return g(d)?w:(n=c.Gr(1),r=-1,c.mq(d)?r=c._q(h+p-1-m(n)):c.frozenRowCount()<=0&&(r=c.ar()),r<c.lq?r=c.lq:r>=c.Fw()&&(r=c.gr(c.Fw())),i=c.Jx(r,f,e,o),a=T(h,i.row),s=T(f,i.col),l=T(h+p-1,i.row+M(i)-1)-a+1,u=x(f+I(t)-1,i.col+I(i)-1)-s+1,C.kf(a,s,l,u))},gK:function(t,e,o){var n,r,i,a,s,l,u,c=this,h=t.row,f=t.col,p=M(t),d=c.$x();return g(d)?w:(n=c.Gr(1),c.mq(d),(r=c.gr(h+p-1+m(n)))<c.lq?r=c.lq:r>=c.Fw()&&(r=c.lq>=c.kr()?c.Fw():c.gr(c.Fw())),i=c.Jx(r,f,e,o),a=x(h,i.row),s=T(f,i.col),l=x(h+p-1,i.row+M(i)-1)-a+1,u=x(f+I(t)-1,i.col+I(i)-1)-s+1,C.kf(a,s,l,u))},Ew:function(){var t,e,o,n,r,i=this.Gr(1);if(!i||m(i)<=0)return w;for(e=(t=this.frozenRowCount())?this._q(t-1):this.ar(),o=0,n=this.lq,r=this.am();e<n&&(n--,!((o+=this.Sl(n))>this.oKc(r))););return n},zw:function(){var t,e,o,n,r,i=this.Hr(1);if(!i||m(i)<=0)return w;for(e=(t=this.frozenColumnCount())?this.Zq(t-1):this.$q(),o=0,n=this.qq,r=this.am();e<n&&(n--,!((o+=this.Tl(n))>this.rKc(r))););return n},$x:function(){var t,e=this.Gr(1),o=m(e);return e&&0<o?(t=e[o-1].row,this.ir()<=t?this.lq:t):w},kr:function(){var t,e,o,n,r,i,a=this;if(a.ir()===a.Fw()&&(t=a.am(),e=a.Gr(1),o=m(e),e&&1<=o&&(n=e[o-1]).y+n.height<=t.qt+a.oKc(t)))return a.lq;r=a.lq;try{return a.lq=a.ir(),i=a.Ew(),i=a._q(i)}catch(t){}finally{a.lq=r}},lr:function(){var t,e,o,n,r,i,a=this;if(a.dr()===a.Aw()&&(t=a.am(),e=a.Hr(1),o=m(e),e&&1<=o&&(n=e[o-1]).x+n.width<=t.pt+t.width))return a.qq;for(t=a.am(),r=0,i=a.dr();0<i&&!((r+=a.Tl(i))>a.rKc(t));)i--;return 0<i&&(i=a.Zq(i)),i},Fw:function(){var t=this.Gr(1),e=m(t);return t&&0<e?t[e-1].row:w},Aw:function(){var t=this.Hr(1),e=m(t);return t&&0<e?t[e-1].col:w},hr:function(){var t,e,o=this.Gr(1),n=m(o);return o&&0<n?(t=this.am(),o[e=n-1].y+o[e].height<=t.qt+this.oKc(t)?o[e].row:o[x(e-1,0)].row):w},cr:function(){var t,e,o=this.Hr(1),n=m(o);return o&&0<n?(t=this.am(),o[e=n-1].x+o[e].width<=t.pt+this.rKc(t)?o[e].col:o[x(e-1,0)].col):w},ir:function(t){g(t)&&(t=3);var e=S(this,t);return 3!==t&&2!==t||(e-=this.frozenTrailingRowCount()),this.gr(e,t)},dr:function(t){g(t)&&(t=3);var e=A(this,t);return 3!==t&&1!==t||(e-=this.frozenTrailingColumnCount()),this.br(e,t)},TJ:function(t,e){var o,n,r;if(t)for(o=0,n=m(t);o<n;o++)if(r=t[o],e.intersect(r.row,r.col,M(r),I(r)))return t.splice(o,1),o--,this.TJ(t,e.union(r));return e},_getActiveSelectedRange:function(t){var e,o=this._modelManager,n=m(o.getSelections()),r=C.kf(-1,-1,0,0);return n<=0||(e=o.getActiveSelectedRangeIndex(),3===t?(--e<0&&(e=n-1),o.do("setActiveSelectedRangeIndex",e)):4===t&&(n<=++e&&(e=0),o.do("setActiveSelectedRangeIndex",e)),0<=(e=o.getActiveSelectedRangeIndex())&&(r=o.getSelections()[e])),r}}),n.Worksheet.$n("selection",{init:function(){this._modelManager.do("addSelection",0,0,1,1),this._modelManager.setCellState(0,0,a.CellStatesType.active,!0,a.SheetArea.viewport)}})},"./dist/core/worksheet/worksheet-sort.js":function(t,e,s){"use strict";var o,n,T,C,r,A,i,a,S,B,b,V,z,W,G,M;function k(t,e,o){for(var n=t[o-e];n<o;)n=t[n-e];return n}function U(t,e){return"object"==typeof t?JSON.stringify(t):(t=e.getColor(t),o.Common.pc.bc(o.Common.pc.ec(t)))}function p(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P=r,L=t,H=e;if(P)for(s=0;s<P.length&&(P[s]&&(l=P[s].ascending,0<=(u=P[s].index)&&(h=c=void 0,f=n?L:u,p=n?u:L,d=n?H:u,g=n?u:H,h=i?(c=i[f][p],i[d][g]):(c=o.getValue(f,p),o.getValue(d,g)),P[s].compareFunction?(a=P[s].compareFunction(c,h),l||(a*=-1)):V(P[s].color)?(b=V(c)||""===c||typeof c===G&&isNaN(c),v=V(h)||""===h||typeof h===G&&isNaN(h),b||v?b&&v?a=0:b&&!v?a=1:!b&&v&&(a=-1):(F=h,a=((O=c)instanceof Date&&F instanceof Date?B(O)===B(F):typeof O===W&&typeof F===W?O.toLowerCase()===F.toLowerCase():O===F)?0:(R=h,_=j=D=E=k=void 0,(N=c)instanceof Date&&(N=B(N)),R instanceof Date&&(R=B(R)),D=(k=typeof N)===W,j=(E=typeof R)===W,_=E===G,(k==E||k!==G&&!_?k===z&&j||(!D||E!==z)&&(D&&j?N.toLowerCase()>R.toLowerCase():R<N):_)?l?1:-1:l?-1:1))):(0,m=o.getActualStyle(f,p,3,!1,!1,!0),y=o.getActualStyle(d,g,3,!1,!1,!0),C=o,w=m,x=y,T=P[s].color,A=P[s].isBackColor,M=S=void 0,I=C.currentTheme(),V(w)||(S=A?w.backColor:w.foreColor,V(S)||(S=U(S,I))),V(x)||(M=A?x.backColor:x.foreColor,V(M)||(M=U(M,I))),a=(S=S||"")===(M=M||"")?0:S===T?1:M===T?-1:0,l||(a*=-1)))),0===a);s++);return a}function v(t,e,o,n,r){var i,a,s,l,u,c,h,f=t.length;if(f<=1)return t;for(a=t[i=Math.floor(f/2)],s=[],l=[],u=[],c=0;c<f;c++)i!==c?(h=p(t[c],a,e,o,n,r))<0?s.push(t[c]):0<h?l.push(t[c]):u.push(t[c]):u.push(t[c]);return v(s,e,o,n,r).concat(u,v(l,e,o,n,r))}function I(t,e,o,n,r,i,a,s,l){var u,c,h,f,p,d=i?n:r,g=i?e:o,m=[];for(u=0;u<d;u++)m[u]=g+u;for(c=s.ignoreHidden?function(t,e,o){var n,r,i=[];if(e)for(n=o.length-1;0<=n;n--)r=o[n],0===t.getRowHeight(r)&&(o.splice(n,1),i.push({mi:n,Qb:r}));else for(n=o.length-1;0<=n;n--)r=o[n],0===t.getColumnWidth(r)&&(o.splice(n,1),i.push({mi:n,Qb:r}));return i}(t,i,m):[],h=m.concat([]),f=!1,m=v(m,t,i,a,l),p=0;p<m.length;p++)if(m[p]!==h[p]){f=!0;break}return function(t,e){var o,n;for(o=t.length-1;0<=o;o--)n=t[o],e.splice(n.mi,0,n.Qb)}(c,m),{array:m,isChanged:f}}function N(t,e,o,n,r,i,a,s,l){var u,c,h,f,p=i?n:r,d=i?e:o,g=i?t.rowOutlines:t.columnOutlines,m=g.kec(d,p),y=g.lec(m,s.groupSort);if(!y){for(u=[],c=0;c<p;c++)u.push(d+c);y=[u]}for(c=0;c<y.length;c++)y[c]=v(y[c],t,i,a,l);return f=(h=g.mec(y,m,s.groupSort)).array,h.isChanged&&function(t,e,o,n,r,i,a){var s,l,u=e?t.rowOutlines:t.columnOutlines,c=[],h=[];if(e){for(s=i;s<i+a;s++)t.Ps(s)||t.rowOutlines&&t.rowOutlines.isCollapsed(s)||(t.getRowVisible(s,3,!0)?0===t.getRowHeight(s)&&(c.push(s),t.setRowHeight(s,t.defaults.rowHeight)):(h.push(s),t.setRowVisible(s,!0)));for(u.nec(o.groupSwap,o.array,r.start),s=0;s<h.length;s++)l=b.Cb(n,h[s])+i,t.setRowVisible(l,!1);for(s=0;s<c.length;s++)l=b.Cb(n,c[s])+i,t.setRowHeight(l,0)}else{for(s=i;s<i+a;s++)t.columnOutlines&&t.columnOutlines.isCollapsed(s)||(t.getColumnVisible(s,3)?0===t.getColumnWidth(s)&&(c.push(s),t.setColumnWidth(s,t.defaults.colWidth)):(h.push(s),t.setColumnVisible(s,!0)));for(u.nec(o.groupSwap,o.array,r.start),s=0;s<h.length;s++)l=b.Cb(n,h[s])+i,t.setColumnVisible(l,!1);for(s=0;s<c.length;s++)l=b.Cb(n,c[s])+i,t.setColumnWidth(l,0)}}(t,i,h,f,m,d,p),{array:f,isChanged:h.isChanged}}function E(t,e,o){var n=t.qg(e,o,!1);n&&n.hasListeners()&&n.Yg()}function D(t,e,o,n){var r,i,a=s("SheetsCalc");a&&(r=a.CalcOperatorAdjustor.zj(t._source,t._source,t.Kf(e,o),e,o,0,0),t.Rf(e,o,r,n),(i=t.qg(e,o,!!r))&&i.og())}function R(t,e,o,n,r,i,a,s,l,u,c){var h,f,p,d,g,m,y,b=[],v=t._modelManager.WTa;if(0<v&&e&&(t._modelManager.WTa=0,[].push.apply(t._modelManager.zTa,[{row:o,column:n,rowCount:r,columnCount:i,byRows:a,sortInfo:s,type:"sortRange",array:u.concat([])}])),h=A&&t.Bj(),f=A&&t.yj(),function(t,e,o,n,r,i,a,s,l,u,c,h){var f,p,d,g,m,y,b,v,C,w,x,T=t._modelManager,A=T.Ky,S=A&&0<A.sV.length,M=i?e:o,I=i?e+n:o+r,N=i?o:e,R=i?o+r:e+n;for(w=M;w<I;w++)if(w!==(C=k(s,M,w)))for(i?(f=w,d=C):(p=w,g=C),x=N;x<R;x++)i?g=p=x:d=f=x,a&&(m=l[f][p],y=l[d][g]),S&&(b=A.get(f,p),v=A.get(d,g)),c&&h&&(E(c,f,p),E(c,d,g),c._f(f,p,d,g),D(c,f,p),D(c,d,g)),T.do("swapNode",f,p,d,g),t.uja&&t.wja(f,p,d,g),S&&A.qUa(b,f,p,v,d,g),a&&(l[f][p]=y,l[d][g]=m),u.push({row:f,col:p}),u.push({row:d,col:g})}(t,o,n,r,i,a,l,u,c,b,h,f),l)for(p=o;p<o+r;p++)for(d=n;d<n+i;d++)t.setValue(p,d,c[p][d]);if(h){for(g=o;g<o+r;g++)for(m=n;m<n+i;m++)(y=h.Kf(g,m))&&h.fg(g,m,y,M);t.getCalcService().recalcRange(f,o,n,r,i)}return C.Worksheet.ao(t,"sortRangeChanged",{column:n,columnCount:i}),0<v&&(t._modelManager.WTa=v),b}Object.defineProperty(e,"__esModule",{value:!0}),o=s("@grapecity/js-sheets-common"),n=s("./dist/core/util/domUtil.js"),T=s("./dist/core/util/common.js"),C=s("./dist/core/worksheet/worksheet.js"),r=s("@grapecity/js-calc"),A=!!r,i=s("./dist/core/core.ns.js"),a=new o.Common.ResourceManager(i.SR),S=a.getResource.bind(a),B=o.Common.l.Ra,b=o.Common.k,V=o.Common.j.Fa,z="boolean",W="string",G="number",M=void 0,n.GC$.extend(C.Worksheet.prototype,{sortRange:function(t,e,o,n,r,i,a,s,l){var u,c,h,f,p,d,g,m,y,b,v,C=this,w=C.getRowCount(),x=C.getColumnCount();if(-1===t&&(t=0),-1===o&&(o=w),-1===e&&(e=0),-1===n&&(n=x),t<0||w<=t||e<0||x<=e||o<0||w<t+o||n<0||x<e+n||!i)return!1;if(a=C.oec(T.kf(t,e,o,n),r,a),u=r?o:n,c=r?t:e,h=r?C.rowOutlines:C.columnOutlines,!s&&0<a.groupSort){if(!h)return!1;f=h.kec(c,u),r?(o=f.count,t=f.start):(n=f.count,e=f.start)}return A&&!C.Vq(t,e,o,n,!1)?(l&&C.Os(7,S().Exp_InvalidSortArrayFormulaInRange),!1):(p=C._modelManager.getSpans(T.kf(t,e,o,n)))&&0<p.length?(l&&C.Os(7,S().Exp_InvalidSortSpanInRange),!1):!(d=C.tables)||(m=1===(g=d.s$(t,e,o,n)).length&&g[0].dataRange().equals(T.kf(t,e,o,n)),g.length<=0||m)?(b=(y=C.wq)&&y.Ou||m&&g[0]&&g[0].LZ(),(v=function(t,e,o,n,r,i,a,s,l,u){var c,h,f,p,d,g;t.suspendPaint(),t.suspendEvent(),A&&t.suspendCalcService();try{if(u)for(h=[],f=e;f<e+n;f++)for(h[f]=[],p=o;p<o+r;p++)h[f][p]=t.getValue(f,p);return g=d=void 0,!!(d=l||(g=(0===s.groupSort?I:N)(t,e,o,n,r,i,a,s,h)).array)&&(c=R(t,g&&g.isChanged,e,o,n,r,i,a,u,d,h),!0)}finally{A&&t.resumeCalcService(!1),t.resumeEvent(),t.resumePaint(),t.Bu(e,o,n,r,c,4,M,M,M,!!l)}}(C,t,e,o,n,r,function(t,e){var o,n,r,i,a,s,l=[];for(o=0,n=e;o<n.length;o++)(r=n[o]).compareFunction?(i=r,l.push({index:i.index,ascending:i.ascending,compareFunction:i.compareFunction})):r.order&&r.hasOwnProperty("backColor")?(a="top"!==(i=r).order,s=V(i.backColor)?"":U(i.backColor,t.currentTheme()),l.push({index:i.index,ascending:a,color:s,isBackColor:!0})):r.order&&r.hasOwnProperty("fontColor")?(a="top"!==(i=r).order,s=V(i.fontColor)?"":U(i.fontColor,t.currentTheme()),l.push({index:i.index,ascending:a,color:s,isBackColor:!1})):(r.color&&(r.color=U(r.color,t.currentTheme())),l.push(r));return l}(C,i),a,s,b))&&0!==a.groupSort&&C.xr&&C.xr.reFilter(),v):(l&&C.Os(7,S().Exp_InvalidSortPartTableOrMultiTableInRange),!1)},oec:function(t,e,o){var n,r=this.Tq(t),i=e?r.rowCount:r.colCount,a=e?r.row:r.col,s=e?this.rowOutlines:this.columnOutlines;return V(o)&&(o={}),this.outlineColumn&&this.outlineColumn.ZQa()&&e&&(n=this.outlineColumn.YQa.columnIndex,r.col<=n&&n<=r.col+r.colCount||(o.groupSort=0)),V(o.groupSort)&&(V(o.ignoreHidden)?o.groupSort=s&&s.pec(a,i)?1:0:o.groupSort=0),0===o.groupSort?o.ignoreHidden=!!V(o.ignoreHidden)||o.ignoreHidden:o.ignoreHidden=!1,o},hK:function(){var t=this.options;return!t.isProtected||t.protectionOptions.allowSort},wja:function(t,e,o,n){var r=this.getDataValidator(t,e),i=this.getDataValidator(o,n);this.setDataValidator(t,e,i),this.setDataValidator(o,n,r)}})},"./dist/core/worksheet/worksheet-static.js":function(t,e,ie){"use strict";var o,ae,r,n,se,le,ue,ce,he,fe,pe,de,i,ge;function me(t,e){return t.getRowCount(e)}function ye(t,e){return t.getColumnCount(e)}function be(t,e,o){return t.$r(e,o)}function ve(t,e,o){return t.Yr(e,o)}function Ce(t,e,o,n){t.setColumnWidth(e,o,n)}function we(t,e,o,n){t.setRowHeight(e,o,n)}function xe(t,e,o,n){return t.getActualStyle(e,o,n)}function Te(t,e){return t.getDefaultStyle(e)}function Ae(t,e,o){t.setDefaultStyle(e,o)}function Se(t,e,o,n,r){t.Pq(e,o,n,r)}function Me(t,e,o,n){throw Error(r.Common.u.Kb(ge().Exp_InvalidAndSpace,[t,e,o,n]))}function Ie(t,e,o){return e&&o.Ps&&o.Ps(t)}function P(t){if(!t)return t;if("number"==typeof t||"string"==typeof t||"boolean"==typeof t||ue(t))return t;if(t.clone)return t.clone();if(t instanceof Date)return new Date(t.valueOf());var e,o,n;for(o in e=t instanceof Object?new t.constructor:new t.constructor(t.valueOf()),t)t.hasOwnProperty(o)&&(n=t[o],t.hasOwnProperty(o)&&e[o]!==n&&(e[o]="object"==typeof n?P(n):n));return e.toString=t.toString,e.valueOf=t.valueOf,e}function Ne(t,e,o,n,r,i,a,s,l,u){var c=!(t===n&&t.name()===n.name()),h=t._modelManager,f=h.zl(u);c?(function(t,e,o,n,r,i,a,s,l){var u,c,h,f,p,d,g,m,y,b=t.getSpans(fe,l),v=n.getSpans(fe,l),C=[];if(b)for(u=0;u<b.length;u++)h=(c=b[u]).row,f=c.col,p=c.rowCount,d=c.colCount,-1===e?o<=f&&f+d<=o+s&&C.push(ae.kf(h,i+f-o,p,d)):-1===o?e<=h&&h+p<=e+a&&C.push(ae.kf(r+h-e,f,p,d)):e<=h&&h<e+a&&o<=f&&f<o+s&&C.push(ae.kf(r+h-e,i+f-o,p,d));if(v)for(u=0;u<v.length;u++)h=(c=v[u]).row,g=i<=(f=c.col)&&f<i+s,m=r<=h&&h<r+a,(-1===e?g:-1===o?m:m&&g)&&((y=n.findSpan(h,f,l))&&y.row===h&&y.col===f&&n.do("removeSpan",y,l));for(u=0;u<C.length;u++)n.do("addSpan",C[u],l)}(h,e,o,n._modelManager,r,i,a,s,u),l&&f&&h.do("clearSpan",e,o,a,s,u)):l?h.do("moveSpan",e,o,r,i,a,s,u):h.do("copySpan",e,o,r,i,a,s,u)}function Re(t,e,o,n,r,i,a,s,l,u,c,h,f){var p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O=!(t===n&&t.name()===n.name()),F=!f&&n.KLc();if(2==(2&u)&&e<0)if(w=o,x=i,p=pe(me(t,1),me(n,1)),d=s,o<0&&(w=0,d=ye(t)),i<0&&(x=0),T=d,O)for(v=g=0;g<p&&g<me(n,1);g++)if(F&&0===n.getRowHeight(g,1))p++;else{for(C=m=0,d=T;m<d&&m<ye(n,1);m++)F&&0===n.getColumnWidth(x+m,1)?d++:(h(n,g,x+m,P(b=c(t,v,w+C,1)),1),C++);v++}else{for(y=new ae.KTa,g=0;g<p;g++)for(m=0;m<d;m++)b=c(t,g,w+m,1),ue(b)||y.set(g,m,P(b));for(v=g=0;g<p&&g<me(n,1);g++)if(F&&0===n.getRowHeight(g,1))p++;else{for(C=m=0,d=T;m<d&&m<ye(n,1);m++)F&&0===n.getColumnWidth(x+m,1)?d++:(h(n,g,x+m,y.get(v,C),1),C++);v++}}if(1==(1&u)&&o<0)if(A=e,S=r,p=a,d=pe(ye(t,2),ye(n,2)),e<0&&(A=0,p=me(t)),r<0&&(S=0),T=d,O)for(v=g=0;g<p&&g<me(n,2);g++)if(F&&0===n.getRowHeight(S+g,2))p++;else{for(C=m=0,d=T;m<d&&m<ye(n,2);m++)F&&0===n.getColumnWidth(m,2)?d++:(h(n,S+g,m,P(b=c(t,A+v,C,2)),2),C++);v++}else{for(y=new ae.KTa,g=0;g<p;g++)for(m=0;m<d;m++)b=c(t,A+g,m,2),ue(b)||y.set(g,m,P(b));for(v=g=0;g<p&&g<me(n,2);g++)if(F&&0===n.getRowHeight(S+g,2))p++;else{for(C=m=0,d=T;m<d&&m<ye(n,2);m++)F&&0===n.getColumnWidth(m,2)?d++:(h(n,S+g,m,y.get(v,C),2),C++);v++}}if(M=e,I=o,N=r,R=i,k=a,E=s,D=me(n),j=ye(n),e<0&&(M=0,k=pe(me(t),D)),o<0&&(I=0,E=pe(ye(t),j)),r<0&&(N=0),i<0&&(R=0),_=E,O)for(g=v=0;g<k&&N+g<D;g++)if(F&&0===n.getRowHeight(N+g))k++;else if(Ie(N+g,l,n))v++;else{for(m=C=0,E=_;m<E&&R+m<j;m++)F&&0===n.getColumnWidth(R+m)?E++:(h(n,N+g,R+m,P(b=c(t,M+v,I+C,3)),3),C++);v++}else{y=new ae.KTa;try{for(g=0;g<k;g++)for(m=0;m<E;m++)b=c(t,M+g,I+m,3),ue(b)||y.set(g,m,P(b));for(g=v=0;g<k&&N+g<D;g++)if(F&&0===n.getRowHeight(N+g))k++;else if(Ie(N+g,l,n))v++;else{for(m=C=0,E=_;m<E&&R+m<j;m++)F&&0===n.getColumnWidth(R+m)?E++:(h(n,N+g,R+m,y.get(v,C),3),C++);v++}}catch(t){}}}function ke(t,e,o,n,r,i,a,s,l,u,m,y,c){var b;m&&(b=ae.kf(e,o,a,s)),Re(t,e,o,n,r,i,a,s,l,u,function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p=3===n,d=t._modelManager,g={};return p?(i=(m||y)&&d.getDynamicArrayInfo(e,o))&&i.isValid?(r=he,m&&(g[a=[(f=i).row,f.col].join(",")]||(s=(g[a]=i).row,l=i.col,b.contains(s,l,1,1)&&d._getSheetModel(3).yIb(i)))):r=t.getValue(e,o,n,1):(r=d.getValue(e,o,n,!0,1),1===n&&ue(r)&&((u=t.wq)&&u.Ou&&(c=d.Jp(!1,3,o),h=t.options.colHeaderAutoTextIndex,c&&(0<=h&&e===h||-1===h&&e===me(t,n)-1)&&(r=c.displayName||c.name)))),m&&(p?t.uq(e,o,he,n,!1):t._modelManager.do("setValue",e,o,he,n,!0,!0)),r},function(t,e,o,n,r){ue(n)?t.uq(e,o,he,r,!1):t.uq(e,o,n,r,!1)},c)}function Ee(t,e,o){var n,r,i,a=t.Tq(e),s=a.row,l=a.col,u=a.rowCount,c=a.colCount;for(n=0;n<u;n++)for(r=o[s+n]=o[s+n]||{},i=0;i<c;i++)r[l+i]=!0}function De(t,e){return t===e&&t.name()===e.name()}function je(t){t.forEach(function(t){var e=t.sheet,o=t.r,n=t.c,r=t.value;e.setBindingPath&&e.setBindingPath(o,n,r)})}function f(t,e,o,n,r,i,a,s,l,u,c,h,f,p){var d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J,Z,q,K,Y,Q,X,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ht,ft,pt,dt,gt,mt,yt,bt,vt,Ct,wt,xt,Tt,At,St,Mt,It,Nt,Rt,kt,Et,Dt,jt,_t,Ot,Ft,Pt,Lt,Ht,Bt,Vt,zt,Wt,Gt,Ut,Jt,Zt,qt,Kt,Yt,Qt,Xt,$t,te,ee,oe,ne,re;if(function(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d,g;if(!t)throw Error(ge().Exp_SrcIsNull);if(!n)throw Error(ge().Exp_DestIsNull);l=me(t),u=ye(t),c=me(n),h=ye(n),(e<-1||l<=e)&&Me("from row index",e,"-1",l-1),(o<-1||u<=o)&&Me("from column index",o,"-1",u-1),(r<-1||c<=r)&&Me("to row index",r,"-1",c-1),(i<-1||h<=i)&&Me("to column index",i,"-1",h-1),(f=o)<0&&(f=0,s=u),p=i<0?0:i,(s<1||u<f+s||h<p+s)&&Me("column count",s,"1",pe(u-f,h-p)),(d=e)<0&&(d=0,a=l),g=r<0?0:r,(a<1||l<d+a||c<g+a)&&Me("row count",a,"1",pe(l-d,c-g))}(t,e,o,n,r,i,a,s),0<(1&l)&&0<(2&l)&&((b=t.pivotTables)&&(y=b.dB(ae.kf(de(0,e),de(0,o),e<0?pe(me(t),me(n)):a,o<0?pe(ye(t),ye(n)):s),h))),h&&e<0)for(m=s,(g=o)<0&&(g=0,m=pe(ye(t),ye(n))),(v=i)<0&&(v=0),d=!0,C=0;C<m;C++)w=t._modelManager.Jp(!1,3,g+C),x=t._modelManager.Jp(!1,3,v+C),T=w&&w.name,A=x&&x.name,w&&x&&T&&A||(d=!1),(x=le.GC$.extend(!0,{},n._modelManager.Jp(!1,3,v+C)||{})).displayName=w&&w.displayName,x.name=w&&w.name,n._modelManager.do("setItem",!1,3,v+C,x);0<(64&l)&&(function(t,e,o,n,r,i,a,s,l,u,c,h,f){var p,d,g,m,y,b,v={};if(t.tables)for(p=ae.kf(e,o,a,s),d=ae.kf(r,i,a,s),m=void 0,y=0,b=(g=t.tables.all()).length;y<b;y++)m=g[y].range(),p.containsRange(m)?Ee(t,m,v):m.containsRange(p)&&m.containsRange(d)?Ee(t,p,v):m.intersect(p.row,p.col,p.rowCount,p.colCount)&&m.containsRange(d)&&Ee(t,m.getIntersect(p),v);Re(t,e,o,n,r,i,a,s,l,u,function(t,e,o,n){var r=(3===n||ue(n))&&v[e]&&v[e][o],i=t.getCompositeStyle(e,o,n,fe,fe,fe,fe,r,fe,fe,h);return c&&Se(t,e,o,he,n),i},function(t,e,o,n,r){Se(t,e,o,n,r)},f)}(t,e,o,n,r,i,a,s,u,c,h,f,p),t.dJb||t.uja&&function(r,t,e,i,o,n,a,s,l,u,c){var h,f,p,d=r.uja.Dja;for(h in d)(f=d[h])&&((p=f.condition())&&p.initExpression());Re(r,t,e,i,o,n,a,s,l,0,function(t,e,o){var n=t.getDataValidator(e,o,3);return n&&(u&&t.setDataValidator(e,o,he),De(r,i)&&(n.Nja=!0)),n},function(t,e,o,n){t.setDataValidator(e,o,n),De(r,i)&&n&&delete n.Nja},c)}(t,e,o,n,r,i,a,s,u,h,p)),0<(512&l)&&(B=e,V=o,z=n,W=r,G=i,U=a,J=s,Z=h,q=p,Y=(H=t).conditionalFormats,Q=z.conditionalFormats,X=De(H,z),Y&&Q&&!H.dJb&&(K=Y.XA(B,V,Q,W,G,U,J,X,q),Z&&Y.YA(B,V,U,J,K,X))),0<(1&l)&&0<(2&l)&&((M=t.tables)&&(S=M.dB(ae.kf(de(0,e),de(0,o),e<0?pe(me(t),me(n)):a,o<0?pe(ye(t),ye(n)):s),h))),(I=se)&&(t.suspendCalcService(),n.suspendCalcService()),N=[],R=he,k=[],0<(256&l)&&(N=(R=function(a,s,l,t,e,o,n,r,i,u,c){var h,f,p,d,g,m,y,b,v=[],C=[],w={},x={},T=!c&&t.KLc();if(T){for(h=n,f=r,h+=t.MLc(e,h,!0),f+=t.MLc(o,f),p=t.getRowCount(),d=t.getColumnCount(),m=g=0;g<h&&g+e<p;g++)0!==t.getRowHeight(e+g)&&(w[m]=g,m++);for(b=y=0;y<f&&y+o<d;y++)0!==t.getColumnWidth(o+y)&&(x[b]=y,b++)}return Re(a,s,l,t,e,o,n,r,i,0,function(t,e,o){var n,r,i=t.getBindingPath&&t.getBindingPath(e,o);return i&&(n=e-de(0,s),r=o-de(0,l),T&&(n=w[n],r=x[r]),v.push({row:n,col:r,value:t.getValue(e,o)})),u&&a.setBindingPath&&a.setBindingPath(e,o,he),i},function(t,e,o,n){C.push({sheet:t,r:e,c:o,value:n})},c),{savedValues:v,bindingPathInfos:C}}(t,e,o,n,r,i,a,s,u,h,p)).savedValues,k=R.bindingPathInfos);try{if(E=n.pivotTables,0<(1&l)&&0<(2&l)&&E&&E.eB(y,t,de(0,e),de(0,o),n,de(0,r),de(0,i),a,s,h),0<(1&l)&&!d){if(ke(t,e,o,n,r,i,a,s,u,c,h,0<(2&l),p),h&&n.Wq("shiftCellsDown",{row:r,col:i,changedRowCount:r-e,changedColCount:i-o},!0),je(k),se&&0==(2&l)&&n.clearFormula(r,i,a,s,function(t,e){return!u||!t.Ps||!t.Ps(e)}),0<(256&l))for(D=N.length,j=r<0?0:r,_=i<0?0:i,O=0;O<D;O++)F=N[O],!h&&Ie(j+F.row,u,n)||n.setValue(j+F.row,_+F.col,F.value)}else je(k);P=n.tables,0<(1&l)&&0<(2&l)&&P&&P.eB(S,de(0,e),de(0,o),de(0,r),de(0,i),h),se&&(h?(function(n,r,i,a,s,l,u,c){var h,f,p,d,t,g,e,o,m,y=ie("SheetsCalc");if(y){if(h=y.uyb,d=n._modelManager.dUa(),!n.parent||!n.parent.sheets)return(t=n.getCustomNames())&&ce(t,function(t,e){f=e.getExpression(),(p=h(n,n,r,i,a,s,l,u,c,f))!==f&&e.fg(p,d)});for(g=n.parent.sheets,(e=n.parent.getCustomNames())&&ce(e,function(t,e){f=e.getExpression(),(p=h(null,n,r,i,a,s,l,u,c,f))!==f&&e.fg(p,d)}),o=function(o){var t=g[o].getCustomNames();t&&ce(t,function(t,e){f=e.getExpression(),(p=h(g[o],n,r,i,a,s,l,u,c,f))!==f&&e.fg(p,d)})},m=0;m<g.length;m++)o(m)}}(t,e,o,n,r,i,a,s),0<(2&l)&&($=t,tt=e,et=o,ot=n,nt=r,rt=i,it=a,at=s,(st=ie("SheetsCalc"))&&st.CalcOperatorAdjustor.moveFormula($,tt,et,ot,nt,rt,it,at))):0<(2&l)&&((L=ie("SheetsCalc"))&&L.vyb(t,e,o,n,r,i,a,s,u,p)),0<(1&l)&&0<(2&l)&&P&&P.R3(S))}finally{I&&(t.resumeCalcService(!1),n.resumeCalcService(!1))}if(0<(4&l)&&(re=h,Re(t,e,o,n,r,i,a,s,u,0,function(t,e,o){var n=t._modelManager.Ky,r=n&&n.get(e,o);return r&&re&&n.remove(e,o),r},function(t,e,o,n){var r=t._modelManager.Ky;r&&r.Cz(e,o,n)},p)),0<(128&l)&&(ne=h,Re(t,e,o,oe=n,r,i,a,s,u,c,function(t,e,o,n){var r=t.getTag(e,o,n);return!ue(r)&&ne&&t.setTag(e,o,fe),r},function(t,e,o,n,r){oe.setTag(e,o,n,r)},p)),0<(1024&l)&&(ee=h,Re(t,e,o,te=n,r,i,a,s,u,c,function(t,e,o,n){var r=t.getHyperlink&&t.getHyperlink(e,o,n);return!ue(r)&&ee&&t.setHyperlink&&t.setHyperlink(e,o,fe),r},function(t,e,o,n,r){te.setHyperlink&&te.setHyperlink(e,o,n,r)},p)),0<(16&l)&&(Wt=t,Ut=o,Jt=n,Zt=r,qt=i,Kt=a,Yt=s,Qt=h,Xt=p,(Gt=e)<0&&(Gt=0,Kt=pe(me(Wt),me(Jt))),Zt<0&&(Zt=0),Ut<0&&(Ut=0,Yt=pe(ye(Wt),ye(Jt))),qt<0&&(qt=0),!(Wt===Jt&&Wt.name()===Jt.name())?($t=Jt.ZA)&&(Qt?0<Wt.ZA.count()&&$t.$A(Wt,Gt,Ut,Zt,qt,Kt,Yt):$t._A(Wt,Gt,Ut,Zt,qt,Kt,Yt,fe,Xt)):($t=Wt.ZA)&&(Qt?0<$t.count()&&$t.aB(Gt,Ut,Zt,qt,Kt,Yt):$t.Zz(Gt,Ut,Zt,qt,Kt,Yt,fe,Xt))),0<(8&l)&&(e<0&&(Ot=t,Pt=n,Lt=i,Ht=s,Bt=h,(Ft=o)<0&&(Ft=0,Ht=pe(ye(Ot),ye(Pt))),Lt<0&&(Lt=0),Vt=Ot.columnOutlines,zt=Pt.columnOutlines,!(Ot===Pt&&Ot.name()===Pt.name())?Vt&&zt&&zt.bB(Vt,Ft,Lt,Ht,Bt):Vt&&Vt.cB(Ft,Lt,Ht,Bt)),o<0&&(Mt=t,Nt=n,Rt=r,kt=a,Et=h,(It=e)<0&&(It=0,kt=pe(me(Mt),me(Nt))),Rt<0&&(Rt=0),Dt=!(Mt===Nt&&Mt.name()===Nt.name()),jt=Mt.rowOutlines,_t=Nt.rowOutlines,Dt?jt&&_t&&_t.bB(jt,It,Rt,kt,Et):jt&&jt.cB(It,Rt,kt,Et))),0<(32&l)&&(h||1!==a||1!==s)&&(gt=t,bt=n,vt=r,Ct=i,wt=a,xt=s,Tt=h,St=yt=o,(At=mt=e)<0&&(At=0,wt=pe(me(gt),me(bt))),vt<0&&(vt=0),St<0&&(St=0,xt=pe(ye(gt),ye(bt))),Ct<0&&(Ct=0),mt<0&&Ne(gt,-1,St,bt,-1,Ct,-1,xt,Tt,1),yt<0&&Ne(gt,At,-1,bt,vt,-1,wt,-1,Tt,2),Ne(gt,At,St,bt,vt,Ct,wt,xt,Tt)),e<0&&r<=0&&function(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d,g,m,y,b,v;for(e<0&&(e=0,r=pe(ye(t),ye(o))),n<0&&(n=0),l=!s&&o.KLc(),c=u=0;u<r&&u<ye(o,1);u++)l&&0===o.getColumnWidth(n+u)?r++:(0<(64&i)&&(h=be(t,c+e),ue(h)||(a&&Ce(t,u+e,t.defaults.colWidth),Ce(o,u+n,h)),f=t.getColumnVisible(c+e),ue(f)||(a&&t.setColumnVisible(u+e,!0),o.setColumnVisible(u+n,f)),(p=xe(t,-1,c+e))?(Se(o,-1,u+n,p.clone()),a&&Se(t,-1,u+e,he)):Se(o,-1,u+n,he),(p=xe(t,-1,c+e,1))?(Se(o,-1,u+n,p.clone(),1),a&&Se(t,-1,u+e,he,1)):Se(o,-1,u+n,he,1)),0<(128&i)&&(d=t.getTag(-1,c+e),ue(d)||(a&&t.setTag(-1,u+e,fe),o.setTag(-1,u+n,d))),c++);for(g=me(o,1),m=pe(me(t,1),g),b=y=0;y<m&&y<g;y++)l&&0===o.getRowHeight(y,1)?m++:(v=ve(t,b,1),ue(v)||(a&&we(t,y,t.defaults.colHeaderRowHeight,1),we(o,y,v,1)),b++)}(t,o,n,i,s,l,h,p),o<0&&i<=0&&function(t,e,o,n,r,i,a,s,l){var u,c,h,f,p,d,g,m,y,b,v,C;for(e<0&&(e=0,r=pe(me(t),me(o))),n<0&&(n=0),u=!l&&o.KLc(),h=c=0;c<r&&n+c<me(o,2);c++)u&&0===o.getRowHeight(n+c)?r++:(!s&&Ie(n+c,a,o)||(0<(64&i)&&(f=ve(t,h+e),ue(f)||(s&&we(t,c+e,t.defaults.rowHeight),we(o,c+n,f)),p=t.getRowVisible(h+e),ue(p)||(s&&t.setRowVisible(c+e,!0),o.setRowVisible(c+n,p)),(d=xe(t,h+e,-1))?(Se(o,c+n,-1,d.clone()),s&&Se(t,c+e,-1,he)):Se(o,c+n,-1,he),(d=xe(t,h+e,-1,2))?(Se(o,c+n,-1,d.clone(),2),s&&Se(t,c+e,-1,he,2)):Se(o,c+n,-1,he,2)),0<(128&i)&&(g=t.getTag(h+e,-1),ue(g)||(s&&t.setTag(c+e,-1,fe),o.setTag(c+n,-1,g)))),h++);for(m=ye(o,2),y=pe(ye(t,2),m),v=b=0;b<y&&b<m;b++)u&&0===o.getColumnWidth(b,2)?y++:(C=be(t,v,2),ue(C)||(s&&Ce(t,b,t.defaults.rowHeaderColWidth,2),Ce(o,b,C,2)),v++)}(t,e,n,r,a,l,u,h,p),e<0&&r<=0&&o<0&&i<=0&&(ct=l,ht=h,(lt=t)===(ut=n)&&lt.name()===ut.name()||(0<(64&ct)&&(ft=Te(lt),Ae(ut,ht?ft:ft.clone()),ft=Te(lt,1),Ae(ut,ht?ft:ft.clone(),1),ft=Te(lt,2),Ae(ut,ht?ft:ft.clone(),2),ht&&(Ae(lt,he),Ae(lt,he,1),Ae(lt,he,2))),pt=ut.defaults,dt=lt.defaults,pt.colWidth=dt.colWidth,pt.rowHeight=dt.rowHeight,pt.rowHeaderColWidth=dt.rowHeaderColWidth,pt.colHeaderRowHeight=dt.colHeaderRowHeight,ht&&(dt.colWidth=62,dt.rowHeight=20,dt.rowHeaderColWidth=40,dt.colHeaderRowHeight=20))),h&&e<0)for(m=s,(g=o)<0&&(g=0,m=pe(ye(t),ye(n))),C=0;C<m;C++)t.getDataColumnName&&t.getDataColumnName(g+C)&&t._modelManager.do("setItem",!1,3,g+C,he)}Object.defineProperty(e,"__esModule",{value:!0}),o=ie("./dist/core/core.ns.js"),ae=ie("./dist/core/util/common.js"),r=ie("@grapecity/js-sheets-common"),n=ie("@grapecity/js-calc"),se=!!n,le=ie("./dist/core/util/domUtil.js"),ue=r.Common.j.Fa,ce=le.GC$.each,he=null,fe=void 0,pe=Math.min,de=Math.max,i=new r.Common.ResourceManager(o.SR),ge=i.getResource.bind(i),e.staticMembers={copyTo:function(t,e,o,n,r,i,a,s,l,u,c,h){f(t,e,o,n,r,i,a,s,l,u,c,!1,fe,h)},moveTo:function(t,e,o,n,r,i,a,s,l,u){f(t,e,o,n,r,i,a,s,l,fe,3,!0,u)}}},"./dist/core/worksheet/worksheet-ui.js":function(t,e,u){"use strict";var o,d,n,g,r,i,a,s,c,m,y,b,l,h;function v(t){return Math.abs(t)}function f(t,e){var s=t,l=e;return function(t){var e,o,n=this.sheet,r=this.row,i=this.col,a=this.sheetArea;if(0===arguments.length)return s.call(n,r,i,a);if(0<=r&&0<=i)for(e=r;e<r+this.rowCount;e++)for(o=i;o<i+this.colCount;o++)C(n,e,o,a)&&l.call(n,e,o,t,a);return this}}function C(t,e,o,n){var r=t.getRowCount(n),i=t.getColumnCount(n);return o<0&&0<=e&&e<r||e<0&&0<=o&&o<i||0<=e&&e<r&&0<=o&&o<i||-1===e&&-1===o}function p(t,e,o,n,r,i){var a,s,l,u,c,h,f,p;C(t,e,o,i)&&("string"==typeof(a=(a=t.Aj(e,o,i))||new d.Style)&&(s=a,(a=new d.Style).parentName=s),"font"===n&&(u=r,b((l=a).themeFont)||(c=m(),h=c.style,f=l.font,h.font=f,p=f&&h.fontFamily,((h.font=u)&&h.fontFamily)!==p&&(l.themeFont=y))),a[n]=r,t.setStyle(e,o,a,i))}function w(t,e,o,n,r,i){e<0&&(e=n=-1),o<0&&(o=r=-1),this.sheet=t,this.row=e,this.rowCount=b(n)?1:n,this.col=o,this.colCount=b(r)?1:r,this.sheetArea=b(i)?3:i}function x(t){var e,o,n,r,i,a,s,l,u,c,h,f,p=t.split(":"),d=p[0],g=p[1],m=/([A-Z]+)(\d+)?(\D+)?/;if(isNaN(+d)){if((n=d.match(m))[3])return null;e=n[1],o=n[2]}else o=d;if(d&&!g){if(e&&o)return[r=T(o),A(e),1,1]}else if(d&&g){if(a=i=void 0,isNaN(+g)){if((s=g.match(m))[3])return null;i=s[1],a=s[2]}else a=g;if(!e&&o&&!i&&a)return l=T(o),u=T(a),[r=Math.min(l,u),-1,c=v(l-u)+1,-1];if(e&&!o&&i&&!a)return h=A(e),f=A(i),[-1,Math.min(h,f),-1,v(h-f)+1];if(e&&o&&i&&a)return l=T(o),u=T(a),h=A(e),f=A(i),r=Math.min(l,u),c=v(l-u)+1,[r,Math.min(h,f),c,v(h-f)+1]}return null}function T(t){return parseInt(t,10)-1}function A(t){var e,o,n=0,r=t.length;for(e=0;e<r;e++)o=t[e].charCodeAt(0)-64,n+=Math.pow(26,r-e-1)*o;return n-1}Object.defineProperty(e,"__esModule",{value:!0}),o=u("./dist/core/worksheet/worksheet.js"),d=u("./dist/core/worksheet/style.js"),n=u("./dist/core/util/domUtil.js"),g=u("./dist/core/util/common.js"),r=u("@grapecity/js-sheets-common"),i=u("./dist/core/core.enum.js"),a=u("@grapecity/js-calc"),s=u("./dist/core/worksheet/clipboardhelper.js"),c=!!a,m=g.util.tt,y=void 0,b=r.Common.j.Fa,l=o.Worksheet.prototype,w.prototype.tag=function(t){var e,o,n=this.sheet,r=this.row,i=this.col,a=this.rowCount,s=this.colCount,l=this.sheetArea;if(0===arguments.length)return n.getTag(r,i,l);if(0<=r&&0<=i)for(e=r;e<r+a;e++)for(o=i;o<i+s;o++)n.setTag(e,o,t,l);else if(0<=r)for(e=r;e<r+a;e++)n.setTag(e,-1,t,l);else if(0<=i)for(o=i;o<i+s;o++)n.setTag(-1,o,t,l);return this},w.prototype.width=function(t){var e,o=this.sheet,n=this.row,r=this.col,i=this.sheetArea;if(0!==arguments.length){if(n<0)for(e=0;e<this.colCount;e++)o.setColumnWidth(e+r,t,i);return this}if(n<0)return o.getColumnWidth(r,i)},w.prototype.height=function(t){var e,o=this.sheet,n=this.row,r=this.col,i=this.sheetArea;if(0!==arguments.length){if(r<0)for(e=0;e<this.rowCount;e++)o.setRowHeight(e+n,t,i);return this}if(r<0)return o.getRowHeight(n,i)},w.prototype.visible=function(t){var e,o,n=this.sheet,r=this.row,i=this.col,a=this.sheetArea;if(0===arguments.length)return i<0&&0<=r?n.getRowVisible(r,a):0<=i&&r<0?n.getColumnVisible(i,a):void 0;if(i<0&&0<=r)for(e=0;e<this.rowCount;e++)n.setRowVisible(e+r,t,a);else if(0<=i&&r<0)for(o=0;o<this.colCount;o++)n.setColumnVisible(o+i,t,a);return this},w.prototype.resizable=function(t){var e,o,n=this.sheet,r=this.row,i=this.col,a=this.sheetArea;if(0===arguments.length)return i<0&&0<=r?n.getRowResizable(r,a):0<=i&&r<0?n.getColumnResizable(i,a):void 0;if(i<0&&0<=r)for(e=0;e<this.rowCount;e++)n.setRowResizable(e+r,t,a);else if(0<=i&&r<0)for(o=0;o<this.colCount;o++)n.setColumnResizable(o+i,t,a);return this},w.prototype.tq=function(t){return this.sheet.tq(this.row,this.col,t,this.sheetArea)},w.prototype._w=function(t,e){var o,n,r=this.sheet,i=this.row,a=this.col,s=this.rowCount,l=this.colCount,u=this.sheetArea;if(r.suspendPaint(),0<=i&&0<=a)for(o=i;o<i+s;o++)for(n=a;n<a+l;n++)p(r,o,n,t,e,u);else if(0<=i)for(n=-1,o=i;o<i+s;o++)p(r,o,n,t,e,u);else if(0<=a)for(o=-1,n=a;n<a+l;n++)p(r,o,n,t,e,u);else-1===i&&-1===a&&-1===s&&-1===l&&p(r,o=-1,n=-1,t,e,u);return r.resumePaint(),this},w.prototype.clear=function(t){this.sheet.clear(this.row,this.col,this.rowCount,this.colCount,this.sheetArea,t)},w.prototype.setBorder=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p=this.sheet,d=this.sheetArea;p.suspendPaint();try{if(o=new g.Range(this.row,this.col,this.rowCount,this.colCount),r=(n=p.Tq(o,d)).row,i=n.col,a=n.rowCount,s=n.colCount,u=l=void 0,c=e.all,h=e.outline,f=e.inside,e.left||c||h)for(l=0;l<a;l++)p.getCell(r+l,i,d).borderLeft(t);if(e.top||c||h)for(u=0;u<s;u++)p.getCell(r,i+u,d).borderTop(t);if(e.right||c||h)for(l=0;l<a;l++)p.getCell(r+l,i+s-1,d).borderRight(t);if(e.bottom||c||h)for(u=0;u<s;u++)p.getCell(r+a-1,i+u,d).borderBottom(t);if(e.diagonalUp)for(l=0;l<a;l++)for(u=0;u<s;u++)p.getCell(r+l,i+u,d).diagonalUp(t);if(e.diagonalDown)for(l=0;l<a;l++)for(u=0;u<s;u++)p.getCell(r+l,i+u,d).diagonalDown(t);if(e.innerHorizontal||c||f)for(l=0;l<a-1;l++)for(u=0;u<s;u++)p.getCell(r+l,i+u,d).borderBottom(t),p.getCell(r+l+1,i+u,d).borderTop(t);if(e.innerVertical||c||f)for(u=0;u<s-1;u++)for(l=0;l<a;l++)p.getCell(r+l,i+u,d).borderRight(t),p.getCell(r+l,i+u+1,d).borderLeft(t)}finally{p.resumePaint()}},w.prototype.toHtml=function(t,e){return void 0===t&&(t=i.HeaderOptions.noHeaders),void 0===e&&(e=!0),this.sheetArea===i.SheetArea.corner?"":s.S4.Q4(this.sheet,t,this.row,this.rowCount,this.col,this.colCount,this.sheetArea,e,[],[],!0,!0,e,!0)},w.Pl=f,h=w,(e.CellRange=h).prototype.value=f(l.getValue,l.setValue),h.prototype.text=f(l.getText,l.setText),h.prototype.formula=f(function(t,e){return c&&this.getFormula(t,e)},function(t,e,o,n){c&&this.setFormula(t,e,o,n)}),h.prototype.styleName=f(l.getStyleName,l.setStyleName),n.GC$.each(["backColor","foreColor","hAlign","vAlign","themeFont","font","formatter","borderLeft","borderTop","borderRight","borderBottom","diagonalDown","diagonalUp","locked","textIndent","wordWrap","showEllipsis","shrinkToFit","backgroundImage","backgroundImageLayout","cellType","tabStop","textDecoration","imeMode","watermark","cellPadding","labelOptions","quotePrefix","isVerticalText","cellButtons","dropDowns","textOrientation"],function(t,e){h.prototype[e]=function(t){return 0===arguments.length?this.tq(e):this._w(e,t)}}),e.Hgc=x,e.Igc=A,n.GC$.extend(l,{getRange:function(){var t,e,o,n,r,i,a,s,l=arguments[0];if("string"==typeof l){if(i=l.toUpperCase(),this.parent&&1===this.parent.options.referenceStyle)return null;if(r=arguments[1],1<(i=i.replace(/[^\:]+\!/g,"").replace(/\$/g,"")).split(",").length)return null;if(c){if(!(a=u("SheetsCalc").formulaToRange(this,i,y,y,r)))return null;t=a.row,e=a.col,o=a.rowCount,n=a.colCount}else{if(!(s=x(i)))return null;t=s[0],e=s[1],o=s[2],n=s[3]}}else"number"==typeof l&&(t=l,e=arguments[1],o=arguments[2],n=arguments[3],r=arguments[4]);return new h(this,t,e,o,n,r)},getCell:function(t,e,o){return b(e)&&(e=-1),new h(this,t,e,1,1,o)}})},"./dist/core/worksheet/worksheet.js":function(t,e,c){"use strict";var o,L,n,r,H,E,h,i,f,a,R,B,s,S,p,l,u,d,V,z,g,m,y,b,v,C,w,x,T,A,M,I,N,k,D,W,G,j,_,O,F,P,U,J,Z,q,K,Y,Q,X,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ht;function ft(t,e){var o,n,r,i,a=[],s=t._modelManager.hUa();if(s)for(o in s)if(w(s,o)&&((n=s[o])&&(e||"n"!==n.rs||(r={row:+o,item:t.getDataItem&&t.getDataItem(+o)},a.push(r)),e&&"e"===n.rs)))for(i in n)if(!D(i)&&n[i]){(r={row:+o,item:t.getDataItem&&t.getDataItem(+o)}).originalItem=n.originalItem,a.push(r);break}return a}function pt(t,e,o){var n,r=0;for(n=e;n<=o;n++)r+=t._m(n);return r}function dt(t,e,o){var n,r=0;for(n=e;n<=o;n++)r+=t.Sl(n);return r}function gt(t){return t.getColumnCount()}function mt(t){return t.getRowCount()}function yt(t){return t.frozenTrailingColumnCount()}function bt(t){return t.frozenTrailingRowCount()}function vt(t){return t.qKc}function Ct(t){return t.tKc}function wt(t){return t.frozenColumnCount()}function xt(t){return t.frozenRowCount()}function Tt(t,o,n){Object.defineProperty(t,o,{get:function(){return this["_"+o]},set:function(t){var e=this["_"+o];e!==t&&(this["_"+o]=t,n&&n(o,t,e))}})}function At(t,e,o,n){return{row:e,col:o,newValue:t.getValue(e,o),oldValue:n}}function St(t){var n=this;n._id=St.Np,St.Np++,n.options=y(st,function(t,e,o){n.Op(t,e,o)}),n.ad(t),n.fgc=new r.Tasks(function(){return this.tasks.pop()},function(){var t=n.parent;return t&&t.ku.Gw||n._eventHandler._isWorking||n._eventHandler.xG||n._eventHandler.eG})}Object.defineProperty(e,"__esModule",{value:!0}),o=c("./dist/core/core.ns.js"),L=c("./dist/core/util/common.js"),n=c("./dist/core/util/imageLoader.js"),r=c("./dist/core/util/tasks.js"),H=c("./dist/core/worksheet/style.js"),E=c("./dist/core/worksheet/worksheet-model.js"),h=c("./dist/core/util/domUtil.js"),i=c("./dist/core/celltype/textcelltype.js"),f=c("@grapecity/js-calc"),a=c("./dist/core/celltype/headercelltype.js"),R=c("./dist/core/core.enum.js"),B=c("@grapecity/js-sheets-common"),s=c("@grapecity/js-calc"),S=!!s,l=c("./dist/core/util/theme.js"),u=c("./dist/core/worksheet/stylehelper.js"),d=L.util.n0a,V=L.util.lHb,z=B.Common.j.Fa,g=L.util.Nl,m=L.util.Pl,y=L.util.Ql,b=L.util.bq,v=h.GC$.each,C=h.GC$.isEmptyObject,w=B.Common.D,x=L.util.x0a,T=L.util.w0a,A=RegExp("^\\d*(\\.\\d+)?\\*$"),M=B.Common.u,I=document,N=parseInt,k=parseFloat,D=isNaN,W=null,G=void 0,j=Math.min,_=Math.max,O=Math.floor,F=Math.ceil,P=Math.abs,U=Math.round,J="undefined",Z="string",q="width",K="height",Y="tag",Q="onLayoutChanged",X="onPaintSuspend",$="isVisible",tt="resizable",et=".gcSheet",ot=".gcSheetInternal",nt={backColor:!0,foreColor:!0,font:!0,borderLeft:!0,borderTop:!0,borderRight:!0,borderBottom:!0,textDecoration:!0,cellType:!0,formatter:!0},rt=new B.Common.ResourceManager(o.SR),it=rt.getResource.bind(rt),(ct=at=e.ClearPendingChangeType||(e.ClearPendingChangeType={}))[ct.dirty=1]="dirty",ct[ct.insert=2]="insert",ct[ct.delete=4]="delete",(ht=e.InvalidType||(e.InvalidType={}))[ht.setFormula=0]="setFormula",ht[ht.copyPaste=1]="copyPaste",ht[ht.dragFill=2]="dragFill",ht[ht.dragDrop=3]="dragDrop",ht[ht.changePartOfArrayFormula=4]="changePartOfArrayFormula",ht[ht.changeSheetName=5]="changeSheetName",ht[ht.table=6]="table",ht[ht.hideSheet=7]="hideSheet",ht[ht.pivotTable=8]="pivotTable",ht[ht.PTOverlapPT=9]="PTOverlapPT",st={rowHeaderVisible:!0,colHeaderVisible:!0,clipBoardOptions:0,frozenlineColor:"black",rowHeaderAutoText:1,colHeaderAutoText:2,rowHeaderAutoTextIndex:-1,colHeaderAutoTextIndex:-1,sheetTabColor:W,selectionBackColor:W,selectionBorderColor:W,allowCellOverflow:!0,showFormulas:!1,isProtected:!1,protectionOptions:{},gridline:{},sheetAreaOffset:{left:0,top:0}},St.prototype.sortRange=function(t,e,o,n,r,i,a,s,l){return!1},St.prototype.Op=function(t,o,e){var n,r,i,a,s=this,l=s.parent;switch(t){case"allowCellOverflow":case"showFormulas":case"colHeaderAutoText":case"colHeaderAutoTextIndex":case"colHeaderVisible":case"frozenlineColor":case"rowHeaderAutoText":case"rowHeaderAutoTextIndex":case"rowHeaderVisible":case"selectionBackColor":case"selectionBorderColor":s.$p();break;case"sheetAreaOffset":n=function(t,e){e<0&&(s.options.sheetAreaOffset[t]=0),s.$p()},r=s.options.sheetAreaOffset,["left","top"].forEach(function(t){var e=o[t];Tt(r,t,n),r[t]=e});break;case"gridline":i=function(){s.$p()},a=s.options.gridline,["color","showHorizontalGridline","showVerticalGridline"].forEach(function(t){var e=o[t];Tt(a,t,i),a[t]=e});break;case"isProtected":o&&l&&l.undoManager().PY(function(t){return t.sheetId!==s._id}),s._p(),St.ao(s,"onProtectChanged"),s.$p();break;case"protectionOptions":s._p(),St.ao(s,"onProtectChanged");break;case"sheetTabColor":l&&l.aq()}},St.prototype.name=function(t){var e=this.parent;if(0===arguments.length)return this._modelManager?this._modelManager.getName():"";if(!b(t,e?e.sheets:null,this))throw it().Exp_NotSupported;return this.cq(t),e&&e.aq(),this},St.prototype.isSelected=function(t){return this.DHb(t)},St.prototype.DHb=function(t,e){var o,n,r,i=this.parent,a=!!this._modelManager&&this._modelManager.TIb();return z(t)?a:(t!==a&&(o=this.name(),n=i&&i.getSheetIndex(o),r=void 0,e&&(r={oldValue:a,newValue:t,sheetName:o,propertyName:"isSelected",cancel:!1,sheetIndex:n},i&&i.Wq(L.Events.SheetChanging,r)),(!e||r&&!1===r.cancel)&&(this._modelManager.CHb(t),i&&i.YJc&&i.YJc.repaint(),e&&i&&i.Wq(L.Events.SheetChanged,{oldValue:a,newValue:t,sheetName:o,propertyName:"isSelected",sheetIndex:n}))),this)},St.prototype.cq=function(t,e){var o=this.name();e||St.ao(this,"beforeSetName",{oldName:o,newName:t}),this._modelManager.do("setName",t),e||St.ao(this,"setName",{oldName:o,newName:t})},St.prototype.addRows=function(t,e,o){var n,r,i,a;if(!(e<=0)){r=mt(n=this),(t<0||r<t)&&(t=r),0===n._modelManager.WTa&&n.parent&&n.parent.pv.clear(),n.suspendPaint();try{if(n.eJb(!1),i={changeType:"addingRows",row:t,rowCount:e,canAdd:!0},St.ao(n,Q,i),!i.canAdd)return;if(z(i.newRow)||(t=i.newRow),a="addRows",!n.pCb(t,3,a,e,r))return;this._modelManager.do("addRows",t,e),n.jq=!0,St.ao(n,Q,{changeType:a,row:t,oldValue:r,rowCount:e,rowExpand:o}),St.ao(n,Q,{changeType:"addRows2",row:t,oldValue:r,rowCount:e}),n.tables&&n.tables.Cec(!0,t),n.kq(t,3,a,e,r)}finally{n.eJb(!0),n.resumePaint()}}},St.prototype.eJb=function(t){var e=this.Jl,o=this.Kl;this._modelManager.setCellState(e,o,R.CellStatesType.active,t,R.SheetArea.viewport)},St.prototype.deleteRows=function(t,e){var o,n,r,i,a,s,l,u=this,c=mt(u);if(!(t<0||c<=t||e<=0)){0===u._modelManager.WTa&&u.parent&&u.parent.pv.clear(),u.suspendPaint();try{if(u.eJb(!1),o={changeType:"deletingRows",row:t,rowCount:e,canDelete:!0},St.ao(u,Q,o),!o.canDelete)return;if(n="deleteRows",!u.pCb(t,3,n,e,c))return;if(u.RIb(t,e,0,this.getColumnCount()),u._modelManager.do("deleteRows",t,e),0<=(r=u.lq)){for(i=-1,a=xt(u),s=r;a<=s;s--)if(u.getRowVisible(s)&&0<u.Sl(s)){i=s;break}-1===i&&(i=0),r!==i&&u.mq(i)}l=c,u.getActiveRowIndex()>=l&&u.setActiveCell(l-1,u.getActiveColumnIndex()),u.jq=!0,St.ao(u,Q,{changeType:n,row:t,oldValue:c,rowCount:e}),u.tables&&u.tables.Cec(!0,t),u.kq(t,3,n,e,c)}finally{u.eJb(!0),u.resumePaint()}}},St.prototype.addColumns=function(t,e){var o,n,r,i;e<=0||(n=gt(o=this),(t<0||n<t)&&(t=n),0===o._modelManager.WTa&&o.parent&&o.parent.pv.clear(),r={changeType:"addingColumns",col:t,colCount:e,canAdd:!0},St.ao(o,Q,r),r.canAdd&&(o.eJb(!1),i="addColumns",o.qCb(t,3,i,e,n)&&(o._modelManager.do("addColumns",t,e),o.oq=!0,St.ao(o,Q,{changeType:i,col:t,oldValue:n,colCount:e}),St.ao(o,Q,{changeType:"addColumns2",col:t,oldValue:n,colCount:e}),o.tables&&o.tables.Cec(!1,t),o.pq(t,3,i,e,n),o.eJb(!0),o.$p())))},St.prototype.deleteColumns=function(t,e){var o,n,r,i,a,s,l,u=this,c=gt(u);if(!(t<0||c<=t||e<=0)&&(0===u._modelManager.WTa&&u.parent&&u.parent.pv.clear(),o={changeType:"deletingColumns",col:t,colCount:e,canDelete:!0},St.ao(u,Q,o),o.canDelete&&(u.eJb(!1),n="deleteColumns",u.RIb(0,this.getRowCount(),t,e),u.qCb(t,3,n,e,c)))){if(u._modelManager.do("deleteColumns",t,e),0<=(r=u.qq)){for(i=-1,a=wt(u),s=r;a<=s;s--)if(u.getColumnVisible(s)&&0<u.Tl(s)){i=s;break}-1===i&&(i=0),r!==i&&u.rq(i)}l=c,u.getActiveColumnIndex()>=l&&u.setActiveCell(u.getActiveRowIndex(),l-1),u.oq=!0,St.ao(u,Q,{changeType:n,col:t,oldValue:c,colCount:e}),St.ao(u,Q,{changeType:"deleteColumns2",col:t,oldValue:c,colCount:e}),u.tables&&u.tables.Cec(!1,t),u.pq(t,3,n,e,c),u.eJb(!0),u.$p()}},St.prototype.frozenTrailingRowCount=function(t,e){return 0===arguments.length?this.aMc:(0<=t&&(z(e)&&(e=!0),this.aMc=t,this.qKc=e,this.jq=!0,this.$p()),this)},St.prototype.frozenTrailingColumnCount=function(t,e){return 0===arguments.length?this.bMc:(0<=t&&(z(e)&&(e=!0),this.bMc=t,this.tKc=e,this.oq=!0,this.$p()),this)},St.prototype.getFrozenTrailingState=function(t){return t?this.qKc:this.tKc},St.prototype.rKc=function(t){var e=Ct(this),o=t.er;return e?o+t.sKc:o},St.prototype.oKc=function(t){var e=vt(this),o=t.jr;return e?o+t.pKc:o},St.prototype.getRowCount=function(t){return 0===t?0:this._modelManager.getRowCount(t)},St.prototype.getColumnCount=function(t){return 0===t?0:this._modelManager.getColumnCount(t)},St.prototype.setRowCount=function(t,e){var o;z(e)&&(e=3),o={changeType:"settingRowCount",rowCount:t,sheetArea:e,canSet:!0},St.ao(this,Q,o),o.canSet&&this.setRowCountCore(t,e)},St.prototype.setRowCountCore=function(t,e){var o,n;t=N(t,10),D(t)||(z(e)&&(e=3),n=(o=this).getRowCount(e),t<0||t===n||(3===e||2===e?(o._modelManager.do("setRowCount",t,e),xt(o)>t&&o.frozenRowCount(t)):1===e&&o._modelManager.do("setRowCount",t,e),St.ao(o,Q,{changeType:"setRowCount",rowCount:t,sheetArea:e}),o.jq=!0,o.Jl>=t&&(3===e||2===e)&&o.setActiveCell(t-1,o.getActiveColumnIndex()),o.$p(),o.clearPendingChanges()))},St.prototype.setColumnCount=function(t,e){var o,n;t=N(t,10),D(t)||(n=(o=this).getColumnCount(e),t<0||t===n||(z(e)&&(e=3),3===e||1===e?(o._modelManager.do("setColumnCount",t,e),wt(o)>t&&o.frozenColumnCount(t)):2===e&&o._modelManager.do("setColumnCount",t,e),St.ao(o,Q,{changeType:"setColumnCount",colCount:t,sheetArea:e}),o.oq=!0,o.Kl>=t&&(3===e||1===e)&&o.setActiveCell(o.getActiveRowIndex(),t-1),o.$p(),o.clearPendingChanges()))},St.prototype.aHb=function(t,e,o){var n,r;return(p=p||c("SheetsCalc"))&&(n="string"==typeof o&&this.parent&&this.parent.aJb(o))&&-1!==t&&-1!==e?(r=n.getExpression(),p.evaluateExpression(this,r,t,e)):G},St.prototype.xHb=function(t,e,o){var n;if(this.options.showFormulas&&3===o){if(n=this.getFormula(t,e))return"="!==n[0]&&(n="="+n),n;if(this._modelManager&&this._modelManager.ZHb&&this._modelManager.ZHb.getAnchorInfo(t,e))return""}},St.prototype.getText=function(t,e,o){var n,r,i,a,s,l;return z(o)&&(o=3),n=this.xHb(t,e,o),z(n)?(r=this.getCellType(t,e,o),i=this.getValue(t,e,o),a=(a=this.tq(t,e,"formatter",o))||this.tq(t,e,"_autoFormatter",o),s={},l=this.tq(t,e,"quotePrefix",o),(i=r.format(i,a,s,{sheet:this,row:t,col:e,sheetArea:o,quotePrefix:l}))&&"string"==typeof i&&(i=i.replace(/\r\n?/g,"\n")),i):n},St.prototype.setText=function(t,e,o,n){var r,i,a,s,l,u;z(n)&&(n=3),i={value:r=o},St.ao(this,"settingText",i),a=o=i.value,s=this.getCellType(t,e,n),l=this.getFormatter&&this.getFormatter(t,e,n),s&&l&&!V(l)&&(u={sheet:this,row:t,col:e,sheetArea:n},a=s.parse(r,l,u),a=z(a)?o:a),this.uq(t,e,a,n),this.$p()},St.prototype.getValue=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d;return 0===o?W:(z(o)&&(o=3),r=this.options,a=(i=this._modelManager).getRowCount(o),s=i.getColumnCount(o),l=this.vq(i,t,e,o,n),1===o?z(l)&&((c=this.wq)&&c.Ou&&(h=this._modelManager.Jp(!1,3,e),f=r.colHeaderAutoTextIndex,h&&(0<=f&&t===f||-1===f&&t===a-1)&&(l=h.displayName||h.name)),z(l)&&(((u=r.colHeaderAutoTextIndex)<0||a<=u)&&(u=a-1),t===u&&(2===(p=r.colHeaderAutoText)?l=L.util.xq(e+1):1===p&&(l=e+1)))):2===o&&z(l)&&(((u=r.rowHeaderAutoTextIndex)<0||s<=u)&&(u=s-1),e===u&&(2===(d=r.rowHeaderAutoText)?l=L.util.xq(t+1):1===d&&(l=t+1))),l)},St.prototype.setValue=function(t,e,o,n,r){this.uq(t,e,o,n,r);var i=this.parent,a=i&&i.getActiveSheet();a&&!0===a.cJc?a.$p():this.$p(),function(t){var e,o,n,r;if(t)for(o=(e=t.sheets).length,r=0;r<o;r++)!0===(n=e[r]).cJc&&delete n.cJc}(i)},St.prototype.eyb=function(t,e,o,n){!n&&S&&this.zq(t,e,o),this.t4&&this.t4(t,e,1,1,o)},St.prototype.fyb=function(){var t=this.conditionalFormats;t&&t.Nm()},St.prototype.WXc=function(t,a,s){if(t&&t.parent&&t.parent.sheets){var e=t.parent.sheets,l=t.name();e.forEach(function(i){var t=i.cameraShapes;t&&0<t.length&&t.forEach(function(t){var e,o,n,r;if(t.cameraImageCache&&(o=(e=t.Fmb).znb.kWc)&&(i.name()===l||o.sheet&&o.sheet.name()===l))for(n=0;n<a.length;n++){if(r=o.cellRange,void 0!==a[n].row&&void 0===a[n].col&&2===s&&a[n].row>=r.row&&a[n].row<r.row+r.rowCount){t.cameraImageCache=null,e.znb.nWc&&e.qnb();break}if(void 0===a[n].row&&void 0!==a[n].col&&1===s&&a[n].col>=r.col&&a[n].col<r.col+r.colCount){t.cameraImageCache=null,e.znb.nWc&&e.qnb();break}if(0===s){if(void 0===a[n].rowCount&&void 0===a[n].colCount&&r.contains(a[n].row,a[n].col)){t.cameraImageCache=null;break}if(void 0!==a[n].rowCount&&void 0!==a[n].colCount&&r.intersect(a[n].row,a[n].col,a[n].rowCount,a[n].colCount)){t.cameraImageCache=null;break}}}})})}},St.prototype.uq=function(t,e,o,n,r){var i,a,s;0!==n&&(z(n)&&(n=3),a=(i=this._modelManager).getRowCount(n),s=i.getColumnCount(n),t<0||a<=t||e<0||s<=e||(o=x(o),o=d(o),i.do("setValue",t,e,o,n),this.eyb(t,e,n,r),this.fyb()))},St.prototype.AHb=function(t,e,o,n,r,i){var a;return a=this.getActualStyle(t,e,o,n,r,i),function(t,e,o,n,r){if((-1!==e||-1!==o)&&(z(r)&&(r=3),3===r)){var i=t.tables&&t.tables.find(e,o);i&&i.NZ&&e===i.footerIndex()&&lt.ao(t,"composeTableFooterList",{table:i,row:e,col:o,style:n})}}(this,t,e,a,o),a},St.prototype.getActualStyle=function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P;if(z(o)&&(o=3),0===o)return new H.Style;if(-1===t&&-1===e)return this.getDefaultStyle(o);if(f=(a=this).Cq,w="__spreadJSDefault",x="__undefined",T=this._modelManager,3===o&&a.pivotTables&&(S=(A=a.pivotTables.findPivotTable(t,e)||W)&&A.HPc(t,e)),u=T.getStyle(t,e,o),c=T.getStyle(t,-1,o),h=T.getStyle(-1,e,o),u=u||W,c=c||W,h=h||W,b=x,M=a.parent&&a.parent.GBb,u&&(b=u.charAt?u:w+u._id),v=x,c&&(v=c.charAt?c:w+c._id),C=x,h&&(C=h.charAt?h:w+h._id),p=(y=f[o])[b],I=a.tables,(N=3===o&&I&&!i?I.find(t,e):W)||A||((g=(p=p||(y[b]={}))[v])?m=g[C]:g=p[v]={}),m||(l=a.getCompositeStyle(t,e,o,u,c,h,N,G,i,S,G,A)),3===o&&!n&&((R=a.conditionalFormats)&&(s=R.Eq(s,t,e,o)),(z(s)||z(s.foreColor))&&(k=s&&s.formatter||m&&m.formatter||l&&l.formatter)&&!i&&!V(k))){try{B.Formatter&&B.Formatter.GeneralFormatter&&typeof k==Z&&(k=L.mn.tn(k))}catch(t){}(k.hasFormatedColor&&k.hasFormatedColor()||B.Formatter&&k instanceof B.Formatter.FormatterBase)&&(E={conditionalForeColor:W},k.format(a.getValue(t,e),E),E.conditionalForeColor&&(z(s)&&(s=new H.Style),s.foreColor=E.conditionalForeColor))}if(s)d=m||l,s.Yo(d),s&&s.font&&d&&d.font&&s.font!==d.font&&(s.font=(_=s,O=d,F=L.util.Pxb(_.font),P=L.util.Pxb(O.font),F.fontStyle+" "+F.fontWeight+" "+P.fontSize+" "+P.fontFamily)),l=s;else if(m)return!a.cellStates||n||M||(D=a.cellStates.getStyle(t,e,o,W,m.locked))&&(D.Yo(m),(m=D).Zo(a.Pm)),r?m:m.clone(!0);return z(l.locked)&&(l.locked=!0),l=l.Zo(a.Pm),s||N||A||(g[C]=l.clone(!0)),!a.cellStates||n||M||(j=a.cellStates.getStyle(t,e,o,W,l.locked))&&(j.Yo(l),l=(l=j).Zo(a.Pm)),l},St.prototype.tq=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y;if(0===n)return G;if(z(n)&&(n=3),s=this._modelManager,u=!1,3===n){if("foreColor"===o){h=this.tq(t,e,"formatter",n);try{B.Formatter&&B.Formatter.GeneralFormatter&&typeof h==Z&&(h=L.mn.tn(h))}catch(t){}h&&(h.hasFormatedColor&&h.hasFormatedColor()||B.Formatter&&h instanceof B.Formatter.FormatterBase)&&(f={conditionalForeColor:W},h.format(this.getValue(t,e),f),f.conditionalForeColor&&(l=f.conditionalForeColor,u=!0))}(p=this.conditionalFormats)&&0<p.count()&&(u=(d=p.Fq(t,e,o,n)).v5,l=d.Fi)}for(g=0;!u&&g<=4;)if(0===g?r=s.getStyle(t,e,n):1===g?(m=this.tables,(y=3===n&&m?m.find(t,e):W)&&nt[o]&&(r=y.Gq(t,e,o))):r=2===g?s.getStyle(t,-1,n):3===g?s.getStyle(-1,e,n):this.getDefaultStyle(n),g++,r&&r.charAt&&typeof r==Z&&(r=this.Hq(r)),r){if("font"===o&&r.themeFont&&!c&&(c=r.themeFont),r[o]!==G){l=r[o],u=!0;break}for(i=r.parentName;i&&(a=this.Hq(i));){if(a[o]!==G){l=a[o],u=!0;break}i=a.parentName}}return"locked"===o?!!z(l)||l:u||c?("foreColor"!==o&&"backColor"!==o&&"font"!==o&&"borderLeft"!==o&&"borderTop"!==o&&"borderRight"!==o&&"borderBottom"!==o||((r=new H.Style)[o]=l,"font"===o&&c&&(r.themeFont=c),r.Zo(this.Pm),l=r[o]),l):G},St.prototype.getStyle=function(t,e,o){return this.Iq(t,e,o,!0)},St.prototype.Iq=function(t,e,o,n){var r,i,a;if(z(o)&&(o=3),0!==o){if((r=this._modelManager.getStyle(t,e,o))instanceof H.Style)return n&&this.Jq(),r;if(typeof r==Z&&(i=this.Hq(r))!==W&&i!==G)return(a=new H.Style).Yo(i,!1),n&&this.Jq(),a}return W},St.prototype.addNamedStyle=function(t){this.Kq(t),this.$p()},St.prototype.Kq=function(t){if(t){if(!t.name)throw Error(it().Exp_EmptyNamedStyle);var e=t.name.toUpperCase();this.Lq[e]=t}},St.prototype.getNamedStyle=function(t){return this.Mq(t,!0)},St.prototype.Mq=function(t,e){var o,n=this.Lq;return n&&t?((o=n[t=t.toUpperCase()])&&e&&this.Jq(),o):W},St.prototype.Jq=function(){this.Cq=[{},{},{},{}]},St.prototype.removeNamedStyle=function(t){var e,o=this.Lq;o&&t&&(t=t.toUpperCase(),w(o,t)&&((e=o[t].formatter)&&"string"==typeof e&&this.parent.QHb[e]&&this.parent.RHb(e),delete o[t],this.Jq(),this.$p()))},St.prototype.getNamedStyles=function(){var o=[],t=this.Lq;return t&&v(t,function(t,e){o.push(e)}),this.Jq(),o},St.prototype.setStyle=function(t,e,o,n){var r;z(n)&&(n=3),o&&o.backColor&&"object"==typeof o.backColor&&u.To.processStops(o.backColor),this.Nq(t,e,o,n),-1===t&&-1===e&&(this.Oq[n]=W),-1!==t&&-1!==e||(r=o&&o.validator)&&r.condition()&&4===r.condition().conType()&&r.condition().getExpected(this,t<0?0:t,e<0?0:e),this.Jq(),this.$p()},St.prototype.Pq=function(t,e,o,n){var r,i;this.options.isProtected?(r=this.getStyle(t,e,n),i=void 0,o?(i=r?r.locked:G,o.locked!==i&&(o.locked=i),this.setStyle(t,e,o,n)):r&&((i=r.locked)!==G&&((o=new H.Style).locked=i),this.setStyle(t,e,o,n))):this.setStyle(t,e,o,n)},St.prototype.getStyleName=function(t,e,o){var n=this.Aj(t,e,o);return n instanceof H.Style?n.name:n},St.prototype.setStyleName=function(t,e,o,n){typeof o==Z&&(this.Nq(t,e,o,n),this.$p())},St.prototype.Aj=function(t,e,o){var n;return z(o)&&(o=3),0!==o&&(n=this._modelManager.getStyle(t,e,o)),n||W},St.prototype.getNamedStyleName=function(t,e,o){var n=this.Aj(t,e,o);return"string"==typeof n?n:G},St.prototype.Nq=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d;if(z(n)&&(n=3),0!==n){if(i=(r=this).Aj(t,e,n),s=(a=r._modelManager).getRowCount(n),l=a.getColumnCount(n),t<-1||s<=t||e<-1||l<=e)return;u=o,c=a.getStyle(t,e,n),typeof u==Z&&(u=r.Hq(u)),(h=u&&u.formatter)&&V(h)&&r.fJb(t,e,h),a.do("setStyle",t,e,o,n),f=i&&i.cellType&&i.cellType.typeName||W,p=o&&o.cellType&&o.cellType.typeName||W,t===r.Jl&&e===r.Kl&&f!==p&&L.Vl.Wl(r)&&r._eventHandler.Qq(),d="[styleinfo]",-1!==t&&-1!==e?r.Bq(d,t,e,n,c,o):-1!==t&&-1===e?r.kq(t,n,d,o,c):-1===t&&-1!==e&&r.pq(e,n,d,o,c)}},St.prototype.fJb=function(t,e,o){var n,r,i,a,s,l,u;if(p=p||c("SheetsCalc")){if(-1===t&&(t=0),-1===e&&(e=0),n=this.getCell(t,e,3),r=p.rangeToFormula(n,t,e,3),"="===(i=o.trim()).charAt(0)&&0<=i.indexOf("@")&&(i=i.replace(/@/g,r)),0<=i.indexOf("{{")&&0<=i.indexOf("}}")){for(""===(a=i.split(/{{|}}/))[0]&&a.shift(),""===a[a.length-1]&&a.pop(),s=0;s<a.length;s++)-1===a[s].indexOf("=")?a[s]='"'+a[s]+'"':(0<=a[s].indexOf("@")&&(a[s]=a[s].replace(/@/g,r)),(l=p.evaluateFormula(this,a[s]))instanceof f.CalcError?a[s]='"'+l+'"':a[s]=a[s].replace(/=/g,""));i="=CONCAT("+a.join(",")+")"}(u=this.parent).aJb(o)||u.Yu(u.QHb,o,i,t,e,!0,"")}},St.prototype.getDefaultStyle=function(t){var e,o,n,r,i,a;return z(t)&&(t=3),(o=(e=this.Oq)[t])?o:0!==t?(typeof(r=(n=this._modelManager).getStyle(-1,-1,t))==Z&&(r=this.Hq(r)),r||(r=new H.Style,n.do("setStyle",-1,-1,r,t)),i=1===t||2===t,typeof(r=r).hAlign==J&&(r.hAlign=i?1:3),typeof r.vAlign==J&&(r.vAlign=i?1:0),typeof r.imeMode==J&&(r.imeMode=1),r.font||typeof r.themeFont!=J||(r.themeFont="Body"),e[t]=r):((a=new H.Style).locked=!0,e[t]=a)},St.prototype.setDefaultStyle=function(t,e){z(e)&&(e=3),0!==e&&this._modelManager.do("setStyle",-1,-1,t,e),this.Oq[e]=W,this.Jq(),this.$p()},St.prototype.Hq=function(t){var e,o=this.Mq(t,!1);return o||((e=this.parent)?e.Mq(t,!1):W)},St.prototype.getCompositeStyle=function(t,e,o,n,r,i,a,s,l,u,c,h){var f,p,d,g,m,y,b,v,C,w,x,T,A;if(z(o)&&(o=3),f=this,p=new H.Style,d=!1,0!==o){if(y=f._modelManager,b=f.tables,v=f.pivotTables,C=y.getRowCount(o),w=y.getColumnCount(o),x=void 0,0<=t&&t<C&&0<=e&&e<w&&((x=n!==G?n:y.getStyle(t,e,o))&&x.charAt&&(x=f.Hq(x)),x))for(p.Yo(x,!0,10),d=!0,m=x.parentName;m&&(g=f.Hq(m));)p.Yo(g,!1,10,!0),m=g.parentName;if(s)return p;if(a!==G||l||(a=3===o&&b?b.find(t,e):W),a&&!l&&(a.Yo(t,e,p),d=!0),h!==G||l||(u=(h=3===o&&v?v.findPivotTable(t,e):W)&&h.HPc(t,e)),u&&(u&&u.parentName&&(T=f.Hq(u.parentName))&&u.Yo(T),u.Yo(p),p=u,d=!0),h&&(h.MPc(t,e,p),d=!0),0<=t&&t<C&&((x=r!==G?r:y.getStyle(t,-1,o))&&x.charAt&&(x=f.Hq(x)),x))for(p.Yo(x,!d,30),d=!0,m=x.parentName;m&&(g=f.Hq(m));)p.Yo(g,!1,30,!0),m=g.parentName;if(0<=e&&e<w&&((x=i!==G?i:y.getStyle(-1,e,o))&&x.charAt&&(x=f.Hq(x)),x))for(p.Yo(x,!d,40),d=!0,m=x.parentName;m&&(g=f.Hq(m));)p.Yo(g,!1,40,!0),m=g.parentName}if((A=f.getDefaultStyle(o))&&A.charAt&&(A=f.Hq(A)),A&&!c)for(p.Yo(A,!d,50),m=A.parentName;m&&(g=f.Hq(m));)p.Yo(g,!1,50,!0),m=g.parentName;return p},St.prototype.getCellType=function(t,e,o){return this.tq(t,e,"cellType",o)||this.Al(o)},St.prototype.Al=function(t){z(t)&&(t=3);var e=this.Rq;return e=e||(this.Rq=new i.Text),3===t?e:1===t?new a.ColumnHeader:2===t?new a.RowHeader:0===t?new a.Corner:e},St.prototype.setCellType=function(t,e,o,n){var r=this.Iq(t,e,n);(r=r||new H.Style).cellType=o,this.setStyle(t,e,r,n)},St.prototype.Sq=function(t,e,o,n,r){var i,a,s,l,u,c;if(z(r)&&(r=3),(i=this._modelManager).do("clearSpan",t,e,o,n,r),a=L.kf(t,e,o,n),s=this.Tq(a,r),l=this.Fia(s,r),i.do("addSpan",l,r),3===r){for(u=this.getSelections(),c=0;c<u.length;c++)u[c].intersect(t,e,o,n)&&(u[c]=u[c].union(a));i.do("setSelections",u)}this.$p()},St.prototype.Fia=function(t,e){var o=this.getRowCount(e),n=this.getColumnCount(e),r=t.row,i=t.col,a=t.rowCount,s=t.colCount;return o<r+a&&(a=o-r),n<i+s&&(s=n-i),L.kf(r,i,a,s)},St.prototype.addSpan=function(t,e,o,n,r){var i,a,s,l,u=this;if((1!==o||1!==n)&&0!==r&&(i=u.getRowCount(r),a=u.getColumnCount(r),!(i<=t||a<=e||t<-1||e<-1)&&(s=!0,S&&(3===r||z(r))&&(s=u.Vq(t,e,o,n,!1),u.pivotTables&&(s=s&&u.pivotTables.MOc(t,e,o,n))),s))){if(u._modelManager.qu(t,e,o,n,r))throw Error(it().Exp_InvalidRange);u.wyb&&u.wyb(t,e,o,n),u.Sq(t,e,o,n,r),l={sheet:u,row:t,col:e,rowCount:o,colCount:n,sheetArea:r,changeType:"addSpan"},St.ao(u,Q,l),u.Wq("spanChanged",l)}},St.prototype.removeSpan=function(t,e,o){var n,r,i;z(o)&&(o=3),(r=(n=this._modelManager).findSpan(t,e,o))&&r.row===t&&r.col===e&&n.do("removeSpan",r,o),i={sheet:this,row:t,col:e,sheetArea:o,changeType:"removeSpan"},St.ao(this,Q,i),this.Wq("spanChanged",i),this.$p()},St.prototype.getSpans=function(t,e){return 0===e?[]:this._modelManager.getSpans(t,e,!0)},St.prototype.getSpan=function(t,e,o){return 0===o?W:this._modelManager.findSpan(t,e,o)},St.prototype.repaint=function(t){this.Xq<=0&&this._render&&this._render.repaint(t)},St.prototype.ULc=function(t,e){void 0===e&&(e=1);var o=this.cm(new L.Range(t,-1,e,-1));--o.y,o.height+=1,this.repaint(o)},St.prototype.VLc=function(t,e){void 0===e&&(e=1);var o=this.cm(new L.Range(-1,t,-1,e));--o.x,o.width+=1,this.repaint(o)},St.prototype.Yq=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v=this,C=v.parent,w=C&&C.options.scrollbarAppearance===R.ScrollbarAppearance.mobile,x=!1,T=!1,A=C&&C.options.scrollByPixel,S=xt(v),M=wt(v),I=M?v.Zq(M-1):v.$q(),N=S?v._q(S-1):v.ar();if(e<v.qq&&I<=e?(x=!0,v.rq(v.br(e+1),0)):A&&e===v.qq&&0!==v.eCb&&(x=!0,v.rq(e,0)),e>v.cr()&&e<=v.dr()){for(o=0,n=e,r=v.am(),i=v.rKc(r),(a=v._modelManager.findSpan(t,n))&&(n=a.col+a.colCount-1);n>v.qq&&!(i<(o+=v.Tl(n)));)n--;l=s=void 0,l=A?(n===v.qq&&o<i&&(o+=v.Tl(n)),s=n,i-o):(s=v.Zq(n),0),x=!0,v.rq(s,l)}if(t<v.lq&&N<=t?(T=!0,v.mq(v.gr(t+1),0)):A&&t===v.lq&&0!==v.cCb&&(T=!0,v.mq(t,0)),t>v.hr()&&t<=v.ir()){for(u=0,c=t,(h=v._modelManager.findSpan(c,e))&&(c=h.row+h.rowCount-1),f=v.am(),p=v.oKc(f);c>v.lq&&!(p<(u+=v.Sl(c)));)c--;g=d=void 0,g=A?(c===v.lq&&u<p&&(u+=v.Sl(c)),d=c,p-u):(d=v._q(c),0),T=!0,v.mq(d,g)}A||e!==v.dr()||v.rq(v.lr(),0),w&&(m=C.nKc,y=C.kKc,b=C.ku,T&&(m.Jwa(R.ScrollbarState.show),b.Rdc(!0)),x&&(y.Jwa(R.ScrollbarState.show),b.Rdc(!1)))},St.prototype.hitTest=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R=this;if(R.am(),r={x:t,y:e},i=R.rowOutlines,a=R.columnOutlines,i&&(s=i.hitTest(R,t,e)),!s&&a&&(s=a.hitTest(R,t,e)),s)r.outlineHitInfo=s;else{if(l=R.nr(e),u=R.or(t),r.rowViewportIndex=l,r.colViewportIndex=u,r.row=R.pr(e,l),r.col=R.qr(t,u),0<=l&&l<=2&&0<=u&&(c=R.rr(l,u,G,r.row,r.col))&&!0!==o&&(r.row=c.row,r.col=c.col),r.hitTestType=R.sr(l,u),h=R._eventHandler,p=(f=R.xr)&&f.hitTest(r,t,e),g=void 0,(d=R.tables)&&(g=-1===r.rowViewportIndex?d&&d.find(R.getActiveRowIndex(),R.getActiveColumnIndex()):d.find(r.row,r.col)),p=p||(m=g&&g.xr)&&m.hitTest(r,t,e),y=d&&!p&&d.gJb(t,e,r))return(r.tableSelectInfo=y).table&&y.table.xr&&(r.filterButtonHitInfo=p),r;(b=h.Yia&&h.Yia(r,t,e))?r.dragMergeInfo=b:(v=h.tr&&h.tr(r,t,e))?r.dragInfo=v:(C=h.ur(r,t,e,5))?r.resizeInfo=C:(w=h.vr?h.vr(r,t,e):W)?r.formulaRangeHitInfo=w:(T=(x=R._modelManager.Ky)&&x.hitTest(t,e))?r.commentHitInfo=T:(S=(A=R.wr)&&A.hitTest(t,e,n),M=void 0,R.shapes&&(M=R.shapes.hitTest(t,e)),M?r.shapeHitInfo=M:S?r.floatingObjectHitInfo=S:p?r.filterButtonHitInfo=p:(I=g&&!g.hJb()&&h.iJb&&h.iJb(r,g))?r.resizeTableHitInfo=I:r.cellTypeHitInfo=R.yr(r,t,e))}return N=R.pivotTables&&R.pivotTables.findPivotTable(r.row,r.col),z(N)||(r.pivotTableInfo=N),r},St.prototype.getCellRect=function(t,e,o,n,r){var i,a,s,l,u,c=3;return-1===o?c=1:-1===n&&(c=2),i=this.am(),-1===o&&-1===n?new L.Rect(i.zr,i.Ar,i.Br,i.Cr):(a=this.Dr(),z(o)&&(o=this.Er(t)),z(n)&&(n=this.Fr(e)),s=this.Gr(o,c).findRow(t),l=this.Hr(n,c).findCol(e),(u=this.Ir(o,n,c,r).findCell(t,e))?new L.Rect(u.x-a.x,u.y-a.y,u.width,u.height):s&&l?new L.Rect(l.x-a.x,s.y-a.y,l.width,s.height):new L.Rect)},St.prototype.Jr=function(t,e,o){var n,r,i,a,s,l,u,c=this,h=c._eventHandler,f=!1,p=c.Jl,d=c.Kl;z(t)||(c.Jl=t,f=!0),z(e)||(c.Kl=e,f=!0),r=(n=c.QLc)&&n.isEnable(R.StatesType.active,!0),i=n&&n.isEnable(R.StatesType.active,!1),r&&(c.ULc(p),c.ULc(t)),i&&(c.VLc(d),c.VLc(e)),c._modelManager.setCellState(p,d,R.CellStatesType.active,!1,R.SheetArea.viewport),r||i||c.xIb&&c.xIb(R.CellStatesType.active,p,d,R.SheetArea.viewport),c._modelManager.setCellState(t,e,R.CellStatesType.active,!0,R.SheetArea.viewport),r||i||c.xIb&&c.xIb(R.CellStatesType.active,t,e,R.SheetArea.viewport),!o&&h&&f&&(h.Qq(),(s=(a=c._modelManager).getDynamicArrayInfo(t,e))!==(l=a.WIb)&&(a.WIb=s,c.Xq<=0&&(u=void 0,u=s&&l?L.getUnionRange(s,l):(s=s||l,L.kf(s.row,s.col,s.rowCount,s.colCount)),c._render.im(u))))},St.prototype.gCb=function(t,e,o,n,r){var i=t.getCellRect(e,o,n,r),a=i.x,s=i.y,l=i.width,u=i.height;return i.x=a-2,i.y=s-2,i.width=l+4,i.height=u+4,i},St.prototype.Kr=function(t,e,o,n,r){var i,a=this,s=a.Jl,l=a.Kl,u=a._modelManager,c=u.getSpan(t,e);a.Lr=c.rowCount,a.Mr=c.colCount,a.Xq<=0&&(i=u.getSpan(s,l),a._render.im(L.kf(s,l,i.rowCount,i.colCount))),a.Nr=o,a.Pr=n,a.Jr(t,e,r),a.Qr=t,a.Rr=e},St.prototype.setActiveCell=function(t,e,o,n){this.Sr(t,e,o,n,2)},St.prototype.Sr=function(t,e,o,n,r){var i,a,s=mt(this),l=gt(this);t<0?t=0:s<=t&&(t=_(0,s-1)),e<0?e=0:l<=e&&(e=_(0,l-1)),this.Tr(),i=2===r?L.Vl.Wl(this):1===r,this.Kr(t,e,o,n,!i),a=this._modelManager.getSpan(t,e),this.Ur(a.row,a.col,a.rowCount,a.colCount),this.$p()},St.prototype.getActiveRowIndex=function(){return this.Jl},St.prototype.getActiveColumnIndex=function(){return this.Kl},St.prototype.getRowResizable=function(t,e){return this._modelManager.getResizable(!0,e,t)},St.prototype.setRowResizable=function(t,e,o){this.Vr(t,e,tt,!0,o)},St.prototype.Vr=function(t,e,o,n,r){var i,a,s;switch(z(r)&&(r=3),o!==K&&o!==q||!A.test(e)||(o="starSize"),i=this._modelManager,o){case tt:a=i.getResizable(n,r,t);break;case"pageBreak":a=i.getPageBreak(n,r,t);break;case $:a=i.getVisible(n,r,t);break;case K:a=i.getSize(n,r,t);break;case q:a=i.getSize(n,r,t)}if(!(s=n?this.pCb(t,r,o,e,a):this.qCb(t,r,o,e,a)))return s;switch(o){case tt:i.do("setResizable",n,r,t,e);break;case"pageBreak":i.do("setPageBreak",n,r,t,e);break;case $:i.do("setVisible",n,r,t,e),n&&S&&3===r&&a!==e&&this.recalcRows([t]);break;case K:i.do("setSize",n,r,t,e),!S||3!==r||a===e||0!==a&&0!==e||this.recalcRows([t]);break;case q:i.do("setSize",n,r,t,e),!S||3!==r||a===e||0!==a&&0!==e||this.recalcCols([t]);break;case"starSize":i.do("setStarSize",n,r,t,e)}return n?this.kq(t,r,o,e,a):this.pq(t,r,o,e,a),!0},St.prototype.getColumnResizable=function(t,e){return this._modelManager.getResizable(!1,e,t)},St.prototype.setColumnResizable=function(t,e,o){this.Vr(t,e,tt,!1,o)},St.prototype.getRowHeight=function(t,e,o){var n,r,i,a,s,l;if(z(e)&&(e=3),o)return this._modelManager.getStarSize(!0,e,t);if(3===e||2===e){if(n=this.getRowCount(e),t<0||n<=t)return 0;for(r=this.Wr,i=0;i<r.length;i++)if(!r[i].Xr(t))return 0}return s=(a=this.defaults).rowHeight,1===e&&(s=a.colHeaderRowHeight),(l=this._modelManager.getSize(!0,e,t))||0===l?l:O(s)},St.prototype.Yr=function(t,e){var o,n,r;return z(e)&&(e=3),n=(o=this.defaults).rowHeight,1===e&&(n=o.colHeaderRowHeight),(r=this._modelManager.getActualSize(!0,e,t))||0===r?r:O(n)},St.prototype.setRowHeight=function(t,e,o){this.Vr(t,e,K,!0,o)&&(this.jq=!0,this.$p())},St.prototype.getRowVisible=function(t,e,o){var n,r;if(z(e)&&(e=3),!o&&(3===e||2===e))for(n=this.Wr,r=0;r<n.length;r++)if(!n[r].Xr(t))return!1;return this._modelManager.getVisible(!0,e,t)},St.prototype.setRowVisible=function(t,e,o){this.Vr(t,e,$,!0,o)&&(this.jq=!0,this.$p())},St.prototype.getColumnWidth=function(t,e,o){var n,r,i,a,s,l;if(z(e)&&(e=3),o)return this._modelManager.getStarSize(!1,e,t);if(r=(n=this.defaults).colWidth,2===e&&(r=n.rowHeaderColWidth),3===e||1===e){if(i=this.getColumnCount(e),t<0||i<=t)return 0;for(a=this.Zr,s=0;s<a.length;s++)if(!a[s].Xr(t))return 0}return(l=this._modelManager.getSize(!1,e,t))||0===l?l:O(r)},St.prototype.$r=function(t,e){var o,n,r;return z(e)&&(e=3),n=(o=this.defaults).colWidth,2===e&&(n=o.rowHeaderColWidth),(r=this._modelManager.getActualSize(!1,e,t))||0===r?r:O(n)},St.prototype.setColumnWidth=function(t,e,o){this.Vr(t,e,q,!1,o)&&(this.oq=!0,this.$p())},St.prototype.getColumnVisible=function(t,e){var o,n;if(z(e)&&(e=3),3===e||1===e)for(o=this.Zr,n=0;n<o.length;n++)if(!o[n].Xr(t))return!1;return this._modelManager.getVisible(!1,e,t)},St.prototype.setColumnVisible=function(t,e,o){this.Vr(t,e,$,!1,o)&&(this.oq=!0,this.$p())},St.prototype.zoom=function(t){var e,o=this;return 0===arguments.length?o._modelManager.getZoomFactor():(t=k(t),!D(t)&&isFinite(t)&&(4<t?t=4:t<.25&&(t=.25),e=o._modelManager.getZoomFactor(),o.XSa(t),o.eCb=o.eCb/e*t,o.cCb=o.cCb/e*t,o.oq=!0,o.jq=!0,o.$p()),o)},St.prototype.XSa=function(t){this._modelManager.do("setZoomFactor",t),St.ao(this,Q,{changeType:"zoomSheet"})},St.prototype.x6a=function(){this._r=W,this.as={colHeader:W,viewport:W},this.bs={rowHeader:W,viewport:W}},St.prototype.invalidateLayout=function(){var t,e,o=this,n=o._eventHandler;o._modelManager.$Gb(),o.x6a(),St.ao(o,"beforeLayoutChanged",{changeType:"invalidateLayout"}),o.oq&&(o.ds(),o.oq=!1),o.jq&&(o.es(),o.jq=!1),o.x6a(),St.ao(o,Q,{changeType:"invalidateLayout"}),n&&n.cs&&L.Vl.Wl(o)&&!n.byb(o)&&n.cs(o.Jl,o.Kl),o.$l=!0,(t=o.parent)&&t.options.enableAccessibility&&(e=o.cgc(),t.dgc(e))},St.prototype.$p=function(){this.Xq<=0&&(this.invalidateLayout(),this.repaint())},St.prototype.getViewportHeight=function(t){var e=this.am();return 0===t?e.fs:1===t?this.oKc(e):2===t?e.gs:0},St.prototype.getViewportWidth=function(t){var e=this.am();return 0===t?e.hs:1===t?this.rKc(e):2===t?e.js:0},St.prototype.getViewportTopRow=function(t){var e=xt(this);return 0===t?0:1===t?_(e,this.lq):2===t?_(e,mt(this)-bt(this)):-1},St.prototype.getViewportTopRowOffset=function(){return this.cCb},St.prototype.getViewportBottomRow=function(t){var e,o,n,r,i,a;if(2===t)return mt(this)-1;for(e=this.getViewportTopRow(t),o=this.getViewportHeight(t),n=1===t?this.cCb:0,r=0,i=mt(this)-bt(this),0===t&&(i=j(xt(this),i)),a=e;a<i&&n<o;a++,r++)n+=this.Sl(a);return e+r-1},St.prototype.jCb=function(t){var e,o=this.getViewportTopRow(t),n=this.getViewportBottomRow(t);for(e=o;e<n+1;e++)if(-1<e&&this.getRowVisible(e,3)&&0<this.Sl(e,3))return e;return-1},St.prototype.getViewportLeftColumn=function(t){var e=wt(this);return 0===t?0:1===t?_(e,this.qq):2===t?_(e,gt(this)-yt(this)):-1},St.prototype.getViewportLeftColumnOffset=function(){return this.eCb},St.prototype.getViewportRightColumn=function(t){var e,o,n,r,i,a;if(2===t)return gt(this)-1;for(e=this.getViewportLeftColumn(t),o=this.getViewportWidth(t),n=0,r=1===t?this.eCb:0,i=gt(this)-yt(this),0===t&&(i=j(wt(this),i)),a=e;a<i&&r<o;a++,n++)r+=this.Tl(a);return e+n-1},St.prototype.kCb=function(t){var e,o=this.getViewportLeftColumn(t),n=this.getViewportRightColumn(t);for(e=o;e<n+1;e++)if(-1<e&&this.getColumnVisible(e,3)&&0<this.Tl(e,3))return e;return-1},St.prototype.showCell=function(t,e,o,n){this.iXc(t,e,o,n)},St.prototype.iXc=function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y,b=this;t<0||t>=mt(b)||e<0||e>=gt(b)||(l=b.parent&&b.parent.options.scrollByPixel,u=b.parent&&b.parent.options.scrollbarMaxAlign,c=b.Fr(e),h=b.Er(t),f=b.getViewportTopRow(h),p=b.cCb,d=b.getViewportLeftColumn(c),g=b.eCb,1===c&&z(i)&&(e=(a=b.gXc(e,n,l,u)).col,i=a.offset),1===h&&z(r)&&(t=(s=b.hXc(t,o,l,u)).row,r=s.offset),m=!1,1!==h||t===f&&r===p||(t=j(t,b.ns()),b.lq=t,b.cCb=r,b.os(),m=!0),1!==c||e===d&&i===g||(e=j(e,b.ps()),b.qq=e,b.eCb=i,b.qs(),m=!0),m&&((y=b.parent)&&!y.options.scrollbarShowMax&&(b.oq=!0,b.jq=!0),b.$p()))},St.prototype.Er=function(t){var e=1;return t<xt(this)?e=0:t>=mt(this)-bt(this)&&(e=2),e},St.prototype.Fr=function(t){var e=1;return t<wt(this)?e=0:t>=gt(this)-yt(this)&&(e=2),e},St.prototype.hXc=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g=this,m=g.ss,y=g.Er(t),b=g.getViewportTopRow(y),v=g.cCb,C=xt(g),w=g.ir();if(0===e)if(n){for(i=w,r=g.getViewportHeight(y);C<=i;i--)if((r-=m.Sl(i))<0){v=t<=i?0:(t=i,r);break}}else v=0;else if(1===e){if(s=a=!1,n){for(i=w,r=l=O(g.getViewportHeight(y)/2);C<=i;i--)if((r-=m.Sl(i))<0){i<=t&&(i--,r+=l,s=!0);break}if(s)for(;C<=i;i--)if((r-=m.Sl(i))<0){t=i,v=r,a=!0;break}}if(!a){for(r=O((g.getViewportHeight(y)-m.Sl(t))/2);C<t;t--)if((r-=m.Sl(t-1))<0){--t,v=r;break}0<r&&t===C&&(v=0)}}else if(2===e){for(r=g.getViewportHeight(y)-m.Sl(t);C<t;t--)if((r-=m.Sl(t-1))<0){--t,v=r;break}0<r&&t===C&&(v=0)}else if(3===e)if(b<t){if(c=(u=g.am()).pt,h=u.qt,f=u.er,p=u.jr,d=g.getCellRect(t,g.Kl),new L.Rect(c,h,f,p).containsRect(d,!0))t=b;else for(r=g.getViewportHeight(y)-m.Sl(t);b<t;t--)if((r-=m.Sl(t-1))<0){--t,v=r;break}}else v=0;return!o&&v<0&&(v=0,t<w&&(t+=1)),{row:t,offset:v}},St.prototype.gXc=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g=this,m=g.ss,y=g.Fr(t),b=g.getViewportLeftColumn(y),v=g.eCb,C=wt(g),w=g.dr();if(0===e)if(n){for(r=g.getViewportWidth(y),i=w;C<=i;i--)if((r-=m._m(i))<0){v=t<=i?0:(t=i,r);break}}else v=0;else if(1===e){if(s=a=!1,n){for(r=l=O(g.getViewportWidth(y)/2),i=w;C<=i;i--)if((r-=m._m(i))<0){i<=t&&(i--,r+=l,s=!0);break}if(s)for(;C<=i;i--)if((r-=m._m(i))<0){t=i,v=r,a=!0;break}}if(!a){for(r=O((g.getViewportWidth(y)-m._m(t))/2);C<t;t--)if((r-=m._m(t-1))<0){--t,v=r;break}0<r&&t===C&&(v=0)}}else if(2===e){for(r=g.getViewportWidth(y)-m._m(t);C<t;t--)if((r-=m._m(t-1))<0){--t,v=r;break}0<r&&t===C&&(v=0)}else if(3===e)if(b<t){if(c=(u=g.am()).pt,h=u.qt,f=u.er,p=u.jr,d=g.getCellRect(g.Jl,t),new L.Rect(c,h,f,p).containsRect(d,!0))t=b;else for(r=g.getViewportWidth(y)-m._m(t);b<t;t--)if((r-=m._m(t-1))<0){--t,v=r;break}}else v=0;return!o&&v<0&&(v=0,t<w&&(t+=1)),{col:t,offset:v}},St.prototype.ms=function(t,e){var o,n=this.ss,r=this.Er(t),i=this.getViewportTopRow(r);if(0!==e)if(1===e)for(o=O((this.getViewportHeight(r)-n.Sl(t))/2);0<t&&!((o-=n.Sl(t-1))<0);t--);else if(2===e)for(o=this.getViewportHeight(r)-n.Sl(t);0<t&&!((o-=n.Sl(t-1))<0);t--);else if(3===e&&!(t<i||-1===i))for(o=this.getViewportHeight(r)-n.Sl(t);i<t&&!((o-=n.Sl(t-1))<0);t--);return t},St.prototype.showColumn=function(t,e){this.showCell(this.lq,t,0,e)},St.prototype.showRow=function(t,e){this.showCell(t,this.qq,e,0)},St.prototype.suspendEvent=function(){this.jm++},St.prototype.resumeEvent=function(){this.jm--,this.jm<0&&(this.jm=0)},St.prototype.isEventSuspended=function(){return 0<this.jm},St.prototype.currentTheme=function(t){return 0===arguments.length?(this.Pm||this.ts(),this.Pm):(typeof t==Z&&(t=l.Themes[t]?l.Themes[t]:new l.Theme(t)),this.Pm=t,this._render.us(),this.Jq(),this.$p(),this)},St.prototype.P3=function(){var t=L.Im.Lm(""),e=N(t.zIndex),o=l.Themes.Office2007;return 2007<e&&(o=l.Themes.Office),o},St.prototype.ts=function(){this.Pm=this.P3(),this.Jq()},St.prototype.reset=function(){this.vs(),this.$p()},St.prototype.vs=function(){var t,e,o=this,n=o.DHb();o.Pp(),o.Nr=0,o.Pr=0,o.T3(),o._r=W,o.as={colHeader:W,viewport:W},o.bs={rowHeader:W,viewport:W},o.lq=0,o.cCb=0,o.qq=0,o.eCb=0,o.frozenRowCount(0),o.frozenColumnCount(0),o.frozenTrailingRowCount(0),o.frozenTrailingColumnCount(0),St.ao(o,"beforeSetHost"),!(t=o.parent)||(e=t.getActiveSheet())&&o.name()===e.name()&&o.ws(t.xs),o.Cq=[{},{},{},{}],o.ss=new L.ln(o),o.Oq={},S&&o.resetCalc(),o._modelManager=new E.lUa(o,St.Rp,St.Sp,St.Vp,St.Tp,o.name()),o.defaults=o._modelManager.defaults,o.DHb(n),o.ts(),o.Lq={},o.oq=!0,o.jq=!0,o.parent&&o.parent.xD?o.Xq=o.parent.xD:o.Xq=0,o.parent&&o.parent.jm?o.jm=o.parent.jm:o.jm=0,o.gga=0,o.Js=!1,o.Ks=W,o.Wr=[],o.Zr=[],o.OIb=!1,St.ao(o,"init")},St.prototype.T3=function(){var n=this;v(st,function(t,e){if(!z(e)){var o=e;"gridline"===t?o={color:L.Im.Lm("gc-gridlineColor").borderTopColor,showVerticalGridline:!0,showHorizontalGridline:!0}:"object"==typeof o&&(o=h.GC$.extend({},e)),n.options[t]=o}})},St.prototype.Ls=function(t){var e;for(this.parent=t,e=this.Xq;e<t.xD;e++)this.suspendPaint();this.jm=t.jm,St.ao(this,"attach",t)},St.prototype.jJb=function(t,e){return t.row===e.row&&t.col===e.col&&t.rowCount===e.rowCount&&t.colCount===e.colCount},St.prototype.kJb=function(t,e,o,n,r){var i,a,s=this.Ms(e,o,n,r).ranges;for(i=0;i<s.length;i++)for(a=0;a<t.length;a++)if(this.jJb(t[i],s[a]))return!0;return!1},St.prototype.lJb=function(t,e,o,n,r){var i,a=!1;return void 0!==r?0===r?0<(i=this.Ms(t,e,o,this.getColumnCount()-e).ranges).length&&(0<t-1&&(a=this.kJb(i,t-1,e,1,this.getColumnCount()-e)),a=(a=a||this.kJb(i,t+o,e,1,this.getColumnCount()-e))||this.kJb(i,t,e,o,1)):0<(i=this.Ms(t,e,this.getRowCount()-t,n).ranges).length&&(0<t-1&&(a=this.kJb(i,t-1,e,this.getRowCount()-t,1)),a=(a=a||this.kJb(i,t+o,e,this.getRowCount()-t,1))||this.kJb(i,t,e,1,n)):a=!0,a},St.prototype.Y3=function(t,e,o,n,r,i,a,s,l){var u;return!a&&this.options.isProtected&&this.ou(L.kf(t,e,o,n),l)?(r&&this.Os(1,r),!1):(u=this.lJb(t,e,o,n,s),!(S&&u&&!this.Vq(t,e,o,n)&&(i&&this.Os(1,i),1)))},St.prototype.clear=function(t,e,o,n,r,i,a,s,l){0!==r&&this.cg(t,e,o,n,r,i,a,s,l)},St.prototype.cg=function(t,e,o,n,r,i,a,s,l){var u,c,h,f,p,d,g,m,y,b,v,C,w,x,T=this,A=S;try{if(A&&T.suspendCalcService(),T.suspendPaint(),u=T.defaults,d={changeType:"clear",row:t,col:e,rowCount:o,colCount:n,sheetArea:r,type:i,ignoreTable:s,ignorePivotTable:l,canClear:!(p=f=h=c=void 0)},St.ao(T,Q,d),!d.canClear)return;if(z(r)||3===r){if(A&&!T.Vq(t,e,o,n))return!1;if(1&i&&T.getDataSource&&T.getDataSource()){for(T.suspendEvent(),c=t;c<t+o;c++)if(!(a&&T.Ps&&T.Ps(c)))for(h=e;h<e+n;h++)T.setValue(c,h,W,r);T.resumeEvent()}}for(g=T._modelManager,m=A&&T.Bj(),c=-1===t?0:t,y=-1===t?g.getRowCount(r):o,h=-1===e?0:e,b=-1===e?g.getColumnCount(r):n,v=[],C=c;C<y+c;C++)a&&T.Ps&&T.Ps(C)&&v.push(C);if(g.do("clear",c,h,y,b,i,v,r),m&&1&i&&(m.Sg(c,h,y,b),m.clear(c,h,y,b,g.dUa())),8&i&&!(0<=t&&0<=e))if(0<=e)for(p=0;p<b;p++)T.setTag(-1,h+p,W,r);else if(0<=t)for(f=0;f<y;f++)a&&T.Ps&&T.Ps(c+f)||T.setTag(c+f,-1,W,r);else T.setTag(-1,-1,W,r);if(256&i&&!(0<=t&&0<=e))if(0<=e)for(p=0;p<b;p++)T.setHyperlink(-1,h+p,W,r);else if(0<=t)for(f=0;f<y;f++)a&&T.Ps&&T.Ps(c+f)||T.setHyperlink(-1,-1,W);if(2&i&&!(0<=t&&0<=e))if(0<=e)for(p=0;p<b;p++)T.setStyle(-1,h+p,W,r);else if(0<=t)for(f=0;f<y;f++)a&&T.Ps&&T.Ps(c+f)||T.setStyle(c+f,-1,W,r);else T.setStyle(-1,-1,W,r);if(32&i){if(t<0)for(p=0;p<b;p++)T.setColumnVisible(h+p,!0,r),T.setColumnResizable(h+p,!0,r),T.setColumnWidth(h+p,2===r?u.rowHeaderColWidth:u.colWidth,r);if(e<0)for(f=0;f<y;f++)a&&T.Ps&&T.Ps(c+f)||(T.setRowVisible(c+f,!0,r),T.setRowResizable(c+f,!0,r),T.setRowHeight(c+f,1===r?u.colHeaderRowHeight:u.rowHeight,r))}for((z(r)||3===r)&&A&&1==(1&i)&&(w=T.Bj())&&w.Ag(t,e,o,n),x=[],f=0;f<y;f++)for(p=0;p<b;p++)x.push({row:c+f,col:h+p});T.Bu(t,e,y,b,x,2,r)}finally{T.resumePaint(),A&&T.resumeCalcService(!1)}},St.prototype._p=function(){var t,e,o,n,r=this.options,i=r.protectionOptions;r.isProtected&&i&&(t=i.allowSelectLockedCells,e=i.allowSelectUnlockedCells,(!1===t&&!1!==e||!1!==t&&!1===e)&&(o=this.Jl,n=this.Kl,this.Qs(o,n)||(this.Tr(),this.Rs(o,n,!0),this.Ss(4,o,n))))},St.prototype.setArray=function(n,r,t,i){var a,s,l,u,c=this,e=S;if(i=e&&i,a=mt(c),s=gt(c),t&&0<=n&&n<a&&0<=r&&r<s){e&&c.suspendCalcService(),c.suspendPaint();try{v(t,function(o,t){h.GC$.isArray(t)?v(t,function(t,e){u=r+t,(l=n+o)<a&&u<s&&(i?c.setFormula(l,u,e):c.setValue(l,u,e,3,!0))}):(u=r,(l=n+o)<a&&u<s&&(i?c.setFormula(l,u,t):c.setValue(l,u,t,3,!0)))})}finally{e&&c.resumeCalcService(),c.resumePaint()}}},St.prototype.getArray=function(t,e,o,n,r){var i,a,s=[],l=mt(this),u=gt(this);if(r=r&&S,0<=t&&t<l&&0<=e&&e<u)for(l<t+o&&(o=l-t),u<e+n&&(n=u-e),i=0;i<o;i++)for(s[i]=[],a=0;a<n;a++)s[i][a]=r?this.getFormula(t+i,e+a):this.getValue(t+i,e+a);return s},St.prototype.setTag=function(t,e,o,n){var r,i,a,s,l;if(z(n)&&(n=3),0!==n){if(i=(r=this._modelManager).getRowCount(n),a=r.getColumnCount(n),t<-1||i<=t||e<-1||a<=e)return;o=x(o),s=void 0,(l=0<this.jm)||(s=this.getTag(t,e,n)),r.do("setValueForKey",t,e,Y,o,n),s!==o&&(-1!==t&&-1!==e?l?this.WXc(this,[{row:t,col:e}],0):this.Bq(Y,t,e,n,s,o):-1!==t&&-1===e?this.kq(t,n,Y,o,s):-1===t&&-1!==e&&this.pq(e,n,Y,o,s))}},St.prototype.getTag=function(t,e,o){var n;return z(o)&&(o=3),0!==o?(n=this._modelManager.getValueForKey(t,e,Y,o),T(n)):W},St.prototype.tag=function(t){var e;return 0===arguments.length?(e=this._modelManager.getValueForKey(-1,-1,Y,3),T(e)):(this._modelManager.do("setValueForKey",-1,-1,Y,x(t),3),this)},St.prototype.getParent=function(){return this.parent},St.prototype.getDirtyRows=function(){return ft(this,!0)},St.prototype.getInsertRows=function(){return ft(this,!1)},St.prototype.getDeletedRows=function(){var o=[],t=this.Ts;return t&&v(t,function(t,e){e&&!h.GC$.isFunction(e)&&o.push({row:e.row,originalItem:e.data})}),o},St.prototype.hasPendingChanges=function(){var t,e=this.Ts;return!!(e&&0<e.length)||(t=this._modelManager.hUa(),!C(t))},St.prototype.clearPendingChanges=function(t){var e,o,n,r,i;return z(t)||C(t)?(this._modelManager.iUa(),this.Ts=[],void St.ao(this,"clearPendingChanges")):(e=t.row,o=t.col,n=t.rowCount,r=t.colCount,(1&(i=(i=t.clearType)||at.dirty))===at.dirty&&this.Rec(e,o,n,r),(2&i)===at.insert&&this.Sec(e,o,n,r),void((4&i)===at.delete&&this.Tec(e,o,n,r)))},St.prototype.Rec=function(t,e,o,n){var r=this._modelManager,i=this.Uec(t,e,o,n),a=this.Vec(e,n);i?(r.Qec(),St.ao(this,"clearPendingChanges")):r.Mec(a,t,e,o,n)},St.prototype.Sec=function(t,e,o,n){var r=this._modelManager,i=this.Uec(t,e,o,n),a=this.Vec(e,n);r.Lec(i,a,t,o)},St.prototype.Tec=function(n,t,r,e){var o,i,a;if(this.Uec(n,t,r,e))this.Ts=[];else if(this.Vec(t,e)&&(o=this.Ts))for(i=[],v(o,function(t,e){if(e){var o=e.row;n<=o&&o<n+r&&i.push(t)}}),a=i.length-1;0<=a;a--)this.Ts.splice(i[a],1)},St.prototype.Vec=function(t,e){return z(t)||-1===t||0===t&&this.getColumnCount()===e},St.prototype.Wec=function(t,e){return z(t)||-1===t||0===t&&e===this.getRowCount()},St.prototype.Uec=function(t,e,o,n){return this.Vec(t,o)&&this.Vec(e,n)},St.prototype.getDirtyCells=function(t,r,e,i){var a,s,o,n,l,u,c,h=this;if(z(t)&&(t=-1),z(r)&&(r=-1),(z(e)||e<=0)&&(e=1),(z(i)||i<=0)&&(i=1),a=[],s=h._modelManager.hUa(),!C(s)){if(o=[],0<=t)for(n=t;n<t+e;n++)o.push(n);else for(l in s)w(s,l)&&o.push(N(l));v(o,function(t,e){var o,n;if((u=s[e])&&"e"===u.rs)if(0<=r)for(o=r;o<r+i;o++)(c=u[o])&&a.push(At(h,e,o,c.oldValue));else for(n in u)D(n)||(c=u[n])&&a.push(At(h,e,N(n),c.oldValue))})}return a},St.prototype.suspendDirty=function(){this.gga++,this._modelManager.jUa()},St.prototype.resumeDirty=function(){this.gga--,this.gga<0&&(this.gga=0),this._modelManager.kUa()},St.prototype.isDirtySuspended=function(){return 0<this.gga},St.prototype.ad=function(t){this.Us(new L.Rect(0,0,0,0)),this.vs(),this.cq(t)},St.prototype.Vs=function(){var t,e=this.Ws(),o={top:0,left:0};return e&&e.parentElement&&(o=h.GC$(e).offset())&&(o.top+=I.body.clientTop||0,o.left+=I.body.clientLeft||0),(t=e&&e.canvasOffset)&&(o=t),o},St.prototype.ws=function(t){var e,o,n;t&&((e=this).Js=!1,e.Xs&&e.no(!1),o=g("canvas"),n=e.parent&&e.parent.options.enableAccessibility?"":it().NeedCanvasSupport,h.GC$(o).attr("id",t.getAttribute("id")+"_vp").attr("gcUIElement","gcWorksheetCanvas").html(n).appendTo(t),L.En.Kn(o,W,e),e.Xs=o,e.fq(),e.repaint(),e.parent&&e.parent.Ys(),St.ao(e,"setHost",h.GC$(o)))},St.prototype.Jgc=function(t,e,o,n,r,i,a,s,l){var u,c;for(u=o;u<n;u++)c=this.getText(e,u,l),t.push('"'+c+'"');for(u=r;u<i;u++)c=this.getText(e,u,l),t.push('"'+c+'"');for(u=a;u<s;u++)c=this.getText(e,u,l),t.push('"'+c+'"')},St.prototype.Kgc=function(){var t,e,o,n,r,i=this,a=i.getViewportTopRow(1),s=i.getViewportBottomRow(1),l=i.getViewportLeftColumn(1),u=s-a+1,c=i.getViewportRightColumn(1)-l+1,h=i.getRowCount(R.SheetArea.colHeader),f=i.getColumnCount(R.SheetArea.rowHeader),p=i.frozenColumnCount(),d=yt(i),g=i.getColumnCount(),m=i.frozenRowCount(),y=bt(i),b=i.getRowCount(),v=[];for(t=0;t<h;t++)e=[],i.Jgc(e,t,0,p,l,l+c,g-d,g,R.SheetArea.colHeader),v.push(e.join(","));for(t=0;t<m;t++){for(o=[],n=0;n<f;n++)r=i.getText(t,n,R.SheetArea.rowHeader),o.push('"'+r+'"');i.Jgc(o,t,0,p,l,l+c,g-d,g),v.push(o.join(","))}for(t=a;t<a+u;t++){for(o=[],n=0;n<f;n++)r=i.getText(t,n,R.SheetArea.rowHeader),o.push('"'+r+'"');i.Jgc(o,t,0,p,l,l+c,g-d,g),v.push(o.join(","))}for(t=b-y;t<b;t++){for(o=[],n=0;n<f;n++)r=i.getText(t,n,R.SheetArea.rowHeader),o.push('"'+r+'"');i.Jgc(o,t,0,p,l,l+c,g-d,g),v.push(o.join(","))}return v.join(";")},St.prototype.cgc=function(t){var e,o,n,r,i;return L.util.sl()?this.Kgc():(e=this.Jl,o=this.Kl,n=R.SheetArea.viewport,!t||z(t.row)||z(t.col)||(e=t.row,o=t.col,n=t.hitTestType),r=it(),i="",n===R.SheetArea.rowHeader?i=r.ARIA_RowHeader+" ":n===R.SheetArea.colHeader&&(i=r.ARIA_ColumnHeader+" "),i+r.ARIA_Cell+"("+e+","+o+") "+M.Kb(r.ARIA_HasValue,[this.getText(e,o,n)]))},St.prototype.fq=function(){var t,e,o,n,r,i,a,s,l=this.Ws();l&&l.parentNode&&(e=(t=getComputedStyle(l.parentNode)).width,o=t.height,0<(n=e.indexOf("px"))&&(e=e.substring(0,n)),0<(n=o.indexOf("px"))&&(o=o.substring(0,n)),r=N(e),i=N(o),D(r)&&(r=h.GC$(l.parentNode).width()),D(i)&&(i=h.GC$(l.parentNode).height()),0!==r&&0!==i&&(a=_(r,0),s=_(i,0),l.style.display="none",l.style.display="",l.width=a,l.height=s,l.style.width=a+"px",l.style.height=s+"px",a=l.clientWidth||l.width,s=l.clientHeight||l.height,this.Zs.width=a,this.Zs.height=s,L.En.Pn(l,a,s),this.invalidateLayout()))},St.prototype.no=function(t,e){var o,n,r,i=this;!0!==i.Js&&(L.En.Sn(i),i.isEditing&&i.isEditing()&&i.Yoa(),St.ao(i,"dispose",{clearCache:t,isSheetDestroy:!0,hasActiveSheet:e}),(o=i.Xs)&&((n=o.parentNode)&&n.removeChild(o),i.Xs=W),i.$s(),i._modelManager&&i._modelManager.no(t),!1!==t&&(i.Js=!0,(r=i.at)&&r.no(),i.parent=W,i._modelManager=W,i.ss&&(i.ss.no(),i.ss=W),i.bt&&(i.bt.no(),i.bt=W),L.Vl.Wl(i)&&L.Vl.Zl(W,!0),i.uu&&(i.uu=W),i.Wr=W,i.Zr=W))},St.prototype.$s=function(){var t=this.dt;t&&(h.GC$(t).remove(),this.dt=G)},St.prototype.vq=function(t,e,o,n,r){var i,a,s,l,u;return z(n)&&(n=3),3===n&&this.jIb&&(i=t.getDynamicArrayInfo(e,o))&&i.isValid&&(e!==i.row||o!==i.col)?W:(a=this.et,!this.loading&&a&&(s=a.getCalcService()).calcOnDemand&&3===n&&!s.IsSuspended()&&(l=a.qg(e,o))&&!0===l.$l&&(l.$l=!1,delete l.dh,delete l.eh,a.recalculateCell(e,o),this.yj().ZIc()),u=t.getValue(e,o,n,this.loading,r),u=T(u))},St.prototype.Tq=function(t,e){var o,n,r,i,a;return z(e)&&(e=3),o=L.kf(-1,-1,-1,-1),t&&(n=t.row,r=t.col,i=t.rowCount,a=t.colCount,-1===r&&(r=0,a=this.getColumnCount(e)),-1===n&&(n=0,i=this.getRowCount(e)),o.col=r,o.row=n,o.colCount=a,o.rowCount=i),o},St.prototype.getRangeRect=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v=new L.Rect(-1,-1,-1,-1),C=this,w=C.am();return 0===w.width||0===w.height?v:(n=C.it(e),r=C.jt(t),n&&0!==n.length&&r&&0!==r.length&&(i=C.Tq(o),a=C.ss,s=i.row,l=i.row+i.rowCount-1,u=i.col,c=i.col+i.colCount-1,h=xt(C),f=mt(C)-bt(C)-1,p=wt(C),d=gt(C)-yt(C)-1,g=n[0].col,m=n[n.length-1].col,y=r[0].row,b=r[r.length-1].row,u<g&&(u=function(t,e){for(;e<t;)if(t--,C.getColumnVisible(t))return t;return t}(g,u)),m<c&&(c=function(t,e){for(;t<e;)if(t++,C.getColumnVisible(t))return t;return t}(m,c)),s<y&&(s=function(t,e){for(;e<t;)if(t--,C.getRowVisible(t))return t;return t}(y,s)),b<l&&(l=function(t,e){for(;t<e;)if(t++,C.getRowVisible(t))return t;return t}(b,l)),c<u||l<s||(0===e?u<p&&(v.x=w.kt+pt(a,0,u-1),v.width=pt(a,u,c)):1===e?u<=d&&p<=c&&(v.x=u<g?n[0].x-pt(a,u,g-1):n[0].x+pt(a,g,u-1),v.width=pt(a,u,c)):2===e&&d<c&&(v.x=u<g?w.lt-pt(a,u,g-1):w.lt+pt(a,g,u-1),v.width=pt(a,u,c)),0===t?s<h&&(v.y=w.nt+dt(a,0,s-1),v.height=dt(a,s,l)):1===t?s<=f&&h<=l&&(v.y=s<y?r[0].y-dt(a,s,y-1):r[0].y+dt(a,y,s-1),v.height=dt(a,s,l)):2===t&&f<l&&(v.y=s<y?w.ot-dt(a,s,y-1):w.ot+dt(a,y,s-1),v.height=dt(a,s,l)))),v)},St.prototype.isintersectWithArrayFormula=function(t){var e,o,n=this.Bj();if(n)for(e=t.row;e<t.row+t.rowCount;e++)for(o=t.col;o<t.col+t.colCount;o++)if(n.dg(e,o,1,1))return!0;return!1},St.prototype.cm=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g=this,m=new L.Rect(-1,-1,-1,-1),y=g.am();if(0===y.width||0===y.height)return m;if(e=g.Tq(t),o=wt(g),n=xt(g),r=yt(g),i=bt(g),a=g.ss,s=e.row,l=e.row+e.rowCount-1,u=e.col,c=e.col+e.colCount-1,h=mt(g),f=gt(g),u<o)m.x=y.kt+pt(a,0,u-1),m.width=pt(a,u,j(c,o-1)),o<=c&&c<f-r?(p=g.it(1))&&0<p.length&&(m.width+=pt(a,p[0].col,j(c,p[p.length-1].col))+g.eCb):f-r<=c&&(p=g.it(2))&&0<p.length&&(m.width=p[0].x-m.x,m.width+=pt(a,f-r,j(c,f-1)));else if(u<f-r){if(!(p=g.it(1))||0===p.length||u>p[p.length-1].col||c<p[0].col)return m;m.x=y.pt+pt(a,p[0].col,u-1)+g.eCb,o<=c&&c<f-r?m.width=pt(a,_(u,p[0].col),j(c,p[p.length-1].col)):f-r<=c&&(p=g.it(2))&&0<p.length&&(m.width=p[0].x-m.x,m.width+=pt(a,f-r,j(c,f-1)))}else u<f&&(p=g.it(2))&&0<p.length&&(m.x=y.lt+pt(a,p[0].col,u-1),m.width=pt(a,u,j(c,f-1)));if(s<n)m.y=y.nt+dt(a,0,s-1),m.height=dt(a,s,j(l,n-1)),n<=l&&l<h-i?(d=g.jt(1))&&0<d.length&&(m.height+=dt(a,d[0].row,j(l,d[d.length-1].row))+g.cCb):h-i<=l&&(d=g.jt(2))&&0<d.length&&(m.height=d[0].y-m.y,m.height+=dt(a,h-i,j(l,h-1)));else if(s<h-i){if(!(d=g.jt(1))||0===d.length||s>d[d.length-1].row||l<d[0].row)return m;m.y=y.qt+dt(a,d[0].row,s-1)+g.cCb,n<=l&&l<h-i?m.height=dt(a,_(s,d[0].row),j(l,d[d.length-1].row)):h-i<=l&&(d=g.jt(2))&&0<d.length&&(m.height=d[0].y-m.y,m.height+=dt(a,h-i,j(l,h-1)))}else s<h&&(d=g.jt(2))&&0<d.length&&(m.y=y.ot+dt(a,d[0].row,s-1),m.height+=dt(a,s,j(l,h-1)));return m},St.prototype.Ws=function(){return this.Xs},St.prototype.rt=function(t,e){return this.dp(t,e)+1},St.prototype.dp=function(t,e){var o,n=this._render;return o=e||n.Cl(n.Bl()),L.Vn.Xn(t,o)},St.prototype.or=function(t){var e=this.am(),o=W,n=e.pt,r=this.rKc(e),i=e.lt,a=e.js;return e.zr<t&&t<e.zr+e.Br?o=-1:e.kt<t&&t<e.kt+e.hs?o=0:n<t&&t<n+r?o=1:i<t&&t<i+a&&(o=2),o},St.prototype.nr=function(t){var e=this.am(),o=W,n=e.qt,r=this.oKc(e),i=e.ot,a=e.gs;return e.Ar<t&&t<e.Ar+e.Cr?o=-1:e.nt<t&&t<e.nt+e.fs?o=0:n<t&&t<n+r?o=1:i<t&&t<i+a&&(o=2),o},St.prototype.pr=function(t,e){var o,n;if((o=-1===e?this.ut():this.jt(e))&&(n=o.findY(t)))return n.row},St.prototype.qr=function(t,e){var o,n;if((o=-1===e?this.vt():this.it(e))&&(n=o.findX(t)))return n.col},St.prototype.wt=function(t,e){return this.Jl<=t&&t<this.Jl+this.Lr&&this.Kl<=e&&e<this.Kl+this.Mr},St.prototype.sp=function(t){return this._modelManager.sp(t)},St.prototype.tp=function(t){return this._modelManager.tp(t)},St.prototype.vp=function(t,e,o,n){var r=mt(this),i=gt(this);return this._modelManager.vp(t,e,o,r,i,n)},St.prototype.wp=function(t,e,o){var n=mt(this),r=gt(this);return this._modelManager.wp(t,e,o,n,r)},St.prototype.xt=function(t,e,o){var n,r,i,a,s,l,u=this.yt;if(u&&!u.resizeInfo&&!z(o)){if(a=u.hitTestType,s=u.row,l=u.col,1===o)return n=!1,(r=this._modelManager.findSpan(s,l,1))&&(n=r.contains(t,e,1,1)),i=t===s&&e===l||n,a===o&&i;if(2===o)return n=!1,(r=this._modelManager.findSpan(s,l,2))&&(n=r.contains(t,e,1,1)),i=t===s&&e===l||n,a===o&&i;if(3===o)return a===o&&t===s&&e===l;if(0===o)return a===o}return!1},St.prototype.sr=function(t,e){return 0<=t&&t<=2&&0<=e?3:0<=t&&t<=2&&e<0?2:t<0&&0<=e?1:t<0&&e<0?0:W},St.prototype.zt=function(t){var e=this._eventHandler;e&&e.zt(t)},St.prototype.zo=function(){var t,e=this.parent,o=e&&e._host;return o=o||(t=this.Xs)&&t.parentElement},St.prototype.Pp=function(){this.Jl=0,this.Kl=0,this.Lr=1,this.Mr=1,this.Qr=0,this.Rr=0},St.prototype.Sl=function(t,e,o){var n=this.getRowHeight(t,e),r=this.zoom();return 1!==r&&(n*=r),o?n:F(n)},St.prototype.Tl=function(t,e,o){var n=this.getColumnWidth(t,e),r=this.zoom();return 1!==r&&(n*=r),o?n:F(n)},St.prototype.At=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g=this,m=g.Dr(),y=g.options,b=y.sheetAreaOffset.left,v=y.sheetAreaOffset.top,C=new L.Rect(m.x+b,m.y+v,_(0,m.width-b),_(0,m.height-v)),w=C.width,x=C.height,T=vt(g),A=Ct(g),S={x:C.x,y:C.y,width:C.width,height:C.height,Br:0,Cr:0,hs:0,fs:0,js:0,gs:0,Bt:0,Ct:0,Dt:0,Et:0,kt:0,nt:0,lt:0,ot:0,pt:0,qt:0,jr:0,er:0,$Lc:0,_Lc:0,pKc:0,sKc:0,zr:0,Ar:0,em:function(){return new L.Rect(this.x,this.y,this.Br,this.Cr)},gm:function(t){var e=this;return 0===t?new L.Rect(e.kt,e.y,e.hs,e.Cr):1===t?new L.Rect(e.pt,e.y,g.rKc(e),e.Cr):2===t?new L.Rect(e.lt,e.y,e.js,e.Cr):W},fm:function(t){var e=this;return 0===t?new L.Rect(e.x,e.nt,e.Br,e.fs):1===t?new L.Rect(e.x,e.qt,e.Br,g.oKc(e)):2===t?new L.Rect(e.x,e.ot,e.Br,e.gs):W},Ft:function(t,e){var o=this;if(0===t){if(0===e)return new L.Rect(o.kt,o.nt,o.hs,o.fs);if(1===e)return new L.Rect(o.pt,o.nt,g.rKc(o),o.fs);if(2===e)return new L.Rect(o.lt,o.nt,o.js,o.fs)}else if(1===t){if(0===e)return new L.Rect(o.kt,o.qt,o.hs,g.oKc(o));if(1===e)return new L.Rect(o.pt,o.qt,g.rKc(o),g.oKc(o));if(2===e)return new L.Rect(o.lt,o.qt,o.js,g.oKc(o))}else if(2===t){if(0===e)return new L.Rect(o.kt,o.ot,o.hs,o.gs);if(1===e)return new L.Rect(o.pt,o.ot,g.rKc(o),o.gs);if(2===e)return new L.Rect(o.lt,o.ot,o.js,o.gs)}return W}};if(g.Gt&&(0<(t=g.Gt()).width&&(S.x+=t.width+0,w-=t.width+0),0<t.height&&(S.y+=t.height+0,x-=t.height+0)),y.rowHeaderVisible)for(r=g.getColumnCount(2),n=0;n<r;n++)S.Br+=g.Tl(n,2);if(y.colHeaderVisible)for(o=g.getRowCount(1),e=0;e<o;e++)S.Cr+=g.Sl(e,1);if(0<(i=wt(g)))for(r=gt(g),n=0;n<i&&n<r;n++)g.getColumnVisible(n)&&(S.hs+=g.Tl(n));if(0<(a=xt(g)))for(o=mt(g),e=0;e<a&&e<o;e++)g.getRowVisible(e)&&(S.fs+=g.Sl(e));if(0<(s=yt(g)))for(r=gt(g),n=_(i,r-s);n<r;n++)S.js+=g.Tl(n);if(0<(l=bt(g)))for(o=mt(g),e=_(a,o-l);e<o;e++)S.gs+=g.Sl(e);if(S.zr=S.x,S.Ar=S.y,S.kt=S.zr+S.Br,S.nt=S.Ar+S.Cr,S.pt=S.kt+S.hs,S.qt=S.nt+S.fs,w-=S.Br,x-=S.Cr,w-=S.hs,x-=S.fs,w-=S.js,x-=S.gs,w-=S.sKc,x-=S.pKc,x-=S.Bt,o=mt(g),(u=0)<(c=(r=gt(g))-s))for(u+=g.eCb,n=_(i,g.qq);n<c&&u<w;n++)u+=g.Tl(n);if(u<(h=_(0,w))?(S.sKc=h-u,h=S.er=u):S.er=h,(f=0)<(p=o-l))for(f+=g.cCb,e=_(a,g.lq);e<p&&f<x;e++)f+=g.Sl(e);return f<(d=_(0,x))?(S.pKc=d-f,d=S.jr=f):S.jr=d,S.lt=S.pt+h,S.ot=S.qt+d,A?(S.$Lc=S.pt+S.er,S.lt+=S.sKc):S.$Lc=S.lt+S.js,T?(S._Lc=S.qt+S.jr,S.ot+=S.pKc):S._Lc=S.ot+S.gs,S.Dt=S.zr,S.Et=S.y+S.height-S.Bt,S},St.prototype.am=function(){return this._r||(this._r=this.At()),this._r},St.prototype.Hr=function(t,e){return z(e)||3===e||1===e?this.it(t):2===e?this.vt():W},St.prototype.vt=function(){return this.bs.rowHeader||(this.bs.rowHeader=this.Ht()),this.bs.rowHeader},St.prototype.it=function(t){return this.bs.viewport||(this.bs.viewport={}),this.bs.viewport[t]||(this.bs.viewport[t]=this.It(t)),this.bs.viewport[t]},St.prototype.Ht=function(){var t,e,o=new E.yp,n=this.am().zr,r=this.getColumnCount(2);for(e=0;e<r;e++)t=this.Tl(e,2),o.push(new E.zp(-1,e,n,-1,t,-1)),n+=t;return o},St.prototype.It=function(t){var e,o,n,r,i,a,s=new E.yp,l=this.am(),u=gt(this),c=this.ss,h=wt(this),f=yt(this);if(0===t)for(o=l.kt,u=j(h,u),e=0;e<u;e++)n=c._m(e),s.push(new E.zp(-1,e,o,-1,n,-1)),o+=n;else if(1===t)for(r=Ct(this),i=this.eCb,o=l.pt+i,u=r?u-f:u+f,a=this.rKc(l)-i,e=_(h,this.qq);0<a&&e<u;e++)n=c._m(e),s.push(new E.zp(-1,e,o,-1,n,-1)),o+=n,a-=n;else if(2===t)for(o=l.lt,e=_(h,u-f);e<u;e++)n=c._m(e),s.push(new E.zp(-1,e,o,-1,n,-1)),o+=n;return s},St.prototype.Gr=function(t,e){return z(e)||3===e||2===e?this.jt(t):1===e?this.ut():W},St.prototype.Jt=function(t){var e,o,n=new E.yp;for(e=0;e<3;e++)(o=this.Gr(e,t))&&0<o.length&&(n=h.GC$.merge(n,o));return n},St.prototype.Kt=function(t){var e,o,n=new E.yp;for(e=0;e<3;e++)(o=this.Hr(e,t))&&0<o.length&&(n=h.GC$.merge(n,o));return n},St.prototype.ut=function(){return this.as.colHeader||(this.as.colHeader=this.Lt()),this.as.colHeader},St.prototype.jt=function(t){return this.as.viewport||(this.as.viewport={}),this.as.viewport[t]||(this.as.viewport[t]=this.Mt(t)),this.as.viewport[t]},St.prototype.Lt=function(){var t,e,o=new E.yp,n=this.am().Ar,r=this.getRowCount(1);for(e=0;e<r;e++)t=this.Sl(e,1),o.push(new E.zp(e,-1,-1,n,-1,t)),n+=t;return o},St.prototype.Mt=function(t){var e,o,n,r,i,a,s=new E.yp,l=xt(this),u=bt(this),c=this.am(),h=mt(this),f=this.ss;if(0===t)for(o=c.nt,h=j(l,h),e=0;e<h;e++)n=f.Sl(e),s.push(new E.zp(e,-1,-1,o,-1,n)),o+=n;else if(1===t)for(r=vt(this),i=this.cCb,o=c.qt+i,h=r?h-u:h+u,a=this.oKc(c)-i,e=_(l,this.lq);0<a&&e<h;e++)n=f.Sl(e),s.push(new E.zp(e,-1,-1,o,-1,n)),o+=n,a-=n;else if(2===t)for(o=c.ot,e=_(l,h-u);e<h;e++)n=f.Sl(e),s.push(new E.zp(e,-1,-1,o,-1,n)),o+=n;return s},St.prototype.Ir=function(t,e,o,n){var r,i,a,s,l,u,c=this.getRowCount(o),h=this.getColumnCount(o),f=this.Gr(t,o),p=this.Hr(e,o),d=new E.yp;return f&&0<f.length&&p&&0<p.length&&(r=f[0].row,i=p[0].col,a=f[f.length-1].row,s=p[p.length-1].col,l=this._modelManager.getSpans(L.kf(r,i,a-r+1,s-i+1),o),n&&this.mJb&&(u=this.mJb.nJb(o),l=l.concat(u)),0<l.length&&this.Nt(l,r,i,a,s,d,c,h,o,f,p)),d},St.prototype.rr=function(t,e,o,n,r){var i,a,s,l,u=this.getRowCount(o),c=this.getColumnCount(o),h=this.Gr(t,o),f=this.Hr(e,o),p=new E.yp;return h&&0<h.length&&f&&0<f.length?(i=h[0].row,a=f[0].col,(s=this.getSpan(n,r,o))&&((l=[]).push(s),this.Nt(l,i,a,s.row+s.rowCount,s.col+s.colCount,p,u,c,o,h,f)),0<p.length?p[0]:W):W},St.prototype.Nt=function(t,e,o,n,r,i,a,s,l,u,c){var h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k=t.length;if(!(k<=0)){for(f=n+1,p=r+1,d=[],g=[],m=[],y=[],v=b=0,h=e-1;0<=h;h--)d[h]=this.Sl(h,l),v-=d[h],y[h]=v;for(v=0,h=e;h<f;h++)y[h]=v,d[h]=this.Sl(h,l),v+=d[h];for(h=o-1;0<=h;h--)g[h]=this.Tl(h,l),b-=g[h],m[h]=b;for(b=0,h=o;h<p;h++)m[h]=b,g[h]=this.Tl(h,l),b+=g[h];for(C=0;C<k;C++)if((w=t[C]).intersect(e,o,n-e+1,r-o+1)){if(f<(x=w.row+w.rowCount)){for(h=f;h<x;h++)d.push(this.Sl(h,l)),y.push(y[h-1]+d[h]);f=x}if(p<(T=w.col+w.colCount)){for(h=p;h<T;h++)g.push(this.Tl(h,l)),m.push(m[h-1]+g[h]);p=T}for(A=m[w.col],S=y[w.row],R=N=void(I=M=0),R=w.col;R<w.col+w.colCount&&R<s;R++)M+=g[R];for(N=w.row;N<w.row+w.rowCount&&N<a;N++)I+=d[N];i.push(new E.zp(w.row,w.col,c[0].x+A,u[0].y+S,M,I,w.rowCount,w.colCount,w.isAutoMerge))}}},St.prototype.qs=function(){var t,e,o=this.parent,n=this.Ot(this.qq),r=this.eCb;-1!==n&&n!==this.qq&&(this.qq=n),(t=o&&o.kKc)&&(e=t.QB===R.ScrollType.pixels?this.jgc(n)-r:this.Qt(n),t.value(e))},St.prototype.os=function(){var t,e,o=this.parent,n=this.Rt(this.lq),r=this.cCb;-1!==n&&n!==this.lq&&(this.lq=n),(t=o&&o.nKc)&&(e=t.QB===R.ScrollType.pixels?this.kgc(n)-r:this.Tt(n),t.value(e))},St.prototype.ds=function(){var t,e=this.parent;e&&e.kKc&&(t=e.options.scrollByPixel,e.kKc.QB=t?R.ScrollType.pixels:R.ScrollType.continuous),e&&e.Ut&&(e.options.scrollbarAppearance===R.ScrollbarAppearance.mobile&&e.hec(),e.options.scrollIgnoreHidden&&(this.Vt=this.Wt(!0)),e.Ut())},St.prototype.es=function(){var t,e=this.parent;e&&e.nKc&&(t=e.options.scrollByPixel,e.nKc.QB=t?R.ScrollType.pixels:R.ScrollType.continuous),e&&e.Xt&&(e.options.scrollbarAppearance===R.ScrollbarAppearance.mobile&&e.hec(),e.options.scrollIgnoreHidden&&(this.Yt=this.Zt(!0)),e.Xt())},St.prototype.$t=function(){var t=wt(this);return 0<t?this.Zq(t-1):this.$q()},St.prototype._t=function(){var t=xt(this);return 0<t?this._q(t-1):this.ar()},St.prototype.$q=function(t){return this.Zq(-1,t)},St.prototype.Zq=function(t,e,o){for(var n=this.getColumnCount(e),r=o?n-1:n-1-yt(this);t<r;)if(t++,this.getColumnVisible(t,e)&&0<this.Tl(t,e))return t;return W},St.prototype.br=function(t,e,o){for(var n=o?0:wt(this);n<t;)if(t--,this.getColumnVisible(t,e)&&0<this.Tl(t,e))return t;return W},St.prototype.ar=function(t){return this._q(-1,t)},St.prototype._q=function(t,e,o){for(var n=this.getRowCount(e),r=o?n-1:n-1-bt(this);t<r;)if(t++,this.getRowVisible(t,e)&&0<this.Sl(t,e))return t;return W},St.prototype.gr=function(t,e,o){for(var n=o?0:xt(this);n<t;)if(t--,this.getRowVisible(t,e)&&0<this.Sl(t,e))return t;return W},St.prototype.au=function(){this.jq=!0,this.os()},St.prototype.bu=function(){this.oq=!0,this.qs()},St.prototype.kgc=function(t){var e,o=xt(this),n=o+(mt(this)-bt(this)-o)-1,r=0;if(t<=o)return r;for(n<t&&(t=n),e=o;e<t;e++)r+=this.Sl(e);return r},St.prototype.jgc=function(t){var e,o=wt(this),n=o+(gt(this)-yt(this)-o)-1,r=0;if(t<=o)return r;for(n<t&&(t=n),e=o;e<t;e++)r+=this.Tl(e);return r},St.prototype.Tt=function(t){var e=this.parent;return e&&e.options.scrollIgnoreHidden?this.Zt().visibleIndex[t]:t},St.prototype.cu=function(t){var e=this.parent;return e&&e.options.scrollIgnoreHidden?this.Zt().originalIndex[t]:t},St.prototype.Qt=function(t){var e=this.parent;return e&&e.options.scrollIgnoreHidden?this.Wt().visibleIndex[t]:t},St.prototype.du=function(t){var e=this.parent;return e&&e.options.scrollIgnoreHidden?this.Wt().originalIndex[t]:t},St.prototype.Wt=function(t){var e,o,n,r,i,a,s;if(this.Vt&&!t)return this.Vt;if(n=(o=e=wt(this))+(gt(this)-yt(this)-e)-1,r=this.ss,i={visibleIndex:{},originalIndex:{}},n-o+1<=0)return i;for(a=0,s=o;s<=n;s++)i.originalIndex[a]=s,i.visibleIndex[s]=a,0<r._m(s)&&a++;for(s--,a--;r._m(s)<=0&&o<=s;)i.originalIndex[a]=s,i.visibleIndex[s]=a,s--;return i},St.prototype.Zt=function(t){var e,o,n,r,i,a,s;if(this.Yt&&!t)return this.Yt;if(n=(o=e=xt(this))+(mt(this)-bt(this)-e)-1,r=this.ss,i={visibleIndex:{},originalIndex:{}},n-o+1<=0)return i;for(a=0,s=o;s<=n;s++)i.originalIndex[a]=s,i.visibleIndex[s]=a,0<r.Sl(s)&&a++;for(s--,a--;r.Sl(s)<=0&&o<=s;)i.originalIndex[a]=s,i.visibleIndex[s]=a,s--;return i},St.prototype.Rt=function(t,e){var o,n=xt(this),r=mt(this)-bt(this)-1;if(e){if(r<t&&(t=r),(o=this.gr(t+1))!==W&&n<=o)return o}else if(t<n&&(t=n),(o=this._q(t-1))!==W&&o<=r)return o;return-1},St.prototype.Ot=function(t,e){var o,n=wt(this),r=gt(this)-yt(this)-1;if(e){if(r<t&&(t=r),(o=this.br(t+1))!==W&&n<=o)return o}else if(t<n&&(t=n),(o=this.Zq(t-1))!==W&&o<=r)return o;return-1},St.prototype.eu=function(t,e,o){var n,r,i,a,s;if(o<e)return o;for(n=0,r=this.ss,a=i=o;e<=a;a--)if(!((s=r.Sl(a))<=0)){if(t<(n+=s))break;i=a}return i},St.prototype.LHb=function(t,e,o){var n,r,i=0,a=o,s=0;for(n=o;e<=n;n--)if(!((r=this.Sl(n))<=0)&&(a=n,t<=(i+=r))){s=t-i;break}return{cj:a,UP:s}},St.prototype.fu=function(t,e,o){var n,r,i,a,s;if(o<e)return o;for(n=0,r=this.ss,a=i=o;e<=a;a--)if(!((s=r._m(a))<=0)){if(t<(n+=s))break;i=a}return i},St.prototype.MHb=function(t,e,o){var n,r,i=0,a=o,s=0;for(n=o;e<=n;n--)if(!((r=this.Tl(n))<=0)&&(a=n,t<=(i+=r))){s=t-i;break}return{dj:a,UP:s}},St.prototype.gu=function(){var t,e,o,n=this.am(),r=this.Hr(1,3),i=0,a=0;if(r)for(t=0;t<r.length;t++)i+=e=r[t].width,0<e&&a++;return 0==(o=i/(a=0===a?1:a))?1:O(this.rKc(n)/o)},St.prototype.hu=function(){var t,e,o,n=this.am(),r=this.Gr(1,3),i=0,a=0;if(r)for(t=0;t<r.length;t++)i+=e=r[t].height,0<e&&a++;return 0==(o=i/(a=0===a?1:a))?1:O(this.oKc(n)/o)},St.prototype.ns=function(t){var e,o,n,r,i,a;return z(t)&&(t=3),e=this.parent,o=xt(this),n=bt(this),e&&e.options.scrollbarMaxAlign?(r=this.am(),this.eu(this.oKc(r),o,mt(this)-n-1)):(i=this.getRowCount(t),3!==t&&2!==t||(i-=n),(a=this.gr(i,t))===W&&(a=o),a)},St.prototype.ps=function(t){var e,o,n,r,i,a;return z(t)&&(t=3),o=(e=this).parent,n=wt(e),o&&o.options.scrollbarMaxAlign?(r=e.am(),e.fu(e.rKc(r),n,gt(e)-yt(e)-1)):(i=e.getColumnCount(t),3!==t&&1!==t||(i-=yt(e)),(a=e.br(i,t))===W&&(a=n),a)},St.prototype.iu=function(){var t,e,o,n,r=this,i=xt(r),a=wt(r),s=mt(r)-bt(r)-1,l=gt(r)-yt(r)-1,u=r._modelManager,c=u.getLastNonNullRow(3);return i<c&&(i=c),t=u.getLastNonNullCol(3),a<t&&(a=t),e=u.getLastNonNullRow(2),i<e&&(i=e),o=u.getLastNonNullCol(1),a<o&&(a=o),(n=St._features)&&v(n,function(t,e){var o,n=e.lastNonNullRowAndCol;n&&(o=n.call(r),i=_(i,o.lastNonNullRow),a=_(a,o.lastNonNullCol))}),s<i&&(i=s),l<a&&(a=l),{lastNonNullRow:i,lastNonNullCol:a}},St.prototype.getLastNonNullRow=function(){return this.iu().lastNonNullRow},St.prototype.getLastNonNullColumn=function(){return this.iu().lastNonNullCol},St.prototype.mq=function(t,e,o){var n,r=this.lq,i=this.cCb,a=this.ns(),s=!z(o);r>=this.getRowCount()&&a<t&&(t=a),t>=this._t()&&t<=a&&(s||t!==r||e!==i)&&((n=this.parent)&&(n.ku&&n.ku.ju(this,t,e||0,o),this.os()),n&&!n.options.scrollbarShowMax&&this.es())},St.prototype.rq=function(t,e,o){var n,r=this.qq,i=this.eCb,a=this.ps(),s=!z(o);r>=this.getColumnCount()&&a<t&&(t=a),t>=this.$t()&&t<=a&&(s||t!==r||e!==i)&&((n=this.parent)&&(n.ku&&n.ku.lu(this,t,e||0,o),this.qs()),n&&!n.options.scrollbarShowMax&&this.ds())},St.prototype.yr=function(t,e,o){var n,r,i,a,s,l,u,c=t.row,h=t.col,f=t.hitTestType;return z(c)||z(h)?W:((n=this.getSpan(c,h,f))&&(c=n.row,h=n.col),this.mJb&&(r=this.mJb.oJb(c,h,f))&&(c=r.row,h=r.col),i=this.AHb(c,h,f),a=1===f?-1:G,s=2===f?-1:G,l=this.getCellRect(c,h,a,s,!0),u={sheet:this,row:c,col:h,sheetArea:f},(i.cellType||this.Al(f)).h5(e,o,i,l,u))},St.prototype.mu=function(){this.unbindAll(),this.nu()},St.prototype.ou=function(t,e){var o,n,r,i,a,s,l,u=this.Tq(t),c=u.row,h=u.col,f=c+u.rowCount,p=h+u.colCount;for(n=c;n<f;n++)for(r=h;r<p;r++)if(a=(i=this.getSpan(n,r))?i.row:n,s=i?i.col:r,o=this.getActualStyle(a,s),l=e&&this.Ps(n),!0===o.locked&&!l)return!0;return!1},St.prototype.pu=function(t,e,o,n,r,i){if(-1<=t&&t<r&&-1<=e&&e<i){if(-1===t&&-1===e)return!0;if(-1===t){if(0!==n&&e+n<=i)return!0}else if(-1===e){if(0!==o&&t+o<=r)return!0}else if(0!==n&&e+n<=i&&0!==o&&t+o<=r)return!0}return!1},St.prototype.qu=function(t,e,o,n){var r,i,a;return!(t<0&&e<0)&&(t<0&&(r=this._modelManager.zl(1))&&r.spans&&0<r.spans.length?this._modelManager.qu(-1,e,-1,n,1):e<0&&(i=this._modelManager.zl(2))&&i.spans&&0<i.spans.length?this._modelManager.qu(t,-1,o,-1,2):!!((a=this._modelManager.zl(3))&&a.spans&&0<a.spans.length)&&this._modelManager.qu(t,e,o,n,3))},St.prototype.suspendPaint=function(){var t=this.Xq;this.Xq++,0===t&&St.ao(this,X,{suspend:!0})},St.prototype.resumePaint=function(){this.Xq--,this.Xq<=0&&(this.Xq=0,St.ao(this,X,{suspend:!1}),this.cMc()&&this.$p())},St.prototype.cMc=function(){var t=this.parent;return!t||t.getActiveSheet()===this},St.prototype.isPaintSuspended=function(){return 0<this.Xq},St.prototype.su=function(t,e){var o,n,r=t&&t.length;for(o=0;o<r;o++)if(n=t[o],e.intersect(n.row,n.col,n.rowCount,n.colCount))return t.splice(o,1),this.su(t,e.union(n));return e},St.prototype.getClipboardHelperObj=function(){var t=this.tu();return{isCutting:t.G4,ranges:t.n5,showInsertCopyPasteCells:t.UHb}},St.prototype.tu=function(){var t=this.parent;return this.uu||(this.uu=t&&t.uu),this.uu},St.prototype.vu=function(){if(!this.bt){var t=this;t.bt=new n.oo(function(){t.bt&&(t.parent&&t.parent.fgc&&t.parent.fgc.endingCallback||t.repaint())})}return this.bt},St.prototype.wu=function(){var t=this.parent;if(t)return t.commandManager()},St.prototype.Os=function(t,e){this.Wq(L.Events.InvalidOperation,{sheet:this,sheetName:this.name(),invalidType:t,message:e})},St.prototype.Bq=function(t,e,o,n,r,i){var a;0===this.jm&&(a={sheet:this,sheetName:this.name(),row:e,col:o,sheetArea:n,propertyName:t,oldValue:r,newValue:i,isUndo:this.OIb},this.Wq(L.Events.CellChanged,a),this._modelManager.ZVa(["cellChanged",t,e,o,n,i,r]))},St.prototype.xu=function(t,e,o,n){this.Wq(L.Events.ValueChanged,{sheet:this,sheetName:this.name(),row:t,col:e,oldValue:o,newValue:n})},St.prototype.qCb=function(t,e,o,n,r){var i;if(0===this.jm){if(i={sheet:this,sheetName:this.name(),col:t,sheetArea:e,propertyName:o,newValue:n,oldValue:r,cancel:!1},"addColumns"!==o&&"deleteColums"!==o||(i.count=n),this.Wq(L.Events.ColumnChanging,i),!0===i.cancel)return!1;this._modelManager.ZVa(["columnChanging",t,e,o,r,n])}return!0},St.prototype.pq=function(t,e,o,n,r){var i;0===this.jm?(i={sheet:this,sheetName:this.name(),col:t,sheetArea:e,propertyName:o,newValue:n,oldValue:r,isUndo:this.OIb},"addColumns"!==o&&"deleteColumns"!==o||(i.count=n),this.Wq(L.Events.ColumnChanged,i),this._modelManager.ZVa(["columnChanged",t,e,o,r,n])):this.WXc(this,[{col:t}],1)},St.prototype.RIb=function(t,e,o,n){var r,i,a,s=[];if(this.tables){for(r=this.tables.pJb(t,e,o,n),i=0;i<r.length;i++)s.push(r[i].name());0<s.length&&(a={isUndo:this.OIb,sheet:this,sheetName:this.name(),row:t,col:o,rowCount:e,colCount:n,tableNames:s,action:2},this.Wq(L.Events.RangeChanged,a),this._modelManager.ZVa(["rangeChanged",t,e,o,n]))}},St.prototype.pCb=function(t,e,o,n,r){var i;if(0===this.jm){if(i={sheet:this,sheetName:this.name(),row:t,sheetArea:e,propertyName:o,newValue:n,oldValue:r,cancel:!1},"addRows"!==o&&"deleteRows"!==o||(i.count=n),this.Wq(L.Events.RowChanging,i),!0===i.cancel)return!1;this._modelManager.ZVa(["rowChanging",t,e,o,r,n])}return!0},St.prototype.kq=function(t,e,o,n,r){var i;0===this.jm?(i={sheet:this,sheetName:this.name(),row:t,sheetArea:e,propertyName:o,newValue:n,oldValue:r,isUndo:this.OIb},"addRows"!==o&&"deleteRows"!==o||(i.count=n),this.Wq(L.Events.RowChanged,i),this._modelManager.ZVa(["rowChanged",t,e,o,r,n])):this.WXc(this,[{row:t}],2)},St.prototype.gyb=function(t,e){e!==t&&(this.Wq(L.Events.ViewZoomed,{sheet:this,sheetName:this.name(),oldZoomFactor:t,newZoomFactor:e}),this.Wq(L.Events.UserZooming,{sheet:this,sheetName:this.name(),oldZoomFactor:t,newZoomFactor:e}))},St.prototype.yu=function(t,e){return!(this.n_a||!this._eventHandler.zu(t,e)||(this.Wq(L.Events.SelectionChanging,{sheet:this,sheetName:this.name(),oldSelections:t,newSelections:e}),0))},St.prototype.Au=function(t){this.Wq(L.Events.SelectionChanged,{sheet:this,sheetName:this.name(),oldSelections:t,newSelections:this.getSelections()})},St.prototype.Bu=function(t,e,o,n,r,i,a,s,l,u){var c={sheet:this,sheetName:this.name(),row:t,col:e,rowCount:o,colCount:n,changedCells:r,action:i},h={sheet:this,sheetName:this.name(),row:t,col:e,rowCount:o,colCount:n,changedCells:r,isUndo:!!u,action:i};a&&(c.sheetArea=a,h.sheetArea=a),s&&(c.value=s),r&&0<r.length&&(l&&0<l.length&&(h.tableNames=l),this.Wq(L.Events.RangeChanged,h),this.Wq(L.Events.FormulatextboxRangeChanged,c))},St.prototype._raiseEditorStatusChanged=function(t,e){var o={sheet:this,sheetName:this.name(),oldStatus:t,newStatus:e};this.Wq(L.Events.EditorStatusChanged,o)},St.prototype.Du=function(){return this.b4||(this.b4=h.GC$(g("input"))),this.b4},St.prototype.KLc=function(){return this.parent&&this.parent.options.pasteSkipInvisibleRange},St.prototype.MLc=function(t,e,o){var n,r=0,i=this.getColumnWidth,a=this.getColumnCount();for(o&&(i=this.getRowHeight,a=this.getRowCount()),n=t=t<0?0:t;n<t+e;n++)n<a&&0===i.call(this,n)&&(r++,e++);return r},St.prototype.OLc=function(t,e,o){var n,r=0,i=this.getColumnWidth;for(o&&(i=this.getRowHeight),n=t=t<0?0:t;t-e<n&&0<n;n--)0===i.call(this,n)&&(r++,e++);return r},St.prototype.NLc=function(t,e,o){var n,r=0,i=this.getColumnWidth;for(o&&(i=this.getRowHeight),n=t=t<0?0:t;n<t+e;n++)0===i.call(this,n)&&r++;return r},St.prototype.bind=function(t,e,o){this.Du().bind(t+et,e,o)},St.prototype.unbind=function(t,e){this.Du().unbind(t+et,e)},St.prototype.Wq=function(t,e,o){this.updateEventsData&&this.updateEventsData(t,e),0!==this.jm&&!o||this.Du().trigger(t,e)},St.prototype.unbindAll=function(){this.unbind(et)},St.prototype._bind=function(t,e,o){0<=t.indexOf(".")?this.bind(t,e,o):this.bind(t+ot,e,o)},St.prototype._unbind=function(t,e){0<=t.indexOf(".")?this.unbind(t,e):this.unbind(t+ot,e)},St.prototype.nu=function(){this.unbind(ot)},St.prototype.Dr=function(){var t=this.Zs;return new L.Rect(t.x,t.y,t.width,t.height)},St.prototype.Us=function(t){this.Zs=new L.Rect(t.x,t.y,t.width,t.height)},St.prototype.scroll=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p=this,d=p.parent;d&&(n=(o=d.options).scrollByPixel,r=o.scrollPixel,i=d.ku,a=o.scrollbarShowMax,s=o.showHorizontalScrollbar,l=o.showVerticalScrollbar,0!==e&&(c=(u=i._Bb(p,Math.round(e)/r)).dj,h=n?u.UP:0,c===p.qq&&h===p.eCb||(i.lu(p,c,h),s&&(p.qs(),a||(p.oq=!0)))),0!==t&&(c=(f=i.aCb(p,Math.round(t)/r)).cj,h=n?f.UP:0,c===p.lq&&h===p.cCb||(i.ju(p,c,h),l&&(p.os(),a||(p.jq=!0)))))},St.prototype.isCtrlPressed=function(t){return this._eventHandler&&this._eventHandler.ctrl},St.prototype.deselectIgnoreSpan=function(){return!1},St.prototype.lKc=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y=this,b=y.zoom(),v=e.newValue,C=e.oldValue,w=e.scrollEventType,x=t.options.scrollByPixel,T=t.options.scrollPixel;if(C=e.oldValue=z(C)?0:x?U(C):N(C+"",10),y.jq=!1,r=y._t(),i=y.ns(),a=t.options.scrollbarShowMax,s=0,x){for(l=(v=U(v))-C,w!==R.Nxb.thumbTrack&&(v=C+(l*=T*b))<0&&(v=0),a||(y.jq=!0,w===R.Nxb.smallIncrement&&v===C?v+=T*b:e.ignoreUpdatePosition=!0),c=(u=y.frozenRowCount())+(y.getRowCount()-y.frozenTrailingRowCount()-u)-1,f=h=0,p=u;p<=c;p++)if(v<=(h+=f=y.Sl(p))){s=h-v-f,o=p;break}z(o)&&(o=c,s=-y.Sl(c),v=h)}else o=N(v+"",10),o=y.cu(o),w===R.Nxb.largeDecrement||w===R.Nxb.smallDecrement?(w===R.Nxb.largeDecrement&&(o=y.Ew()),-1!==(n=y.Rt(o,!0))&&n!==o&&(o=n),a||(y.jq=!0,e.ignoreUpdatePosition=!0)):w!==R.Nxb.largeIncrement&&w!==R.Nxb.smallIncrement||(w===R.Nxb.largeIncrement&&(o=y.Fw())===y.lq&&o++,a||(y.jq=!0,w===R.Nxb.smallIncrement&&v===C&&o++),-1!==(n=y.Rt(o))&&n!==o&&(o=n)),o<r&&(o=r),i<o&&(o=i);d=x?U(v):y.Tt(o),e.newValue!==d&&(e.newValue=d),g=d,0!==(m=y.Sl(o))&&(g+=P(s)/m),e.newValueWithOffset=x?d:g,C===d&&!x||t.ku.Bw(y,o,s)},St.prototype.mKc=function(t){var e,o,n,r=t.nKc;r.QB===R.ScrollType.pixels||(e=this.cu(r.value()),o=this._t(),n=this.ns(),e<o?r.value(this.Tt(o)):n<e&&r.value(this.Tt(n))),t.xw(),t.options.scrollbarShowMax||(t.ku.scrolling?this.jq=!0:t.Xt())},St.prototype.iKc=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y=this,b=y.zoom(),v=e.newValue,C=e.oldValue,w=e.scrollEventType,x=t.options.scrollByPixel,T=t.options.scrollPixel;if(C=e.oldValue=z(C)?0:x?U(C):N(C+"",10),y.oq=!1,r=y.$t(),i=y.ps(),a=t.options.scrollbarShowMax,s=0,x){for(l=(v=U(v))-C,w!==R.Nxb.thumbTrack&&(v=C+(l*=T*b))<0&&(v=0),a||(y.oq=!0,w===R.Nxb.smallIncrement&&v===C?v+=T*b:e.ignoreUpdatePosition=!0),c=(u=y.frozenColumnCount())+(y.getColumnCount()-y.frozenTrailingColumnCount()-u)-1,f=h=0,p=u;p<=c;p++)if(v<=(h+=f=y.Tl(p))){s=h-v-f,o=p;break}z(o)&&(o=c,s=-y.Tl(c),v=h)}else o=N(v+"",10),o=y.du(o),w===R.Nxb.largeDecrement||w===R.Nxb.smallDecrement?(w===R.Nxb.largeDecrement&&(o=y.zw()),-1!==(n=y.Ot(o,!0))&&n!==o&&(o=n),a||(y.oq=!0,e.ignoreUpdatePosition=!0)):w!==R.Nxb.largeIncrement&&w!==R.Nxb.smallIncrement||(w===R.Nxb.largeIncrement&&(o=y.Aw())===y.qq&&o++,a||(y.oq=!0,w===R.Nxb.smallIncrement&&v===C&&o++),-1!==(n=y.Ot(o))&&n!==o&&(o=n)),o<r&&(o=r),i<o&&(o=i);d=x?U(v):y.Qt(o),e.newValue!==d&&(e.newValue=d),g=d,0!==(m=y.Tl(o))&&(g+=P(s)/m),e.newValueWithOffset=x?d:g,C===d&&!x||t.ku.Bw(y,o,s,!0)},St.prototype.jKc=function(t){var e,o,n,r=t.kKc;this&&r&&(r.QB===R.ScrollType.pixels||(e=this.du(r.value()),o=this.$t(),n=this.ps(),e<o?r.value(this.Qt(o)):n<e&&r.value(this.Qt(n))),t.xw(),t.options.scrollbarShowMax||(t.ku.scrolling?this.oq=!0:t.Ut()))},St.prototype.Ut=function(t,e,o){var n,r,i,a,s,l,u,c,h,f=this,p=o&&o.QB===R.ScrollType.pixels,d=f.frozenColumnCount(),g=f.getColumnCount()-f.frozenTrailingColumnCount()-d,m=d,y=f.am(),b=f.rKc(y),v=0==g?m:m+g-1,C=f.qq,w=f.eCb,x=0;t?(p?(n=(r=f.MHb(b,m,v)).dj,x=r.UP):n=f.fu(b,m,v),v=n):p&&(x=-f.Tl(v)),e?p&&!t&&(x=-f.Tl(v)):(i=f.iu().lastNonNullCol,(a=f.fu(b,m,i))!==m||v<++a&&(a=v),v=a<C?C<v?C:v:a,x=w),v<C?(f.qq=v,f.eCb=p?x:0):C===v&&w<x&&(f.eCb=p?x:0),-1!==(s=f.Ot(f.qq))&&s!==f.qq&&(f.qq=s),o&&(h=c=u=l=0,p?(l=f.jgc(m),u=f.jgc(v)-x,c=b,h=f.jgc(f.qq)-f.eCb):(l=f.Qt(m),u=f.Qt(v),c=f.gu(),h=f.Qt(f.qq),c<1&&(c=1)),o.bw(l),o.cw(u),o.dw(c),o.ew(),o.value(h))},St.prototype.Xt=function(t,e,o){var n,r,i,a,s,l,u,c,h,f=this,p=o&&o.QB===R.ScrollType.pixels,d=f.frozenRowCount(),g=f.getRowCount()-f.frozenTrailingRowCount()-d,m=d,y=f.am(),b=0==g?m:m+g-1,v=f.lq,C=f.cCb,w=0,x=f.oKc(y);t?(p?(n=(r=f.LHb(x,m,b)).cj,w=r.UP):n=f.eu(x,m,b),b=n):p&&(w=-f.Sl(b)),e?p&&!t&&(w=-f.Sl(b)):(i=f.iu().lastNonNullRow,(a=f.eu(x,m,i))!==m||b<++a&&(a=b),b=a<v?v<b?v:b:a,w=C),b<v?(f.lq=b,f.cCb=p?w:0):v===b&&C<w&&(f.cCb=p?w:0),-1!==(s=f.Rt(f.lq))&&s!==f.lq&&(f.lq=s),o&&(h=c=u=l=0,p?(l=f.kgc(m),u=f.kgc(b)-w,c=x,h=f.kgc(f.lq)-f.cCb):(l=f.Tt(m),u=f.Tt(b),c=f.hu(),h=f.Tt(f.lq),c<1&&(c=1)),o.bw(l),o.cw(u),o.dw(c),o.ew(),o.value(h))},St.prototype.Av=function(){var t,e,o,n,r=this.getRowCount(),i=this.getColumnCount();for(t=0;t<r;t++)for(e=0;e<i;e++)(o=this.getValue(t,e))instanceof Date&&((n=this.getStyle(t,e))&&n.$o(o),this.Nq(t,e,n))},St.Np=1,St.Qp=st,St.Rp=200,St.Sp=20,St.Tp=1,St.Vp=1,lt=St,e.Worksheet=lt,L.Zn(lt),(ut=lt.prototype).visible=m("visible",!0,function(t){var e,o=this.parent,n=o.sheets,r=n.length,i=h.GC$.inArray(this,n),a=o.getActiveSheetIndex();if(t)a<0?(o.dq(i,1),o.YJc&&o.YJc.gq<0&&(o.YJc.gq=i)):o.aq();else if(i===a){for(e=i+1;e<r&&!n[e].visible();)e++;if(r<=e)for(e=i-1;0<=e&&!n[e].visible();)e--;o.YJc&&e<o.YJc.gq&&(o.YJc.gq=e),e<0?(this.no(!1),o.eq=e,o.fq()):o.dq(e,1)}else o.aq()}),ut.frozenColumnCount=m("frozenColumnCount",0,function(t){this.qq<t?this.qq=t:""!==t&&0!==t&&null!==t||(this.qq=0),this.oq=!0,this.$p()},function(t){return 0<=t}),ut.frozenRowCount=m("frozenRowCount",0,function(t){this.lq<t?this.lq=t:""!==t&&0!==t&&null!==t||(this.lq=0),this.jq=!0,this.$p()},function(t){return 0<=t})},"./dist/plugins/celltype/buttoncelltype.js":function(t,e,o){"use strict";var n,b,a,h,r,i,v,s,l,u,c,f,p,d,g,m,y,C,w=this&&this.__extends||(y=function(t,e){return(y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}y(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function x(t,e,o,n){var r,i=t._modelManager;i&&(i.do("setValueForKey",e,o,f,c,n),(r=i.getValueForKey(e,o,p,n))&&(clearTimeout(r),i.do("setValueForKey",e,o,p,c,n)))}function T(){var o,t=C.call(this)||this;return t.typeName="6",o=t,u(g,function(t,e){o["_"+t]=e}),t}Object.defineProperty(e,"__esModule",{value:!0}),n=o("@grapecity/js-sheets-common"),b=o("Core"),a=b.Events.SelectionChanged,h=n.Common.j.Fa,r=b.Ul.nl,i=b.CellTypes.Context,v=b.CellTypes.Text,s=b.CellTypes.Base,l=b.GC$,u=l.each,c=void 0,f="_isFirstMouseUp",p="_mouseupToken",d=".buttonCellType",g={marginTop:2,marginRight:2,marginBottom:2,marginLeft:2,text:"",buttonBackColor:null,buttonState:0},w(T,C=s),T.prototype.paintValue=function(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d,g,m,y;t&&(l=this._marginLeft,u=this._marginTop,c=o+l,h=n+u,f=r-l-this._marginRight,p=i-u-this._marginBottom,0<f-2&&0<p-2&&o<c+f&&c<o+r&&n<h+p&&h<n+i&&(t.save(),(c<o||o+r<c+f||h<n||n+i<h+p)&&(t.rect(o,n,r,i),t.clip()),t.beginPath(),d="#707070",t.strokeStyle!==d&&(t.strokeStyle=d),t.strokeRect(c+.5,h+.5,f-1,p-1),g=void 0,m=this._buttonState,y=this._text,g=2===m?"#34B4E3":(g=this._buttonBackColor)||{degree:90,stops:[{position:0,color:"#F6FAFB"},{position:.125,color:"#F6FAFB"},{position:1,color:"#D2DBEB"}]},t.fillStyle!==g&&(t.fillStyle=g),b.To.setFillStyle(t,g,o,n,r,i,function(){t.fillRect(c+1,h+1,f-2,p-2)}),t.restore(),y&&v.prototype.paintValue.call(this,t,y,c,h,f,p,a,s)))},T.prototype.getText=function(t,e){return t},T.prototype.tw=function(t,e,o,n){var r=t.parent;r&&r.tw(t,e,o,n)},T.prototype.getHitInfo=function(t,e,o,n,r){var i,a,s,l,u,c;return r&&(i=r.sheetArea,(h(i)||3===i)&&n)?(a=n.x+this._marginLeft,s=n.x+n.width-this._marginRight,l=n.y+this._marginTop,u=n.y+n.height-this._marginBottom,c={x:t,y:e,row:r.row,col:r.col,cellRect:n,sheetArea:i,sheet:r.sheet,cellStyle:o},a<=t&&t<=s&&l<=e&&e<=u&&(c.isReservedLocation=!0),c):null},T.prototype.processMouseDown=function(t){var e=t&&t.sheet;return!(!e||!t.isReservedLocation||this.uK||(this.uK=!0,this._buttonState=2,e.repaint(t.cellRect),0))},T.prototype.processMouseUp=function(t){var e,o,n,r,i=t&&t.sheet;if(this.uK&&i&&t.isReservedLocation){if(this._buttonState=0,i.repaint(t.cellRect),this.uK=!1,e=t.row,o=t.col,n=t.sheetArea,!i._modelManager.getValueForKey(e,o,f,n))return this.tw(i,e,o,n),i._modelManager.do("setValueForKey",e,o,f,!0,n),r=setTimeout(function(){x(i,e,o,n)},250),i._modelManager.do("setValueForKey",e,o,p,r,n),!0;x(i,e,o,n)}return!1},T.prototype.processMouseLeave=function(t){var e=t&&t.sheet;e&&this.uK&&(this._buttonState=0,e.repaint(t.cellRect),this.uK=!1)},T.prototype.processKeyDown=function(t,e){var o,n=e.sheet,r=this;return!(!n||r.vK||(o=n.getCellRect(e.row,e.col),r._buttonState=2,n.repaint(o),n._bind(a+d,function(){n._unbind(a+d),r.vK=!1,r._buttonState=0,n.repaint(o)}),r.vK=!0,0))},T.prototype.processKeyUp=function(t,e){var o,n,r,i=e.sheet;return!(!i||!this.vK||(o=e.row,n=e.col,r=i.getCellRect(o,n),this._buttonState=0,i.repaint(r),i._unbind(a+d),this.tw(i,o,n,e.sheetArea),this.vK=!1))},T.prototype.isReservedKey=function(t,e){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},T.prototype.getAutoFitWidth=function(t,e,o,n,r){return i.cp(t,this._text,o,n,r)+this._marginLeft+this._marginRight},T.prototype.getAutoFitHeight=function(t,e,o,n,r){return i.ep(t,this._text,o,n,r)+this._marginTop+this._marginBottom},T.prototype.JH=function(t){this.isReservedKey(t)&&r(t)},T.prototype.isImeAware=function(t){return!1},T.prototype.toJSON=function(){var o,n=this,r={typeName:n.typeName};return u(g,function(t,e){"buttonState"!==t&&(o=n["_"+t])!==e&&(r[t]=o)}),r},T.prototype.fromJSON=function(o){var n=this;u(g,function(t){var e=o[t];h(e)||(n["_"+t]=e)})},T.prototype._createCellTypeElement=function(t){},T.prototype.gQa=function(){},m=T,e.Button=m,u(g,function(e){m.prototype[e]=function(t){return 0===arguments.length?this["_"+e]:(this["_"+e]=t,this)}}),b.CellTypes._o[6]=m},"./dist/plugins/celltype/cellbuttons.js":function(t,e,o){"use strict";var Y,n,r,Q,w,X,$,p,tt,et,ot,nt,rt,it,x,T,f,at,st,lt,ut,ct,ht,ft,A,i,E,D,j,_,O,F,P,L,h,pt,g,a,s,dt,l,u;function S(t){switch(t){case O:return Y.ButtonPosition.left;case F:return Y.ButtonPosition.right;case P:return Y.ButtonPosition.leftOfText;case L:return Y.ButtonPosition.rightOfText}}function M(t){switch(t){case Y.ButtonPosition.left:return O;case Y.ButtonPosition.right:return F;case Y.ButtonPosition.leftOfText:return P;case Y.ButtonPosition.rightOfText:return L}}function d(t){var e,o,n=t.split(" ");for(o=0;o<n.length;o++)if(0<=n[o].indexOf(i)){e=n[o];break}switch(e){case E:return O;case D:return F;case j:return P;case _:return L}}function m(t){switch(t){case O:return E;case F:return D;case P:return j;case L:return _}}function I(t,e,o,n){var r,i=t._modelManager;i&&(i.do("setValueForKey",e,o,x,X,n),(r=i.getValueForKey(e,o,T,n))&&(clearTimeout(r),i.do("setValueForKey",e,o,T,X,n)))}function gt(t,e,o){var n,r;switch(o){case dt.topLeft:return new Y.Rect(t.x,t.y,Math.min(e.width,t.width),Math.min(e.height,t.height));case dt.topCenter:return n=(t.width-e.width)/2,n=Math.max(0,n),new Y.Rect(t.x+n,t.y,Math.min(e.width,t.width),Math.min(e.height,t.height));case dt.topRight:return n=t.width-e.width,n=Math.max(0,n),new Y.Rect(t.x+n,t.y,Math.min(e.width,t.width),Math.min(e.height,t.height));case dt.MiddleLeft:return r=(t.height-e.height)/2,r=Math.max(0,r),new Y.Rect(t.x,t.y+r,Math.min(e.width,t.width),Math.min(e.height,t.height));case dt.MiddleCenter:return n=(t.width-e.width)/2,n=Math.max(0,n),r=(t.height-e.height)/2,r=Math.max(0,r),new Y.Rect(t.x+n,t.y+r,Math.min(e.width,t.width),Math.min(e.height,t.height));case dt.MiddleRight:return n=t.width-e.width,n=Math.max(0,n),r=(t.height-e.height)/2,r=Math.max(0,r),new Y.Rect(t.x+n,t.y+r,Math.min(e.width,t.width),Math.min(e.height,t.height));case dt.bottomLeft:return r=t.height-e.height,r=Math.max(0,r),new Y.Rect(t.x,t.y+r,Math.min(e.width,t.width),Math.min(e.height,t.height));case dt.bottomCenter:return n=(t.width-e.width)/2,n=Math.max(0,n),r=t.height-e.height,r=Math.max(0,r),new Y.Rect(t.x+n,t.y+r,Math.min(e.width,t.width),Math.min(e.height,t.height));case dt.bottomRight:return n=t.width-e.width,n=Math.max(0,n),r=t.height-e.height,r=Math.max(0,r),new Y.Rect(t.x+n,t.y+r,Math.min(e.width,t.width),Math.min(e.height,t.height))}}function c(t,e,o){var n,r,i,a,s,l,u,c,h,f=[];for(n=0;n<t.length;n++)f.push({width:V(t[n].button,e,o),height:(r=t[n].button,(h=c=u=l=s=a=void 0)===a&&(a=!0),s=(i=o).sheet,l=mt(i)?i.printZoomFactor:s.zoom(),u=s.getRowHeight(i.row),c=r.imageSize?r.imageSize.height:$,h=p(1,c||u),isNaN(h)&&(h=1),a?h*l:h)});return f}function N(t,e,o,n,r,i){var a,s,l,u,c=[],h=[];for(a=0;a<t.length;a++)s=e[t[a].index],Q(s)?h.push(t[a]):c.push(s);for(l=function(t){var e,o,n,r,i;if(t.length<=0)return new Y.Rect(0,0,0,0);for(e=t[0].x,o=t[0].y,n=t[0].x+t[0].width,r=t[0].y+t[0].height,i=1;i<t.length;i++)e=Math.min(e,t[i].x),o=Math.min(o,t[i].y),n=Math.max(n,t[i].x+t[i].width),r=Math.max(r,t[i].y+t[i].height);return new Y.Rect(e,o,n-e,r-o)}(c),a=0;a<h.length;a++)u=V(h[a].button,o,n),(!i||l.width+u<=i.width)&&(l.width+=u);return l.height=l.height?l.height:i?i.height:0,l}function y(t,e,o,n,r,i,a,s,l,u,c){var h,f,p,d,g,m,y,b,v,C=z(e,o,a,s,!0,[t]);if(0<C.length){switch(R(C,e,a),t){case Y.ButtonPosition.left:h=E;break;case Y.ButtonPosition.right:h=D;break;case Y.ButtonPosition.leftOfText:h=j;break;case Y.ButtonPosition.rightOfText:h=_;break;default:return}switch(f=N(C,u,r,n,0,i),p="0",d=w(),(Y.Ul.Ml.mozilla||1<d)&&(p="1px"),g=f.width,m=f.height,y=M(t),Q(l.canvasSizes)&&(l.canvasSizes={}),(b=l.canvasSizes)[y]={width:g,height:m},v=function(t,e,o,n){var r,i=document.createElement("canvas");for(r in i.className=t+" "+A,n)n.hasOwnProperty(r)&&(i.style[r]=n[r]);return i.width=e,i.height=o,i}(h,g,m,{width:g+"px",height:m+"px",display:"block",position:"absolute",bottom:p,overflow:"hidden",paddingTop:"0"}),t){case Y.ButtonPosition.left:v.style.left="0";break;case Y.ButtonPosition.right:v.style.right="0";break;case Y.ButtonPosition.leftOfText:v.style.left=b[P].width+"px";break;case Y.ButtonPosition.rightOfText:v.style.right=b[L].width+"px";break;default:return}c.appendChild(v)}}function H(t,e,o,n,r,i,a,s){var l,u,c,h,f,p;if(!Q(t))for(Q(s[o])&&(s[o]={}),R(e,n.sheet,n.row),l=t.getContext("2d"),u=N(e,a,r,n),l.setTransform(parseFloat(t.style.width)/u.width,0,0,parseFloat(t.style.height)/u.height,0,0),c=0,h=new Y.Rect(0,0,parseFloat(t.style.width),parseFloat(t.style.height)),f=0;f<e.length&&(p=B(l,c,0,V(e[f].button,r,n),n.sheet.getRowHeight(n.row),e[f].button,r,n,i,s[o],e[f].index,h),!Q(p));f++)c+=p.width}function b(t,e,o,n,r,i,a,s,l,u,c,h){var f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k=z(e,o,a,s,!0,[t]);if(0<k.length){switch(p=f=void 0,t){case Y.ButtonPosition.left:f=E,p=O;break;case Y.ButtonPosition.right:f=D,p=F;break;case Y.ButtonPosition.leftOfText:f=j,p=P;break;case Y.ButtonPosition.rightOfText:f=_,p=L;break;default:return}if(d=h.querySelector("."+f),Q(d))return;switch(g=parseFloat(d.style.width),m=i.options.contentRect,y=i.options.leftExternalRect,b=i.options.rightExternalRect,t){case Y.ButtonPosition.left:m.x+=g,m.width-=g;break;case Y.ButtonPosition.right:m.width-=g;break;case Y.ButtonPosition.leftOfText:y.width+=g;break;case Y.ButtonPosition.rightOfText:b.width+=g}H(d,k,p,n,r,l,u,c),v=d,C=p,w=n,x=r,T=i.options.cellRect,Q((A=l).eventListeners)&&(A.eventListeners={}),Q(A.eventListeners[C])&&(A.eventListeners[C]={}),M=(S=A.eventListeners[C]).mouseDownListener=function(t){U(G({x:t.offsetX,y:t.offsetY,context:w,cellRect:T,cellStyle:x,buttonArea:C},!0),!0,v)},v.addEventListener("mousedown",M),I=S.mouseUpListener=function(t){J(G({x:t.offsetX,y:t.offsetY,context:w,cellRect:T,cellStyle:x,buttonArea:C},!0),!0,v)},v.addEventListener("mouseup",I),N=S.mouseMoveListener=function(t){Z(G({x:t.offsetX,y:t.offsetY,context:w,cellRect:T,cellStyle:x,buttonArea:C},!0),!0,v)},v.addEventListener("mousemove",N),R=S.mouseLeaveListener=function(t){var e={x:t.offsetX,y:t.offsetY,context:w,cellRect:T,cellStyle:x,buttonArea:C};e.x<0&&(e.x=0),e.x>=parseFloat(v.style.width)&&(e.x=parseFloat(v.style.width)-1),q(G(e,!0),!0,v)},v.addEventListener("mouseleave",R)}}function v(t,e,o,n,r,i,a){var s,l,u,c,h,f,p=z(e,o,n,r,!0,[t]);if(p&&0<p.length)switch(s=M(t),l=i[s]&&i[s].width||0,u=a.contentContainer,c=a.contentRect,h=a.leftExternalRect,f=a.rightExternalRect,t){case Y.ButtonPosition.left:C(u,"left",l),c.x+=l,c.width-=l;break;case Y.ButtonPosition.leftOfText:C(u,"left",l),h.width+=l;break;case Y.ButtonPosition.right:c.width-=l;break;case Y.ButtonPosition.rightOfText:f.width+=l;break;default:return}}function C(t,e,o){var n=0;t.style[e]&&(n=+t.style[e].replace("px","")||0),n+=o,t.style[e]=n-1+"px"}function R(t,e,o){var n,r,i=e.vu();for(n=0;n<t.length;n++)(r=Ct(t[n].button,o))&&i.fo(r)}function mt(t){var e=t.isPrinting,o=t.printZoomFactor;return e&&"number"==typeof o&&1!==o}function k(t,e,o,n,r,i,a){var s,l,u,c,h,f,p;if(t&&!(e.length<=0)){if(r=bt(r),R(e,s=i.sheet,i.row),l=function(t,e,o){switch(o){case Y.ButtonPosition.leftOfText:return new Y.Rect(t.x,t.y,e.x-t.x,t.height);case Y.ButtonPosition.rightOfText:return new Y.Rect(e.x+e.width,t.y,t.x+t.width-e.x-e.width,t.height)}}(o,n,a?Y.ButtonPosition.leftOfText:Y.ButtonPosition.rightOfText),t.save(),t.rect(l.x,l.y,l.width,l.height),t.clip(),t.beginPath(),u=W(s,i.row,i.col,i.sheetArea),c=bt(r),Q(u.layout)&&(u.layout={}),a)for(h=l.x+l.width,f=e.length-1;0<=f&&(p=B(t,h-=V(e[f].button,c,i),o.y,V(e[f].button,c,i),l.height,e[f].button,c,i,u,u.layout,e[f].index,o),!Q(p));f--);else for(h=l.x,f=0;f<e.length&&(p=B(t,h,o.y,V(e[f].button,c,i),l.height,e[f].button,c,i,u,u.layout,e[f].index,o),!Q(p));f++)h+=p.width;t.restore()}}function B(t,e,o,n,r,i,a,s,l,u,c,h){var f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J,Z,q,K=lt;if(l.buttonDownIndex===c?K=ut:l.buttonHoverIndex===c&&(K=ct),f=function(t,e,o,n,r){if(!(t+o<r.x||t>r.x+r.width||e+n<r.y||e>r.y+r.height))return t+o>r.x+r.width&&(o=r.x+r.width-t),e+n>r.y+r.height&&(n=r.y+r.height-e),t<r.x&&(t=r.x),e<r.y&&(e=r.y),new Y.Rect(t,e,o,n)}(e,o,n,r,h),!Q(f))return p=t,d=f.x,g=f.y,m=f.width,y=f.height,b=i,v=a,C=s,w=K,x=h,p.save(),p.beginPath(),T=b.useButtonStyle,A=mt(C),S=C.printZoomFactor,M=A?S:C.sheet.zoom(),d+=I=T?st*M:0,g+=I,m-=2*I,y-=2*I,N=et,R=b.hoverBackColor||rt,N&&p.strokeStyle!==N&&(p.strokeStyle=N),T&&p.strokeRect(d+.5,g+.5,m-1,y-1),k=wt(b.enabled,C.row),T?E=!1===b.enabled?b.buttonBackColor||nt:w===ut?ot:w===ct||C.visualState===Y.VisualState.hover?R:((D=p.createLinearGradient(d+m/2,g,d+m/2,g+y)).addColorStop(.125,"#F6FAFB"),D.addColorStop(1,"#D2DBEB"),b.buttonBackColor||D):(E=b.buttonBackColor||"white",w===ct&&(b.enabled||Q(b.enabled))&&(E=R)),(j=v.font)&&p.font!==j&&(p.font=j),p.fillStyle!==E&&(p.fillStyle=E),d+=1,g+=1,m-=2,y-=2,p.rect(d,g,m,y),p.clip(),p.beginPath(),p.fillRect(d,g,m,y),_=new Y.Rect(d,g,m,y),O=new Y.Rect(d,g,m,y),F=at*M,P=Ct(b,C.row),b.caption&&P&&(L=(ft.cp($,b.caption,v,M,C)+2*st)*M,H=yt(b)*M,B=new Y.Rect(0,0,L+H+F,y),V=new Y.Rect(d,g,m,y),z=gt(V,B,dt.MiddleCenter),b.captionAlign===Y.CaptionAlignment.left?(O=new Y.Rect(z.x,g,L,y),_=z.x+L+F<d+m-2?new Y.Rect(z.x+L+F,g,Math.max(0,H),y):new Y.Rect(0,0,0,0)):(_=new Y.Rect(z.x,g,Math.min(H,m),y),O=z.x+H+F<d+m-2?new Y.Rect(z.x+H+F,g,Math.min(m-2-H-F,L),y):new Y.Rect(0,0,0,0))),b.caption&&(W=(ft.cp($,b.caption,v,M,C)+2*st)*M,G=(ft.ep($,b.caption,v,M,C)+2*st)*M,U=new Y.Rect(0,0,W,G),J=gt(O,U,dt.MiddleCenter),Z=new ht,v=v.clone(),!1===k&&(v.foreColor=it),v.cellButtons=X,q=A?0:2,Z.paintValue(p,b.caption,J.x,J.y-q,J.width,J.height,v,C)),P&&function(t,e,o,n,r,i,a,s,l){var u,c,h,f,p,d,g,m,y,b,v,C,w;t.save(),t.rect(o+2,n+2,r-4,i-4),t.clip(),t.beginPath(),u=s.sheet,(c=u.vu()).ko(a)?c.bgc(a)&&(h=mt(s)?s.printZoomFactor:u.zoom(),f=new Y.Rect(o,n,r,i),p=yt(e)-2,d=function(t){var e;return t.imageSize&&("string"==typeof t.imageSize.height&&(e=tt(t.imageSize.height)),"number"==typeof t.imageSize.height&&(e=t.imageSize.height)),(e===$||isNaN(e)||e<0)&&(e=16),e}(e)-2,g=new Y.Rect(0,0,p*h,d*h),m=gt(f,g,dt.MiddleCenter),y=c.lo(a),b=y.width,v=y.height,Y.Ul.Ml.msie&&e.imageType&&(v=e.imageType===Y.ButtonImageType.custom?(pt[a]||(y.style.position="absolute",y.style.left="-10000px",y.style.top="-100000px",document.body.appendChild(y),pt[a]={width:y.width,height:y.height},document.body.removeChild(y)),b=pt[a].width,pt[a].height):b=12),l&&Y.Ul.Ml.msie&&m.x+m.width>l.x+l.width?0<(C=l.x+l.width-m.x)&&(w=b/(p*h),t.drawImage(y,0,0,C*w,v,m.x,m.y,C,d*h)):t.drawImage(y,0,0,b,v,m.x,m.y,p*h,d*h)):c.fo(a),t.restore()}(p,b,_.x,_.y,_.width,_.height,P,C,x),p.restore(),u[c]=new Y.Rect(f.x,f.y,f.width,f.height),u[c].offsetX=f.x-h.x,u[c].offsetY=f.y-h.y,u[c]}function V(t,e,o,n){var r,i,a,s,l;return void 0===n&&(n=!0),r=mt(o)?o.printZoomFactor:o.sheet.zoom(),i=2*st+3,Q(t.width)?(a=ft.cp($,t.caption,e,r,o),s=t.useButtonStyle,Ct(t,o.row)&&(a=yt(t)+a,i=(s?i:0)+at),n?(a+i+7)*r:a+i+7):(l=p(1,t.width),isNaN(l)&&(l=1),n?l*r:l)}function z(t,e,o,n,r,i){var a,s,l,u,c,h=[];if(!e||0===e.length)return[];for(a=!1,s=t._modelManager.getValueForKey(o,n,f),t.getActiveRowIndex()===o&&t.getActiveColumnIndex()===n&&!0!==s&&(a=!0),l=0;l<e.length;l++)for(u=e[l].visible,c=0;c<i.length;c++)(e[l].position===i[c]||Q(e[l].position)&&i[c]===Y.ButtonPosition.right)&&(u&&"function"==typeof u?u(o)&&h.push({index:l,button:e[l]}):(e[l].visibility===Y.ButtonVisibility.onEditing&&r||e[l].visibility!==Y.ButtonVisibility.onEditing&&a||e[l].visibility===Y.ButtonVisibility.always||Q(e[l].visibility))&&h.push({index:l,button:e[l]}));return h}function yt(t){var e;return t.imageSize&&("string"==typeof t.imageSize.width&&(e=tt(t.imageSize.width)),"number"==typeof t.imageSize.width&&(e=t.imageSize.width)),(e===$||isNaN(e)||e<0)&&(e=16),e}function W(t,e,o,n,r){var i,a,s,l,u,c={isMouseDownReservedLocation:!1};return n===Y.SheetArea.corner?c:((i=t._modelManager.getValueForKey(e,o,h,n))||r||(a=e,s=o,l=n,u=i=c,t._modelManager.setValueForKey(a,s,h,u,l)),i)}function G(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x;if(void 0===e&&(e=!1),o=t.context.row,n=t.context.col,r=t.cellRect,i=t.cellStyle,a=t.context,l=(s={x:t.x,y:t.y,row:o,col:n,cellRect:r,cellStyle:i,sheetArea:t.context.sheetArea,sheet:t.context.sheet,context:a}).sheet,!1!==t.cellStyle.locked&&l.options.isProtected)return null;if(u=W(l,s.row,s.col,s.sheetArea,!0),c=t.cellStyle.cellButtons,!u||!c||c.length<=0)return null;if(h=u.layout,e&&(h=u.editorLayout[t.buttonArea]),!h)return null;for(g in f=-1,p=s.x,d=s.y,h)if(h.hasOwnProperty(g)&&(m=void 0,y=h[g],(m=e?new Y.Rect(y.x,y.y,y.width,y.height):new Y.Rect(r.x+y.offsetX,r.y+y.offsetY,y.width,y.height))&&m.contains(p,d))){f=+g;break}return-1!==f?s.cellButtonHitInfo={hitButtonIndex:f,buttonConfig:c[f],buttonArea:t.buttonArea}:(b=l.getCellType(s.row,s.col))&&(v=N(z(l,c,o,n,e,[Y.ButtonPosition.left]),h,i,a),C=N(z(l,c,o,n,e,[Y.ButtonPosition.right]),h,i,a),w=new Y.Rect(r.x+v.width,r.y,r.width-v.width-C.width,r.height),(x=b.getHitInfo(s.x,s.y,i,w,a))&&x.isReservedLocation&&(s.isReservedLocation=!0)),s}function U(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m,y;return void 0===e&&(e=!1),t&&t.cellButtonHitInfo&&(n=t.sheet,i=t.row,a=t.col,s=t.sheetArea,(i===n.Jl&&a===n.Kl||s!==Y.SheetArea.viewport||n.endEdit())&&(t.cellButtonHitInfo.buttonConfig&&(r=t.cellButtonHitInfo.buttonConfig.hasOverLay),l=W(n,i,a,t.sheetArea),t.cellButtonHitInfo&&(c=t.cellButtonHitInfo.hitButtonIndex,u=t.cellButtonHitInfo.buttonConfig),h=wt(u.enabled,t.row),n&&(!l.isMouseDownReservedLocation||r)&&u&&(h||Q(h))&&0<=c&&(l.buttonDownIndex=c,l.isMouseDownReservedLocation=!0,e&&o?(f=t.cellStyle,p=l.layout,d=t.context,g=l.editorLayout,m=t.cellButtonHitInfo&&t.cellButtonHitInfo.buttonArea,y=f.cellButtons,m&&H(o,z(n,y,i,a,!0,[S(m)]),m,d,f,l,p,g)):n.repaint(t.cellRect),1)))}function J(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m;if(void 0===e&&(e=!1),t){if(n=t&&t.sheet,r=t.row,i=t.col,a=W(n,t.row,t.col,t.sheetArea),s=t.cellButtonHitInfo,a.isMouseDownReservedLocation&&n){if(s&&0<=s.hitButtonIndex&&s.buttonConfig.command&&(l=s.buttonConfig.command,e||n.getActiveRowIndex()===r&&n.getActiveColumnIndex()===i||n.DJ(r,i,1,1,2),"string"==typeof l?n.getParent().commandManager().execute({cmd:l,row:r,col:i,sheetName:n.name(),sheetArea:t.sheetArea}):"function"==typeof l&&l.call($,n,r,i,t.sheetArea)),e&&0<=a.buttonDownIndex&&o&&(a.buttonDownIndex=-1,u=t.cellStyle,c=a.layout,h=t.context,f=a.editorLayout,p=s&&s.buttonArea,d=u.cellButtons,p&&H(o,z(n,d,r,i,!0,[S(p)]),p,h,u,a,c,f)),a.buttonDownIndex=-1,e||n.repaint(t.cellRect),a.isMouseDownReservedLocation=!1,g=t.sheetArea,!n._modelManager.getValueForKey(r,i,x,g))return b=r,v=i,C=g,(w=(y=n).parent)&&w.tw(y,b,v,C),n._modelManager.do("setValueForKey",r,i,x,!0,g),m=setTimeout(function(){I(n,r,i,g)},250),n._modelManager.do("setValueForKey",r,i,T,m,g),1;I(n,r,i,g)}}else var y,b,v,C,w}function Z(t,e,o){var n,r,i,a,s,l,u,c,h,f;return void 0===e&&(e=!1),t&&(r=W(n=t&&t.sheet,t.row,t.col,t.sheetArea),i=-1,t.cellButtonHitInfo&&(i=t.cellButtonHitInfo.hitButtonIndex),i!==(Q(r.buttonHoverIndex)?-1:r.buttonHoverIndex)&&(r.buttonHoverIndex=i,e?(a=t.cellStyle,s=r.layout,l=t.context,u=r.editorLayout,c=a.cellButtons,h=t.row,f=t.col,o&&K(c,n,h,f,o.parentElement,l,a,r,s,u)):n.repaint(t.cellRect),1))}function q(t,e,o){var n,r,i,a,s,l,u,c,h;void 0===e&&(e=!1),t&&t.cellButtonHitInfo&&(r=W(n=t&&t.sheet,t.row,t.col,t.sheetArea),e?(r.buttonHoverIndex=-1,0<=t.cellButtonHitInfo.hitButtonIndex&&(i=t.cellStyle,a=r.layout,s=t.context,l=r.editorLayout,u=i.cellButtons,c=t.row,h=t.col,o&&K(u,n,c,h,o.parentElement,s,i,r,a,l))):(n&&(r.buttonHoverIndex=-1,r.buttonDownIndex=-1,r.isMouseDownReservedLocation=!1),n.repaint(t.cellRect)))}function K(t,e,o,n,r,i,a,s,l,u){var c,h;for(c=0;c<g.length;c++)h=M(g[c]),H(r.querySelector("."+m(h)),z(e,t,o,n,!0,[S(h)]),h,i,a,s,l,u)}function bt(t){var e=t.clone(!0);return e.hAlign=Y.HorizontalAlign.left,e.vAlign=Y.VerticalAlign.center,e.wordWrap=!1,e.isVerticalText=!1,e.shrinkToFit=!1,e.formatter="General",e.textIndent=0,e}function vt(t,e,o,n,r){var i,a=t.AHb(e,o,r);if(a&&a.cellButtons&&0<a.cellButtons.length&&0<a.cellButtons.filter(function(t){return 1===t.visibility}).length){n&&t._modelManager.do("setValueForKey",e,o,f,!0,r);try{i=t.getCellRect(e,o,1===r?-1:void 0,2===r?-1:void 0),t.repaint(i)}finally{n&&t._modelManager.do("setValueForKey",e,o,f,X,r)}}}function Ct(t,e){var o,n,r=null,i=t.imageType;if(Q(t.imageType))return null;switch(n=(o=wt(t.enabled,e))||Q(o),i){case Y.ButtonImageType.dropdown:r=n?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case Y.ButtonImageType.left:r=n?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case Y.ButtonImageType.right:r=n?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case Y.ButtonImageType.clear:r=n?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case 3:r=n?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case Y.ButtonImageType.ok:r=n?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case Y.ButtonImageType.plus:r=n?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiM2RTZFNkUiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiNDQUNBQ0EiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case Y.ButtonImageType.minus:r=n?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiM2RTZFNkUiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiNDQUNBQ0EiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+";break;case Y.ButtonImageType.redo:r=n?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case Y.ButtonImageType.undo:r=n?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case Y.ButtonImageType.search:r=n?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case Y.ButtonImageType.separator:r=n?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case Y.ButtonImageType.spinLeft:r=n?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case Y.ButtonImageType.spinRight:r=n?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iIzZFNkU2RSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iI0NBQ0FDQSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case Y.ButtonImageType.ellipsis:r=n?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case Y.ButtonImageType.expand:r=n?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==";break;case Y.ButtonImageType.collapse:r=n?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=":"data:image/svg+xml;PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=";break;case Y.ButtonImageType.custom:r=t.imageSrc}return r}function wt(t,e){return"function"==typeof t?t(e):t}Object.defineProperty(e,"__esModule",{value:!0}),Y=o("Core"),n=o("@grapecity/js-sheets-common"),r=o("./dist/plugins/celltype/celltypes.ns.js"),Q=n.Common.j.Fa,Y.To.No,Y.Ul.fp,w=Y.En.npb,X=void 0,$=null,p=Math.max,tt=parseInt,et="#707070",ot="#34B4E3",nt="#e6e6e6",rt="lightgray",it="#CACACA",x="_isFirstMouseUp",T="_mouseupToken",f="_leaveCell",lt=at=0,ut=st=2,ct=3,ht=Y.CellTypes.Base,ft=Y.CellTypes.Context,A="gc-cell-button-canvas",E=(i="gc-editor-")+"left-cellbuttons",D=i+"right-cellbuttons",j=i+"left-of-text-cellbuttons",_=i+"right-of-text-cellbuttons",O="leftButtonArea",F="rightButtonArea",P="leftOfTextButtonArea",L="rightOfTextButtonArea",h="_cellButtonParam",pt={},Y.GC$,g=[Y.ButtonPosition.left,Y.ButtonPosition.right,Y.ButtonPosition.leftOfText,Y.ButtonPosition.rightOfText],a=new n.Common.ResourceManager(r.SR,"CellTypes"),s=a.getResource.bind(a),(u=dt=dt||{})[u.topLeft=0]="topLeft",u[u.topCenter=1]="topCenter",u[u.topRight=2]="topRight",u[u.MiddleLeft=3]="MiddleLeft",u[u.MiddleCenter=4]="MiddleCenter",u[u.MiddleRight=5]="MiddleRight",u[u.bottomLeft=6]="bottomLeft",u[u.bottomCenter=7]="bottomCenter",u[u.bottomRight=8]="bottomRight",Y.CellTypes.Base.$n("cellButton",{beforePaintLabel:function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b=t.options.context,v=t.options.style;if(!b.cellOverflowLayout&&v.cellButtons&&0<v.cellButtons.length&&(e=t.options.context.sheet,o=b.row,n=b.col,(r=z(e,v.cellButtons,o,n,!1,[Y.ButtonPosition.left,Y.ButtonPosition.right]))&&0<r.length)){if(i=bt(v),R(r,e,t.options.context.row),!(a=t.ctx))return;for(s=t.options.rect,a.save(),a.rect(s.x,s.y,s.width,s.height),a.clip(),a.beginPath(),l=s.x,u=s.x+s.width,c=W(e,b.row,b.col,b.sheetArea),Q(c.layout)&&(c.layout={}),h=c.layout,f=z(e,v.cellButtons,o,n,!1,[Y.ButtonPosition.left]),p=0;p<f.length&&(d=B(a,l,s.y,V(f[p].button,i,b),s.height,f[p].button,i,b,c,h,f[p].index,s),!Q(d));p++)l+=d.width;for(g=l,l=u,p=(m=z(e,v.cellButtons,o,n,!1,[Y.ButtonPosition.right])).length-1;0<=p&&(d=B(a,l-=y=V(m[p].button,i,b),s.y,y,s.height,m[p].button,i,b,c,h,m[p].index,s),!Q(d));p--);a.restore(),s.x=g,s.width=l-g}},beforePaintText:function(t){var e,o,n,r,i=t.context,a=t.style;!i.cellOverflowLayout&&a.cellButtons&&0<a.cellButtons.length&&(e=t.context.sheet,o=i.row,n=i.col,(r=t.externals).left=r.left.concat(c(z(e,a.cellButtons,o,n,!1,[Y.ButtonPosition.leftOfText]),a,i)),r.right=r.right.concat(c(z(e,a.cellButtons,o,n,!1,[Y.ButtonPosition.rightOfText]),a,i)))},beforeFillTextArea:function(t){var e,o,n,r,i=t.style,a=i.cellButtons;i.cellButtons&&0<i.cellButtons.length&&(e=t.ctx,o=t.availRect,n=t.textRect,k(e,z((r=t.context).sheet,a,r.row,r.col,!1,[Y.ButtonPosition.leftOfText]),o,n,i,r,!0))},afterFillTextArea:function(t){var e,o,n,r,i=t.style,a=i.cellButtons;i.cellButtons&&0<i.cellButtons.length&&(e=t.ctx,o=t.availRect,n=t.textRect,k(e,z((r=t.context).sheet,a,r.row,r.col,!1,[Y.ButtonPosition.rightOfText]),o,n,i,r,!1))},onCreateCellEditor:function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d=t.options.dom;if(d&&d.children&&((e=d.children[0])&&e.children&&e.children[0])){if(n=(o=t.context).sheet,r=o.row,i=o.col,a=t.options.cellStyle,Q(a)&&(a=n.getActualStyle(r,i)),s=a.cellButtons,Q(s)||s&&s.length<=0)return;for(l=t.options.cellRect,u=new Y.Rect(l.x,l.y,l.width,l.height),c=W(n,r,i,o.sheetArea),Q(c.layout)&&(c.layout={}),h=c.layout,f=!1,p=0;p<s.length;p++)s[p].position!==Y.ButtonPosition.leftOfText&&s[p].position!==Y.ButtonPosition.rightOfText||(f=!0);for(f&&(e.style.overflow="hidden"),p=0;p<g.length;p++)y(g[p],n,s,o,a,u,r,i,c,h,d)}},onActivateCellEditor:function(t){var e,o,n,r,i,a,s=t.context,l=s.sheet,u=s.row,c=s.col,h=t.options.cellStyle,f=h.cellButtons;if(!(Q(f)||f.length<=0))for(e=W(l,u,c,s.sheetArea),Q(e.editorLayout)&&(e.editorLayout={}),o=e.layout,n=e.editorLayout,r=bt(h),i=t.options.dom,a=0;a<g.length;a++)b(g[a],l,f,s,r,t,u,c,e,o,n,i)},onDeactivateCellEditor:function(t){var e,o,n,r,i,a,s,l,u=t.context,c=u.sheet,h=u.row,f=u.col,p=c.getActualStyle(h,f,u.sheetArea).cellButtons;if(p&&0<p.length)for(o=(e=W(u.sheet,h,f,u.sheetArea)).eventListeners,n=t.options.dom.querySelectorAll("."+A),r=0;r<n.length;r++)a=d((i=n[r]).className),Q(a)||Q(o)||Q(o[a])||(s=i,l=o[a],Q(l.mouseDownListener)||s.removeEventListener("mousedown",l.mouseDownListener),Q(l.mouseUpListener)||s.removeEventListener("mouseup",l.mouseUpListener),Q(l.mouseMoveListener)||s.removeEventListener("mousemove",l.mouseMoveListener),Q(l.mouseLeaveListener)||s.removeEventListener("mouseleave",l.mouseLeaveListener),delete e.eventListeners[a])},onUpdateContainer:function(t){var e,o=t.context,n=o.sheet,r=o.row,i=o.col,a=W(o.sheet,r,i,o.sheetArea).canvasSizes,s=t.cellStyle.cellButtons;if(!(Q(s)||s.length<=0))for(t.context.preventOverflow=!0,e=0;e<g.length;e++)v(g[e],n,s,r,i,a,t)},getCellButtonHitInfo:function(t){t.paddingHitInfo=G(t)},processMouseDownOnCellPadding:function(t){U(t)},processMouseUpOnCellPadding:function(t){J(t)},processMouseMoveOnCellPadding:function(t){Z(t)},processMouseLeaveOnCellPadding:function(t){q(t)},getCellButtonAutoHeight:function(o){var t,n,r=o.context.sheet,i=o.context.row,e=o.context.col,a=o.cellStyle;a.cellButtons&&0!==a.cellButtons.length&&(t=z(r,a.cellButtons,i,e,!1,[Y.ButtonPosition.left,Y.ButtonPosition.right]),n=0,t.forEach(function(t){var e=ft.ep($,t.button.caption,a,r.zoom(),o.context)-2;Ct(t.button,i)&&(e=p(e,yt(t.button))),n=p(e,n)}),o.value=n+ +st)},getCellButtonAutoWidth:function(e){var t,o,n=e.context.sheet,r=e.context.row,i=e.context.col,a=e.cellStyle;a.cellButtons&&0!==a.cellButtons.length&&(t=z(n,a.cellButtons,r,i,!1,[Y.ButtonPosition.left,Y.ButtonPosition.right]),o=0,t.forEach(function(t){o+=V(t.button,a,e.context,!1)}),e.value=o)}}),l="cellButtons",Y.Worksheet.$n(l,{setHost:function(){var o=this;o.bind(Y.Events.EnterCell+"."+l,function(t,e){vt(o,e.row,e.col,!1,e.sheetArea)}),o.bind(Y.Events.LeaveCell+"."+l,function(t,e){vt(o,e.row,e.col,!0,e.sheetArea)}),o.bind(Y.Events.TopRowChanged+"."+l,function(t,e){vt(o,e.row,e.col,!0,e.sheetArea)})},dispose:function(t){this.unbind(Y.Events.EnterCell+"."+l),this.unbind(Y.Events.LeaveCell+"."+l),this.unbind(Y.Events.TopRowChanged+"."+l)},processMouseDown:function(t){var e=t.hitInfo.cellTypeHitInfo;e&&e.cellButtonHitInfo&&U(e)&&(t.r=!0)}}),Y.Workbook.$n(l,{onCultureChanged:function(){s()}})},"./dist/plugins/celltype/celltypes.entry.js":function(t,o,e){"use strict";var n,r,i,a,s;function l(t){for(var e in t)o.hasOwnProperty(e)||(o[e]=t[e])}Object.defineProperty(o,"__esModule",{value:!0}),r=(n=e("Core")).CellTypes.Base,i=n.CellTypes.Context,a=n.CellTypes.EditorType,s=n.CellTypes._o,o.Base=r,o.Context=i,o.EditorType=a,o._o=s,o.vHb=n.CellTypes.vHb,o.wHb=n.CellTypes.wHb,Object.defineProperty(o,"Corner",{set:function(t){t!==o.vHb.Corner&&(o.vHb.Corner=t)},get:function(){return o.vHb.Corner}}),Object.defineProperty(o,"ColumnHeader",{set:function(t){t!==o.vHb.ColumnHeader&&(o.vHb.ColumnHeader=t)},get:function(){return o.vHb.ColumnHeader}}),Object.defineProperty(o,"RowHeader",{set:function(t){t!==o.vHb.RowHeader&&(o.vHb.RowHeader=t)},get:function(){return o.vHb.RowHeader}}),Object.defineProperty(o,"Text",{set:function(t){t!==o.wHb.Text&&(o.wHb.Text=t)},get:function(){return o.wHb.Text}}),l(e("./dist/plugins/celltype/checkboxcelltype.js")),l(e("./dist/plugins/celltype/buttoncelltype.js")),l(e("./dist/plugins/celltype/hyperlinkcelltype.js")),l(e("./dist/plugins/celltype/comboboxcelltype.js")),e("./dist/plugins/celltype/cellbuttons.js"),l(e("./dist/plugins/celltype/editor/colorpicker.js")),l(e("./dist/plugins/celltype/editor/timepicker.js")),l(e("./dist/plugins/celltype/editor/calendar.js")),l(e("./dist/plugins/celltype/editor/calculator.js")),l(e("./dist/plugins/celltype/editor/monthPicker.js")),l(e("./dist/plugins/celltype/editor/listControl.js")),l(e("./dist/plugins/celltype/dropdown-action.js")),l(e("./dist/plugins/celltype/radiochecklistcelltype.js")),l(e("./dist/plugins/celltype/celltypes.ns.js")),l(e("./dist/plugins/celltype/rangecelltype.js"))},"./dist/plugins/celltype/celltypes.ns.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("./dist/plugins/celltype/celltypes.res.en.js");e.SR={en:n}},"./dist/plugins/celltype/celltypes.res.en.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.OK="OK",e.Cancel="Cancel",e.Calendar_ShortWeeks_1="MON",e.Calendar_ShortWeeks_2="TUE",e.Calendar_ShortWeeks_3="WED",e.Calendar_ShortWeeks_4="THU",e.Calendar_ShortWeeks_5="FRI",e.Calendar_ShortWeeks_6="SAT",e.Calendar_ShortWeeks_7="SUN",e.Calendar_Weeks_1="Monday",e.Calendar_Weeks_2="Tuesday",e.Calendar_Weeks_3="Wednesday",e.Calendar_Weeks_4="Thursday",e.Calendar_Weeks_5="Friday",e.Calendar_Weeks_6="Saturday",e.Calendar_Weeks_7="Sunday",e.Calendar_ShortMonths_1="JAN",e.Calendar_ShortMonths_2="FEB",e.Calendar_ShortMonths_3="MAR",e.Calendar_ShortMonths_4="APR",e.Calendar_ShortMonths_5="MAY",e.Calendar_ShortMonths_6="JUN",e.Calendar_ShortMonths_7="JUL",e.Calendar_ShortMonths_8="AUG",e.Calendar_ShortMonths_9="SEP",e.Calendar_ShortMonths_10="OCT",e.Calendar_ShortMonths_11="NOV",e.Calendar_ShortMonths_12="DEC",e.Calendar_Months_1="JANUARY",e.Calendar_Months_2="FEBRUARY",e.Calendar_Months_3="MARCH",e.Calendar_Months_4="APRIL",e.Calendar_Months_5="MAY",e.Calendar_Months_6="JUNE",e.Calendar_Months_7="JULY",e.Calendar_Months_8="AUGUST",e.Calendar_Months_9="SEPTEMBER",e.Calendar_Months_10="OCTOBER",e.Calendar_Months_11="NOVEMBER",e.Calendar_Months_12="DECEMBER",e.Calendar_Time_AM="AM",e.Calendar_Time_PM="PM",e.Calendar_EraName_1="M",e.Calendar_EraName_2="T",e.Calendar_EraName_3="S",e.Calendar_EraName_4="H",e.Calendar_FirstYear="1",e.Calendar_Today="Today",e.Calendar_LastMonth="Go to previous month",e.Calendar_NextMonth="Go to next month",e.Calendar_LastYear="Go to previous year",e.Calendar_NextYear="Go to next year",e.Calendar_LastTenYear="Go to previous ten years",e.Calendar_NextTenYear="Go to next ten years",e.Quarter_Format_1="Q1",e.Quarter_Format_2="Q2",e.Quarter_Format_3="Q3",e.Quarter_Format_4="Q4",e.ThemeColor="Theme Colors",e.StandardColor="Standard Colors",e.Calculator_DivideByZeroInfo="Cannot divide by zero.",e.Calculator_InvalidInputInfo="Invalid Input.",e.Calculator_SqrtParameterException="Invalid input for function.",e.Calculator_OverFlowInfo="Arithmetic operation resulted in an overflow.",e.MultiColumn_InvalidDataSource="Invalid data source. The formula should return an array."},"./dist/plugins/celltype/checkboxcelltype.js":function(t,e,o){"use strict";var n,j,c,_,O,s,u,r,F,i,P,a,h,L,H,B,l,f,p,d,g,V,m,y,b,v,C,w=this&&this.__extends||(b=function(t,e){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}b(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function x(t,e,o,n){var r,i=t._modelManager;i&&(i.do("setValueForKey",e,o,p,a,n),(r=i.getValueForKey(e,o,d,n))&&(clearTimeout(r),i.do("setValueForKey",e,o,d,a,n)))}function T(){var o,t=v.call(this)||this;return t.typeName="5",t._boxSize=V,o=t,i(m,function(t,e){o["_"+t]=e}),t}function z(t,e,o,n,r){var i=5*r,a=e.hAlign,s=o.x-1,l=o.width+1,u=0,c=0;return 0===t||1===t?(c=s+i,1===a?c=s+l/2-V*r/2:2===a&&(c=s+l-i-V*r)):2===t?(u=V*r+n,c=s+i+n,1===a?c=s+l/2-u/2+n:2===a&&(c=s+l-i-u+n)):(u=V*r+n,c=s+i,1===a?c=s+l/2-u/2:2===a&&(c=s+l-i-u)),c-s}function W(t,e,o,n,r){var i=5*r,a=e.vAlign,s=o.y-1,l=o.height+1,u=0,c=0;return 0===t?(u=V*r+n,c=s+i+n,1===a?c=s+l/2-u/2+n:2===a&&(c=s+l-i-u+n)):1===t?(u=V*r+n,c=s+i,1===a?c=s+l/2-u/2:2===a&&(c=s+l-i-u)):(c=s+i,1===a?c=s+l/2-V*r/2:2===a&&(c=s+l-i-V*r)),c-s}function A(t,e,o,n,r){var i=e.getValue(o,n,r),a=t.rK(i),s={cmd:"editCell",sheetName:e.name(),row:o,col:n,newValue:a,autoFormat:!0};e.wu().execute(s),t.tw(e,o,n,r)}function S(t,e,o,n,r){var i=r&&r.sheet,a=t.getEditorValue(e,r);t.setEditorValue(e,a,r),t.updateEditor(e,o,n,r),t.tw(i,i.Jl,i.Kl,r.sheetArea)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("@grapecity/js-sheets-common"),j=o("Core"),c=j.Ul.Nl,_=n.Common.j.Fa,O=j.Ul.fp,s=j.Ul.nl,u=j.CellTypes.Context,r=j.CellTypes.Base,F=j.GC$,i=F.each,P=j.Ul.hZa,a=void 0,h=Math.max,L=parseInt,H="left",B="alphabetic",l=".gcEditingInput",f="normal 11pt calibri",p="_isFirstMouseUp",d="_mouseupToken",(C=g=e.CheckBoxTextAlign||(e.CheckBoxTextAlign={}))[C.top=0]="top",C[C.bottom=1]="bottom",C[C.left=2]="left",C[C.right=3]="right",m={caption:"",textTrue:"",textIndeterminate:"",textFalse:"",textAlign:3,isThreeState:!(V=12),boxSize:V},w(T,v=r),T.prototype.paintValue=function(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D;t&&(t.save(),t.rect(o,n,r,i),t.clip(),t.beginPath(),l=a.hAlign,u=a.font,c=a.foreColor,h=this._textAlign,f=this.getText(e,s),d=p=0,(g=s.sheet)&&(p=g.dp(f,u),d=O(u),f&&(d*=f.split(/\r\n|\r|\n/).length)),m=g.zoom(),y=s.isPrinting,b=s.printZoomFactor,y&&"number"==typeof b&&1!==b&&(m=b),++o,++n,--r,--i,C=(v=this.iWc(d,m)).radius,w=v.scaleFactor,T=z(h,a,x=new j.Rect(o,n,r,i),p,m*w),A=W(h,a,x,d,m*w),S=L(""+(o+T)),M=L(""+(n+A)),I=H,N=S+1,1===l?(I="center",N+=C):2===l&&(I="right",N+=2*C),u&&t.font!==u&&j.Ul.lZa(t,u),c&&(t.fillStyle=c),R=a.textDecoration,D=d/2-(k=parseInt(s.fontInfo.fontSize,10))/2+(E=8<k?Math.floor((k-8)/5+2):1)-1,t.textBaseline!==B&&(t.textBaseline=B),2===h?(t.textAlign="right",t.fillText(f,S+1-2,M+C+d/2-D),R&&this.ip(t,R,S+1-2,M+C+d/2-D,p,k,E)):0===h&&(t.textAlign=I,t.fillText(f,N,M-2-D),R&&this.ip(t,R,N,M-2-D,p,d)),t.save(),t.strokeStyle="black",t.strokeRect(S+.5,M+.5,2*C+.05,2*C+.05),t.fillStyle="white",t.fillRect(S+1,M+1,2*C-1,2*C-1),this._isThreeState&&_(e)?(t.beginPath(),t.fillStyle="green",t.rect(S+3*m,M+3*m,2*(C-2.5*m),2*(C-2.5*m)),t.fill()):1==!!e&&(t.beginPath(),t.lineWidth=2.5*m,t.moveTo(S+3*m,M+C),t.lineTo(S+C,M+2*C-3.5*m),t.lineTo(S+2*C-1.5*m,M+3*m),t.stroke()),t.restore(),c&&(t.fillStyle=c),3===h?(t.textAlign=H,t.fillText(f,S+1+2*C+2,M+C+d/2-D),R&&this.ip(t,R,S+1+2*C+2,M+C+d/2-D,p,k,E)):1===h&&(t.textAlign=I,t.fillText(f,N,M+2*C+2+d-D),R&&this.ip(t,R,N,M+2*C+2+d-D,p,k,E)),t.restore())},T.prototype.iWc=function(t,e){var o=this._boxSize,n=V/2,r=1;return"auto"===o&&(n=t/4,r=t/2/V),"number"==typeof o&&0<o&&(n=e*o/2,r=o/V),{radius:n,scaleFactor:r}},T.prototype.Voa=function(t,e,o){var n=e.font,r=this.getText(t,o),i=0;return o.sheet&&(i=O(n),r&&(i*=r.split(/\r\n|\r|\n/).length)),i},T.prototype.getText=function(t,e){return this.sK(t)},T.prototype.focus=function(t,e){t&&t.parentNode.focus()},T.prototype.createEditorElement=function(t,e){var o,n,r,i,a,s,l=t&&t.sheet&&t.sheet.parent&&t.sheet.parent._host,u=j.Ul.vl(l)+1e3;return F(e).css("z-index",u).attr("tabindex",1).attr("gcUIElement","gcEditingInput"),(o=F(e.firstChild)).css("overflow","hidden"),(n=F(c("input"))).attr("type","checkbox"),n.attr("class","gc-checkbox-cell-type-input"),i=(r=this.gMc(t))/V,n.css("transform","scale("+i+")"),o.append(n),(a=F(c("span"))).css("position","absolute").css("font",P(f)).css("cursor","default").css("white-space","nowrap"),o.append(a),(s=F(c("div"))).css("position","absolute").css("background-color","green").css("width",2*(r/2-2.5)).css("height",2*(r/2-2.5)),o.append(s),null},T.prototype.gMc=function(t){var e,o,n=t.sheet,r=n.zoom();return"number"==typeof this._boxSize&&0<this._boxSize?this._boxSize*r:"auto"===this._boxSize?(o=(e=n.getStyle(t.row,t.col))&&e.font?e.font:f,r*O(o)/2):V/2},T.prototype.rK=function(t){return this._isThreeState?!_(t)&&(1!=!!t||null):!t},T.prototype.setEditorValue=function(t,e,o){var n,r,i,a,s,l,u;t&&(r=(n=t.parentNode.children)[0],i=n[1],a=n[2],r&&i&&a&&(u=l=void 0,(s=o&&o.sheet)&&s.HF||(u=this.rK(e)),this._isThreeState?_(u)?(l=!1,F(a).show()):(l=!!u,F(a).hide()):l=!!u,r.checked=l,F(i).text(this.sK(u))))},T.prototype.getEditorValue=function(t,e){if(t){var o=t.parentNode.children,n=o[0],r=o[1],i=o[2];if(n&&r&&i&&(!this._isThreeState||!F(i).isVisible()))return n.checked}return null},T.prototype.tw=function(t,e,o,n){var r=t.parent;r&&r.tw(t,e,o,n)},T.prototype.activateEditor=function(e,o,n,r){var t,i,a=r&&r.sheet;e&&a&&(t=F(e.parentNode.parentNode),i=this,t.bind("mousedown"+l,function(t){s(t)}),t.bind("mouseup"+l,function(){S(i,e,o,n,r)}),t.bind("keydown"+l,function(t){var e=t.keyCode;if(!t.ctrlKey&&!t.shiftKey&&!t.altKey){if(32===e)return i.tK=!0,s(t),!1;8===e&&s(t)}}),t.bind("keyup"+l,function(t){!i.tK||32!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey||(i.tK=!1,S(i,e,o,n,r))}),F(e).bind("click",function(t){s(t)}))},T.prototype.updateEditor=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j=n&&n.sheet;t&&j&&(r=j._render,s=(a=(i=t.parentNode).children)[0],l=a[1],u=a[2],s&&l&&u&&(F(i).width(o.width).height(o.height),h=(c=F(l)).text(),f=e.foreColor,p=e.font,d=e.hAlign,g=e.textDecoration,f&&c.css("color",f),m=void 0,m=p||r.Bl(),1<(y=j.zoom())&&(m=r.Cl(m)),c.css("font",P(m)),b=j.rt(h,m),v=O(m),h&&(v*=h.split(/\r\n|\r|\n/).length),T=z(C=this._textAlign,e,o,b,y*(x=(w=this.gMc(n))/V)),A=W(C,e,o,v,y*x),F(s).css("margin-left",T).css("margin-top",A),S=s.offsetLeft,M=s.offsetTop,I=s.offsetWidth,N=s.offsetHeight,(k=R=0)===C?(R=S,1===d?R=S+w/2-b/2:2===d&&(R=S+w-b),k=M-v,R-=(x-1)*V/2,k-=(x-1)*V/2):1===C?(R=S,1===d?R=S+w/2-b/2:2===d&&(R=S+w-b),k=M+N,R-=(x-1)*V/2,k+=(x-1)*V/2):(2===C?(R=S-b-2,k=M+w/2-v/2,R-=(x-1)*V/2):(R=S+I+2,k=M+w/2-v/2,R+=(x-1)*V/2),k-=(x-1)*V/2),c.css(H,R).css("top",k),this._isThreeState?(E=S+(I-u.offsetWidth)/2,D=M+(N-u.offsetHeight)/2,F(u).css(H,E).css("top",D).toggle().toggle()):F(u).hide(),g&&this.lp(c,g)))},T.prototype.sK=function(t){var e=this._caption;return this._isThreeState&&_(t)?this._textIndeterminate||e:1==!!t?this._textTrue||e:this._textFalse||e},T.prototype.getHitInfo=function(t,e,o,n,r){if(r){var i=r.sheetArea;if(_(i)||3===i)return{x:t,y:e,row:r.row,col:r.col,cellRect:n,sheetArea:3,isReservedLocation:!0,sheet:r.sheet,cellStyle:o}}return null},T.prototype.processMouseDown=function(t){return!!t&&void(t.isReservedLocation&&(this.uK=!0))},T.prototype.processMouseUp=function(t){var e,o,n,r,i=t&&t.sheet;if(i&&this.uK&&t.isReservedLocation){if(this.uK=!1,e=t.row,o=t.col,n=t.sheetArea,!i._modelManager.getValueForKey(e,o,p,n))return A(this,i,e,o,n),i._modelManager.do("setValueForKey",e,o,p,!0,n),r=setTimeout(function(){x(i,e,o,n)},250),i._modelManager.do("setValueForKey",e,o,d,r,n),!0;x(i,e,o,n)}return!1},T.prototype.processMouseLeave=function(t){return!!t&&void(this.uK=!1)},T.prototype.isReservedKey=function(t,e){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},T.prototype.processKeyUp=function(t,e){return A(this,e.sheet,e.row,e.col,e.sheetArea),!0},T.prototype.getAutoFitWidth=function(t,e,o,n,r){var i=this._textAlign,a=u.cp(t,this.sK(t),o,n,r),s=this.Voa(t,o,r),l=2*this.iWc(s,n).radius;return 0===i||1===i?a=h(a,l):a+=l,a+5+2},T.prototype.getAutoFitHeight=function(t,e,o,n,r){var i=this._textAlign,a=u.ep(t,this.sK(t),o,n,r),s=this.Voa(t,o,r),l=2*this.iWc(s,n).radius;return 0===i||1===i?a+=l:a=h(a,l),a+5},T.prototype.JH=function(t){this.isReservedKey(t)&&s(t)},T.prototype.isImeAware=function(t){return!1},T.prototype.gQa=function(){},T.prototype.lJc=function(t){var e={caption:t.caption,textTrue:t.textTrue,textIndeterminate:t.textIndeterminate,textFalse:t.textFalse,textAlign:t.textAlign&&g[t.textAlign],isThreeState:t.isThreeState,boxSize:t.boxSize};this.fromJSON(e)},T.prototype.toJSON=function(){var o,n=this,r={typeName:n.typeName};return i(m,function(t,e){(o=n["_"+t])!==e&&(r[t]=o)}),r},T.prototype.fromJSON=function(o){var n=this;i(m,function(t){var e=o[t];_(e)||(n["_"+t]=e)})},y=T,e.CheckBox=y,i(m,function(e){y.prototype[e]=function(t){return 0===arguments.length?this["_"+e]:("boxSize"===e?("number"==typeof t&&0<t&&(this["_"+e]=t),"auto"===t&&(this["_"+e]=t)):this["_"+e]=t,this)}}),j.CellTypes._o[5]=y},"./dist/plugins/celltype/comboboxcelltype.js":function(t,e,o){"use strict";var n,x,u,m,y,r,p,s,b,i,a,T,d,h,v,A,l,C,w,S,M,c,I,N,f,R,k,E,D,j,_,O,F,P,g,L,H,B,V,z,W,G,U,J,Z,q,K,Y,Q,X,$,tt,et,ot=this&&this.__extends||($=function(t,e){return($=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}$(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function nt(t,e){t.appendChild(e)}function rt(t,e){t.removeChild(e)}function it(t){return t&&t.parentNode.parentNode.comboBox}function at(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g=this;s=(g.KK=t).firstChild,b(t).bind(w,function(t){g.LK(t)}).css(["z-index",R,k,_,O,"overflow"],[i||0,e,o,n,r,"visible"]).attr([E],["gcComboBox"]),l=A(0,n-17),g._editable=!1,g.MK=u=m("div"),g.NK=c=m("textarea"),nt(s,g.PK=u),st(u),st(c),b(c).bind("keyup",function(){var t,e=g.PK.value;g._text=e,t=g.QK(e),g.editorValue(t),g.RK(e),g.SK()}).bind(S,function(){g.TK()}).bind(M,function(){g.SK()}),b(u).bind(C,function(){g.IK?g.Wq(q,{isMouse:!0}):g.UK()}).bind(S,function(){g.TK()}).bind(M,function(){g.SK()}),g.VK(0,0,l,r),nt(s,h=g.WK=m("div")),b(h).css([z,I,L,P],[j,N,B,H]).attr(E,"gcDropDownButton").bind(C,function(){var t;!y(g.JK)&&(t=g.JK,g.JK=v,(new Date).valueOf()-t<100)||(g.IK?g.Wq(q,{isMouse:!0}):g.UK())}),f=m("canvas"),g.Xs=f,g.XK(l,0,n-l,r),nt(h,f),nt(s,p=g.YK=m("div")),g.ZK=!1,g.XIc=a||n,b(p).css([I,z,L,"z-index",F,"display","cursor",P,O,"min-width"],[N,"1px solid",B,i||0,j,j,"default",H,r,g.XIc+"px"]),b(p).attr(E,"gcDropDownWindow").attr(D,-1),g.$K(0,+r),g._K=0,nt(p,d=g.aL=m("div")),g.bL=new x.IB(p,d),g._itemHeight=22,g.cL=20,g.dL=-1,g._editorValueType=0,g._items=[],g.e$a=K}function st(t){b(t).css(["margin","overflow","resize",I,"padding",F,L,"white-space",P,z],[0,"hidden",j,N,J+"px 0px 0px "+U+"px",j,B,"nowrap",H,j]).attr(E,"gcComboBoxEditor").attr(D,-1)}function lt(){var o,t=et.call(this)||this;return t.typeName="7",t.DF=!1,t.GK=!1,o=t,i(Y,function(t,e){"items"===t&&(e=[]),o["_"+t]=e}),t}function ut(t){var e,o,n,r,i=["0","0","0","0"];return typeof t===c&&(r=n=void 0,1===(o=(e=t.split(" ",4)).length)?i=[n=e[0],n,n,n]:2===o?i=[n=e[0],r=e[1],n,r]:3===o?(r=e[1],i=[e[0],r,e[2],r]):4===o&&(i=[e[0],e[1],e[2],e[3]])),i}function ct(t,e){return t.hasOwnProperty(e)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("@grapecity/js-sheets-common"),x=o("Core"),u=x.CellTypes.Base,m=x.Ul.Nl,y=n.Common.j.Fa,r=n.Common.pc,p=x.Ul,s=p.nl,b=x.GC$,i=b.each,a=p.hZa,T=p.Fxb,d=p.YIc,h=document,v=void 0,A=Math.max,l=parseInt,C="click",w="keydown",S="mouseover",M="mouseout",c="string",I="position",N="absolute",f="font",R="left",k="top",E="gcUIElement",D="tabindex",j="none",_="width",O="height",F="outline",P="box-sizing",g="color",L="background-color",H="content-box",B="white",V="text",z="border",W=p.K_a,(tt=G=e.EditorValueType||(e.EditorValueType={}))[tt.text=0]="text",tt[tt.index=1]="index",tt[tt.value=2]="value",J=U=1,Z=U,q="EndEdit.gcEditingInput",K="lightgrey",Y={editorValueType:0,items:null,itemHeight:22,editable:!"#1E90FF",maxDropDownItems:20},at.prototype.getComboBox=function(){return this.KK},at.prototype.dispose=function(){b(this.KK).unbind(w),b(this.NK).unbind("keyup").unbind(S).unbind(M),b(this.MK).unbind(C).unbind(S).unbind(M),b(this.WK).unbind(C),b(this.aL).find("div").forEach(function(t){b(t).unbind(S).unbind(M).unbind(C)}),this.bL.dispose()},at.prototype.updateLocationAndSize=function(t,e,o,n){var r=A(0,o-17);this.VK(0,0,r,n),this.XK(r,0,o-r,n),this.$K(0,+n)},at.prototype.updateStyle=function(t,e,o){o=a(o),t=t||v,b(this.PK).css(L,t).css(g,e).css(f,o),b(this.WK).css(L,t).css(g,e).css(f,o),b(this.YK).css(L,t).css(g,e).css(f,o),b(this.KK).css(L,"transparent"),this.e$a=r.Pka(r.ec(t),r.ec(K))?B:K},at.prototype.updateImeMode=function(t){b(this.PK).css("ime-mode",t)},at.prototype.editorValueType=function(t){return 0===arguments.length?this._editorValueType:(this._editorValueType=t,this)},at.prototype.editorValue=function(t){var e;return 0===arguments.length?this.fL:(t!==this.fL&&(this.fL=t,e=this.gL(t),this.text(e),this.RK(e,!0)),this)},at.prototype.gL=function(t){var e,o,n,r,i=this._items,a=i.length,s=this._editorValueType;if(this.HK=!0,1===s)(e=(o=i[t])&&ct(o,V)?o.text:o)===v&&(e=t,this.HK=!1);else if(0===s){for(e=t,r=0;r<a&&!((o=i[r])&&ct(o,V)&&o.text===t||o===t);r++);a<=r&&(this.HK=!1)}else if(2===s){for(n=0;n<a;n++)if((o=i[n])&&ct(o,"value")&&o.value===t){e=o.text;break}a<=n&&(e=t,this.HK=!1)}return y(t)&&(e=""),e},at.prototype.QK=function(t){var e,o,n,r=this._items,i=r.length,a=this._editorValueType,s=t;if(1===a)for(o=0;o<i;o++)((e=r[o])&&ct(e,V)&&e.text===t||e===t)&&(s=o);else if(2===a)for(n=0;n<i;n++)(e=r[n])&&ct(e,V)&&e.text===t?s=e.value:e===t&&(s=v);return s},at.prototype.RK=function(t,e){var o,n,r,i,a;if(t){for(r=(n=this._items).length,o=0;o<r&&(a=ct(i=n[o],V)?i.text:i,(e?a:(""+a).substr(0,t.length))!==t);o++);r<=o&&(o=-1)}else o=-1;this.hL(o)},at.prototype.SK=function(){b(this.PK).removeAttr("title")},at.prototype.TK=function(){var t=this.Xn(this._text),e=b(this.PK);e.width()+U<t?e.attr("title",this._text):e.removeAttr("title")},at.prototype.VK=function(t,e,o,n){o-=0,n-=0,b(this.PK).css(R,t).css(k,e).css(_,o-U).css(O,n-J)},at.prototype.editable=function(t){var e,o,n,r,i,a=this;return 0===arguments.length?a._editable:a._editable!==t?(a._editable=t,e=a.KK.firstChild,o=a.PK,n=b(o),r={left:l(n.css(R)),top:l(n.css(k)),width:l(n.css(_)),height:l(n.css(O))},i={backColor:n.css(L),foreColor:n.css(g),font:o.style.font},rt(e,o),a.PK=t?a.NK:a.MK,nt(e,a.PK),b(a.PK).css(L,i.backColor).css(g,i.foreColor).css(f,i.font),a.VK(r.left,r.top,r.width,r.height),a):void 0},at.prototype.text=function(t){var e=this.PK;return 0===arguments.length?this._text:void(t!==this._text&&(this._text=t,this._editable?e.value=t:e.textContent=t))},at.prototype.focus=function(){var t=this.PK;t.focus(),this._editable&&(t.selectionStart=t.value.length)},at.prototype.selectAll=function(){this._editable&&this.PK.select()},at.prototype.XK=function(t,e,o,n){var r,i,a,s;o-=0,n-=0,r=this.Xs,b(this.WK).css(R,t).css(k,e).css(_,o).css(O,n),b(r).attr(_,o).attr(O,n),i=r.width,a=r.height,(s=r.getContext("2d")).beginPath(),s.lineWidth=2,s.fillStyle="black",s.moveTo(i-17+4,(a-2)/2-2.5),s.lineTo(i-17+7,(a-2)/2+3.5),s.lineTo(i-17+10,(a-2)/2-2.5),s.fill()},at.prototype.showDropDownList=function(){var e=this,t=e.bL;e.ZK=!0,b(e.YK).bind(w,function(t){e.LK(t)}).show(),e.iL=!1,e.jL(),this.adjustPosition(),e.iL&&t.lB(b(e.aL.children).height()),t.ew(!1),e.kL("#1E90FF"),e.lL(e.dL),e.focus()},at.prototype.adjustPosition=function(){var t,e,o,n,r,i,a,s,l,u,c=b(this.YK);if(c){if(t=parseInt(c.css("left"),10),e=parseInt(c.css("top"),10),o=c.width(),n=c.height(),isNaN(t)||isNaN(e)||isNaN(o)||isNaN(n))return;i=r=0,s=(a=h.documentElement).clientWidth,l=a.clientHeight,u=c[0].getBoundingClientRect(),l<n&&(c.css("max-height",Math.round(.8*l)+"px"),n=Math.round(.8*l)),s<o&&(c.css("max-width",Math.round(.8*s)+"px"),o=Math.round(.8*s)),u.left+o>s&&(i=u.left+o-s),u.top+n>l&&(r=u.top+n-l),(t<0||e<0||0<r||0<i)&&(e-=r,(t-=i)<0&&(t-=22),c.css({left:t+"px",top:e+"px"}))}},at.prototype.shiftPadding=function(t,e){var o=this.KK.firstChild;t===R?b(o).css({left:(+b(o).css(R).replace("px","")||0)-e}):t===k&&b(o).css({top:(+b(o).css(k).replace("px","")||0)-e})},at.prototype.closeDropDownList=function(){this.ZK=!1,b(this.YK).unbind(w).hide(),this.kL(""),this.focus()},at.prototype.UK=function(){this.ZK?this.closeDropDownList():this.showDropDownList()},at.prototype.listHeight=function(t){var e=b(this.YK);return 0===arguments.length?e.height():void(0<t&&(e.height(t),this.bL.ew(!1)))},at.prototype.$K=function(t,e){b(this.YK).css(R,t).css(k,e)},at.prototype.items=function(t){var e,o,n,r,i;if(0===arguments.length)return this._items;if(t){for(this._items=t,e=this.aL,o=void 0,b(e).find("div").forEach(function(t){b(t).unbind(S).unbind(M).unbind(C)}),o=e.firstChild;o;)rt(e,o),o=e.firstChild;for(n=this._K=0,r=t.length;n<r;n++)i=t[n],this.mL(ct(i,V)?i.text:i);return this}},at.prototype.mL=function(t){var e=this,o=m("div"),n=m("span");n.textContent=""+t,n.style.padding="0 18px 0 "+Z+"px",n.style.textOverflow="ellipsis",n.style.whiteSpace="nowrap",nt(o,n),nt(e.aL,o),e._K++,b(o).bind(C,function(){var t=b(o).index();e.selectedIndex(t),e.closeDropDownList(),e.Wq(q,{isMouse:!0})}).bind(S,function(){var t=b(o);o.oldBackColor=t.css(L),t.css(L,e.e$a)}).bind(M,function(){b(o).css(L,o.oldBackColor||"")}).css("min-width",e.XIc+"px")},at.prototype.nL=function(){this.Po=m("span"),b(this.Po).css(["display",f],[j,this.YK.style.font]).appendTo(h.body)},at.prototype.oL=function(){rt(h.body,this.Po)},at.prototype.pL=function(t){return this.Po.textContent=t,b(this.Po).width()+2+Z},at.prototype.kL=function(t){var e=this.dL;0<=e&&e<this._K&&b(this.aL.children[e]).css(L,t)},at.prototype.LK=function(t){var e,o,n,r=this,i=t.keyCode,a=t.which;(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey||37===a||39===a)&&9!==a&&r.editable()||(e=r._K,o=r.dL,n=0,38===a||40===a?(0<=o&&o<e&&(n=o+(38===a?-1:1)),0<=n&&n<e&&r.selectedIndex(n),r.ZK&&r.lL(n),s(t)):13===a||37===a||39===a||9===a?(r.selectedIndex(r.dL),r.closeDropDownList(),r.Wq(q,{keyCode:i,shiftKey:t.shiftKey}),s(t)):27===a?(r.closeDropDownList(),r.Wq(q,{keyCode:i}),s(t)):r.editable()||32!==a||s(t))},at.prototype.getSelectedValue=function(t,e,o){var n,r=e[t];return y(r)||(1===o?n=t:0===o?n=ct(r,V)?r.text:r:2===o&&ct(r,"value")&&(n=r.value)),n},at.prototype.hL=function(t){this.kL(""),this.dL=t,this.kL("#1E90FF"),this.lL(t)},at.prototype.selectedIndex=function(t){var e;return 0===arguments.length?this.dL:void(0<=t&&t<this._K&&(this.hL(t),e=this.getSelectedValue(this.dL,this._items,this._editorValueType),y(e)||this.editorValue(e)))},at.prototype.itemCountPerPage=function(t){return 0===arguments.length?this.cL:void(0<t&&(this.cL=t))},at.prototype.Xn=function(t){this.nL();var e=this.pL(t);return this.oL(),e},at.prototype.itemHeight=function(t){return 0===arguments.length?this._itemHeight:void(0<t&&(this._itemHeight=t))},at.prototype.jL=function(){var t,e,o,n,r,i=this;i.nL(),t=i._items[0],e=A(i._itemHeight,b(i.Po).text(y(t)?"":t).height()),b(i.aL.children).css(O,e),(n=i._K)<=(r=i.cL)?o=n*e:(o=r*e,i.iL=!0),i.listHeight(o),i.oL()},at.prototype.lL=function(t){if(0<=t&&t<this._K){var e=this.aL.children[t];this.bL.BB(e)}},at.prototype.bind=function(t,e,o){b(this.KK).bind(t,e,o)},at.prototype.unbind=function(t,e){b(this.KK).unbind(t,e)},at.prototype.Wq=function(t,e){b(this.KK).trigger(t,e)},Q=at,ot(lt,et=u),lt.prototype.isReservedKey=function(t,e){return this.GK},lt.prototype.paintValue=function(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d,g,m,y,b,v=s.sheet,C=v.zoom?v.zoom():1,w=A(0,r-17-1);3===a.hAlign&&(a.hAlign=0),a.wordWrap&&(a.wordWrap=!1),l=s.isPrinting,u=s.printZoomFactor,l&&"number"==typeof u&&1!==u&&(C=u),0<w&&0<i&&(c={},h=void 0,s.quotePrefix=a.quotePrefix,f=a.formatter&&"General"!==a.formatter,p=a._autoFormatter&&a._autoFormatter.formatCached&&"General"!==a._autoFormatter.formatCached,g=this.getItemValue(e),d=f?a.formatter:p?a._autoFormatter:x.CellTypes.Context.Ixb(t,g,w+1,a,C),(h=this.format(W(e),d,c,s))&&(m=new x.Rect(o,n,r,i),et.prototype.adjustRectForIconSet.call(this,a.hAlign,s.sheet,s.row,s.col,s.sheetArea,m,c.content&&et.prototype.hasInfilling.call(this,c.content)),o=m.x,r=m.width,y=a.isVerticalText,T(g)&&!y&&!0!==a.shrinkToFit&&(h!==(b=x.CellTypes.Context.Lxb(t,h,w+1,a,C))&&(delete c.content,a.textIndent=0),h=b),this.paintText(t,this.getText(e,s),o,n,w,i,a,s,h,c))),t.save(),(r<17||i<17)&&(t.rect(o,n,r,i),t.clip()),t.beginPath(),t.lineWidth=2,t.fillStyle="black",t.moveTo(o+r-17+3,n+(i-2)/2-2.5),t.lineTo(o+r-17+6,n+(i-2)/2+3.5),t.lineTo(o+r-17+9,n+(i-2)/2-2.5),t.fill(),t.restore()},lt.prototype.getText=function(t,e){return t},lt.prototype.createEditorElement=function(t,e){var o,n,r,i,a=t&&t.sheet,s=a&&a.parent,l=s&&s._host,u=p.vl(l)+1e3,c=a.defaults,h=a.getActualStyle(t.row,t.col).cellPadding,f=0;return h&&(f=parseFloat(h.split(" ")[3])||0),o=(n=a.getSpan(t.row,t.col))?d(a,n.col,n.col+n.colCount,!1):a.Tl(t.col)-f,(r=new Q(e,0,0,c.colWidth,c.rowHeight,u,o)).editorValueType(this._editorValueType),r.items(this._items),r.itemHeight(this._itemHeight),r.itemCountPerPage(this._maxDropDownItems),r.editable(this._editable),i=r.getComboBox(),Object.defineProperty(i,"comboBox",{get:function(){return this.ixb},set:function(t){this.ixb!==t&&(this.ixb&&this.ixb.dispose(),this.ixb=t)}}),i.comboBox=r,null},lt.prototype.getEditorValue=function(t,e){var o=it(t);return o&&(this.DF=!o.HK),o&&o.editorValue()},lt.prototype.setEditorValue=function(t,e,o){var n=it(t);n&&n.editorValue(e)},lt.prototype.focus=function(t,e){var o=it(t);o&&o.focus()},lt.prototype.selectAll=function(t,e){var o=it(t);o&&o.selectAll()},lt.prototype.activateEditor=function(t,e,o,n){var u=n.sheet,c=it(t);c&&(c.editorValueType(this._editorValueType),c.items(this._items),c.itemHeight(this._itemHeight),c.itemCountPerPage(this._maxDropDownItems),c.editable(this._editable),c.bind(q,function(t,e){var o,n,r,i,a,s=e.keyCode,l=e.shiftKey;if(s){if(n=(o=u.wu()).getShortcutKey(s,!1,l||!1,!1,!1),r=o.getCommands(n))for(i=0,a=r.length;i<a;i++)if("navigationLeft"!==r[i].Cj&&"navigationRight"!==r[i].Cj||(u._editorStatus=1),r[i].execute(u.parent,{sheetName:u.name()}))return!0}else e.isMouse&&c.IK&&u.endEdit()})),this.GK=!0},lt.prototype.deactivateEditor=function(t,e){var o,n,r,i,a,s;if(t&&(o=it(t))){if(n=e.sheet.getActualStyle(e.row,e.col,e.sheetArea).cellPadding)for(r=[R,k],i=[3,0],a=0;a<r.length;a++)s="number"==typeof(s=parseInt(ut(n)[i[a]],10))&&0<s?s:0,o.shiftPadding(r[a],s);o.unbind(q),o.closeDropDownList(),o.IK=!1}this.GK=!1},lt.prototype.updateImeMode=function(t,e){if(this.isImeAware()){var o=it(t);o&&o.updateImeMode(e)}},lt.prototype.updateEditor=function(t,e,o,n){var r,i,a=t&&n&&n.sheet;a&&(r=it(t),e&&r&&(i=a._render,r.updateStyle(e.backColor,e.foreColor,i.Cl(e.font||i.Bl()))),o&&r&&r.updateLocationAndSize(o.x,o.y,o.width,o.height))},lt.prototype.format=function(t,e,o,n){var r;return y(t)?"":(r=this.getItemValue(t),u.prototype.format.call(this,r,e,o))},lt.prototype.getItemValue=function(t){var e,o,n,r,i=this._editorValueType,a=this._items;if(a)if(o=a.length,1===i){if(0<=(n=l(t))&&n<o&&(e=a[n])!==v&&null!==e)return ct(e,V)?e.text:e}else if(2===i)for(r=0;r<o;r++)if((e=a[r])&&ct(e,"value")&&e.value===t)return e.text;return t},lt.prototype.parse=function(t,e,o){var n,r,i,a=this._editorValueType,s=this._items,l=u.prototype.parse.call(this,t,e);if(s){if(i=s.length,0===a)return l;if(1===a){for(r=0;r<i;r++)if((n=s[r])&&ct(n,V)&&n.text===l||n===l)return r}else if(2===a)for(r=0;r<i;r++)if((n=s[r])&&ct(n,V)&&n.text===l)return n.value}return l},lt.prototype.getHitInfo=function(t,e,o,n,r){var i,a,s,l,u,c;return r?(i=r.sheetArea,a=r.sheet,(y(i)||3===i)&&n&&(s=ut(o.cellPadding),l=parseInt(s[1],10)||0,u=n.x+n.width-l,c={x:t,y:e,row:r.row,col:r.col,cellStyle:o,cellRect:n,sheetArea:i,sheet:a},u-17<=t&&t<u)?(c.isReservedLocation=!0,c):null):null},lt.prototype.processMouseDown=function(t){var e,o=t.sheet,n=t.sheetArea;(y(n)||3===n)&&t.isReservedLocation&&o&&(t.row===o.Jl&&t.col===o.Kl||o.setActiveCell(t.row,t.col),o.startEdit(),(e=it(o._editor))&&(p.Ml.mozilla&&(e.JK=(new Date).valueOf()),e.showDropDownList(),e.IK=!0))},lt.prototype.getAutoFitWidth=function(t,e,o,n,r){return o&&o.wordWrap&&(o.wordWrap=!1),x.CellTypes.Context.cp(t,e,o,n,r)+17},lt.prototype.getAutoFitHeight=function(t,e,o,n,r){return o&&o.wordWrap&&(o.wordWrap=!1),x.CellTypes.Context.ep(t,e,o,n,r)},lt.prototype.isImeAware=function(t){return!0},lt.prototype.gQa=function(){},lt.prototype.lJc=function(t){var e={editorValueType:t.editorValueType&&G[t.editorValueType],items:t.items,itemHeight:t.itemHeight,maxDropDownItems:t.maxDropDownItems,editable:t.editable};this.fromJSON(e)},lt.prototype.toJSON=function(){var o,n=this,r={typeName:n.typeName};return i(Y,function(t,e){o=n["_"+t],("items"===t?o&&0<o.length:o!==e)&&(r[t]=o)}),r},lt.prototype.fromJSON=function(o){var n=this;i(Y,function(t){var e=o[t];y(e)||(n["_"+t]=e)})},X=lt,e.ComboBox=X,i(Y,function(e){X.prototype[e]=function(t){return 0===arguments.length?this["_"+e]:(this["_"+e]=t,this)}}),x.CellTypes._o[7]=X},"./dist/plugins/celltype/dropdown-action.js":function(t,e,o){"use strict";var V,z,W,G,U,J,Z,q,K,n,Y,Q,X,$,r,i,tt,a,et,ot,nt,rt,it,at,st,lt,ut,ct,ht,ft,pt,s;function l(B){return{canUndo:!1,execute:function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H=V.uJc(t,e.sheetName);if(!H||t.WJc().name()!==e.sheetName)return!1;if(n=e.row,r=e.col,($.isNullOrUndefined(n)||$.isNullOrUndefined(r))&&(n=H.getActiveRowIndex(),r=H.getActiveColumnIndex()),i=e.sheetArea,$.isNullOrUndefined(i)&&(i=3),n<0||n>=H.getRowCount(i)||r<0||r>=H.getColumnCount(i))return!1;switch(H.showCell(n,r,V.VerticalPosition.nearest,V.HorizontalPosition.nearest),a=1===i?-1:void 0,s=2===i?-1:void 0,l=H.getCellRect(n,r,a,s),u=ht.createElement("div",void 0),p=n,d=r,g=i,c=(f=H).isEditing()?(m=f.getCellType(p,d),y={sheet:f,row:p,col:d,sheetArea:g},m.getEditorValue(f._editor,y)):f.getValue(p,d,g),($.isNullOrUndefined(e.row)||$.isNullOrUndefined(e.col))&&(e.row=H.getActiveRowIndex(),e.col=H.getActiveColumnIndex()),B){case ot:h=new Z.ColorPicker(u);break;case nt:c=dt(c,"date"),h=new K.Calendar(u);break;case rt:c=dt(c,"date"),h=new U.TimePicker(u);break;case it:c=""+(c=dt(c,"number")),h=new z.Calculator(u);break;case at:c=dt(c,"date"),h=new J.MonthPicker(u);break;case st:(h=new W.List(u)).formula=H.getFormula(e.row,e.col);break;case lt:c=dt(c,"number"),h=new G.Slider(u);break;case ut:h=new Q.WorkFlow(u),"string"!=typeof c&&c!==tt&&(c=""+c);break;case ct:h=new X.MultiColumn(u,tt,H)}return b=h,v=B,C=c,w=l,x=H,T=e,et.Gm(),A=x.zo(),M=T.row,I=T.col,N=T.sheetArea,R=x.AHb(M,I,N),k=function(t){var e=-1;switch(t){case ot:e=V.DropDownType.colorPicker;break;case nt:e=V.DropDownType.dateTimePicker;break;case rt:e=V.DropDownType.timePicker;break;case it:e=V.DropDownType.calculator;break;case at:e=V.DropDownType.monthPicker;break;case st:e=V.DropDownType.list;break;case lt:e=V.DropDownType.slider;break;case ut:e=V.DropDownType.workflowList;break;case ct:e=V.DropDownType.multiColumn}return e}(v),E=R.dropDowns,(j=E&&0<E.length)&&(_=E.filter(function(t){return t.type===k})[0])&&(void 0!==_.option&&null!==_.option&&(S=_.option),D=_),b.setOptions(S),b.setValue(C),O=A.getBoundingClientRect(),F=new q.Rectangle(w.x+O.left,w.y+O.top,w.width,w.height),P=new q.PopupControl(b.getContainer(),F,{align:q.DropDownAlignment.Far,hostElement:A}),pt+=1,j&&b.SDc(),P.open(),b.scrollToSelect(),j&&b.refresh(),b.on(Y.BaseDropdown.Event_ValueChanged,function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d;t.notCloseDropDown||P.close(),p=T,!0===(d=t).notSubmit||3!==p.sheetArea&&p.cmd===it&&isNaN(d.value)||(e=x,o=D,r=t,h=(n=T).row,f=n.col,($.isNullOrUndefined(h)||$.isNullOrUndefined(f))&&(h=e.getActiveRowIndex(),f=e.getActiveColumnIndex()),i=n.sheetArea,$.isNullOrUndefined(i)&&(i=3),o&&o.submitCommand?"string"==typeof o.submitCommand?e.getParent().commandManager().execute({cmd:o.submitCommand,sheetName:e.name(),row:h,col:f,newValue:r.value}):"function"==typeof o.submitCommand&&((a={}).row=n.row,a.col=n.col,a.sheetArea=i,o.submitCommand.call(null,e,r.value,a)):(e.getParent().commandManager().execute({cmd:"editCell",sheetName:e.name(),row:h,col:f,newValue:r.text,autoFormat:!r.noAutoFormat,sheetArea:i,isUndo:!1}),e.isEditing()&&e.Kl===f&&e.Jl===h&&(s=e.getCellType(h,f),l={sheet:e,row:h,col:f,sheetArea:V.SheetArea.viewport},u=e.AHb(h,f,i),c=e.getCellRect(h,f),e._editor.LF=r.value,s.updateEditor(e._editor,u,c,l),s.setEditorValue(e._editor,r.text,l))))}),(L=x.parent)&&(L.wXc=L.wXc||[],L.wXc.push(P)),b.getContainer().addEventListener("contextmenu",function(t){t.stopPropagation(),t.preventDefault()}),P.on("close",function(){var t,e,o,n,r,i;t=x,e=M,o=I,n=N,i=R.cellButtons,t&&i&&0<i.length&&(r=t._modelManager.getValueForKey(e,o,ft,n))&&r.isMouseDownReservedLocation&&(r.buttonDownIndex=-1,r.isMouseDownReservedLocation=!1,t.repaint(t.getCellRect(e,o))),b&&b.dispose(),--pt,P=null;var a=L.wXc.indexOf(P);L.wXc.splice(a,1),et.Hm()}),!0}}}function dt(t,e){return"date"===e?"string"==typeof t?(t=i.Qa(t))===tt&&(t=new Date):t instanceof Date||(t=new Date):"number"===e&&("string"==typeof t?t=r.Qa(t):"number"!=typeof t&&(t=0)),t}Object.defineProperty(e,"__esModule",{value:!0}),V=o("Core"),e.commands=V.Commands,z=o("./dist/plugins/celltype/editor/calculator.js"),W=o("./dist/plugins/celltype/editor/listControl.js"),G=o("./dist/plugins/celltype/editor/slider.js"),U=o("./dist/plugins/celltype/editor/timepicker.js"),J=o("./dist/plugins/celltype/editor/monthPicker.js"),Z=o("./dist/plugins/celltype/editor/colorpicker.js"),q=o("./dist/plugins/celltype/editor/popupControl.js"),K=o("./dist/plugins/celltype/editor/calendar.js"),n=o("@grapecity/js-sheets-common"),Y=o("./dist/plugins/celltype/editor/baseControl.js"),Q=o("./dist/plugins/celltype/editor/workflowPicker.js"),X=o("./dist/plugins/celltype/editor/multiColumnPicker.js"),$=o("./node_modules/util/util.js"),r=n.Common.o,i=n.Common.l,tt=null,a=window,et=a.Yl,ot="openColorPicker",nt="openDateTimePicker",rt="openTimePicker",it="openCalculator",at="openMonthPicker",st="openList",lt="openSlider",ut="openWorkflowList",ct="openMultiColumn",ht=document,ft="_cellButtonParam",V.Commands[ot]=l(ot),V.Commands[nt]=l(nt),V.Commands[rt]=l(rt),V.Commands[it]=l(it),V.Commands[at]=l(at),V.Commands[st]=l(st),V.Commands[lt]=l(lt),V.Commands[ut]=l(ut),V.Commands[ct]=l(ct),pt=0,s={init:function(){this.commandManager().register(ot,V.Commands[ot]),this.commandManager().register(nt,V.Commands[nt]),this.commandManager().register(rt,V.Commands[rt]),this.commandManager().register(it,V.Commands[it]),this.commandManager().register(at,V.Commands[at]),this.commandManager().register(st,V.Commands[st]),this.commandManager().register(lt,V.Commands[lt]),this.commandManager().register(ut,V.Commands[ut]),this.commandManager().register(ct,V.Commands[ct])}},V.Workbook.$n("registerOpendropdownCommand",s),V.Worksheet.$n("registerOpendropdownCommand",{preProcessMouseWheel:function(t){0<pt&&!this.sgc&&(t.r=!0)}})},"./dist/plugins/celltype/editor/baseControl.js":function(t,e,o){"use strict";var n,r,i,a,s=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function l(t){var e=i.call(this)||this;return e._host=t,e}function u(t){var e=a.call(this)||this;return e.xo=t,e}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/celltype/editor/eventbase.js"),a=n.EventBase,s(u,a),u.prototype.init=function(t,e,o){this._host=this.xo.querySelector("."+e),this._host?this.RemoveChilds(this._host):(this._host=this.CreateElement(t,e,o),this.xo.appendChild(this._host))},u.prototype.GetContainer=function(){return this.xo},u.prototype.RemoveChilds=function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},u.prototype.CreateElement=function(t,e,o,n){var r,i=document.createElement(t);if(e&&(i.className=e),o)for(r in o)o[r]&&i.setAttribute(r,o[r]);return n&&n.appendChild(i),i},e.BaseControl=u,i=n.EventBase,s(l,i),l.prototype.updateStyle=function(t,e,o){},l.prototype.scrollToSelect=function(){},l.prototype.getContainer=function(){return this._host},l.prototype.refresh=function(){},l.prototype.SDc=function(){},l.prototype.dispose=function(){},l.Event_ValueChanged="ValueChangedEvent",e.BaseDropdown=l},"./dist/plugins/celltype/editor/baseSpreadPicker.js":function(t,e,o){"use strict";var n,i,p,d,g,r,a,s,l=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function u(t,e,o){var n=s.call(this,t)||this;return n.setOptions(e),n.Lgc=o,n}function c(t,e,o){var n={sheet:t};p.isNullOrUndefined(o)||(n.isEsc=o),t.Wq(e,n)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/celltype/editor/baseControl.js"),i=o("Core"),p=o("./node_modules/util/util.js"),d=Math.min,g=Math.max,r=".baseSpreadNS",s=n.BaseDropdown,l(u,s),u.prototype.setOptions=function(t){var e,o;(this.$z=t)&&(e=this._host,(o=document.createElement("div")).setAttribute("class","gc-base-spread-div"),e.appendChild(o),this.Mgc=o,this.Ngc=this.Ogc(o))},u.prototype.setValue=function(t){var e;this.$z&&(e=this.Ngc,setTimeout(function(){window.Yl.Hm(),e&&e.focus(!0)},1e3))},u.prototype.SDc=function(){var t,e,o,n,r;this.Mgc&&(t=this._host,(e=this.$z)&&(o=e.width,n=e.height),r=this.mAa(o,n),p.isNullOrUndefined(o)&&(o=r.width),p.isNullOrUndefined(n)&&(n=r.height),i.GC$(t).width(o).height(n))},u.prototype.refresh=function(){this.Ngc&&this.Ngc.refresh()},u.prototype.dispose=function(){var t=this;t.Lgc&&(t.Lgc.zt(),t.Lgc=null),t.Mgc&&(t.Mgc=null),t.Ngc&&(t.Ngc.unbind(i.Events.DropdownSpreadMouseClick+r),t.Ngc.unbind(i.Events.DropdownSpreadKeyboardEnter+r),t.Ngc.no(),t.Ngc=null)},u.prototype.mAa=function(t,e){var o,n,r,i,a,s,l,u=this.Ngc,c=u.getActiveSheet(),h=c.getColumnCount(),f=0;for(o=0;o<h;o++)f+=c.getColumnWidth(o,3);return n=f,r=c.getRowCount(3)+c.getRowCount(1),i=c.getRowHeight(0,3)*r,n<800&&p.isNullOrUndefined(t)||n<=t?u.options.showHorizontalScrollbar=!1:(a=0,u.kKc&&(a=u.kKc._v()),i+=a),i<400&&p.isNullOrUndefined(e)||i<e?u.options.showVerticalScrollbar=!1:(s=0,(l=u.nKc)&&(s=l.wDc(!1)||l.Vo()),n+=s),{width:d(n,800),height:d(g(i,100),400)}},u.prototype.Ogc=function(t){var e,o,n=new i.Workbook(t,{sheetCount:1});return n.jDc=!0,(e=n.options).allowUserDragDrop=!1,e.allowUserDragFill=!1,e.allowUserResize=!1,e.allowUserZoom=!1,e.tabStripVisible=!1,e.allowContextMenu=!1,e.allowUserDeselect=!1,e.scrollbarMaxAlign=!0,n.getActiveSheet().sgc=!0,o=this,n.bind(i.Events.DropdownSpreadMouseClick+r,function(t,e){o.submitData(e)}),n.bind(i.Events.DropdownSpreadKeyboardEnter+r,function(t,e){o.submitData(e)}),n},u.prototype.submitData=function(t){},e.BaseSpreadPicker=u,i.GC$.extend(i.Worksheet.prototype,{tgc:function(){c(this,i.Events.DropdownSpreadMouseClick)},ugc:function(t){c(this,i.Events.DropdownSpreadKeyboardEnter,t)}})},"./dist/plugins/celltype/editor/calculator.js":function(t,e,o){"use strict";var s,n,r,i,a,u,l,c,h,f,p,d,g,m,y,b,v,C,w,x=this&&this.__extends||(C=function(t,e){return(C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}C(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function T(t){var e=w.call(this,t)||this,o=e;return o._host=document.createElement("div"),o._host.classList.add("gc-calculator-container"),o._host.innerHTML='\n<div class="gc-calculator">\n    <header class="gc-top-part">\n        <div class="gc-screen">\n            <div class="gc-main-screen">\n                <input class="gc-main" value="" type="text" disabled readonly="readonly"></div>\n        </div>\n    </header>\n    <section class="gc-bottom-part">\n        <div class="gc-features">\n            <div class="gc-sub-menu">\n                <div class="gc-row">\n                    <div class="percentage button image icon-group1" data-value="%" role="button">\n                        <img class="icon icons8-Percentage" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABK0lEQVRYR+2WYQ3CMBCFvznAAgrAAeAAHOAACYADHCABJIACcAA4wAHkkpYM6K7XZs3+rAnZYNf169u7Nyo6HlXH69MD9ArEFJgDK2AKnICtO2re3bk5D2AMPLViDUAWPwQmzxQIWfDi5iyAY6zLNIArMHK73gDyWQNnp0jo3qLSJFLzNU8DeLnKek3oN3/DJbB3X4bAPbZ7ud4WwAC4AXIUn4haptEWQJLx6mRtACQbzwrgTShyellDJkw2nhXA0oZZxrMCSJ0EkCjgW0vOZccyso2XApCTeEnpGYviJoAm41kemzmItN03GS85PXMU0IyXmp7J/4hixisOEEu8ogCWxCsKYEk8a3p+DG41oTXxirRhzHi/7aql519rWxUwvdtzinqAXoHOFXgD+J9gIZOwvCMAAAAASUVORK5CYII="></div>\n                    <div class="sqrt button image icon-group1" data-value="sqrt" role="button">\n                        <img class="icon icons8-Square-Root" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABP0lEQVRYR+3V4S0FQRQF4O9VgApQATrQASpABXSAClABOqCCRwWoABWgAnKTnWSzeV5mdkf2z55fm83sPWfPuXfuzMiYjcxvEjA5UNuBd6z/0dgLuWoK2MV8yVT9u4BbHOIC57njXcuBVXw2pJuIKLJQS8ARbvCA/Szm5lAtAS/YwjEiimzUELCNZ3wjoihCDQFXOME1TovYqbILvrCCHUQURRjqQGq+V0QUxVgm4KdVLcYqxquLe+z1ab5UKFdAnO92+AbemkJriCiKkRNBsrnrQjTcJe4QZ3ohR0AUTkum7UJ6d4CIohdyBXRdSIvnAxFFb+QKaLsQfxzXbfHiWaSyREBy4bEZubj1ihbPUAFBGLnHpRN4QkQxCCUOBFHs+bOGsXjxDHUgvk8upOdBfx8flzowmLBbYBIwOTC6A7+1/zEhMa617wAAAABJRU5ErkJggg=="></div>\n                    <div class="sqr button icon-group1" data-value="pow" role="button">\n                        <span class="x-sign">\n                            <sub>x</sub></span>\n                        <span>\n                            <sup>2</sup></span>\n                    </div>\n                    <div class="fraction button icon-group1" data-value="1/x" role="button">\n                        <span>\n                            <sup>1</sup></span>\n                        <span>&frasl;</span>\n                        <span class="x-sign">\n                            <sub>\n                                <em>x</em></sub>\n                        </span>\n                    </div>\n                </div>\n            </div>\n            <div class="gc-main-menu">\n                <div class="gc-row">\n                    <div class="clear-entry button icon-group1" data-value="CE" role="button">CE</div>\n                    <div class="clear button icon-group1" data-value="C" role="button">C</div>\n                    <div class="clear-element button image icon-group1" data-value="BS" role="button">BS</div>\n                    <div class="divide button image operation icon-group1" data-value="/" role="button">\n                        <img class="icon icons8-Divide" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAo0lEQVRYR+2VSxGDMBRFTxTUAkioklrAQSVAHSChjmqhdYCDMm8mCz7DIp/yurisQ+6Zk5u8gPMXnPMRgAyUGBiBWyzxE3jkFDoXwMLvm0ADGFIhcgEm4AJcY+ALeAOtJ8AHaM4CMNW95xFYtkF0ixImn7/9m9uBVNOH6wVwZOBbzfF6o13e3wL8SMB+W5WwxICmoaahpmGVx6rkGgpABqoYmAH2Lh4hfK3KfwAAAABJRU5ErkJggg=="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="7">7</div>\n                    <div class="button number icon-group2" role="button" data-value="8">8</div>\n                    <div class="button number icon-group2" role="button" data-value="9">9</div>\n                    <div class="multiply button image operation icon-group1" data-value="*" role="button">\n                        <img class="icon icons8-Multiply" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABBUlEQVRYR+2W6w3CMAyErxuwCYwAG7AJjAATMQKMUDZhBHQSQaFqYp8DqpDSn2nj+3J+NAMWfoaF9dEBugN/4cAewA3AQ+yYFYADgHNtn+UAxS8ARgA7AYLiVwCbF8CpBGEBMBBPvxYgcvE7gG0N3AIguAIhiTO4B8ALIYsrABZESFwFKEFwPRWcmfNpMXpTkO+b1gTfsdpl8YgDCSSH4FpIvBUg2c446px4OxpNQZ5zBlPmxEcZqABz1c6A6rAKOVBrNWVYhRzw9HkIwpMCj/hcd7gK0wJQxEMQFkD6Hat9nqeD94Hw75inarmQHGviLYNIvByVP7dS8DWh6I2oA3QHfu7AEzfHWCF+OOmJAAAAAElFTkSuQmCC"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="4">4</div>\n                    <div class="button number icon-group2" role="button" data-value="5">5</div>\n                    <div class="button number icon-group2" role="button" data-value="6">6</div>\n                    <div class="minus button image operation icon-group1" data-value="-" role="button">\n                        <img class="icon icons8-Minus-Math-" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAARElEQVRYR+3V0Q0AMAQFQPYfuh1A+ql8nAF4LhIZw5XD80MAAgQIECCwVuA0fcmy8EtgPEATQG279gYIECBAgACBbwIXi38CITaYSB4AAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="1">1</div>\n                    <div class="button number icon-group2" role="button" data-value="2">2</div>\n                    <div class="button number icon-group2" role="button" data-value="3">3</div>\n                    <div class="plus button image operation icon-group1" data-value="+" role="button">\n                        <img class="icon icons8-Plus-Math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAWUlEQVRYR+2WMQoAIAgA9f+PrsWmEMQSEa7Z8rzEUmle2pxfABhvYFkPpQtJb7TEAGAAAxgoM3AO/v1YXoPPm4TtANHKy64AAAxgAANjDERB3bjXXzEA8w1s3k4WIU0YaEoAAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="plus-minus button image icon-group1" data-value="+/-" role="button">\n                        <img class="icon icons8-Plus-Minus" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAYUlEQVRYR+2VMQ4AIAgD4f+P1gUdCakx1VB3pL0UcCM/J/c3CfiewIgMwUbgwmgsASLQg8ByiW7tdNIqY0gXkDnvkQEREIGnCaDLaddVFtFxk+wDCagQoN8CugCFUASuEpjXIBIhP3OSdgAAAABJRU5ErkJggg=="></div>\n                    <div class="button number icon-group2" role="button" data-value="0">0</div>\n                    <div class="dot button icon-group1" data-value="." role="button">.</div>\n                    <div class="equal button image operation icon-group1" data-value="=" role="button">\n                        <img class="icon icons8-Equal-Sign" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAQ0lEQVRYR+3U0Q0AMAQFQPYfuh1A+ikkPQMgF0/GcOXw/LAAAQIECLwETtOLLvPWLtAEUNs6wrUCUiAFBAgQIPCPwAX8vwQhcNJI5wAAAABJRU5ErkJggg==" width="32" height="32"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button okbtn icon-group1" role="button">OK</div>\n                </div>\n            </div>\n        </div>\n    </section>\n</div>\n',o._host.querySelector(".okbtn").textContent=u().OK,t.appendChild(e._host),o.YCb(),o.ZCb(),o.$Cb(),o._Cb(),o.aDb("0"),e}function A(t,e,o,n,r,i,a,s,l,u,c){var h=this;h.Fi=t,h.XHa=e,h.YHa=o,h.JCb=n,h.KCb=r,h.Jb=i,h.LCb=a,h.MCb=s,h.NCb=l,h.OCb=u,h.PCb=c,h.QCb=g}function S(){}function M(){}function I(){}Object.defineProperty(e,"__esModule",{value:!0}),s=o("./dist/plugins/celltype/editor/baseControl.js"),n=o("./dist/plugins/celltype/celltypes.ns.js"),r=o("@grapecity/js-sheets-common"),i=o("Core"),a=new r.Common.ResourceManager(n.SR),u=a.getResource.bind(a),l=Math.floor,c=Math.abs,h=Math.pow,f=Math.round,p=Math.sqrt,d=Math.max,g=["0","1","2","3","4","5","6","7","8","9","+/-",".","+","-","*","/","SQRT","%","1/x","=","MC","MR","MS","M+","BS","CE","C","POW"],I.Init=function(){I.GetBrowserType(),I.IsIE=void 0!==I.ie||void 0!==I.edge},I.GetBrowserType=function(){try{var t=navigator.userAgent.toLowerCase();window.ActiveXObject?I.ie=t.match(/msie ([\d.]+)/)[1]:-1!==t.indexOf("edge")?I.edge=t.match(/edge\/([\d.]+)/)[1]:-1!==t.indexOf("firefox")&&(I.firefox=t.match(/firefox\/([\d.]+)/)[1]),-1!==t.indexOf("rv:")&&-1===t.indexOf("firefox")&&(I.ie=t.match(/rv:([\d.]+)/)[1])}catch(t){}},(m=I).Init(),M.IsErrorText=function(t){return t===u().Calculator_DivideByZeroInfo||t===u().Calculator_InvalidInputInfo||t===u().Calculator_SqrtParameterException||t===u().Calculator_OverFlowInfo},y=M,e.CalculatorErrorInfo=y,S.IsDotContained=function(t){return-1!==(t+"").indexOf(".")},S.GetDotPosition=function(t){var e=t+"",o=0,n=0;for(n=e.length;0<n;n--){if("."===e.substring(n-1,n))return o;o++}return 0===n?0:o},S.FormatOutput=function(t){var e,o;if(null==t)return null;if(o=(e=t+"").length,S.IsDotContained(e))for(;"0"===e.substring(o-1,o)&&""!==e&&-1===e.indexOf("e");)e=e.substring(0,o-1),o--;return e},S.FormatResult=function(t){var e,o,n,r,i,a,s;return isNaN(t)&&(t=0),e=t+"",o="",t<0&&(o="-",e=e.substring(1,e.length)),n=e.length,r="",-1!==(i=e.indexOf("e"))&&(r=e.substring(i,n),n=(e=e.substring(0,i)).length),S.IsDotContained(e)&&16<n&&(a=0,e=1<parseFloat(e)?(a=S.GetDotPosition(e)-(n-16),(""+e).substring(0,17)):(a=S.GetDotPosition(e)-(n-17),(""+e).substring(0,18)),e=0<a?""+f(parseFloat(e)*h(10,a))/h(10,a):""+f(parseFloat(e))),n=e.length,!S.IsDotContained(e)&&15<n&&(a=n-15,e=""+f(parseFloat(e)/h(10,a))*h(10,a)),e=o+e+r,s=parseFloat(e),S.IsOverFlow(""+s)?u().Calculator_OverFlowInfo:s},S.SingleMathOperation=function(t,e){var o,n=parseFloat(t);if(isNaN(n)&&(n=0),"SQRT"===e){if(n<0)return u().Calculator_InvalidInputInfo;n=p(n)}if("POW"===e&&(n=h(n,2)),"1/x"===e){if(0===n)return u().Calculator_DivideByZeroInfo;o=S.GetDotPosition(""+n),n=h(10,o)/(h(10,o)*n)}return S.FormatResult(n)},S.DoubleMathOperation=function(t,e,o){var n,r,i,a,s=parseFloat(t),l=parseFloat(e);if(S.IsDotContained(""+s)||S.IsDotContained(""+l)){if(i=r=0,S.IsDotContained(""+s)&&(r=S.GetDotPosition(""+s)),S.IsDotContained(""+l)&&(i=S.GetDotPosition(""+l)),a=d(r,i),"+"===o&&(n=((s*=h(10,a))+(l*=h(10,a)))/h(10,a)),"-"===o&&(n=((s*=h(10,a))-(l*=h(10,a)))/h(10,a)),"*"===o&&(n=(s*=h(10,r))*(l*=h(10,i))/h(10,r+i)),"/"===o){if(s*=h(10,a),0==(l*=h(10,a)))return u().Calculator_DivideByZeroInfo;n=s/l}"%"===o&&(n=(s*=h(10,r))*(l*=h(10,i))/h(10,r+i+2))}else{if("+"===o&&(n=s+l),"-"===o&&(n=s-l),"*"===o&&(n=s*l),"/"===o){if(0===l)return u().Calculator_DivideByZeroInfo;n=s/l}"%"===o&&(n=s*l/100)}return S.FormatResult(n)},S.IsOverFlow=function(t){var e=parseFloat(t);if(0!==e){if(79e27<e)return!0;if(e<1e-28&&-1e-28<e)return!0;if(e<-79e27)return!0}return!1},b=S,A.prototype.RCb=function(){this.Fi="",this.XHa=null,this.YHa=null,this.JCb=null,this.KCb=0,this.MCb=!1,this.NCb=!1},A.prototype.Click=function(t){var e,o=this;return 0<=t&&t<=11&&(o.OCb&&(o.SCb(t),o.OCb=!1),o.TCb(t),10!==t&&(o.PCb="ClickNumericButton")),(12<=t&&t<=19||27===t)&&(o.OCb?(o.SCb(t),o.OCb=!1):(o.UCb(t),o.PCb="ClickMathButton")),24===t&&(o.OCb&&(o.SCb(t),o.OCb=!1),o.VCb()),25!==t&&26!==t||(o.SCb(t),o.OCb=!1),o.OCb?null:((e={}).outputText=o.WCb(),y.IsErrorText(o.Fi)&&(o.OCb=!0),e.result=void 0===o.Fi||null===o.Fi?"":o.Fi,e.x=o.XHa,e.y=o.YHa,e.operation=o.JCb,e.token=o.KCb,e.count=o.Jb,e.memoryNumber=o.LCb,e.isBSCanUse=o.MCb,e.isEqualClicked=o.NCb,e.isOperationInvalid=o.OCb,e.lastOperation=o.PCb,e)},A.prototype.TCb=function(t){var e=this;if(null!==e.Fi&&void 0!==e.Fi||(e.Fi=""),!(14<e.Jb&&10!==t))switch(11!==t&&10!==t&&(0!==t||e.Fi+""!="0"&&""!==e.Fi)&&e.Jb++,10!==t&&(e.MCb=!0),e.KCb){case 0:0<=t&&t<=9&&("ClickNumericButton"!==e.PCb&&void 0!==e.PCb&&null!==e.PCb&&(e.Fi="0"),"0"===e.Fi&&0!==t?e.Fi=""+t:"0"!==e.Fi&&(e.Fi=e.Fi+""+t)),10===t&&(-1===(""+e.Fi).indexOf("e")?""!==e.Fi&&"0"!==e.Fi&&(-1===(""+e.Fi).indexOf("-")?e.Fi="-"+e.Fi:e.Fi=(""+e.Fi).substring(1,(""+e.Fi).length)):0<+e.Fi?e.Fi="-"+e.Fi:e.Fi=e.Fi.substring(1,e.Fi.length)),11===t&&("ClickNumericButton"!==e.PCb&&void 0!==e.PCb&&null!==e.PCb&&(e.Fi="0."),""===e.Fi||b.IsDotContained(e.Fi)?""!==e.Fi&&b.IsDotContained(e.Fi)||(e.Fi="0."):e.Fi=e.Fi+"."),e.KCb=1;break;case 1:0<=t&&t<=9&&("ClickNumericButton"!==e.PCb&&void 0!==e.PCb&&null!==e.PCb&&(e.Fi="0"),"0"===e.Fi&&0===t||("0"===e.Fi&&0!==t?e.Fi=""+t:e.Fi=e.Fi+""+t)),10===t&&(-1===(""+e.Fi).indexOf("e")?""!==e.Fi&&"0"!==e.Fi&&(-1===(""+e.Fi).indexOf("-")?e.Fi="-"+e.Fi:e.Fi=(""+e.Fi).substring(1,(""+e.Fi).length)):0<+e.Fi?e.Fi="-"+e.Fi:e.Fi=e.Fi.substring(1,e.Fi.length)),11===t&&("ClickNumericButton"!==e.PCb&&void 0!==e.PCb&&null!==e.PCb?e.Fi="0.":b.IsDotContained(e.Fi)||(""===e.Fi?e.Fi="0.":e.Fi=e.Fi+".")),e.NCb||(e.YHa=e.Fi);break;case 2:0<=t&&t<=9&&(e.Fi="",e.Fi=e.Fi+t),11===t&&(e.Fi="0."),10===t&&(e.Fi="0"),e.KCb=3,e.YHa=e.Fi;break;case 3:0<=t&&t<=9&&("ClickNumericButton"!==e.PCb&&void 0!==e.PCb&&null!==e.PCb&&(e.Fi="0"),"0"===e.Fi&&0===t||("0"===e.Fi&&0!==t?e.Fi=""+t:e.Fi=e.Fi+""+t)),10===t&&(-1===(""+e.Fi).indexOf("e")?""!==e.Fi&&"0"!==e.Fi&&(-1===(""+e.Fi).indexOf("-")?e.Fi="-"+e.Fi:e.Fi=(""+e.Fi).substring(1,(""+e.Fi).length)):0<+e.Fi?e.Fi="-"+e.Fi:e.Fi=e.Fi.substring(1,e.Fi.length)),11===t&&("ClickNumericButton"!==e.PCb&&null!==e.PCb?e.Fi="0.":b.IsDotContained(e.Fi)||(""===e.Fi?e.Fi="0.":e.Fi=e.Fi+".")),e.YHa=e.Fi}},A.prototype.UCb=function(t){var e=this;switch(e.Jb=0,e.MCb=!1,e.NCb&&(e.NCb=!1),e.Fi=b.FormatOutput(e.Fi),e.KCb){case 0:""===e.Fi&&(e.Fi=0),(16<=t&&t<=18&&17!==t||27===t)&&(e.Fi=""+b.SingleMathOperation(e.Fi,e.QCb[t]),y.IsErrorText(e.Fi)||(e.XHa=e.Fi),e.KCb=1),12<=t&&t<=15&&(e.JCb=t,e.XHa=e.Fi,e.KCb=2),17===t&&e.RCb();break;case 1:(16<=t&&t<=18&&17!==t||27===t)&&(e.Fi=""+b.SingleMathOperation(e.Fi,e.QCb[t]),y.IsErrorText(e.Fi)||(null!==e.JCb&&void 0!==e.JCb&&null!==e.YHa&&void 0!==e.YHa?e.YHa=e.Fi:e.XHa=e.Fi)),19===t&&(null!==e.JCb&&void 0!==e.JCb&&null!==e.YHa&&void 0!==e.YHa?(e.Fi=""+b.DoubleMathOperation(""+e.XHa,""+e.YHa,e.QCb[e.JCb]),y.IsErrorText(e.Fi)||(e.XHa=e.Fi)):"-0."===e.Fi&&(e.Fi="0."),e.NCb=!0,e.MCb=!1),12<=t&&t<=15&&(e.JCb=t,e.XHa=e.Fi,e.KCb=2),17===t&&(null!==e.JCb&&void 0!==e.JCb?(e.YHa=e.Fi,e.Fi=""+b.DoubleMathOperation(""+e.XHa,""+e.YHa,e.QCb[17]),e.YHa=e.Fi):e.RCb());break;case 2:(16<=t&&t<=18&&17!==t||27===t)&&(e.Fi=""+b.SingleMathOperation(e.Fi,e.QCb[t]),y.IsErrorText(e.Fi)||(e.KCb=3,e.YHa=e.Fi)),19===t&&(e.YHa=e.XHa,e.Fi=""+b.DoubleMathOperation(""+e.XHa,""+e.XHa,e.QCb[e.JCb]),y.IsErrorText(e.Fi)||(e.XHa=e.Fi,e.KCb=1,e.MCb=!1),e.NCb=!0),12<=t&&t<=15&&(e.JCb=t,e.YHa=e.Fi),17===t&&(e.Fi=b.DoubleMathOperation(""+e.XHa,""+e.XHa,e.QCb[17]),y.IsErrorText(e.Fi)||(e.YHa=e.Fi,e.KCb=3));break;case 3:16<=t&&t<=18&&17!==t&&(e.Fi=""+b.SingleMathOperation(e.Fi,e.QCb[t]),y.IsErrorText(e.Fi)||(e.YHa=e.Fi)),12<=t&&t<=15&&(e.YHa=e.Fi,e.Fi=""+b.DoubleMathOperation(""+e.XHa,""+e.YHa,e.QCb[e.JCb]),y.IsErrorText(e.Fi)||(e.XHa=e.Fi,e.YHa=null,e.JCb=t,e.KCb=2)),17===t&&(e.Fi=b.DoubleMathOperation(""+e.XHa,""+e.YHa,e.QCb[17]),y.IsErrorText(e.Fi)||(e.YHa=e.Fi)),19===t&&(e.YHa=e.Fi,e.Fi=""+b.DoubleMathOperation(""+e.XHa,""+e.YHa,e.QCb[e.JCb]),y.IsErrorText(e.Fi)||(e.XHa=e.Fi,e.KCb=1,e.MCb=!1),e.NCb=!0)}e.Fi+=""},A.prototype.VCb=function(){var t,e=this;if(0<e.Jb&&e.Jb--,(0===e.KCb||1===e.KCb||3===e.KCb)&&!0===e.MCb)switch(e.Fi+="",t=e.Fi.length,0<t&&(e.Fi=e.Fi.substring(0,t-1)),"-0"===e.Fi&&(e.Fi="0"),"-"===e.Fi&&(e.Fi=""),""===e.Fi&&(e.MCb=!1),e.KCb){case 0:case 1:e.XHa=e.Fi;break;case 3:e.YHa=e.Fi}},A.prototype.SCb=function(t){var e=this;e.Jb=0,e.MCb=!1,e.Fi="",25===t&&(1===e.KCb&&(null===e.JCb||void 0===e.JCb||e.NCb||(e.YHa=0)),2===e.KCb&&(e.KCb=3)),26===t&&e.RCb()},A.prototype.WCb=function(){return""===this.Fi||null===this.Fi||void 0===this.Fi?"0":this.Fi},A.prototype.XCb=function(t){var e=t.keyCode;switch(t.shiftKey&&(e|=65536),t.ctrlKey&&(e|=131072),t.altKey&&(e|=262144),e){case 131138:case 131140:case 131141:case 131144:case 131145:case 131148:case 131150:case 131154:case 131159:case 131188:case 262181:case 262183:case 117:case 65657:case 131081:case 196617:case 9:case 65545:case 121:case 123:return null;case 48:case 96:return 0;case 49:case 97:return 1;case 50:case 98:return 2;case 51:case 99:return 3;case 52:case 100:return 4;case 53:case 101:return 5;case 54:case 102:return 6;case 55:case 103:return 7;case 56:case 104:return 8;case 57:case 105:return 9;case 120:return 10;case 190:case 188:case 110:return 11;case 65723:case 107:return 12;case 65643:if(!m.IsIE)return 12;break;case 189:case 109:return 13;case 65592:case 106:case 65722:return 14;case 191:case 111:return 15;case 65586:case 192:return 16;case 65589:return 17;case 82:return 18;case 13:return 19;case 393292:return 20;case 393298:return 21;case 393293:return 22;case 393296:return 23;case 8:return 24;case 46:return 25;case 27:case 131118:return 26;default:return 61===e&&m.firefox||187===e&&!m.firefox?19:-1}},v=A,w=s.BaseDropdown,x(T,w),T.prototype.setValue=function(t){var e,o=this;t=o.bDb(t);try{if(!o.Na(t))throw Error(u().Calculator_InvalidInputInfo);t=""===t?"0":t,o.Fi=o.cDb(t),o._text=o.dDb(t),o.XHa=parseFloat(o.Fi),o.YHa=null,o.JCb=null,o.KCb=0,o.Jb=o.eDb(parseFloat(o.Fi)),0<o.Jb?o.MCb=!0:o.MCb=!1,o.NCb=!1,o.OCb=!1,o.PCb=null}catch(t){o._text=u().Calculator_InvalidInputInfo,o.Fi="",o.XHa=null,o.YHa=null,o.OCb=!0}return o.fDb(o.OCb),o.aDb(o._text),(e={}).outputText=o._text,e.result=o.Fi,e.x=o.XHa,e.y=o.YHa,e.operation=o.JCb,e.token=o.KCb,e.count=o.Jb,e.memoryNumber=o.LCb,e.isBSCanUse=o.MCb,e.isEqualClicked=o.NCb,e.isOperationInvalid=o.OCb,e.lastOperation=o.PCb,o.gDb=new v(o.Fi,o.XHa,o.YHa,o.JCb,o.KCb,o.Jb,o.LCb,o.MCb,o.NCb,o.OCb,o.PCb),o},T.prototype.setOptions=function(){},T.prototype.scrollToSelect=function(){var t=this._host.querySelector(".gc-main-screen .gc-main");this.kDb(t)},T.prototype.YCb=function(){var t=this;t.hDb="0",t._text=t.hDb,t.Fi="",t.XHa=0,t.YHa=0,t.JCb=null,t.KCb=0,t.Jb=0,t.LCb=null,t.MCb=!1,t.NCb=!1,t.OCb=!1,t.PCb=null},T.prototype.ZCb=function(){var t=this;t.gDb=new v(this.Fi,t.XHa,t.YHa,t.JCb,t.KCb,t.Jb,t.LCb,t.MCb,t.NCb,t.OCb,t.PCb)},T.prototype.$Cb=function(){this.fDb(this.OCb)},T.prototype._Cb=function(){var r=this,i=this,a=i._host;a.addEventListener("click",function(t){for(var e,o,n=t.srcElement||t.target;n&&!n.classList.contains("button");)n=n.parentElement;n&&(n.getAttribute("data-value")?(e=n.getAttribute("data-value"),o=T.iDb(e),a.focus(),-1!==o&&i.jDb(o)):n.classList.contains("okbtn")&&("ClickNumericButton"===i.PCb&&i.jDb(19),r.fire(s.BaseDropdown.Event_ValueChanged,{value:i._text,text:i._text})))}),a.addEventListener("keydown",function(t){!0!==i.XCb(t)&&(t.preventDefault(),t.stopPropagation())}),a.addEventListener("contextmenu",function(t){t.preventDefault(),t.stopPropagation()})},T.prototype.aDb=function(t){var e=this._host.querySelector(".gc-main-screen .gc-main"),o=e.value;null!=o&&(""+o).replace(/\r\n/g,"\n")!==(""+t).replace(/\r\n/g,"\n")&&(e.value=t,this.kDb(e))},T.prototype.kDb=function(t){if(null!==this.lDb&&void 0!==this.lDb||(this.lDb=parseInt(window.getComputedStyle(t)["font-size"].replace("px",""),0)),this.mDb(t))for(;this.mDb(t);)this.nDb(t);else this.oDb(t)},T.prototype.mDb=function(t){var e,o;return t.scrollWidth>t.clientWidth||!(!i.Ul.Ml.edge&&!i.Ul.Ml.msie)&&!(t.clientWidth<=0)&&(o=(e=window.getComputedStyle(t)).fontWeight+" "+e.fontSize+" "+e.fontFamily,i.Vn.Xn(t.value,o)+40>t.clientWidth)},T.prototype.nDb=function(t){var e=parseInt(window.getComputedStyle(t)["font-size"].replace("px",""),0);t.style.fontSize=e-1+"px"},T.prototype.oDb=function(t){for(var e=parseInt(window.getComputedStyle(t)["font-size"].replace("px",""),0);!this.mDb(t)&&e<this.lDb;)if(++e,t.style.fontSize=e+"px",this.mDb(t)){for(;this.mDb(t);)this.nDb(t);break}},T.prototype.bDb=function(t){if(void 0===t||"string"!=typeof t&&!(t instanceof String))throw Error(t+" type is not a string.");return null!=t||(t=""),""+t},T.prototype.pDb=function(t,e){var o,n,r,i;if(0===e.length)return"";for(o="",n=r=0;n<e.length;n++){for(i=!1,r=0;r<t.length;r++)e.substring(n,n+1)===t.substring(r,r+1)&&(i=!0);!0===i&&(o+=e.substring(n,n+1))}return o},T.prototype.Na=function(t){if(this.pDb("-.0123456789",t)!==t)return!1;var e=t.indexOf("-");return(-1===e||0===e)&&t.indexOf("-")===t.lastIndexOf("-")&&t.indexOf(".")===t.lastIndexOf(".")},T.prototype.cDb=function(t){var e,o,n,r,i,a=parseFloat(t),s=!1;if(a<0&&(s=!0),e=c(a),o=l(e),n=b.GetDotPosition(""+e),r=(e*h(10,n)-o*h(10,n))/h(10,n),999999999999999<o)throw Error(u().Calculator_InvalidInputInfo);if(999999999999999!==o)return r=f(r*h(10,i=0===o?15:15-(""+o).length))/h(10,i),n=b.GetDotPosition(""+r),e=(o*h(10,n)+r*h(10,n))/h(10,n),o=l(e),n=b.GetDotPosition(""+e),0==(r=(e*h(10,n)-o*h(10,n))/h(10,n))&&(e=o),s?"-"+e:""+e;if(0===r)return o;throw Error(u().Calculator_InvalidInputInfo)},T.prototype.dDb=function(t){var e=""+t;return""===e&&(e="0"),e},T.prototype.eDb=function(t){var e=c(t),o=l(e),n=b.GetDotPosition(""+e),r=(e*h(10,n)-o*h(10,n))/h(10,n);return(0===o?0:(""+o).length)+(0==r?0:n)},T.prototype.fDb=function(t){for(var e=10;e<=18;e++)this.qDb(e,t);this.qDb(27,t)},T.prototype.qDb=function(t,e){var o=g[t],n=this._host.querySelector('[data-value="'+o.toLowerCase()+'"]');n&&(e?n.classList.add("disabled"):n.classList.remove("disabled"))},T.iDb=function(t){var e=-1;switch(t){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":e=parseInt(t,10);break;case"+/-":e=10;break;case".":e=11;break;case"+":e=12;break;case"-":e=13;break;case"*":e=14;break;case"/":e=15;break;case"sqrt":e=16;break;case"%":e=17;break;case"1/x":e=18;break;case"=":e=19;break;case"MC":e=20;break;case"MR":e=21;break;case"MS":e=22;break;case"M+":e=23;break;case"BS":e=24;break;case"CE":e=25;break;case"C":e=26;break;case"pow":e=27;break;default:e=-1}return e},T.prototype.jDb=function(t){var e=this,o=e.gDb.Click(t);null!=o&&(null!==o.result&&void 0!==o.result&&(e.Fi=o.result),null!==o.outputText&&void 0!==o.outputText&&(e.hDb=o.outputText,e._text=e.hDb,e.aDb(e.hDb)),null!==o.isOperationInvalid&&void 0!==o.isOperationInvalid&&o.isOperationInvalid!==e.OCb&&(e.OCb=o.isOperationInvalid,e.fDb(e.OCb)),o.memoryNumber!==e.LCb&&(e.LCb=o.memoryNumber),o.lastOperation!==e.PCb&&(e.PCb=o.lastOperation))},T.prototype.XCb=function(t){var e=this.gDb.XCb(t);return null==e||-1!==e&&void this.jDb(e)},e.Calculator=T},"./dist/plugins/celltype/editor/calendar.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,m,c,h,y,b,f,p,d,v,C,g,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J,Z,q,K,Y,Q,X,$,tt,et,ot,nt=this&&this.__extends||($=function(t,e){return($=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}$(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function rt(t){return c.createElement(t)}function it(t,e){var n=tt.call(this,t)||this;return n.rDb=7,n.JK=!0,n.aT=new Q(n),n._render=new X(n),n._render.on(i.BaseDropdown.Event_ValueChanged,function(t){var e=(new s.Common.CultureInfo).DateTimeFormat,o=new s.Formatter.GeneralFormatter(e.defaultDatePattern).format(t.newValue);n.fire(i.BaseDropdown.Event_ValueChanged,{text:o,value:t.newValue})}),n._render.on(X.Event_GetHost,function(t){t.host=n._host}),n._render.createCalendarDom(),n._render.attachEvent(),n.setValue(new Date),n._render.showCalendarPage(l.CalendarPage.day),n._render.setCalendarActivePart(V.Date),e&&n.setOptions(e),n}function at(t){var e=et.call(this)||this;return e.sDb=40,e.tDb=100,e.uDb=!1,e.tc=t,e}function st(t){this.owner=t,this.calendarPage=l.CalendarPage.month,this.oldSelectedData=null,this.selectedDate=new Date,this.focusDate=new Date(this.selectedDate.valueOf()),this.focusDateTimeIndex=-1,z.initResource()}function lt(t,e,o,n){this.date=t,this.selected=!!e,this.disabled=!!o,this.focused=!!n}function ut(t,e,o,n){this.month=t,this.selected=!!e,this.disabled=!!o,this.focused=!!n}function ct(t,e,o,n){this.year=t,this.selected=!!e,this.disabled=!!o,this.focused=!!n}function ht(){}function ft(){}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/celltype/editor/eventbase.js"),r=o("./dist/plugins/celltype/editor/timepicker.js"),i=o("./dist/plugins/celltype/editor/baseControl.js"),a=o("./dist/plugins/celltype/celltypes.ns.js"),s=o("@grapecity/js-sheets-common"),l=o("Core"),u=new s.Common.ResourceManager(a.SR),m=u.getResource.bind(u),c=document,h="gc-content-container",y="gc-header-container",b="gc-header-title",f="gc-year-page",p="gc-month-page",d="gc-day-page",v="gc-left-arrow",C="gc-right-arrow",g="gc-is-focused",w="gc-cl-is-selected",x="gc-cl-disabled-text",T="gc-cl-select-container",A="gc-focus-part-indicator",S="gc-cl-datepicker",M="gc-cl-dropdown",I="gc-cl-datepicker-filter",N="gc-cl-datepicker-filter-month",R="gc-cl-grid-align-spread",k="gc-cl-align-middle",E="gc-cl-button-icon-container",D="gc-cl-datepicker-month",j="gc-cl-day",_="gc-cl-grow",O="gc-cl-grid",F="gc-cl-button",P="year-index",L="month-index",H="week-index",B="day-index",(ot=V=V||{})[ot.Date=1]="Date",ot[ot.Time=2]="Time",ft.initResource=function(){ft.resource={shortWeeks:[m().Calendar_ShortWeeks_1,m().Calendar_ShortWeeks_2,m().Calendar_ShortWeeks_3,m().Calendar_ShortWeeks_4,m().Calendar_ShortWeeks_5,m().Calendar_ShortWeeks_6,m().Calendar_ShortWeeks_7],shortMonths:[m().Calendar_ShortMonths_1,m().Calendar_ShortMonths_2,m().Calendar_ShortMonths_3,m().Calendar_ShortMonths_4,m().Calendar_ShortMonths_5,m().Calendar_ShortMonths_6,m().Calendar_ShortMonths_7,m().Calendar_ShortMonths_8,m().Calendar_ShortMonths_9,m().Calendar_ShortMonths_10,m().Calendar_ShortMonths_11,m().Calendar_ShortMonths_12],weeks:[m().Calendar_Weeks_7,m().Calendar_Weeks_1,m().Calendar_Weeks_2,m().Calendar_Weeks_3,m().Calendar_Weeks_4,m().Calendar_Weeks_5,m().Calendar_Weeks_6],months:[m().Calendar_Months_1,m().Calendar_Months_2,m().Calendar_Months_3,m().Calendar_Months_4,m().Calendar_Months_5,m().Calendar_Months_6,m().Calendar_Months_7,m().Calendar_Months_8,m().Calendar_Months_9,m().Calendar_Months_10,m().Calendar_Months_11,m().Calendar_Months_12],timePrefix:[m().Calendar_Time_AM,m().Calendar_Time_PM],eraNames:[m().Calendar_EraName_1,m().Calendar_EraName_2,m().Calendar_EraName_3,m().Calendar_EraName_4],earFirstYear:m().Calendar_FirstYear,today:m().Calendar_Today,lastMonth:m().Calendar_LastMonth,nextMonth:m().Calendar_NextMonth,lastYear:m().Calendar_LastYear,nextYear:m().Calendar_NextYear,lastTenYears:m().Calendar_LastTenYear,nextTenYears:m().Calendar_NextTenYear}},ft.resource={shortWeeks:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],shortMonths:["Jan","Feb","Mar","Api","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weeks:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],months:["January","February","March","Apirl","May","June","July","August","September","October","November","December"],timePrefix:["AM","PM"],eraNames:["M","T","S","H"],earFirstYear:"1",today:"Today",lastMonth:"Go to previous month",nextMonth:"Go to next month",lastYear:"Go to previous year",nextYear:"Go to next year",lastTenYears:"Go to previous ten years",nextTenYears:"Go to next ten years"},z=ft,W=function(){this.yearTds=[]},G=function(){this.monthTds=[]},U=function(){this.weekThs=[],this.dayTds=[]},J=function(){this.calendarYearSection=new W,this.calendarMonthSection=new G,this.calendarDaySection=new U,this.timeItemLIs=[]},ht.dateEqual=function(t,e,o){if(!t&&!e)return!0;if(!t)return!1;if(!e)return!1;try{return o?t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()&&t.getHours()===e.getHours()&&t.getMinutes()===e.getMinutes()&&t.getSeconds()===e.getSeconds():t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()}catch(t){return!1}},ht.getMonthMaxDay=function(t,e){return-1!==[1,3,5,7,8,10,12].indexOf(e)?31:-1!==[4,6,9,11].indexOf(e)?30:t%4==0&&t%100!=0?29:28},ht.isValidEraDate=function(t){return!(t<this.eraMin||t>this.eraMax)},ht.addMilliseconds=function(t,e){var o=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());return o.setMilliseconds(o.getMilliseconds()+e),new Date(o.valueOf())},ht.getEraDate=function(t){var e,o={era:-1,eraYear:-1};if(!ht.isValidEraDate(t))return o;for(e=0;e<ht.eraCount;e++)if(t<(e+1!==ht.eraCount?ht.eraDates[e+1]:ht.addMilliseconds(ht.eraMax,1))){o.era=e,o.eraYear=t.getFullYear()-ht.eraDates[e].getFullYear()+1;break}return o},ht.getEraYearString=function(t){var e=new Date(t,5,30),o=ht.getEraDate(e);return-1===o.era||-1===o.eraYear?""+t:t+"年"},ht.getShortEraYearString=function(t){var e,o=new Date(t,11,31),n=ht.getEraDate(o);return-1===n.era||-1===n.eraYear?"":(e=1===n.eraYear?z.resource.earFirstYear:n.eraYear,z.resource.eraNames[n.era]+e+"年")},ht.getDateLocaleLabel=function(t){var e=t.getHours(),o=t.getMinutes();return(e<12?z.resource.timePrefix[0]:z.resource.timePrefix[1])+" "+(0===e||12===e?"12":""+e%12)+":"+(o<10?"0"+o:""+o)},ht.eraCount=4,ht.eraMax=new Date(2087,11,31,23,59,59),ht.eraMin=new Date(1868,8,8),ht.eraDates=[new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8)],Z=ht,ct.prototype.getLabel=function(){return""+this.year},q=ct,ut.prototype.getLabel=function(){return z.resource.shortMonths[this.month]},K=ut,lt.prototype.getLabel=function(){return""+this.date.getDate()},Y=lt,st.getMonthName=function(t){return z.resource.months[t]},st.getShortMonthName=function(t){return z.resource.shortMonths[t]},st.prototype.updateDayItems=function(){var t,e,o,n,r,i,a;for(this.dayItems=[],t=this.focusDate.getFullYear(),e=this.focusDate.getMonth(),r=n=((o=new Date(t,e,1).getDay()-this.owner.rDb)<0?7+o:o)%7;0<r;r--)(i=new Date(t,e,1)).setDate(i.getDate()-r),a=new Y(i,!1,!0,!1),this.dayItems.push(a);for(r=1;r<=42-n;r++)i=new Date(t,e,r),a=new Y(i),i.getMonth()!==e&&(a.disabled=!0),Z.dateEqual(i,this.selectedDate)&&(a.selected=!0),Z.dateEqual(i,this.selectedDate)&&(a.selected=!0),Z.dateEqual(i,this.focusDate)&&(a.focused=!0),this.dayItems.push(a)},st.prototype.updateMonthItems=function(){var t,e,o=this.selectedDate,n=this.focusDate;for(this.monthItems=[],t=0;t<12;t++)(e=new K(t)).selected=o&&o.getMonth()===t&&o.getFullYear()===n.getFullYear(),e.focused=n&&n.getMonth()===t,this.monthItems.push(e)},st.prototype.updateYearItems=function(){var t,e;for(this.yearItems=[],t=this.focusDateYearRangeStart-1;t<=this.focusDateYearRangeEnd+1;t++)(e=new q(t)).selected=this.selectedDate&&this.selectedDate.getFullYear()===t,e.focused=this.focusDate&&this.focusDate.getFullYear()===t,e.disabled=t<this.focusDateYearRangeStart||t>this.focusDateYearRangeEnd,this.yearItems.push(e)},st.prototype.updateYearRange=function(){this.focusDateYearRangeStart=10*Math.floor(this.focusDate.getFullYear()/10),this.focusDateYearRangeEnd=this.focusDateYearRangeStart+9},st.prototype.getShortWeekName=function(t){return z.resource.shortWeeks[t=(this.owner.rDb+t-1)%7]},st.prototype.getCurrentMonthName=function(){var t=this.focusDate.getMonth();return st.getMonthName(t)},Q=st,et=n.EventBase,nt(at,et),Object.defineProperty(at.prototype,"host",{get:function(){return this.tc.getContainer()},enumerable:!0,configurable:!0}),at.prototype.createCalendarDom=function(){var t,e,o,n,r,i,a,s=this.tc;this.vDb=new J,(t=rt("div")).tabIndex=0,t.classList.add("gc-calendar-container"),s.JK?t.classList.add("gc-date-time-container"):t.classList.add("gc-date-container"),e=rt("table"),o=rt("tr"),(n=rt("td")).classList.add("gc-content-td-date"),s.JK&&n.classList.add("gc-content-td-time"),n.appendChild(this.wDb()),o.appendChild(n),e.appendChild(o),t.appendChild(e),s.JK&&(r=rt("tr"),i=rt("td"),n.appendChild(this.xDb()),n.appendChild(this.yDb()),i.appendChild(this.zDb()),i.appendChild(this.ADb()),r.appendChild(i),e.appendChild(r)),this.vDb.outterContainerDiv=t,(a=this.host)&&(a.innerHTML="",a.appendChild(t))},at.prototype.ADb=function(){var t,e=rt("div");return e.classList.add("gc-ok-button-container"),(t=rt("button")).textContent="OK",t.className=F+" gc-cl-button-brand gc-uiButton",e.appendChild(t),this.vDb.okButton=t,e},at.prototype.xDb=function(){var t=rt("div");return t.classList.add("gc-date-time-vertical-partline"),t},at.prototype.zDb=function(){var t=rt("div");return t.classList.add("gc-date-time-horizontal-partline"),t},at.prototype.wDb=function(){var t=rt("div");return t.className="gc-date-part-container "+S+" "+M,t.tabIndex=0,t.appendChild(this.BDb()),t.appendChild(this.CDb()),t.appendChild(this.DDb()),this.vDb.dateContainerDiv=t},at.prototype.BDb=function(){var t=rt("div");return t.classList.add(f),t.appendChild(this.EDb()),t.appendChild(this.FDb()),t},at.prototype.EDb=function(){var t,e,o,n,r,i,a,s=rt("div");return s.className=y+" "+I+" "+O,(t=rt("div")).className=N+" "+O+" "+R+" "+_,rt("div").classList.add(k),(e=rt("button")).className=F+" "+E,e.title=m().Calendar_LastTenYear,(o=rt("div")).classList.add(v),e.appendChild(o),(n=rt("span")).classList.add(k),(r=rt("button")).className=F+" "+E,r.title=m().Calendar_NextTenYear,(i=rt("div")).classList.add(C),r.appendChild(i),t.appendChild(e),t.appendChild(n),t.appendChild(r),(a=this.vDb.calendarYearSection).headerDiv=s,a.lastYearRangeButton=e,a.focusDateYearRangeName=n,a.nextYearRangeButton=r,s.appendChild(t),s},at.prototype.FDb=function(){var t,e=rt("table");return e.className=h+" "+D,(t=rt("div")).appendChild(e),this.vDb.calendarYearSection.currentYearRangeTable=e,this.GDb(),t},at.prototype.GDb=function(){var t,e,o,n,r,i=this.vDb.calendarYearSection,a=rt("tbody");for(t=0;t<3;t++){for(e=rt("tr"),o=0;o<4;o++)(n=rt("td")).setAttribute(P,""+(4*t+o)),(r=rt("span")).classList.add(j),r.setAttribute(P,""+(4*t+o)),r.innerText=""+(4*t+o+1),n.appendChild(r),e.appendChild(n),i.yearTds.push(n);a.appendChild(e)}i.currentYearRangeTable.appendChild(a)},at.prototype.CDb=function(){var t=rt("div");return t.classList.add(p),t.appendChild(this.HDb()),t.appendChild(this.IDb()),t},at.prototype.HDb=function(){var t,e,o,n,r,i,a,s=rt("div");return s.className=y+" "+I+" "+O,(t=rt("div")).className=N+" "+O+" "+R+" "+_,rt("div").classList.add(k),(e=rt("button")).className=F+" "+E,e.title=m().Calendar_LastYear,(o=rt("div")).classList.add(v),e.appendChild(o),(n=rt("span")).className=b+" "+k,(r=rt("button")).className=F+" "+E,r.title=m().Calendar_NextYear,(i=rt("div")).classList.add(C),r.appendChild(i),t.appendChild(e),t.appendChild(n),t.appendChild(r),(a=this.vDb.calendarMonthSection).headerDiv=s,a.lastYearButton=e,a.currentYearName=n,a.nextYearButton=r,s.appendChild(t),s},at.prototype.IDb=function(){var t,e=rt("table");return e.className=h+" "+D,(t=rt("div")).appendChild(e),this.vDb.calendarMonthSection.currentYearTable=e,this.JDb(),t},at.prototype.JDb=function(){var t,e,o,n,r,i=this.vDb.calendarMonthSection,a=rt("tbody");for(t=0;t<3;t++){for(e=rt("tr"),o=0;o<4;o++)(n=rt("td")).setAttribute(L,""+(4*t+o+1)),(r=rt("span")).classList.add(j),r.setAttribute(L,""+(4*t+o+1)),r.innerText=""+(4*t+o+1),n.appendChild(r),e.appendChild(n),i.monthTds.push(n);a.appendChild(e)}i.currentYearTable.appendChild(a)},at.prototype.DDb=function(){var t=rt("div");return t.classList.add(d),t.appendChild(this.KDb()),t.appendChild(this.LDb()),t.appendChild(this.MDb()),t.appendChild(this.NDb()),t},at.prototype.KDb=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g=rt("div");for(g.className=y+" "+I+" "+O,(t=rt("div")).className=N+" "+O+" "+R+" "+_,rt("div").classList.add(k),(e=rt("button")).className=F+" "+E,e.title=m().Calendar_LastMonth,(o=rt("div")).classList.add(v),e.appendChild(o),(n=rt("span")).className=b+" "+k,(r=rt("button")).className=F+" "+E,r.title=m().Calendar_NextMonth,(i=rt("div")).classList.add(C),r.appendChild(i),t.appendChild(e),t.appendChild(n),t.appendChild(r),(a=rt("div")).className="gc-year-select-div gc-cl-shrink-none",(s=rt("div")).classList.add(T),(l=rt("select")).classList.add("gc-cl-select"),c=(u=new Date).getFullYear()-this.tDb,h=u.getFullYear()+this.sDb,f=c;f<=h;f++)(p=rt("option")).text=""+f,p.value=""+f,l.options.add(p);return rt("div").classList.add(T),s.appendChild(l),a.appendChild(s),g.appendChild(a),g.appendChild(t),(d=this.vDb.calendarDaySection).headerDiv=g,d.lastMonthButton=e,d.currentMonthName=n,d.nextMonthButton=r,d.yearSelect=l,g},at.prototype.LDb=function(){var t,e,o,n,r,i,a=rt("div");for(a.className="gc-week-container "+I+" "+O,(t=rt("table")).className=h+" "+D,e=rt("thead"),o=rt("tr"),n=0;n<7;n++)(r=rt("th")).setAttribute(H,""+n),(i=rt("span")).classList.add("gc-cl-week"),i.setAttribute(H,""+n),i.innerText=this.tc.aT.getShortWeekName(n),r.appendChild(i),o.appendChild(r),this.vDb.calendarDaySection.weekThs.push(r);return e.appendChild(o),t.appendChild(e),a.appendChild(t),a},at.prototype.MDb=function(){var t,e,o,n,r,i,a=this.vDb.calendarDaySection,s=rt("div"),l=rt("div"),u=rt("table");for(u.className=h+" "+D,t=rt("tbody"),e=0;e<6;e++){for(o=rt("tr"),n=0;n<7;n++)(r=rt("td")).setAttribute(B,""+(7*e+n)),(i=rt("span")).classList.add(j),i.setAttribute(B,""+(7*e+n)),r.appendChild(i),o.appendChild(r),a.dayTds.push(r);t.appendChild(o)}return u.appendChild(t),l.appendChild(u),s.appendChild(l),a.dayContentTable=u,s},at.prototype.NDb=function(){var t,e,o,n,r,i=rt("div");return i.classList.add("gc-today-container"),(t=rt("table")).classList.add(h),e=rt("tbody"),o=rt("tr"),n=rt("td"),(r=rt("a")).href="javascript:void(0);",r.className="gc-cl-show-inline-block gc-cl-p-bottom-x-small",r.innerText=z.resource.today,n.appendChild(r),o.appendChild(n),e.appendChild(o),t.appendChild(e),i.appendChild(t),this.vDb.calendarDaySection.todayTd=n,this.vDb.calendarDaySection.todayTable=t,i},at.prototype.yDb=function(){var e=this,t=rt("div");return t.className="gc-time-part-container "+S+" "+M,t.tabIndex=0,this.vDb.timeContainerDiv=t,this.ODb=new r.TimePicker(t),this.ODb.setOptions({step:{minute:30},height:260}),this.ODb.on(i.BaseDropdown.Event_ValueChanged,function(t){e.PDb(t)}),t},at.prototype.updateCalendarDom=function(){this.QDb(),this.tc.JK&&this.RDb()},at.prototype.QDb=function(){switch(this.tc.aT.calendarPage){case l.CalendarPage.year:this.SDb();break;case l.CalendarPage.month:this.TDb();break;case l.CalendarPage.day:this.UDb()}},at.prototype.VDb=function(){var t,e,o,n,r,i=this.tc.aT,a=this.vDb.calendarDaySection,s=!1;for(a.currentMonthName.innerText=i.getCurrentMonthName(),t=i.focusDate.getFullYear(),e=a.yearSelect,o=0;o<e.options.length;o++)if(""+t===e.options[o].value){e.selectedIndex=o,s=!0;break}n=this.sDb+this.tDb+1,s?e.options[n]&&e.selectedIndex<=n-1&&e.options[n].remove():((r=rt("option")).text=""+t,r.value=""+t,e.options[n]=r,e.selectedIndex=n)},at.prototype.SDb=function(){var t,e,o,n,r,i,a,s,l=this.tc.aT,u=this.vDb.calendarYearSection;for(l.updateYearItems(),u.focusDateYearRangeName.innerText=l.focusDateYearRangeStart+" - "+l.focusDateYearRangeEnd,t=u.yearTds,e=l.yearItems,o=0;o<3;o++)for(n=0;n<4;n++)i=e[r=4*o+n],(s=(a=t[r]).querySelector("span")).innerText=i.getLabel(),i.disabled?a.classList.add(x):a.classList.remove(x),i.selected?a.classList.add(w):a.classList.remove(w),i.focused?s.classList.add(g):s.classList.remove(g)},at.prototype.TDb=function(){var t,e,o,n,r,i,a,s,l,u=this.tc.aT,c=this.vDb.calendarMonthSection;for(u.updateMonthItems(),t=u.focusDate.getFullYear(),e=u.monthItems,o=c.monthTds,c.currentYearName.innerText=""+t,n=0;n<3;n++)for(r=0;r<4;r++)a=e[i=4*n+r],(l=(s=o[i]).querySelector("span")).innerText=a.getLabel(),a.selected?s.classList.add(w):s.classList.remove(w),a.focused?l.classList.add(g):l.classList.remove(g)},at.prototype.UDb=function(){this.VDb(),this.WDb()},at.prototype.WDb=function(){var t,e,o,n,r,i,a,s,l=this.tc.aT;for(l.updateDayItems(),t=l.dayItems,e=this.vDb.calendarDaySection.dayTds,o=0;o<6;o++)for(n=0;n<7;n++)i=t[r=7*o+n],(s=(a=e[r]).querySelector("span")).innerText=i.getLabel(),i.disabled?a.classList.add(x):a.classList.remove(x),i.focused?s.classList.add(g):s.classList.remove(g),i.selected?a.classList.add(w):a.classList.remove(w)},at.prototype.RDb=function(){this.ODb.setValue(this.tc.aT.selectedDate)},at.prototype.attachEvent=function(){this.XDb(),this.attachDateEvent(),this.tc.JK&&this.attachTimeEvent()},at.prototype.XDb=function(){var e=this;this.vDb.outterContainerDiv.addEventListener("keydown",function(t){e.YDb(t)})},at.prototype.YDb=function(t){return 9===t.keyCode?(this.tc.JK&&(this.tc.aT.calendarActivePart===V.Date?this.setCalendarActivePart(V.Time):this.setCalendarActivePart(V.Date)),void t.preventDefault()):void(this.tc.aT.calendarActivePart===V.Date&&this.ZDb(t))},at.prototype.ZDb=function(t){switch(this.tc.aT.calendarPage){case l.CalendarPage.year:this.$Db(t);break;case l.CalendarPage.month:this._Db(t);break;case l.CalendarPage.day:this.aEb(t)}},at.prototype.$Db=function(t){var e=this.tc.aT,o=e.focusDate;switch(t.keyCode){case 13:e.selectedDate=new Date(o.valueOf()),this.showCalendarPage(l.CalendarPage.month);break;case 32:e.selectedDate=new Date(o.valueOf());break;case 37:this.bEb();break;case 39:this.cEb();break;case 38:this.bEb(4);break;case 40:t.ctrlKey||t.metaKey?this.dEb():this.cEb(4);break;case 36:o.setFullYear(e.focusDateYearRangeStart);break;case 35:o.setFullYear(e.focusDateYearRangeEnd);break;case 33:this.eEb();break;case 34:this.fEb()}e.updateYearRange(),this.QDb()},at.prototype._Db=function(t){var e=this.tc.aT,o=e.focusDate;switch(t.keyCode){case 13:e.selectedDate=new Date(o.valueOf()),this.showCalendarPage(l.CalendarPage.day);break;case 32:e.selectedDate=new Date(o.valueOf());break;case 37:this.gEb();break;case 39:this.hEb();break;case 38:t.ctrlKey||t.metaKey?this.iEb():this.gEb(4);break;case 40:t.ctrlKey||t.metaKey?this.jEb():this.hEb(4);break;case 36:o.setMonth(0);break;case 35:o.setMonth(11);break;case 33:this.bEb();break;case 34:this.cEb()}this.QDb()},at.prototype.aEb=function(t){var e=this.tc.aT,o=e.focusDate,n=o.getFullYear(),r=o.getMonth(),i=o.getDate(),a=Z.getMonthMaxDay(n,r+1);switch(t.keyCode){case 13:return e.selectedDate=new Date(o.valueOf()),void this.lEb();case 32:e.selectedDate=new Date(o.valueOf());break;case 37:o.setDate(i-1);break;case 39:o.setDate(i+1);break;case 38:o.setDate(i-7);break;case 40:o.setDate(i+7);break;case 36:o.setDate(1);break;case 35:o.setDate(a);break;case 33:t.shiftKey?this.gEb(12):this.gEb();break;case 34:t.shiftKey?this.hEb(12):this.hEb()}e.selectedDate=new Date(o.valueOf()),this.QDb()},at.prototype.attachDateEvent=function(){var o=this;this.vDb.dateContainerDiv.addEventListener("click",function(t){var e=t.target;e&&(e===o.vDb.calendarDaySection.yearSelect||e.parentElement===o.vDb.calendarDaySection.yearSelect)||o.setCalendarActivePart(V.Date)}),this.attachYearEvent(),this.attachMonthEvent(),this.attachDayEvent()},at.prototype.attachYearEvent=function(){var e=this;this.vDb.calendarYearSection.lastYearRangeButton.addEventListener("click",function(t){e.eEb(),e.QDb()}),this.vDb.calendarYearSection.nextYearRangeButton.addEventListener("click",function(t){e.fEb(),e.QDb()}),this.vDb.calendarYearSection.currentYearRangeTable.addEventListener("click",function(t){e.mEb(t)})},at.prototype.eEb=function(){var t=this.tc.aT;t.focusDateYearRangeStart-=10,t.focusDateYearRangeEnd=t.focusDateYearRangeStart+9,t.focusDate.setFullYear(t.focusDate.getFullYear()-10)},at.prototype.fEb=function(){var t=this.tc.aT;t.focusDateYearRangeStart+=10,t.focusDateYearRangeEnd=t.focusDateYearRangeStart+9,t.focusDate.setFullYear(t.focusDate.getFullYear()+10)},at.prototype.dEb=function(){this.showCalendarPage(l.CalendarPage.month)},at.prototype.mEb=function(t){var e,o,n=t.srcElement||t.target;n&&(e=+n.getAttribute(P),o=this.tc.aT.yearItems[e],this.tc.aT.focusDate.setFullYear(o.year),this.dEb())},at.prototype.attachMonthEvent=function(){var e=this;this.vDb.calendarMonthSection.lastYearButton.addEventListener("click",function(t){e.bEb(),e.QDb()}),this.vDb.calendarMonthSection.nextYearButton.addEventListener("click",function(t){e.cEb(),e.QDb()}),this.vDb.calendarMonthSection.currentYearName.addEventListener("click",function(t){e.iEb()}),this.vDb.calendarMonthSection.currentYearTable.addEventListener("click",function(t){e.nEb(t)})},at.prototype.bEb=function(t){var e=t||1,o=Math.max(this.tc.aT.focusDate.getFullYear()-e,0);this.tc.aT.focusDate.setFullYear(o)},at.prototype.cEb=function(t){var e=t||1,o=Math.min(this.tc.aT.focusDate.getFullYear()+e,9999);this.tc.aT.focusDate.setFullYear(o)},at.prototype.iEb=function(){this.tc.aT.updateYearRange(),this.showCalendarPage(l.CalendarPage.year)},at.prototype.jEb=function(){this.showCalendarPage(l.CalendarPage.day)},at.prototype.nEb=function(t){var e,o=t.srcElement||t.target;o&&(e=+o.getAttribute(L),this.tc.aT.focusDate.setMonth(e-1),this.jEb())},at.prototype.attachDayEvent=function(){var e=this,t=this.vDb.calendarDaySection;t.lastMonthButton.addEventListener("click",function(t){e.gEb(),e.uDb||e.QDb()}),t.nextMonthButton.addEventListener("click",function(t){e.hEb(),e.uDb||e.QDb()}),t.currentMonthName.addEventListener("click",function(t){e.oEb()}),t.todayTable.addEventListener("click",function(t){e.pEb()}),t.dayContentTable.addEventListener("click",function(t){e.qEb(t)}),t.yearSelect.addEventListener("change",function(t){e.rEb(t)}),this.vDb.calendarDaySection.yearSelect.addEventListener("keydown",function(t){t.stopPropagation()})},at.prototype.gEb=function(t){var e,o,n=this.tc.aT,r=t||1,i=n.focusDate.getFullYear(),a=n.focusDate.getMonth()-r,s=n.focusDate.getDate();a<0&&(a+=12,--i),e=Z.getMonthMaxDay(i,a+1),o=new Date(i,a,Math.min(s,e)),n.focusDate=o},at.prototype.hEb=function(t){var e,o,n=this.tc.aT,r=t||1,i=n.focusDate.getFullYear(),a=n.focusDate.getMonth()+r,s=n.focusDate.getDate();11<a&&(a-=12,i+=1),e=Z.getMonthMaxDay(i,a+1),o=new Date(i,a,Math.min(s,e),n.focusDate.getHours(),n.focusDate.getMinutes(),n.focusDate.getSeconds()),n.focusDate=o},at.prototype.oEb=function(){this.showCalendarPage(l.CalendarPage.month)},at.prototype.qEb=function(t){var e,o,n,r,i=this.tc.aT,a=t.srcElement||t.target;a&&(e=a.getAttribute(B),o=i.dayItems[+e].date,r=(n=i.selectedDate)?new Date(n.valueOf()):new Date,i.selectedDate=new Date(o.getFullYear(),o.getMonth(),o.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()),i.focusDate=new Date(i.selectedDate.valueOf()),this.QDb(),this.tc.JK||this.lEb()),this.vDb.dateContainerDiv.focus()},at.prototype.pEb=function(){var t=this.tc,e=t.aT.selectedDate,o=e?new Date(e.valueOf()):null,n=new Date;o&&(n.setHours(o.getHours()),n.setMinutes(o.getMinutes()),n.setSeconds(0)),t.aT.selectedDate=n,t.aT.focusDate=new Date(n.valueOf()),this.QDb(),t.JK||this.lEb()},at.prototype.rEb=function(t){var e=t.srcElement||t.target;e&&(this.tc.aT.focusDate.setFullYear(+e.value),this.updateCalendarDom())},at.prototype.attachTimeEvent=function(){var e=this;this.vDb.timeContainerDiv.addEventListener("click",function(t){e.setCalendarActivePart(V.Time)}),this.vDb.okButton.addEventListener("click",function(t){e.lEb()})},at.prototype.PDb=function(t){var e=this.tc.aT,o=e.selectedDate?new Date(e.selectedDate.valueOf()):new Date,n=t.value;o.setHours(n.getHours()),o.setMinutes(n.getMinutes()),o.setSeconds(n.getSeconds()),e.selectedDate=o,e.focusDate=new Date(o.valueOf())},at.prototype.lEb=function(){var t=this.tc.aT;this.fire(i.BaseDropdown.Event_ValueChanged,{oldValue:t.oldSelectedData,newValue:t.selectedDate}),t.oldSelectedData=t.selectedDate},at.prototype.showCalendarPage=function(t){var e=this.host.querySelector("."+f),o=this.host.querySelector("."+p),n=this.host.querySelector("."+d);switch(e.style.display="none",o.style.display="none",n.style.display="none",t){case l.CalendarPage.year:e.style.display="";break;case l.CalendarPage.month:o.style.display="";break;case l.CalendarPage.day:n.style.display=""}this.tc.aT.calendarPage=t,this.updateCalendarDom()},at.prototype.setCalendarActivePart=function(t){switch(this.tc.aT.calendarActivePart=t,this.vDb.dateContainerDiv.classList.remove(A),this.tc.JK&&this.vDb.timeContainerDiv.classList.remove(A),t){case V.Date:this.tc.JK&&this.vDb.dateContainerDiv.classList.add(A),this.vDb.outterContainerDiv.focus();break;case V.Time:this.tc.JK&&this.vDb.timeContainerDiv.classList.add(A),this.vDb.outterContainerDiv.focus()}},at.Event_GetHost="GetHost",X=at,tt=i.BaseDropdown,nt(it,tt),it.prototype.setOptions=function(t){var e,o;t&&(t.showTime||(this.JK=t.showTime,this._render.createCalendarDom(),this._render.attachEvent()),e=t&&t.calendarPage?t.calendarPage:l.CalendarPage.day,(o=t&&t.startDay?t.startDay:l.CalendarStartDay.saturday)!==this.rDb&&(this.rDb=o,this._host.innerHTML="",this._render.createCalendarDom(),this._render.attachEvent()),this._render.showCalendarPage(e),this._render.setCalendarActivePart(V.Date))},it.prototype.setValue=function(t){var e=this.aT;e.selectedDate=t,e.oldSelectedData=new Date(t.valueOf()),e.focusDate=new Date(t.valueOf()),e.updateYearRange()},it.prototype.scrollToSelect=function(){this._render.updateCalendarDom()},e.Calendar=it},"./dist/plugins/celltype/editor/colorpicker.js":function(t,e,o){"use strict";var n,r,i,a,s,l,c,u,h,f,p,d=this&&this.__extends||(f=function(t,e){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function g(t,e){var o=p.call(this,t)||this;return o.ad(),o.setOptions(e),o}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/celltype/editor/listControl.js"),r=o("Core"),i=o("./dist/plugins/celltype/editor/baseControl.js"),a=o("./dist/plugins/celltype/celltypes.ns.js"),s=o("@grapecity/js-sheets-common"),l=s.Common.j.Fa,c="group-name",u=new s.Common.ResourceManager(a.SR),h=u.getResource.bind(u),p=i.BaseDropdown,d(g,p),g.prototype.setOptions=function(t){if(t){if(this.options=this.options||{},!l(t.colorBlockSize)){var e=parseInt(t.colorBlockSize,10);!isNaN(e)&&0<=e&&(this.options.colorBlockSize=t.colorBlockSize)}l(t.groups)||(this.options.groups=t.groups),this.VF()}else this.VF()},g.prototype.setValue=function(t){l(t)||(this.BYa=t,this.sEb=null,this.VF())},g.prototype.ad=function(){var t,e=this,o=g.DefaultColorGroup(),n=[];for(t=0;t<o.length;t++)n.push({name:o[t].name,colors:o[t].colors,needScaleColor:o[t].needScaleColor});this.options={colorBlockSize:g.DefaultCellWidth,groups:n},this.tEb=document.createElement("div"),this.tEb.classList.add("gc-color-picker-outer-div"),this.tEb.addEventListener("click",function(t){e.uEb(t)}),this._host.appendChild(this.tEb)},g.prototype.VF=function(){this.tEb.innerHTML="",new n.List(this.tEb,this.vEb()),this.wEb()},g.prototype.wEb=function(){var t,e,o,n=this.tEb.querySelectorAll(".gc-color-picker-color-cell");if(0<n.length)for(t=0;t<n.length;t++)n[t].classList.remove("selected"),e=n[t].getAttribute("color"),o=n[t].getAttribute(c),this.BYa===e&&(!this.sEb||this.sEb&&this.sEb===o)&&n[t].classList.add("selected")},g.prototype.xEb=function(){var t,e,o,n,r=0,i=this.options.groups;for(t=0;t<i.length;t++)for(e=i[t],o=0;o<e.colors.length;o++)n=e.colors[o],r=Math.max(r,n.length);return r},g.prototype.vEb=function(){var t,e,o,n=[],r=this.options.colorBlockSize||g.DefaultCellWidth,i=this.xEb(),a=this.options.groups;for(t=0;t<a.length;t++)e=this.yEb(a[t],r,i),n.push(e),a[t].needScaleColor&&(o=this.zEb(a[t].colors[0]),n.push(this.yEb(o,r,i)));return{items:n}},g.prototype.zEb=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d={},g=[];e=[-(g.length=5),-15,-25,-35,-50],o=[-10,-25,-50,-75,-90],n=[80,60,40,-25,-50],r=document.createElement("span"),i=t.length,r.style.display="none",document.body.appendChild(r);try{for(a=0;a<i;a++)for(l=(s=this.AEb(t[a],r))[0],u=s[1],c=s[2],h=this.BEb(l,u,c),f=0;f<5;f++)g[f]||((p=[]).length=i,g[f]=p),g[f][a]=1===h?this.CEb(l,u,c,e[f]):.8<=h?this.CEb(l,u,c,o[f]):0===h?this.CEb(l,u,c,Math.abs(e[5-f-1])):h<=.2?this.CEb(l,u,c,Math.abs(o[5-f-1])):this.CEb(l,u,c,n[f]);d.colors=g}finally{document.body.removeChild(r)}return d},g.prototype.AEb=function(t,e){var o;return e.style.color=t,o=window.getComputedStyle(e).color.replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(","),[parseInt(o[0],10),parseInt(o[1],10),parseInt(o[2],10)]},g.prototype.CEb=function(t,e,o,n){var r,i,a;return n/=100,r=this.DEb(t,e,o),i=parseInt(""+(0<n?(240-r.luminosity)*n:r.luminosity*n),10),a=this.EEb(r.hue,r.luminosity+i,r.saturation),this.FEb(a.r,a.g,a.b)},g.prototype.GEb=function(t){var e=t.toString(16);return 1===e.length?"0"+e:e},g.prototype.FEb=function(t,e,o){return"#"+this.GEb(t)+this.GEb(e)+this.GEb(o)},g.prototype.EEb=function(t,e,o){var n,r,i,a,s;return 0===o?n=r=i=parseInt(""+255*e/240,10):(a=2*e-(s=e<=120?(e*(240+o)+120)/240:e+o-(e*o+120)/240),n=parseInt(""+(255*this.fc(a,s,t+80)+120)/240,10),r=parseInt(""+(255*this.fc(a,s,t)+120)/240,10),i=parseInt(""+(255*this.fc(a,s,t-80)+120)/240,10)),{a:255,r:n,g:r,b:i}},g.prototype.fc=function(t,e,o){return o<0&&(o+=240),240<o&&(o-=240),o<40?t+((e-t)*o+20)/40:o<120?e:o<160?t+((e-t)*(160-o)+20)/40:t},g.prototype.BEb=function(t,e,o){return this.DEb(t,e,o).luminosity/240},g.prototype.DEb=function(t,e,o){var n,r,i,a,s,l=Math.max(Math.max(t,e),o),u=Math.min(Math.min(t,e),o),c=l+u,h=parseInt(""+(240*c+255)/510,10),f=l-u;return 0==f?(n=0,r=160):(n=h<=120?parseInt(""+(240*f+c/2)/c,10):parseInt(""+(240*f+(510-c)/2)/(510-c),10),i=(40*(l-t)+f/2)/f,a=(40*(l-e)+f/2)/f,s=(40*(l-o)+f/2)/f,(r=t===l?parseInt(""+(s-a),10):e===l?parseInt(""+(80+i-s),10):parseInt(""+(160+a-i),10))<0&&(r+=240),240<r&&(r-=240)),{luminosity:h,saturation:n,hue:r}},g.prototype.yEb=function(a,s,l){var u=this,t={items:function(){var t,e,o,n,r,i=document.createElement("div");for(i.classList.add("gc-color-picker-group-row"),i.style.width=(s+7)*l+"px",t=0;t<a.colors.length;t++){for((e=document.createElement("div")).classList.add("gc-color-picker-color-row"),o=a.colors[t],n=0;n<o.length;n++)(r=document.createElement("div")).setAttribute(c,a.name),r.setAttribute("color",o[n]),r.style.backgroundColor=o[n],r.style.width=s+"px",r.style.height=s+"px",r.classList.add("gc-color-picker-color-cell"),u.BYa===o[n]&&u.sEb===a.name&&r.classList.add("selected"),e.appendChild(r);i.appendChild(e)}return i},layout:{direction:r.LayoutDirection.horizontal,displayAs:r.LayoutDisplayAs.inline}};return a.name&&(t.text=a.name),t},g.prototype.uEb=function(t){var e,o,n=t.srcElement||t.target;n&&(e=n.getAttribute("color"),o=n.getAttribute(c),e&&o&&(this.BYa=e,this.sEb=o,this.HEb(e),this.wEb()))},g.prototype.HEb=function(t){this.fire(i.BaseDropdown.Event_ValueChanged,{value:t,text:t})},g.DefaultCellWidth=10,g.DefaultColorGroup=function(){return[{name:h().ThemeColor,colors:[["#ffffff","#000000","#e7e6e6","#44546a","#5b9bd5","#ed7d31","#a5a5a5","#ffc000","#4472c4","#70ad47"]],needScaleColor:!0},{name:h().StandardColor,colors:[["#C00000","#FF0000","#FFC000","#FFFF00","#92D050","#00B050","#00B0F0","#0070C0","#002060","#7030A0"]]}]},e.ColorPicker=g},"./dist/plugins/celltype/editor/eventbase.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=(r.prototype.on=function(t,e){var o=this.IEb[t];null!=o||(o=this.IEb[t]=[]),o.push(e)},r.prototype.off=function(t,e){var o,n;if(t){if(null==(o=this.IEb[t]))return;e?(n=o.indexOf(e),o.splice(n,1)):o=[],this.IEb[t]=o}else this.IEb={}},r.prototype.fire=function(t,e){var o=this,n=this.IEb[t];null!=n&&n.forEach(function(t){try{t.call(o,e)}catch(t){}})},r);function r(){this.IEb={}}e.EventBase=n},"./dist/plugins/celltype/editor/listControl.js":function(t,e,o){"use strict";var l,u,s,p,d,h,n,r,i,g,m,a,y,b,v,c,f,C=this&&this.__extends||(c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function w(t){return n.createElement(t)}function x(t,e){if(s.Common.k.Bb(t,e))return 1;if(s.Common.l.Ska(e))for(var o=0;o<t.length;o++)if(t[o]-e==0)return 1}function T(t,e,o){var n=f.call(this,t)||this;return n._host=w("div"),n._host.classList.add("gc-list-control"),t.appendChild(n._host),n.xn=new r,n.JJb=o&&o.JJb||{Qb:void 0},n.bHb={items:[],doms:[]},n.setOptions(e),n}function A(){this.JEb=new WeakMap}Object.defineProperty(e,"__esModule",{value:!0}),l=o("./dist/plugins/celltype/editor/popupControl.js"),u=o("./dist/plugins/celltype/editor/baseControl.js"),s=o("@grapecity/js-sheets-common"),p=o("Core"),d=s.Common.j.Fa,h=s.Common.k.Cb,n=document,A.prototype.set=function(t,e,o){var n=this.JEb.get(t);n||this.JEb.set(t,n={}),n[e]=o},A.prototype.get=function(t,e){var o=this.JEb.get(t);return o&&o[e]},A.prototype.clear=function(){this.JEb=new WeakMap},r=A,i="gc-list-control-container",g="gc-list-control-item",m="gc-list-control-hassubitem",a="gc-list-control-selected-item",y="gc-list-control-subitem",b="hide-children",v="gc-list-control-tree-content",f=u.BaseDropdown,C(T,f),T.prototype.setOptions=function(t){d(t)||(this.$z=function t(e){if(e.hasOwnProperty("items"))t(e.items);else if(Array.isArray(e))for(var o=0;o<e.length;o++)e[o].hasOwnProperty("items")?t(e[o]):e[o].hasOwnProperty("text")&&!e[o].hasOwnProperty("value")&&(e[o].value=e[o].text);return e}(t),this._host.innerHTML="",this._render())},T.prototype.setValue=function(t){if(this.$z&&this.$z.multiSelect)if("string"==typeof t)t=function(t){var e,o,n,r,i,a,s;if(d(t)||0===t.length)return[];for(e=[],n=o=0;n<t.length;n++)"\\"===(r=t.charAt(n))?","!==(i=t.charAt(n+1))&&"\\"!==i||(s=n,t=(a=t).substring(0,s)+a.substring(s+1,a.length)):","===r&&(e.push(t.substring(o,n)),o=n+1);return e.push(t.substring(o,t.length)),e}(t);else if(d(t))t=[];else if(s.Common.j.Ca(t)){if(1!==this.$z.valueType){t=t.slice(0);for(var e=0;e<t.length;e++)t[e]=""+t[e]}}else t=[t];this.JJb.Qb=t,this.KEb()},T.prototype.scrollToSelect=function(){},T.prototype.updateStyle=function(t,e,o){this._host.style.font=o},T.prototype._render=function(){var t=w("div");t.classList.add(i),this.SXa(t,this.$z),this._host.appendChild(t),this.LXa()},T.prototype.SXa=function(t,e){if(e&&(this.LEb(t,e.layout),e.items))if(Array.isArray(e.items))this.MEb(t,e.items);else{var o=e.items();o instanceof HTMLElement&&(t.appendChild(o),t.classList.add(g),this.LEb(o,e.layout))}},T.prototype.LEb=function(t,e){e&&e.direction===p.LayoutDirection.horizontal?t.classList.add("gc-list-alignment-horizontal"):t.classList.add("gc-list-alignment-vertical")},T.prototype.MEb=function(t,e){var o,n,r,i,a,s,l,u,c,h,f=e.some(function(t){return!!t.icon});for(o=0;o<e.length;o++)e[o].items?(n=e[o]).layout&&n.layout.displayAs===p.LayoutDisplayAs.inline?((r=w("div")).classList.add("gc-list-control-group"),(i=w("span")).innerText=n.text,!d(n.text)&&""!==n.text||i.classList.add(b),i.classList.add("gc-list-control-group-text"),r.appendChild(i),Array.isArray(n.items)?this.SXa(r,n):(a=n.items())instanceof HTMLElement&&((s=w("div")).classList.add(g),this.LEb(a,n.layout),s.appendChild(a),r.appendChild(s)),t.appendChild(r)):n.layout&&n.layout.displayAs===p.LayoutDisplayAs.tree?((l=w("div")).classList.add("gc-list-control-tree"),(u=w("div")).classList.add(g),u.classList.add(m),(i=w("span")).innerText=n.text,i.classList.add("gc-list-control-tree-text"),u.appendChild(i),n.layout.collapsible&&((c=w("span")).classList.add(y),u.appendChild(c),this.NEb(u)),l.appendChild(u),(h=w("div")).classList.add(v),Array.isArray(n.items)?this.SXa(h,n):(a=n.items())instanceof HTMLElement&&((s=w("div")).classList.add(g),this.LEb(a,n.layout),s.appendChild(a),h.appendChild(s)),l.appendChild(h),t.appendChild(l)):this.OEb(t,e[o],!1,!0):this.OEb(t,e[o],f)},T.prototype.OEb=function(t,e,o,n){var r,i,a,s,l,u,c;void 0===n&&(n=!1),(r=w("div")).classList.add(g),"-"===e.text?(r.classList.add("gc-list-control-noitem"),(i=w("div")).classList.add("gc-list-control-listseparator"),r.appendChild(i)):(o&&((a=w("div")).classList.add("gc-list-control-item-icon"),e.icon?a.style.backgroundImage="url("+e.icon+")":a.classList.add("gc-list-control-emptyicon"),r.appendChild(a)),(s=w("span")).classList.add("gc-list-control-item-text"),s.innerText=e.text,d(e.text)&&(s.innerText=d(e.value)?"":e.value),r.appendChild(s),l=d(e.value)?null:e.value,(u=h(this.bHb.items,l))<0&&(u=this.bHb.items.length,this.bHb.doms.push([]),this.bHb.items.push(l)),this.bHb.doms[u].push(r),this.xn.set(r,"items",e),n&&((c=w("span")).classList.add(y),r.classList.add(m),this.xn.set(r,"sub-items",e),r.appendChild(c),this.PEb(r))),t.appendChild(r)},T.prototype.CHb=function(t,e){var o,n=this.bHb.doms[t];if(e)for(o=0;o<n.length;o++)n[o].classList.contains(m)||n[o].classList.add(a);else for(o=0;o<n.length;o++)n[o].classList.contains(a)&&n[o].classList.remove(a)},T.prototype.KEb=function(){var t,e,o,n=this.$z;for(t=d(this.formula)?n&&n.multiSelect?this.JJb.Qb:[this.JJb.Qb]:["="+this.formula],e=0;e<this.bHb.items.length;e++)o=this.bHb.items[e],n&&n.multiSelect&&1!==n.valueType&&(o=""+o),x(t,o)?this.CHb(e,!0):this.CHb(e,!1)},T.prototype.LXa=function(){var a=this;this._host.querySelector("."+i).addEventListener("click",function(t){var e,o,n,r,i=a.QEb(t.target,"."+g);if(i){if(i.classList.contains(m))return void a.KJb(t);e=a.xn.get(i,"items"),o=a.$z,!e&&s.Common.j.Aa(o&&o.onItemSelected)&&(e={value:o.onItemSelected(t)}),d(e)||(n=e.value,o&&o.multiSelect&&(r=(r=a.JJb.Qb).slice(0),o.multiSelect&&1!==o.valueType&&(n=""+n),x(r,n)?function(t,e){var o,n=s.Common.l.Ska(e);for(o=t.length-1;0<=o;o--)(t[o]===e||n&&t[o]-e==0)&&t.splice(o,1)}(r,n):s.Common.k.Sb(r,n),a.JJb.Qb=n=r,a.KEb(),1!==o.valueType&&(n=function(t){var e,o,n=[];for(e=0;e<t.length;e++)(o=t[e])&&"string"==typeof o&&(o=o.replace(/\\/g,"\\\\").replace(/,/g,"\\,")),n[e]=o;return n.join(",")}(n))),a.fire(u.BaseDropdown.Event_ValueChanged,{value:n,text:n,notCloseDropDown:o&&o.multiSelect,noAutoFormat:!0}))}})},T.prototype.QEb=function(t,e){Element.prototype.matches||(Element.prototype.matches=Element.prototype.webkitMatchesSelector||function(t){for(var e=(this.document||this.ownerDocument).querySelectorAll(t),o=e.length;0<=o&&e.item(o)!==this;)--o;return-1<o});for(var o=t;o&&!o.matches(e);)o=o.parentElement;return o},T.prototype.KJb=function(t){var e,o,n,r,i,a=this,s=this.QEb(t.target,"."+g);!s.classList.contains(m)||(e=this.xn.get(s,"sub-items"))&&e.items&&(o=w("div"),n=this.$z,e.multiSelect=n&&n.multiSelect,e.valueType=n&&n.valueType,e.onItemSelected=n&&n.onItemSelected,(r=new T(o,e,this)).KEb(),(i=new l.PopupControl(o,s,{align:l.DropDownAlignment.Near,hostElement:s,direction:l.DropDownDirection.Right})).open(),o.parentElement.style.top="0",r.on(u.BaseDropdown.Event_ValueChanged,function(t){a.fire(u.BaseDropdown.Event_ValueChanged,t),a.$z&&a.$z.multiSelect?a.KEb():i.close()}),this.xn.set(s,"sub-items-popup",i),t.stopPropagation(),t.preventDefault())},T.prototype.PEb=function(t){var n=this;t.addEventListener("mouseenter",function(t){n.KJb(t)}),t.addEventListener("mouseleave",function(t){var e,o=t.target;!o.classList.contains(m)||(e=n.xn.get(o,"sub-items-popup"))&&(e.close(),n.xn.set(o,"sub-items-pop",void 0))})},T.prototype.NEb=function(t){var n=this;t.addEventListener("click",function(t){var e=t.target,o=n.QEb(e,"."+m);!o||o.parentElement.querySelector("."+v)&&(o.parentElement.classList.contains(b)?o.parentElement.classList.remove(b):o.parentElement.classList.add(b),t.stopPropagation(),t.preventDefault())})},e.List=T},"./dist/plugins/celltype/editor/monthPicker.js":function(t,e,o){"use strict";var c,n,h,a,r,l,i,f,p,d,g,m,s,u,y=this&&this.__extends||(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function b(t){return i.createElement(t)}function v(t,e){var o=u.call(this,t)||this;return o.setOptions(e),o.LXa(),o}Object.defineProperty(e,"__esModule",{value:!0}),c=o("./dist/plugins/celltype/editor/baseControl.js"),n=o("./dist/plugins/celltype/celltypes.ns.js"),h=o("@grapecity/js-sheets-common"),a=h.Common.j.Fa,r=new h.Common.ResourceManager(n.SR),l=r.getResource.bind(r),i=document,f="gc-month-picker-month-item",p="gc-month-picker-qtr-item",d="selected",g="data-month",m="data-qtr",u=c.BaseDropdown,y(v,u),v.prototype.setOptions=function(t){var e,o,n,r=new Date,i={startYear:r.getFullYear()-10,stopYear:r.getFullYear(),height:300};t&&(a(t.startYear)||(e=parseInt(t.startYear,10),isNaN(e)||(i.startYear=e)),!a(t.stopYear)&&0<t.stopYear&&(o=parseInt(t.stopYear,10),isNaN(o)||(i.stopYear=o)),i.stopYear<i.startYear&&(i.stopYear=t.startYear),a(t.height)||(n=parseInt(t.height,10),isNaN(n)||(i.height=n))),i.height=Math.max(1,i.height),this.$z=i,this._host.innerHTML="",this.REb()},v.prototype.setValue=function(t){var e,o,n;t&&(e=t.getMonth()+1,o=t.getFullYear()),"number"!=typeof e||(n=this._host.querySelector("["+g+"='"+o+"-"+e+"']"))&&(n.classList.add(d),this.SEb&&this.SEb.classList.remove(d),this.SEb=n)},v.prototype.scrollToSelect=function(){var t,e=this.SEb;e&&(t=e.offsetTop,this._host.scrollTop=t)},v.prototype.TEb=function(t,e){Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(t){for(var e=(this.document||this.ownerDocument).querySelectorAll(t),o=e.length;0<=o&&e.item(o)!==this;)--o;return-1<o});for(var o=t;o&&!o.matches(e);)o=o.parentElement;return o},v.prototype.LXa=function(){var u=this;this._host.addEventListener("click",function(t){var e,o,n,r,i,a,s=u,l=s.TEb(t.target,"."+f+",."+p);l&&(l.getAttribute(m)||(l.classList.add(d),s.SEb&&s.SEb.classList.remove(d),o=e=null,(s.SEb=l).getAttribute(g)&&(e=+(n=l.getAttribute(g).split("-"))[1],o=+n[0]),r=new Date(o,e-1,1,0,0,0,0),i=h.Common.CultureManager.q4().DateTimeFormat,a=new h.Formatter.GeneralFormatter(i.shortDatePattern).format(r),s.fire(c.BaseDropdown.Event_ValueChanged,{text:a,value:r})))})},v.prototype.REb=function(){var t,e,o,n,r=this;for(0<=this.$z.height?r._host.style.maxHeight=this.$z.height+"px":r._host.style.height="auto",r._host.classList.add("gc-month-picker-container"),t=r.$z.startYear;t<=r.$z.stopYear;t++)e=document.createElement("div"),r.UEb(e),(o=document.createElement("div")).classList.add("gc-month-picker-year-container"),r.VEb(t,o),(n=document.createElement("div")).classList.add("gc-month-picker-month-container"),r.WEb(t,1,n),r.WEb(t,2,n),r.WEb(t,3,n),r.WEb(t,4,n),e.appendChild(o),e.appendChild(n),this._host.appendChild(e)},v.prototype.UEb=function(t){var e=b("div");e.classList.add("gc-month-picker-separator"),t.appendChild(e)},v.prototype.VEb=function(t,e){var o=b("div");o.classList.add("gc-month-picker-year-item"),o.innerText=""+t,e.appendChild(o)},v.prototype.WEb=function(t,e,o){var n=document.createElement("div"),r=b("div"),i=b("div"),a=b("div"),s=b("div");switch(r.classList.add(f),i.classList.add(f),a.classList.add(f),s.classList.add(p),e){case 1:r.innerText=l().Calendar_ShortMonths_1,r.setAttribute(g,t+"-1"),i.innerText=l().Calendar_ShortMonths_2,i.setAttribute(g,t+"-2"),a.innerText=l().Calendar_ShortMonths_3,a.setAttribute(g,t+"-3"),s.innerText=l().Quarter_Format_1,s.setAttribute(m,t+"-1");break;case 2:r.innerText=l().Calendar_ShortMonths_4,r.setAttribute(g,t+"-4"),i.innerText=l().Calendar_ShortMonths_5,i.setAttribute(g,t+"-5"),a.innerText=l().Calendar_ShortMonths_6,a.setAttribute(g,t+"-6"),s.innerText=l().Quarter_Format_2,s.setAttribute(m,t+"-2");break;case 3:r.innerText=l().Calendar_ShortMonths_7,r.setAttribute(g,t+"-7"),i.innerText=l().Calendar_ShortMonths_8,i.setAttribute(g,t+"-8"),a.innerText=l().Calendar_ShortMonths_9,a.setAttribute(g,t+"-9"),s.innerText=l().Quarter_Format_3,s.setAttribute(m,t+"-3");break;case 4:r.innerText=l().Calendar_ShortMonths_10,r.setAttribute(g,t+"-10"),i.innerText=l().Calendar_ShortMonths_11,i.setAttribute(g,t+"-11"),a.innerText=l().Calendar_ShortMonths_12,a.setAttribute(g,t+"-12"),s.innerText=l().Quarter_Format_4,s.setAttribute(m,t+"-4")}n.appendChild(r),n.appendChild(i),n.appendChild(a),n.appendChild(s),o.appendChild(n),e<4&&this.UEb(o)},e.MonthPicker=v},"./dist/plugins/celltype/editor/multiColumnPicker.js":function(t,e,o){"use strict";var u,l,n,c,r,a,i,f,s,h,p,d,g,m,y=this&&this.__extends||(g=function(t,e){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}g(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function b(t,e){var r,i,o,n,a,s=t[0],l=[];if(f.isArray(s))for(i=function(t,e){var o=[];return e&&0<e.length?e.forEach(function(t){o.push(t.name)}):o=t.shift(),o}(r=t,e),o=function(t,e){var o=r[t],n={};i.forEach(function(t,e){n[t]=o[e]}),l.push(n)},n=0,a=r.length;n<a;n++)o(n);else l=t;return l}function v(t,e,o){return m.call(this,t,e,o)||this}Object.defineProperty(e,"__esModule",{value:!0}),u=o("Core"),l=o("SheetsCalc"),n=o("@grapecity/js-calc"),c=o("@grapecity/js-calc"),r=o("@grapecity/js-sheets-common"),a=o("./dist/plugins/celltype/editor/baseControl.js"),i=o("./dist/plugins/celltype/editor/baseSpreadPicker.js"),f=o("./node_modules/util/util.js"),s=o("./dist/plugins/celltype/celltypes.ns.js"),h=new r.Common.ResourceManager(s.SR),p=h.getResource.bind(h),d=!!n,m=i.BaseSpreadPicker,y(v,m),v.prototype.setOptions=function(t){var e,o,n,r,i,a,s,l;if(m.prototype.setOptions.call(this,t),(this.$z=t)&&(e=this.Ngc,o=t.dataSource,n=t.bindingInfos,r=e.getActiveSheet(),o)){i=!0,(l=r).suspendPaint(),l.suspendEvent(),l.suspendCalcService(),r.options.isProtected=!0,r.options.rowHeaderVisible=!1,r.selectionPolicy(u.SelectionPolicy.single),r.selectionUnit(u.SelectionUnit.row);try{this.Rgc(r,o,n)}catch(t){i=!1,this.dispose()}finally{i&&r&&((a=new u.Style).THb=!1,r.setStyle(-1,-1,a,u.SheetArea.viewport),(s=r).resumeCalcService(),s.resumeEvent(),s.resumePaint())}}},v.prototype.setValue=function(t){var e,o;this.$z&&(m.prototype.setValue.call(this,t),e=this.Ngc.getActiveSheet(),o=this.Sgc(t),e.setSelection(o,-1,1,-1))},v.prototype.dispose=function(){m.prototype.dispose.call(this)},v.prototype.Rgc=function(t,e,o){if(e){var n=this.Ugc(e);n&&(t.setDataSource(b(n,o)),o&&t.bindColumns(o))}},v.prototype.Ugc=function(t){var e,o,n,r,i,a=t,s=this.Lgc;if(f.isString(a)){if(d){if(o=l.formulaToExpression(s,a),n=s.getCalcService()._evaluateParsedFormula(s.yj(),o,c._createCellIdentity(0,0),!0),r=!1,i=void 0,(c.Convert._isReference(n)||c.Convert.Ca(n))&&((i=c.Convert.Ph(n,0,!1,!1,!1)).isError||i.isConvertError||(r=!0)),!r)throw Error(p().MultiColumn_InvalidDataSource);e=i}}else a instanceof u.Range?e=s.getArray(a.row,a.col,a.rowCount,a.colCount):f.isArray(a)?e=a:a.LLc&&(e=a.LLc);return e},v.prototype.Sgc=function(t){var e,o,n,r,i,a,s,l,u,c,h=0;if(t)if(e=this.Ngc.getActiveSheet(),n=(o=Object.keys(t)).length,i=(r=e.getDataSource()).length,a=!1,s=this.$z.key,f.isNullOrUndefined(s))for(l=0;l<i;l++){for(u=r[l],a=!0,c=0;c<n;c++)if(u[s=o[c]]!==t[s]&&void 0!==u[s]){a=!1;break}if(a){h=l;break}}else for(l=0;l<i;l++)if((u=r[l])[s]===t){h=l;break}return h},v.prototype.submitData=function(t){var e,o,n,r,i=t.sheet;t.isEsc?e={notSubmit:!0}:-1<(o=i.getSelections()[0].row)&&(n=i.getDataItem(o),r=this.$z.key,f.isNullOrUndefined(r)||(n=n[r]),e={value:n,text:n}),f.isNullOrUndefined(e)||this.fire(a.BaseDropdown.Event_ValueChanged,e)},e.MultiColumn=v},"./dist/plugins/celltype/editor/popupControl.js":function(t,e,o){"use strict";var n,T,A,S,M,r,i,a,s,l,u,c=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function h(t,e,o){var n=a.call(this,null)||this;return n.sourceElement=t,n.target=e,n.defaultOption={closeAfterResize:!0,closeAfterClickOutside:!0,direction:T.Down,align:A.Near,horAdj:S.Flip|S.Slide,verAdj:S.Flip|S.Slide},n.globalMousedownEventHandler=function(t){var e;if(n.cXa){for(e=t.target;e&&e!==n.sourceElement;)e=e.parentElement;e||(n.close(),t.stopPropagation(),t.preventDefault())}},n.windowResizeEventHandler=function(){n.cXa&&n.close()},n.$z=n.defaultOption,n.cXa=!1,o&&n.mergeOption(o),n.XEb=null===n.$z.hostElement||void 0===n.$z.hostElement||!(n.$z.hostElement instanceof HTMLElement),n}function f(t,e,o,n){this.XHa=t,this.YHa=e,this.Vo=o,this._v=n}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/celltype/editor/baseControl.js"),(u=T=e.DropDownDirection||(e.DropDownDirection={}))[u.Down=0]="Down",u[u.Up=1]="Up",u[u.Left=2]="Left",u[u.Right=3]="Right",(l=A=e.DropDownAlignment||(e.DropDownAlignment={}))[l.Near=0]="Near",l[l.Center=1]="Center",l[l.Far=2]="Far",(s=S=e.DropDownAdjustment||(e.DropDownAdjustment={}))[s.None=0]="None",s[s.Flip=1]="Flip",s[s.Slide=2]="Slide",f.CreateFromDom=function(t){return new f(t.left,t.top,t.width,t.height)},Object.defineProperty(f.prototype,"x",{get:function(){return this.XHa},set:function(t){this.XHa=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"y",{get:function(){return this.YHa},set:function(t){this.YHa=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"width",{get:function(){return this.Vo},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"height",{get:function(){return this._v},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"left",{get:function(){return this.XHa},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"right",{get:function(){return this.XHa+this.Vo},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"top",{get:function(){return this.YHa},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"bottom",{get:function(){return this.YHa+this._v},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"Location",{get:function(){return{X:this.XHa,Y:this.YHa}},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"Size",{get:function(){return{width:this.Vo,height:this._v}},enumerable:!0,configurable:!0}),f.prototype.Offset=function(){var t,e=[];for(t=0;t<arguments.length;t++)e[t]=arguments[t];1===e.length&&"number"==typeof e[0].X&&"number"==typeof e[0].X?(this.XHa+=e[0].X,this.YHa+=e[0].Y):2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&(this.XHa+=e[0],this.YHa+=e[1])},M=f,e.Rectangle=M,r="ribbon-dropdowngroup-popup",a=n.BaseControl,c(h,a),h.prototype.open=function(){this.cXa||(this.beforeOpen(),this.render(),this.clearPosition(),this.calcPosition(),this.cXa=!0,this.sourceElement.tabIndex=-1,this.sourceElement.style.cssText+="outline:none",this.sourceElement.focus())},h.prototype.beforeOpen=function(){this.bindEvent()},h.prototype.dispose=function(){var e=this;this.$z.closeAfterResize&&document.removeEventListener("resize",this.windowResizeEventHandler),this.$z.closeAfterClickOutside&&(document.removeEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach(function(t){document.removeEventListener(t,e.globalMousedownEventHandler,!0)})),this.XEb?(this.sourceElement.classList.remove(r),this.sourceElement.style.display=this.YEb,this.sourceElement.style.position=this.xC):this.ZEb&&this.ZEb.parentNode&&(this.$z.hostElement.removeChild(this.ZEb),this.ZEb=null)},h.prototype.close=function(){this.cXa&&(this.cXa=!1,this.dispose(),this.fire("close"))},h.prototype.mergeOption=function(t){for(var e in t)void 0!==t[e]&&(this.$z[e]=t[e])},h.prototype.clearPosition=function(){this.$Eb.style.top=this.$Eb.style.bottom=this.$Eb.style.left=this.$Eb.style.right=""},h.prototype.calcPosition=function(){var t,e,o,n,r,i,a,s,l;t=this.target instanceof M?this.target:M.CreateFromDom(this.target.getBoundingClientRect()),e=new M(0,0,window.innerWidth,window.innerHeight),o=this.calculateDropDownLocation(e,t,{width:this.sourceElement.offsetWidth,height:this.sourceElement.offsetHeight},this.$z.direction,this.$z.align,this.$z.horAdj,this.$z.verAdj),r=(n=this.$Eb.offsetParent).getBoundingClientRect(),i=n===document.body,a=document.documentElement,s=(window.pageXOffset||a.scrollLeft)-(a.clientLeft||0),l=(window.pageYOffset||a.scrollTop)-(a.clientTop||0),this.$Eb.style.left=o.X-(i?-s:r.left)+"px",this.$Eb.style.top=o.Y-(i?-l:r.top)+"px"},h.prototype.calculateDropDownLocation=function(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x={X:t.x,Y:t.y};switch(t.Offset(-x.X,-x.Y),e.Offset(-x.X,-x.Y),s=e.left,l=e.right,u=e.top,c=e.bottom,h=u,f=t.height-c,p=s,d=t.width-l,g=(a&S.Flip)===S.Flip,m=(i&S.Flip)===S.Flip,y=(a&S.Slide)===S.Slide,b=(i&S.Slide)===S.Slide,n){case T.Up:o.height>h&&g&&(n=T.Down);break;case T.Down:o.height>f&&g&&(n=T.Up);break;case T.Left:o.width>p&&m&&(n=T.Right);break;case T.Right:o.width>d&&m&&(n=T.Left)}switch(C=v=0,n){case T.Up:C=u-o.height;break;case T.Down:C=c;break;case T.Left:v=s-o.width;break;case T.Right:v=l}return n===T.Up||n===T.Down?r===A.Near?v=s:r===A.Center?v=s-(o.width-e.width)/2:r===A.Far&&(v=l-o.width):n!==T.Right&&n!==T.Left||(r===A.Near?C=u:r===A.Center?C=u-(o.height-e.height)/2:r===A.Far&&(C=c-o.height)),w=new M(v,C,o.width,o.height),b&&(w.width>t.width?w.x=0:(w.x=Math.max(w.x,0),w.x=Math.min(w.x,t.width-w.width))),y&&(w.height>t.height?w.y=0:(w.y=Math.max(w.y,0),w.y=Math.min(w.y,t.height-w.height))),w.Offset(x),w.Location},h.prototype.render=function(){this.XEb?(this.xC=this.sourceElement.style.position,this.sourceElement.style.position="absolute",this.YEb=this.sourceElement.style.display,this.sourceElement.style.display="",this.sourceElement.style.zIndex="10000",this.sourceElement.classList.add(r),this.$Eb=this.sourceElement):(this.ZEb=document.createElement("div"),this.ZEb.style.cssText="position:absolute; z-index:10000; box-shadow:rgba(0, 0, 0, 0.4) 2px 4px 5px; outline:none",this.ZEb.classList.add(r),this.ZEb.appendChild(this.sourceElement),this.$z.hostElement.appendChild(this.ZEb),this.$Eb=this.ZEb)},h.prototype.bindEvent=function(){var e=this;this.$z.closeAfterClickOutside&&(document.addEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach(function(t){document.addEventListener(t,e.globalMousedownEventHandler,!0)})),this.$z.closeAfterResize&&document.addEventListener("resize",this.windowResizeEventHandler)},e.PopupControl=h},"./dist/plugins/celltype/editor/slider.js":function(t,e,o){"use strict";var i,s,a,r,l,u,c,n,h,f,p,d,g,m,y,b=this&&this.__extends||(m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}m(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function v(t){var e,o,n=(o=(e=t||0).toExponential().match(/\d(?:\.(\d*))?e([+-]\d+)/),e.toFixed(Math.max(0,(o[1]||"").length-parseInt(o[2],10)))),r=0;return 0<=n.indexOf(".")&&(r=n.length-n.indexOf(".")-1),r}function C(t,e){var n=y.call(this,t)||this;return n.MFb=u,n.NFb=u,n.XFb=u,n.YFb=function(t){c.pauseEvent(t),0===t.button&&(document.addEventListener("mouseup",n.ZFb,!1),document.addEventListener("pointerup",n.ZFb,!1),document.addEventListener("MSPointerUp",n.ZFb,!1),document.addEventListener("mousemove",n._Fb,!1),document.addEventListener("pointermove",n._Fb,!1),document.addEventListener("MSPointerMove",n._Fb,!1),n._Fb(t))},n._Fb=function(t){c.pauseEvent(t);var e=n.aGb(t);n.bGb!==e&&(n.setValue(e),n.$Fb.onChange(e))},n.ZFb=function(t){n._Fb(t),document.removeEventListener("mousemove",n._Fb),document.removeEventListener("mouseup",n.ZFb),document.removeEventListener("pointermove",n._Fb),document.removeEventListener("pointerup",n.ZFb),document.removeEventListener("MSPointerMove",n._Fb),document.removeEventListener("MSPointerUp",n.ZFb);var e=n.aGb(t);n.bGb=e,n.$Fb.onAfterChange(n.$Fb.value),n.fire(i.BaseDropdown.Event_ValueChanged,{value:e,text:""+e,notCloseDropDown:!0}),c.pauseEvent(t)},n.cGb=function(t){c.pauseEvent(t);var e=t.target||t.srcElement;document.addEventListener("touchend",n.dGb,!1),e.classList.contains(n.$Fb.prefixCls+"-handle")?document.addEventListener("touchmove",n.eGb,!1):n.eGb(t)},n.eGb=function(t){var e,o;c.pauseEvent(t),e=t.targetTouches[0],o=n.aGb(e),n.bGb!==o&&(n.setValue(o),n.$Fb.onChange(o))},n.dGb=function(t){var e,o;document.removeEventListener("touchmove",n.eGb),document.removeEventListener("touchend",n.dGb),e=t.changedTouches[0],o=n.aGb(e),n.bGb=o,n.$Fb.onAfterChange(n.$Fb.value),n.fire(i.BaseDropdown.Event_ValueChanged,{value:o,text:""+o,notCloseDropDown:!0}),c.pauseEvent(t)},n.init(e),n}function w(t,e,o,n){this.xo=t,this.MFb=e,this.NFb=o,this.$z=n,this.Tyb=u,this.OFb=u,this.Tyb=new h(this.PFb(),this.xo),this.OFb=new d(this.QFb(),this.xo)}function x(t,e){this.xo=e,this.IFb={},this.IFb=c.extend(this.IFb,t)}function T(t,e){this.xo=e,this.CFb={},this.DFb=!1,this.EFb=u,this.CFb=c.extend(this.CFb,t),this.EFb=new f(this.xo,this.FFb())}function A(t,e){this.xo=t,this.AFb={},this.exb="",this.AFb=c.extend(this.AFb,e),this.exb='\n        <div class="'+this.AFb.prefixCls+"-tooltip "+this.AFb.prefixCls+'-tooltip-placement-top">\n            <div class="'+this.AFb.prefixCls+'-tooltip-content">\n                <div class="'+this.AFb.prefixCls+'-tooltip-arrow"></div>\n                <div class="'+this.AFb.prefixCls+'-tooltip-inner">{{value}}</div>\n            </div>\n        </div>\n        '}function S(t,e){this.xo=e,this.xFb={},this.xFb=c.extend(this.xFb,t)}function M(t,e){this.xo=e,this.vFb={},this.vFb=c.extend(this.vFb,t)}function I(){}Object.defineProperty(e,"__esModule",{value:!0}),i=o("./dist/plugins/celltype/editor/baseControl.js"),s=o("@grapecity/js-sheets-common"),a=o("Core"),r=s.Common.j.Fa,l=s.Common.u.Ob,u=null,I.isEmpty=function(t){return void 0===t||t===u||""===t||Array.isArray(t)&&0===t.length},I.isEmptyObject=function(t){var e,o=!0;for(e in t)if(e){o=!1;break}return o},I.pauseEvent=function(t){t.stopPropagation(),t.preventDefault()},I.isObject=function(t){var e=typeof t;return"function"==e||"object"==e&&!!t},I.allKeys=function(t){var e,o=[];if(!I.isObject(t))return[];for(e in t)t.hasOwnProperty(e)&&o.push(e);return o},I.parseStyleObject=function(t){var e,o,n,r,i,a;if(!I.isObject(t))return"";for(e="",n=0,r=(o=I.allKeys(t)).length;n<r;n++)a=t[i=o[n]],e+=i.replace(/([A-Z])/g,"-$1").toLowerCase()+": "+a+"; ";return e.trim()},I.extend=function(t,e,o){var n,r,i,a,s;for(void 0===o&&(o={}),n=I.allKeys(t),i=0,a=(r=I.allKeys(e)).length;i<a;i++)o[s=r[i]]=e[s];for(i=0,a=n.length;i<a;i++)void 0===o[s=n[i]]&&(o[s]=t[s]);return o},I.noop=function(){},I.measureWidth=function(t,e){var o=0,n=document.createElement("span");n.classList.add(e);try{n.innerText=t,n.style.display="none",document.body.appendChild(n),o=a.GC$(n).width()}finally{document.body.removeChild(n)}return o},c=I,M.prototype.render=function(){var t,e;return this.vFb.included?(t=this.wFb(),(e=this.xo.querySelector("."+this.vFb.className))===u&&((e=document.createElement("div")).classList.add(""+this.vFb.className),this.xo.appendChild(e)),void e.setAttribute("style",c.parseStyleObject(t))):u},M.prototype.setLength=function(t){this.vFb.length=t,this.render()},M.prototype.wFb=function(){return this.vFb.direction===a.LayoutDirection.vertical?{bottom:this.vFb.offset+"%",height:this.vFb.length+"%"}:{left:this.vFb.offset+"%",width:this.vFb.length+"%"}},n=M,S.prototype.render=function(){var t,e,o,n,r=this.xo.querySelector("."+this.xFb.className);if(r===u){for((r=document.createElement("div")).className=""+this.xFb.className,e=0,o=(t=this.yFb()).length;e<o;e++)n=this.zFb(t[e]),r.appendChild(n);this.xo.appendChild(r)}},S.prototype.zFb=function(t){var e=document.createElement("span"),o=this.xFb.max-this.xFb.min,n=Math.abs(t-this.xFb.min)/o*100+"%",r=this.xFb.direction===a.LayoutDirection.vertical?{bottom:n}:{left:n};return e.classList.add(this.xFb.prefixCls+"-dot"),e.setAttribute("style",c.parseStyleObject(r)),e.setAttribute("key",""+t),e},S.prototype.yFb=function(){var t,e,o=Object.keys(this.xFb.marks).map(function(t){return+t});if(o.sort(function(t,e){return t-e}),t=o,this.xFb.dots)for(e=this.xFb.min;e<=this.xFb.max;e+=this.xFb.step)-1===t.indexOf(e)&&t.push(e);return t},h=S,A.prototype.render=function(t,e){var o,n,r,i,a;this.AFb.offset=t,o=this.xo.querySelector("."+this.AFb.prefixCls+"-tooltip"),n=new s.Formatter.GeneralFormatter(this.AFb.formatString).format(e),c.isEmpty(o)&&(r=l(n),this.exb=this.exb.replace(/{{value}}/,r),(i=document.createElement("div")).innerHTML=this.exb,this.xo.appendChild(i.firstElementChild),o=this.xo.querySelector("."+this.AFb.prefixCls+"-tooltip")),o.querySelector("."+this.AFb.prefixCls+"-tooltip-inner").textContent=n,a=this.BFb(n),o.setAttribute("style",c.parseStyleObject(a)),this.AFb.tooltipVisible?this.show():this.hide()},A.prototype.show=function(){var t=this.xo.querySelector("."+this.AFb.prefixCls+"-tooltip");c.isEmpty(t)||(t.style.display="inline-block")},A.prototype.hide=function(){var t=this.xo.querySelector("."+this.AFb.prefixCls+"-tooltip");c.isEmpty(t)||(t.style.display="none")},A.prototype.BFb=function(t){var e=c.measureWidth(t,this.AFb.prefixCls+"-tooltip");return e=0===e?12:e/2+4,this.AFb.direction===a.LayoutDirection.vertical?{left:"-"+e+"px",bottom:"calc("+this.AFb.offset+"% + 10px)"}:{top:"-28px",left:"calc("+this.AFb.offset+"% - "+(e+4)+"px)"}},f=A,T.prototype.render=function(){var t,e=this,o=this.GFb(),n=this.BFb(),r=this.CFb.tabIndex||0;!this.CFb.disabled&&r!==u||(r=u),(t=this.xo.querySelector("."+this.CFb.className))===u&&((t=document.createElement("div")).className=o,this.xo.appendChild(t),t.setAttribute("role","slider"),t.setAttribute("aria-valuemin",""+this.CFb.min),t.setAttribute("aria-valuemax",""+this.CFb.max),t.setAttribute("aria-valuenow",""+this.CFb.value),t.setAttribute("aria-disabled",this.CFb.disabled+""),t.addEventListener("blur",function(){e.HFb(!1)}),t.addEventListener("mouseenter",function(){e.EFb.show()}),t.addEventListener("keydown",function(){e.HFb(!1)}),t.addEventListener("mousedown",function(){t.focus(),e.EFb.show()}),document.addEventListener("mouseup",function(){document.activeElement===t&&(e.HFb(!0),e.EFb.hide())})),t.tabIndex=r,t.setAttribute("style",c.parseStyleObject(n))},T.prototype.setOffset=function(t,e){this.CFb.offset=t,this.render(),this.EFb.render(t,e)},T.prototype.HFb=function(t){this.DFb=t},T.prototype.GFb=function(){return this.DFb?this.CFb.className+" "+this.CFb.prefixCls+"-handle-click-focused":""+this.CFb.className},T.prototype.BFb=function(){return this.CFb.direction===a.LayoutDirection.vertical?{bottom:this.CFb.offset+"%"}:{left:this.CFb.offset+"%"}},T.prototype.FFb=function(){return{prefixCls:"gc-slider",tooltipVisible:this.CFb.tooltipVisible,direction:this.CFb.direction,offset:this.CFb.offset,formatString:this.CFb.formatString}},p=T,x.prototype.render=function(){var t,e,o,n,r,i=this.xo.querySelector("."+this.IFb.className);if(i===u){for((i=document.createElement("div")).className=""+this.IFb.className,t=this.JFb(),this.LJb(t),e=0,o=t.length;e<o;e++)n=t[e],(r=this.KFb(n))!==u&&i.appendChild(r);this.xo.appendChild(i)}},x.prototype.LJb=function(t){var e,o,n,r;for(this.MJb=0,e=1,o=t.length;e<o;e++)(n=this.IFb.marks[t[0]])&&(r=c.measureWidth(n.label,this.IFb.className+"-text"),(!this.MJb||this.MJb<r)&&(this.MJb=r))},Object.defineProperty(x.prototype,"maxWidth",{get:function(){return this.MJb},enumerable:!0,configurable:!0}),x.prototype.JFb=function(){return c.allKeys(this.IFb.marks).sort(function(t,e){return t-e})},x.prototype.KFb=function(e){var t,o,n,r,i=this,a=this.IFb.marks[e],s=c.isObject(a)?a.label:a;return c.isEmptyObject(s)?u:(t=this.IFb.className+"-text",o=this.LFb(e),n=c.extend(o,a.style),(r=document.createElement("span")).classList.add(t),r.setAttribute("style",c.parseStyleObject(n)),r.setAttribute("key",""+e),r.addEventListener("mousedown",function(t){i.IFb.onClickLabel(t,e)}),r.innerHTML=l(s),r)},x.prototype.LFb=function(t){var e=this.IFb.max-this.IFb.min;return this.IFb.direction===a.LayoutDirection.vertical?{"margin-bottom":"-50%",bottom:(t-this.IFb.min)/e*100+"%"}:{left:(t-this.IFb.min)/e*100+"%",transform:"translateX(-50%)"}},d=x,w.prototype.render=function(){var t=document.createElement("div");t.className=this.$z.prefixCls+"-rail",this.xo.appendChild(t),this.MFb.render(),this.Tyb.render(),this.NFb.render(),this.OFb.render(),this.OFb.maxWidth&&this.$z.direction===a.LayoutDirection.vertical&&(this.xo.style.paddingRight=this.OFb.maxWidth+"px")},w.prototype.calcValueByPosition=function(t){var e=t-this.RFb();return this.trimAlignValue(this.SFb(e))},w.prototype.trimAlignValue=function(t){return c.isEmpty(t)?u:this.TFb(t)},w.prototype.calcOffset=function(){return Math.max(this.$z.value-this.$z.min,0)/(this.$z.max-this.$z.min)*100},w.prototype.getKeyboardValueMutator=function(t){var e=this;switch(t.keyCode){case 38:case 39:return function(t){return e.calculateNextValue("increase",t)};case 40:case 37:return function(t){return e.calculateNextValue("decrease",t)};case 35:return function(t){return e.$z.max};case 36:return function(t){return e.$z.min}}},w.prototype.calculateNextValue=function(t,e){var o={increase:function(t,e){return t+e},decrease:function(t,e){return t-e}},n=Object.keys(this.$z.marks).indexOf(e+""),r=o[t](n,1),i=Object.keys(this.$z.marks)[r];return this.$z.step?o[t](e,this.$z.step):!c.isEmptyObject(this.$z.marks)&&this.$z.marks[i]?this.$z.marks[i]:e},w.prototype.TFb=function(t){var e=isFinite(this.UFb(t))?this.UFb(t):0;return this.$z.step===u?e:parseFloat(e.toFixed(this.Yrb()))},w.prototype.Yrb=function(){var t,e;if(r(this.$z.precision)){for(e in t=Math.max(v(this.$z.max),v(this.$z.min),v(this.$z.step)),this.$z.marks)t=Math.max(v(parseFloat(e)),t);this.$z.precision=t}return this.$z.precision},w.prototype.UFb=function(e){var t,o,n,r,i=Object.keys(this.$z.marks).map(parseFloat);return this.$z.step!==u&&(t=Math.ceil((this.$z.max-this.$z.min)/this.$z.step),o=Math.min((e-this.$z.min)/this.$z.step,t),n=Math.round(o)*this.$z.step+this.$z.min,i.push(Math.min(n,this.$z.max))),r=i.map(function(t){return Math.abs(e-t)}),i[r.indexOf(Math.min.apply(Math,r))]},w.prototype.PFb=function(){return{prefixCls:this.$z.prefixCls,className:this.$z.prefixCls+"-step",direction:this.$z.direction,marks:this.$z.marks,dots:this.$z.dots,step:this.$z.step,included:this.$z.included,max:this.$z.max,min:this.$z.min}},w.prototype.QFb=function(){var o=this;return{className:this.$z.prefixCls+"-mark",onClickLabel:this.$z.disabled?c.noop:function(t,e){o.VFb(t,e)},direction:this.$z.direction,marks:this.$z.marks,included:this.$z.included,max:this.$z.max,min:this.$z.min}},w.prototype.VFb=function(t,e){},w.prototype.RFb=function(){var t=this.xo.getBoundingClientRect();return this.$z.direction===a.LayoutDirection.vertical?t.top:t.left},w.prototype.WFb=function(){var t=this.xo.getBoundingClientRect();return this.$z.direction===a.LayoutDirection.vertical?t.height:t.width},w.prototype.SFb=function(t){var e=this.$z.min,o=this.$z.max,n=Math.abs(Math.max(t,0)/this.WFb());return this.$z.direction===a.LayoutDirection.vertical&&(n=Math.max(1-n,0)),n*(o-e)+e},g=w,y=i.BaseDropdown,b(C,y),C.prototype.setValue=function(t){if(!this.$Fb.disabled){var e=parseFloat(t);e=isNaN(e)?this.$Fb.min:(e=Math.max(this.$Fb.min,e),Math.min(this.$Fb.max,e)),this.$Fb.value=e,this.bGb=this.$Fb.value,this.MFb.setLength(this.calcOffset()),this.NFb.setOffset(this.calcOffset(),e)}},C.prototype.calcOffset=function(){var t=Math.max(this.$Fb.value-this.$Fb.min,0)/(this.$Fb.max-this.$Fb.min);return 100*(t=Math.min(t,1))},C.prototype.setOptions=function(t){this.init(t)},C.prototype.init=function(t){var e,o;this.fGb(t),this.gGb(),this._host.innerHTML="",(e=document.createElement("div")).className="gc-slider-container",this._host.appendChild(e),this.$Fb.direction===a.LayoutDirection.vertical?(e.classList.add(this.$Fb.prefixCls+"-vertical"),e.style.height=this.$Fb.height+"px"):e.style.width=this.$Fb.width+"px",(o=document.createElement("div")).className=this.GFb(),e.appendChild(o),this.MFb=new n(this.hGb(),o),this.NFb=new p(this.iGb(),o),this.XFb=new g(o,this.MFb,this.NFb,this.jGb()),this.XFb.render(),this.QQ(o)},C.prototype.QQ=function(t){var r=this;this.$Fb.disabled||(t.addEventListener("mousedown",this.YFb),t.addEventListener("pointerdown",this.YFb),t.addEventListener("MSPointerDown",this.YFb),t.addEventListener("touchstart",this.cGb),t.addEventListener("keyup",function(t){var e,o,n;if(c.pauseEvent(t),e=r.XFb.getKeyboardValueMutator(t),!c.isEmpty(e)){if(o=e(r.$Fb.value),(n=r.XFb.trimAlignValue(o))===r.$Fb.value)return;r.setValue(n),r.$Fb.onChange(n),r.$Fb.onAfterChange(n),r.fire(i.BaseDropdown.Event_ValueChanged,{value:n,text:""+n,notCloseDropDown:!0})}}))},C.prototype.aGb=function(t){return this.$Fb.direction===a.LayoutDirection.vertical?this.XFb.calcValueByPosition(t.clientY):this.XFb.calcValueByPosition(t.clientX)},C.prototype.sYa=function(){function t(t){}return{prefixCls:"gc-slider",dots:!1,range:!1,disabled:!1,max:100,min:0,step:1,value:0,direction:a.LayoutDirection.horizontal,included:!0,width:350,height:350,marks:{},tooltipVisible:!1,onChange:t,onAfterChange:t,formatString:"General"}},C.prototype.gGb=function(){(c.isEmpty(this.$Fb)||c.isEmptyObject(this.$Fb))&&(this.$Fb={}),this.$Fb=c.extend(this.sYa(),this.$Fb)},C.prototype.fGb=function(t){var n=this;t&&(r(t.scaleVisible)||(this.$Fb.dots=t.scaleVisible),r(t.direction)||(this.$Fb.direction=t.direction),r(t.formatString)||(this.$Fb.formatString=t.formatString),this.kGb(t.min,"min"),this.kGb(t.max,"max"),this.kGb(t.step,"step"),this.kGb(t.width,"width"),this.kGb(t.height,"height"),this.$Fb.step<=0&&(this.$Fb.step=1),this.$Fb.min>this.$Fb.max&&(this.$Fb.max=this.$Fb.min),r(t.tooltipVisible)||(this.$Fb.tooltipVisible=t.tooltipVisible),this.$Fb.marks={},t.marks&&t.marks.forEach(function(t){var e,o=parseFloat(t);isNaN(o)||o>=n.$Fb.min&&o<=n.$Fb.max&&(e=new s.Formatter.GeneralFormatter(n.$Fb.formatString),n.$Fb.marks[o]={label:e.format(o)})}))},C.prototype.kGb=function(t,e){if(!r(t)){var o=parseFloat(t);isNaN(o)||(this.$Fb[e]=o)}},C.prototype.hGb=function(){return{className:this.$Fb.prefixCls+"-track",included:this.$Fb.included,direction:this.$Fb.direction,offset:0,length:0}},C.prototype.iGb=function(){return{prefixCls:this.$Fb.prefixCls,className:this.$Fb.prefixCls+"-handle",direction:this.$Fb.direction,disabled:this.$Fb.disabled,min:this.$Fb.min,max:this.$Fb.max,value:this.$Fb.value,offset:0,tabIndex:0,tooltipVisible:this.$Fb.tooltipVisible,formatString:this.$Fb.formatString}},C.prototype.jGb=function(){return{prefixCls:this.$Fb.prefixCls,min:this.$Fb.min,max:this.$Fb.max,value:this.$Fb.value,disabled:this.$Fb.disabled,direction:this.$Fb.direction,dots:this.$Fb.dots,step:this.$Fb.step,included:this.$Fb.included,marks:this.$Fb.marks}},C.prototype.GFb=function(){var t=""+this.$Fb.prefixCls;return this.$Fb.direction===a.LayoutDirection.vertical&&(t+="  "+this.$Fb.prefixCls+"-vertical"),c.isEmptyObject(this.$Fb.marks)||(t+=" "+this.$Fb.prefixCls+"-with-marks"),this.$Fb.disabled&&(t+=" "+this.$Fb.prefixCls+"-disabled"),t},e.Slider=C},"./dist/plugins/celltype/editor/timepicker.js":function(t,e,o){"use strict";var n,l,r,u,i,a,s,c=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function h(t,e){var o=s.call(this,t)||this;return o.ad(),o.setOptions(e),o}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/celltype/editor/listControl.js"),l=o("./dist/plugins/celltype/editor/baseControl.js"),r="undefined",u=o("@grapecity/js-sheets-common"),i=u.Common.j.Fa,s=l.BaseDropdown,c(h,s),h.prototype.setOptions=function(t){var e,o,n,r;return t&&(null!==(e=this.pGb(t.min))&&(this.$z.min=e),null!==(o=this.pGb(t.max))&&(this.$z.max=o),null!==(n=this.pGb(t.step))&&(this.$z.step=n),i(t.formatString)||(this.$z.formatString=t.formatString),i(t.height)||(r=parseInt(t.height,10),isNaN(r)||(this.$z.height=r)),this.$z.height=Math.max(1,this.$z.height)),void this.VF()},h.prototype.setValue=function(t){void 0!==t&&(this.KEb={hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()},this.cHb=t,this.wEb(),this.scrollToSelect())},h.prototype.scrollToSelect=function(){var t,e=this.tEb.querySelector(".selected");null!==e&&(t=e.offsetTop,this.xo.scrollTop=t)},h.prototype.ad=function(){var e=this;this.$z={min:{},max:{hour:23,minute:59,second:59},step:{hour:1},formatString:"hh:mm",height:200},this.tEb=document.createElement("div"),this.tEb.classList.add("gc-time-picker-outer-div"),this.tEb.addEventListener("click",function(t){e.uEb(t)}),this._host.appendChild(this.tEb)},h.prototype.pGb=function(t){var e,o,n,r=null;return i(t)||(r={},i(t.hour)||(e=parseInt(t.hour,10),isNaN(e)||(r.hour=e)),i(t.minute)||(o=parseInt(t.minute,10),isNaN(o)||(r.minute=o)),i(t.second)||(n=parseInt(t.second,10),isNaN(n)||(r.second=n))),r},h.prototype.VF=function(){this.tEb.innerHTML="",new n.List(this.tEb,this.qGb()),this.wEb()},h.prototype.wEb=function(){var t,e,o,n,r=this.tEb.querySelectorAll(".gc-time-picker-li");if(0<r.length)for(t=0;t<r.length;t++)r[t].classList.remove("selected"),e=+r[t].getAttribute("hour"),o=+r[t].getAttribute("minute"),n=+r[t].getAttribute("second"),this.rGb(this.KEb,{hour:e,minute:o,second:n})&&r[t].classList.add("selected")},h.prototype.qGb=function(){var r=this;return{items:function(){var t,e,o=r.sGb(),n=document.createElement("div");for(n.classList.add("gc-time-picker-container"),r.xo=n,r.$z.height<0?n.style.height="auto":n.style.maxHeight=r.$z.height+"px",(t=document.createElement("ul")).classList.add("gc-time-picker-ul"),e=0;e<o.length;e++)t.appendChild(r.tGb(o[e]));return 24*o.length>r.$z.height&&0<=r.$z.height?n.style.overflowY="scroll":n.style.overflowY="hidden",n.appendChild(t),n}}},h.prototype.tGb=function(t){var e=document.createElement("li");return e.classList.add("gc-time-picker-li"),e.setAttribute("hour",""+t.hour),e.setAttribute("minute",""+t.minute),e.setAttribute("second",""+t.second),e.innerText=this.uGb(t),e},h.prototype.sGb=function(){for(var t=this.vGb(this.$z.min),e=this.vGb(this.$z.max),o=[];t<=e;)o.push({hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()}),t=this.wGb(t,this.$z.step);return o},h.prototype.wGb=function(t,e){return typeof e.hour!=r&&t.setHours(t.getHours()+e.hour),typeof e.minute!=r&&t.setMinutes(t.getMinutes()+e.minute),typeof e.second!=r&&t.setSeconds(t.getSeconds()+e.second),t},h.prototype.uGb=function(t){var e,o=new Date;return o.setHours(t.hour),o.setMinutes(t.minute),o.setSeconds(t.second),(e=new u.Formatter.GeneralFormatter(this.$z.formatString).format(o))&&""!==e&&null!==e?e:this.xGb(o)},h.prototype.xGb=function(t){var e=t.getHours(),o=t.getMinutes();return(e<12?"AM":"PM")+" "+(0===e||12===e?"12":""+e%12)+":"+(o<10?"0"+o:""+o)},h.prototype.vGb=function(t){var e=new Date;return e.setHours(t.hour||0),e.setMinutes(t.minute||0),e.setSeconds(t.second||0),e},h.prototype.rGb=function(t,e){return!(!t||!e)&&(t=this.yGb(t),e=this.yGb(e),t.hour===e.hour&&t.minute===e.minute&&t.second===e.second)},h.prototype.yGb=function(t){return{hour:t.hour||0,minute:t.minute||0,second:t.second||0}},h.prototype.uEb=function(t){var e,o,n,r,i,a,s=t.target;s&&(e=+s.getAttribute("hour"),o=+s.getAttribute("minute"),n=+s.getAttribute("second"),(r=this.cHb||new Date).setHours(e),r.setMinutes(o),r.setSeconds(n),r.setMilliseconds(0),i=(new u.Common.CultureInfo).DateTimeFormat,a=new u.Formatter.GeneralFormatter(i.defaultDatePattern).format(r),this.fire(l.BaseDropdown.Event_ValueChanged,{value:r,text:a}),this.KEb={hour:e,minute:o,second:n},this.wEb())},e.TimePicker=h},"./dist/plugins/celltype/editor/workflowPicker.js":function(t,e,o){"use strict";var n,r,i,s,a,l,u=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function c(t,e){var o=l.call(this,t)||this;return o.FP=new r.List(t),o.FP.on(n.BaseDropdown.Event_ValueChanged,function(t){o.fire(n.BaseDropdown.Event_ValueChanged,t)}),o.setOptions(e),o}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/celltype/editor/baseControl.js"),r=o("./dist/plugins/celltype/editor/listControl.js"),i=o("@grapecity/js-sheets-common"),s=i.Common.j.Fa,l=n.BaseDropdown,u(c,l),c.prototype.setOptions=function(t){this.$z=t},c.prototype.setValue=function(t){if(this.$z){var e=function(t,e){var o,n,r={items:[]},i=t.items,a=i.filter(function(t){return t.value===e})[0];if(s(a)&&i&&0<i.length)r.items.push({text:i[0].value,value:i[0].value});else if(a&&a.transitions&&0<a.transitions.length)for(o=function(t){var e,o=a.transitions[t];"number"==typeof o&&i[o]&&(o=i[o].value),(e=i.filter(function(t){return t.value===o})[0])&&r.items.push({text:e.value,value:e.value})},n=0;n<a.transitions.length;n++)o(n);return r}(this.$z,t);this.FP.setOptions(e)}},c.prototype.updateStyle=function(t,e,o){this.FP.updateStyle(t,e,o)},e.WorkFlow=c},"./dist/plugins/celltype/hyperlinkcelltype.js":function(t,e,o){"use strict";var n,A,r,w,i,a,S,s,l,M,I,u,c,N,v,R,h,k,f,p,d,g,m,y,b=this&&this.__extends||(g=function(t,e){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}g(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function C(){var o,t=m.call(this)||this;return t.typeName="8",(o=t)._id=t.wK(),c(p,function(t,e){o["_"+t]=e}),t._onAction=function(t){var e=t&&t.sheet,o=t.row,n=t.col,r=t.sheetArea,i=e.getValue(o,n,r),a=["_blank","_self","_parent","_top"][this._target];i&&h(s(i),a)},t}function E(t,e,o,n,r,i){var a=0,s=0,l=t.width,u=t.height;return a=i=i||0,1===n?a=(l-e)/2:2===n&&(a=l-e-i),1===r?s=(u-o)/2:2===r&&(s=u-o),{x:a,y:s}}function x(t,e,o,n){var r=D(t,o),i=r.width;return i+=1==(1!==e&&!S(n))?n:0,r.width=i,r}function T(t,e,o,n,r,i){var a=D(t,n),s=E(r,a.width,a.height,e,o,i);return a.x=s.x,a.y=s.y,a}function D(t,e){var o=l(e);return{x:0,y:0,width:Math.max(0,A.Vn.Xn(t,e,!0)),height:t.split(/\r\n|\r|\n/).length*o}}function j(t){return 8*(t.textIndent||0)}function _(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C=n&&n.sheet;if(C){if(s=C._render,l=e.font||s.Bl(),1<o&&(l=s.Cl(l)),u=j(e),e.wordWrap||r){if(e.wordWrap){if(c=n.row,h=n.col,f=n.sheetArea,p=0,d=C._modelManager.findSpan(c,h,f)){if(d.row>=c&&d.rowCount<=1&&d.col>=h&&h===d.col&&(p=C.Tl(h),1<d.colCount))for(g=h+1;g<h+d.colCount;g++)p+=C.Tl(g)}else p=C.Tl(h);if(i=w(e,1),0<(a=w(e,3))&&(p-=a),0<i&&(p-=i),m=A.Vn.Wn(t,p-3-u,l),r&&1<t.split(/\r\n|\r|\n/).length){for(b=y=0;b<m.length;b++)y=Math.max(y,x(m[b],e.hAlign,l,j(e)).width);return y}r||(t=m.join("\r\n"))}}else t=t.replace(/\s+/g," ");return v=x(t,e.hAlign,l,j(e)),r?v.width:v.height}return 0}Object.defineProperty(e,"__esModule",{value:!0}),n=o("@grapecity/js-sheets-common"),r=(A=o("Core")).CellTypes.Context,w=r.u5,i=A.CellTypes.Base,a=A.Ul.Nl,S=n.Common.j.Fa,s=n.Common.u.BIc,l=A.Ul.fp,M=A.Ul.Ml,I=M.mozilla,u=A.GC$,c=u.each,N=Math.max,v=Math.min,R=Math.floor,h=window.open,k="hyperlinkInfo",(y=f=e.HyperLinkTargetType||(e.HyperLinkTargetType={}))[y.blank=0]="blank",y[y.self=1]="self",y[y.parent=2]="parent",y[y.top=3]="top",p={linkColor:"#0066cc",visitedLinkColor:"#3399ff",text:"",linkToolTip:"",target:0,activeOnClick:!0},b(C,m=i),C.prototype.wK=function(){var t,e;return S(this._id)&&(this._id="0"),e="id_"+(t=parseInt(this._id,10)),t++,this._id=t+"",e},C.prototype.Eka=function(t,e,o,n,r,i,a,s,l,u){var c,h,f,p,d,g,m,y,b,v=1,C="left",w=a.hAlign,x=a.vAlign,T=s.lineHeight,A=l.length;for(v+=e,1===w?(v=r/2,C="center"):2===w&&(v=r-1,v-=e,C="right"),t.textAlign!==C&&(t.textAlign=C),c=1,h="alphabetic",c+=T-(d=T/2-(f=parseInt(s.fontInfo.fontSize,10))/2+(p=8<f?R((f-8)/5+2):1)-1),1===x?T<i&&(c=I?(i-u)/2+1:M.msie?(i-u)/2+.5:(i-u)/2,R(c)!==c&&(c+=.5),c+=T/2-d):2===x&&(c=i-u-2.5-d),t.textBaseline!==h&&(t.textBaseline=h),g=n+c,m=0;m<A;m++)t.fillText(l[m],o+v,g),y=t.measureText(l[m]).width,(b=a.textDecoration)&&this.ip(t,b,o+v,g,y,f,p),g+=T},C.prototype.Fka=function(t,e,o,n,r,i,a,s,l){var u,c,h,f,p,d,g,m=a.hAlign,y=a.vAlign,b=s.lineHeight,v=l.length,C=0,w=0,x=0,T=0;for(2!==m&&(x=1),2===a.vAlign&&(T=-2.5),T-=N(0,Math.round(b/9)-1),t.strokeStyle!==t.fillStyle&&(t.strokeStyle=t.fillStyle),p=s.fontInfo.fontSize,d=R((p-12)/21+1),t.lineWidth=d,t.beginPath(),g=0;g<v;g++)u=t.measureText(l[g]).width,h=(c=x+o+(f=E(new A.Rect(o,n,r,i),u,b*v,m,y,e)).x)+u,C=T+n+f.y+b,R(C)===C&&(C+=.5),w=C,t.moveTo(c,C),t.lineTo(h,w),t.stroke(),T+=b},C.prototype.paintValue=function(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T;if(t&&(l=this.getText(e,s),!S(l))){for(u=(l+="").split(/\r\n|\r|\n/),c=0;c<u.length;)u[c]=u[c].replace(/\s+/g," "),c++;l=u.join("\r\n"),h=!1,f=s.sheet._modelManager,p=s.row,d=s.col,g=s.sheetArea,(m=f.getValueForKey(p,d,k,g))&&(this._id===m.id?h=m.visited:f.do("setValueForKey",p,d,k,void 0,g)),t.save(),t.beginPath(),(y=h?this._visitedLinkColor:this._linkColor)&&t.fillStyle!==y&&(t.fillStyle=y),(b=a.font)&&t.font!==b&&A.Ul.lZa(t,b),v=j(a),s.sheet.outlineColumn&&s.sheet.outlineColumn.XQa(s.col)&&(v=0),C=[],x=w=0,a.wordWrap?(T=r-3-v,--T,1<(w=(C=A.Vn.Wn(l,T,b)).length)&&0!==a.vAlign&&(x=(w-1)*s.lineHeight)):C.push(l),t.rect(o,n,r,i),t.clip(),t.beginPath(),this.Eka(t,v,o,n,r,i,a,s,C,x),this.Fka(t,v,o,n,r,i,a,s,C),t.restore()}},C.prototype.getText=function(t,e){return this._text||t},C.prototype.tw=function(t,e,o,n){if(!t.HF){var r=t.parent;r&&r.tw(t,e,o,n)}},C.prototype.getHitInfo=function(t,e,o,n,r){var i;return r&&(i=r.sheetArea,(S(i)||3===i)&&o&&n)?{x:t,y:e,row:r.row,col:r.col,cellStyle:o,cellRect:n,sheetArea:i,isFocusAware:!0,sheet:r.sheet,isReservedLocation:function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y=r.sheet,b=y._render;if(S(o))return!1;if(i||(a=y.getValue(r.row,r.col,r.sheetArea),S(a)||(i=a+"")),!i)return!1;for(n=o.cellType.f5(n,o,y.zoom()),i=i.replace(/\s+/g," "),s=o&&o.font?o.font:b.Bl(),s=b.Cl(s),l=[i],u=j(o),o.wordWrap&&(l=A.Vn.Wn(i,n.width-3-u,s),i=l.join("\r\n")),c=T(i,o.hAlign,o.vAlign,s,n,u),h=n.y+c.y,f=0;f<l.length;f++)if(p=T(l[f],o.hAlign,o.vAlign,s,n,u),d=n.x+p.x,g=v(d+p.width,n.x+n.width),h=v((m=h)+p.height,n.y+n.height),d<=t&&t<g&&m<=e&&e<h)return!0;return!1}(t,e,o,n,r,this._text)}:null},C.prototype.processMouseDown=function(t){var e=t&&t.sheet;e&&!e.isEditing()&&t.isReservedLocation&&(this.AK=!0)},C.prototype.processMouseUp=function(t){var e=t&&t.sheet;e&&!e.isEditing()&&(t.isReservedLocation&&this.AK&&this.Eia(t),this.AK=!1)},C.prototype.processMouseMove=function(t){var e,o=t.row,n=t.col,r=t.sheet;!r||r.isEditing()&&r.getActiveRowIndex()===o&&r.getActiveColumnIndex()===n||(e=r.Ws(),t.isReservedLocation?e&&(this.BK(r,t),e.style.cursor="pointer"):(this.CK(r),e&&(e.style.cursor="default")))},C.prototype.processMouseLeave=function(t){var e,o=t.sheet;this.AK=!1,this.CK(o),!o||(e=o.Ws())&&(e.style.cursor="default")},C.prototype.BK=function(t,e){var o,n,r,i,a,s;this._linkToolTip&&(o=this.DK(),(n=u(o)).text(this._linkToolTip),i=(r=t._eventHandler.bG()).left+e.x,a=r.top+e.y+20,0===n.parent().length&&((s=t&&t.zo())&&s.insertBefore(o,null),n.css("top",a).css("left",i)))},C.prototype.CK=function(t){var e,o,n;this.EK&&((e=t&&t.zo())&&this.EK.parentElement===e&&(o=e,n=this.EK,o.removeChild(n)),this.EK=null)},C.prototype.DK=function(){var t;return this.EK||(t=a("div"),u(t).css("position","absolute").css("margin",0).css("padding",2).css("border","1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css("box-sizing","content-box").css("background-color","white").css("font","9pt Arial"),this.EK=t),this.EK},C.prototype.isReservedKey=function(t,e){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},C.prototype.processKeyUp=function(t,e){return!!e.sheet&&(this.Eia(e),!0)},C.prototype.getAutoFitWidth=function(t,e,o,n,r){return _(this._text||t,o,n,r,!0)},C.prototype.getAutoFitHeight=function(t,e,o,n,r){return _(this._text||t,o,n,r)},C.prototype.isImeAware=function(t){return!1},C.prototype.Eia=function(t){var e=t&&t.sheet,o=t.row,n=t.col,r=t.sheetArea;this.onClickAction().call(this,t),e._modelManager.do("setValueForKey",o,n,k,{id:this._id,visited:!0},r),e.repaint(e.getCellRect(o,n)),this.tw(e,o,n,r)},C.prototype.onClickAction=function(t){return 0===arguments.length?this._onAction:(t&&(this._onAction=t),this)},C.prototype.lJc=function(t){var e={linkColor:t.linkColor,visitedLinkColor:t.visitedLinkColor,text:t.text,linkToolTip:t.linkToolTip,target:t.target&&f[t.target],activeOnClick:t.activeOnClick};this.fromJSON(e)},C.prototype.toJSON=function(){var o,n=this,r={typeName:n.typeName};return c(p,function(t,e){(o=n["_"+t])!==e&&(r[t]=o)}),r},C.prototype.fromJSON=function(o){var n=this;c(p,function(t){var e=o[t];S(e)||(n["_"+t]=e)})},C.prototype._createCellTypeElement=function(t){},C.prototype.gQa=function(){var o,n=this,r=new C;return c(p,function(t,e){(o=n["_"+t])!==e&&(r["_"+t]=o)}),r._onAction=n._onAction,r},d=C,e.HyperLink=d,c(p,function(e){d.prototype[e]=function(t){return 0===arguments.length?this["_"+e]:(this["_"+e]=t,this)}}),A.CellTypes._o[8]=d},"./dist/plugins/celltype/radiochecklistcelltype.js":function(t,e,o){"use strict";var z,n,i,r,W,G,s,d,m,h,y,U,a,l,u,J,Z,x,f,p,q,K,Y,c,g,b,v,C,w,T,A,S,M,I,N,R,k,E,D=this&&this.__extends||(A=function(t,e){return(A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}A(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function Q(t,e){return t.hasOwnProperty(e)}function j(t,e){return t instanceof Date&&e instanceof Date?r(t)===r(e):!y(t)&&!y(e)&&t.toString&&e.toString?""+t==""+e:t===e}function _(){var o,t=S.call(this)||this;return t.typeName="13",t.defaultPadding=0,o=t,u(w,function(t,e){"items"===t&&(e=[]),o["_"+t]=e}),o._boxSize=0,delete o.boxSize,t}function O(){var t=null!==I&&I.apply(this,arguments)||this;return t.typeName="12",t}function F(){return null!==N&&N.apply(this,arguments)||this}function P(){var o,t=R.call(this)||this;return t.typeName="11",t.defaultPadding=5,o=t,u(c,function(t,e){"items"===t&&(e=[]),o["_"+t]=e}),t}function X(t,e,o,n){var r=e.zoom(),i=et(t._boxSize,o.font,r),a=ot(t,o),s=G(a,i),l=n;return t._items.length<n&&(l=t._items.length),s*l+t._itemSpacing.vertical*r*(l-1)}function $(t,e,o,n,r){var i=e.zoom(),a=et(t._boxSize,o.font,i),s=t.defaultPadding*i,l=tt(t,e,o,n,r),u=0;return l.forEach(function(t){u+=t}),u+=r*(a+s)+(r-1)*t._itemSpacing.horizontal*i}function tt(t,e,o,n,r){var i,a,s,l,u,c=[];for(i=0;i<t._items.length;i++)a=Q(t._items[i],Z)?t._items[i].text:t._items[i],s=e.dp(a,o.font),(l=t.dHb()).hasMagin&&(s=s+l.paddingLeft+l.paddingRight),u=W(i%r),t._direction===K.vertical&&(u=W(i/n)),c[u]===h?c[u]=s:c[u]=Math.max(c[u],s);return c}function et(t,e,o){var n=q*o;return"number"==typeof t&&0<=t?n=t*o:"auto"===t&&(n=J(e)/2),n}function ot(t,e){var o=J(e.font),n=t.dHb();return n.hasMagin&&(o=o+n.paddingTop+n.paddingBottom),o}function nt(t,e,o,n){var r=L(t)*o,i=r;return 1===t.hAlign?i=(e.width-n)/2:2===t.hAlign&&(i=e.width-r-n),i}function rt(t,e,o,n){var r=2*o,i=r;return 1===t.vAlign?e.height-r>n&&(i=(e.height-n-r)/2+r):2===t.vAlign&&(i=e.height-n-r),i}function it(t,e,o,n,r){var i,a;if(t._direction===K.vertical){if(t._isFlowLayout){if(r!==h)for(i=t._items.length;0<i;){if(!(r<X(t,e,o,i,s(t._items.length/i))))return[i=G(i,1),s(t._items.length/i)];--i}return[t._items.length,1]}return[i=G(1,t._maxRowCount),s(t._items.length/i)]}if(t._isFlowLayout){if(n!==h)for(a=t._items.length;0<a;){if(!(n<$(t,e,o,s(t._items.length/a),a)))return a=G(a,1),[s(t._items.length/a),a];--a}return[1,t._items.length]}return a=G(1,t._maxColumnCount),[s(t._items.length/a),a]}function L(t){var e=t.textIndent;return 1===t.hAlign||0===e||e===m||e===h?2:8*e}function H(t,e){var o,n=!1,r=Q(t,x)?t.value:t;if(e!==m)if(Array.isArray(e)){for(o=0;o<e.length;o++)if(j(e[o],r)){n=!0;break}}else n=j(e,r);return n}function B(t,e,o,n){var r,i,a,s;if(n)return e;for(t===m&&(t=[]),Array.isArray(t)||(t=[t]),r={},o.forEach(function(t){r[Q(t,x)?t.value:t]=!0}),i=t.length-1;0<=i;i--)r[t[i]]||t.splice(i,1);if(-1===(a=t.slice()).indexOf(e))a.push(e);else for(i=a.length-1;0<=i;i--)j(a[i],e)&&a.splice(i,1);return s=[],o.forEach(function(t){-1!==a.indexOf(t.value)&&s.push(t.value)}),s}Object.defineProperty(e,"__esModule",{value:!0}),z=o("Core"),n=o("@grapecity/js-sheets-common"),i=n.Common.j.C4,r=n.Common.l.Ra,W=Math.floor,G=Math.max,s=Math.ceil,d="alphabetic",m=null,h=void 0,y=n.Common.j.Fa,U=z.Ul.lZa,a=z.CellTypes.Base,l=z.GC$,u=l.each,J=z.Ul.fp,Z="text",x="value",f="string",p="number",q=12,(E=K=e.Direction||(e.Direction={}))[E.horizontal=0]="horizontal",E[E.vertical=1]="vertical",(k=Y=e.TextAlign||(e.TextAlign={}))[k.left=2]="left",k[k.right=3]="right",c={items:m,direction:K.horizontal,maxColumnCount:1,maxRowCount:1,isFlowLayout:!0,itemSpacing:{horizontal:20,vertical:5},textAlign:Y.right,boxSize:q},D(P,R=a),P.prototype.paintValue=function(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V=this;if(t){for(t.save(),t.rect(o+1,n+1,r-2,i-2),t.clip(),t.beginPath(),l=0,c=(u=s.sheet).zoom(),h=a.font,f=s.isPrinting,p=s.printZoomFactor,f&&"number"==typeof p&&1!==p&&(c=p),d=et(V._boxSize,h,c),g=V.defaultPadding*c,m=d/2,y=new z.Rect(o+1,n+1,r-2,i-2),w=$(V,u,a,v=(b=it(V,u,a,r-2,i-2))[0],C=b[1]),x=X(V,u,a,v),T=tt(V,u,a,v,C),A=ot(V,a),S=o+nt(a,y,c,w),M=n+rt(a,y,c,x),(I=a.font)&&t.font!==I&&U(t,s.fontInfo.font),a.foreColor&&(t.fillStyle=a.foreColor),N=a.textDecoration,k=8<(R=s.fontInfo.fontSize)?W((R-8)/5+2):1,E=J(a.font)/2-R/2+k-1,D=S,j=M,O=_=0,d<R&&(_=V.hMc(d),O=(A-E-q)/2+1),F=0;F<V._items.length;F++)o+r<S||n+i<M||(P=Q(V._items[F],Z)?V._items[F].text:V._items[F],l=u.dp(P,a.font),t.textAlign="left",L=V._direction===K.vertical?T[W(F/v)]:T[F%C],H=0,H=V._textAlign===Y.left?(V.zGb(t,V._items[F],e,l,S,M+_,L,A,E),S=S+L+g,t.save(),V.AGb(t,e,V._items[F],S,M+O,m),t.restore(),d):(t.save(),V.AGb(t,e,V._items[F],S,M+O,m),S=S+d+g,t.restore(),V.zGb(t,V._items[F],e,l,S,M+_,L,A,E),L),N&&(B=this.dHb(),V.ip(t,N,S-(V._textAlign===Y.right?0:L+g)+B.paddingLeft,M+A-E-B.paddingBottom,l,R,k)),V._direction===K.vertical?(M+=G(A,d)+V._itemSpacing.vertical*c,(F+1)%v==0&&(D=D+L+d+g+V._itemSpacing.horizontal*c,M=n+rt(a,y,c,x)),S=D):(S=S+H+V._itemSpacing.horizontal*c,(F+1)%C==0&&(S=o+nt(a,y,c,w),j=j+G(A,d)+V._itemSpacing.vertical*c),M=j));t.restore()}},P.prototype.hMc=function(t){return(t-q)/2},P.prototype.getText=function(t,e){return t},P.prototype.zGb=function(t,e,o,n,r,i,a,s,l){var u=Q(e,Z)?e.text:e;t.textBaseline!==d&&(t.textBaseline=d),t.fillText(u,r,i+s-l)},P.prototype.getItemsBound=function(l,t,e,o){var n,r,u,i,a,s,c,h,f,p,d,g,m,y,b,v,C,w,x,T=this,A=l.zoom(),S=l.getActualStyle(t,e,o),M=z.To.No("11pt "+l.currentTheme().bodyFont(),A);for(S.font&&(M=z.To.No(S.font,A)),S.font=M.font,n=1===o?-1:void 0,r=2===o?-1:void 0,i=(u=l.getCellRect(t,e,n,r)).width,a=u.height,s=it(T,l,S,i-1,a),c=s[0],h=s[1],f=tt(T,l,S,c,h),p=et(T._boxSize,M.font,A),d=T.defaultPadding*A,g=G(ot(T,S),p),m=$(T,l,S,c,h),y=X(T,l,S,c),b=nt(S,u,A,m),v=rt(S,u,A,y),C=[],w=function(t){var e,o,n,r=Q(T._items[t],Z)?T._items[t].text:T._items[t],i=l.dp(r,S.font),a=W(t/h),s=t%h;T._direction===K.vertical&&(a=t%c,s=W(t/c)),e=new z.Rect,o=0,f.filter(function(t,e){return e<s}).forEach(function(t){o+=t}),e.x=b+o+s*(p+d+T._itemSpacing.horizontal*A)+u.x,e.y=v+a*g+T._itemSpacing.vertical*A*a+u.y,n=T.dHb(),e.width=(T._textAlign!==Y.right||n.hasMagin?f[s]:i)+p+d,e.height=g,e.x>u.x+u.width||e.y>u.y+u.height?C[t]=null:C[t]=e},x=0;x<T._items.length;x++)w(x);return C},P.prototype.AGb=function(t,e,o,n,r,i){},P.prototype.dHb=function(){return{hasMagin:!1,paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}},P.prototype.getAutoFitWidth=function(t,e,o,n,r){var i=r&&r.sheet,a=L(o),s=it(this,i,o);return($(this,i,o,s[0],s[1])+a)/i.zoom()},P.prototype.getAutoFitHeight=function(t,e,o,n,r){var i=r&&r.sheet,a=it(this,i,o);return X(this,i,o,a[0],a[1])/i.zoom()},P.prototype.getHitInfo=function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g;return r?(i=r.sheetArea,a=r.sheet,n=o.cellType.f5(n,o,a.zoom()),(y(i)||3===i)&&n?(s={x:t,y:e,row:r.row,col:r.col,cellStyle:o,cellRect:n,sheetArea:i,sheet:a},l=a.zoom(),o.font&&(o.font=z.To.No(o.font,l).font),f=$(this,a,o,c=(u=it(this,a,o,n.width-1,n.height-2))[0],h=u[1]),p=X(this,a,o,c),d=n.x+nt(o,n,l,f),g=n.y+rt(o,n,l,p),new z.Rect(d,g,f,p).contains(s.x,s.y)&&(s.isReservedLocation=!0),s):m):m},P.prototype.processMouseDown=function(t){return!!t&&void(t.isReservedLocation&&(this.uK=!0))},P.prototype.processMouseLeave=function(t){return R.prototype.processMouseLeave.call(this,t),!!t&&void(this.uK=!1)},P.prototype.processMouseUp=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d;return!!t&&(e=t.sheet,!!(this.uK&&e&&t.isReservedLocation&&(this.uK=!1,o=t.row,n=t.col,r=t.sheetArea,i=function(c,h){function t(t){var e,o,n,r,i,a=Q(c._items[t],Z)?c._items[t].text:c._items[t],s=f.dp(a,h.cellStyle.font),l=W(t/g),u=t%g;if(c._direction===K.vertical&&(l=t%d,u=W(t/d)),e=new z.Rect,o=0,m.filter(function(t,e){return e<u}).forEach(function(t){o+=t}),e.x=C+o+u*(y+b+c._itemSpacing.horizontal*p),e.y=w+l*v+c._itemSpacing.vertical*p*l,n=c.dHb(),e.width=(c._textAlign!==Y.right||n.hasMagin?m[u]:s)+y+b,e.height=v,r=h.x-h.cellRect.x,i=h.y-h.cellRect.y,e&&e.contains(r,i))return{value:{value:Q(c._items[t],x)?c._items[t].value:c._items[t]}}}var e,o,n=h.cellRect.width,r=h.cellRect.height,f=h.sheet,p=f.zoom(),i=f.getStyle(h.row,h.col),a=i&&i.font,s=it(c,h.sheet,h.cellStyle,n-1,r),d=s[0],g=s[1],m=tt(c,h.sheet,h.cellStyle,d,g),y=et(c._boxSize,a,p),b=c.defaultPadding*p,v=G(ot(c,h.cellStyle),y),l=$(c,f,h.cellStyle,d,g),u=X(c,f,h.cellStyle,d),C=nt(h.cellStyle,h.cellRect,p,l),w=rt(h.cellStyle,h.cellRect,p,u);for(e=0;e<c._items.length;e++)if("object"==typeof(o=t(e)))return o.value}(this,t)))&&(a=this,s=e,l=o,u=n,c=i.value,h=r,f=s.getValue(l,u,h),p=a.rK(f,c),d={cmd:"editCell",sheetName:s.name(),row:l,col:u,newValue:p,autoFormat:!0},s.wu().execute(d),a.triggerButtonClicked(s,l,u,h),!0))},P.prototype.rK=function(t,e){return B(t,e,this._items,!0)},P.prototype.triggerButtonClicked=function(t,e,o,n){var r=t.parent;r&&r.tw(t,e,o,n)},P.prototype.lJc=function(t){var e={items:t.items,direction:t.direction&&K[t.direction],maxColumnCount:t.maxColumnCount,maxRowCount:t.maxRowCount,isFlowLayout:t.isFlowLayout,itemSpacing:t.itemSpacing,textAlign:t.textAlign&&Y[t.textAlign],boxSize:t.boxSize};this.fromJSON(e)},P.prototype.toJSON=function(){var o,n=this,r={typeName:n.typeName};return u(c,function(t,e){o=n["_"+t],("items"===t?o&&0<o.length:o!==e)&&(r[t]="object"==typeof o?i(o):o)}),r},P.prototype.fromJSON=function(o){var n=this;u(c,function(t){var e=o[t];y(e)||(n["_"+t]=e)})},D(F,N=g=P),F.prototype.AGb=function(t,e,o,n,r,i){var a=Q(o,x)?o.value:o;t.beginPath(),t.fillStyle="white",t.arc(n+i,r+i,i,0,2*Math.PI),t.fill(),t.beginPath(),t.strokeStyle="black",t.arc(n+i,r+i,i,0,2*Math.PI),t.stroke(),e!==m&&j(e,a)&&(t.beginPath(),t.strokeStyle="black",t.arc(n+i,r+i,.5*i,0,2*Math.PI),t.fillStyle="black",t.fill(),t.stroke())},b=F,e.RadioButtonList=b,D(O,I=g),O.prototype.AGb=function(t,e,o,n,r,i){t.strokeStyle="black",t.strokeRect(n+.5,r+.5,2*i+.05,2*i+.05),t.fillStyle="white",t.fillRect(n+1,r+1,2*i-1,2*i-1);var a=H(o,e);e!==m&&a&&(t.beginPath(),t.lineWidth=2.5,t.moveTo(n+3,r+i),t.lineTo(n+i,r+2*i-3.5),t.lineTo(n+2*i-1.5,r+3),t.stroke())},O.prototype.rK=function(t,e){return B(t,e,this._items,!1)},v=O,e.CheckBoxList=v,(M=C=e.SelectionMode||(e.SelectionMode={}))[M.single=0]="single",M[M.multiple=1]="multiple",w={selectedBackColor:"rgb(227,119,0)",selectedForeColor:"white",padding:"5",items:m,itemSpacing:{horizontal:5,vertical:5},selectionMode:C.multiple},D(_,S=g),_.prototype.zGb=function(t,e,o,n,r,i,a,s,l){var u,c,h,f,p;t.save(),t.beginPath(),u=H(e,o),c=Q(e,Z)?e.text:e,h=this._selectedBackColor,f=this._selectedForeColor,u&&(t.fillStyle=h,t.fillRect(r+1,i+1,a-1,s-1),t.fillStyle=f),t.textAlign="center",t.textBaseline!==d&&(t.textBaseline=d),p=this.dHb(),t.fillText(c,r+p.paddingLeft+(a-p.paddingLeft-p.paddingRight)/2,i+p.paddingTop+s-p.paddingTop-p.paddingBottom-l),t.restore()},_.prototype.rK=function(t,e){return B(t,e,this._items,this._selectionMode===C.single)},_.prototype.dHb=function(){var t,e,o,n,r,i,a,s=0,l=0,u=0,c=0;return this._padding&&(e=this._padding,a=["0","0","0","0"],typeof e===f&&(i=r=void 0,1===(n=(o=e.split(" ",4)).length)?a=[r=o[0],r,r,r]:2===n?a=[r=o[0],i=o[1],r,i]:3===n?(i=o[1],a=[o[0],i,o[2],i]):4===n&&(a=[o[0],o[1],o[2],o[3]])),t=a,s=typeof(s=parseInt(t[0],10))==p&&0<s?s:0,c=typeof(c=parseInt(t[1],10))==p&&0<c?c:0,l=typeof(l=parseInt(t[2],10))==p&&0<l?l:0,u=typeof(u=parseInt(t[3],10))==p&&0<u?u:0),{hasMagin:!0,paddingTop:s,paddingBottom:l,paddingLeft:u,paddingRight:c}},_.prototype.hMc=function(t){return 0},_.prototype.toJSON=function(){var o,n=this,r=S.prototype.toJSON.call(this);return u(w,function(t,e){o=n["_"+t],("items"===t?o&&0<o.length:o!==e)&&(r[t]="object"==typeof o?i(o):o)}),r},_.prototype.fromJSON=function(o){S.prototype.fromJSON.call(this,o);var n=this;u(w,function(t){var e=o[t];y(e)||(n["_"+t]=e)})},T=_,e.ButtonList=T,u(c,function(u){g.prototype[u]=function(t){var e,o,n,r,i,a,s="_"+u,l=this;if(0===arguments.length)return l[s];if("items"===u){for(e=[],o=0;o<t.length;o++)n=t[o],y(n.text)||y(n.value)?y(n.text)?y(n.value)?y(n)||"object"==typeof n||e.push({text:n,value:n}):(n.text=n.value,e.push(n)):(n.value=n.text,e.push(n)):e.push(n);t=e}if("itemSpacing"===u)r=l[s],l[s]={horizontal:r.horizontal,vertical:r.vertical},y(t.horizontal)||(i=parseInt(t.horizontal,10),isNaN(i)||(l[s].horizontal=i)),y(t.vertical)||(a=parseInt(t.vertical,10),isNaN(a)||(l[s].vertical=a));else if("boxSize"===u){if(y(t))return l[s];"number"==typeof t&&0<=t&&(l[s]=t),"auto"===t&&(l[s]=t)}else l[s]=t;return l}}),z.CellTypes._o[11]=b,z.CellTypes._o[12]=v,u(w,function(l){T.prototype[l]=function(t){var e,o,n,r,i,a,s="_"+l;if(0===arguments.length)return this[s];if("items"===l){for(e=[],o=0;o<t.length;o++)n=t[o],y(n.text)||y(n.value)?y(n.text)?y(n.value)?y(n)||"object"==typeof n||e.push({text:n,value:n}):(n.text=n.value,e.push(n)):(n.value=n.text,e.push(n)):e.push(n);t=e}return"itemSpacing"===l?(r=this[s],this[s]={horizontal:r.horizontal,vertical:r.vertical},y(t.horizontal)||(i=parseInt(t.horizontal,10),isNaN(i)||(this[s].horizontal=i)),y(t.vertical)||(a=parseInt(t.vertical,10),isNaN(a)||(this[s].vertical=a))):this[s]=t,this}}),z.CellTypes._o[13]=T},"./dist/plugins/celltype/rangecelltype.js":function(t,e,o){"use strict";var xt,n,p,Tt,At,r,St,Mt,It,s,l,i,a,u,c=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function d(t){return t.map(function(t){return{start:t.start,size:t.size}})}function h(t,e,o,n,r){var i,a=u.call(this)||this;return a.allowOverflow=!1,a.typeName="16",i=1===arguments.length?new xt.Range(0,0,t.getRowCount(),t.getColumnCount()):new xt.Range(e,o,n,r),t&&i&&(a._R=(new s).YE(t,i),a.gKb=(new l).YE(t,i)),a}function f(){}function g(){this.Uu=0,this.SV=0,this.Xj=0,this.OZ=0}function m(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J,Z,q,K,Y,Q,X,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ht,ft,pt,dt,gt,mt,yt,bt,vt,Ct,wt;for(void 0===a&&(a=1),s=e.x,l=e.y,u=e.width,c=e.height,h=n.sheet,f=n.sheetArea,p=n.isPrinting,d=n.needTopGridline,g=n.needLeftGridline,m=[],y=[],b=[],v=h.vu(),C=i.rowCount,w=i.colCount,x=i.rowSize,T=i.colSize,A=i.cellStyleList,S=i.sparklines,r.$Jb(o),I=(M=r.cKb()).baseRow,N=M.baseCol,k=(R=r.UJb).Pm,R.Us(new xt.Rect(0,0,u,c)),E=new xt.AF(R,R.Gr(1,3),R.Hr(1,3),3),D=r.dKb(!0),l+=1,--c,s+=1,--u,_=j=0,x=x.map(function(t){var e=t.size*c,o=It(e);return 1<=(_+=e-o)&&(o++,_--),{start:It(t.start*c),size:o}}),T=T.map(function(t){var e=t.size*u,o=It(e);return 1<=(j+=e-o)&&(o++,j--),{start:It(t.start*u),size:o}}),O=R.conditionalFormats,F=0;F<C;F++)for(P=0;P<w;P++)if(A[F][P]){if(H=(L=A[F][P]).style,B=L.isSpan,V=L.span,z=!1,W=D[F][P],B&&!V)continue;if(H=H.clone(!0),G=It(s+T[P].start),U=It(l+x[F].start),0,q=B?V.colCount:1,K=B?V.rowCount:1,J=T[P+q]?T[P+q].start:u,Y=It(J-T[P].start),Z=x[F+K]?x[F+K].start:c,Q=It(Z-x[F].start),W.formatStyle&&(W.formatStyle.Yo(H),H=W.formatStyle),H.Zo(k),X=Mt,B){for(X={row:F,col:P,x:It(G),y:It(U),width:It(Y),height:It(Q),rowCount:K,colCount:q},$={},tt={},et=[],nt=ot=void 0,ot=it=rt=0;ot<q-1;ot++)st=(at=T[P+ot])?at.size:0,rt+=tt[ot]=st;for(tt[ot]=It(Y)-rt,nt=0;nt<K-1;nt++)st=(lt=x[F+nt])?lt.size:0,it+=$[nt]=st;for($[nt]=It(Q)-it,nt=0;nt<K;nt++){for(ut=[],ct=0;ct<q;ct++)A[nt+F]&&A[nt+F][P+ct]&&ut.push(A[nt+F][P+ct].style);et.push(ut)}X.spanSizeInfo={styleList:et,rowSizes:$,colSizes:tt}}E.jF(F,P,It(G),It(U),It(Y),It(Q),H,X,d&&0===F,g&&0===P),(ht=H.formatter)&&xt.util.lHb(ht)&&((ft=h.parent&&h.parent.aJb(ht))&&(ft.getExpression()&&((pt=At.evaluateFormula(h,ht.replace("@",JSON.stringify(W.value))))instanceof Tt.CalcError||(W.value=pt)))),dt=null,S[F][P]&&((dt=S[F][P].clone())&&(dt.oZa=R.name(),dt.hKb=dt.iKb(R),dt.jKb=dt.kKb(R),dt.lKb=R)),W&&W.value&&"SparklineExValue"===W.value.typeName&&(b.push({value:W.value,x:G,y:U,width:Y,height:Q,option:n}),z=!0),W.validStyle&&y.push({style:W.validStyle,x:G,y:U,width:Y,height:Q}),m.push({data:z?null:W.value,row:F,col:P,x:G,y:U,width:Y,height:Q,style:H,sparkline:dt,baseRow:F+I,baseCol:P+N,conditionalFormats:O,imageLoader:v,cellLayout:{row:F,col:P,x:G,y:U,width:Y,height:Q}})}for(t.save(),d&&(l-=2,c+=4),g&&(s-=2,u+=4),t.rect(s,l,u,c),t.clip(),0<m.length&&R._render.SI(t,m,f,p,1,h,I,N,a),E.paint(t),0<y.length&&R._render.jJ(t,y),t.restore(),F=0;F<b.length;F++)mt=(gt=b[F]).value,yt=gt.x,bt=gt.y,vt=gt.width,Ct=gt.height,wt=gt.option,St.bDc(t,mt,yt,bt,vt,Ct,wt)}Object.defineProperty(e,"__esModule",{value:!0}),xt=o("Core"),n=o("Bindings"),p=o("Sparkline"),Tt=o("@grapecity/js-calc"),At=o("SheetsCalc"),r=xt.CellTypes.Base,St=xt.CellTypes.Context,Mt=null,It=Math.floor,g.prototype.YE=function(t,e){var o=e.row,n=e.col,r=e.rowCount,i=e.colCount;return this.Uu=o,this.SV=n,this.Xj=r,this.OZ=i,this.Ny=this.nJb(t,e),this.NJb=this.OJb(t,e),this},g.prototype.PJb=function(){return this.NJb},g.prototype.OJb=function(t,e){var o,n,r,i,a,s=e.row,l=e.col,u=e.rowCount,c=e.colCount,h=0,f=[],p=0,d=[],g=0,m=s+u,y=l+c;for(o=s;o<m;o++)g=t.getRowHeight(o),p+=g,d.push(g);for(n=l;n<y;n++)g=t.getColumnWidth(n),h+=g,f.push(g);return g=0,r=d.map(function(t){var e=g/p;return g+=t,{start:e,size:t/p}}),g=0,i=f.map(function(t){var e=g/h;return g+=t,{start:e,size:t/h}}),a=this.nJb(t,e),{rowCount:u,colCount:c,rowSize:r,colSize:i,cellStyleList:this.QJb(t,e,a,r,i),sparklines:this.RJb(t,e),totalHeight:p,totalWidth:h}},g.prototype.SJb=function(t,e,o,n,r){var i,a,s,l,u,c,h,f=null;for(i=0,a=r;i<a.length;i++)if(l=(s=a[i]).rowOffset,u=s.colOffset,c=s.rowCount,h=s.colCount,new xt.Range(l+o,u+n,c,h).contains(t,e)){f=s;break}return f},g.prototype.TJb=function(t,e,o){var n,r=[0,0],i=r[0],a=r[1],s=t.rowOffset,l=t.colOffset,u=s+t.rowCount,c=l+t.colCount;for(n=s;n<u;n++)a+=e[n]?e[n].size:0;for(n=l;n<c;n++)i+=o[n]?o[n].size:0;return{width:i,height:a}},g.prototype.QJb=function(t,e,o,n,r){var i,a,s,l,u,c=e.row,h=e.col,f=e.rowCount,p=e.colCount,d=[];for(i=c;i<c+f;i++){for(a=[],s=h;s<h+p;s++)(l=this.SJb(i,s,c,h,o))&&l.rowOffset+c===i&&l.colOffset+h===s?(u=this.TJb(l,n,r),a.push({style:t.getActualStyle(i,s,3,!0),spanWidth:u.width,spanHeight:u.height,isSpan:!0,span:l})):l?a.push({style:t.getActualStyle(i,s,3,!0),isSpan:!0}):a.push({style:t.getActualStyle(i,s,3,!0)});d.push(a)}return d},g.prototype.nJb=function(t,e){var o,n,r,i=t._modelManager.getSpans(),a=[],s=e.row,l=e.col,u=e.rowCount,c=e.colCount;for(o=0,n=i;o<n.length;o++)(r=n[o]).intersect(s,l,u,c)&&a.push({rowOffset:r.row-s,colOffset:r.col-l,rowCount:r.rowCount,colCount:r.colCount});return a},g.prototype.RJb=function(t,e){var o,n,r,i,a=e.row,s=e.col,l=e.colCount,u=e.rowCount,c=[];for(o=a;o<a+u;o++){for(n=[],r=s;r<s+l;r++)(i=t.getSparkline(o,r))?n.push(i.clone()):n.push(null);c.push(n)}return c},g.prototype.toJSON=function(){var t=this.PJb(),e=t.rowCount,o=t.colCount,n=t.rowSize,r=t.colSize,i=t.cellStyleList,a=t.sparklines,s=t.totalWidth,l=t.totalHeight;return{rowCount:e,colCount:o,rowSize:d(n),colSize:d(r),cellStyleList:i.map(function(t){return t.map(function(t){if(t){var e=t.style,o=t.spanWidth,n=t.spanHeight,r=t.isSpan,i=t.span;return{style:e.toJSON(),spanWidth:o,spanHeight:n,isSpan:r,span:i}}return null})}),sparklines:a.map(function(t){return t.map(function(t){if(t)return{sparklineType:t.sparklineType(),sp:t.toJSON(),setting:t.setting().toJSON()}})}),totalWidth:s,totalHeight:l}},g.prototype.fromJSON=function(t){var e,o,n,r,i,a,s,l,u,c,h,f;t&&(e=t.rowCount,o=t.colCount,n=t.rowSize,r=t.colSize,i=t.cellStyleList,a=t.sparklines,s=t.totalWidth,l=t.totalHeight,u=d(n),c=d(r),h=i.map(function(t){return t.map(function(t){var e,o,n,r,i,a;return t?(e=t.style,o=t.spanWidth,n=t.spanHeight,r=t.isSpan,i=t.span,a=null,e&&(a=new xt.Style).fromJSON(e),{style:a,spanWidth:o,spanHeight:n,span:i,isSpan:r}):null})}),f=a.map(function(t){return t.map(function(t){if(t){var e=new p.Sparkline,o=new p.SparklineSetting(t.setting);return e.fromJSON(t.sp),e.setting(o),e.sparklineType(t.sparklineType),e}})}),this.NJb={rowCount:e,colCount:o,rowSize:u,colSize:c,cellStyleList:h,sparklines:f,totalWidth:s,totalHeight:l})},g.prototype.no=function(){this.NJb=null},s=g,e.Wgc=s,f.prototype.YE=function(t,e,o){var n=this;return n.my=e,n.UJb=new xt.Worksheet,n.VJb=t.parent&&t.parent.options.allowDynamicArray,n.UJb.getCalcService&&(n.UJb.getCalcService().allowDynamicArray=n.VJb,n.WJb=n.XJb(t)),n.iMc(t,o),n},f.prototype.XJb=function(t){var e,o,n,r,i,a,s,l=this.my,u=l.row,c=l.col,h=l.colCount,f=l.rowCount,p=[],d=t.Bj&&t.Bj();for(e=u;e<u+f;e++)for(o=c;o<c+h;o++)t.getFormula(e,o)&&(n=d&&d.Qf(e,o))&&n.isDynamicArray&&(r=n.row,i=n.col,a=n.rowCount,s=n.colCount,1<a&&p.push({row:r+1,col:i,rowCount:a-1,colCount:s}),1<s&&p.push({row:r,col:i+1,rowCount:1,colCount:s-1}));return p},f.prototype.ZJb=function(){var t,e,o,n,r,i,a,s=this.WJb,l=this.UJb;for(t=0,e=s;t<e.length;t++)n=(o=e[t]).row,r=o.col,i=o.rowCount,a=o.colCount,l.clear(n,r,i,a,3,1)},f.prototype.$Jb=function(t){var e,o=this.UJb;o.suspendEvent(),e=new n.CellBindingSource(t),this.ZJb(),o.setDataSource(e),o.resumeEvent()},f.prototype.iMc=function(t,e){var o=this.UJb,n=t.toJSON({includeBindingSource:!0,ignoreFormula:!!e});delete n.charts,delete n.shapes,o.fromJSON(JSON.parse(JSON.stringify(n))),this._Jb()},f.prototype._Jb=function(){var t,e,o=this.my,n=o.row,r=o.col,i=o.colCount,a=o.rowCount,s=[],l=[];for(t=n;t<n+a;t++){for(l=[],e=r;e<r+i;e++)l.push(this.aKb(t,e,3));s.push(l)}this.bKb=s},f.prototype.cKb=function(){var t=this.my;return{baseRow:t.row,baseCol:t.col}},f.prototype.dKb=function(t){var e,o,n,r,i,a,s,l,u=this.UJb,c=this.my,h=c.row,f=c.col,p=c.colCount,d=c.rowCount,g=[];for(e=h;e<h+d;e++){for(o=[],r=n=void 0,i=f;i<f+p;i++)a=u.getText(e,i),s=u.getValue(e,i,3,1),l=u.getBindingPath(e,i),n=this.eKb(e,i,3),r=this.fKb(u,e,i,s,t),o.push({value:s,formatStyle:n,text:a,validStyle:r,bindingPath:l});g.push(o)}return g},f.prototype.aKb=function(t,e,o){var n;return this.UJb.uja&&(n=this.UJb.getDataValidator(t,e,o))?n.highlightStyle():null},f.prototype.fKb=function(t,e,o,n,r){if(r&&t.isValid&&!t.isValid(e,o,n)){var i=this.my,a=i.row,s=i.col;return this.bKb[e-a][o-s]}return null},f.prototype.eKb=function(t,e,o){var n=this.UJb.conditionalFormats;return n?n.Eq(new xt.Style,t,e,o):null},f.prototype.getCellValueInfo=function(t){var e,o,n,r=this.my,i=r.row,a=r.col,s=r.colCount,l=r.rowCount,u=[],c=t._modelManager;for(e=i;e<i+l;e++){for(o=[],n=a;n<a+s;n++)o.push({bindPath:t.getBindingPath(e,n),formula:t.getFormula(e,n),value:c.getValue(e,n,3,Mt,1)});u.push(o)}return u},f.prototype.setValueToDataStruct=function(t,e,o,n){n[t]||(n[t]={}),n[t][e]=o},f.prototype.toJSON=function(){var t=this.UJb,e=this.VJb,o=this.WJb.map(function(t){return{row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount}}),n=this.my;return{spillRangs:o,allowDynamicArray:e,range:{row:n.row,col:n.col,rowCount:n.rowCount,colCount:n.colCount},templatejson:JSON.stringify(t.toJSON({includeBindingSource:!0}))}},f.prototype.fromJSON=function(t){var e,o,n,r,i,a;t&&((e=this.UJb=new xt.Worksheet).suspendCalcService&&e.suspendCalcService(),this.WJb=t.spillRangs,this.VJb=t.allowDynamicArray,e.getCalcService&&(e.getCalcService().allowDynamicArray=this.VJb),e.fromJSON(JSON.parse(t.templatejson)),this.ZJb(),n=(o=t.range).row,r=o.col,i=o.rowCount,a=o.colCount,this.my=new xt.Range(n,r,i,a),this._Jb(),e.resumeCalcService&&e.resumeCalcService())},f.prototype.no=function(){this.UJb.no(),this.UJb=null,this.my=null},l=f,e.Xgc=l,c(h,u=r),h.prototype.getAutoFitWidth=function(){return this._R.NJb.totalWidth},h.prototype.getAutoFitHeight=function(){return this._R.NJb.totalHeight},h.prototype.updateTemplate=function(t,e){t&&e&&(this._R.YE(t,e),this.gKb.YE(t,e))},h.prototype.paintContent=function(t,e,o,n,r,i,a,s){var l,u=this.gKb,c=this._R;u&&c&&(l=this._R.PJb(),a.cellPadding&&(s.needTopGridline=!0,s.needLeftGridline=!0),m(t,{x:o,y:n,width:r,height:i},e,s,u,l))},h.prototype.toJSON=function(){return{typeName:this.typeName,layout:this._R.toJSON(),resolvor:this.gKb.toJSON()}},h.prototype.fromJSON=function(t){t.layout&&(this._R=new s,this._R.fromJSON(t.layout)),t.resolvor&&(this.gKb=new l,this.gKb.fromJSON(t.resolvor))},i=h,e.RangeTemplate=i,xt.CellTypes._o[16]=i,e.paintRangeTemplate=m},"./dist/plugins/conditional/conditional.entry.js":function(t,o,e){"use strict";function n(t){for(var e in t)o.hasOwnProperty(e)||(o[e]=t[e])}Object.defineProperty(o,"__esModule",{value:!0}),n(e("./dist/plugins/conditional/conditional.js")),n(e("./dist/plugins/conditional/conditional.ns.js"))},"./dist/plugins/conditional/conditional.js":function(t,y,e){"use strict";var l,T,p,o,b,d,K,g,v,n,L,C,w,I,S,A,M,i,x,N,m,R,r,k,E,D,j,_,a,O,u,s,c,Y,F,P,H,B,Q,V,z,h,W,X,$,f,G,U,J,Z,q,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ht,ft,pt,dt,gt,mt,yt,bt,vt,Ct,wt,xt,Tt,At,St,Mt,It,Nt,Rt,kt,Et,Dt,jt,_t,Ot,Ft,Pt,Lt,Ht,Bt,Vt,zt,Wt,Gt,Ut,Jt,Zt,qt,Kt,Yt,Qt,Xt,$t,te,ee,oe,ne,re,ie,ae,se,le,ue,ce,he,fe,pe,de,ge,me,ye,be,ve,Ce,we,xe,Te,Ae,Se,Me,Ie,Ne,Re,ke,Ee=this&&this.__extends||(re=function(t,e){return(re=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}re(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function De(t){return t.rowCount}function je(t){return t.colCount}function _e(t,e,o,n){switch(n&&"string"==typeof e&&"string"==typeof o&&(e=e.toLowerCase(),o=o.toLowerCase()),t){case st.equalsTo:return e===o;case st.notEqualsTo:return e!==o;case st.greaterThan:return o<e;case st.greaterThanOrEqualsTo:return o<=e;case st.lessThan:return e<o;case st.lessThanOrEqualsTo:return e<=o;default:return!1}}function Oe(t,e){var o,n;o=(e=e||{}).formula,(n=this).offsetRow=0,n.offsetCol=0,n.conType("string"==typeof t?Tt[t]:t),_(e.compareType)||n.RV(e.compareType),_(e.expected)||n.expected(e.expected),_(o)||n.formula("string"==typeof o?k(v.trim(o),"="):o),_(e.item1)||n.item1(e.item1),_(e.item2)||n.item2(e.item2),_(e.customValueType)||n.customValueType(e.customValueType),_(e.type)||n.type(e.type),n.ranges(e.ranges),n.Lf=L,n.TV=L}function Fe(t,e,o){var n=[],r=t.row,i=t.rowCount,a=t.col,s=t.col+t.colCount-1;return a<e?e<=s&&s<=o?(n[0]=Q(r,a,i,e-a),n[1]=Q(r,e,i,s-e+1)):o<s&&(n[0]=Q(r,a,i,e-a),n[1]=Q(r,e,i,o-e+1),n[2]=Q(r,o+1,i,s-o)):a<=o&&(e<=s&&s<=o?n[1]=t:o<s&&(n[1]=Q(r,a,i,o-a+1),n[2]=Q(r,o+1,i,s-o))),n}function Pe(t,e,o){var n=[],r=t.col,i=t.colCount,a=t.row,s=t.row+t.rowCount-1;return a<e?e<=s&&s<=o?(n[0]=Q(a,r,e-a,i),n[1]=Q(e,r,s-e+1,i)):o<s&&(n[0]=Q(a,r,e-a,i),n[1]=Q(e,r,o-e+1,i),n[2]=Q(o+1,r,s-o,i)):a<=o&&(e<=s&&s<=o?n[1]=t:o<s&&(n[1]=Q(a,r,o-a+1,i),n[2]=Q(o+1,r,s-o,i))),n}function Le(t,e,o){this.xyb=!0,this.ruleType(t),this.style(e),this.ranges(o)}function He(t,e,o,n,r,i,a,s,l,u){var c=Me.call(this,t,o)||this,h=c;return h.ranges(e),h.operator(n),h.value1("string"==typeof r?v.trim(r):r),h.value2("string"==typeof i?v.trim(i):i),h.text(a),h.formula(s),h.type(l),h.rank(u),h.cached=!1,h.cW=L,c}function Be(t,e,o,n){var r=e.ranges(),i=Y(r),a=K.formulaToExpression(t,o,i.r,i.c,n);return K.expressionToFormula(t,a,i.r,i.c,!n)}function Ve(t,e){var o=this,n=t;return 0===arguments.length&&(n=0),(o=Ie.call(this,13,L,L,L)||this).xyb=!1,o.ranges(e),o.ad(n),o}function ze(t,e,o,n,r,i){var a=this,s=t,l=e,u=o,c=n,h=r;return 0===arguments.length&&(s=5,u=7,c=l=L,h=B(255,99,142,198)),(a=Ne.call(this,12,s,l,L,L,L,L,u,c,L,i)||this).xyb=!1,a.ad(h),a}function We(t,e,o,n,r,i,a,s,l,u,c){var h,f,p,d,g,m,y,b,v,C=Re.call(this,t,L,c)||this,w=C;return w.xyb=!1,w.lowestValueCached=L,w.highestValueCached=L,w.zyb={},w.cached=!1,w.cW=L,h=e,f=o,p=n,d=r,g=i,m=a,y=s,b=l,v=u,arguments.length<=1&&(h=1,f=L,p=B(255,248,105,107),d=4,g=50,m=B(255,255,235,132),y=2,b=L,v=B(255,99,190,123)),w.minColor(p),w.minValue(f),w.minType(h),w.midColor(m),w.midValue(g),w.midType(d),w.maxColor(v),w.maxValue(b),w.maxType(y),C}function Ge(t){return"string"==typeof t&&("="!==(t=v.trim(t))[0]&&(t='="'+n.Gb(t,'"','""')+'"')),t}function Ue(t){this.AW=[],this.BW=L,this.DW={},this.Kfc=!0,this.WS=t}function Je(t,e,o,n){var r=ke.call(this,t,o,n)||this;return r.state(e),r}function Ze(t,e){if(e)for(var o=0;o<e.length;o++)t.push(e[o])}function qe(t){var e,o,n=[],r=$(t);for(o=0;o<r;o++)e=t[o],n.push(Q(e.row,e.col,De(e),je(e)));return n}function Ke(t,e){var o,n;for(o=0;o<t.length;o++)if((n=t[o])&&n.equals(e))return 1}Object.defineProperty(y,"__esModule",{value:!0}),l=e("@grapecity/js-sheets-common"),T=e("Core"),p=e("@grapecity/js-calc"),o=e("./dist/plugins/conditional/conditional.ns.js"),b=e("@grapecity/js-calc"),d=e("Core"),K=e("SheetsCalc"),g=e("./dist/plugins/conditional/conditionalFormatIcon.js"),v=T.GC$,n=l.Common.u,L=null,C=void 0,w="string",I=Math.min,S=Math.max,A=Math.abs,M=Math.floor,i=Math.ceil,x=p.Convert,N=x.Na,m=x.Pa,R=x.Th,r=l.Common.u,k=r.Db,E=r.kb,D=r.jb,j=r.Bb,_=l.Common.j.Fa,a=l.Common.q,O=l.Common.F,u=T.Ul,s=T.Zn,c=u.T$a,Y=u.l_a,F=!!p,P=T.Style,l.Common.k,H=l.Common.pc,B=H.bc,Q=T.kf,V=T.Range,z=l.Common.l,h=l.Common.k,W=h.Fb,X=h.Cb,$=h.ac,f=p.Functions,G=p.evaluateOperator,U=T.Rm,J=new l.Common.ResourceManager(o.SR,"ConditionalFormatting"),Z=J.getResource.bind(J),q=function(t){return/[\f\n\r\t\v]/.test(t)},tt=function(t){var e=t.row<0?K.BAND_INDEX_CONST:t.row,o=t.col<0?K.BAND_INDEX_CONST:t.col;return b.uf(L,L,e,o,e+t.rowCount-1,o+t.colCount-1)},et=function(t){var e;if(t instanceof p.Expression)e=t;else if(t instanceof V)e=tt(t);else{if(!N(t))throw Z().Exp_NotSupport;t=m(t),isNaN(t)||((e=new p.Expression(2)).value=t)}return e},ot=function(t,e,r,i){function o(t,e){var o,n;return this.hasOwnProperty("_ps")||(this._ps={}),o=this._ps,0===arguments.length?o[a]!==C?i?i.call(this,o[a]):o[a]:s:(o[a]!==t&&(n=o[a]!==C?o[a]:s,o[a]=t,!1!==e&&r&&r.call(this,t,n)),this)}var a=t,s=e;return o.isDefault=function(t){return t===s},o},nt=function(r,t,i){var a=this;return i=i||{},t=t||a,_(a.pivotTableName)||(i.pivot=!0),v.each(t,function(t,e){var o,n=a[e];_(n)||(o=n.call(a),"formula"===e?(a.getFormulaString?o=a.getFormulaString(r,C,C,!0):a.condition()&&a.condition().getFormulaString&&(o=a.condition().getFormulaString(r,C,C,!0)),o&&(i[e]=o)):"iconCriteria"===e||"icons"===e?i[e]=o:z.Ska(o)?i[e]=z.Daa(o):o&&o.toJSON?i[e]=o.toJSON(r):_(o)||n.isDefault(o)||(i[e]=o))}),i},rt=function(f,t,p,d){if(p){var g,m=this;t=t||m,v.each(t,function(t,e){var o,n,r,i,a,s,l,u,c,h;if(g=p[e],!_(g))if("ranges"===e){for(o=[],n=0;n<g.length;n++)r=g[n],o.push(Q(r.row,r.col,De(r),je(r)));m.ranges(o,!1)}else if("style"===e)m.style(new P,!1),m.style().fromJSON(g,d);else if("iconCriteria"===e)for(i=g.length,a=0;a<i;a++)s=g[a],m.NV[a]=new Qt(s.isGreaterThanOrEqualTo,s.iconValueType,s.iconValue);else if("icons"===e)for(l=g.length,u=0;u<l;u++)c=g[u],m.CZa[u]={iconSetType:c.iconSetType,iconIndex:c.iconIndex};else"iconSetType"===e?m[e](g,!0):"item1"===e||"item2"===e?(m[e](y.$V(),!1),m[e]().fromJSON(g,f)):"expected"===e?v.getType(g)!==w||5!==p.conType&&13!==p.conType?m[e](g,!1):"/OADate("===g.substr(0,8)?m[e](z.Rka(g),!1):m[e](new Date(g)):"condition"===e?((h=new Lt).fromJSON(g,f),m.condition(h,!1)):v.getType(g)===w&&"/OADate("===g.substr(0,8)?m[e](z.Rka(g),!1):m[e](g,!1)})}},it=T.lUa,v.extend(it.prototype,{YUa:function(){var t=this.zTa;t&&!t.pXc&&(t.pXc=this.U5.AW.map(function(t){return{rule:t,ranges:t.ranges().slice()}}))},$Ua:function(t){var o=this.U5,n=this.kj;n.suspendPaint(),t&&(0===t.length&&o.AW&&1===o.AW.length&&o.constructor.ao(n,"onRuleUpdated",{ranges:o.AW[0].ranges()}),o.AW=t.map(function(t){var e=t.rule;return e.ranges(t.ranges),o.constructor.ao(n,"onRuleUpdated",{ranges:e.ranges()}),e}),o.QV()),n.resumePaint()},_Ua:function(t,e,o,n){this.YUa(),this.U5.rI(t,e,o,n)},aVa:function(t,e,o,n){this.YUa(),this.U5.GR(t,e,o,n)},bVa:function(t,e,o,n){this.YUa(),this.U5.tI(t,e,o,n)},cVa:function(t,e,o,n){this.YUa(),this.U5.HR(t,e,o,n)},dVa:function(){this.YUa(),this.U5.Nm()},eVa:function(){this.YUa(),this.U5.QV()}}),it.$n("conditionalFormat",{init:function(){this.U5=new ne(this.kj)},undo:function(t){var e=t.pXc;e&&this.$Ua(e)},dispose:function(t){!1!==(t&&t.clearCache)&&this.U5&&(this.U5.no(),this.U5=L)}}),at={init:function(){this.conditionalFormats=this._modelManager.U5},dispose:function(t){if(!1!==t.clearCache){var e=this.conditionalFormats;e&&e.OV()}},onLayoutChanged:function(t){var e=t.changeType,o=t.row,n=De(t),r=t.col,i=je(t),a=t.sheetArea,s=this._modelManager,l=this.tables;"addRows"===e?s._Ua(o,n,l&&l.KFc(o,-1,n,-1,!0),!1):"deleteRows"===e?s.aVa(o,n):"addColumns"===e?s.bVa(r,i):"deleteColumns"===e?s.cVa(r,i):"clear"===e?s.dVa():"setColumnCount"!==e&&"setRowCount"!==e||3!==a&&1!==a||s.eVa()},toJson:function(t,e){var o=this.conditionalFormats,n=e&&e.ignoreStyle;o&&!n&&(t.conditionalFormats=o.toJSON(this))},fromJson:function(t,e,o){var n=o&&o.ignoreStyle;t&&t.conditionalFormats&&!n&&this.conditionalFormats.fromJSON(t.conditionalFormats,this,e,!0)}},T.Worksheet.$n("conditionalFormat",at),T.Workbook.$n("conditionalFormat",{fromJson:function(t,e,o){this.sheets.forEach(function(t){t.conditionalFormats&&t.conditionalFormats.getRules().forEach(function(t){t.S$a()})})},onCultureChanged:function(){Z()}}),(Se=st=y.GeneralComparisonOperators||(y.GeneralComparisonOperators={}))[Se.equalsTo=0]="equalsTo",Se[Se.notEqualsTo=1]="notEqualsTo",Se[Se.greaterThan=2]="greaterThan",Se[Se.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",Se[Se.lessThan=4]="lessThan",Se[Se.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",lt=[9,10,13,14,11,12],(Ae=ut=y.LogicalOperators||(y.LogicalOperators={}))[Ae.or=0]="or",Ae[Ae.and=1]="and",(Te=ct=y.ComparisonOperators||(y.ComparisonOperators={}))[Te.equalsTo=0]="equalsTo",Te[Te.notEqualsTo=1]="notEqualsTo",Te[Te.greaterThan=2]="greaterThan",Te[Te.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",Te[Te.lessThan=4]="lessThan",Te[Te.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",Te[Te.between=6]="between",Te[Te.notBetween=7]="notBetween",(xe=y.TextComparisonOperators||(y.TextComparisonOperators={}))[xe.contains=0]="contains",xe[xe.doesNotContain=1]="doesNotContain",xe[xe.beginsWith=2]="beginsWith",xe[xe.endsWith=3]="endsWith",(we=ht=y.TextCompareType||(y.TextCompareType={}))[we.equalsTo=0]="equalsTo",we[we.notEqualsTo=1]="notEqualsTo",we[we.beginsWith=2]="beginsWith",we[we.doesNotBeginWith=3]="doesNotBeginWith",we[we.endsWith=4]="endsWith",we[we.doesNotEndWith=5]="doesNotEndWith",we[we.contains=6]="contains",we[we.doesNotContain=7]="doesNotContain",(Ce=ft=y.ColorCompareType||(y.ColorCompareType={}))[Ce.backgroundColor=0]="backgroundColor",Ce[Ce.foregroundColor=1]="foregroundColor",(ve=pt=y.CustomValueType||(y.CustomValueType={}))[ve.empty=0]="empty",ve[ve.nonEmpty=1]="nonEmpty",ve[ve.error=2]="error",ve[ve.nonError=3]="nonError",ve[ve.formula=4]="formula",(be=dt=y.DateCompareType||(y.DateCompareType={}))[be.equalsTo=0]="equalsTo",be[be.notEqualsTo=1]="notEqualsTo",be[be.before=2]="before",be[be.beforeEqualsTo=3]="beforeEqualsTo",be[be.after=4]="after",be[be.afterEqualsTo=5]="afterEqualsTo",(ye=gt=y.DateExConditionExpectType||(y.DateExConditionExpectType={}))[ye.dateOccurring=0]="dateOccurring",ye[ye.yearOccurring=1]="yearOccurring",ye[ye.quarterOccurring=2]="quarterOccurring",ye[ye.monthOccurring=3]="monthOccurring",ye[ye.weekOccurring=4]="weekOccurring",ye[ye.dayOccurring=5]="dayOccurring",ye[ye.yearTodate=6]="yearTodate",(me=y.Top10ConditionType||(y.Top10ConditionType={}))[me.top=0]="top",me[me.bottom=1]="bottom",(ge=mt=y.DateOccurringType||(y.DateOccurringType={}))[ge.today=0]="today",ge[ge.yesterday=1]="yesterday",ge[ge.tomorrow=2]="tomorrow",ge[ge.last7Days=3]="last7Days",ge[ge.thisMonth=4]="thisMonth",ge[ge.lastMonth=5]="lastMonth",ge[ge.nextMonth=6]="nextMonth",ge[ge.thisWeek=7]="thisWeek",ge[ge.lastWeek=8]="lastWeek",ge[ge.nextWeek=9]="nextWeek",ge[ge.nextQuarter=10]="nextQuarter",ge[ge.thisQuarter=11]="thisQuarter",ge[ge.lastQuarter=12]="lastQuarter",ge[ge.nextYear=13]="nextYear",ge[ge.thisYear=14]="thisYear",ge[ge.lastYear=15]="lastYear",(de=yt=y.QuarterType||(y.QuarterType={}))[de.quarter1=0]="quarter1",de[de.quarter2=1]="quarter2",de[de.quarter3=2]="quarter3",de[de.quarter4=3]="quarter4",(pe=bt=y.AverageConditionType||(y.AverageConditionType={}))[pe.above=0]="above",pe[pe.below=1]="below",pe[pe.equalOrAbove=2]="equalOrAbove",pe[pe.equalOrBelow=3]="equalOrBelow",pe[pe.above1StdDev=4]="above1StdDev",pe[pe.below1StdDev=5]="below1StdDev",pe[pe.above2StdDev=6]="above2StdDev",pe[pe.below2StdDev=7]="below2StdDev",pe[pe.above3StdDev=8]="above3StdDev",pe[pe.below3StdDev=9]="below3StdDev",(fe=vt=y.ScaleValueType||(y.ScaleValueType={}))[fe.number=0]="number",fe[fe.lowestValue=1]="lowestValue",fe[fe.highestValue=2]="highestValue",fe[fe.percent=3]="percent",fe[fe.percentile=4]="percentile",fe[fe.automin=5]="automin",fe[fe.formula=6]="formula",fe[fe.automax=7]="automax",(he=y.BarDirection||(y.BarDirection={}))[he.leftToRight=0]="leftToRight",he[he.rightToLeft=1]="rightToLeft",(ce=y.DataBarAxisPosition||(y.DataBarAxisPosition={}))[ce.automatic=0]="automatic",ce[ce.cellMidPoint=1]="cellMidPoint",ce[ce.none=2]="none",(ue=Ct=y.IconSetType||(y.IconSetType={}))[ue.threeArrowsColored=0]="threeArrowsColored",ue[ue.threeArrowsGray=1]="threeArrowsGray",ue[ue.threeTriangles=2]="threeTriangles",ue[ue.threeStars=3]="threeStars",ue[ue.threeFlags=4]="threeFlags",ue[ue.threeTrafficLightsUnrimmed=5]="threeTrafficLightsUnrimmed",ue[ue.threeTrafficLightsRimmed=6]="threeTrafficLightsRimmed",ue[ue.threeSigns=7]="threeSigns",ue[ue.threeSymbolsCircled=8]="threeSymbolsCircled",ue[ue.threeSymbolsUncircled=9]="threeSymbolsUncircled",ue[ue.fourArrowsColored=10]="fourArrowsColored",ue[ue.fourArrowsGray=11]="fourArrowsGray",ue[ue.fourRedToBlack=12]="fourRedToBlack",ue[ue.fourRatings=13]="fourRatings",ue[ue.fourTrafficLights=14]="fourTrafficLights",ue[ue.fiveArrowsColored=15]="fiveArrowsColored",ue[ue.fiveArrowsGray=16]="fiveArrowsGray",ue[ue.fiveRatings=17]="fiveRatings",ue[ue.fiveQuarters=18]="fiveQuarters",ue[ue.fiveBoxes=19]="fiveBoxes",ue[ue.noIcons=20]="noIcons",(le=wt=y.IconValueType||(y.IconValueType={}))[le.number=1]="number",le[le.percent=4]="percent",le[le.formula=7]="formula",le[le.percentile=5]="percentile",(se=xt=xt||{})[se.contains=0]="contains",(ae=Tt=y.ConditionType||(y.ConditionType={}))[ae.relationCondition=0]="relationCondition",ae[ae.numberCondition=1]="numberCondition",ae[ae.textCondition=2]="textCondition",ae[ae.colorCondition=3]="colorCondition",ae[ae.formulaCondition=4]="formulaCondition",ae[ae.dateCondition=5]="dateCondition",ae[ae.dateExCondition=6]="dateExCondition",ae[ae.textLengthCondition=7]="textLengthCondition",ae[ae.top10Condition=8]="top10Condition",ae[ae.uniqueCondition=9]="uniqueCondition",ae[ae.averageCondition=10]="averageCondition",ae[ae.cellValueCondition=11]="cellValueCondition",ae[ae.areaCondition=12]="areaCondition",ae[ae.timeCondition=13]="timeCondition",ae[ae.stateCondition=14]="stateCondition",(ie=At=y.RuleType||(y.RuleType={}))[ie.conditionRuleBase=0]="conditionRuleBase",ie[ie.cellValueRule=1]="cellValueRule",ie[ie.specificTextRule=2]="specificTextRule",ie[ie.formulaRule=3]="formulaRule",ie[ie.dateOccurringRule=4]="dateOccurringRule",ie[ie.top10Rule=5]="top10Rule",ie[ie.uniqueRule=6]="uniqueRule",ie[ie.duplicateRule=7]="duplicateRule",ie[ie.averageRule=8]="averageRule",ie[ie.twoScaleRule=10]="twoScaleRule",ie[ie.threeScaleRule=11]="threeScaleRule",ie[ie.dataBarRule=12]="dataBarRule",ie[ie.iconSetRule=13]="iconSetRule",ie[ie.rowStateRule=14]="rowStateRule",ie[ie.columnStateRule=15]="columnStateRule",St=function(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0)},Mt=function(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59,999)},It=function(t,e){t.setDate(e)},Nt=function(t){return t.getDate()},Rt=function(t,e){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()},kt=function(t,e){return Mt(t)<e},Et=function(t,e){return t<e},Dt=function(t,e){return e<St(t)},jt=function(t,e){return e<t},_t=function(t,e){return t.getHours()===e.getHours()&&t.getMinutes()===e.getMinutes()&&t.getSeconds()===e.getSeconds()&&t.getMilliseconds()===e.getMilliseconds()},Ot=function(t,e){return new Date(1899,11,30,t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())<new Date(1899,11,30,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())},Ft=function(t,e){return!Ot(t,e)&&!_t(t,e)},y.$V=function(t,e,o,n,r,i,a,s,l){return new Lt(t,{compareType:e,expected:o,formula:n,customValueType:r,type:i,ranges:a,item1:s,item2:l})},y.Cxb=new P,Pt=["conType","compareType","item1","item2","ignoreBlank","preciseCompareDate","expected","formula","treatNullValueAsZero","integerValue","forceValue2Text","useWildCards","ignoreCase","customValueType","expectTypeId","type","ranges","isPercent","regex"],Oe.prototype.context=function(t){if(1===arguments.length){this.xc=t;var e=this.item1(),o=this.item2();e&&e.context&&e.context(t),o&&o.context&&o.context(t)}return this.xc},Oe.prototype.j_a=function(t){var e=this.item1(),o=this.item2();t?this.q$a=!0:this.p$a=!0,e&&e.j_a(t),o&&o.j_a(t)},Oe.prototype.k_a=function(){var t=this.item1(),e=this.item2();delete this.q$a,delete this.p$a,t&&t.k_a(),e&&e.k_a()},Oe.prototype.initExpression=function(t,e,o){var n,r,i,a,s,l=this.item1(),u=this.item2();l&&l.initExpression&&l.initExpression(),u&&u.initExpression&&u.initExpression(),t=t||this.xc,n=this.Yw,t&&n&&!this.Lf&&(o=this.ranges()?(e=(r=Y(this.ranges())).r,r.c):(e=e||0,o||0),i=t.getCalcService(),a=t.yj(),i&&a&&(s=!1,this.q$a&&(s=!this.p$a),this.Lf=i.parse(a,n,e,o,!1,!0,s)))},Oe.prototype.expression=function(t,e,o,n){var r,i,a;return 1===arguments.length?(this.Lf=t,e=e||this.xc,t?e&&(n=this.ranges()?(o=(r=Y(this.ranges())).r,r.c):(o=o||0,n||0),i=e.getCalcService(),a=e.yj(),i&&a&&(this.Yw=i.unparse(a,t,o,n))):this.Yw=t):this.Lf||this.initExpression(e,o,n),this.Lf},Oe.prototype.getFormulaString=function(t,e,o,n){var r,i,a;return t=t||this.xc,r=this.Lf,i=this.Yw,t&&i?(r||(this.initExpression(t,e,o),r=this.Lf),i&&(r.value&&14===r.value.type||r.value2&&14===r.value2.type)?i:(a=Y(this.ranges()),e=_(e)?a.r:e,o=_(o)?a.c:o,t.getCalcService().unparse(t.yj(),r,e,o,C,!!n))):i},Oe.prototype.formula=function(t,e,o){if("string"!=typeof t){var n=this.item1(),r=this.item2();return 0===o&&n&&n.formula?n.formula(t,e,o):1===o&&r&&r.formula?r.formula(t,e,o):this.getFormulaString(C,t,e)}this.Yw=t,this.Lf=L},Oe.prototype.adjustOffset=function(t,e){var o=this.item1();o&&o.adjustOffset&&o.adjustOffset(t,e),(o=this.item2())&&o.adjustOffset&&o.adjustOffset(t,e),this.offsetRow=t,this.offsetCol=e},Oe.prototype.relationConditionEvaluate=function(n,r,i,o,t){var e,a,s=this;function l(t,e){if(t)return t.ignoreBlank(s.ignoreBlank()),arguments.length<5?function(t,e){if(n&&t&&3===t.conType()){var o=n.getActualStyle(r,i,3,!0);o&&(0===t.RV()?e=o.backColor:1===t.RV()&&(e=o.foreColor))}return e}(t,o):e}function u(t,e){return!_(t)&&t.evaluate(n,r,i,e)}return e=l(s.item1(),o),a=l(s.item2(),t),(u(s.item1(),e)?1:0)+(u(s.item2(),a)?1:0)>s.RV()},Oe.prototype.cellValueConditionEvaluate=function(t,e,o,n){var r=this.getExpected(t,e,o);return!(r!==L||!t||!t.lRa)||this.cellValueConditionCheckCondition(r,n)},Oe.prototype.cellValueConditionCheckCondition=function(t,e){var o,n,r,i,a=0,s=!1,l=this.RV();if(_(e)&&_(t))switch(l){case st.equalsTo:case st.greaterThanOrEqualsTo:case st.lessThanOrEqualsTo:return!0;case st.notEqualsTo:case st.greaterThan:case st.lessThan:default:return!1}if("boolean"==typeof t||"boolean"==typeof e)return _e(l,e,t);if(o={},_(e))this.treatNullValueAsZero()?s=!0:a=e;else{if(typeof e==w&&"number"==typeof t)return _e(l,1,0);"boolean"!=typeof e&&R(e,o)&&(a=o.value,s=!isNaN(a))}return n=0,r=!1,R(t,o)&&(n=o.value,r=!0),i=lt[l],s?r?_e(l,a,n):G(i,e,t):"string"==typeof e?r?G(i,e,n):"string"==typeof t?G(i,e,t):1===l:!!_(e)&&l===st.notEqualsTo},Oe.prototype.numberConditionEvaluate=function(t,e,o,n){var r=this.numberConditionGetExpected(t,e,o);return!(r!==L||!t||!t.lRa)||(this.integerValue()&&(r=isNaN(r)?L:(0<r?M:i)(r)),this.numberConditionCheckCondition(r,n))},Oe.prototype.numberConditionCheckCondition=function(t,e){var o;if((_(e)||""===e)&&this.ignoreBlank())return!0;if(isNaN(e))return!1;if(_(t)){if(this.ignoreBlank())return!0;t=0}try{o=_(e)?0:parseFloat(e)}catch(t){return!1}return!(this.integerValue()&&o-M(o)!=0)&&_e(this.RV(),o,t)},Oe.prototype.numberConditionGetExpected=function(t,e,o){var n;return this.Yw&&0<this.Yw.length&&(n=t.Cf())?n.evaluate(t.yj(),this.expression(L,t),e,o):this.expected()},Oe.prototype.textConditionEvaluate=function(t,e,o,n){var r,i,a,s=this,l=s.compareType(),u=s.ignoreCase();function c(t,e){return s.testTextByCondition(e,t,"^","$",function(){return u?t.toLowerCase()===e.toLowerCase():t===e})}function h(t,e){return s.testTextByCondition(e,t,"^","",function(){return E(e,t,u)})}function f(t,e){return s.testTextByCondition(e,t,"","$",function(){return D(e,t,u)})}function p(t,e){return s.testTextByCondition(e,t,"","",function(){return j(e,t===C||t===L?"":t,u)})}if(!s.forceValue2Text()&&O(n,Date))return l!==ht.beginsWith&&l!==ht.endsWith&&l!==ht.contains&&(l===ht.doesNotBeginWith||l===ht.doesNotEndWith||l===ht.doesNotContain);if(r=_(n)?"":""+n,s.ignoreBlank()&&!r)return!0;if(i=this.getExpected(t,e,o),a=_(i)?"":""+i,s.hasWildcard(a)&&"number"==typeof n)return l===ht.doesNotBeginWith||l===ht.doesNotContain||l===ht.doesNotEndWith||l===ht.notEqualsTo;switch(l){case ht.equalsTo:return c(a,r);case ht.notEqualsTo:return!c(a,r);case ht.beginsWith:return h(a,r);case ht.doesNotBeginWith:return!h(a,r);case ht.endsWith:return f(a,r);case ht.doesNotEndWith:return!f(a,r);case ht.contains:return p(a,r);case ht.doesNotContain:return!p(a,r);default:return!1}},Oe.prototype.hasWildcard=function(t){return-1<t.indexOf("*")||-1<t.indexOf("?")},Oe.prototype.testTextByCondition=function(t,e,o,n,r){var i;return this.useWildCards()?this.regex()?a.qb(this.regex()).test(t):(i=a.ub(e))?(i=o+i+n,this.ignoreCase()?a.sb(i).test(t):a.qb(i).test(t)):r():r()},Oe.prototype.colorConditionEvaluate=function(t,e,o,n){var r,i,a;function s(t){return _(t)||""===t?L:H.ec(t)}if(r=s(this.expected()),_(r)||""===r){if(this.ignoreBlank()||_(r)&&_(n))return!0}else if(i=s(n),(_(i)||""===i)&&t&&t.getDefaultStyle&&(a=t.getDefaultStyle(),this.RV()===ft.backgroundColor?i=a.backColor:this.RV()===ft.foregroundColor&&(i=a.foreColor)),!_(i)&&""!==i)return l.Common.pc.Pka(i,r);return!1},Oe.prototype.formulaConditionEvaluate=function(t,e,o,n){var r,i,a;if(!F)return!1;if(this.customValueType()===pt.formula)return t.yj().xc=e,r=this.getExpected(t,e,o),!(!this.ignoreBlank()||!_(r)&&""!==r)||(i={},!!x.Uh(r,i)&&i.value);switch(a=x.vf,this.customValueType()){case pt.empty:return _(n)||""===n;case pt.nonEmpty:return!_(n)&&""!==n;case pt.error:return a(n);case pt.nonError:return!a(n);default:return!1}},Oe.prototype.formulaConditionGetExpected=function(t,e,o){var n,r,i,a,s,l,u,c,h,f;if(this.Yw&&0<this.Yw.length){if(!(n=t.Cf()))return this.expected();if(r=n._evaluateParsedFormula(t.yj(),this.expression(C,t),b._createCellIdentity(e,o),!0),u=l=s=a=i=void 0,x._isReference(r)){for(i=r.getRowCount(0),a=r.getColumnCount(0),s=[],l=0;l<i;l++)for(s[l]=[],u=0;u<a;u++)s[l][u]=r.getValue(0,l,u);r=s}else if(x.Ca(r)){for(i=r.getRowCount(),a=r.getColumnCount(),s=[],l=0;l<i;l++)for(s[l]=[],u=0;u<a;u++)s[l][u]=r.getValue(l,u);r=s}return O(r,Array)?(i=$(r),a=$(r[0]),1===i&&1===a?r[0][0]:(h=e-(c=function(t,e,o){var n,r;for(n=0;n<t.length;n++)if((r=t[n]).contains(e,o))return r}(this.ranges(),e,o)).row,f=o-c.col,h<i&&f<a?r[h][f]:p.Errors.NotAvailable)):r}return this.expected()},Oe.prototype.dateOrTimeEvaluate=function(t,e,o,n,r,i,a){var s,l,u;if((_(n)||""===n)&&this.ignoreBlank())return!0;if(!O(s=n,Date)){if(this.RV()===dt.notEqualsTo)return!0;if(!_(n))return!1;s=z.Xb(0)}if(l=L,u=this.getExpected(t,e,o),O(u,Date)?l=u:"string"==typeof u?l=z.Qa(u):"number"==typeof u&&(l=z.Xb(u)),_(l))return!!this.ignoreBlank();switch(this.RV()){case dt.equalsTo:return r(l,s);case dt.notEqualsTo:return!r(l,s);case dt.after:return a(l,s);case dt.afterEqualsTo:return a(l,s)||r(l,s);case dt.before:return i(l,s);case dt.beforeEqualsTo:return i(l,s)||r(l,s);default:return!1}},Oe.prototype.dateConditionEvaluate=function(t,e,o,n){var r=this.preciseCompareDate();return this.dateOrTimeEvaluate(t,e,o,n,Rt,r?jt:Dt,r?Et:kt)},Oe.prototype.timeConditionEvaluate=function(t,e,o,n){return this.dateOrTimeEvaluate(t,e,o,n,_t,Ft,Ot)},Oe.prototype.dateExConditionEvaluate=function(t,e,o,n){var r=this.A4(t,e,o);return!_(r)&&this.dateExConditionCheckCondition(r,n)},Oe.prototype.getExConditionDateScope=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_=L,O=L,F=new Date,P=new Date(F.getFullYear(),F.getMonth(),F.getDate(),F.getHours(),F.getMinutes(),F.getSeconds(),F.getMilliseconds());switch(t){case mt.last7Days:It(P,Nt(P)-6),_=St(P),O=Mt(F);break;case mt.yesterday:It(P,Nt(P)-1),_=St(P),O=Mt(P);break;case mt.today:_=St(F),O=Mt(F);break;case mt.tomorrow:It(P,Nt(P)+1),_=St(P),O=Mt(P);break;case mt.lastWeek:It(e=F,Nt(F)-F.getDay()-7),(o=P).setDate(Nt(P)-P.getDay()-1),_=St(e),O=Mt(o);break;case mt.thisWeek:It(n=F,Nt(F)-F.getDay()),It(r=P,Nt(P)-P.getDay()+6),_=St(n),O=Mt(r);break;case mt.nextWeek:It(i=F,Nt(F)-F.getDay()+7),It(a=P,Nt(P)-P.getDay()+13),_=St(i),O=Mt(a);break;case mt.lastMonth:It(s=F,1),s.setMonth(F.getMonth()-1),It(l=P,0),_=St(s),O=Mt(l);break;case mt.thisMonth:It(u=F,1),It(c=P,1),c.setMonth(P.getMonth()+1),It(c,0),_=St(u),O=Mt(c);break;case mt.nextMonth:It(h=F,1),h.setMonth(F.getMonth()+1),It(f=P,1),f.setMonth(P.getMonth()+2),It(f,0),_=St(h),O=Mt(f);break;case mt.nextQuarter:g=(d=(p=F).getMonth())%3,p.setDate(1),p.setMonth(d-g+3),(m=P).setDate(1),m.setMonth(d-g+3+2),y=2===m.getMonth()||11===m.getMonth()?31:30,m.setDate(y),_=St(p),O=Mt(m);break;case mt.thisQuarter:C=(v=(b=F).getMonth())%3,b.setDate(1),b.setMonth(v-C),(w=P).setDate(1),w.setMonth(v-C+2),x=2===w.getMonth()||11===w.getMonth()?31:30,w.setDate(x),_=St(b),O=Mt(w);break;case mt.lastQuarter:S=(A=(T=F).getMonth())%3,T.setDate(1),T.setMonth(A-S-3),(M=P).setDate(1),M.setMonth(A-S-3+2),I=2===M.getMonth()||11===M.getMonth()?31:30,M.setDate(I),_=St(T),O=Mt(M);break;case mt.nextYear:(N=F).setDate(1),N.setFullYear(N.getFullYear()+1),N.setMonth(0),(R=P).setFullYear(R.getFullYear()+1),R.setMonth(11),R.setDate(31),_=St(N),O=Mt(R);break;case mt.thisYear:(k=F).setDate(1),k.setMonth(0),(E=P).setMonth(11),E.setDate(31),_=St(k),O=Mt(E);break;case mt.lastYear:(D=F).setFullYear(D.getFullYear()-1),D.setDate(1),D.setMonth(0),(j=P).setFullYear(j.getFullYear()-1),j.setMonth(11),j.setDate(31),_=St(D),O=Mt(j)}return{from:_,to:O}},Oe.prototype.dateExConditionCheckCondition=function(t,e){var o,n,r,i,a,s,l,u,c,h;if(o=e,this.ignoreBlank()&&(_(o)||""===o))return!0;try{o=x.Wh(o)}catch(t){return!1}if((r=this.expectTypeId())===gt.dateOccurring){if(a=(i=this.getExConditionDateScope(t)).from,s=i.to,!_(a)&&!_(s))return l=y.$V(Tt.dateCondition,dt.afterEqualsTo,a,L),u=y.$V(Tt.dateCondition,dt.beforeEqualsTo,s,L),y.$V(Tt.relationCondition,ut.and,L,L,L,L,L,l,u).evaluate(L,0,0,o)}else if(n=this.A4(L,0,0),!_(n)){if(r===gt.yearOccurring)return n===o.getFullYear();if(r===gt.quarterOccurring)return function(t,e){switch(t){case yt.quarter1:return 0<=e.getMonth()&&e.getMonth()<=2;case yt.quarter2:return 3<=e.getMonth()&&e.getMonth()<=5;case yt.quarter3:return 6<=e.getMonth()&&e.getMonth()<=8;case yt.quarter4:return 9<=e.getMonth()&&e.getMonth()<=11;default:return!1}}(n,o);if(r===gt.monthOccurring)return n===o.getMonth();if(r===gt.weekOccurring)return n===o.getDay();if(r===gt.dayOccurring)return n===Nt(o);if(r===gt.yearTodate)return c=new Date,h=new Date,c.setMonth(0,1),c.setHours(0,0,0,0),h.setHours(23,59,59,59),c<=o&&o<=h}return!1},Oe.prototype.textLengthConditionEvaluate=function(t,e,o,n){var r,i;return!(!_(n)&&""!==n||!this.ignoreBlank())||(r=_(n)?0:(""+n).length,"number"==typeof(i=this.A4(t,e,o))&&_e(this.RV(),r,i))},Oe.prototype.top10ConditionEvaluate=function(t,e,o,n){var r,i,a,s=this;if(_(n)||""===n)return s.ignoreBlank();if(r=s.A4(t,e,o),!_(r)&&(i=void 0,i=s.k$a?(_(s.mxb)&&(s.mxb=s.getTopValues(t,r,s.ranges())),s.mxb):s.getTopValues(t,r,s.ranges()))){a=0;try{a=s.Pa(n)}catch(t){return!1}if(h.Bb(i,a))return!0}return!1},Oe.prototype.A4=function(t,e,o){var n=this.getExpected(t,e,o);return n=parseInt(n,10),isNaN(n)||!isFinite(n)?L:n},Oe.prototype.adjustRange=function(t,e){return Q(t.row,t.col,Math.min(De(t),e.getRowCount()),Math.min(je(t),e.getColumnCount()))},Oe.prototype.getTopValues=function(t,e,o){var n,r,i,a,s,l,u,c,h,f=0===this.type()?1:-1,p=[];if(!o)return p;for(n=this.UV(t,o),r=$(n),u=0;u<r;u++)for(i=this.adjustRange(n[u],t),c=0;c<De(i);c++)for(a=c+i.row,h=0;h<je(i);h++)s=h+i.col,l=this.Pa(t.getValue(a,s)),_(l)||p.push(l);return p.sort(function(t,e){return(e-t)*f}),$(p)>e&&(p=p.slice(0,e)),p},Oe.prototype.Pa=function(t){return("number"==typeof t||O(t,Date))&&F?m(t):L},Oe.prototype.uniqueConditionEvaluate=function(t,e,o,n){var r,i,a,s,l=n;return _(l)||""===l?this.ignoreBlank():(F&&N(l)&&!q(l)&&(l=m(l)),r=this.getExpected(t,e,o),i={},x.Uh(r,i),!_(a=i.value)&&(s=this.duplicatedArrayCached||this.getDuplicated(t,this.ranges()),!_(s)&&h.Bb(s,l)?!0===a:!0!==a))},Oe.prototype.getDuplicated=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p=[],d={},g=this.UV(t,e);if(g)for(o=$(g),n=0;n<o;n++)for(r=g[n],i=De(r=this.adjustRange(r,t)),a=je(r),s=0;s<i;s++)for(l=s+r.row,u=0;u<a;u++)c=u+r.col,h=t.getValue(l,c,3),!_(h)&&F&&N(h)&&!q(h)&&(h=m(h)),(f=d[h])?1===f&&p.push(h):d[h]=1;return p},Oe.prototype.VV=function(t,e){var o,n=t.length;for(o=0;o<n;o++)if(t[o].key===e)return!0;return!1},Oe.prototype.averageConditionEvaluate=function(t,e,o,n){var r,i,a,s,l,u,c,h;if(!F)return!1;if((r=this).ignoreBlank()&&(_(n)||""===n))return!0;if(r.WV(),i=r.k$a?(_(r.mxb)&&(r.mxb=r.getExpected(t,e,o)),r.mxb):r.getExpected(t,e,o),s=R(i,a={})?a.value:NaN,l=L,u=r.TV?r.XV(t,r.TV,e,o):L,_(u)||(l=R(u,a={})?a.value:NaN),N(n)&&(c=m(n),!isNaN(s)))switch(h=isNaN(l),r.type()){case bt.above:return s<c;case bt.below:return c<s;case bt.equalOrAbove:return s<=c;case bt.equalOrBelow:return c<=s;case bt.above1StdDev:return!h&&s+l<c;case bt.below1StdDev:return!h&&c<s-l;case bt.above2StdDev:return!h&&s+2*l<c;case bt.below2StdDev:return!h&&c<s-2*l;case bt.above3StdDev:return!h&&s+3*l<c;case bt.below3StdDev:return!h&&c<s-3*l;default:return!1}return!1},Oe.prototype.WV=function(){this.ranges()&&(this.Lf=this.YV("AVERAGE",this.ranges()),4<=this.type()&&this.type()<=9&&(this.TV=this.YV("STDEV",this.ranges())))},Oe.prototype.YV=function(t,e){var o,n,r,i;if(!F)return L;if(o=f.findGlobalFunction(t)){for(n=[],r=$(e),i=0;i<r;i++)n[i]=et(e[i]);return p.Jh(o,n)}return L},Oe.prototype.averageConditionGetExpected=function(t,e,o){var n=t.Cf();return n?n._evaluateParsedFormula(t.yj(),this.expression(C,t),b._createCellIdentity(e,o),!1):L},Oe.prototype.nxb=function(){var t=this.conType();t!==Tt.averageCondition&&t!==Tt.top10Condition||(this.k$a=!0)},Oe.prototype.oxb=function(){this.k$a=!1,this.mxb=C},Oe.prototype.XV=function(t,e,o,n){var r=t.Cf();return r?r._evaluateParsedFormula(t.yj(),e,b._createCellIdentity(o,n),!1):L},Oe.prototype.ZV=function(t,e){var o,n;for(n=0;n<$(e);n++)o=e[n],O(o,Array)&&0<$(o)?1<$(e)?t.push(o[0]):t.push.apply(t,o):t.push(o)},Oe.prototype.getValidList=function(t,e,o){var n,r,i=[],a=this.getValidListImp(t,e,o);for(n=0,r=$(a);n<r;n++)i.push(a[n].value);return i},Oe.prototype.CIc=function(){return this.Yw&&0<this.Yw.length},Oe.prototype.getValidListImp=function(t,e,o){var n,r,i,a,s,l,u=[];if(this.Yw&&0<this.Yw.length)n=this.getExpected(t,e,o),O(n,Array)?this.ZV(u,n):u.push(n);else if(this.expected()&&0<this.expected().length&&(r=this.expected().replace(/\\,/g,String.fromCharCode(206)).split(",")))for(i=0;i<$(r);i++)a=r[i],_(a)||(s=RegExp(String.fromCharCode(206),"g"),""!==(l=v.trim(a).replace(s,","))&&u.push({text:l,value:l}));return u},Oe.prototype.areaConditionEvaluate=function(t,e,o,n){var r,i,a,s;function l(t,e,o){return O(t,Date)&&O(e,Date)?t.valueOf()===e.valueOf():o||"string"!=typeof t||"string"!=typeof e?t===e:t.toLowerCase()===e.toLowerCase()}if(_(n)||""===n)return!0===this.ignoreBlank();for(r=this.getValidList(t,e,o),i=0;i<$(r);i++){if(a=r[i],_(a)&&_(n))return!0;if(this.Yw){if(l(a,n,!1))return!0}else if(s=t.getActualStyle(e,o,3,!0),l(u.ul(s,a,!0),n,!0))return!0}return!1},Oe.prototype.areaConditionGetExpected=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m=[];if(this.Yw){if(l=s=a=i=r=n=void 0,!(u=t.Cf()))return m;if(c=u._evaluateParsedFormula(t.yj(),this.expression(C,t),b._createCellIdentity(e,o),!0),x._isReference(c))for(n=c.getRowCount(0),r=c.getColumnCount(0),h=c.getRow(0),f=c.getColumn(0),(p=c._source&&c._source.kj)&&(d=p.getRowCount(),g=p.getColumnCount(),n=d<n?S(d-h,0):n,r=g<r?S(g-f,0):r),i=0;i<n;i++)for(m[i]=[],a=0;a<r;a++)s=c.getValue(0,i,a),l=p?p.getText(h+i,f+a):s,m[i][a]={value:s,text:l};else if(x.Ca(c))for(n=c.getRowCount(),r=c.getColumnCount(),i=0;i<n;i++)for(m[i]=[],a=0;a<r;a++)s=c.getValue(i,a),m[i][a]={value:s,text:s}}else m.push({value:this.expected(),text:this.expected()});return m},Oe.prototype.stateConditionEvaluate=function(t,e,o,n){var r=this.expected();return!(_(n)||_(r)||isNaN(n)||isNaN(n))&&0<(n&r)},Oe.prototype.reset=function(){var t=this;switch(t.ignoreBlank(!1),t.preciseCompareDate(!1),t.RV(1),t.item1(L),t.item2(L),t.value1=L,t.value2=L,t.expected(L),t.RV(0),t.integerValue(!1),t.operator=0,t.text="",t.RV(0),t.useWildCards(!0),t.ignoreCase(!1),t.forceValue2Text(!1),t.customValueType(0),t.Lf=L,t.type(0),this.expectTypeId(0),t.ranges(L),t.isPercent(!1),t.regex(L),t.conType()){case Tt.relationCondition:t.ignoreBlank(!1),t.RV(1);break;case Tt.numberCondition:t.RV(0),t.integerValue(!1);break;case Tt.textCondition:t.RV(0),t.useWildCards(!0),t.forceValue2Text(!1);break;case Tt.colorCondition:t.RV(0);break;case Tt.formulaCondition:t.customValueType(0),t.TV=L;break;case Tt.dateCondition:case Tt.timeCondition:t.RV(0);break;case Tt.dateExCondition:t.expectTypeId(0);break;case Tt.textLengthCondition:t.RV(0);break;case Tt.top10Condition:case Tt.averageCondition:t.type(0);break;case Tt.cellValueCondition:t.operator=6}},Oe.prototype.evaluate=function(t,e,o,n){var r=this.conType();return!_(r)&&this[Tt[r]+"Evaluate"](t,e,o,n)},Oe.prototype.getExpectedNormal=function(t,e,o,n,r,i){var a,s=this.Yw,l=this.expected();return s&&(a=t.Cf())?a._evaluateParsedFormula(t.yj(),this.expression(C,t),b._createCellIdentity(e,o),!1,i):l},Oe.prototype.getExpected=function(t,e,o){var n=this;switch(n.conType()){case 2:return n.getExpectedNormal(t,e,o,e-n.offsetRow,o-n.offsetCol,!1);case 5:case 6:case 7:case 9:case 11:case 13:return n.getExpectedNormal(t,e,o,e-n.offsetRow,o-n.offsetCol,!1);case 8:return n.getExpectedNormal(t,e,o,e,o);case 0:return L;case 1:return n.numberConditionGetExpected(t,e,o);case 3:return L;case 4:return n.formulaConditionGetExpected(t,e,o);case 10:return n.averageConditionGetExpected(t,e,o);case 12:return n.areaConditionGetExpected(t,e,o);default:return L}},Oe.prototype.UV=function(t,e){var o,n,r,i=[];for(o=0,n=$(e);o<n;o++)r=t.Tq(e[o]),i.push(r);return i},Oe.prototype.getExpressions=function(){var t=[],e=this;return 0===e.conType()?(e.item1()&&e.item1().getExpressions&&(t=e.item1().getExpressions()),e.item2()&&e.item2().getExpressions&&(t=t.concat(e.item2().getExpressions())),t):(e.Lf||e.initExpression(),e.Lf?[e.Lf]:[])},Oe.prototype.setExpressions=function(t,e){var o,n=this;return e&&e.push({type:"condition",condition:this,expressions:n.getExpressions()}),0===n.conType()?(n.item1()&&n.item1().setExpressions&&(o=n.item1().getExpressions().length,n.item1().setExpressions(t.slice(0,o))),void(n.item2()&&n.item2().setExpressions&&n.item2().setExpressions(t.slice(o)))):void n.expression(t[0])},Oe.prototype.toJSON=function(t){return nt.call(this,t,Pt)},Oe.prototype.fromJSON=function(t,e,o){t&&(rt.call(this,e,Pt,t,o),e&&e.Wu&&e.Wu.useR1C1&&e instanceof d.Worksheet&&(this.context(e),c(this)),this.j_a(!0),this.initExpression(),this.k_a())},Oe.fromSource=function(t){return y.$V(12,L,t,L)},Oe.fromFormula=function(t){return y.$V(12,L,"",t)},Oe.fromDay=function(t){var e=y.$V(6,L,t);return e.expectTypeId(5),e},Oe.fromMonth=function(t){var e=y.$V(6,L,t);return e.expectTypeId(3),e},Oe.fromQuarter=function(t){var e=y.$V(6,L,t);return e.expectTypeId(2),e},Oe.fromWeek=function(t){var e=y.$V(6,L,t);return e.expectTypeId(4),e},Oe.fromYear=function(t){var e=y.$V(6,L,t);return e.expectTypeId(1),e},Lt=Oe,(y.Condition=Lt).prototype.conType=ot("conType",L),Lt.prototype.ranges=ot("ranges",L,function(t){var e=this.item1(),o=this.item2();e&&e.ranges&&e.ranges(t),o&&o.ranges&&o.ranges(t)}),Lt.prototype.ignoreBlank=ot("ignoreBlank",!1),Lt.prototype.preciseCompareDate=ot("preciseCompareDate",!1),Lt.prototype.compareType=ot("compareType",C),Lt.prototype.RV=Lt.prototype.compareType,Lt.prototype.expected=ot("expected",C),Lt.prototype.item1=ot("item1",L),Lt.prototype.item2=ot("item2",L),Lt.prototype.treatNullValueAsZero=ot("treatNullValueAsZero",!1),Lt.prototype.integerValue=ot("integerValue",!1),Lt.prototype.forceValue2Text=ot("forceValue2Text",!1),Lt.prototype.useWildCards=ot("useWildCards",!0),Lt.prototype.regex=ot("regex",L),Lt.prototype.ignoreCase=ot("ignoreCase",!1),Lt.prototype.customValueType=ot("customValueType",C),Lt.prototype.expectTypeId=ot("expectTypeId",0),Lt.prototype.type=ot("type",L),Lt.prototype.isPercent=ot("isPercent",!1),Le.prototype.stopIfTrue=function(t){},Le.prototype.evaluate=function(t,e,o,n){var r,i,a,s;return this.contains(e,o)?(this.initCondition(),r={baseRow:0,baseCol:0},this.getBaseCoordinate(r),this.condition().adjustOffset(e-r.baseRow,o-r.baseCol),i=L,a=x.vf,(s=this.condition().evaluate(t,e,o,n))&&!a(s)&&(i=this.getExpected()||y.Cxb),this.condition().adjustOffset(0,0),i):L},Le.prototype.contains=function(t,e){var o,n,r=this.ranges();if(r)for(o=$(r),n=0;n<o;n++)if(r[n].contains(t,e))return!0;return!1},Le.prototype.createCondition=function(){return this.xyb=!1,null},Le.prototype.initCondition=function(t){var e=this.condition();e||((e=this.createCondition())&&(e.ranges(this.ranges()),this.condition(e)),t&&this.context(t),this.context()&&e&&e.context(this.context()))},Le.prototype.yyb=function(){var t;this.xyb&&((t=this.condition())||(this.initCondition(),t=this.condition()),t&&!t.Lf&&t.initExpression())},Le.prototype.context=function(t){return 1===arguments.length&&(this.xc=t,this.condition()&&this.condition().context(t)),this.xc},Le.prototype.getExpected=function(){return this.style()},Le.prototype.reset=function(){this.ranges(L),this.condition(L),this.style(L),this.stopIfTrue(!1),this.priority(1)},Le.prototype.intersects=function(t,e,o,n){var r,i,a=this.ranges();if(a)for(r=$(a),i=0;i<r;i++)if(a[i].intersect(t,e,o,n))return!0;return!1},Le.prototype.isScaleRule=function(){return!1},Le.prototype.isStateRule=function(){return!1},Le.prototype.getBaseCoordinate=function(t){var e,o,n,r;if(t.baseRow=Number.MAX_VALUE,t.baseCol=Number.MAX_VALUE,this.ranges()&&0<$(this.ranges()))for(e=0;e<$(this.ranges());e++)n=-1===(n=(o=this.ranges()[e]).row)?0:n,r=-1===(r=o.col)?0:r,t.baseRow=I(n,t.baseRow),t.baseCol=I(r,t.baseCol);else t.baseRow=0,t.baseCol=0},Le.prototype.XXc=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p=!1;if(this.yyb(),n=this.ranges())for(r=$(n),i=0;i<r;i++)s=(a=n[i]).row,l=De(a),u=a.col,c=je(a),h=s===t.row&&l===t.rowCount&&t.col<=u&&c<=t.colCount,f=s===e.row&&l===e.rowCount&&e.col<=u&&c<=e.colCount,(h||f)&&(n[i]=Q(s,u,l+o,c),p=!0);return p},Le.prototype._V=function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S=o?e:0,M=o?0:e;if(this.yyb(),i=this.ranges()){for(a=[],s=$(i),l=0;l<s;l++)if(u=i[l],c=o?u.row:u.col,h=(o?De:je)(u),-1!==c){if(n&&0<n.length){for(f=!1,p=0,d=n.length;p<d;p++)if((g=n[p])&&(m=!o&&g.col===t&&g.col===u.col&&g.colCount-e===u.colCount,y=!o&&g.col===t&&g.row===u.row&&g.rowCount===u.rowCount&&u.col>=g.col&&u.col+u.colCount<=g.col+g.colCount,b=o&&g.row===t&&g.row===u.row&&g.rowCount-e===u.rowCount,m||y||b)){i[l]=Q(u.row,u.col,De(u)+S,je(u)+M),f=!0;break}if(f)break}if(v=u,C=r&&n&&n[0]){if((w=o?Fe(u,C.col,C.col+C.colCount-1):Pe(u,C.row,C.row+C.rowCount-1))[0]&&a.push(w[0]),w[2]&&a.push(w[2]),!w[1])continue;v=w[1]}t<=c?i[l]=Q(v.row+S,v.col+M,De(v),je(v)):t<=c+h&&(i[l]=Q(v.row,v.col,De(v)+S,je(v)+M))}for(x=0,T=a;x<T.length;x++)A=T[x],i.push(A)}},Le.prototype.rI=function(t,e,o,n){this._V(t,e,!0,o,n)},Le.prototype.tI=function(t,e,o,n){this._V(t,e,!1,o,n)},Le.prototype.aW=function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T=o?t:0,A=o?0:t,S=o?e:0,M=o?0:e;if(this.yyb(),i=this.ranges()){for(a=[],s=[],l=$(i),u=0;u<l;u++)if(c=i[u],h=o?c.row:c.col,f=(o?De:je)(c),-1!==h){if(p=c,d=r&&n&&n[0]){if((g=o?Fe(c,d.col,d.col+d.colCount-1):Pe(c,d.row,d.row+d.rowCount-1))[0]&&a.push(g[0]),g[2]&&a.push(g[2]),!g[1])continue;p=g[1]}t<h?h+f<=t+e?s.push(p):i[u]=Q(p.row-S,p.col-M,De(p),je(p)):t<h+f&&(m=Q(p.row,p.col,De(p)-I(p.row+De(p)-T,S),je(p)-I(p.col+je(p)-A,M)),0===je(m)||0===De(m)?s.push(p):i[u]=m)}for(y=0,b=a;y<b.length;y++)v=b[y],i.push(v);for(C=$(s),w=0;w<C;w++)x=s[w],W(i,x)}},Le.prototype.GR=function(t,e,o,n){this.aW(t,e,!0,o,n)},Le.prototype.HR=function(t,e,o,n){this.aW(t,e,!1,o,n)},Le.prototype.toJSON=function(t){return nt.call(this,t)},Le.prototype.fromJSON=function(t,e,o){t&&(rt.call(this,e,L,t,o),this.initCondition(e))},Le.prototype.S$a=function(){var t=this.condition();t&&c(t)},Le.prototype.iW=function(){var t,e,o=this.cW,n=this.ranges();if(!o)return this.cW=qe(n),!1;if($(o)!==(t=$(n)))return!0;for(e=0;e<t;e++)if(!o[e].equals(n[e]))return!0;return!1},Ht=Le,(Bt=(y.ConditionRuleBase=Ht).prototype).ruleType=ot("ruleType",L),Bt.ranges=ot("ranges",L,function(t){var e,o=this.condition();o&&o.ranges()&&((e=o.xc)&&e._modelManager.YUa(),o.ranges(t))}),Bt.condition=ot("condition",L),Bt.style=ot("style",L),Bt.priority=ot("priority",1),Bt.stopIfTrue=ot("stopIfTrue",!1),Vt=["ruleType","style","operator","text","formula","type","rank","priority","stopIfTrue","ranges"],Ee(He,Me=Ht),He.prototype.value1=function(t,e){var o,n;return 1!==arguments.length?(o=this.condition())&&(n=o.formula(t,e,0))&&0<n.length?"="+k(v.trim(""+n),"="):this._Qa:void(this._Qa=t)},He.prototype.value2=function(t,e){var o,n;return 1!==arguments.length?(o=this.condition())&&(n=o.formula(t,e,1))&&0<n.length?"="+k(v.trim(""+n),"="):this.aRa:void(this.aRa=t)},He.prototype.formula=function(t,e){var o=this.condition();return"string"!=typeof t?o&&o.formula(t,e)||this.Yw:(this.Yw=t,void(o&&o.formula(t)))},He.prototype.cellValueRuleCreateCondition=function(){var t,e,o,n,r,i,a,s=this.value1(),l=this.value2(),u=this.ranges(),c=this.bW(s)?k(s,"="):L,h=this.bW(l)?k(l,"="):L,f=this.operator();return f===ct.between?((t=y.$V(Tt.cellValueCondition,3,s,c,C,C,u)).treatNullValueAsZero(!0),(e=y.$V(Tt.cellValueCondition,5,l,h,C,C,u)).treatNullValueAsZero(!0),r=y.$V(Tt.relationCondition,1,L,L,L,L,u,t,e),(o=y.$V(Tt.cellValueCondition,5,s,c,C,C,u)).treatNullValueAsZero(!0),(n=y.$V(Tt.cellValueCondition,3,l,h,C,C,u)).treatNullValueAsZero(!0),i=y.$V(Tt.relationCondition,1,L,L,L,L,u,o,n),y.$V(Tt.relationCondition,0,L,L,L,L,u,r,i)):f===ct.notBetween?((t=y.$V(Tt.cellValueCondition,4,s,c,C,C,u)).treatNullValueAsZero(!0),e=y.$V(Tt.cellValueCondition,2,l,h,C,C,u),t.treatNullValueAsZero(!0),r=y.$V(Tt.relationCondition,0,L,L,L,L,u,t,e),(o=y.$V(Tt.cellValueCondition,2,s,c,C,C,u)).treatNullValueAsZero(!0),(n=y.$V(Tt.cellValueCondition,4,l,h,C,C,u)).treatNullValueAsZero(!0),i=y.$V(Tt.relationCondition,0,L,L,L,L,u,o,n),y.$V(Tt.relationCondition,1,L,L,L,L,u,r,i)):((a=y.$V(11,f,s,c,C,C,u)).treatNullValueAsZero(!0),a)},He.prototype.bW=function(t){return!_(t)&&"="===t[0]},He.prototype.specificTextRuleCreateCondition=function(){var t,e,o,n,r=this.operator();switch(r){case 2:t=2;break;case 3:t=4;break;case 0:t=6;break;case 1:t=7;break;default:t=0}return e=this.text(),o=L,e&&"="===e[0]&&(o=e),(n=y.$V(2,t,e,o,C,C,this.ranges())).ignoreCase(!0),n.useWildCards(2!==r&&3!==r),n},He.prototype.formulaRuleCreateCondition=function(){var t=this.ranges();return y.$V(4,L,L,this.Yw,4,L,t)},He.prototype.dateOccurringRuleCreateCondition=function(){return y.$V(6,L,this.type(),L,L,C,this.ranges())},He.prototype.top10RuleCreateCondition=function(){return y.$V(8,L,this.rank(),L,L,this.type(),this.ranges())},He.prototype.uniqueRuleCreateCondition=function(){return y.$V(9,L,!1,L,L,L,this.ranges())},He.prototype.duplicateRuleCreateCondition=function(){return y.$V(9,L,!0,L,L,L,this.ranges())},He.prototype.averageRuleCreateCondition=function(){return y.$V(10,L,L,L,L,this.type(),this.ranges())},He.prototype.createCondition=function(){return this[At[this.ruleType()]+"CreateCondition"]()},He.prototype.reset=function(){var t=this;switch(t.ranges(L),t.condition(L),t.style(L),t.stopIfTrue(!1),t.priority(1),t.operator(6),t.value1(L),t.value2(L),t.text(""),t.formula(L),t.type(0),t.rank(10),t.ruleType()){case 1:t.operator(6);break;case 2:t.operator(0);break;case 4:t.style(L);break;case 5:t.type(0),t.rank(10);break;case 8:t.type(0)}},He.prototype.evaluate=function(t,e,o,n){return this.jW(t),Me.prototype.evaluate.call(this,t,e,o,n)},He.prototype.jW=function(t){var e;this.initCondition(),9===(e=this.condition()).conType()&&(this.iW()&&(this.Nm(),this.cW=qe(this.ranges())),!1===this.cached&&(e.duplicatedArrayCached=e.getDuplicated(t,this.ranges()),this.cached=!0))},He.prototype.Nm=function(){this.cached=!1},He.prototype.rI=function(t,e,o,n){Me.prototype.rI.call(this,t,e,o,n),this.Nm()},He.prototype.tI=function(t,e,o,n){Me.prototype.tI.call(this,t,e,o,n),this.Nm()},He.prototype.GR=function(t,e,o,n){Me.prototype.GR.call(this,t,e,o,n),this.Nm()},He.prototype.HR=function(t,e,o,n){Me.prototype.HR.call(this,t,e,o,n),this.Nm()},He.prototype.toJSON=function(t){var e,o,n,r,i,a,s=this;return _(s.condition())&&this.initCondition(),e=nt.call(s,t,Vt),o=s.value1(),i=e.ruleType,a=e.operator,i!==At.cellValueRule||a!==ct.between&&a!==ct.notBetween||(n=s.value2()),r=t&&t.parent&&1===t.parent.options.referenceStyle,_(o)||(s.bW(o)&&r&&(o=Be(t,s,o,r)),e.value1=o),_(n)||(s.bW(n)&&r&&(n=Be(t,s,n,r)),e.value2=n),s.ruleType()===At.conditionRuleBase&&(e.condition=s.condition().toJSON()),e},He.prototype.fromJSON=function(t,e,o){var n=Vt;_(t.condition)||(n=Vt.concat(["condition"])),rt.call(this,e,n,t,o),_(t.value1)||this.value1(t.value1),_(t.value2)||this.value2(t.value2),this.initCondition(e)},zt=He,y.NormalConditionRule=zt,Wt={operator:ot("operator",L),text:ot("text",L),type:ot("type",L),rank:ot("rank",L),priority:ot("priority",1)},v.extend(zt.prototype,Wt),Gt=function(t,e){this.type=t,this.value=e},y.ScaleValue=Gt,Ut=["ruleType","ranges","minType","minValue","minColor","maxType","maxValue","maxColor","midType","midValue","midColor","priority"],Ee(We,Re=Ht),We.prototype.stopIfTrue=function(t){return!1},We.prototype.isScaleRule=function(){return!0},We.prototype.createCondition=function(){return L},We.prototype.fW=function(t){var e=y.$V(8,L,L,L,L,1).getTopValues(t,1,this.ranges());return 0<$(e)?e[0]:L},We.prototype.gW=function(t){var e=y.$V(8,L,L,L,L,0).getTopValues(t,1,this.ranges());return 0<$(e)?e[0]:L},We.prototype.jW=function(t){var e=this;e.iW()&&(e.Nm(),e.cW=qe(e.ranges())),!1===e.cached&&(e.lowestValueCached=e.fW(t),e.highestValueCached=e.gW(t),e.cached=!0)},We.prototype.Nm=function(){this.lowestValueCached=L,this.highestValueCached=L,this.zyb={},this.cached=!1},We.prototype.kW=function(t,e,o,n){var r,i;return n&&(r=t.Cf())?(i=r.parse(t.yj(),n,e,o),r._evaluateParsedFormula(t.yj(),i,b._createCellIdentity(e,o),!1)):L},We.prototype.bW=function(t){return t&&"="===t[0]},We.prototype.lW=function(t){return _(t)||""===t?L:"="===t[0]?t.substr(1):t},We.prototype.mW=function(t,e,o,n){if(this.bW(n))return this.kW(t,e,o,this.lW(""+n));var r={};return R(n,r)?r.value:NaN},We.prototype.dW=function(t){return this.jW(t),this.highestValueCached},We.prototype.eW=function(t){return this.jW(t),this.lowestValueCached},We.prototype.nW=function(t,e,o,n){var r,i,a=this.mW(t,e,o,n);return!isNaN(a)&&0<=a&&a<=100&&(r=this.eW(t),i=this.dW(t),void 0!==r&&r!==L&&void 0!==i&&i!==L)?r+(i-r)*a/100:L},We.prototype.oW=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m=this.zyb;if(void 0!==m[n])return m[n];if(r=this.mW(t,e,o,n),!isNaN(r)&&0<=r&&r<=100){for(i=0,a=this.ranges(),s=$(a),l=0;l<s;l++)u=this.YV("PERCENTILE",[t.Tq(a[l]),r/100]),c=t.Cf(),h=t.yj(),f=c.unparse(h,u,e,o),p=c.parse(h,f,e,o),d=c._evaluateParsedFormula(h,p,b._createCellIdentity(e,o),!1),i+=R(d,g={})?g.value:0;return m[n]=i/s,m[n]}return m[n]=L,m[n]},We.prototype.pW=function(t,e,o,n,r){var i,a;switch(n){case vt.formula:return this.bW(r)||(r="="+r),this.mW(t,e,o,r);case vt.highestValue:return this.dW(t);case vt.lowestValue:return this.eW(t);case vt.number:return this.mW(t,e,o,r);case vt.percent:return this.nW(t,e,o,r);case vt.percentile:return this.oW(t,e,o,r);case vt.automax:return(i=this.dW(t))<0?0:i;case vt.automin:return 0<(a=this.eW(t))?0:a;default:return L}},We.prototype.qW=function(t,e,o){return t===e&&t===o?1:t<=e?0:o<=t?1:(t-e)/(o-e)},We.prototype.rW=function(t,e,o){var n,r,i,a,s,l;return 0<=t&&t<=1?(n=H.ec(e),r=H.ec(o),i=n.a*(1-t)+r.a*t,a=n.r*(1-t)+r.r*t,s=n.g*(1-t)+r.g*t,l=n.b*(1-t)+r.b*t,B(parseFloat(i/255+""),parseInt(a+"",10),parseInt(s+"",10),parseInt(l+"",10))):L},We.prototype.YV=function(t,e){var o,n,r,i;if(!F)return L;if(o=f.findGlobalFunction(t)){for(n=[],r=$(e),i=0;i<r;i++)n[i]=et(e[i]);return p.Jh(o,n)}return L},We.prototype.rI=function(t,e,o,n){Re.prototype.rI.call(this,t,e,o,n),this.Nm()},We.prototype.tI=function(t,e,o,n){Re.prototype.tI.call(this,t,e,o,n),this.Nm()},We.prototype.GR=function(t,e,o,n){Re.prototype.GR.call(this,t,e,o,n),this.Nm()},We.prototype.HR=function(t,e,o,n){Re.prototype.HR.call(this,t,e,o,n),this.Nm()},We.prototype.scaleEvaluate=function(t,e,o,n){var r,i,a,s,l=this;if(l.jW(t),l.contains(e,o)){if(_(n))return L;try{if(r=m(n),i=l.pW(t,e,o,l.minType(),l.minValue()),a=l.pW(t,e,o,l.midType(),l.midValue()),(s=l.pW(t,e,o,l.maxType(),l.maxValue()))<i)return L;if(isNaN(a)){if(!isNaN(i)&&!isNaN(s))return l.qW(r,i,s)}else if(!isNaN(i)&&!isNaN(s))return r<i?0:s<=r?2:i<=r&&r<=a?l.qW(r,i,a):1+l.qW(r,i,s)}catch(t){return L}}return L},We.prototype.twoScaleRuleEvaluate=function(t,e,o,n){var r,i,a,s,l,u;if(!_(n)){if(r={},i=N(n)&&R(n,r)?r.value:NaN,isNaN(i))return L;if(s=(a=this).pW(t,e,o,a.minType(),a.minValue()),l=a.pW(t,e,o,a.maxType(),a.maxValue()),!_(s)&&!_(l))return u=a.qW(i,s,l),a.rW(u,a.minColor(),a.maxColor())}return L},We.prototype.threeScaleRuleEvaluate=function(t,e,o,n){var r,i,a,s,l,u,c=this;if(c.lh=t,!_(n)){if(r={},i=N(n)&&R(n,r)?r.value:NaN,isNaN(i))return L;if(a=c.pW(t,e,o,c.minType(),c.minValue()),s=c.pW(t,e,o,c.midType(),c.midValue()),l=c.pW(t,e,o,c.maxType(),c.maxValue()),!_(a)&&!_(l)&&!_(s))return u=void 0,l<a?L:i<=a||a===l?l<=i?c.maxColor():c.minColor():l<=i?c.maxColor():i<=s?(u=c.qW(i,a,s),c.rW(u,c.minColor(),c.midColor())):(u=c.qW(i,s,l),c.rW(u,c.midColor(),c.maxColor()))}return L},We.prototype.evaluate=function(t,e,o,n){return this[At[this.ruleType()]+"Evaluate"](t,e,o,n)},We.prototype.ad=function(){var t=this;t.minValue(L),t.minType(1),t.midValue(50),t.midType(4),t.maxValue(L),t.maxType(2),10===t.ruleType()&&(t.minColor(B(0,255,255,255)),t.maxColor(B(255,99,190,123))),11===t.ruleType()&&(t.midValue(50),t.midType(4),t.minColor(B(255,248,105,107)),t.midColor(B(255,255,235,132)),t.maxColor(B(255,99,190,123)))},We.prototype.reset=function(){this.ranges(L),this.condition(L),this.style(L),this.ad(),this.lh=L,this.stopIfTrue(!1),this.priority(1)},We.prototype.toJSON=function(t){return nt.call(this,t,Ut)},We.prototype.fromJSON=function(t,e,o){rt.call(this,e,Ut,t,o),this.initCondition(e)},Jt=We,y.ScaleRule=Jt,Zt={minValue:ot("minValue",L),minType:ot("minType",5),minColor:ot("minColor",L),midValue:ot("midValue",50,L,function(t){if(this.lh){if(2===this.midType())return this.dW(this.lh);if(1===this.midType())return this.eW(this.lh)}return t}),midType:ot("midType",L),midColor:ot("midColor",L),maxType:ot("maxType",7),maxValue:ot("maxValue",L),maxColor:ot("maxColor",L)},v.extend(Jt.prototype,Zt),qt=["ruleType","ranges","gradient","color","showBorder","borderColor","dataBarDirection","negativeFillColor","useNegativeFillColor","negativeBorderColor","useNegativeBorderColor","axisPosition","axisColor","showBarOnly","minType","minValue","maxType","maxValue","priority"],Ee(ze,Ne=Jt),ze.prototype.ad=function(t){var e=this;e.gradient(!0),e.color(t),e.showBorder(!1),e.borderColor("black"),e.dataBarDirection(0),e.negativeFillColor("red"),e.useNegativeFillColor(!0),e.negativeBorderColor("black"),e.useNegativeBorderColor(!1),e.axisPosition(0),e.axisColor("black"),e.showBarOnly(!1)},ze.prototype.reset=function(){var t=this;t.ranges(L),t.condition(L),t.style(L),t.ad(B(255,99,142,198)),t.stopIfTrue(!1),t.priority(1),t.minValue(L),t.minType(5),t.midValue(L),t.midType(L),t.maxValue(L),t.maxType(7),t.minColor(L),t.midColor(L),t.maxColor(L)},ze.prototype.qXc=function(t,e,o,n){var r,i,a,s,l=n?this.maxType():this.minType(),u=n?this.maxValue():this.minValue();if(6!==l&&4!==l)return this.pW(t,e,o,l,u);for(i=0;i<$(this.ranges());i++)if(this.ranges()[i].intersect(e,-1,1,-1)&&(r=this.ranges()[i]))return a=-1===(a=r.row)?0:a,s=-1===(s=r.col)?0:s,this.pW(t,a,s,l,u)},ze.prototype.tW=function(t,e,o){return o<=t&&e<t?[1,0]:t<=e&&t<o?[0,0]:o===e?[.5,0]:[(t-e)/(o-e),0]},ze.prototype.uW=function(t,e,o){var n,r,i=.5,a=A(o-e);return 0<o&&0<=e?o===e||o<=t?[.5,i]:t<=e?[e/o*.5,i]:[.5*A(t/o),i]:0<o&&e<0?(n=o>A(e)?.5:o/a,r=o>A(e)?e/a:-.5,0<t?o<=t?[n,i]:[t/o*n,i]:t<0?t<=e?[r,i]:[t/e*r,i]:[0,i]):o<=0&&e<0?o===e?[-.5,i]:o<=t?[-o/e*.5,i]:t<=e?[-.5,i]:[-t/e*.5,i]:0===o&&0===e?[0,i]:[i=-1,i]},ze.prototype.vW=function(t,e,o){var n,r,i,a=-1,s=A(e),l=A(o),u=A(o-e),c=e<0?-1:1;return 0<o&&0<=e||o<=0&&e<0?(n=S(s,l),r=I(s,l),a=e<0?1:0,(i=A(t))<=r&&i<n?[0,a]:n<=i&&r<i?[c,a]:r===n?[.5*c,a]:[c*(A(t)-r)/u,a]):0<o&&e<0?(a=A(e)/u,0===t?[0,a]:o<=t?[1-a,a]:[S(t,e)/u,a]):0===o&&0===e?(a=.5,0===t?[0,a]:[.5*c,a]):[-1,a]},ze.prototype.wW=function(t,e,o){return 0===this.axisPosition()?this.vW(t,e,o):1===this.axisPosition()?this.uW(t,e,o):this.tW(t,e,o)},ze.prototype.evaluate=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g;if(!_(n)){if(r={},i=N(n,!0)&&R(n,r)?r.value:NaN,isNaN(i))return L;if(s=(a=this).qXc(t,e,o,!1),l=a.qXc(t,e,o,!0),O(s,Date)&&(s=z.Ra(s)),O(l,Date)&&(l=z.Ra(l)),!_(s)&&!_(l))return l<s&&(u=l,l=s,s=u),c=void 0,!(h=a.wW(i,s,l))||$(h)<2?L:(f=h[0],c=h[1],p=i<0&&a.useNegativeFillColor()?a.negativeFillColor():a.color(),d=i<0&&a.useNegativeBorderColor()?a.negativeBorderColor():a.borderColor(),g=a.axisColor(),p=U.Om(t,p),d=U.Om(t,d),g=U.Om(t,g),{fillColor:p,borderColor:d,showBorder:a.showBorder(),axisColor:g,isGradient:a.gradient(),direction:a.dataBarDirection(),axisLocation:c,scale:f,showBarOnly:a.showBarOnly()})}return L},ze.prototype.toJSON=function(t){return nt.call(this,t,qt)},ze.prototype.fromJSON=function(t,e,o){rt.call(this,e,qt,t,o),this.initCondition(e)},ze.paintDataBar=function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y,b=new T.Rect(o+2,n+2,r-4,i-4),v=b.x,C=b.y,w=M(A(b.width*e.scale)),x=b.height;if(0===e.axisLocation)e.scale<=0&&(w=0);else if(1===e.axisLocation)e.scale<0?v=v+b.width-w:w=0;else{for(a=M(b.width*e.axisLocation+v)+.5,s=b.y,l=i-2,t.lineWidth=1,t.strokeStyle=e.axisColor,t.beginPath(),u=0;u<=l;u+=2)1===e.direction?(t.moveTo(2*o+r-a,s+u),t.lineTo(2*o+r-a,s+u+1)):(t.moveTo(a,s+u),t.lineTo(a,s+u+1));t.stroke(),0<e.scale?v=a+1:e.scale<0?v=a-w:w=0}e.showBorder&&(v=M(v)+.5,--w,C+=.5,--x),h=(c=v)+w,1===e.direction&&(c=2*o+r-v-w,h=2*o+r-v),0<=w&&0<=x&&(f=e.fillColor,e.isGradient&&(f=t.createLinearGradient(c,C,h,C),p=H.ec(e.fillColor),d=B(p.a,M(229.5+p.r*(1-.9)),M(229.5+p.g*(1-.9)),M(229.5+p.b*(1-.9))),g=e.scale<0?1-.9:.9,m=e.fillColor,y=e.scale<0?1:0,1===e.direction?(f.addColorStop(g,m),f.addColorStop(y,d)):(f.addColorStop(g,d),f.addColorStop(y,m))),t.fillStyle=f,t.fillRect(c,C,w,x),e.showBorder&&0<w&&0<x&&(t.strokeStyle=e.borderColor,t.strokeRect(c,C,w,x)))},Kt=ze,y.DataBarRule=Kt,Yt={gradient:ot("gradient",!0),color:ot("color",L),showBorder:ot("showBorder",!1),borderColor:ot("borderColor","black"),dataBarDirection:ot("dataBarDirection",0),negativeFillColor:ot("negativeFillColor","red"),useNegativeFillColor:ot("useNegativeFillColor",!0),negativeBorderColor:ot("negativeBorderColor","black"),useNegativeBorderColor:ot("useNegativeBorderColor",!1),axisPosition:ot("axisPosition",0),axisColor:ot("axisColor","black"),showBarOnly:ot("showBarOnly",!1)},v.extend(Kt.prototype,Yt),Qt=function(t,e,o){this.isGreaterThanOrEqualTo=t,this.iconValueType=e,this.iconValue=o},y.IconCriterion=Qt,Xt=["ruleType","ranges","iconSetType","iconCriteria","showIconOnly","reverseIconOrder","priority","icons"],Ee(Ve,Ie=Jt),Ve.prototype.xW=function(t){var e=this;e.iconSetType(t,!1),e.iconSetType()>=Ct.threeArrowsColored&&e.iconSetType()<=Ct.threeSymbolsUncircled?(e.NV=[],e.NV[0]=new Qt(!0,wt.percent,33),e.NV[1]=new Qt(!0,wt.percent,67),e.CZa=[],e.CZa[0]={iconSetType:t,iconIndex:0},e.CZa[1]={iconSetType:t,iconIndex:1},e.CZa[2]={iconSetType:t,iconIndex:2}):e.iconSetType()>=Ct.fourArrowsColored&&e.iconSetType()<=Ct.fourTrafficLights?(e.NV=[],e.NV[0]=new Qt(!0,wt.percent,25),e.NV[1]=new Qt(!0,wt.percent,50),e.NV[2]=new Qt(!0,wt.percent,75),e.CZa=[],e.CZa[0]={iconSetType:t,iconIndex:0},e.CZa[1]={iconSetType:t,iconIndex:1},e.CZa[2]={iconSetType:t,iconIndex:2},e.CZa[3]={iconSetType:t,iconIndex:3}):e.iconSetType()>=Ct.fiveArrowsColored&&e.iconSetType()<=Ct.fiveBoxes?(e.NV=[],e.NV[0]=new Qt(!0,wt.percent,20),e.NV[1]=new Qt(!0,wt.percent,40),e.NV[2]=new Qt(!0,wt.percent,60),e.NV[3]=new Qt(!0,wt.percent,80),e.CZa=[],e.CZa[0]={iconSetType:t,iconIndex:0},e.CZa[1]={iconSetType:t,iconIndex:1},e.CZa[2]={iconSetType:t,iconIndex:2},e.CZa[3]={iconSetType:t,iconIndex:3},e.CZa[4]={iconSetType:t,iconIndex:4}):e.iconSetType()>Ct.fiveBoxes&&(e.NV=[],e.CZa=[])},Ve.prototype.ad=function(t){this.showIconOnly(!1),this.reverseIconOrder(!1),this.xW(t)},Ve.prototype.yW=function(t){var e=$(this.NV)+1;return this.reverseIconOrder()&&2<e?e-1-t:t},Ve.prototype.pW=function(t,e,o,n){var r=this.NV[n];if(r)switch(r.iconValueType){case wt.formula:case wt.number:return this.mW(t,e,o,r.iconValue);case wt.percent:return this.nW(t,e,o,r.iconValue);case wt.percentile:return this.oW(t,e,o,r.iconValue);default:return L}},Ve.prototype.evaluate=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m=n;if(_(m))return L;if(r={},i=N(n,!0)&&"boolean"!=typeof m&&R(n,r)?r.value:NaN,isNaN(i))return L;if(a=0,s=this.iconSetType(),l=this.NV,Ct.fiveArrowsColored<=s?a=5:Ct.fourArrowsColored<=s?a=4:Ct.threeArrowsColored<=s&&(a=3),!l)return 0;for(c=0,h=a-1;0<h;h--)if(h<$(l)+1&&(u=l[h-1],!_(u&&u.iconValue)&&(f=this.pW(t,e,o,h-1),!_(f)&&(p=u.isGreaterThanOrEqualTo?f<=i:f<i,i<Number.MAX_VALUE&&p)))){c=h;break}return d=this.yW(c),(g=this.CZa)?{iconSetType:g[d]?g[d].iconSetType:Ct.noIcons,iconIndex:g[d]?g[d].iconIndex:0,showIconOnly:this.showIconOnly()}:{iconSetType:Ct.noIcons,iconIndex:0,showIconOnly:this.showIconOnly()}},Ve.prototype.reset=function(){var t=this;t.ranges(L),t.condition(L),t.style(L),t.showIconOnly(!1),t.reverseIconOrder(!1),t.iconSetType(0,L),t.NV=L,t.stopIfTrue(!1),t.priority(1),t.minColor(L),t.minValue(L),t.minType(5),t.midColor(L),t.midValue(L),t.midType(L),t.maxColor(L),t.maxValue(L),t.maxType(7),t.CZa=L},Ve.prototype.icons=function(t){return 1===arguments.length&&(this.CZa=t),this.CZa},Ve.prototype.iconCriteria=function(){return this.NV},Ve.prototype.toJSON=function(t){return nt.call(this,t,Xt)},Ve.prototype.fromJSON=function(t,e,o){rt.call(this,e,Xt,t,o),this.initCondition(e)},Ve.getIcon=function(t,e){return L},Ve.Pdc=function(t,e,o,n,r,i,a){if(a.ko(e)){var s=a.lo(e);t.drawImage(s,o,n,r,i)}else a.fo(e)},Ve.paintIconSet=function(t,e,o,n,r,i,a,s,l,u){var c,h,f=d.To.No(a.font,1).fontSize,p=o+2;if(e.showIconOnly&&(1===a.hAlign?p=o+r/2-f/2:2===a.hAlign&&(p=o+r-2-f-2)),c=1===a.vAlign?n+i/2-f/2:2===a.vAlign?n+i-2-s/2-f/2:n+2+s/2-f/2,e.iconSetType!==Ct.noIcons)if((h=Ve.getIcon(e.iconSetType,e.iconIndex))&&"string"===v.getType(h)&&u)try{Ve.Pdc(t,h,p,c,f,f,u)}catch(t){}else!function(t,e,o,n,r,i,a,s,l){var u=Math.round;switch(t.lineWidth=1,t.rect(i,a,s,l),o=u(++o),n=u(n),t.clip(),e.iconSetType){case 10:case 15:case 1:case 11:case 16:case 0:g.drawArrows(t,e.iconSetType,e.iconIndex,o,n,r);break;case 2:g.drawIconTypeIsTwo(t,e.iconSetType,e.iconIndex,o,n,r);break;case 3:g.drawStar(t,e.iconSetType,e.iconIndex,o,n,r);break;case 14:case 12:case 5:g.drawCircle(t,e.iconSetType,e.iconIndex,o,n,r);break;case 4:g.drawFlag(t,e.iconSetType,e.iconIndex,o,n,r);break;case 6:g.drawTrafficLight(t,e.iconSetType,e.iconIndex,o,n,r);break;case 7:g.drawIconTypeIsSen(t,e.iconSetType,e.iconIndex,o,n,r);break;case 8:g.drawIconTypeIsEight(t,e.iconSetType,e.iconIndex,o,n,r);break;case 9:g.drawIconTypeIsNine(t,e.iconSetType,e.iconIndex,o,n,r);break;case 18:g.drawSector(t,e.iconSetType,e.iconIndex,o,n,r);break;case 17:case 13:g.drawSignal(t,e.iconSetType,e.iconIndex,o,n,r);break;case 19:g.drawMagicCube(t,e.iconSetType,e.iconIndex,o,n,r)}}(t,e,p,c,f,o,n,r,i)},$t=Ve,y.IconSetRule=$t,te={iconSetType:ot("iconSetType",Ct.threeArrowsColored,function(t){this.xW(t)}),reverseIconOrder:ot("reverseIconOrder",!1),showIconOnly:ot("showIconOnly",!1)},v.extend($t.prototype,te),ee=["ruleType","state","style","priority","stopIfTrue","ranges"],Ee(Je,ke=Ht),Je.prototype.isRow=function(){var t=this.ruleType();return _(this.hj)&&(t===At.rowStateRule?this.hj=!0:t===At.columnStateRule&&(this.hj=!1)),this.hj},Je.prototype.isStateRule=function(){return!0},Je.prototype.jMc=function(){var t=this.state(),e=this.ranges();return y.$V(Tt.stateCondition,xt.contains,t,C,C,C,e)},Je.prototype.rowStateRuleCreateCondition=function(){return this.jMc()},Je.prototype.columnStateRuleCreateCondition=function(){return this.jMc()},Je.prototype.createCondition=function(){return this[At[this.ruleType()]+"CreateCondition"]()},Je.prototype.evaluate=function(t,e,o,n){return this.isRow()?o=-1:e=-1,ke.prototype.evaluate.call(this,t,e,o,n)},Je.prototype.kMc=function(t){return Je.StatesPriority.indexOf(this.state())<Je.StatesPriority.indexOf(t.state())},Je.prototype.fromJSON=function(t,e,o){var n=ee;_(t.condition)||(n=ee.concat(["condition"])),rt.call(this,e,n,t,o),this.initCondition(e)},Je.prototype.toJSON=function(t){var e;return _(this.condition())&&this.initCondition(),e=nt.call(this,t,ee),this.ruleType()===At.conditionRuleBase&&(e.condition=this.condition().toJSON()),e},Je.StatesPriority=[d.StatesType.readonly,d.StatesType.invalid,d.StatesType.dirty,d.StatesType.inserted,d.StatesType.updated,d.StatesType.selected,d.StatesType.active,d.StatesType.hover,d.StatesType.edit],oe=Je,(y.StateRule=oe).prototype.state=ot("state",L),Ue.prototype.no=function(){this.WS=L},Ue.prototype.getRule=function(t){return this.AW[t]},Ue.prototype.count=function(){return $(this.AW)},Ue.prototype.w4=function(){return this.AW},Ue.prototype.UV=function(t){var e,o,n=[],r=this.WS,i=$(t);for(e=0;e<i;e++)o=r.Tq(t[e]),n.push(o);return n},Ue.prototype.EW=function(t){var e,o,n,r,i=[],a=this.WS;for(e=0,o=$(t);e<o;e++)n=t[e],r=new V(n.row,n.col,De(n),je(n)),0===n.row&&De(n)===a.getRowCount()&&(r.row=-1),0===n.col&&je(n)===a.getColumnCount()&&(r.col=-1),i.push(r);return i},Ue.prototype.QV=function(){if(this.Kfc&&(this.DW={},this.AW))for(var t=0;t<$(this.AW);t++)this.FW(this.AW[t])},Ue.prototype.OV=function(){this.Kfc&&(this.DW={})},Ue.prototype.FW=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y;if(this.Kfc)for(e=this.DW,a=this.UV(t.ranges()),l=(s=this.WS).getRowCount(),u=s.getColumnCount(),c=0;c<$(a);c++)for(f=(h=a[c]).row,p=h.col,l<=f+(d=De(h))-1&&(d=l-f),u<=p+(g=je(h))-1&&(g=u-p),m=0;m<d;m++)for((o=e[r=m+f])||(e[r]=o=[]),y=0;y<g;y++)(n=o[i=y+p])||(o[i]=n=[]),n.push(t)},Ue.prototype.GW=function(t){var e,o,n,r,i,a,s,l,u,c,h;if(this.Kfc)for(e=this.DW,i=this.UV(t.ranges()),a=0;a<$(i);a++)for(s=i[a],l=0;l<De(s);l++)if(o=e[l+s.row])for(u=0;u<je(s);u++)if(n=o[r=u+s.col]){for(c=[],h=0;h<$(n);h++)n[h]!==t&&c.push(n[h]);0===$(c)&&(c=C),o[r]=c}},Ue.prototype.HW=function(t,e,o,n){var r,i,a,s;if(this.Kfc)for(r=this.DW,a=0;a<o;a++)if(i=r[a+t])for(s=0;s<n;s++)i[s+e]=C},Ue.prototype.Ayb=function(t,e){var o,n,r=[];for(o=0;o<$(this.AW);o++)(n=this.AW[o]).contains(t,e)&&r.push(n);return r},Ue.prototype.addSpecificTextRule=function(t,e,o,n){var r=new zt(2,n,o,t,L,L,e);return this.addRule(r)},Ue.prototype.addCellValueRule=function(t,e,o,n,r){var i=new zt(1,r,n,t,Ge(e),Ge(o));return this.addRule(i)},Ue.prototype.addDateOccurringRule=function(t,e,o){var n=new zt(4,o,e,L,L,L,L,L,t);return this.addRule(n)},Ue.prototype.addFormulaRule=function(t,e,o){var n=new zt(3,o,e,L,L,L,L,t);return this.addRule(n)},Ue.prototype.addTop10Rule=function(t,e,o,n){var r=new zt(5,n,o,L,L,L,L,L,t,e);return this.addRule(r)},Ue.prototype.addUniqueRule=function(t,e){var o=new zt(6,e,t);return this.addRule(o)},Ue.prototype.addDuplicateRule=function(t,e){var o=new zt(7,e,t);return this.addRule(o)},Ue.prototype.addAverageRule=function(t,e,o){var n=new zt(8,o,e,L,L,L,L,L,t);return this.addRule(n)},Ue.prototype.add3ScaleRule=function(t,e,o,n,r,i,a,s,l,u){var c;return c=0===arguments.length?new Jt(11):new Jt(11,t,e,o,n,r,i,a,s,l,u),this.addRule(c)},Ue.prototype.add2ScaleRule=function(t,e,o,n,r,i,a){var s;return s=0===arguments.length?new Jt(10):new Jt(10,t,e,o,L,L,L,n,r,i,a),this.addRule(s)},Ue.prototype.addDataBarRule=function(t,e,o,n,r,i){var a;return a=0===arguments.length?new Kt:new Kt(t,e,o,n,r,i),this.addRule(a)},Ue.prototype.addIconSetRule=function(t,e){var o=new $t(t,e);return this.addRule(o)},Ue.prototype.addRowStateRule=function(t,e,o,n){var r,i,a=this.WS;return _(o)&&(o=0),_(n)&&(n=a.getRowCount()-o),r=[new V(o,-1,n,-1)],i=new oe(At.rowStateRule,t,e,r),a.QLc.enableState(t,!0),this.addRule(i)},Ue.prototype.addColumnStateRule=function(t,e,o,n){var r,i,a=this.WS;return _(o)&&(o=0),_(n)&&(n=a.getRowCount()-o),r=[new V(-1,o,-1,n)],i=new oe(At.columnStateRule,t,e,r),a.QLc.enableState(t,!1),this.addRule(i)},Ue.prototype.addRule=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p=this.WS;if(p){if(!t)throw Error(Z().Exp_RuleIsNull);for(n=o=void 0,(e=t.ranges())&&(o=(r=Y(e)).r,n=r.c),(a=(i=t.getExpected())&&i.formatter)&&"string"==typeof a&&p.fJb(o||0,n||0,a),p._modelManager.YUa(),s=1,l=void 0,u=$(this.AW),l=0;l<u;l++)f=(h=(c=this.AW[l])._ps).priority||1,h.priority=f+1,t.isStateRule()&&c.isStateRule()&&t.kMc(c)&&(s=S(s,h.priority),--h.priority);return t.priority(s),this.AW.push(t),Ue.ao(p,"onRuleAdded",{ranges:e}),t.context(p),this.FW(t),p.$p(),t}},Ue.prototype.removeRule=function(t){var e,o,n,r,i,a,s,l,u=this.WS,c=u.parent;if(u){if(t&&((o=(e=t.getExpected())&&e.formatter)&&"string"==typeof o&&c.QHb[o]&&c.RHb(o),u._modelManager.YUa(),this.GW(t),W(this.AW,t),Ue.ao(u,"onRuleRemoved",{priority:t.priority(),ranges:t.ranges()}),t.isStateRule())){for(n=t.state(),r=t.isRow(),i=!1,a=0,s=this.AW;a<s.length;a++)if((l=s[a]).isStateRule()&&l.state()===n){i=!0;break}i||u.QLc.disableState(n,r)}u.$p()}},Ue.prototype.IW=function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y;return t.intersect(e,o,n,r)?(i=t.row,a=t.row+De(t)-1,s=t.col,l=t.col+je(t)-1,c=(u=e)+n-1,f=(h=o)+r-1,p=[],-1!==i&&-1!==s&&-1!==u&&-1!==h&&(0<h-s&&(d=Q(i,s,De(t),h-s),p.push(d)),0<l-f&&(g=Q(i,1+f,De(t),l-f),p.push(g)),0<u-i&&(m=Q(i,S(h,s),u-i,I(f,l)-S(h,s)+1),p.push(m)),0<a-c&&(y=Q(1+c,S(h,s),a-c,I(f,l)-S(h,s)+1),p.push(y))),0<$(p)?p:L):[t]},Ue.prototype.removeRuleByRange=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g=this.WS;if(g){if(r=[],this.AW)for(g._modelManager.YUa(),this.HW(t,e,o,n),i=0,a=$(this.AW);i<a;i++)if(s=this.AW[i],Ue.ao(g,"onRuleRemoved",{ranges:[new V(t,e,o,n)]}),s&&s.ranges()&&s.intersects(t,e,o,n))if(g.pivotTables&&s.pivotTableName)g.pivotTables.get(s.pivotTableName).nPc(s,t,e,o,n);else{for(l=[],u=this.UV(s.ranges()),c=0,h=$(u);c<h;c++)(f=this.IW(u[c],t,e,o,n))&&(l=l.concat(f));0<$(l)?s.ranges(this.EW(l)):r.push(s)}for(p=0,d=$(r);p<d;p++)W(this.AW,r[p]);g.$p()}},Ue.prototype.clearRule=function(){var t,e,o,n,r,i,a=this.WS,s=a.parent;if(a){for(t=this.AW,a._modelManager.YUa(),e=0;e<t.length;e++)r=(n=(o=t[e]).getExpected())&&n.formatter,Ue.ao(a,"onRuleRemoved",{ranges:o.ranges()}),r&&"string"==typeof r&&s.QHb[r]&&s.RHb(r);if(a.pivotTables)for(i=a.pivotTables.all(),e=0;e<i.length;e++)i[e].oPc();this.AW.length=0,this.QV(),a.$p()}},Ue.prototype.getRules=function(t,o){var n,e,r,i,a,s,l,u,c=this.AW;if(0===arguments.length||0===$(c))return c;if(t=t===C?-1:t,o=o===C?-1:o,n=[],this.Kfc)e=this.DW,i=void 0,-1!==t&&-1!==o?(i=e[t])&&(r=i[o],Ze(n,r)):-1===t?v.each(e,function(t,e){r=e[o],Ze(n,r)}):(i=e[t])&&v.each(i,function(t,e){Ze(n,e)});else if(s=(a=this.WS).getRowCount(),l=a.getColumnCount(),u=void 0,-1!==t&&-1!==o)Ze(n,this.Ayb(t,o));else if(-1===t)for(u=0;u<s;u++)Ze(n,this.Ayb(u,o));else for(u=0;u<l;u++)Ze(n,this.Ayb(t,u));return n},Ue.prototype.containsRule=function(t,e,o){return!(!t||!h.Bb(this.AW,t))&&t.contains(e,o)},Ue.prototype.lMc=function(t,e){var o,n,r,i,a,s,l,u,c,h,f=this.WS;if(f){if(!t)throw Error(Z().Exp_RuleIsNull);for(r=n=void 0,(o=t.ranges())&&(n=(i=Y(o)).r,r=i.c),(s=(a=t.getExpected())&&a.formatter)&&"string"==typeof s&&f.fJb(n||0,r||0,s),f._modelManager.YUa(),l=0,u=$(this.AW);l<u;l++)e<=(h=(c=this.AW[l]._ps).priority||1)&&(c.priority=h+1);return t.priority(e),(this.AW[e]=t).context(f),this.FW(t),f.$p(),t}},Ue.prototype.XXc=function(t,e,o){var n,r,i=this.WS._modelManager,a=this.AW,s=$(a),l=!1;for(i.YUa(),n=0;n<s;n++)(r=a[n])&&r.XXc(t,e,o)&&(l=!0);l&&this.QV()},Ue.prototype._V=function(t,e,o,n,r){var i,a,s;if(this.AW&&this.WS)for(i=$(this.AW),a=0;a<i;a++)(s=this.AW[a])&&(o?s.rI(t,e,n,r):s.tI(t,e,n,r));this.QV()},Ue.prototype.rI=function(t,e,o,n){this._V(t,e,!0,o,n)},Ue.prototype.tI=function(t,e,o,n){this._V(t,e,!1,o,n)},Ue.prototype.aW=function(t,e,o,n,r){var i,a;if(this.AW&&this.WS)for(i=$(this.AW)-1;0<=i;i--)(a=this.AW[i])&&(o?a.GR(t,e,n,r):a.HR(t,e,n,r),a.ranges().length<=0&&(this.GW(a),this.AW.splice(i,1)));this.QV()},Ue.prototype.GR=function(t,e,o,n){this.aW(t,e,!0,o,n)},Ue.prototype.HR=function(t,e,o,n){this.aW(t,e,!1,o,n)},Ue.prototype.Nm=function(){var t,e,o,n=this.AW;if(n!==L&&0<$(n))for(e=0,o=$(n);e<o;e++)(t=n[e]).Nm&&t.Nm()},Ue.prototype.XA=function(t,e,o,n,r,i,a,s,l){var u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z=[],W=[],G=[],U=[],J=[],Z=this.WS,q=!l&&Z.KLc();for(-1===t&&(n=t=0,i=Z.getRowCount()),-1===e&&(r=e=0,a=Z.getColumnCount()),u=0;u<i;u++)for(c=0;c<a;c++)for(h=this.getRules(t+u,e+c),f=0;f<$(h);f++)if(d=(p=h[f]).ranges(),!p.isStateRule()){for(g=[],m=0;m<$(d);m++)y=d[m],v=(b=Z.Tq(y)).row,C=b.col,w=De(b),x=je(b),(X(G,y)<=-1||-1<X(G,y)&&X(U,p)<=-1)&&y.contains(t+u,e+c)&&(G.push(y),U.push(p),(T=Q(n+u,r+c,-1,-1)).rowCount=i+t<=v+w?i-u:t<v?w:v+w-t,T.colCount=a+e<=C+x?a-c:e<C?x:C+x-e,this===o&&y.containsRange(T)||g.push(T),s&&!Ke(J,T)&&J.push(T));0<g.length&&((A=z.indexOf(p))<0?(q&&(g=this.mMc(g)),z.push(p),W.push(g)):(q&&(R=W[A][0].row,k=W[A][0].col,S=(E=g[0]).row-R,M=E.col-k,I=Z.MLc(R,S,!0),N=Z.MLc(k,M),E.row+=I,E.col+=N,g=this.mMc(g)),W[A]=W[A].concat(g)))}for(D=0,j=z.length;D<j;D++)O=(_=this.iga(z[D].toJSON(),z[D].context())).ranges(),_.ranges(W[D]),(F=_.Yw)&&(P=1===Z.parent.options.referenceStyle,L=Y(O),H=K.formulaToExpression(Z,F,L.r,L.c,P),B=Y(W[D]),V=K.expressionToFormula(Z,H,B.r,B.c,P),_.formula(V)),o.addRule(_);return this.QV(),J},Ue.prototype.mMc=function(t){var e,o,n,r,i,a,s,l,u,c,h=this.WS,f=[];if(0<t.length){for(o=(e=t[0]).row,n=e.col,r=e.rowCount,i=e.colCount,r+=h.MLc(o,r,!0),i+=h.MLc(n,i),a=[],s=void 0,l=0;l<i;l++)0!==l?0!==h.getColumnWidth(n+l)?s.colCount++:(a.push(s),l=h.Zq(n+l-1)-1-n,s=new V(o,n+l+1,1,0)):s=new V(o,n,1,1);for(a.push(s),u=0;u<r;u++)if(0!==u)if(0!==h.getRowHeight(o+u))for(c=0;c<a.length;c++)a[c].rowCount++;else for(f=f.concat(qe(a)),u=h._q(o+u-1)-1-o,c=0;c<a.length;c++)a[c].rowCount=0,a[c].row=o+u+1;f=f.concat(a)}return f},Ue.prototype.YA=function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w=[],x=this.WS,T=x.getRowCount(3),A=x.getColumnCount(3);for(-1===t&&(t=0,o=x.getRowCount()),-1===e&&(e=0,n=x.getColumnCount()),a=0;a<o;a++)for(s=0;s<n;s++)for(l=this.getRules(t+a,e+s),u=0;u<$(l);u++)if(h=(c=l[u]).ranges(),!c.isStateRule()){for(f=[],p=0;p<$(h);p++)d=h[p],m=(g=x.Tq(d)).row,y=g.col,b=De(g),v=je(g),Ke(r,d)||X(w,d)<=-1&&d.contains(t+a,e+s)&&(w.push(d),m<t&&f.push(Q(m,y,t-m,v)),y<e&&f.push(Q(S(t,m),y,I(t+o,m+b)-S(t,m),e-y)),e+n<y+v&&f.push(Q(S(t,m),e+n,I(t+o,m+b)-S(t,m),y+v-(e+n))),t+o<m+b&&f.push(Q(t+o,y,m+b-(t+o),v)));x&&x._modelManager.YUa(),this.Byb(x,w,r,h,T,A,i),0<(C=h.concat(f)).length?(c.yyb(),c.ranges(C)):this.removeRule(c)}this.QV()},Ue.prototype.Byb=function(t,e,o,n,r,i,a){var s,l,u,c,h,f;for(s=0;s<$(e);s++){if(u=[l=e[s]],a)for(c=0;c<$(o);c++)h=o[c],l.intersect(h.row,h.col,h.rowCount,h.colCount)&&(u=u.concat(t.v_a(l,h,r,i)));for(f=0;f<$(u);f++)W(n,u[f])}},Ue.prototype.jp=function(t,e,o,n,r,i,a,s){var l=16,u=!1,c=!1,h=s.sheet,f=s.row,p=s.col,d=h.zoom(),g=this.oRa(h,f,p,e),m=g.iconSet,y=g.dataBar;return(y||m)&&(t.save(),t.beginPath(),y&&(Kt.paintDataBar(t,y,o,n,r,i),u=y.showBarOnly),m&&((r<(l=parseInt(l*d+"",10))||i<l)&&(t.rect(o,n,r,i),t.clip(),t.beginPath()),$t.paintIconSet(t,m,o,n,r,i,a,s.lineHeight,d,s.imageLoader),c=m.showIconOnly),t.restore()),u||c},Ue.prototype.oRa=function(t,e,o,n){var r,i,a,s,l,u,c,h,f=t.ss,p=f.Um(e,o);if(p)r=p.i,i=p.d;else{if(a=this.getRules(e,o),0<(s=$(a))){for(a.sort(function(t,e){return t.priority()-e.priority()}),u=l=L,h=c=void 0,h=0;h<s&&(!l||!u);h++)(c=a[h])&&(O(c,Kt)&&(l=c),O(c,$t)&&(u=c));if(l||u)for(l=u=L,h=0;!(!(h<s)||l&&u||(c=a[h])&&(!l&&O(c,Kt)&&(l=c),!u&&O(c,$t)&&(u=c),c.stopIfTrue()&&c.evaluate(t,e,o,n)));h++);l&&(i=l.evaluate(t,e,o,n)),u&&(r=u.evaluate(t,e,o,n))}f.Wm(e,o,i,r)}return{dataBar:i,iconSet:r}},Ue.prototype.bp=function(t,e,o){var n,r,i;if(_(o)||3===o)for(n=this.getRules(t,e),r=0,i=$(n);r<i;r++)if(n[r]instanceof $t)return!0;return!1},Ue.prototype.toJSON=function(t){var e,o,n=[];for(e=0;e<$(this.AW);e++)o=this.AW[e],n.push(o?o.toJSON(t):L);return 0===$(n)?C:{rules:n}},Ue.prototype.fromJSON=function(t,e,o,n){var r,i,a,s,l;if(t&&(r=t.rules)){for(this.AW=[],i=$(r),a=0;a<i;a++)(s=r[a]).pivot&&n||(l=this.iga(s,e,o))&&this.AW.push(l);this.Kfc=!function(t){var e,o,n,r,i=$(t);for(e=0;e<i;e++)if(o=t[e],n=o.ranges)for(r=0;r<n.length;r++)if(1e3<n[r].rowCount)return 1}(r),this.QV()}},Ue.prototype.iga=function(t,e,o){var n,r=L;return t&&(n=this.JW()[t.ruleType])&&(r=new n).fromJSON(t,e,o),r},Ue.prototype.JW=function(){if(!this.BW){var t={};t[0]=zt,t[1]=zt,t[2]=zt,t[3]=zt,t[4]=zt,t[5]=zt,t[6]=zt,t[7]=zt,t[8]=zt,t[9]=Jt,t[10]=Jt,t[11]=Jt,t[12]=Kt,t[13]=$t,t[14]=oe,t[15]=oe,this.BW=t}return this.BW},Ue.prototype.Eq=function(t,e,o,n){var r,i,a,s,l,u,c,h,f;if(this&&0<this.count()&&(r=this.getRules(e,o),i=$(r),a=void 0,s=L,0<i))for(r.sort(function(t,e){return t.priority()-e.priority()}),l=0;l<i&&!((a=r[l])&&(u=this.WS,a.isScaleRule()?10!==a.ruleType()&&11!==a.ruleType()||(s=a.evaluate(u,e,o,u.getValue(e,o,n)))&&(t=t||new P).backColor===C&&(t.backColor=s):(s=a.isStateRule()?(c=a.state(),h=a.isRow(),f=u.QLc.getState(e,o,c,h),a.evaluate(u,e,o,f)):a.evaluate(u,e,o,u.getValue(e,o,n)))&&(t=t||new P).Yo(s,!1,1),a.stopIfTrue()&&s));l++);return t},Ue.prototype.Fq=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g={v5:!1};if(this&&0<this.count()&&(r=this.getRules(t,e),i=$(r),a=void 0,s=L,0<i))for(r.sort(function(t,e){return t.priority()-e.priority()}),l=0;l<i;l++)if(a=r[l]){if(u=this.WS,a.isScaleRule()){if(c=a.ruleType(),"backColor"===o&&(10===c||11===c)&&(s=a.evaluate(u,t,e,u.getValue(t,e,n)))){g.Fi=s,g.v5=!0;break}}else if(a.isStateRule()){if(h=a.state(),f=a.isRow(),p=u.QLc.getState(t,e,h,f),!((d=a.style())&&void 0!==d[o]||a.stopIfTrue()))continue;if((s=a.evaluate(u,t,e,p))&&s[o]!==C){g.Fi=s[o],g.v5=!0;break}}else{if(!((d=a.style())&&void 0!==d[o]||a.stopIfTrue()))continue;if((s=a.evaluate(u,t,e,u.getValue(t,e,n)))&&s[o]!==C){g.Fi=s[o],g.v5=!0;break}}if(a.stopIfTrue()&&s)break}return g},ne=Ue,s(y.ConditionalFormats=ne)},"./dist/plugins/conditional/conditional.ns.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("./dist/plugins/conditional/conditional.res.en.js");e.SR={en:n}},"./dist/plugins/conditional/conditional.res.en.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_RuleIsNull="The argument 'rule' is null",e.Exp_NotSupported="NotSupportException"},"./dist/plugins/conditional/conditionalFormatIcon.js":function(t,e,o){"use strict";var M,I,l,u,n,r,i,a,s,c,h,f,p,d,g,m,N;function y(t,e,o,n,r){t.beginPath(),t.moveTo(e,o),t.lineTo(e+n,o),t.lineTo(e+n,o+r),t.lineTo(e,o+r),t.lineTo(e,o),t.closePath(),t.fill(),t.stroke()}function b(t,e,o){t.moveTo(l(.1*M)*e,-u(.1*M)*e),t.lineTo(l(.3*M)*o,-u(.3*M)*o),t.lineTo(0*e,-u(.5*M)*e),t.lineTo(l(.7*M)*o,-u(.7*M)*o),t.lineTo(l(.9*M)*e,-u(.9*M)*e),t.lineTo(l(1.1*M)*o,-u(1.1*M)*o),t.lineTo(l(1.3*M)*e,-u(1.3*M)*e),t.lineTo(0*o,-u(1.5*M)*o),t.lineTo(l(1.7*M)*e,-u(1.7*M)*e),t.lineTo(l(1.9*M)*o,-u(1.9*M)*o),t.lineTo(l(.1*M)*e,-u(.1*M)*e)}function v(t,e,o,n,r,i){var a=i;t.strokeStyle=N[e][o].strokeStyle,t.beginPath(),t.arc(a/2+n,a/2+r,a/2,0,2*M),t.fillStyle=N[e][o].fillColor,t.closePath(),t.fill(),t.stroke()}function R(t,e,o){t.lineTo(I(e)+.5,I(o)+.5)}function k(t,e,o){t.moveTo(I(e)+.5,I(o)+.5)}Object.defineProperty(e,"__esModule",{value:!0}),M=Math.PI,I=Math.round,l=Math.cos,u=Math.sin,N=[[{strokeStyle:r="#326f5b",fillColor:i="#76a797",fillColor2:"",rotate:M},{strokeStyle:a="#A4802b",fillColor:s="#EAC282",fillColor2:"",rotate:-.5*M},{strokeStyle:c="#9E381C",fillColor:h="#D86344",fillColor2:"",rotate:0}],[{strokeStyle:f="#646262",fillColor:p="#808080",fillColor2:"",rotate:M},{strokeStyle:f,fillColor:p,fillColor2:"",rotate:-.5*M},{strokeStyle:f,fillColor:p,fillColor2:"",rotate:0}],[{strokeStyle:c,fillColor:h,fillColor2:"",rotate:0},{strokeStyle:a,fillColor:s,fillColor2:"",rotate:0},{strokeStyle:r,fillColor:i,fillColor2:"",rotate:M}],[{strokeStyle:a,fillColor:"#FFFFFF",fillColor2:"",rotate:0},{strokeStyle:a,fillColor:s,fillColor2:"",rotate:0},{strokeStyle:a,fillColor:s,fillColor2:"",rotate:0}],[{strokeStyle:c,fillColor:h,fillColor2:"",rotate:0},{strokeStyle:a,fillColor:s,fillColor2:"",rotate:0},{strokeStyle:r,fillColor:i,fillColor2:"",rotate:0}],[{strokeStyle:c,fillColor:h,fillColor2:"",rotate:0},{strokeStyle:a,fillColor:s,fillColor2:"",rotate:0},{strokeStyle:r,fillColor:i,fillColor2:"",rotate:0}],[{strokeStyle:d="#303030",fillColor:g="#505050",fillColor2:"#d86344",rotate:0},{strokeStyle:d,fillColor:g,fillColor2:"#eac282",rotate:0},{strokeStyle:d,fillColor:g,fillColor2:i,rotate:0}],[{strokeStyle:c,fillColor:h,fillColor2:"",rotate:0},{strokeStyle:a,fillColor:s,fillColor2:"",rotate:0},{strokeStyle:r,fillColor:i,fillColor2:"",rotate:0}],[{strokeStyle:c,fillColor:h,fillColor2:"white",rotate:.25*M},{strokeStyle:a,fillColor:s,fillColor2:"white",rotate:0},{strokeStyle:r,fillColor:i,fillColor2:"white",rotate:-.25*M}],[{strokeStyle:c,fillColor:h,fillColor2:"",rotate:.25*M},{strokeStyle:a,fillColor:s,fillColor2:"",rotate:0},{strokeStyle:r,fillColor:i,fillColor2:"",rotate:-.25*M}],[{strokeStyle:r,fillColor:i,fillColor2:"",rotate:M},{strokeStyle:a,fillColor:s,fillColor2:"",rotate:-.75*M},{strokeStyle:a,fillColor:s,fillColor2:"",rotate:-.25*M},{strokeStyle:c,fillColor:h,fillColor2:"",rotate:0}],[{strokeStyle:f,fillColor:p,fillColor2:"",rotate:M},{strokeStyle:f,fillColor:p,fillColor2:"",rotate:-.75*M},{strokeStyle:f,fillColor:p,fillColor2:"",rotate:-.25*M},{strokeStyle:f,fillColor:p,fillColor2:"",rotate:0}],[{strokeStyle:"#353535",fillColor:g,fillColor2:"",rotate:0},{strokeStyle:p,fillColor:"#b1b1b1",fillColor2:"",rotate:0},{strokeStyle:"#b28578",fillColor:"#edb9ab",fillColor2:"",rotate:0},{strokeStyle:c,fillColor:h,fillColor2:"",rotate:0}],[{strokeStyle:m="#727272",fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:m,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:m,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:m,fillColor:n="#4d82b8 #4d82b8 #4d82b8 #4d82b8",fillColor2:"",rotate:0}],[{strokeStyle:"#353535",fillColor:g,fillColor2:"",rotate:0},{strokeStyle:c,fillColor:h,fillColor2:"",rotate:0},{strokeStyle:a,fillColor:s,fillColor2:"",rotate:0},{strokeStyle:r,fillColor:i,fillColor2:"",rotate:0}],[{strokeStyle:r,fillColor:i,fillColor2:"",rotate:M},{strokeStyle:a,fillColor:s,fillColor2:"",rotate:-.75*M},{strokeStyle:a,fillColor:s,fillColor2:"",rotate:-.5*M},{strokeStyle:a,fillColor:s,fillColor2:"",rotate:-.25*M},{strokeStyle:c,fillColor:h,fillColor2:"",rotate:0}],[{strokeStyle:f,fillColor:p,fillColor2:"",rotate:M},{strokeStyle:f,fillColor:p,fillColor2:"",rotate:-.75*M},{strokeStyle:f,fillColor:p,fillColor2:"",rotate:-.5*M},{strokeStyle:f,fillColor:p,fillColor2:"",rotate:-.25*M},{strokeStyle:f,fillColor:p,fillColor2:"",rotate:0}],[{strokeStyle:m,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:m,fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:m,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:m,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0}],[{strokeStyle:g,fillColor:g,fillColor2:"",rotate:2*M},{strokeStyle:g,fillColor:g,fillColor2:"",rotate:.5*M},{strokeStyle:g,fillColor:g,fillColor2:"",rotate:.5*M},{strokeStyle:g,fillColor:g,fillColor2:"",rotate:+M},{strokeStyle:g,fillColor:g,fillColor2:"",rotate:2*M}],[{strokeStyle:m,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:m,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:m,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:m,fillColor:"#4d82b8 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0}]],e.drawSignal=function(t,e,o,n,r,i){var a,s;t.translate(n,r),t.strokeStyle=N[e][o].strokeStyle,a=N[e][o].fillColor.split(" "),s=I(.2*i),t.fillStyle=a[0],y(t,s+.5,3*s+.5,s,2*s),t.fillStyle=a[1],y(t,2*s+.5,2*s+.5,s,3*s),t.fillStyle=a[2],y(t,3*s+.5,s+.5,s,4*s),t.fillStyle=a[3],y(t,4*s+.5,.5,s,5*s)},e.drawMagicCube=function(t,e,o,n,r,i){var a,s;t.translate(n,r),t.strokeStyle=N[e][o].strokeStyle,a=N[e][o].fillColor.split(" "),t.fillStyle=N[e][o].strokeStyle,s=I(i/2),t.fillStyle=a[0],y(t,.5,.5,s,s),t.fillStyle=a[1],y(t,s+.5,.5,s,s),t.fillStyle=a[2],y(t,.5,s+.5,s,s),t.fillStyle=a[3],y(t,s+.5,s+.5,s,s)},e.drawSector=function(t,e,o,n,r,i){t.translate(n+i/2,r+i/2),t.strokeStyle=N[e][o].strokeStyle,4===o?(t.beginPath(),t.arc(0,0,i/2,0,N[e][o].rotate),t.closePath(),t.fillStyle=N[e][o].fillColor,t.fill(),t.beginPath(),t.arc(0,0,i/2,0,N[e][o].rotate),t.closePath(),t.stroke()):0===o?(t.beginPath(),t.arc(0,0,i/2,0,2*M),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.arc(0,0,i/2,0,N[e][o].rotate),t.stroke(),t.closePath()):1===o?(t.beginPath(),t.arc(0,0,i/2,0,2*M),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,-i/2),t.arc(0,0,i/2,.5*-M,0),t.lineTo(0,0),t.closePath(),t.fillStyle=N[e][o].fillColor,t.fill(),t.arc(0,0,i/2,0,2*M),t.stroke()):2===o?(t.beginPath(),t.arc(0,0,i/2,0,2*M),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,-i/2),t.arc(0,0,i/2,.5*-M,.5*M),t.moveTo(0,0),t.closePath(),t.fillStyle=N[e][o].fillColor,t.fill(),t.arc(0,0,i/2,0,2*M),t.stroke()):3===o&&(t.beginPath(),t.arc(0,0,i/2,0,2*M),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,-i/2),t.arc(0,0,i/2,.5*-M,M),t.lineTo(0,0),t.fillStyle=N[e][o].fillColor,t.fill(),t.arc(0,0,i/2,0,2*M),t.stroke(),t.closePath())},e.drawStar=function(t,e,o,n,r,i){var a=i/1.8,s=a/2.5;t.translate(a+n,a+r),t.strokeStyle="#727272",t.fillStyle=N[e][o].fillColor,t.beginPath(),2===o&&(t.strokeStyle="#727272",b(t,a,s),t.fill(),t.stroke(),t.strokeStyle=N[e][o].strokeStyle,b(t,a,s),t.stroke(),t.closePath()),0===o&&(t.fillStyle="white",b(t,a,s),t.fill(),t.stroke(),t.strokeStyle="#727272",b(t,a,s),t.stroke(),t.closePath()),1===o&&(t.strokeStyle=N[e][o].fillColor,t.moveTo(0*a,-u(.5*M)*a),t.lineTo(l(.7*M)*s,-u(.7*M)*s),t.lineTo(l(.9*M)*a,-u(.9*M)*a),t.lineTo(l(1.1*M)*s,-u(1.1*M)*s),t.lineTo(l(1.3*M)*a,-u(1.3*M)*a),t.lineTo(0*s,-u(1.5*M)*s),t.fill(),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(0*a,-u(.5*M)*a),t.lineTo(-l(.7*M)*s,-u(.7*M)*s),t.lineTo(-l(.9*M)*a,-u(.9*M)*a),t.lineTo(-l(1.1*M)*s,-u(1.1*M)*s),t.lineTo(-l(1.3*M)*a,-u(1.3*M)*a),t.lineTo(0*s,-u(1.5*M)*s),t.fillStyle="white",t.fill(),t.closePath(),t.beginPath(),t.strokeStyle="#727272",b(t,a,s),t.stroke(),t.closePath())},e.drawIconTypeIsEight=function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A;2===o?(C=e,w=o,x=n,T=r,A=i,(v=t).translate(I(x+A/2),I(A/2+T)),v.strokeStyle=N[C][w].strokeStyle,v.rotate(N[C][w].rotate),v.beginPath(),v.arc(0,0,A/2,0,2*M),v.closePath(),v.fillStyle=N[C][w].fillColor,v.fill(),v.beginPath(),v.arc(0,0,A/2,0,2*M),v.stroke(),v.closePath(),v.beginPath(),v.fillStyle=N[C][w].fillColor2,v.fillRect(.325*-A,.25*-A,.2*A,.5*A),v.closePath(),v.fill(),v.beginPath(),v.fillStyle=N[C][w].fillColor2,v.fillRect(.325*-A,.05*A,.65*A,.2*A),v.closePath(),v.fill(),v.stroke()):0===o?(f=t,p=e,d=o,g=n,m=r,b=I((y=i)/2),f.translate(g+b,m+b),f.strokeStyle=N[p][d].strokeStyle,f.rotate(N[p][d].rotate),f.beginPath(),f.arc(0,0,b,0,2*M),f.closePath(),f.fillStyle=N[p][d].fillColor,f.fill(),f.beginPath(),f.arc(0,0,b,0,2*M),f.closePath(),f.stroke(),f.beginPath(),f.fillStyle=N[p][d].fillColor2,f.fillRect(.375*-y,.1*-y,.75*y,.2*y),f.closePath(),f.fill(),f.beginPath(),f.fillStyle=N[p][d].fillColor2,f.fillRect(.1*-y,.375*-y,.2*y,.75*y),f.closePath(),f.fill(),f.stroke()):1===o&&(s=e,l=o,u=n,c=r,h=i,(a=t).translate(u,c),a.strokeStyle=N[s][l].strokeStyle,a.beginPath(),a.arc(.5*h,.5*h,.5*h,0,2*M),a.closePath(),a.fillStyle=N[s][l].fillColor,a.fill(),a.beginPath(),a.arc(.5*h,.5*h,.5*h,0,2*M),a.stroke(),a.closePath(),a.beginPath(),a.moveTo(h/3,.1*h),a.lineTo(h/1.5,.1*h),a.lineTo(.625*h,.6*h),a.lineTo(.375*h,.6*h),a.lineTo(h/3,.1*h),a.moveTo(.625*h,.85*h),a.arc(.5*h,.8*h,.15*h,0,2*M),a.fillStyle=N[s][l].fillColor2,a.fill(),a.closePath())},e.drawIconTypeIsNine=function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S;2===o?(w=e,x=o,T=n,A=r,S=i,(C=t).translate(I(T+S/2),I(A+S/2)),C.strokeStyle=N[w][x].strokeStyle,C.rotate(N[w][x].rotate),C.beginPath(),C.fillStyle=N[w][x].fillColor,C.fillRect(.375*-S,.25*-S,.2*S,.5*S),C.closePath(),C.fill(),C.beginPath(),C.fillStyle=N[w][x].fillColor,C.fillRect(.375*-S,.05*S,.75*S,.2*S),C.closePath(),C.fill(),C.stroke()):0===o?(p=e,d=o,g=n,m=r,v=i,(f=t).translate(I(g+v/2),I(m+v/2)),f.strokeStyle=N[p][d].strokeStyle,f.rotate(N[p][d].rotate),f.beginPath(),k(f,-(y=.5*v),-(b=.075*v)),R(f,-y,b),R(f,-b,b),R(f,-b,y),R(f,b,y),R(f,b,b),R(f,y,b),R(f,y,-b),R(f,b,-b),R(f,b,-y),R(f,-b,-y),R(f,-b,-b),R(f,-y,-b),f.fillStyle=N[p][d].fillColor,f.fill(),f.stroke()):1===o&&(s=e,l=o,u=n,c=r,h=i,(a=t).translate(u,c),a.beginPath(),a.strokeStyle=N[s][l].strokeStyle,a.moveTo(h/3,.5),a.lineTo(h/1.5,.5),a.lineTo(.625*h,.65*h),a.lineTo(.375*h,.65*h),a.lineTo(h/3,.5),a.moveTo(.65*h,.85*h),a.arc(.5*h,.85*h,.15*h,0,2*M),a.fillStyle=N[s][l].fillColor,a.fill(),a.stroke())},e.drawFlag=function(t,e,o,n,r,i){var a=1.2*i;t.translate(n,r),t.strokeStyle=p,t.fillStyle=p,y(t,I(.2*a)+.5,.5,I(.06*a),I(.8*a)),t.strokeStyle=N[e][o].strokeStyle,t.beginPath(),k(t,.4*a,.5),R(t,.4*a,.5*a),R(t,.9*a,.25*a),R(t,.4*a,.5),t.fillStyle=N[e][o].fillColor,t.fill(),t.stroke()},e.drawIconTypeIsSen=function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y;2===o?v(t,e,o,n,r,i):1===o?(f=t,p=e,d=o,g=n,m=r,y=I(i),f.translate(g,m),f.strokeStyle=N[p][d].strokeStyle,f.beginPath(),k(f,0,y),R(f,y/2,y-y/2*Math.sqrt(3)),R(f,y,y),R(f,0,y),f.fillStyle=N[p][d].fillColor,f.closePath(),f.fill(),f.stroke()):(s=e,l=o,u=n,c=r,h=i,(a=t).strokeStyle=N[s][l].strokeStyle,a.beginPath(),a.translate(u+I(h/2),c+I(h/2)),a.beginPath(),k(a,0,-h/2),R(a,h/2,0),R(a,0,h/2),R(a,-h/2,0),R(a,0,-h/2),a.fillStyle=N[s][l].fillColor,a.closePath(),a.fill(),a.stroke())},e.drawTrafficLight=function(t,e,o,n,r,i){var a=I(i);t.strokeStyle=N[e][o].strokeStyle,t.fillStyle=N[e][o].fillColor,y(t,n+.5,r+.5,a,a),t.beginPath(),t.arc(a/2+n+.5,a/2+r+.5,.375*a,0,2*M),t.fillStyle=N[e][o].fillColor2,t.fill(),t.stroke()},e.drawCircle=v,e.drawIconTypeIsTwo=function(t,e,o,n,r,i){var a,s,l,u,c,h;1===o?(s=e,l=o,u=n,c=r,h=i,(a=t).strokeStyle=N[s][l].strokeStyle,a.translate(I(h/2+u),I(h/2+c)),a.beginPath(),a.rotate(N[s][l].rotate),k(a,-h/2,-h/5.4),R(a,h/2,-h/5.4),R(a,h/2,h/5.4),R(a,-h/2,h/5.4),R(a,-h/2,-h/5.4),a.fillStyle=N[s][l].fillColor,a.fill(),a.stroke()):0===o?function(t,e,o,n,r,i){t.strokeStyle=N[e][o].strokeStyle;var a=i;t.translate(I(a/2+n),I(a/2+r)),t.beginPath(),k(t,-a/2,-a/3),R(t,a/2,-a/3),R(t,0,a/3),R(t,-a/2,-a/3),t.fillStyle=N[e][o].fillColor,t.fill(),t.stroke()}(t,e,o,n,r,i):2===o&&function(t,e,o,n,r,i){t.strokeStyle=N[e][o].strokeStyle;var a=i;t.translate(I(a/2+n),I(a/2+r)),t.beginPath(),k(t,-a/2,a/3),R(t,a/2,a/3),R(t,0,-a/3),R(t,-a/2,a/3),t.fillStyle=N[e][o].fillColor,t.fill(),t.stroke()}(t,e,o,n,r,i)},e.drawArrows=function(t,e,o,n,r,i){var a,s,l,u,c=i/3.5,h=N[e].length-1;t.strokeStyle=N[e][h-o].strokeStyle,t.translate(I(1.75*c+n),I(1.75*c+r)),t.rotate(N[e][h-o].rotate),t.beginPath(),a=.25*c,s=1.25*c,k(t,-(l=.75*c),-(u=1.75*c)),R(t,a,-u),R(t,a,a),R(t,s,-l),R(t,s,a),R(t,-a,u),R(t,-u,a),R(t,-u,-l),R(t,-l,a),R(t,-l,-u),t.fillStyle=N[e][h-o].fillColor,t.fill(),t.stroke()}},"./dist/plugins/contextMenu/context-menu-dialog.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c=this&&this.__extends||(l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function h(t,e){var o=u.call(this,t,r(t))||this;return o.Eu=e,o}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=n.Ul.vl,i=n.Go,a=n.GC$,s="gc.command.executed",c(h,u=i),h.prototype.Qla=function(t,e,o){var n=t[0];this.kma&&this.kma.ai&&this.kma.ai(n,e,o,this.Eu)},h.prototype.OT=function(t,e,o,n,r){var i=this.Sla(o,n);this.kma=t,this.Qla(i,e,r)},h.prototype.Sla=function(t,e){var o=this.yo();return o.css(["left","top"],[t,e]),o.empty(),u.prototype.Ao.call(this),this.QQ(),o},h.prototype.Loa=function(t){var e,o,n,r=this.yo();return"block"!==r.css("display")||((e=r.offset()).top+=document.body.clientTop||0,e.left+=document.body.clientLeft||0,o=t.x,n=t.y,o<e.left||o>r.width()+e.left||n<e.top||n>r.height()+e.top)},h.prototype.QQ=function(){var t=this;t.Eu.bind(s,function(){t.close()})},h.prototype.Tla=function(){this.Eu.unbind(s)},h.prototype.close=function(){this.kma&&this.kma.no(),this.Tla(),this.vo(this.Cj)&&a("#"+this.Cj).remove(),u.prototype.close.call(this)},e.ContextMenuViewDialog=h},"./dist/plugins/contextMenu/context-menu.entry.js":function(t,o,e){"use strict";function n(t){for(var e in t)o.hasOwnProperty(e)||(o[e]=t[e])}Object.defineProperty(o,"__esModule",{value:!0}),n(e("./dist/plugins/contextMenu/context-menu.js")),n(e("./dist/plugins/contextMenu/menu-view.js")),n(e("./dist/plugins/contextMenu/context-menu.ns.js"));var r=e("./dist/plugins/contextMenu/context-menu-dialog.js");o.Cyb=r.ContextMenuViewDialog},"./dist/plugins/contextMenu/context-menu.js":function(t,e,o){"use strict";var n,r,i,L,a,l,H,B,u,V,v,s,m,y,c,z,W,h,f,p,d,g,b,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,G,U,J,Z,q,K,Y,Q,X,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ht,ft,pt,dt,gt,mt,yt,bt,vt,Ct,wt,xt,Tt,At,St,Mt,It,Nt,Rt,kt,Et,Dt,jt,_t,Ot,Ft,Pt,Lt,Ht,Bt,Vt,zt,Wt,Gt,Ut,Jt,Zt,qt,Kt,Yt,Qt,Xt;function $t(t){var e,o;if(t.slicers){if(!(e=t.slicers.all())||B(e))return;for(o in e)if(e[o].isSelected())return 1}else;}function te(t,e,o){var n,r,i,a,s="row"===e?"rowCount":"colCount";for(n=0;n<t.length;n++)for(i=-1===(r=t[n])[e]?0:r[e],a=0;a<r[s];a++)o(i+a)}function ee(t,e){var o,n=[],r=-1;for(o=t.row;o<t.row+t.rowCount;o++)!1!==e[o]&&-1===r&&(r=o),!1===e[o]&&-1!==r&&(n.push([r,o-r]),r=-1);return-1!==r&&n.push([r,o-r]),n}function oe(t,e){var o,n,r,i;if(1===e.colCount&&-1===e.row){if((o=e.col)===t.$q()&&(0<=(n=o-1)&&!t.getColumnVisible(n)))return!0}else if(1===e.rowCount&&-1===e.col&&((r=e.row)===t.ar()&&(0<=(i=r-1)&&!t.getRowVisible(i))))return!0}function ne(t,e){var o=e.name,n=e.group;return[v+Rt,v+Nt,v+Tt].indexOf(o)<0&&v+Tt!==n||(!L.sJc(t).xUc||v+Tt!==o&&v+Tt!==n)}function re(t,e){return[v+wt].indexOf(e.name)<0||!L.sJc(t).xUc}function ie(t,e){return[v+bt,v+Ct,v+yt,v+vt].indexOf(e.name)<0||!L.sJc(t).xUc}function ae(t,e){var o=e.name;return[v+ct,v+at,v+st,v+it].indexOf(o)<0||(!L.sJc(t).xUc||o!==v+st&&o!==v+it)}function se(t,e){var o,n,r,i,a,s=[v+dt,v+ot,v+tt,v+et],l=e.name;if(s.indexOf(l)<0)return!0;if(n=(o=L.sJc(t)).getActiveRowIndex(),r=o.getActiveColumnIndex(),o.comments){if(o.comments.get(n,r))return l!==v+dt;if(l===v+ot||l===v+tt)return!1;if(l===v+dt)return!0;for(i=o.getSelections(),a=0;a<i.length;a++)if(ue(i[a],o))return!0;return!1}}function le(t,e){var o,n,r,i,a,s;if(e.comments)for(o=e.comments.all(),r=n=void 0,i=0;i<t.length;i++)for(a=t[i],s=0;s<o.length;s++)if(!o[s].locked()&&(r=o[s].nT,n=o[s].oT,r>=a.row&&r<a.row+a.rowCount&&n>=a.col&&n<a.col+a.colCount))return 1}function ue(t,e){var o,n,r,i;if(e.comments)for(o=e.comments.all(),r=n=void 0,i=0;i<o.length;i++)if(r=o[i].nT,n=o[i].oT,r>=t.row&&r<t.row+t.rowCount&&n>=t.col&&n<t.col+t.colCount)return 1}function ce(t,e){var o,n,r,i,a;return[v+"sort",v+pt].indexOf(e.name)<0||!((o=L.sJc(t)).xUc||(!(n=o.getSelections())||1!==n.length||(i=fe(o,r=n[0]))&&(a=i.range(),r.row<a.row||r.col<a.col||r.row+r.rowCount>a.row+a.rowCount||r.col+r.colCount>a.col+a.colCount)))}function he(t){var e,o,n,r,i;if(t.xUc)return!1;if(e=t.getActiveRowIndex(),o=t.getActiveColumnIndex(),!t.tu().UHb)return!1;if(t.tables&&t.tables.find(e,o))return!1;for(n=t._modelManager.getSpans(),r=0;r<n.length;r++)if(e>=(i=n[r]).row&&e<i.row+i.rowCount&&o>=i.col&&o<i.col+i.colCount)return!1;return!0}function fe(t,e){var o,n,r;if(!e)return null;for(L.Ul.rXc(e,t.getRowCount(),t.getColumnCount()),o=e.row;o<e.row+e.rowCount;o++)for(n=e.col;n<e.col+e.colCount;n++)if(t.tables&&(r=t.tables.find(o,n)))return r;return null}function pe(t,e,o,n){var r,i;for(r=0;r<e.length;r++)(i=e[r]).PIb(o,n,!0,Zt,i.nKb())}function de(t){var e,o,n,r=t;for(e=0;e<r.length-1;e++)for(o=e+1;o<r.length;o++)r[e].row<r[o].row&&(n=r[e],r[e]=r[o],r[o]=n);return r}function ge(t){var e,o,n,r=t;for(e=0;e<r.length-1;e++)for(o=e+1;o<r.length;o++)r[e].col<r[o].col&&(n=r[e],r[e]=r[o],r[o]=n);return r}function me(t,e,o,n){var r=t._modelManager.getSpans(Zt,3);0<=e?(be(t,r,e,n,3),be(t,t._modelManager.getSpans(Zt,2),e,n,2)):0<=o&&(ye(t,r,o,n,3),ye(t,t._modelManager.getSpans(Zt,1),o,n,1))}function ye(t,e,o,n,r){var i,a,s,l,u,c,h;for(i=0,a=e.length;i<a;i++)if(o>(s=e[i]).col&&o<s.col+s.colCount)for(l=t.getStyle(s.row,s.col,r),u=o;u<o+n;u++)for(c=s.row;c<s.row+s.rowCount;c++)t.setStyle(c,u,l,r),c===s.row+s.rowCount-1&&((h=t.getCell(s.row+s.rowCount-1,s.col).borderBottom())&&t.getCell(c,u).borderBottom(h))}function be(t,e,o,n,r){var i,a,s,l,u,c,h;for(i=0,a=e.length;i<a;i++)if(o>=(s=e[i]).row&&o<=s.row+s.rowCount)for(l=t.getStyle(s.row,s.col,r),u=o;u<o+n;u++)for(c=s.col;c<s.col+s.colCount;c++)t.setStyle(u,c,l,r),c===s.col+s.colCount-1&&((h=t.getCell(s.row,s.col+s.colCount-1).borderRight())&&t.getCell(u,c).borderRight(h))}function ve(t,e,o,n,r){var i,a,s,l,u,c=L.uJc(t,e.sheetName);return!!c&&(i=e.considerAllSheets,a=t.yJc(),c.suspendPaint(),s=L.Commands.bWa(c.name()),o?(r&&r(c,e),i?L.Commands._xb(a,e):c._modelManager.undo(e[s])):(i?L.Commands.Zxb(a):c._modelManager.startTransaction(),l=n(c,e),i?L.Commands.$xb(a,e):e[s]=c._modelManager.endTransaction()),c.resumePaint(),i&&((u=L.sJc(t))&&c!==u&&u.repaint()),l)}function Ce(t,e,o){var n;if(0<o){for(n=e+1;n<t.getRowCount();n++)if((o-=t.getRowHeight(n))<=0)return n-e}else if(o<0)for(n=e-1;0<=n;n--)if(0<=(o+=t.getRowHeight(n)))return n-e;return 0}function we(t,e,o,n){var r=L.uJc(t,e.sheetName);r&&o.execute({cmd:xt,sheetName:r.name(),pasteOption:n})}function xe(n,r,t,i){return ve(n,r,t,function(t){var e,o=function(t){var e,o,n;if(t.slicers){if(!(e=t.slicers.all())||B(e))return null;for(n in o=[],e)e[n].isSelected()&&o.push(e[n]);return o}}(t);if(o&&0!==o.length){for(e in o)o.hasOwnProperty(e)&&o[e].sortState(i);n.changeSelectionInCommandExecuting(r,null,null,[],o)}})}function Te(t){t.Os(8,Kt().hideSheetFailureInfo)}function Ae(){this.menuView=new i.MenuView,this.menuData=[{text:Kt().copy,name:v+Rt,command:V+Rt,iconClass:s+Rt,workArea:c+z+W+h+p+"pivotTable"},{text:Kt().cut,name:v+Nt,command:V+Nt,iconClass:s+Nt,workArea:c+z+W+h+p},{text:Kt().pasteOptions,name:v+Tt,iconClass:s+Tt,type:"groupHeader",workArea:c+z+W+h+p},{command:V+It,name:v+It,iconClass:s+It,group:v+Tt,text:Kt().pasteAll,workArea:c+z+W+h+p},{command:V+Mt,name:v+Mt,iconClass:s+Mt,group:v+Tt,text:Kt().pasteFormula,workArea:c+z+W+p},{command:V+St,name:v+St,iconClass:s+St,group:v+Tt,text:Kt().pasteValues,workArea:c+z+W+p},{command:V+At,name:v+At,iconClass:s+At,group:v+Tt,text:Kt().pasteFormatting,workArea:c+z+W+p},{command:V+kt,name:v+kt,iconClass:s+kt,group:v+Tt,text:Kt().pasteValuesFormatting,workArea:c+z+W+p},{command:V+Et,name:v+Et,iconClass:s+Et,group:v+Tt,text:Kt().pasteFormulaFormatting,workArea:c+z+W+p},{text:Kt().paste,name:v+xt,command:V+St,iconClass:s+Tt,workArea:c+z+W+p},{type:Dt},{text:Kt().pinRows,name:v+lt,command:V+lt,workArea:W},{text:Kt().pinColumns,name:v+ut,command:V+ut,workArea:z},{type:Dt},{text:Kt().clearContents,command:V+wt,name:v+wt,workArea:c+z+W+p},{type:Dt},{text:Kt().headerInsertCopiedCells,name:v+W+Wt,command:V+W+Wt,workArea:W},{text:Kt().headerInsertCutCells,name:v+W+Gt,command:V+W+Gt,workArea:W},{text:Kt().headerInsertCopiedCells,name:v+z+Wt,command:V+z+Wt,workArea:z},{text:Kt().headerInsertCutCells,name:v+z+Gt,command:V+z+Gt,workArea:z},{text:Kt().insertCopiedCells,name:v+Wt,subMenu:[{text:Kt().shiftCellsRight,name:v+Wt+Jt,command:V+Wt+Jt,iconClass:s+Jt},{text:Kt().shiftCellsDown,name:v+Wt+Ut,command:V+Wt+Ut,iconClass:s+Ut}],workArea:c},{text:Kt().insertCutCells,name:v+Gt,subMenu:[{text:Kt().shiftCellsRight,name:v+Gt+Jt,command:V+Gt+Jt,iconClass:s+Jt},{text:Kt().shiftCellsDown,name:v+Gt+Ut,command:V+Gt+Ut,iconClass:s+Ut}],workArea:c},{text:Kt().insertRows,name:v+yt,command:V+yt,workArea:W},{text:Kt().insertColumns,name:v+bt,command:V+bt,workArea:z},{text:Kt().deleteRows,name:v+vt,command:V+vt,workArea:W},{text:Kt().deleteColumns,name:v+Ct,command:V+Ct,workArea:z},{type:Dt},{text:Kt().tableInsert,name:v+Ot,subMenu:[{text:Kt().tableInsertColumnsLeft,name:v+Ht,command:"tableInsertColumnsLeftForContextMenu",iconClass:s+Ht},{text:Kt().tableInsertColumnsRight,name:v+Bt,command:"tableInsertColumnsRightForContextMenu",iconClass:s+Bt},{text:Kt().tableInsertRowsAbove,name:v+Pt,command:"tableInsertRowsAboveForContextMenu",iconClass:s+Pt},{text:Kt().tableInsertRowsBelow,name:v+Lt,command:"tableInsertRowsBelowForContextMenu",iconClass:s+Lt}],workArea:"table"},{text:Kt().tableDelete,name:v+Ft,subMenu:[{text:Kt().tableDeleteColumns,name:v+zt,command:"tableDeleteColumnsForContextMenu",iconClass:s+zt},{text:Kt().tableDeleteRows,name:v+Vt,command:"tableDeleteRowsForContextMenu",iconClass:s+Vt}],workArea:"table"},{type:Dt},{text:Kt().insertSheet,name:v+mt,command:V+mt,workArea:f},{text:Kt().deleteSheet,name:v+gt,command:V+gt,workArea:f},{type:Dt},{text:Kt().filter,name:v+pt,command:V+pt,workArea:c+p},{text:Kt().sort,name:v+"sort",subMenu:[{text:Kt().sortAscend,name:v+ht,command:V+ht,iconClass:s+ht},{text:Kt().sortDescend,name:v+ft,command:V+ft,iconClass:s+ft}],workArea:c+p},{text:Kt().slicerSortAscend,name:v+jt,command:V+jt,iconClass:s+ht,workArea:h},{text:Kt().slicerSortDescend,name:v+_t,command:V+_t,iconClass:s+ft,workArea:h},{type:Dt},{text:Kt().insertComment,name:v+dt,command:V+dt,iconClass:s+dt,workArea:c+p},{text:Kt().editComment,name:v+ot,command:V+ot,iconClass:s+ot,workArea:c+p},{text:Kt().deleteComment,name:v+et,command:V+et,iconClass:s+et,workArea:c+p},{text:Kt().toggleComment,name:v+tt,command:V+tt,workArea:c+p},{type:Dt},{text:Kt().hideRows,name:v+st,command:V+st,workArea:W},{text:Kt().unhideRows,name:v+it,command:V+it,workArea:W},{text:Kt().hideColumns,name:v+ct,command:V+ct,workArea:z},{text:Kt().unhideColumns,name:v+at,command:V+at,workArea:z},{type:Dt},{text:Kt().hideSheet,name:v+rt,command:V+rt,workArea:f},{text:Kt().unhideSheet,name:v+nt,command:V+nt,workArea:f},{type:Dt},{text:Kt().removeSlicer,name:v+$,command:V+$,workArea:h},{type:Dt},{text:Kt().sort,name:v+"sort",subMenu:[{text:Kt().sortAscend,name:v+ht,command:"pivotSort",iconClass:s+ht,commandOptions:{subType:0},placeholder:T},{text:Kt().sortDescend,name:v+ft,command:"pivotSort",iconClass:s+ft,commandOptions:{subType:1},placeholder:T}],workArea:b},{text:Kt().pivotTableRefresh,name:m+k,command:k,iconClass:s+k,workArea:d+g+C+b+w+"pivotEmptyLabel"},{text:Kt().pivotTableRemove_,name:m+E,command:E,iconClass:s+E,workArea:d+g+C+b,placeholder:x},{text:Kt().pivotTableRemoveGrandTotal,name:m+D,command:D,workArea:w},{text:Kt().pivotTableSummarizeValuesBy,name:m+A,subMenu:[{text:Kt().pivotTableSum,name:v+"pivotSum",command:_,commandOptions:{subTotalType:8}},{text:Kt().pivotTableCount,name:v+"pivotCount",command:_,commandOptions:{subTotalType:1}},{text:Kt().pivotTableAverage,name:v+"pivotAverage",command:_,commandOptions:{subTotalType:0}},{text:Kt().pivotTableMax,name:v+"pivotMax",command:_,commandOptions:{subTotalType:3}},{text:Kt().pivotTableMin,name:v+"pivotMin",command:_,commandOptions:{subTotalType:4}},{text:Kt().pivotTableProduct,name:v+"pivotProduct",command:_,commandOptions:{subTotalType:5}}],workArea:g+C+w},{text:Kt().pivotTableShowValueAs,name:m+N,subMenu:[{text:Kt().pivotTableNoCalculation,name:v+"pivotNoCalculation",command:_,commandOptions:{showValueAsType:0}},{text:Kt().pivotTableGrandTotal,name:v+"pivotGrandtotal",command:_,commandOptions:{showValueAsType:1}},{text:Kt().pivotTableColumnTotal,name:v+"pivotColumnTotal",command:_,commandOptions:{showValueAsType:3}},{text:Kt().pivotTableRowTotal,name:v+"pivotRowTotal",command:_,commandOptions:{showValueAsType:2}},{text:Kt().pivotTableOf,name:v+"pivotOf",command:Q,commandOptions:{showValueAsType:4}},{text:Kt().pivotTableParentRowTotal,name:v+"pivotParentRowTotal",command:_,commandOptions:{showValueAsType:5}},{text:Kt().pivotTableParentColumnTotal,name:v+"pivotParentColumnTotal",command:_,commandOptions:{showValueAsType:6}},{text:Kt().pivotTableOfParentTotal,name:v+"pivotOfParentTotal",command:Q,commandOptions:{showValueAsType:7}},{text:Kt().pivotTableDifferenceFrom,name:v+"pivotDifferenceFrom",command:Q,commandOptions:{showValueAsType:8}},{text:Kt().pivotTablePercentDifferenceFrom,name:v+"pivotPercentDifferenceFro",command:Q,commandOptions:{showValueAsType:9}},{text:Kt().pivotTableRunningTotalIN,name:v+"pivotRunningTotalIn",command:Q,commandOptions:{showValueAsType:10}},{text:Kt().pivotTablePercentRunningTotalIn,name:v+"pivotPercentRunningTotalIn",command:Q,commandOptions:{showValueAsType:11}},{text:Kt().pivotTableRankSmallestToLargest,name:v+"pivotRankSmallestToLargest",command:Q,commandOptions:{showValueAsType:12}},{text:Kt().pivotTableRankLargestToSmallest,name:v+"pivotRankLargestToSmallest",command:Q,commandOptions:{showValueAsType:13}},{text:Kt().pivotTableIndex,name:v+"pivotIndex",command:_,commandOptions:{showValueAsType:14}}],workArea:g+C},{text:Kt().pivotTableFilter,name:m+O,iconClass:s+O,subMenu:[{text:Kt().pivotTableClearFilterFrom_,name:v+F,command:"ClearCommand",iconClass:s+F,placeholder:x,commandOptions:{clearType:0}},{text:Kt().pivotTableKeepOnlySelectedItems,name:v+P,command:X,commandOptions:{subType:1}},{text:Kt().pivotTableHideSelectedItems,name:v+G,command:X,commandOptions:{subType:2}},{text:Kt().pivotTableTop10,name:v+"pivotTop10",command:Y,commandOptions:{isTop10:!0}},{text:Kt().pivotTableLabelFilters,name:v+U,command:"createDialogForLabelFilter"},{text:Kt().pivotTableValueFilters,name:v+"pivotValueFilters",command:Y}],workArea:b},{text:Kt().pivotTableExpandOrCollapse,name:m+S,subMenu:[{text:Kt().pivotTableExpand,name:v+J,command:J,iconClass:s+J},{text:Kt().pivotTableCollapse,name:v+Z,command:Z,iconClass:s+Z},{text:Kt().pivotTableExpandEntireField,name:v+q,command:q,iconClass:s+q},{text:Kt().pivotTableCollapseEntireField,name:v+K,command:K,iconClass:s+K}],workArea:b},{text:Kt().pivotTableGroup,name:m+M,command:"OpenPivotGroupDialog",iconClass:s+M,workArea:b},{text:Kt().pivotTableUnGroup,name:m+I,command:I,iconClass:s+I,workArea:b},{text:Kt().pivotTableShowDetails,name:m+R,command:R,iconClass:s+R,workArea:C},{text:Kt().pivotTableValueFieldSettings,name:m+j,command:j,iconClass:s+j,workArea:g+C+w}]}Object.defineProperty(e,"__esModule",{value:!0}),n=o("@grapecity/js-sheets-common"),r=o("./dist/plugins/contextMenu/context-menu-dialog.js"),i=o("./dist/plugins/contextMenu/menu-view.js"),L=o("Core"),a=o("./dist/plugins/contextMenu/context-menu.ns.js"),l=L.GC$,H=n.Common.j.Fa,B=n.Common.j.za,u=L.Ul.nl,V="gc.spread.contextMenu.",v="gc.spread.",s="gc-spread-",m="gc.spread.pivot",y="gc-spread-pivot-selected",c="viewport",z="colHeader",W="rowHeader",h="slicer",f="sheetTab",p="corner",d="pivotPageFilter",g="pivotTopLeft",b="pivotHeader",C="pivotContent",w="pivotGrandTotal",x="FieldName",T="SortType",A="pivotSummarizeValuesBy",S="pivotExpandOrCollapse",M="pivotTableGroup",I="pivotTableUnGroup",N="pivotShowValueAs",R="pivotShowDetails",k="pivotRefresh",E="removeField",D="removePivotGrandTotal",j="openValueFieldSettingDialogCmd",_="UpdatePivotValueFieldCmd",O="pivotFilter",F="pivotClearFilterFrom",P="pivotKeepOnlySelectedItems",G="pivotHideSelectedItems",U="pivotLabelFilters",J="pivotExpand",Z="pivotCollapse",q="pivotExpandEntireField",K="pivotCollapseEntireField",Y="createDialogForValueFilter",Q="OpenPivotShowValueAsDialog",X="filterFieldLabelValue",$="removeSlicer",tt="toggleComment",et="deleteComment",ot="editComment",nt="unhideSheet",rt="hideSheet",it="unhideRows",at="unhideColumns",st="hideRows",lt="pinRows",ut="pinColumns",ct="hideColumns",ht="sortAscend",ft="sortDescend",pt="filter",dt="insertComment",gt="deleteSheet",mt="insertSheet",yt="insertRows",bt="insertColumns",vt="deleteRows",Ct="deleteColumns",wt="clearContents",xt="paste",Tt="pasteOptions",At="pasteFormatting",St="pasteValues",Mt="pasteFormula",It="pasteAll",Nt="cut",Rt="copy",kt="pasteValuesFormatting",Et="pasteFormulaFormatting",Dt="separator",jt="slicerSortAscend",_t="slicerSortDescend",Ot="tableInsert",Ft="tableDelete",Pt="tableInsertRowsAbove",Lt="tableInsertRowsBelow",Ht="tableInsertColumnsLeft",Bt="tableInsertColumnsRight",Vt="tableDeleteRows",zt="tableDeleteColumns",Wt="insertCopiedCells",Gt="insertCutCells",Ut="shiftCellsDown",Jt="shiftCellsRight",Zt=void 0,qt=new n.Common.ResourceManager(a.SR,"ContextMenu"),Kt=qt.getResource.bind(qt),Yt={sheetTab:function(t,e,o){return RegExp("sheetTab","i").test(o.workArea)&&t.tabStripHitInfo&&t.tabStripHitInfo.sheetTab&&"newSheet"!==t.tabStripHitInfo.sheetTab.sheetName},outline:function(t,e,o){return!!(RegExp("outline","i").test(o.workArea)&&t.worksheetHitInfo&&t.worksheetHitInfo.outlineHitInfo)},viewport:function(t,e,o){if(RegExp("viewport","i").test(o.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&!t.worksheetHitInfo.floatingObjectHitInfo&&!t.worksheetHitInfo.shapeHitInfo&&!t.worksheetHitInfo.pivotTableInfo&&!t.worksheetHitInfo.commentHitInfo)return ne(e,o)&&re(e,o)&&se(e,o)&&ce(e,o)&&(a=e,[v+Wt].indexOf(o.name)<0||(s=L.sJc(a),(l=s.tu())&&!l.G4&&l.n5&&1===l.n5.length&&1===s.getSelections().length&&he(s)))&&(n=e,[v+Gt].indexOf(o.name)<0||(r=L.sJc(n),(i=r.tu())&&i.G4&&i.n5&&1===i.n5.length&&1===r.getSelections().length&&he(r)));var n,r,i,a,s,l},rowHeader:function(t,e,o){if(RegExp("rowHeader","i").test(o.workArea)&&t.worksheetHitInfo&&2===t.worksheetHitInfo.hitTestType)return ne(e,o)&&re(e,o)&&ie(e,o)&&ae(e,o)&&function(t,e){var o,n,r,i,a,s,l,u;if([v+W+Wt,v+W+Gt].indexOf(e.name)<0)return!0;if((o=L.sJc(t)).xUc)return!1;if(n=o.tu(),r=o.getActiveRowIndex(),o.tables)for(i=o.tables.all(),a=0;a<i.length;a++)if(s=i[a],r>s.cj&&r<s.cj+s.Xj)return!1;for(l=o._modelManager.getSpans(),a=0;a<l.length;a++)if(u=l[a],r>u.row&&r<u.row+u.rowCount)return!1;if(!n.UHb||n.n5&&1!==n.n5.length||1!==o.getSelections().length)return!1;if(e.name===v+W+Gt){if(n.G4&&n.n5&&o.getColumnCount()%n.n5[0].colCount==0)return!0}else if(e.name===v+W+Wt&&!n.G4&&n.n5&&o.getColumnCount()%n.n5[0].colCount==0)return!0;return!1}(e,o)},colHeader:function(t,e,o){if(RegExp("colHeader","i").test(o.workArea)&&t.worksheetHitInfo&&1===t.worksheetHitInfo.hitTestType)return ne(e,o)&&re(e,o)&&ie(e,o)&&ae(e,o)&&function(t,e){var o,n,r,i,a,s,l,u;if([v+z+Wt,v+z+Gt].indexOf(e.name)<0)return!0;if((o=L.sJc(t)).xUc)return!1;if(n=o.tu(),r=o.getActiveColumnIndex(),o.tables)for(i=o.tables.all(),a=0;a<i.length;a++)if(s=i[a],r>s.dj&&r<s.dj+s.OZ)return!1;for(l=o._modelManager.getSpans(),a=0;a<l.length;a++)if(u=l[a],r>u.col&&r<u.col+u.colCount)return!1;if(!n.UHb||n.n5&&1!==n.n5.length||1!==o.getSelections().length)return!1;if(e.name===v+z+Wt){if(!n.G4&&n.n5&&o.getRowCount()%n.n5[0].rowCount==0)return!0}else if(e.name===v+z+Gt&&n.G4&&n.n5&&o.getRowCount()%n.n5[0].rowCount==0)return!0;return!1}(e,o)},corner:function(t,e,o){if(RegExp("corner","i").test(o.workArea)&&t.worksheetHitInfo&&0===t.worksheetHitInfo.hitTestType)return ne(e,o)&&re(e,o)&&se(e,o)&&ce(e,o)},slicer:function(t,e,o){return RegExp("slicer","i").test(o.workArea)&&t.worksheetHitInfo&&t.worksheetHitInfo.floatingObjectHitInfo&&t.worksheetHitInfo.floatingObjectHitInfo.floatingObject&&"Slicer"===t.worksheetHitInfo.floatingObjectHitInfo.floatingObject.typeName},chart:function(t,e,o){return RegExp("chart","i").test(o.workArea)&&t.worksheetHitInfo&&t.worksheetHitInfo.floatingObjectHitInfo&&t.worksheetHitInfo.floatingObjectHitInfo.floatingObject&&"2"===t.worksheetHitInfo.floatingObjectHitInfo.floatingObject.typeName},shape:function(t,e,o){return RegExp("shape","i").test(o.workArea)&&t.worksheetHitInfo&&t.worksheetHitInfo.shapeHitInfo},table:function(t,e,o){var n=L.sJc(e).tables;return RegExp("table","i").test(o.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&!t.worksheetHitInfo.floatingObjectHitInfo&&!t.worksheetHitInfo.shapeHitInfo&&!t.worksheetHitInfo.pivotTableInfo&&!t.worksheetHitInfo.commentHitInfo&&n&&n.mKb()},vpWithoutTb:function(t,e,o){if(RegExp("vpWithoutTb","i").test(o.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&!t.worksheetHitInfo.floatingObjectHitInfo&&!t.worksheetHitInfo.shapeHitInfo&&!t.worksheetHitInfo.pivotTableInfo&&!t.worksheetHitInfo.commentHitInfo){var n=L.sJc(e).tables;return!(n&&n.mKb())&&ne(e,o)&&re(e,o)&&se(e,o)&&ce(e,o)}},pivotTablePageFilterArea:function(t,e,o){var n=L.sJc(e).pivotTables;return RegExp("pivotPageFilter","i").test(o.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo&&0===t.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableCornerArea:function(t,e,o){var n=L.sJc(e).pivotTables;return RegExp("pivotTopLeft","i").test(o.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo&&1===t.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableEmptyLabelArea:function(t,e,o){var n=L.sJc(e).pivotTables;return RegExp("pivotEmptyLabel","i").test(o.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo&&3===t.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableHeaderArea:function(t,e,o){var n=L.sJc(e).pivotTables;return RegExp("pivotHeader","i").test(o.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo&&2===t.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableGrandTotalArea:function(t,e,o){var n=L.sJc(e).pivotTables;return RegExp("pivotGrandTotal","i").test(o.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo&&5===t.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableContentArea:function(t,e,o){var n=L.sJc(e).pivotTables;return RegExp("pivotContent","i").test(o.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo&&4===t.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTable:function(t,e,o){var n=L.sJc(e).pivotTables;return RegExp("pivotTable","i").test(o.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo}},Qt=[],Ae.prototype.ad=function(t){this.Mma||(this.wu=t.commandManager(),H(this.Ela)&&(this.Ela=new r.ContextMenuViewDialog(t.xv(),l(t.sv))),this.nla(t),this.kTa={filter:{menuDataDict:[v+pt],checkFunction:function(t){if(t.rowFilter)return!0}},comments:{menuDataDict:[v+dt,v+ot,v+et,v+tt],checkFunction:function(t){if(t.comments)return!0}},slicer:{menuDataDict:[v+jt,v+_t,v+$],checkFunction:function(t){if(t.slicers)return!0}},floatingObject:{menuDataDict:[v+St,v+At,v+Mt],checkFunction:function(t){var e;return!t.BR||!((e=t.BR().fromSheet)&&e.CR)||void 0}},table:{menuDataDict:[v+Ot,v+Ft],checkFunction:function(t){if(t.tables)return!0}},tableSheet:{menuDataDict:[v+xt,v+lt,v+ut],checkFunction:function(t){if(t.xUc)return!0}}},this.Mma=!0)},Ae.prototype.ola=function(t,e){var o,n,r,i,a,s,l;return e.focus(),o=this.pla(t,e),n=L.sJc(e),H(o)||H(n)?void u(t):(r={row:n.getActiveRowIndex(),col:n.getActiveColumnIndex()},void(n.isEditing()&&o.worksheetHitInfo&&o.worksheetHitInfo.col===r.col&&o.worksheetHitInfo.row===r.row||e.getTab()&&e.getTab().FD||(this.ad(e),this.qla(o,e),i=n.getSelections()[0],H(i)||H(n.pivotTables)||(a=n.pivotTables.findPivotTable(i.row,i.col),!H(a)&&o.worksheetHitInfo&&(s=(o.worksheetHitInfo.pivotTableInfo=a).getPivotInfoImp(i.row,i.col,!1,!1,!0),H(s)||(o.worksheetHitInfo.pivotTableCellInfo=s))),l=this.Fla(this.menuData,o,e),this.onOpenMenu(this.menuData,l,o,e)||(u(t),l.length&&this.jla(l,o,e)))))},Ae.prototype.qla=function(t,e){this.Ela.Loa(t)&&this.sla(t,e)},Ae.prototype.sla=function(t,e){var o=L.sJc(e);o.isEditing()&&o.endEdit(),this.tla(t)?this.ula(t,e):this.vla(t)&&this.wla(t,e)},Ae.prototype.vla=function(t){return!!t.worksheetHitInfo},Ae.prototype.xla=function(t,e,o,n){var r,i,a=!0;if(1===n){for(r=0;r<t.length;r++)-1===(i=t[r]).row&&o>=i.col&&o<i.col+i.colCount&&(a=!1);return a}if(2===n){for(r=0;r<t.length;r++)-1===(i=t[r]).col&&e>=i.row&&e<i.row+i.rowCount&&(a=!1);return a}for(r=0;r<t.length;r++)if((i=t[r]).contains(e,o))return!1;return!0},Ae.prototype.tla=function(t){return!(!t.tabStripHitInfo||!t.tabStripHitInfo.sheetTab)},Ae.prototype.yla=function(t){return t.tabStripHitInfo.sheetTab.sheetName},Ae.prototype.nMc=function(t){return t.tabStripHitInfo.sheetTab.sheetIndex},Ae.prototype.wla=function(t,e){var o=L.sJc(e),n=t.worksheetHitInfo;n.floatingObjectHitInfo||n.commentHitInfo||n.shapeHitInfo||(this.Ala(o,n),this.aPa(o))},Ae.prototype.aPa=function(t){var e,o=t.getActiveRowIndex(),n=t.getActiveColumnIndex(),r=t.comments;!r||(e=r.get(o,n))&&r.bU===e&&r.hT(e)},Ae.prototype.zla=function(t){return 3===t.hitTestType},Ae.prototype.cs=function(t,e,o){t.cs&&t.cs(e,o)},Ae.prototype.Ala=function(t,e){var o,n,r=t._modelManager.getSelections(),i=e.row,a=e.col;t.Qs(e.rowViewportIndex<0?-1:e.row,e.colViewportIndex<0?-1:e.col)&&(o=!1,this.xla(r,i,a,e.hitTestType)?o=!0:0<(n=(t.shapes&&t.shapes.all()||[]).filter(function(t){return t.isSelected()})).length&&(n.forEach(function(t){return t.isSelected(!1)}),o=!0),o&&(t._eventHandler.Ala(t,e,i,a),t._eventHandler.hH()))},Ae.prototype.ula=function(t,e){var o=this.nMc(t),n=e.XJc(o);n&&(n.DHb()||(e.yJc().forEach(function(t){t.DHb()&&t.DHb(!1,!0)}),n.DHb(!0,!0)),e.ZJc(o,2,!1,!0),this.$Oa(this.menuData,t,e))},Ae.prototype.pla=function(t,e){var o=e.oia(),n=t.pageX-o.left,r=t.pageY-o.top;return e.hitTest(n,r,!0)},Ae.prototype.onOpenMenu=function(t,e,o,n){},Ae.prototype.jla=function(t,e,o){this.Ela.Loa(e)&&(this.Cla(),o.xw(),this.Dla(t,e,o))},Ae.prototype.Cla=function(){this.Ela.close()},Ae.prototype.Dla=function(t,e,o){this.Ela.OT(this.menuView,t,e.x,e.y,o)},Ae.prototype.Fla=function(t,e,o){var n,r={};return l.extend(!0,r,t),n=this.oMc(r,e,o),this.J$a(n,e),this.lTa(n,o),this.oKb(n,o),this.UZa(n,o),this.RZa(n),n=this.Bma(n),this.pKb(n),n},Ae.prototype.oMc=function(t,n,r){var i=this,a=[];return l.each(t,function(t,o){H(o)||(o.type===Dt&&a.push(o),l.each(Yt,function(t,e){e(n,r,o)&&i.pMc(o,n)&&a.push(o)}))}),a},Ae.prototype.qMc=function(t,e,o){var n,r,i,a,s,l=o.placeholder,u=o.name,c=e.area,h=e.value,f=e.menuArea,p=e.colHeadFieldInfo,d=e.rowInfos,g=e.colInfos,m=e.cornerFieldInfo,y=e.activeRowFieldInfo,b=e.activeColFieldInfo;if(H(l))u===v+U&&(a=y&&y.name||b&&b.name||p&&p.fieldName||m&&m.fieldName,s=t.vic,a&&s.getFieldInfoByName(a)&&2===s.getFieldInfoByName(a).ny&&(o.text=Kt().pivotTableLabelFilters_Date));else if(l===x){if(n=void 0,0===f)n=e.pageFieldInfo.fieldName;else if(2===c&&2===f){if(p)n=p.fieldName;else if(n=b&&b.name,H(n)){for(r=b.index;0<=r&&g[r]&&H(g[r].itemName);)--r;n=g[r].fieldName}}else if(3===c&&2===f){if(n=y&&y.name,H(n)){for(r=y.index;0<=r&&d[r]&&H(d[r].itemName);)--r;n=d[r].fieldName}}else 1===c?1===f?n=e.value:2===f&&m&&(n=m.fieldName):4===f&&(n=e.valueFieldName,2===c?n=b&&b.name||h:3===c&&(n=y&&y.name||h));o.text=o.text.replace("{0}",'"'+n+'"')}else l===T&&4===f&&(n=void 0,0===(i=o.commandOptions.subType)?n=Kt().pivotTableSortAscend:1===i&&(n=Kt().pivotTableSortDescend),o.text=n);H(o.commandOptions)&&(o.commandOptions={}),o.commandOptions.pivotTableName=t.name(),o.commandOptions.pivotTableCellInfo=e},Ae.prototype.pKb=function(t){var e,o,n=0,r=!1;for(e=0;e<t.length&&((o=t[e].name)!==v+W+Wt&&o!==v+W+Gt&&o!==v+z+Wt&&o!==v+z+Gt||(r=!0),o!==v+yt&&o!==v+bt||(n=e,!r));e++);r&&t.splice(n,1)},Ae.prototype.J$a=function(t,e){var o=e.worksheetHitInfo;!o||o.row!==Zt&&o.col!==Zt||t.splice(0,t.length)},Ae.prototype.lTa=function(i,t){var a=this,s=L.sJc(t),e=a.kTa;return l.each(e,function(t,e){var o,n,r;if(!e.checkFunction(s))for(n=0,r=(o=e.menuDataDict).length;n<r;n++)a.hma(i,o[n],function(t,e){t[e]=null})}),i},Ae.prototype.pMc=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d=this,g=e.worksheetHitInfo&&e.worksheetHitInfo.pivotTableInfo;if(g&&(o=e.worksheetHitInfo&&e.worksheetHitInfo.pivotTableCellInfo)){if(n=g.options.subtotalsPosition,r=o.value,i=o.area,a=o.menuArea,s=o.cornerFieldInfo,l=o.colHeadFieldInfo,u=o.activeRowFieldInfo,c=o.activeColFieldInfo,h=o.rowInfos,f=o.colInfos,p=o.valueFieldName,-1<[m+S,m+O,m+R].indexOf(t.name)&&((2===i||3===i)&&4===a||(!H(s)||!H(l))&&r===Kt().sigmaValueTemp||3===i&&u&&h[u.index].isSubtotal&&void 0===h[u.index].collapseIndex&&1!==n||2===i&&c&&f[c.index].isSubtotal&&void 0===f[c.index].collapseIndex&&1!==n))return!1;if(-1<[m+M,m+I].indexOf(t.name)&&(!H(s)||!H(l)))return!1;if(-1<[m+j,m+E,m+A,m+N].indexOf(t.name)&&H(p)&&4===a&&4===i)return!1;t&&t.subMenu?t.subMenu.forEach(function(t){d.qMc(g,o,t),d.rMc(g,o,t)}):d.qMc(g,o,t)}return!0},Ae.prototype.rMc=function(t,e,o){var n,r,i,a,s,l=e.activeRowFieldInfo,u=e.activeColFieldInfo,c=e.cornerFieldInfo,h=e.colHeadFieldInfo,f=e.valueFieldName,p=l&&l.name||u&&u.name||h&&h.fieldName||c&&c.fieldName||f,d=t.vic,g=p&&d.getFieldInfoByName(p);switch(o.commandOptions&&g&&(n=o.commandOptions.showValueAsType,r=o.commandOptions.subTotalType,H(n)||(g.pNc&&g.pNc.showDataAs||0)===n&&(o.iconClass=y),H(r)||g.getSubTotalType()===r&&(o.iconClass=y)),o.name){case v+F:a=!1,(i=g&&g.Dhc)&&i.labelFilter&&i.Bhc()&&(a=!0),s=!!i&&i.Chc(),a||s||(o.disable=!0);break;case v+P:case v+G:H(c)&&H(h)||(o.disable=!0)}},Ae.prototype.oKb=function(t,e){var n,r,i,o=L.sJc(e),a=o.getSelections();a&&0<a.length&&(n=fe(o,a[0]),r=o.getActiveRowIndex(),i=o.getActiveColumnIndex(),n&&l.each(t,function(t,e){if(!H(e)&&e.name===v+Ot){var o=e.subMenu;n.checkTableLastRow(r)&&o.splice(3,1),n.checkTableLastCol(i)&&o.splice(1,1)}}))},Ae.prototype.RZa=function(t){var e;for(e=t.length-1;0<e;e--)t[e]?t[e].subMenu&&this.RZa(t[e].subMenu):t.splice(e,1);return t},Ae.prototype.Bma=function(t){var e,o,n,r,i,a=[],s=t.length;for(e=0;e<s;e++)t[e]&&t[e].type===Dt&&t[e+1]&&t[e+1].type===Dt||a.push(t[e]);for(s=a.length,i=r=!(n=o=0),e=0;e<s&&(r&&a[e].type===Dt?o++:r=!1,i&&a[s-1-e].type===Dt?n++:i=!1,r||i);e++);return a.splice(s-n,n),a.splice(0,o),a},Ae.prototype.UZa=function(t,e){this.VZa(t,e),this.QZa(t,e)},Ae.prototype.VZa=function(t,e){var o,n=L.sJc(e),r=n.tables;for(o=0;o<t.length;o++)if(t[o]){switch(t[o].name){case v+yt:n.ZZa()||(t[o].disable=!0);break;case v+vt:(!n.ZZa()||r&&r.containTableHeaderTotalRowForSheet())&&(t[o].disable=!0);break;case v+bt:case v+Ct:n.$Za()||(t[o].disable=!0);break;case v+Pt:r&&(r.isAcrossTables()||r.containTableHeader()||r.noRoomToInsertRow())&&(t[o].disable=!0);break;case v+Lt:r&&(r.isAcrossTables()||r.noRoomToInsertRow())&&(t[o].disable=!0);break;case v+Vt:r&&(r.checkTableRow()||r.isAcrossTables()||r.containTableHeaderTotalRow())&&(t[o].disable=!0);break;case v+Ht:case v+Bt:r&&(r.isAcrossTables()||r.noRoomToInsertColumn())&&(t[o].disable=!0);break;case v+zt:r&&(r.checkTableCol()||r.isAcrossTables()||r.isWholeTableCol())&&(t[o].disable=!0)}t[o]&&t[o].subMenu&&this.VZa(t[o].subMenu,e)}},Ae.prototype.QZa=function(t,e){var o,n,r,i,a=L.sJc(e),s=a.options.isProtected,l=a.options.protectionOptions;if(s&&l)for(o=void 0,n=0;n<t.length;n++)if(t[n]){switch(t[n].name){case v+yt:l.allowInsertRows||(t[n].disable=!0);break;case v+bt:l.allowInsertColumns||(t[n].disable=!0);break;case v+vt:l.allowDeleteRows||(t[n].disable=!0);break;case v+Ct:l.allowDeleteColumns||(t[n].disable=!0);break;case v+pt:l.allowFilter||(t[n].disable=!0);break;case v+ht:case v+ft:l.allowSort||(t[n].disable=!0);break;case v+st:case v+it:case v+ct:case v+at:a.xUc||(t[n].disable=!0);break;case v+jt:case v+_t:l.allowEditObjects||t.splice(0,t.length);break;case v+dt:l.allowEditObjects||(t[n]=null);break;case v+ot:r=void 0,a.comments&&(r=(o=a.comments.get(a.getActiveRowIndex(),a.getActiveColumnIndex()))&&o.lockText()),!l.allowEditObjects&&r&&(t[n]=null);break;case v+et:i=void 0,a.comments&&(i=!le(a.getSelections(),a)),!l.allowEditObjects&&i&&(t[n]=null);break;case v+Pt:case v+Lt:case v+Ht:case v+Bt:case v+Vt:case v+zt:t[n].disable=!0}t[n]&&t[n].subMenu&&this.QZa(t[n].subMenu,e)}},Ae.prototype.$Oa=function(t,e,o){var n,r,i;if(e.tabStripHitInfo&&(n=o.yJc(),r=this.RS(v+nt))){for(i=0;i<n.length;i++)if(!n[i].visible())return void(r.disable=!1);r.disable=!0}},Ae.prototype.RS=function(t){return this.gma(this.menuData,t)},Ae.prototype.gma=function(t,e){var o;return this.hma(t,e,function(t,e){o=t[e]}),o},Ae.prototype.hma=function(t,e,o){for(var n=t.length,r=0;r<n;r++)if(!H(t[r])){if(e===t[r].name)return void o(t,r);t[r].subMenu&&this.hma(t[r].subMenu,e,o)}},Ae.prototype.nla=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O=t.commandManager(),F={canUndo:!1,execute:function(t,e){var o=L.uJc(t,e.sheetName);o&&($t(o)?O.execute({cmd:"copyFloatingObjects",sheetName:o.name()}):O.execute({cmd:Rt,sheetName:o.name(),ignoreClipboard:!0}))}};function P(t,e,o){var n,r;for(n=0;n<o;n++)r=e+n,-1===t.indexOf(r)&&t.push(r);return t}O.register(V+Rt,F,null,!1,!1,!1,!1),e={canUndo:!1,execute:function(t,e){var o=L.uJc(t,e.sheetName);o&&($t(o)?O.execute({cmd:"cutFloatingObjects",sheetName:o.name()}):O.execute({cmd:Nt,sheetName:o.name(),ignoreClipboard:!0}))}},O.register(V+Nt,e,null,!1,!1,!1,!1),o={canUndo:!1,execute:function(t,e){var o=L.uJc(t,e.sheetName);o&&(o.isPasteFloatingObject&&o.isPasteFloatingObject()?O.execute({cmd:"pasteFloatingObjects",sheetName:o.name()}):o.isPasteShapes&&o.isPasteShapes()?O.execute({cmd:"pasteShapes",sheetName:o.name()}):O.execute({cmd:xt,sheetName:o.name(),pasteOption:0}))}},O.register(V+It,o,null,!1,!1,!1,!1),n={canUndo:!1,execute:function(t,e){var o=L.uJc(t,e.sheetName);o&&O.execute({cmd:xt,sheetName:o.name(),pasteOption:0,shiftCells:L.InsertShiftCell.right})}},O.register(V+Wt+Jt,n,null,!1,!1,!1,!1),O.register(V+Gt+Jt,n,null,!1,!1,!1,!1),O.register(V+z+Wt,n,null,!1,!1,!1,!1),O.register(V+z+Gt,n,null,!1,!1,!1,!1),r={canUndo:!1,execute:function(t,e){var o=L.uJc(t,e.sheetName);o&&O.execute({cmd:xt,sheetName:o.name(),pasteOption:0,shiftCells:L.InsertShiftCell.down})}},O.register(V+Wt+Ut,r,null,!1,!1,!1,!1),O.register(V+Gt+Ut,r,null,!1,!1,!1,!1),O.register(V+W+Wt,r,null,!1,!1,!1,!1),O.register(V+W+Gt,r,null,!1,!1,!1,!1),i={canUndo:!1,execute:function(t,e){we(t,e,O,3)}},O.register(V+Mt,i,null,!1,!1,!1,!1),a={canUndo:!1,execute:function(t,e){we(t,e,O,1)}},O.register(V+St,a,null,!1,!1,!1,!1),s={canUndo:!1,execute:function(t,e){var o=L.uJc(t,e.sheetName);o&&O.execute({cmd:xt,sheetName:o.name(),pasteOption:2})}},O.register(V+At,s,null,!1,!1,!1,!1),l={canUndo:!1,execute:function(t,e){we(t,e,O,4)}},O.register(V+kt,l,null,!1,!1,!1,!1),u={canUndo:!1,execute:function(t,e){we(t,e,O,5)}},O.register(V+Et,u,null,!1,!1,!1,!1),c={canUndo:!1,execute:function(t,e){var o=L.uJc(t,e.sheetName);o&&O.execute({cmd:"clear",sheetName:o.name()})}},O.register(V+wt,c,null,!1,!1,!1,!1),h={canUndo:!0,execute:function(v,t,e){return ve(v,t,e,function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d=e.commentState||2,g=e.displayMode,m=e.activeRow,y=e.activeCol,b=t.comments.add(m,y,"");b&&(b.commentState(d),g&&b.displayMode(g),o=t.Er(m),n=t.Fr(y),r=t.getCellRect(m,y,o,n),i=t.am().Ft(o,n),a=b.location(),s=b.width(),l=b.height(),f=h=c=u=void 0,p=v.ku,r.y+a.y<i.y?(h=Ce(t,m,r.y+a.y-i.y),u=p.ms(t,h),p.ju(t,u.cj,0),t.os()):r.y+a.y+l>i.y+i.height&&(h=Ce(t,m,r.y+a.y+l-(i.y+i.height)),u=p.ms(t,h),p.ju(t,u.cj,0),t.os()),r.x+a.x+s>i.x+i.width&&(f=function(t,e,o){var n;if(0<o){for(n=e+1;n<t.getColumnCount();n++)if((o-=t.getColumnWidth(n))<=0)return n-e}else if(o<0)for(n=e-1;0<=n;n--)if(0<=(o+=t.getColumnWidth(n)))return n-e;return 0}(t,y,r.x+a.x+s-(i.x+i.width)),c=p.Sw(t,f),p.lu(t,c.dj,0),t.qs()))},function(t,e){var o=e.activeRow,n=e.activeCol,r=t.comments.get(o,n);r&&(e.displayMode=r.displayMode(),e.commentState=r.commentState())})}},O.register(V+dt,h,null,!1,!1,!1,!1),f={canUndo:!1,execute:function(t,e){var o,n,r,i=L.uJc(t,e.sheetName);i&&(o=e.activeRow,n=e.activeCol,(r=i.comments.get(o,n))&&r.commentState(2))}},O.register(V+ot,f,null,!1,!1,!1,!1),p={canUndo:!0,execute:function(t,l,e){return ve(t,l,e,function(t){var e,o,n,r,i,a=l.selections,s=a.length;if(!(s<=0))for(e=0;e<s;e++)for(n=(o=a[e]).row;n<o.row+o.rowCount;n++)for(r=o.col;r<o.col+o.colCount;r++)!(i=t.comments.get(n,r))||t.options.isProtected&&!t.options.protectionOptions.allowEditObjects&&i.locked()||O.execute({cmd:et,sheetName:t.name(),row:i.nT,col:i.oT})})}},O.register(V+et,p,null,!1,!1,!1,!1),d={canUndo:!1,execute:function(t,e){var o,n,r,i=L.uJc(t,e.sheetName);i&&(o=e.activeRow,n=e.activeCol,(r=i.comments.get(o,n))&&(2===r.displayMode()?r.displayMode(1):r.displayMode(2)))}},O.register(V+tt,d,null,!1,!1,!1,!1),g={canUndo:!0,execute:function(t,p,e){return p.considerAllSheets=!0,ve(t,p,e,function(t){var e,o,n,r,i,a,s,l,u,c,h,f=de(p.selections);for(o=0;o<f.length;o++){for(e=f[o],n=t.getRange(e.row-1,0,1,e.colCount),r=[],i=0;i<n.colCount;i++)t.getCell(n.row,i).locked()||r.push(i);for(a=e.row,s=e.rowCount,t.addRows(a,s),l=0;l<r.length;l++)for(u=f[o].row;u<f[o].row+f[o].rowCount;u++)t.getCell(u,r[l]).locked(!1);if(t.tables&&0<s)for(c=t.tables.s$(a,-1,s,-1),h=0;h<c.length;h++)c[h].PIb(a,s,!1,!1);me(t,a,-1,s)}})}},O.register(V+yt,g,null,!1,!1,!1,!1),m={canUndo:!0,execute:function(t,p,e){return p.considerAllSheets=!0,ve(t,p,e,function(t){var e,o,n,r,i,a,s,l,u,c,h,f=ge(p.selections);for(o=0;o<f.length;o++){for(e=f[o],n=t.getRange(0,e.col-1,e.rowCount,1),r=[],i=0;i<n.rowCount;i++)t.getCell(i,n.col).locked()||r.push(i);for(a=e.col,s=e.colCount,t.addColumns(a,s),l=0;l<r.length;l++)for(u=a;u<a+s;u++)t.getCell(r[l],u).locked(!1);if(t.tables&&0<s)for(c=t.tables.s$(-1,a,-1,s),h=0;h<c.length;h++)c[h].QIb(a,s,!1,!1);me(t,-1,a,s)}})}},O.register(V+bt,m,null,!1,!1,!1,!1),y={canUndo:!0,execute:function(t,f,e){return f.considerAllSheets=!0,ve(t,f,e,function(t){var e,o,n,r,i,a,s,l,u=de(f.selections),c=t.filterRowsVisibleInfo&&t.filterRowsVisibleInfo.rowsVisibleInfo,h=c&&0<Object.keys(c).length;for(e=0;e<u.length;e++)if(n=(o=u[e]).row,r=o.rowCount,i=t.getRowCount(),h)for(s=(a=ee(o,c)).length-1;0<=s;s--)n=a[s][0],r=a[s][1],l=t.tables&&t.tables.s$(n,-1,r,-1),t.deleteRows(n,r),0<l.length&&0<i-t.getRowCount()&&(i=t.getRowCount(),pe(0,l,n,r));else l=t.tables&&t.tables.s$(n,-1,r,-1),t.deleteRows(n,r),0<l.length&&0<i-t.getRowCount()&&pe(0,l,n,r)})}},O.register(V+vt,y,null,!1,!1,!1,!1),b={canUndo:!0,execute:function(t,l,e){return l.considerAllSheets=!0,ve(t,l,e,function(t){var e,o,n,r,i,a,s=ge(l.selections);for(e=0;e<s.length;e++)if(o=t.getColumnCount(),n=s[e].col,r=s[e].colCount,i=void 0,t.tables&&(i=t.tables.s$(-1,n,-1,r)),t.deleteColumns(n,r),t.tables&&0<o-t.getColumnCount())for(a=0;a<i.length;a++)i[a].QIb(n,r,!0)})}},O.register(V+Ct,b,null,!1,!1,!1,!1),v={canUndo:!1,execute:function(t){var e,o,n=t.getActiveSheetIndex(),r=[],i=L.sJc(t),a=t.vv(t._getDefaultSheetName(n));t.yJc().forEach(function(t){t.DHb()&&r.push(t)}),r.forEach(function(t){t.DHb(!1,!0)}),e={sheetName:a.name(),propertyName:"insertSheet",cancel:!1,sheetIndex:n},t.Wq(L.Events.SheetChanging,e),e.cancel||(o={oldSheet:i,newSheet:a},t.Wq(L.Events.ActiveSheetChanging,o),t.ow(Math.max(0,n),2,a),a.DHb(!0,!0),t.Wq(L.Events.SheetChanged,{sheetName:a.name(),propertyName:"insertSheet",sheetIndex:n}),t.Wq(L.Events.ActiveSheetChanged,{oldSheet:i,newSheet:a}))}},O.register(V+mt,v,null,!1,!1,!1,!1),C={canUndo:!1,execute:function(s){var n,l,u,t,c=L.sJc(s),e=s.yJc();1<e.length?(n=[],l=[],e.forEach(function(t,e){if(t.DHb()){var o=t.name();n.push(o),l.push(e)}}),n.length!==e.length?1<=n.length&&(u={oldSheet:c,cancel:!1},n.forEach(function(t,e){var o,n,r=l[e],i=L.uJc(s,t),a={sheetName:t,propertyName:"deleteSheet",cancel:!1,sheetIndex:r};i===c&&s.Wq(L.Events.ActiveSheetChanging,u),s.Wq(L.Events.SheetChanging,a),u.cancel||a.cancel||(o=s.getSheetIndex(t),!H(o)&&0<=o?(s.removeSheet(o),-1===s.getActiveSheetIndex()&&s.setActiveSheetTab(0)):(o=s.getSheetTabIndex(t),!H(o)&&0<=o&&(s.removeSheetTab(o),-1===s.getActiveSheetTabIndex()&&s.setActiveSheetIndex(0))),s.Wq(L.Events.SheetChanged,{sheetName:t,propertyName:"deleteSheet",sheetIndex:r}),n=L.sJc(s),i===c&&s.Wq(L.Events.ActiveSheetChanged,{oldSheet:i,newSheet:n}))}),(t=L.sJc(s)).isSelected()||t.DHb(!0,!0)):Te(c)):Te(c),s.undoManager().clear()}},O.register(V+gt,C,null,!1,!1,!1,!1),w={canUndo:!0,execute:function(t,a,e){return ve(t,a,e,function(t){var e,o=a.selections[0],n=fe(t,o),r=a.activeRow,i=a.activeCol;n?n.range().contains(r,i,1,1)&&(e=n.name(),O.execute({cmd:"contextmenuFilterForTable",sheetName:t.name(),cmdOption:{tableName:e,activeRow:r,activeCol:i,expectedText:t.getText(r,i)}})):t.rowFilter&&O.execute({cmd:"contextmenuFilterForSheet",sheetName:t.name(),cmdOption:{activeRow:r,activeCol:i,selection:o,expectedText:t.getText(r,i)}})})}},O.register(V+pt,w,null,!1,!1,!1,!1),x={canUndo:!0,execute:function(t,s,e){return ve(t,s,e,function(t){var e=s.activeCol,o=s.selections,n=fe(t,o[0]),r=n?n.dataRange():o[0],i=t.oec(r,!0,null),a={sheet:t,sheetName:t.name(),col:e,ascending:!0,range:r,compareFunction:Zt,groupSort:i.groupSort,ignoreHidden:i.ignoreHidden,cancel:!1};t.Wq(L.Events.RangeSorting,a),!1===a.cancel&&(t.sortRange(r.row,r.col,r.rowCount,r.colCount,!0,[{index:e,ascending:!0,compareFunction:a.compareFunction}],{groupSort:a.groupSort,ignoreHidden:a.ignoreHidden},Zt,!!n),t.Wq(L.Events.RangeSorted,a))})}},O.register(V+ht,x,null,!1,!1,!1,!1),T={canUndo:!0,execute:function(t,s,e){return ve(t,s,e,function(t){var e=s.activeCol,o=s.selections,n=fe(t,o[0]),r=n?n.dataRange():o[0],i=t.oec(r,!0,null),a={sheet:t,sheetName:t.name(),col:e,ascending:!1,range:r,compareFunction:Zt,groupSort:i.groupSort,ignoreHidden:i.ignoreHidden,cancel:!1};t.Wq(L.Events.RangeSorting,a),!1===a.cancel&&(t.sortRange(r.row,r.col,r.rowCount,r.colCount,!0,[{index:e,ascending:!1,compareFunction:a.compareFunction}],{groupSort:a.groupSort,ignoreHidden:a.ignoreHidden},Zt,!!n),t.Wq(L.Events.RangeSorted,a))})}},O.register(V+ft,T,null,!1,!1,!1,!1),A={canUndo:!0,execute:function(t,e,o){return xe(t,e,o,1)}},O.register(V+jt,A,null,!1,!1,!1,!1),S={canUndo:!0,execute:function(t,e,o){return xe(t,e,o,2)}},O.register(V+_t,S,null,!1,!1,!1,!1),M={canUndo:!0,execute:function(t,a,e){return ve(t,a,e,function(t){var e,o,n,r,i=a.selections;if(0<i.length){for(e=[],o=0,n=i;o<n.length;o++)P(e,(r=n[o]).row,r.rowCount);try{t.xUc.togglePinnedRows(e)}catch(t){return!1}}})}},O.register(V+lt,M,null,!1,!1,!1,!1),I={canUndo:!0,execute:function(t,a,e){return ve(t,a,e,function(t){var e,o,n,r,i=a.selections;if(0<i.length){for(e=[],o=0,n=i;o<n.length;o++)P(e,(r=n[o]).col,r.colCount);try{t.xUc.togglePinnedColumns(e)}catch(t){return!1}}})}},O.register(V+ut,I,null,!1,!1,!1,!1),N={canUndo:!0,execute:function(t,o,e){return ve(t,o,e,function(e){t.suspendCalcService(),te(o.selections,"row",function(t){e.setRowVisible(t,!1)}),t.resumeCalcService()})}},O.register(V+st,N,null,!1,!1,!1,!1),R={canUndo:!0,execute:function(t,o,e){return ve(t,o,e,function(e){t.suspendCalcService(),te(o.selections,"col",function(t){e.setColumnVisible(t,!1)}),t.resumeCalcService()})}},O.register(V+ct,R,null,!1,!1,!1,!1),k={canUndo:!1,execute:function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g=0,m=t.yJc();if(m.forEach(function(t){t.visible()&&(g+=1)}),e=L.sJc(t),g<=1)Te(e);else{if(n=[],m.forEach(function(t){t.DHb()&&n.push(t)}),g!==n.length){for(r=0;r<n.length;r++)l={sheetName:a=(i=n[r]).name(),propertyName:"isVisible",cancel:!1,sheetIndex:s=t.getSheetIndex(a),oldValue:!0,newValue:!1},t.Wq(L.Events.SheetChanging,l),u={cancel:!1,oldSheet:i},a===e.name()&&t.Wq(L.Events.ActiveSheetChanging,u),l.cancel||u.cancel||(i.DHb(!1,!0),Qt.push(i),i.visible(!1),c=L.sJc(t),r!==n.length-1||c.isSelected()||(o={oldValue:!1,newValue:!0,sheetName:h=c.name(),propertyName:"isSelected",cancel:!1,sheetIndex:t.getSheetIndex(h)},t.Wq(L.Events.SheetChanging,o)),t.Wq(L.Events.SheetChanged,{sheetName:a,propertyName:"isVisible",sheetIndex:s,oldValue:!0,newValue:!1}));p=(f=L.sJc(t)).name(),o&&(o.cancel?f._modelManager.CHb(!1):(f._modelManager.CHb(!0),t&&t.YJc&&t.YJc.repaint(),d={oldValue:!1,newValue:!0,sheetName:p,propertyName:"isSelected",sheetIndex:t.getSheetIndex(p)},t.Wq(L.Events.SheetChanged,d))),e!==f&&t.Wq(L.Events.ActiveSheetChanged,{oldSheet:e,newSheet:f})}else Te(e);t.undoManager().clear()}}},O.register(V+rt,k,null,!1,!1,!1,!1),E={canUndo:!0,execute:function(n,r,t){return ve(n,r,t,function(e){var t=r.selections,o=r.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol;H(o)&&(o=r.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol=oe(e,t[0])),1===t.length&&o?(e.setRowVisible(t[0].row-1,!0),e.mq(t[0].row-1)):(n.suspendCalcService(),te(t,"row",function(t){e.setRowVisible(t,!0),t===e._t()&&(e.lq=0,e.os())}),n.resumeCalcService())})}},O.register(V+it,E,null,!1,!1,!1,!1),D={canUndo:!0,execute:function(n,r,t){return ve(n,r,t,function(e){var t=r.selections,o=r.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol;H(o)&&(o=r.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol=oe(e,t[0])),1===t.length&&o?(e.setColumnVisible(t[0].col-1,!0),e.rq(t[0].col-1)):(n.suspendCalcService(),te(t,"col",function(t){e.setColumnVisible(t,!0),t===e.$t()&&(e.qq=0,e.qs())}),n.resumeCalcService())})}},O.register(V+at,D,null,!1,!1,!1,!1),j={canUndo:!1,execute:function(t){var e,o,n,r,i,a,s=t.yJc();if(0===Qt.length)for(e=0;e<s.length;e++)s[e].visible()||(Qt.push(s[e]),s[e].DHb(!1));if(o=L.sJc(t),0<Qt.length){if(s.forEach(function(t){t!==o&&t.DHb(!1,!0)}),i={sheetName:r=(n=Qt.pop()).name(),propertyName:"isVisible",cancel:!1,sheetIndex:t.getSheetIndex(r),oldValue:!1,newValue:!0},t.Wq(L.Events.SheetChanging,i),i.cancel)return;if(n.visible(!0),t.Wq(L.Events.SheetChanged,{sheetName:r,propertyName:"isVisible",sheetIndex:t.getSheetIndex(r),oldValue:!1,newValue:!0}),a={oldSheet:o,newSheet:n,cancel:!1},t.Wq(L.Events.ActiveSheetChanging,a),a.cancel)return;t.setActiveSheet(n.name())}L.sJc(t)!==o&&(t.focus(!0),t.Wq(L.Events.ActiveSheetChanged,{oldSheet:o,newSheet:L.sJc(t)}))}},O.register(V+nt,j,null,!1,!1,!1,!1),_={canUndo:!1,execute:function(t,e){var o,n,r,i=L.uJc(t,e.sheetName);if(i&&(t.suspendPaint(),o=[],(n=i.slicers.all())&&!B(n))){for(r in n)n[r].isSelected()&&o.push(n[r].name());0<o.length&&O.execute({cmd:"deleteFloatingObjects",sheetName:i.name(),floatingObjects:o}),t.resumePaint()}}},O.register(V+$,_,null,!1,!1,!1,!1)},Xt=Ae,e.ContextMenu=Xt,L.Workbook.$n("contextmenu",{setHost:function(){var e=this,t=e._host;e.contextMenu||(e.contextMenu=new Xt),l(t).bind("contextmenu.gcSheet",function(t){if(e.options.allowContextMenu)return e.contextMenu.ola(t,e)})},dispose:function(){l(this._host).unbind("contextmenu.gcSheet")},onCultureChanged:function(){var e,t=Kt(),n=this.contextMenu;n&&(e=n.menuData,l.each(t,function(t,o){n.hma(e,v+t,function(t,e){t[e].text=o})}))}})},"./dist/plugins/contextMenu/context-menu.ns.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("./dist/plugins/contextMenu/context-menu.res.en.js");e.SR={en:n}},"./dist/plugins/contextMenu/context-menu.res.en.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.copy="Copy",e.cut="Cut",e.pasteOptions="Paste Options:",e.pasteAll="All",e.pasteFormula="Formulas",e.pasteValues="Values",e.pasteFormatting="Formatting",e.pasteValuesFormatting="Values&Formatting",e.pasteFormulaFormatting="Formula&Formatting",e.clearContents="Clear Contents",e.insertRows="Insert",e.insertColumns="Insert",e.deleteRows="Delete",e.deleteColumns="Delete",e.insertSheet="Insert",e.deleteSheet="Delete",e.insertComment="Insert Comment",e.filter="Filter",e.sort="Sort",e.insertCopiedCells="Insert Copied Cells...",e.insertCutCells="Insert Cut Cells...",e.shiftCellsRight="Shift Cells Right",e.shiftCellsDown="Shift Cells Down",e.headerInsertCopiedCells="Insert Copied Cells",e.headerInsertCutCells="Insert Cut Cells",e.slicerSortAscend="Sort A to Z",e.slicerSortDescend="Sort Z to A",e.sortAscend="Sort A to Z",e.sortDescend="Sort Z to A",e.hideRows="Hide",e.hideColumns="Hide",e.hideSheet="Hide",e.unhideSheet="Unhide",e.unhideColumns="Unhide",e.unhideRows="Unhide",e.editComment="Edit Comment",e.deleteComment="Delete Comment",e.toggleComment="Show/Hide Comment",e.removeSlicer="Remove",e.removeFloatingObject="Remove",e.tableInsert="Insert",e.tableInsertRowsAbove="Table Rows Above",e.tableInsertRowsBelow="Table Row Below",e.tableInsertColumnsLeft="Table Columns to the Left",e.tableInsertColumnsRight="Table Columns to the Right",e.tableDelete="Delete",e.tableDeleteRows="Table Rows",e.tableDeleteColumns="Table Columns",e.hideSheetFailureInfo="A workbook must contain at least one visible worksheet.\nTo hide, delete or move the selected sheet(s), you must first insert a new sheet or unhide a sheet that is already hidden.",e.pivotTableRefresh="Refresh",e.pivotTableMove="Move",e.pivotTableRemove_="Remove {0}",e.pivotTableRemoveGrandTotal="Remove GrandTotal",e.pivotTableValueFieldSettings="Value Field Settings...",e.pivotTableOptions="PivotTable Options...",e.pivotTableNumberFormat="Number Format...",e.pivotTableSort="Sort",e.pivotTableSummarizeValuesBy="Summarize Values By",e.pivotTableSum="Sum",e.pivotTableCount="Count",e.pivotTableAverage="Average",e.pivotTableMax="Max",e.pivotTableMin="Min",e.pivotTableProduct="Product",e.pivotTableDistinctCount="Distinct Count",e.pivotTableMoreOptions="More Options",e.pivotTableShowValueAs="Show Value As",e.pivotTableNoCalculation="No Calculation",e.pivotTableGrandTotal="% of Grand Total",e.pivotTableColumnTotal="% of Column Total",e.pivotTableRowTotal="% of Row Total",e.pivotTableOf="% Of...",e.pivotTableParentRowTotal="% of Parent Row Total",e.pivotTableParentColumnTotal="% of Parent Column Total",e.pivotTableOfParentTotal="% of Parent Total...",e.pivotTableDifferenceFrom="Difference From...",e.pivotTablePercentDifferenceFrom="% Difference From...",e.pivotTableRunningTotalIN="Running Total In...",e.pivotTablePercentRunningTotalIn="% Running Total In...",e.pivotTableRankSmallestToLargest="Rank Smallest to Largest...",e.pivotTableRankLargestToSmallest="Rank Largest to Smallest...",e.pivotTableIndex="Index",e.pivotTableShowDetails="Show Details",e.pivotTableGroup="Group...",e.pivotTableUnGroup="Ungroup...",e.pivotTableExpandOrCollapse="Expand/Collapse",e.pivotTableFilter="Filter",e.pivotTableSubtotal_="Subtotal {0}",e.pivotTableHideFieldList="Hide Field List",e.pivotTableFieldSettings="Field Settings...",e.pivotTableClearFilterFrom_="Clear Filter From {0}",e.pivotTableKeepOnlySelectedItems="Keep Only Selected Items",e.pivotTableHideSelectedItems="Hide Selected Items",e.pivotTableTop10="Top 10...",e.pivotTableLabelFilters="Label Filters...",e.pivotTableLabelFilters_Date="Date Filters...",e.pivotTableValueFilters="Value Filters...",e.pivotTableExpand="Expand",e.pivotTableCollapse="Collapse",e.pivotTableExpandEntireField="Expand Entire Field",e.pivotTableCollapseEntireField="Collapse Entire Field",e.pivotTableCollapseTo_="Collapse to {0}",e.pivotTableExpandTo_="Expand to {0}",e.pivotTableMove_ToBeginning="Move {0} to Beginning",e.pivotTableMove_Up="Move {0} Up",e.pivotTableMove_Down="Move {0} Down",e.pivotTableMove_ToEnd="Move {0} to end",e.pivotTableMove_ToLeft="Move {0} to left",e.pivotTableMove_ToRight="Move {0} to Right",e.pivotTableMove_ToColumns="Move {0} to columns",e.sigmaValue="∑ Values",e.sigmaValueTemp="Values",e.pivotTableSortAscend="Sort Smallest to Largest",e.pivotTableSortDescend="Sort Largest to Smallest",e.pinRows="Pin/Unpin Rows",e.pinColumns="Pin/Unpin Columns",e.paste="Paste"},"./dist/plugins/contextMenu/menu-view.js":function(t,e,o){"use strict";var n,h,g,c,r,m,f,i,y,b,a,s,l,p,u,d,v,C,w,x,T;function A(){}Object.defineProperty(e,"__esModule",{value:!0}),n=o("@grapecity/js-sheets-common"),h=o("Core"),g=h.GC$,c=h.Ul.Nl,r=n.Common.j,m=r.Fa,f=r.Aa,i=r.C4,y=document,a=(b={qKb:"mouseenter",rKb:"mouseleave",sKb:"click",tKb:"gc.command.executed",uKb:".",vKb:"gc-ui-contextmenu",wKb:"-",xKb:"container",yKb:"hover",zKb:"disable-hover",AKb:"text",BKb:"icon",CKb:"menuitem",DKb:"nonselective-menuitem",EKb:"menuitem-content",FKb:"sup-container",GKb:"separator",HKb:"sup-indicator",IKb:"subitems-container",JKb:"group-container",KKb:"title",LKb:"group-header",MKb:"groupitems-container",NKb:"groupitem",OKb:"nonexecutable",PKb:"executable",QKb:"disable",sXc:"gcUIElement",tXc:"gcContextMenu",RKb:"gc-statusbar-contextmenu",SKb:" ui-widget",TKb:" ui-state-hover",UKb:" ui-icon ui-icon-triangle-1-e",VKb:"DIV",WKb:"SPAN",XKb:"keydown.ctx.gcSheet",YKb:"none",ZKb:"inline-block",$Kb:"visible",_Kb:"hidden"}).vKb+b.wKb+b.yKb,s=b.vKb+b.wKb+b.CKb,l=b.vKb+b.wKb+b.DKb,p=b.vKb+b.wKb+b.EKb,u=b.vKb+b.wKb+b.PKb,d=b.vKb+b.wKb+b.FKb,v=b.vKb+b.wKb+b.IKb,C=b.RKb+b.wKb+"check",w=b.RKb+b.wKb+"check-container",x=b.RKb+b.wKb+"content",T=b.RKb+b.wKb+"status",A.prototype.ai=function(t,e,o,n){var r=this;r._host=g(t),r.lla=i(e),r.wu=o.commandManager(),r.xc=o,r.Eu=n,r.LQ=[],r.YPa={},r.rQa=[],r.ZPa=null,r.lma()},A.prototype.mma=function(){var t,e,o,n,r,i,a,s=this,l=parseInt(s._host.css("left"),10),u=parseInt(s._host.css("top"),10),c=s._host.width(),h=s._host.height(),f=g(s.xc.getHost()),p=f.width(),d=s.hostInfo;m(d)?(n=f.height(),p<l+c&&(l=0<l-c?l-c:l,s._host.css("left",l)),n<u+h&&(h<u?u-=h:h<=n?u=n-h:(r=s._host.css("display"),s._host.css("display",b.YKb),u+h<(i=y.documentElement.scrollHeight)-(a=f.offset().top)||h<i&&(u=n+(i-a-n)-h),s._host.css("display",r)),s._host.css("top",u))):(t=d.top,e=d.width,o=d.height,e<l+c&&(l=0<l-c?l-c:l,s._host.css("left",l)),window.innerHeight-t-o<t&&(u-=h,s._host.css("top",u)))},A.prototype.lma=function(){var t,e,o=this.lla;m(o)||!(o instanceof Object)||o.length<1||(o instanceof Array||(o=[o]),t=this.nma("menuView",o),this.YPa.menuView=t,(e=this.oma(this.lla)).appendTo(this._host),this.mma(),this.QQ(),this.rQa.push({name:"menuView",menuView:e}))},A.prototype.nma=function(t,e){for(var o,n=e.length,r=0,i=[];r<n;r++)o=e[r],m(o)||"separator"===o.type||(o.subMenu?this.YPa[o.name]=this.nma(o.name,o.subMenu):"groupHeader"===o.type&&(this.pma(o,e),this.YPa[o.name]=this.nma(t,o.groups)),i.push(this.qma(t,o)));return i},A.prototype.qma=function(t,e){var o,n,r;if(o="groupHeader"===e.type?this.$Pa():this.rma(),n=this.createMenuItemElement(e),!m(n))return n instanceof HTMLElement&&(n=g(n)),n.appendTo(o),r={name:e.name,host:o,menuItemData:e,menuName:t},this.LQ.push(r),r},A.prototype.rma=function(){var t=g(c(b.VKb));return t.addClass(s),t},A.prototype.$Pa=function(){var t=g(c(b.VKb));return t.addClass(l),t},A.prototype.createMenuItemElement=function(t){var e=t.type;return"groupHeader"===e?this.tma(t):"groupItem"===e?this.uma(t):"statusBar"===e?this.Eyb(t):t.subMenu?this.vma(t):this.wma(t)},A.prototype.wma=function(t){var e,o,n=g(c(b.VKb)).addClass(p);return t.command?t.disable?n.addClass(b.vKb+b.wKb+b.QKb):n.addClass(u):n.addClass(b.vKb+b.wKb+b.OKb),e=g(c(b.WKb)).addClass(b.vKb+b.wKb+b.BKb),t.iconClass&&e.addClass(t.iconClass),e.appendTo(n),t.text&&((o=g(c(b.WKb)).addClass(b.vKb+b.wKb+b.AKb))[0].innerHTML=t.text,o.appendTo(n)),n},A.prototype.sma=function(t){return g(c(b.VKb)).addClass(b.vKb+b.wKb+b.GKb)},A.prototype.tma=function(t){var e,o,n,r,i,a,s=g(c(b.VKb)).addClass(b.vKb+b.wKb+b.JKb);if(t.groups.length<=0)return s;for((e=this.wma(t)).addClass(b.vKb+b.wKb+b.LKb),e.appendTo(s),o=g(c(b.VKb)).addClass(b.vKb+b.wKb+b.MKb),r=(n=t.groups).length,i=0;i<r;i++)(a=this.xma("name",n[i].name).host).addClass(b.vKb+b.wKb+b.NKb),a.appendTo(o);return o.appendTo(s),s},A.prototype.uma=function(t){var e=this.wma(t);return e.find(b.uKb+b.vKb+b.wKb+b.AKb).remove(),e.attr(b.KKb,t.text),e},A.prototype.Eyb=function(t){var e,o,n,r=c("div"),i=g(r).addClass(p),a=t.visible,s=t.menuContent,l=t.status,u=c("div");return g(u).addClass(C),e=c("div"),g(e).addClass(w),e.appendChild(u),e.style.visibility=a?b.$Kb:b._Kb,(o=c("div")).innerText=s,g(o).addClass(x),n=c("div"),g(n).addClass(T),l?(n.innerText=l,n.style.display=b.ZKb):n.style.display=b.YKb,r.appendChild(e),r.appendChild(o),r.appendChild(n),i},A.prototype.vma=function(t){var e,o=g(c(b.VKb)).addClass(d),n=this.wma(t);return 0<t.subMenu.length&&(g(c(b.WKb)).addClass(b.vKb+b.wKb+b.HKb+b.UKb).appendTo(n),(e=this.oma(t.subMenu)).addClass(v),e.appendTo(o)),n.appendTo(o),o},A.prototype.oma=function(t){for(var e,o,n,r=g(c(b.VKb)).addClass(b.vKb+b.wKb+b.xKb+b.SKb),i=t.length,a=0;a<i;a++)m(t[a])||(e=t[a].name,m(e)?"separator"===t[a].type&&(n=this.$Pa(),this.sma(t[a]).appendTo(n),n.appendTo(r)):(o=this.xma("name",e),m(o)||o.host.appendTo(r)));return r},A.prototype.xma=function(t,e){for(var o=this.LQ,n=o.length,r=0;r<n;r++)if(e instanceof g?e[0]===o[r][t][0]:o[r][t]===e)return o[r]},A.prototype.pma=function(t,e){var o,n,r;for(t.groups=[],o=e.length,n=0;n<o;n++)(r=e[n])&&r.group&&r.group===t.name&&(r.type="groupItem",t.groups.push(r),e.splice(n,1),n--)},A.prototype.QQ=function(){var r=this;g(b.uKb+s).bind(b.qKb,function(){var t,e,o=g(this),n=r.xma("host",o);for(r.ZPa=n,t=0,e=r.rQa.length;t<e&&n.menuName!==r.rQa[e-t-1].name;t++)r.Ooa();r._Pa(),r.cQa(!1)}).bind(b.rKb,function(){r.ZPa=null,r._Pa()}).bind(b.sKb,function(t){var e=g(this),o=r.xma("host",e);r.ZPa=o,r.aQa(!1,t)&&r.WT()}),g(y).bind(b.XKb,function(t){var e,o;if(!t.target||g(t.target).attr(b.sXc)!==b.tXc){switch(t.keyCode){case 27:r.Ooa()||r.WT();break;case 32:case 13:r.aQa(!0,t)&&r.WT();break;case 9:t.shiftKey?r.bQa(!1,!0):r.bQa(!0,!0);break;case 37:e=r.Ooa(),(o=r.xma("name",e))&&(r.ZPa=o),r.ZPa&&r.ZPa.menuItemData.group&&r.bQa(!1,!0);break;case 38:r.bQa(!1,!1);break;case 39:r.ZPa&&r.ZPa.menuItemData.group&&r.bQa(!0,!0),r.cQa(!0);break;case 40:r.bQa(!0,!1)}t.preventDefault?t.preventDefault():t.returnValue=!1}})},A.prototype.Noa=function(t){var e,o,n,r,i=t.offset().left,a=t.width();i+a>(window.scrollX||window.pageXOffset)+window.innerWidth&&t.css("left",-a),e=t.offset().top,o=t.height(),n=t.position().top,e+o>(r=window.scrollY||window.pageYOffset)+window.innerHeight&&t.css("top",n-(e+o-(r+window.innerHeight)))},A.prototype.zma=function(t){return t.command},A.prototype.getCommandOptions=function(t,e,o){},A.prototype.aQa=function(t,e){var o,n=this.ZPa;if(n&&!n.menuItemData.disable)return(o=n.menuItemData).subMenu?void(0<o.subMenu.length&&this.cQa(t)):(this.h4(e),!0)},A.prototype.h4=function(t){var e,o,n,r,i,a,s,l,u=this.ZPa,c=this.zma(u.menuItemData);m(c)||(e=this.getCommandOptions(u.menuItemData,u.host[0],t),o=this.wu,f(c)?c(this.xc,e):(r=(n=h.sJc(this.xc)).getActiveColumnIndex(),i=n.getActiveRowIndex(),a=n.tables&&n.tables.find(i,r),s=n.pivotTables&&n.pivotTables.findPivotTable(i,r),m(s)?o.execute({cmd:c,sheetName:n.name(),selections:n.getSelections(),activeRow:i,activeCol:r,commandOptions:e,tableName:a?a.name():""}):(l=u.menuItemData.commandOptions,m(l)&&(l={}),m(l.pivotTableName)&&(l.pivotTableName=s.name()),m(l.pivotTableCellInfo)&&(l.pivotTableCellInfo=s.getPivotInfoImp(i,r,!1,!1,!0)),o.execute({cmd:c,sheetName:n.name(),selections:n.getSelections(),activeRow:i,activeCol:r,commandOptions:l}))))},A.prototype.Tla=function(){g(b.uKb+s).unbind(b.qKb).unbind(b.rKb).unbind(b.sKb),g(y).unbind(b.XKb)},A.prototype.no=function(){this._host=null,this.lla=null,this.wu=null,this.xc=null,this.Eu=null,this.LQ=null,this.YPa=null,this.ZPa=null,this.Tla()},A.prototype.Ooa=function(){var t;if(1<this.rQa.length)return(t=this.rQa.pop()).menuView.find(b.uKb+s).removeClass(a+b.TKb),t.menuView.hide(),t.name},A.prototype._Pa=function(){var t,e,o=this.dQa(!0);if(o){for(t=0,e=o.length;t<e;t++)o[t].host.removeClass(a+b.TKb);this.ZPa&&(this.ZPa.menuItemData.disable?this.ZPa.host.addClass(b.vKb+b.wKb+b.zKb+b.TKb):this.ZPa.host.addClass(a+b.TKb))}},A.prototype.WT=function(){this.Eu.trigger(b.tKb),this.no()},A.prototype.bQa=function(t,e){var o,n,r,i=this.dQa(e);this.ZPa&&((o=this.eQa(this.ZPa,i))||(n=this.YPa[this.ZPa.menuItemData.group])&&(r=n[0],o=this.eQa(r,i))),o=t?(void 0!==o&&o!==i.length-1||(o=-1),"number"==typeof o?o+1:0):(void 0!==o&&0!==o||(o=i.length),"number"==typeof o?o-1:0),this.ZPa=i[o],this._Pa()},A.prototype.dQa=function(t){for(var e,o,n,r=this.rQa[this.rQa.length-1].name,i=this.YPa[r],a=0,s=i.length,l=[];a<s;a++)if("groupHeader"!==i[a].menuItemData.type)l.push(i[a]);else if(e=this.YPa[i[a].menuItemData.name],t)for(o=0,n=e.length;o<n;o++)l.push(e[o]);else l.push(e[0]);return l},A.prototype.eQa=function(t,e){var o,n=e.length;for(o=0;o<n;o++)if(t.name===e[o].name)return o},A.prototype.cQa=function(t){var e,o,n=this.ZPa;!n||(e=n.menuItemData).subMenu&&0<e.subMenu.length&&(e.name!==this.rQa[this.rQa.length-1].name&&((o=g(n.host.find(b.uKb+v)[0])).show(),this.Noa(o),this.rQa.push({name:e.name,menuView:o})),this.ZPa=null,t&&this.bQa(!0,!1))},e.MenuView=A},"./dist/plugins/data/binding.js":function(t,e,o){"use strict";var d,n,g,r,i,l,u,y,b,c,a,v,C,s,m,h;function f(t){this.ad(t)}function p(t){this._source=t}function w(t,e,o){var n,r,i,a,s,l,u,c,h,f=t,p=f.Ou,d={value:y,hasBinding:!1};if(!p)return d;if(n=f.kj,(r=f.CL)===C){if(s=n?n.getBindingPath(e,o):y)return{value:p.getValue(s),hasBinding:!0}}else{if(e<0||t.getRowCount()<=e)return d;if(l=n?n.getColumnCount():t.getColumnCount(),o<0||l<=o)return d;if(n?(f.qia||(f.qia=n._modelManager.Hp(!1,3)),(i=f.qia[o])&&(a=i.name)):t.HL&&(f.qia?(i=f.qia[o])&&(a=i.dataField):a=t.HL[o]),r)return u=v[r],h=A(c=i&&i.value)?c:y,u.getValue(p,h,a,e,o)}return d}function x(t,e){return t&&e&&e!==C?v[e].getProperties(t):y}function T(t){return h&&t instanceof h}function A(t){return t instanceof Function}function S(t,e,o){var n,r,i,a,s;if(t&&e){if(n=t[e],!u(n))return void(A(n)?t[e](o):t[e]=o);for(i=(r=e.split(".")).length,a=0;a<i&&(s=r[a],t);a++)a===i-1?A(t[s])?t[s](o):t[s]=o:t=A(t[s])?(u(t[s]())&&t[s]({}),t[s]()):(u(t[s])&&(t[s]={}),t[s])}}function M(t,e,o){var n,r,i,a,s;if(!t||!e)return y;if(n=t[e],!u(n))return A(n)?n():n;r=null,o?(r=o[e])||(r=e.split("."),o[e]=r):r=e.split("."),i=r.length,a=0;do{if(t=A(t[s=r[a]])?t[s]():t[s],u(t))return y;++a}while(a<i);return t}function I(){this.pathCache={}}Object.defineProperty(e,"__esModule",{value:!0}),d=o("Core"),n=o("Core"),g=n.GC$,r=o("@grapecity/js-sheets-common"),i=o("./dist/plugins/data/data.ns.js"),l=g.isNumeric,u=r.Common.j.Fa,y=null,b=void 0,c="string",e.yL=a,v=e.yL=a={},C="cellBinding",s=new r.Common.ResourceManager(i.SR,"Bindings"),m=s.getResource.bind(s),d.Workbook.$n("binding",{onCultureChanged:function(){m()}}),p.prototype.setValue=function(t,e){S(this._source,t,e)},p.prototype.getValue=function(t){return M(this._source,t)},p.prototype.getSource=function(){return this._source},h=p,e.CellBindingSource=h,f.prototype.bind=function(n,t){var e,o,r,i,a,s,l,u,c,h=this,f=h.kj,p=h.Ou;if(t&&h.tUa(t,{type:"bind",oldDataSource:p}),p&&(p.lka&&(p.subscribe=p.lka,delete p.mka,delete p.lka),A(p.dispose)&&p.dispose()),h.zL(h.AL),h.zL(h.BL),h.ad(f),h.Ou=n){if(!(e=h.CL=(s=y,(a=n)&&(T(a)?s=C:g.each(v,function(t,e){if(e.isDataSource(a))return s=t,!1})),s)))throw Error(m().Exp_NotSupportedDataSource);h.DL=h.EL(),f&&g[g.sd]({tc:f.parent}),f&&(o=h.AL,r=n.currentPosition,n.subscribe&&o.push(n.subscribe(h.FL,h)),r&&r.subscribe&&o.push(r.subscribe(h.GL,h)),A(n.subscribe)&&!n.lka&&(i=n.lka=n.subscribe,n.mka=!1,n.subscribe=function(t,e){var o=[].concat.apply([],arguments);return o[0]=function(){if(!n.mka&&A(t))return t.apply(e,arguments)},i.apply(n,o)}),h.Lx()),h.HL=x(n,e)}return u=n,!(!(c=(l=f)&&l.wq)||!c.xL(u)||(l.clearPendingChanges(),d.Worksheet.ao(l,"initBinding",{sheet:l,data:u}),0))},f.prototype.Lx=function(){var t,e,o,n,r,i=this.kj,a=this.Ou;if(i&&a&&(t=this.CL,this.zL(this.BL),e=y,t!==C&&(o=i.getActiveRowIndex(),e=a.currentPosition?(-1<=o&&o<a.count()&&a.currentPosition(o),a.currentItem()):this.ru(o)),e))for(r in n=function(){i&&i.repaint()},e)e[r]&&A(e[r].subscribe)&&this.BL.push(e[r].subscribe(n,y,y))},f.prototype.zL=function(t){var e,o;if(t)for(e=0;e<t.length;e++)(o=t[e])&&A(o.dispose)&&o.dispose()},f.prototype.getRowCount=function(){var t=this.Ou,e=this.CL,o=0;return t&&e&&e!==C&&(o=v[e].getDataLength(t)),o},f.prototype.getColumnCount=function(){var t,e,o,n=this.HL;return n?n.length:(t=this.Ou)&&(e=t[0],"null"===(o=g.getType(e))||o===c||"number"===o)?1:0},f.prototype.getSource=function(){return this.Ou},f.prototype.rL=function(){return this.HL},f.prototype.Nka=function(t){this.HL=t},f.prototype.ru=function(t){var e=this.Ou,o=this.CL,n=y;return e&&o&&o!==C&&(n=v[o].getDataItem(e,t)),n},f.prototype.EL=function(){var t,e,o;if(!this.DL)for(t=this.getRowCount(),e=0;e<t;e++)if(o=this.ru(e)){this.DL=o.entityAspect&&o.entityType||o.constructor;break}return this.DL},f.prototype.getValue=function(t,e){return w(this,t,e)},f.prototype.setValue=function(t,e,o,n){var r;return n&&(r=w(this,t,e).value,this.tUa(n,{type:"setValue",row:t,col:e,oldValue:r})),function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d=t,g=d.Ou,m=!1;if(!g)return m;if(r=d.kj,(i=d.CL)===C)(l=r?r.getBindingPath(e,o):y)&&(g.setValue(l,n),m=!0);else{if(e<0||t.getRowCount()<=e)return m;if(u=r?r.getColumnCount():t.getColumnCount(),o<0||u<=o)return m;r?(d.qia||(d.qia=r._modelManager.Hp(!1,3)),(a=d.qia[o])&&(s=a.name)):t.HL&&(d.qia?(a=d.qia[o])&&(s=a.dataField):s=t.HL[o]),i&&(c=v[i],h=a&&a.value,f=A(h)?h:y,p=r&&r.onItemUpdated?r.onItemUpdated.bind(r):b,m=c.setValue(g,f,s,e,o,n,p))}return m}(this,t,e,o)},f.prototype.sL=function(){var t=v[this.CL];return t&&t.canAdd&&t.canAdd()},f.prototype.tL=function(){var t=v[this.CL];return t&&t.canInsert&&t.canInsert()},f.prototype.vL=function(){var t=v[this.CL];return t&&t.canRemove&&t.canRemove()},f.prototype.allowSetCount=function(){var t,e=this.CL;return e===C||(t=v[e])&&t.allowSetCount&&t.allowSetCount()},f.prototype.uL=function(t,e,o){var n,r,i,a,s=this.Ou;!s||t>this.getRowCount()||(n=this.CL,r=this.EL(),n&&n!==C&&!this.IL&&(this.JL=!0,o&&this.tUa(o,{type:"addItems",row:t,rowCount:e}),a=(i=this.kj)&&i.onItemAdded?i.onItemAdded.bind(i):b,v[n].addItems(s,t,e,r,a),this.JL=!1))},f.prototype.wL=function(t,e,o){var n,r,i,a=this.CL,s=this.getRowCount(),l=this.Ou;!l||s<=t||a&&a!==C&&!this.IL&&(this.JL=!0,r=(n=this.kj)&&n.onItemRemoved?n.onItemRemoved.bind(n):b,i=v[a].removeItems(l,t,e,r),o&&i&&0<i.length&&this.tUa(o,{type:"removeItems",row:t,removedItems:i}),this.JL=!1)},f.prototype.uUa=function(t,e){var o=this.Ou,n=this.CL;v[n].undoRemoveItems(o,t,e)},f.prototype.xL=function(t){return T(t||this.Ou)},f.prototype.ad=function(t){var e,o;this.Ou=y,this.CL="",this.DL=y,this.HL=y,this.AL=[],this.BL=[],this.qia=y,this.kj=t,(o=(e=t)&&e.wq)&&o.xL()&&d.Worksheet.ao(e,"resetBinding",{sheet:e})},f.prototype.FL=function(t){var e,o,n,r,i=this.kj;if(i&&!this.JL){if(t){if(this.IL=!0,!isNaN(t.length)&&(i.setRowCountCore(t.length),e=i._modelManager,u(this.HL)&&0===e.VTa(!1,3)&&(this.HL=x(this.Ou),i.setColumnCount(this.getColumnCount()),o=this.rL())))for(n=0,r=o.length;n<r;n++)e.do("setItem",!1,3,n,{name:o[n]});this.IL=!1}i.$p()}},f.prototype.GL=function(){var t,e=this.kj,o=this.Ou;e&&o&&o.currentPosition&&(t=o.currentPosition(),e.Jl!==t&&(e.Sr(t,e.Kl,b,b,2),e.$p()))},f.prototype.tUa=function(t,e){if(!(this.kj&&this.kj._modelManager&&!u(this.kj._modelManager.WTa)&&this.kj._modelManager.WTa<=0)){var o=t.rUa;o=o||(t.rUa=[]),e.bindingManager=this,o.push(e)}},f.prototype.sUa=function(t){var e=t.type,o=t.row;"bind"===e?this.bind(t.oldDataSource):"setValue"===e?this.setValue(o,t.col,t.oldValue):"addItems"===e?this.wL(o,t.rowCount):"removeItems"===e&&this.uUa(o,t.removedItems)},f.prototype.toJSON=function(){var t,e=this.Ou;return e?{type:t=this.CL,source:e=t===C?e.getSource():v[t].toJSON(e)}:y},f.prototype.fromJSON=function(t){var e,o,n=t&&t.source;!n||(o=(e=t.type)===C?new h(n):v[e].fromJSON(n))&&this.bind(o)},e.qL=f,e.setValueByPath=S,e.LL=M,I.prototype.isDataSource=function(t){return g.isArray(t)},I.prototype.getDataLength=function(t){return t.length},I.prototype.getDataItem=function(t,e){return t[e]},I.prototype.addItems=function(t,e,o,n){var r,i;for(r=0;r<o;r++)i={},n&&(i=n.createEntity?n.createEntity():new n),t.splice(e,0,i)},I.prototype.removeItems=function(t,e,o){var n=this.getDataLength(t);if(e<n)return t.splice(e,Math.min(o,n-e))},I.prototype.undoRemoveItems=function(t,e,o){for(var n=0,r=o.length;n<r;n++)t.splice(e+n,0,o[n])},I.prototype.getProperties=function(t){var e,o,n=t.length,r=y;if(0<n)for(o in r=[],e=t[0])A(e[o])||r.push(o);return r},I.prototype.getValue=function(t,e,o,n,r){var i=y,a=!1,s=this.getDataItem(t,n);return u(s)||(e?(i=e(s),a=!0):o?(i=M(s,o,this.pathCache),a=!0):typeof s!=c&&!l(s)||0!==r||(i=s,a=!0)),{value:i,hasBinding:a}},I.prototype.setValue=function(t,e,o,n,r,i){var a=!1,s=this.getDataItem(t,n);return u(s)||(e?(e(s,i),a=!0):o?(S(s,o,i),a=!0):typeof s!=c&&!l(s)||0!==r||(t[n]=i,a=!0)),a},I.prototype.fromJSON=function(t){return t},I.prototype.toJSON=function(t){return t},v.defaultBindingSource=new I},"./dist/plugins/data/data.dataview.js":function(t,e,o){"use strict";var n,r,l;function i(){}Object.defineProperty(e,"__esModule",{value:!0}),n=o("@grapecity/js-sheets-common"),r=o("./dist/plugins/data/binding.js"),e.yL=r.yL,l=n.Common.j.Fa,i.prototype.isDataSource=function(t){var e=window.wijmo;return e&&e.data&&e.data.isDataView&&e.data.isDataView(t)},i.prototype.getDataLength=function(t){return t.count()},i.prototype.getDataItem=function(t,e){return t.item(e)},i.prototype.addItems=function(t,e,o,n){if(n)for(var r=0;r<o;r++)t.mka=!0,t.add(n.createEntity?n.createEntity():new n),t.mka=!1,t.commitEdit()},i.prototype.removeItems=function(t,e,o){var n,r,i,a,s=this.getDataLength(t);if(e<s){for(n=[],r=Math.min(o,s-e),i=0;i<r;i++)a=t.item(e),t.remove(a),n.push(a);return n}},i.prototype.undoRemoveItems=function(t,e,o){var n,r,i=t.getSource();for(n=0,r=o.length;n<r;n++)i.splice(e+n,0,o[n]);t.refresh()},i.prototype.getProperties=function(t){var e,o=0,n=null,r=t.getProperties();if(r&&0<r.length)for(o=r.length,n=[],e=0;e<o;e++)n.push(r[e].name);return n},i.prototype.canInsert=function(){return!1},i.prototype.getValue=function(t,e,o,n,r){var i=null,a=!1,s=this.getDataItem(t,n);return l(s)||(e?(i=e(s),a=!0):o&&(i=t.getProperty(s,o),a=!0)),{value:i,hasBinding:a}},i.prototype.setValue=function(t,e,o,n,r,i){var a=!1,s=this.getDataItem(t,n);return l(s)||(e?(e(s,i),a=!0):o&&(t.setProperty(s,o,i),a=!0)),a},i.prototype.fromJSON=function(t){return t},i.prototype.toJSON=function(t){return t.local},r.yL.dataViewBinding=new i},"./dist/plugins/data/data.entry.js":function(t,o,e){"use strict";function n(t){for(var e in t)o.hasOwnProperty(e)||(o[e]=t[e])}Object.defineProperty(o,"__esModule",{value:!0}),e("./dist/plugins/data/worksheet-databind.js");var r=e("./dist/plugins/data/binding.js");o.CellBindingSource=r.CellBindingSource,o.qL=r.qL,o.setValueByPath=r.setValueByPath,o.LL=r.LL,n(e("./dist/plugins/data/data.ko.js")),n(e("./dist/plugins/data/data.dataview.js")),n(e("./dist/plugins/data/data.ns.js"))},"./dist/plugins/data/data.ko.js":function(t,e,o){"use strict";var m,n,l,u,y,i,c,h,b,a,r;function s(){}Object.defineProperty(e,"__esModule",{value:!0}),m=o("Core"),n=o("@grapecity/js-sheets-common"),l=o("./dist/plugins/data/binding.js"),e.yL=l.yL,u=n.Common.j.Fa,y=m.GC$,i=y.isFunction,c=y.getType,h=y.isNumeric,b="string",a=window.ko,s.prototype.isDataSource=function(t){return a&&a.isObservable(t)},s.prototype.getDataLength=function(t){return t().length},s.prototype.getDataItem=function(t,e){return t()[e]},s.prototype.addItems=function(t,e,o,n){var r,i;for(r=0;r<o;r++)i={},n&&(i=n.createEntity?n.createEntity():new n),t.splice(e,0,i)},s.prototype.removeItems=function(t,e,o){var n=this.getDataLength(t);if(e<n)return t.splice(e,Math.min(o,n-e))},s.prototype.undoRemoveItems=function(t,e,o){for(var n=0,r=o.length;n<r;n++)t.splice(e+n,0,o[n])},s.prototype.getProperties=function(t){var e,o,n=t(),r=[];if(0<n.length)for(o in e=n[0])(!i(e[o])||a&&a.isObservable(e[o]))&&r.push(o);return r},s.prototype.getValue=function(t,e,o,n,r){var i=null,a=!1,s=this.getDataItem(t,n);return u(s)||(e?(i=e(s),a=!0):o?(i=l.LL(s,o),a=!0):c(s)!==b&&!h(s)||0!==r||(i=s,a=!0)),{value:i,hasBinding:a}},s.prototype.setValue=function(t,e,o,n,r,i){var a=!1,s=this.getDataItem(t,n);return u(s)||(e?(e(s,i),a=!0):o?(l.setValueByPath(s,o,i),a=!0):c(s)!==b&&!h(s)||0!==r||(t()[n]=i,a=!0)),a},s.prototype.fromJSON=function(t){return a?a.observableArray(t):null},s.prototype.toJSON=function(t){return t()},l.yL.koBinding=new s,a&&((r=a.bindingHandlers)["gc-spread-sheets"]=r["gcspread-sheets"]=r.wijspread={init:function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g;if(!y(t).data("workbook")&&(i=(r=e())&&r.sheets,a=new m.Workbook(y("#"+t.id)[0],r),i)){for(l=s=void 0,u=i.length,c=a.getSheetCount();c<u;)s=a.vv(a._getDefaultSheetName(c)),a.ow(c,0,s),c=a.getSheetCount();for(h=0;h<u;h++)s=a.getSheet(h),f=(l=i[h]).name,p=l.autoGenerateColumns,d=l.data,g=l.columns,typeof f==b&&0<f.length&&s.cq(f),"boolean"==typeof p&&(s.autoGenerateColumns=p),d&&s.setDataSource(d),g&&0<g.length&&(s.autoGenerateColumns=!1,s.bindColumns(g))}},update:function(t,e,o,n){}})},"./dist/plugins/data/data.ns.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("./dist/plugins/data/data.res.en.js");e.SR={en:n}},"./dist/plugins/data/data.res.en.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_NotSupportedDataSource="The data source is not supported!"},"./dist/plugins/data/worksheet-databind.js":function(t,e,o){"use strict";var n,r,u,c,a,i,s,l,h,f;function p(t,e,o){"string"==typeof o&&(o={name:o}),t._modelManager.do("setItem",!1,3,e,o);var n=o&&o.formatter,r=o&&o.cellType;n&&t.setFormatter&&t.setFormatter(-1,e,n),r&&t.setCellType(-1,e,r),o&&!c(o.width)&&t.setColumnWidth(e,o.width)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("@grapecity/js-sheets-common"),u=o("./dist/plugins/data/binding.js"),c=r.Common.j.Fa,a=n.GC$.isEmptyObject,i=n.GC$.extend,s=n.Worksheet.prototype,l="bindingPath",h=RegExp("^\\d*(\\.\\d+)?\\*$"),f=r.Common.l,i(s,{getDataSource:function(){var t=this.wq;return t?t.getSource():null},setDataSource:function(t,e){var o,n,r,i,a,s=this,l=s.wq;if(l&&l.getSource()!==t){if(s.suspendPaint(),e&&s.vs(),t){if((l=s.wq).aLb=!0,!l.bind(t,s._modelManager.zTa)&&(s.setRowCountCore(l.getRowCount()),s.autoGenerateColumns&&(s.setColumnCount(l.getColumnCount()),o=l.rL())))for(n=0,r=o.length;n<r;n++)s._modelManager.do("setItem",!1,3,n,{name:o[n]})}else s.wq=new u.qL(s);s.clearPendingChanges(),i=!1,l&&l.aLb&&(i=l.bLb,delete l.bLb,delete l.aLb),s.recalcAll&&s.recalcAll(i),(a=s.tu())&&a.PA===s&&a.hZ(),s.resumePaint()}},bindColumn:function(t,e){this.suspendPaint();try{p(this,t,e)}finally{this.resumePaint()}},bindColumns:function(t){var e,o,n,r;this.suspendPaint();try{if(t)for(e=t.length,isNaN(e)||this.setColumnCount(e),o=0;o<e;o++)r=(n=t[o]).size,h.test(r)&&(n.starSize=r),p(this,o,n)}finally{this.resumePaint()}},getDataItem:function(t){var e,o,n,r,i,a,s=this.wq;if(!s||0===s.getRowCount())return null;if(e=this.getColumnCount(),o={},n=s.ru(t))for(r in n)n.hasOwnProperty(r)&&"function"!=typeof r&&(o[r]=n[r]);for(i=0;i<e;i++)(a=this._modelManager.Jp(!1,3,i))&&a.name&&0<a.name.length&&c(o[a.name])&&(o[a.name]=this.getValue(t,i));return o},getDataColumnName:function(t){var e;return 0<=t&&t<this.getColumnCount()&&this.getDataSource()?(e=this._modelManager.Jp(!1,3,t))&&(e.displayName||e.name):null},getBindingPath:function(t,e){return this._modelManager.getValueForKey(t,e,l)},setBindingPath:function(t,e,o){return this._modelManager.do("setValueForKey",t,e,l,o),this.$p(),this}}),n.CellRange.prototype.bindingPath=n.CellRange.Pl(s.getBindingPath,s.setBindingPath),n.Worksheet.$n("binding",{init:function(){this.autoGenerateColumns=!0,this.wq=new u.qL(this)},dispose:function(t){!1!==t.clearCache&&(this.wq=null)},onLayoutChanged:function(t){var e,o,n,r,i,a=t.changeType,s=t.row,l=t.rowCount,u=t.sheetArea,c=this.wq;if("addingRows"===a)c&&!1===c.sL()?t.canAdd=!1:c&&!1===c.tL()&&(t.newRow=this.getRowCount());else if("addRows"===a)c&&c.uL(s,l,this._modelManager.zTa);else if("deletingRows"===a){if(c)if(!1===c.vL())t.canDelete=!1;else for(this.Ts||(this.Ts=[]),e=this.Ts,o=this._modelManager,n=c.getRowCount(),r=0;r<l&&s+r<o.getRowCount();r++)i=null,s+r<n&&(i=c.ru(s+r)),e.push({row:s+r,data:i})}else"deleteRows"===a?c&&c.wL(s,l,this._modelManager.zTa):"settingRowCount"===a&&(!c.getSource()||c.allowSetCount()||3!==u&&2!==u||(t.canSet=!1))},toJson:function(t,e){var o,n,r=this.getColumnCount(),i=this.getDataSource();e&&e.includeBindingSource&&i&&(function(t,e,o,n){var r,i,a,s,l=t.wq;for(r=0;r<o;r++)for(i=0;i<n;i++)a=l.getValue(r,i).value,c(a)||(s=a,f.Ska(a)&&(s=f.Daa(a)),t.qI(e,r,i,s))}(this,o=t.data.dataTable||{},this.getRowCount(),r),a(o)||(t.data.dataTable=o),function(t,e,o,n){var r,i,a,s,l,u=t.options.colHeaderAutoTextIndex;for(r=0;r<o;r++)if(0<=u&&r===u||-1===u&&r===o-1)for(i=0;i<n;i++)a=e[r]&&e[r][i]&&e[r][i].value,s=t._modelManager.Jp(!1,3,i),c(a)&&s&&((l=s.displayName||s.name)&&t.qI(e,r,i,l))}(this,n=t.colHeaderData.dataTable||{},this.getRowCount(1),r),a(n)||(t.colHeaderData.dataTable=n)),!0!==this.autoGenerateColumns&&(t.autoGenerateColumns=this.autoGenerateColumns)},fromJson:function(t,e){var o,n,r,i;this.wq=new u.qL(this),e&&(o=this.wq,n=t.dataSource,r=t.dataBinding,n&&o.bind(n),r&&o.fromJSON(r,e)),i=t.autoGenerateColumns,c(i)||(this.autoGenerateColumns=i)},preFromJson:function(){this.wq=new u.qL(this)}}),n.lUa.$n("binding",{priority:6e3,getValue:function(t){var e,o=t.row,n=t.col,r=t.sheetArea,i=this.kj.wq;3===r&&i&&i.Ou&&(e=i.getValue(o,n),t.isValueGet=e.hasBinding,t.value=e.value)},setValue:function(t){var e,o,n,r=t.row,i=t.col,a=t.value,s=t.sheetArea,l=this.kj,u=l.wq;3===s&&u&&u.Ou&&((e=u.getValue(r,i)).hasBinding&&(a!==(o=e.value)?(l.isDirtySuspended()||(n=l.getDataItem(r),this.Cp(r,i,{Dp:n,Ep:o},s)),t.isValueSet=u.setValue(r,i,a,l._modelManager.zTa)):t.isValueSet="dataManagerBindingSource"!==u.CL))},undo:function(t){var e,o,n=t.rUa;if(n)for(e=n.length-1;0<=e;e--)(o=n[e]).bindingManager.sUa(o)}})},"./dist/plugins/fill/drag-fill.js":function(t,e,o){"use strict";var p,w,d,n,r,a,g,m,i,c,M,s,y,x,b,v,C,I,h,l,u,f,T,A,S,N,R,k,E,D,j,_,O=this&&this.__extends||(E=function(t,e){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}E(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function F(t){return t.rowCount}function P(t){return t.colCount}function L(t,e){return t.getRowCount(e)}function H(t,e){return t.getColumnCount(e)}function B(t,e){var o=D.call(this)||this,n=o;return n.kj=t,n.i4=e,n.W$=e[b],n.X$=e[v],n.Y$=e[C],n.Z$=e[I],o}function V(t,e){var o=j.call(this)||this,n=o,r=e[I],i=0===r,a=i||1===r,s=e[v],l=e[b],u=l.row,c=l.col,h=F(l),f=P(l);return n.kj=t,4===(n.G$=e)[C]?n.H$=new w.Commands.OA(t,{ranges:[e[v]]}):n.I$=a?m(u,i?s.col:c,h,f+P(s)):m(2===r?s.row:u,c,h+F(s),f),n.J$=a?1:0,o}function z(t,e,o,n,r,i){var a,s,l,u=t.getSelections();t.Tr(),t.addSelection(e,o,n,r),a=t.getSelections(),t.Au(u),s=0<e?e:t.ar(),l=0<o?o:t.$q(),t.Kr(s,l,t.Nr,t.Pr),t.parent&&i.xC&&t.parent.changeSelectionInCommandExecuting(i,null,null,a)}function W(t){var e=t.parent.getActiveSheet();e&&t!==e&&e.repaint()}function G(t,e){return _.call(this,t,e)||this}Object.defineProperty(e,"__esModule",{value:!0}),p=o("@grapecity/js-sheets-common"),w=o("Core"),d=o("./dist/plugins/fill/fill.js"),n=o("./dist/plugins/fill/fill.ns.js"),r=o("@grapecity/js-calc"),a=!!r,g=p.Common.j.Fa,m=w.kf,i=w.GC$,c=Math.max,M=Math.floor,s=w.Commands.ActionBase,y=w.Commands.xy,x=w.Commands.Bu,b="startRange",v="fillRange",C="autoFillType",I="fillDirection",h="cancel",l="fill",u="dragDrop",f=i.isEmptyObject,T=new p.Common.ResourceManager(n.SR,"Fill"),A=T.getResource.bind(T),S={fillAuto:function(t,e,o){if(!e)throw Error(A().Exp_RangeIsNull);var n,r,i,a,s=o.fillType,l=o.series,u=o.direction,c=o.step,h=o.stop,f=new d.z$(this);if(r=e,i=u?null:l,a=u,(n=t)&&r&&r.containsRange(n)&&(!g(i)&&(1===i&&n.row===r.row&&F(n)===F(r)||0===i&&n.col===r.col&&P(n)===P(r))||!(g(a)||(2!==a&&3!==a||n.col!==r.col||P(n)!==P(r))&&(0!==a&&1!==a||n.row!==r.row||F(n)!==F(r))))){this.suspendPaint(),t&&(this._eventHandler.A$=t);try{4===s?f.B$(e,l,!1,o.withTag,o.withoutStyle):0===s?f.C$(e,u):1===s||2===s?f.D$(1===s,e,l,c,h):3===s&&f.E$(e,l,3,c,g(h)?null:p.Common.l.Ra(h),o.unit)}finally{this.resumePaint()}}}},i.extend(w.Worksheet.prototype,S),w.Worksheet.$n(l,{init:function(){this.Fyb=new d.Gyb(this)},setHost:function(t){if(t){var e=this.wu();e.fill||e.register(l,w.Commands.fill),e[u]||e.register(u,w.Commands[u])}},dispose:function(t){if(!1!==t.clearCache){this.Fyb&&(this.Fyb.no(),this.Fyb=null)}}}),w.Workbook.$n(l,{onCultureChanged:function(){A()}}),O(V,j=s),V.prototype.canExecute=function(){var t=this.kj,e=this.G$,o=e[b],n=e[v];return!(!t.Y3(n.row,n.col,F(n),P(n),void 0,void 0,void 0,void 0,!0)||4!==e[C]&&n.intersect(o.row,o.col,F(o),P(o)))},V.prototype.execute=function(){var t,e,o,n,r,i=this;if(i.canExecute()){e=(t=i.G$)[v],(o=i.kj)._modelManager.startTransaction(),i.Lz(o,!0);try{a&&o.suspendCalcService(),n=o.getSelections(),o.isDirtySuspended()||(i.N$=new y(o,t[v],2047)),4===t[C]?i.K$(o):i.L$(o),o.yu(n,o.getSelections())&&o.Au(n)}finally{i.Mz(o,!0),t[w.Commands.bWa(o.name())]=o._modelManager.endTransaction(),a&&o.resumeCalcService(!1),o.t4&&o.t4(e.row,e.col,F(e),P(e)),r=[],o.isDirtySuspended()||(i.M$=new y(o,e,2047),i.M$.uy(i.N$.sy()),r=i.M$.wy()),x(o,e.row,e.col,F(e),P(e),r,1)}}},V.prototype.K$=function(t){var e,o,n,r,i,a,s,l,u;this.H$.execute(t),o=(e=this.G$)[b],n=e[v],r=0===this.J$,a=F(o),s=P(o),l=r?c(1,a-F(n)):a,u=r?s:c(1,s-P(n)),o.equals(n)||(i=m(o.row,o.col,l,u),t.Kr(c(t.ar(),i.row),c(t.$q(),i.col),t.Nr,t.Pr),t.Tr(),t.addSelection(i.row,i.col,F(i),P(i)))},V.prototype.L$=function(t){var e,o,n,r=this.kj,i=this.G$[b],a=this.G$[v],s=this.G$[C],l=this.I$,u={fillType:4,series:this.J$,withTag:!0};try{r.tables&&r.tables.fIb(l)}catch(t){return r.Os(6,t.message),void r.resumePaint()}if(1===s){if(r.fillAuto(i,l,u),r._modelManager.MTa(i.row,i.col,i.rowCount,i.colCount))for(e=0;e<a.rowCount;e++)for(o=0;o<a.colCount;o++)(n=r.Aj(i.row+M(e%i.rowCount),i.col+M(o%i.colCount)))&&n.clone&&(n=n.clone()),r.Nq(a.row+e,a.col+o,n)}else 0===s?this.O$(i,a,2043):2===s?this.O$(i,a,192):3===s&&(1!==F(i)||1!==P(i)||-1===i.row&&-1!==i.col||-1===i.col&&-1!==i.row?(u.withoutStyle=!0,r.fillAuto(i,l,u)):this.O$(i,a,187));r.Kr(c(t.ar(),l.row),c(t.$q(),l.col),t.Nr,t.Pr),t.Tr&&t.Tr(),r.addSelection(l.row,l.col,F(l),P(l))},V.prototype.O$=function(t,e,o){var n,r,i,a,s,l=this.kj,u=l.Tq(t),c=l.Tq(e),h=u.row,f=u.col,p=F(u),d=P(u),g=c.row,m=c.col,y=F(c),b=P(c),v=this.G$[I],C=3===v,w=1===v,x=M(y/p),T=y%p,A=M(b/d),S=b%d;if(0===this.J$){for(n=0;n<x;n++)a=C?g+n*p:g+y-(n+1)*p,l.ax(h,f,a,m,p,d,o,!0,!0);0!=T&&(r=C?h:h+(x+1)*p-y,a=C?g+p*x:g+y-x*p-T,l.ax(r,f,a,m,T,d,o,!0,!0))}else{for(n=0;n<A;n++)s=w?m+n*d:m+b-(n+1)*d,l.ax(h,f,g,s,p,d,o,!0,!0);0!=S&&(i=w?f:f+(A+1)*d-b,s=w?m+d*A:m+b-A*d-S,l.ax(h,i,g,s,p,S,o,!0,!0))}},V.prototype.undo=function(){var t,e,o,n,r=this.kj,i=!1;if(this.canUndo()){this.Lz(r,!0);try{a&&r.suspendCalcService(),t=r.getSelections(),e=this.G$,o=r.NF,n=e[v],i=4===e[C]?this.S$(r):this.T$(r),!r.U$&&o&&o.close(),x(r,n.row,n.col,F(n),P(n),this.M$?this.M$.wy():[],1,void 0,!0),r.yu(t,r.getSelections())&&r.Au(t)}finally{this.Mz(r,!0),a&&r.resumeCalcService(!1)}}return i},V.prototype.S$=function(t){var e=this.G$[b],o=e.row,n=e.col,r=w.Commands.bWa(t.name());return t._modelManager.undo(this.G$[r]),t.Kr(c(t.ar(),o),c(t.$q(),n),t.Nr,t.Pr),!0},V.prototype.T$=function(t){var e,o=this.G$,n=o[b],r=n.row,i=n.col;a&&t.suspendCalcService();try{e=w.Commands.bWa(t.name()),t._modelManager.undo(o[e]),t.Kr(c(t.ar(),r),c(t.$q(),i),t.Nr,t.Pr)}finally{a&&t.resumeCalcService(!1)}return t.invalidateLayout(),!0},N=V,O(B,D=s),B.prototype.execute=function(){var t,e,o,n,r,i,a,s,l,u=this,c=!1;if(u.canExecute()){e=(t=u.kj).parent,o=u.X$,n=u.i4,t._modelManager.startTransaction(),u.oUa(),u.Lz(t,!0),t.vxb=!0;try{r=t.getSelections(),a=t._eventHandler,(s={sheet:t,sheetName:t.name(),cancel:!1})[v]=o,s[C]=u.Y$,s[I]=u.Z$,t.Wq(w.Events.DragFillBlock,s),a.$$=s[C],a._$=s[h],s[h]||(u.a_(s),t.Wq(w.Events.DragFillBlockCompleted,s)),c=!0,i=t.getSelections(),t.yu(r,i)&&t.Au(r),e&&n.xC&&e.changeSelectionInCommandExecuting(n,null,null,i)}finally{u.Mz(t,!0),t.vxb=!1,u.IVa(t,o),l=w.Commands.bWa(t.name()),u.i4[l]=t._modelManager.endTransaction()}}return c},B.prototype.a_=function(t){var e,o,n=this.kj,r=n._eventHandler,i=this.X$,a=this.Y$;r.$$=a,r._$||((e={})[b]=this.W$,e[v]=i,e[C]=5===t[C]?a:t[C],e[I]=this.Z$,o=new N(n,e),n.suspendEvent(),o.execute(),n.resumeEvent(),this.i4.d_=o)},B.prototype.oUa=function(){this.kj.isDirtySuspended()||(this.N$=new y(this.kj,this.X$,2047))},B.prototype.undo=function(){var t,e,o,n,r,i,a;if(this.canUndo()){t=this.kj,e=this.X$,o=t.parent,n=this.i4,this.oUa(),this.Lz(t,!0);try{r=t.getSelections(),t.suspendEvent(),i=w.Commands.bWa(t.name()),t._modelManager.undo(this.i4[i]),t.resumeEvent(),a=n[b],t.yu(r,[a])&&t.Au(r),o&&n.xC&&o.changeSelectionInCommandExecuting(n,null,null,[a])}finally{this.Mz(t,!0),this.IVa(t,e,!0)}}return!0},B.prototype.IVa=function(t,e,o){var n,r=[];t.isDirtySuspended()||((n=new y(t,e,2047)).uy(this.N$.sy()),r=n.wy()),x(t,e.row,e.col,F(e),P(e),r,1,void 0,o)},R=B,O(G,_=s),G.prototype.canExecute=function(){var t,e,o,n=this.kj,r=this.VQ,i=r.fromRow,a=r.fromColumn,s=F(r),l=r.columnCount,u=r.toRow,c=r.toColumn,h=!r.copy,f={row:i,col:a,rowCount:s,colCount:l},p={row:u,col:c,rowCount:s,colCount:l};return(!n.tables||!n.tables.zxb(n,f,n,p,h))&&!!n.pu(i,a,s,l,L(n),H(n))&&!(!r.insert&&!n.pu(u,c,s,l,L(n),H(n)))&&(t=0<=u&&c<0&&0<=i&&a<0&&0<s&&l<0,e=u<0&&0<=c&&i<0&&0<=a&&s<0&&0<l,o=this.KZa(t,e),n.Y3(u,c,s,l,null,null,o)&&n.Y3(i,a,s,l,null,null,o))},G.prototype.KZa=function(t,e){var o,n,r=this.VQ,i=this.kj,a=r.insert,s=i.options.isProtected,l=i.options.protectionOptions;return!(!s||f(l)||(o=l.allowDragInsertRows,n=l.allowDragInsertColumns,!a||!(o&&t||n&&e)))},G.prototype.PLc=function(t){var e=[].concat(t.parent.sheets);return t&&t.xUc&&e.push(t),e},G.prototype.execute=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b=!1;if(this.canExecute()){t=this.kj,e=this.VQ,this.oUa(),r=n=o=void 0,i=e.fromRow,a=e.fromColumn,s=e.toRow,l=e.toColumn,u=F(e),c=e.columnCount,h=e.option,f=u,p=c,d=this.PLc(t),t.KLc()&&(f+=t.MLc(s,u,!0),p+=t.MLc(l,c)),w.Commands.Zxb(d),this.Lz(t,!0),t.vxb=!0;try{try{t.tables&&t.tables.fIb(new w.Range(s,l,f,p),new w.Range(i,a,u,c))}catch(e){return t.Os(6,e.message),void t.resumePaint()}e.insert?0<=a&&i<0?(o=a,r=c,g=n=l,t.addColumns(n,r),e.copy?t.copyTo(-1,n<=o?o+r:o,-1,n,-1,r,h):(t.moveTo(-1,n<=o?o+r:o,-1,n,-1,r,h),t.deleteColumns(n<=o?o+r:o,r),o<n&&(g=n-r)),z(t,-1,g,L(t),r,e)):0<=i&&a<0&&(o=i,r=u,m=n=s,t.addRows(n,r),e.copy?t.copyTo(n<=o?o+r:o,-1,n,-1,r,-1,h):(t.moveTo(n<=o?o+r:o,-1,n,-1,r,-1,h),t.deleteRows(n<=o?o+r:o,r),o<n&&(m=n-r)),z(t,m,-1,r,H(t),e)):(e.copy?t.copyTo(i,a,s,l,u,c,h):t.moveTo(i,a,s,l,u,c,h),t&&(z(t,s,l,f,p,e),y=e.io,e.copy||t.isDirtySuspended()||(y._z=this.aA(t,y.cA,i,a,u,c)),t.isDirtySuspended()||(y.dA=this.aA(t,y.fA,s,l,u,c)))),b=!0}finally{t._eventHandler.gA={},this.Mz(t,!0),t.vxb=!1,w.Commands.$xb(d,e)}W(t)}return b},G.prototype.aA=function(t,e,o,n,r,i){var a=new y(t,m(o,n,r,i),this.VQ.option),s=t.tables&&t.tables.$Hb&&t.tables.$Hb(o,n,r,i);return s&&0<s.length&&(this.VQ.tableNamesObj={r:o,c:n,rc:r,cc:i,tableNames:s}),a.uy(e.sy()),x(t,o,n,r,i,a.wy(),0,s),a},G.prototype.oUa=function(){var t=this.kj,e=this.VQ,o=e.io={},n=e.fromRow,r=e.fromColumn,i=e.toRow,a=e.toColumn,s=e.option,l=n<0?0:n,u=r<0?0:r,c=i<0?0:i,h=a<0?0:a,f=n<0?L(t):F(e),p=r<0?H(t):e.columnCount;e.insert||t.isDirtySuspended()||(e.copy||(o.cA=new y(t,m(l,u,f,p),s)),o.fA=new y(t,m(c,h,f,p),s)),o.rA=t.Nr,o.sA=t.Pr,o.tA=t.Jl,o.uA=t.Kl},G.prototype.undo=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C;if(this.canUndo()){if(t=this.kj,o=(e=this.VQ).fromRow,n=e.fromColumn,r=e.toRow,i=e.toColumn,a=F(e),s=e.columnCount,!t.pu(o,n,a,s,L(t),H(t)))return!1;if(!e.insert&&!t.pu(r,i,a,s,L(t),H(t)))return!1;l=void 0,u=e.io,this.Lz(t,!0),c=this.PLc(t),w.Commands._xb(c,e);try{e.insert?0<=n&&0<=o||(0<=n?(l=s,t&&z(t,-1,n,L(t),l,e)):0<=o&&(l=a,t&&z(t,o,-1,l,H(t),e))):(h=o<0?0:o,f=n<0?0:n,p=r<0?0:r,d=i<0?0:i,g=o<0?L(t):a,m=n<0?H(t):s,t&&(z(t,o,n,a,s,e),y=e.tableNamesObj,b=[],v=[],y&&(y.r===p&&y.c===d&&y.rc===g&&y.cc===m?v=y.tableNames:b=y.tableNames),x(t,p,d,g,m,u.dA?u.dA.wy():[],0,b,!0),x(t,h,f,g,m,u._z?u._z.wy():[],0,v,!0))),t&&(-1!==u.tA&&-1!==u.uA&&((C=t.getSelections()[0]).contains(u.tA,u.uA)?t.Jr(u.tA,u.uA):t.Jr(C.row,C.col)),-2!==u.rA&&-2!==u.sA&&-1!==u.tA&&-1!==u.uA&&t.showCell(u.tA,u.uA,3,3))}finally{this.Mz(t,!0)}W(t)}return!0},k=G,w.Commands.fill={canUndo:!0,execute:function(t,e,o){return w.Commands.h4(t,R,e,o)}},w.Commands[u]={canUndo:!0,execute:function(t,e,o){return w.Commands.h4(t,k,e,o)}}},"./dist/plugins/fill/fill-event.js":function(t,e,o){"use strict";var b,y,g,r,v,n,m,C,R,w,h,x,k,E,T,f,p,l,A,i,S;function d(t){return t.rowViewportIndex}function M(t){return t.colViewportIndex}function u(t){return t.hitTestType}function I(t,e){return t.getRowCount(e)}function N(t,e){return t.getColumnCount(e)}function D(t){return t.colCount}function j(t){return t.rowCount}function _(t){return t.height}function O(t){return t.width}function F(t,e,o,n,r){var i,a,s;t.save(),e===n?(t.rect(e-2,o,7,E(r-o)),t.clip(),t.beginPath(),o<r?(o-=3,r+=3):(o+=3,r-=3),i=y.zF(e-1,o-1,n-1,r+1,l,7),a=y.zF(e,o,n,r,l,7),s=y.zF(e+1,o-1,n+1,r+1,l,7)):o===r&&(t.rect(e,o-2,E(n-e),7),t.clip(),t.beginPath(),e<n?(e-=3,n+=3):(e+=3,n-=3),i=y.zF(e-1,o-1,n+1,r-1,l,7),a=y.zF(e,o,n,r,l,7),s=y.zF(e-1,o+1,n+1,r+1,l,7)),i&&i.vE(t),a&&a.vE(t),s&&s.vE(t),t.stroke(),t.beginPath(),t.restore()}function P(t,e,o,n,r,i,a,s,l,u,c){var h=e?y.Events.DragDropBlock:y.Events.DragDropBlockCompleted,f={sheet:t,sheetName:t.name(),fromRow:o,fromCol:n,toRow:r,toCol:i,rowCount:a,colCount:s,copy:l,insert:u,copyOption:c};return e&&(f.cancel=!1),t.Wq(h,f),f.cancel}function L(t,e,o,n,r){var i,a,s;for(i=0;i<o.rowCount;i++){for(a=0;a<o.colCount;a++){if(!(s=t.getSpan(o.row+i,o.col+a))||s.rowCount!==e.rowCount||s.colCount!==e.colCount)return!1;n&&(a+=e.colCount)}r&&(i+=e.rowCount)}return!0}Object.defineProperty(e,"__esModule",{value:!0}),b=o("@grapecity/js-sheets-common"),y=o("Core"),g=o("SheetsCalc"),r=o("./dist/plugins/fill/fill-ui.js"),v=o("./dist/plugins/fill/fill.js"),n=o("./dist/plugins/fill/fill.ns.js"),m=o("@grapecity/js-calc"),C=!!m,R=y.GC$,w=y.kf,h=b.Common.j.Fa,x=null,k=Math.min,E=Math.abs,T=Math.max,f="drag",p="corner",l="black",A=b.Common.u,i=new b.Common.ResourceManager(n.SR),S=i.getResource.bind(i),R.extend(y.iI.prototype,{gG:function(t){var e,o,n,r,i,a,s,l;this.zG||(e=this.kj,o=x,1===(n=e._modelManager.getSelections()).length?o=n[0]:n.length<1&&(o=e._modelManager.getSpan(e.Jl,e.Kl)),o&&(this.zG=!0,this._isWorking=!0,this.L_=o,r=e.getRangeRect(d(t),M(t),o),(i=this.gA).x=r.x,i.y=r.y,i.width=r.width-1,i.height=r.height-1,i.row=o.row,i.col=o.col,i.rowCount=j(o),i.colCount=D(o),a=e.Tq(o),s=t.row,l=t.col,s<a.row&&(s=a.row),s>=a.row+j(a)&&(s=a.row+j(a)-1),l<a.col&&(l=a.col),l>=a.col+D(a)&&(l=a.col+D(a)-1),i.hitRow=s,i.hitCol=l,i.rowOffset=s-a.row,i.colOffset=l-a.col,this.rG={KG:d(t),MG:M(t),sG:u(t)},this.qG()))},AG:function(){var t,e,o,n,r,i,a,s,l,u,c=this;c.rG&&c._isWorking&&c.zG&&c.L_&&(t=c.$F,e=c.gA,n=(o=c.kj.getCellRect(e.hitRow,e.hitCol)).width/2,r=o.x+n,i=o.height/2,a=o.y+i,e.hitTarget={x:t.x,y:t.y},s=c.fH(),l=c.gH(),u=!1,(E(r-t.x)>5+n||E(a-t.y)>5+i)&&(u=!0),0<=s&&0<=l&&u&&c.M_(s,l),c.NG())},M_:function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d,g,m;this.zG&&this.L_&&(o=this.kj,n=this.gA,r=o.KLc(),i=o._getActiveSelectedRange(),a=I(o),s=N(o),l=k(s-D(n),e-n.colOffset),u=k(a-j(n),t-n.rowOffset),r&&(l-=o.OLc(e,n.colOffset+1),u-=o.OLc(t,n.rowOffset+1,!0),0===o.getColumnWidth(l)&&(l=o.br(l)),0===o.getRowHeight(u)&&(u=o.gr(u))),-1===i.row&&-1!==i.col?(n.row=-1,n.col=T(0,l)):-1!==i.row&&-1===i.col?(n.row=T(0,u),n.col=-1):(n.row=n.row<0?-1:T(0,u),n.col=n.col<0?-1:T(0,l)),n.hitRow=t,n.hitCol=e,c=o.Tq(n),r&&(h=o.MLc(c.row,c.rowCount,!0),f=o.MLc(c.col,c.colCount),c.rowCount+=h,c.colCount+=f,c.rowCount=k(a,c.rowCount),c.colCount=k(s,c.colCount),c.row+c.rowCount>a&&(c.row=a-c.rowCount,n.row=c.row),c.col+c.colCount>s&&(c.col=s-c.colCount,n.col=c.col)),(p=this.N_)&&c.row===p.row&&c.col===p.col&&j(c)===j(p)&&D(c)===D(p)&&c.row>o.ar()&&c.col>o.$q()&&c.row+j(c)-1<o.ir()&&c.col+D(c)-1<o.dr()||(this.MI=c,o._render.QH(),this.N_=c,(d=o.parent)&&d.options.showDragDropTip&&(g=n.x+n.width+5,m=n.y+n.height+5,d.uw(A.Ob(this.O_(c)),g,m))))},O_:function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d;return t&&C?(n=j(o=(e=this.kj)._getActiveSelectedRange()),r=D(o),i=e.getActiveRowIndex(),a=e.getActiveColumnIndex(),s=void 0,l=e.KLc(),i=i<0?0:i,a=a<0?0:a,s=1===n&&1===r?m.rf(x,x,t.row-i,t.col-a,!0,!0):(f=h=c=u=void 0,d=p=0,-1===o.row&&0<=o.col?(u=h=g.BAND_INDEX_CONST,c=t.col-a,f=t.col-a+r-1,d=r):-1===o.col&&0<=o.row?(c=f=g.BAND_INDEX_CONST,u=t.row-i,h=t.row-i+n-1,p=n):0<=o.row&&0<=o.col&&(u=t.row-i,h=t.row-i+n-1,c=t.col-a,f=t.col-a+r-1,p=n,d=r),l&&(h+=e.MLc(t.row,p,!0),f+=e.MLc(t.col,d)),m.uf(x,x,u,c,h,f,!0,!0,!0,!0,i,a)),e.Cf().unparse(e.yj(),s,i,a)):void 0},wH:function(){var t,e,o,n,r,i,a,s,l,u,c,h,f=this,p=!1,d="",g=!1,m=f.kj;f.rG=x,f.RG(),t=(e=m._getActiveSelectedRange())&&(0<j(e)||0<D(e))?{r:e.row,c:e.col,rc:j(e),cc:D(e)}:{r:m.Jl,c:m.Kl,rc:1,cc:1},!0===f.zG&&!0===f._isWorking&&(o=t.r,n=t.c,r=t.rc,i=t.cc,a=f.gA.row,s=f.gA.col,l=m.options.protectionOptions,u={fromRow:o,fromColumn:n,rowCount:r,columnCount:i,toRow:a,toColumn:s,isDragInsert:f.OH,isDragCopy:f.PH},m.Wq(y.Events.BeforeDragDrop,u),(d=u.invalidMessage)&&0!==d.length||(!f.OH||-1!==o&&-1!==n?a===o&&s===n||((m.qu(o,n,r,i)||m.qu(a,s,r,i))&&(p=!0,d=S().Exp_ChangeMergedCell),p||C&&(m.Ns(o,n,r,i)||m.Ns(a,s,r,i))&&(p=!0,d=S().Exp_ChangePartOfArray),!p&&m.options.isProtected&&(!f.PH&&m.ou(w(o,n,r,i),!0)||m.ou(w(a,s,r,i),!0))&&(p=!0,d=S().Exp_CellReadOnly),p||(P(m,!0,o,n,a,s,r,i,f.PH,!1,2047)||(g=m.wu().execute({cmd:"dragDrop",sheetName:m.name(),fromRow:o,fromColumn:n,toRow:a,toColumn:s,rowCount:r,columnCount:i,copy:f.PH,insert:!1,option:2047}),P(m,!1,o,n,a,s,r,i,f.PH,!1,2047)))):0<=n?(f.PH&&(s<=n||n+i<=s)||!f.PH&&(s<n||n+i<s))&&((m.qu(-1,n,-1,i)||m.qu(-1,s,-1,0))&&(p=!0,d=S().Exp_ChangeMergedCell),c=l&&l.allowDragInsertColumns,!p&&m.options.isProtected&&!0!==c&&(p=!0,d=S().Exp_ColumnReadOnly),p||(P(m,!0,-1,n,-1,s,-1,i,f.PH,!0,2047)||(g=m.wu().execute({cmd:"dragDrop",sheetName:m.name(),fromRow:-1,fromColumn:n,toRow:-1,toColumn:s,rowCount:-1,columnCount:i,copy:f.PH,insert:!0,option:2047}),P(m,!1,-1,n,-1,s,-1,i,f.PH,!0,2047)))):0<=o&&n<0&&(f.PH&&(a<=o||o+r<=a)||!f.PH&&(a<o||o+r<a))&&((m.qu(o,-1,r,-1)||m.qu(a,-1,0,-1))&&(p=!0,d=S().Exp_ChangeMergedCell),p||C&&(m.Ns(o,-1,r,-1)||m.Ns(a,-1,0,-1))&&(p=!0,d=S().Exp_ChangePartOfArray),h=l&&l.allowDragInsertRows,!p&&m.options.isProtected&&!0!==h&&(p=!0,d=S().Exp_RowReadOnly),p||(P(m,!0,o,-1,a,-1,r,-1,f.PH,!0,2047)||(g=m.wu().execute({cmd:"dragDrop",sheetName:m.name(),fromRow:o,fromColumn:-1,toRow:a,toColumn:-1,rowCount:r,columnCount:-1,copy:f.PH,insert:!0,option:2047}),P(m,!1,o,-1,a,-1,r,-1,f.PH,!0,2047)))))),f._isWorking=!1,f.zG=!1,f.L_=x,f.OH=!1,f.PH=!1,f.N_=x,f.xw(),g||(f.gA={},m.repaint()),p&&m.Os(3,d)},hG:function(t){var e=this;!0!==e.BG&&!0!==e._isWorking&&(e.P_(),e.A$&&(e._isWorking=!0,e.BG=!0,e.$I=!0,e.Q_=t,e.R_=M(t),e.S_=d(t),e.T_=M(t),e.U_(),e.rG={KG:d(t),MG:M(t),sG:u(t)},e.qG()))},U_:function(){var t,e=this,o=e.kj.frozenRowCount(),n=e.kj.frozenColumnCount(),r=e.V_();0<=r&&r<o?e.W_=0:o<=r&&r<=I(e.kj)&&(e.W_=1),e.X_()?e.Y_=1:e.Y_=e.Q_,0<=(t=e.Z_())&&t<n?e.__=0:n<=t&&t<=N(e.kj)&&(e.__=1),e.a0()?e.b0=1:e.b0=e.R_},CG:function(){var t,e,o=this;o.rG&&o.BG&&o._isWorking&&o.A$&&(o.S_=o.iH(),o.T_=o.jH(),o.c0=o.fH(),o.d0=o.gH(),0<=o.c0&&0<=o.d0&&(o.e0(),o.f0(),t=o.kj.parent,e=!1,o.g0()&&(e=o.h0(o.A$,o.A_,!0)),t&&t.options.showDragFillTip&&e&&o.i0(),o.j0()),o.NG())},k0:function(){var t,e,o,n,r,i,a,s,l,u,c,h=this.kj,f=this.A$,p=this.A_,d=h.parent.options.defaultDragFillType,g=this.l0(3===d?5:d,3===d),m=this.m0(),y=this.g0();return 1===g?(t=0===m||1===m?1:0,o=new v.z$(h).B$(y,t,!0),e=this.n0(m,p,f),r=(n=h.getActualStyle(e.row,e.col)).cellType||h.Al(),i=n.formatter?n.formatter:n._autoFormatter,a=b.Formatter&&b.Formatter.GeneralFormatter,o instanceof Date&&a&&(i=new a(b.Common.CultureManager.q4().DateTimeFormat.shortDatePattern+" hh:mm:ss AM/PM;@","0")),l=3,(s=this.rG)&&(l=s.sG),u={sheet:h,row:e.row,col:e.col,sheetArea:l,quotePrefix:n.quotePrefix},c={},r.format(o,i,c,u)):0===g?(e=this.n0(m,p,f),h.getFormula(e.row,e.col)?x:h.getText(e.row,e.col)):x},n0:function(t,e,o){var n,r=o.row,i=o.col,a=j(o),s=D(o),l=w(r,i,1,1);return 3===t?(n=0===(n=j(e)%a)?r+a-1:r+n-1,l.row=n,l.col=i):1===t?(n=0===(n=D(e)%s)?i+s-1:i+n-1,l.row=r,l.col=n):0===t?(n=0===(n=D(e)%s)?i:i+s-n,l.row=r,l.col=n):2===t&&(n=0===(n=j(e)%a)?r:r+a-n,l.row=n,l.col=i),l},i0:function(){var t,e,o,n,r,i,a=this.kj;return 4===this.l0()||this.a0()||this.X_()?(this.xw(),x):(n=this.m0(),r=this.g0(),i=a.cm(r),o=this.k0(),3===n||1===n?(t=i.x+i.width+3,e=i.y+i.height+3):0===n?(t=i.x+3,e=i.y+i.height+3):2===n&&(t=i.x+i.width+3,e=i.y+3),void this.uw(o,t,e))},j0:function(){this.o0(),this.p0(),this.q0(),this.r0=this.g0()},o0:function(){var t,e=this.kj;this.r0&&((t=e.cm(this.r0)).x-=2,t.y-=2,t.width+=4,t.height+=4,e._render.dm(t))},p0:function(t){this.kj._render.im(this.A$,x,t)},q0:function(){var t,e,o=this.kj,n=o._render,r=this.g0();r&&(t=n.bm(),e=o.cm(r),t.save(),t.beginPath(),n.RI(t,e),t.restore())},f0:function(){this.A_=this._I()},a0:function(){return-1===this.A$.col&&-1!==this.A$.row},X_:function(){return-1===this.A$.row&&-1!==this.A$.col},ZI:function(){return 4===this.dJ||5===this.dJ},_I:function(){var t=this,e=-1,o=-1,n=-1,r=-1;switch(t.dJ){case 0:n=t.X_()?e=-1:(e=t.V_(),j(t.A$)),o=t.d0,r=t.Z_()-o;break;case 1:n=t.X_()?e=-1:(e=t.V_(),j(t.A$)),o=t.s0()+1,r=t.d0-o+1;break;case 2:e=t.c0,n=t.V_()-e,r=t.a0()?o=-1:(o=t.Z_(),D(t.A$));break;case 3:e=t.t0()+1,n=t.c0-e+1,r=t.a0()?o=-1:(o=t.Z_(),D(t.A$));break;case 5:e=t.c0,n=t.t0()-e+1,r=t.a0()?o=-1:(o=t.Z_(),D(t.A$));break;case 4:n=t.X_()?e=-1:(e=t.A$.row,j(t.A$)),o=t.d0,r=t.s0()-o+1}return w(e,o,n,r)},u0:function(){var t=this.t0();return-1!==t?this.kj.Gr(this.Y_).findRow(t):x},v0:function(){return this.kj.Gr(this.S_).findRow(this.w0())},w0:function(){return this.kj.getViewportBottomRow(this.S_)},x0:function(){var t=this.s0();return-1!==t?this.kj.Hr(this.b0).findCol(t):x},y0:function(){return this.kj.Hr(this.T_).findCol(this.z0())},z0:function(){return this.kj.getViewportRightColumn(this.T_)},e0:function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v=this,C=v.a0(),w=v.X_(),x=R(v.kj.Ws()).offset(),T=v.$F.e,A=v.$F.x,S=v.$F.y,M=T.pageX-x.left,I=T.pageY-x.top,N=!1;C||w?w?v.d0>=v.Z_()&&v.d0<=v.s0()?v.dJ=4:v.d0<v.Z_()?v.dJ=0:v.d0>v.s0()&&(v.dJ=1):C&&(v.c0>=v.V_()&&v.c0<=v.t0()?v.dJ=5:v.c0<v.V_()?v.dJ=2:v.c0>v.t0()&&(v.dJ=3)):v.c0>=v.V_()&&v.c0<=v.t0()?v.d0>=v.Z_()&&v.d0<=v.s0()?(t=E(v.d0-v.s0()))<(e=E(v.c0-v.t0()))?v.dJ=5:e<t?v.dJ=4:S>(o=(o=v.u0())||v.v0()).y+o.height?v.dJ=3:(r=(n=(n=v.x0())||v.y0()).x+n.width-A,i=o.y+o.height-S,M>=n.x&&M<=n.x+n.width&&I>=o.y&&I<=o.y+o.height?v.dJ=i<=r?4:5:N=!0):v.d0<v.Z_()?v.dJ=0:v.d0>v.s0()&&(v.dJ=1):v.c0<v.V_()?v.d0>=v.Z_()&&v.d0<=v.s0()?v.dJ=2:v.d0<v.Z_()?(t=E(v.d0-v.Z_()),e=E(v.c0-v.V_()),v.dJ=t<=e?2:0):v.d0>v.s0()&&(t=E(v.d0-v.s0()),e=E(v.c0-v.V_()),v.dJ=t<=e?2:1):v.c0>v.t0()&&(v.d0>=v.Z_()&&v.d0<=v.s0()?v.dJ=3:v.d0<v.Z_()?(t=E(v.d0-v.Z_()),e=E(v.c0-v.t0()),v.dJ=t<=e?3:0):v.d0>v.s0()&&(t=E(v.d0-v.s0()),e=E(v.c0-v.t0()),v.dJ=t<=e?3:1)),(a=v.kj._render.rH)&&(u=(s=v.t0())+1,c=(l=v.s0())+1,h=v.kj.getRowHeight(s,3),f=v.kj.getColumnWidth(l,3),p=v.kj.getRowHeight(u,3),d=v.kj.getColumnWidth(c,3),g=a.x+a.width/2-k(10,f/2),m=a.x+a.width/2+k(10,d/2),y=a.y+a.height/2-k(10,h/2),b=a.y+a.height/2+k(10,p/2),(C||w?w?g<=M&&M<=m:y<=I&&I<=b:g<=M&&M<=m&&y<=I&&I<=b)||N?(v.$I=!0,v.dJ=4):v.$I=!1)},V_:function(){return this.A$?-1===this.A$.row?0:this.A$.row:-1},t0:function(){return this.A$?-1===this.A$.row?I(this.kj)-1:this.A$.row+j(this.A$)-1:-1},Z_:function(){return this.A$?-1===this.A$.col?0:this.A$.col:-1},s0:function(){return this.A$?-1===this.A$.col?N(this.kj)-1:this.A$.col+D(this.A$)-1:-1},hla:function(t,e){var o,n,r,i,a,s,l=w(e.row,e.col,e.rowCount,e.colCount),u=this.kj;return u._modelManager.findSpan(t.row,t.col)&&(o=t.rowCount,n=l.rowCount,0!==Math.floor(n%o)&&(r=Math.ceil(n/o)*o,l.row+r<=u.getRowCount()&&(l.rowCount=r)),i=t.colCount,a=l.colCount,0!==Math.floor(a%i)&&(s=Math.ceil(a/i)*i,l.col+s<=u.getColumnCount()&&(l.colCount=s))),l},xH:function(){var t,e,o,n,r=this,i=r.kj;return r.rG=x,r.RG(),r.xw(),r.BG&&r._isWorking?(r.BG=!1,r._isWorking=!1,void((t=r.g0())&&(!r.h0(r.A$,r.A_)||r.$I?(r.A0(),r.WA(t)):(e=i._eventHandler.A$,o=r.hla(e,r.A_),n=r.l0(),i.wu().execute({cmd:"fill",sheetName:i.name(),startRange:e,fillRange:o,autoFillType:n,fillDirection:i._eventHandler.m0()}),!r._$&&r.B0()&&i.parent.options.showDragFillSmartTag&&4!==r.$$?r.C0(r.$$):r.WA(t),r.A0())))):void r.A0()},C0:function(t){var e=this.kj,o=e._render.rH,n={x:o.x+o.width,y:o.y+o.height,fillType:t};e.NF=new r.K_(e.parent.xv(),e,n),e.NF.OT()},P_:function(){var t=this.kj,e=t._modelManager.getSelections();1===e.length?this.A$=e[0]:0<=t.Jl&&0<=t.Kl&&(this.A$=w(t.Jl,t.Kl,1,1))},A0:function(){this._isWorking=!1,this.BG=!1},WA:function(t){this.kj._render.im(t)},l0:function(t,e){var o=this.kj,n=void 0!==t?t:o.parent.options.defaultDragFillType;return this.ZI()?4:5!==n?n:1===j(this.A$)&&1===D(this.A$)&&!this.X_()&&!this.a0()?this.RH&&!e?1:0:this.RH&&!e?0:1},g0:function(){var t,e,o,n,r=this;return r.A$?r.ZI()?r.A$:r.A_?(n=o=e=t=0,n=r.D0()?(t=2===r.dJ?r.A_.row:r.A$.row,e=j(r.A$)+j(r.A_),o=r.A$.col,D(r.A$)):(t=r.A$.row,e=j(r.A$),o=0===r.dJ?r.A_.col:r.A$.col,D(r.A$)+D(r.A_)),w(t,o,e,n)):x:x},h0:function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m,y=this.kj,b=!0,v="";return!y._modelManager.MTa(e.row,e.col,j(e),D(e))||(n=y,i=e,s=(r=t).row,l=r.rowCount,u=r.col,c=r.colCount,h=i.row,f=i.rowCount,p=i.col,d=i.colCount,m=u===p&&c===d,((g=s===h&&l===f)||m)&&(a=n.getSpan(s,u))&&L(n,a,r,g,m)&&!n._modelManager.qu(h,p,f,d)&&L(n,a,i,g,m))||(b=!1,v=S().Exp_FillRangeContainsMergedCell),b&&y.options.isProtected&&y.ou(e,!0)&&(b=!1,v=S().Exp_FillCellsReadOnly),b||o||y.Os(2,v),b},B0:function(){return this.E0()||this.F0()},E0:function(){return 3===this.dJ||1===this.dJ},F0:function(){return 0===this.dJ||2===this.dJ},D0:function(){return 2===this.dJ||3===this.dJ||5===this.dJ},m0:function(){var t=this.dJ;return 0<=t&&t<=3?t:4===t?0:5===t?2:3},tr:function(t,e,o){var n,r,i,a=x,s=d(t),l=M(t),u=this.kj,c=u.parent;if(h(s)||h(l)||!c.options.allowUserDragDrop&&!c.options.allowUserDragFill)return a;if(-1===(n=u._getActiveSelectedRange()).row&&-1===n.col)return a;if(0<=s&&0<=l&&1===u._modelManager.getSelections().length){if(this.qH(s,l,e,o))return a;(r=u.getRangeRect(s,l,n)).x-4<e&&e<r.x+4&&r.y<=o&&o<r.y+r.height&&(a={action:f,side:"left"}),a||(i=this.kj._render.rH)&&i.x<=e&&e<=i.x+i.width&&i.y<=o&&o<=i.y+i.height&&(a={action:f,side:p}),a||r.x+r.width-4<e&&e<r.x+r.width+4&&r.y<=o&&o<r.y+r.height&&(a={action:f,side:"right"}),a||r.y-4<o&&o<r.y+4&&r.x<=e&&e<r.x+r.width&&(a={action:f,side:"top"}),a||r.y+r.height-4<o&&o<r.y+r.height+4&&r.x<=e&&e<r.x+r.width&&(a={action:f,side:"bottom"}),a&&(e<r.x||e>r.x+r.width||o<r.y||o>r.y+r.height)&&(a.outside=!0)}return c&&c.options.allowUserDragDrop||a&&a.side!==p&&(a.side=x),c&&c.options.allowUserDragFill||a&&a.side===p&&(a.side=x),a},Hyb:function(t,e){var o=this.kj.getSpan(t,e,3);return o?!h(this.kj.getValue(o.row,o.col,3,0)):!h(this.kj.getValue(t,e,3,0))},Iyb:function(t,e,o,n){var r;for(r=e;r<e+n;r++)if(!this.Hyb(t,r))return!1;return!0},Jyb:function(t,e,o,n){var r;for(r=e;r<e+n;r++)if(this.Hyb(t,r))return!1;return!0},Kyb:function(t,e,o,n){var r,i,a,s,l,u,c,h=this.kj;if("left"===n){for(r=0;r<e;r++)this.Hyb(t,r)&&(o.searchArray[r]=!0);for(i=e-1,a=1;o.searchArray[i];)i--,a++;o.searchLength=a}if("right"===n){for(s=h.getColumnCount(),l=e;l<s;l++)this.Hyb(t,l)&&(o.searchArray[l-e]=!0);for(u=0,c=1;o.searchArray[u];)u++,c++;o.searchLength=c}return o},Lyb:function(t,e,o,n,r){var i,a,s,l,u,c=this.kj,h=0,f={searchArray:Array(n),searchLength:1},p={searchArray:Array(c.getColumnCount()-r),searchLength:1};for(i=e;i<o;i++)f=this.Kyb(i,t.col,f,"left"),p=this.Kyb(i,t.col+t.colCount-1,p,"right");for(;this.Jyb(o+h,t.col,1,t.colCount);){for(s=!(a=!0),f=this.Kyb(o+h,n,f,"left"),p=this.Kyb(o+h,r,p,"right"),l=n-1;l>=n-f.searchLength;l--)if(this.Hyb(o+h,l)){h++,a=!1;break}if(a){for(u=r+1;u<=r+p.searchLength;u++)if(this.Hyb(o+h,u)){h++,s=!0;break}if(!s)return h}}return h},Myb:function(t){for(var e=0;this.Iyb(t.row+t.rowCount+e,t.col,1,t.colCount);)e++;return e},Nyb:function(t){var e,o,n,r;return this.Iyb(t.row+t.rowCount,t.col,1,t.colCount)?this.Myb(t):(n=t.row-2,r=t.row+t.rowCount,o=1===t.colCount?e=t.col:(e=t.col,t.col+t.colCount-1),this.Lyb(t,n,r,e,o))},cyb:function(){var t,e,o,n=this,r=n.kj,i=r._eventHandler.A$,a=n.Nyb(i);0!==a&&(t=w(i.row+i.rowCount,i.col,a,i.colCount),n.dJ=3,n.A_=t,e=n.l0(),o=n._$,r.wu().execute({cmd:"fill",sheetName:r.name(),startRange:i,fillRange:t,autoFillType:e,fillDirection:n.dJ}),!o&&r.parent.options.showDragFillSmartTag&&4!==n.$$&&n.C0(n.$$))}}),R.extend(y.oJ.prototype,{gJ:function(t,e){var o,n=this.kj,r=t.x,i=t.y,a=O(t),s=_(t),l=n._getActiveSelectedRange(),u=n.am(),c=4,h=-2.5;return 2007<e&&(c=5,h=-3),o=new y.Rect(-4,-4,c,c),-1===l.col?(o.x=u.kt,o.y=i+s+h):-1===l.row?(o.x=r+a+h,o.y=u.nt):(o.x=r+a+h,o.y=i+s+h),o},eJ:function(t,e,o,n,r){var i,a,s=this.kj,l=s.am(),u=s.parent,c=u&&u.Vv,h=this.gJ(n,c),f=h.x,p=h.y,d=O(h),g=_(h),m=l.Ft(e,o);r&&!h.intersectRect(r)||h.intersectRect(m)&&(i=-1.5,2007<c&&(i=-1),(a=new y.Rect(f+i,p+i,d+2,g+2)).x=T(a.x,m.x),a.y=T(a.y,m.y),this.dm(a),t.save(),r&&!r.containsRect(h)&&(t.rect(r.x,r.y,O(r),_(r)),t.clip()),t.beginPath(),t.fillStyle=y.Rm.Om(s,s.getSelectionBorderColor()),t.fillRect(f,p,d,g),this.rH=new y.Rect(h.x,h.y,4,4),t.beginPath(),t.restore())},RI:function(t,e){var o=e.x,n=e.y,r=o+O(e),i=n+_(e);F(t,o,n,r,n),F(t,o,i,r,i),F(t,o,n,o,i),F(t,r,n,r,i)},NI:function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p=this.kj,d=p._eventHandler.gA,g=d.hitTarget;d&&g&&(o=d.hitCol,n=d.hitRow,r=p._eventHandler.OH,i=p.OI,t.save(),!0!==r||-1!==d.row&&-1!==d.col?(i&&(a=new y.Rect(i.x-2,i.y-2,O(i)+4,_(i)+4),this.dm(a,e),this.im(p._getActiveSelectedRange(),e)),t.rect(e.x,e.y,O(e),_(e)),t.clip(),t.beginPath(),this.RI(t,d)):-1===d.row&&-1!==d.col?(s=(s=(s=p.Hr(0).findCol(o))||p.Hr(1).findCol(o))||p.Hr(2).findCol(o))&&(l=s.x,u=O(s),d.col=o,g.x>l+u/2&&(d.col<p.cr()||d.col===p.dr())&&(l=s.x+O(s),d.col++),i&&0===O(i)||(i=p._eventHandler.gA),i&&(a=new y.Rect(i.x-2,i.y-2,O(i)+4,_(i)+4),this.dm(a,e),this.im(p._getActiveSelectedRange(),e)),p.QI=new y.Rect(l,d.y,0,_(d)),t.rect(e.x,e.y,O(e),_(e)),t.clip(),t.beginPath(),F(t,l,d.y,l,d.y+_(d))):-1===d.row||-1!==d.col||(c=(c=(c=p.Gr(0).findRow(n))||p.Gr(1).findRow(n))||p.Gr(2).findRow(n))&&(h=c.y,f=_(c),d.row=n,g.y>h+f/2&&(d.row<p.hr()||d.row===p.ir())&&(h=c.y+_(c),d.row++),i&&0===_(i)||(i=p._eventHandler.gA),i&&(a=new y.Rect(i.x-2,i.y-2,O(i)+4,_(i)+4),this.dm(a,e),this.im(p._getActiveSelectedRange(),e)),p.QI=new y.Rect(d.x,h,O(d),0),t.rect(e.x,e.y,O(e),_(e)),t.clip(),t.beginPath(),F(t,d.x,h,d.x+O(d),h)),t.beginPath(),t.restore())},QH:function(){var t,e,o,n,r,i,a,s,l,u,c,h=this.kj,f=h.yt,p=h._eventHandler.MI;f&&f.dragInfo&&p&&(t=this.bm(),e=h.am(),o=h._eventHandler.gA,n=h.cm(p),r=h.frozenTrailingColumnCount(),i=h.frozenTrailingRowCount(),a=h.getColumnCount()-r,s=h.getRowCount()-i,l=e.Ft(1,1),0<r&&p.col+p.colCount<=a&&n.x+O(n)>l.x+O(l)&&n.intersectRect(l)&&(n=n.getIntersectRect(l)),0<i&&p.row+p.rowCount<=s&&n.y+_(n)>l.y+_(l)&&n.intersectRect(l)&&(n=n.getIntersectRect(l)),u=new y.Rect(e.kt,e.nt,e.lt+e.js,e.ot+e.gs),0<O(n)&&0<_(n)?(o.x=n.x,o.y=n.y,o.width=O(n)-1,o.height=_(n)-1,this.NI(t,u)):0!==O(n)&&0!==_(n)||(o.x=n.x,o.y=n.y,o.width=O(n),o.height=_(n),this.NI(t,u)),c=h._eventHandler.OH,h.OI=!0===c?h.QI:new y.Rect(o.x,o.y,O(o),_(o)))}})},"./dist/plugins/fill/fill-ui.js":function(t,e,o){"use strict";var n,r,i,p,d,a,s,g,l,u,c,h,f,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L=this&&this.__extends||(O=function(t,e){return(O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}O(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function H(t,e,o,n,r,i){var a=t.CH,s=a?"160px":"150px",l=a?"25px":"20px",u=p(d("div")).css([w,x,T,"padding",A],["block",s,l,0,0]).addClass("gc-smartMenu-item-default "+o+" ui-state-default"+g),c=p(d("div")).addClass(y).appendTo(u),h=p(d("div")).addClass("gc-menu-item-text").appendTo(u),f=p(d("input")).attr({id:e,value:r,type:"radio",name:"fill-group",style:"display:none"}).appendTo(c);return p(d("span")).text(n).appendTo(h),i?(c.addClass(m),f.prop("checked","checked")):f.prop("checked",""),u}function B(t,e,o){var n,r=F.call(this,t,a(e.parent._host))||this;return r.kj=e,r.B_=o,n=r.C_=r.yo().addClass("gc-smart-tag-default "+v+" gc-no-user-select ui-widget-header"+g),r.D_=p(d("div")).attr("class","fillSmartTag").css("float",C).appendTo(n),r.E_=p(d("div")).attr("class","fillSmartTagDown").css(["float",w],[C,"none"]).appendTo(n),r}function V(t,e){var o,n=P.call(this,t,a(e.parent._host))||this;return n.kj=e,n.v_=p("."+v),(o=n.w_=n.yo()).addClass(c),H(e,"smartMenuCopyCells",u,j().CopyCells,"0",!0).appendTo(o),H(e,"smartMenuFillSeries",u,j().FillSeries,"1").appendTo(o),e.xUc||(H(e,"smartMenuFillFormattingOnly",u,j().FillFormattingOnly,"2").appendTo(o),H(e,"smartMenuFillWithoutFormatting",u,j().FillWithoutFormatting,"3").appendTo(o)),n}Object.defineProperty(e,"__esModule",{value:!0}),n=o("@grapecity/js-sheets-common"),r=o("Core"),i=o("./dist/plugins/fill/fill.ns.js"),p=r.GC$,d=r.Ul.Nl,a=r.Ul.vl,s=p(document),g=" btn btn-default",u="gc-fill-type-item",c="gc-fill-menu-container",h=(l="ui-state-hover ")+"gc-smartMenu-item-hover",f=l+"gc-smart-tag-hover",m="ui-icon ui-icon-check gc-check-image",y="gc-menu-item-input",b="ui-state-active gc-smart-tag-active",v="gc-tag-container",C="left",w="display",x="min-width",T="height",A="margin",S="change",M="input[type=radio]",I="mouseover",N="mouseout",R="click",k="fillTypeChanged",E="keydown.ui-fill",D=new n.Common.ResourceManager(i.SR),j=D.getResource.bind(D),P=r.Go,L(V,P),V.prototype.Ao=function(){P.prototype.Ao.call(this)},V.prototype.QQ=function(){var i=this;p("."+u).bind(I,function(){p(this).addClass(h)}).bind(N,function(){p(this).removeClass(h)}).bind(R,function(){var t,e=p(this),o=i.v_,n=e.find(M),r=n[0];r.checked=!0,n.trigger(S),o.trigger(R),o.trigger(N),e.removeClass(h),t=parseInt(p(r).attr("value"),10),i.x_(t)}),i.w_.find(M).bind(S,function(){p("."+y).removeClass(m),p(this).parent().addClass(m)})},V.prototype.y_=function(){p("."+u).unbind(I).unbind(N).unbind(R),this.w_.find(M).unbind(S)},V.prototype.x_=function(t){var e=this.kj,o=e._eventHandler;if(this.z_!==t){this.z_=t,e.U$=!0,e.suspendEvent();try{r.Commands.undo.execute(e.parent,{sheetName:e.name()})}finally{e.resumeEvent()}e.U$=!1,e.wu().execute({cmd:"fill",sheetName:e.name(),startRange:o.A$,fillRange:o.A_,autoFillType:t,fillDirection:o.dJ}),this.v_.trigger(k,t)}},V.prototype.MQ=function(){return!!p("."+c).length},_=V,F=r.Go,L(B,F),B.prototype.F_=function(t,e,o){var n=this.kj.CH,r=p(e),i=this.G_,a=this.E_,s=n?"38px":"32px",l=n?"24px":"18px";i&&i.MQ()||(t?r.addClass(f):r.removeClass(f),r.css(["width",T],[t?s:l,l]),o||(t?a.show():a.hide()))},B.prototype.H_=function(){var i=this,t=i.C_,e=r.Ul.rl(),a=r.Ul.Ml.safari&&(e.ipad||e.iphone);t.bind(I,function(){i.F_(!0,this,a)}).bind(N,function(){i.F_(!1,this,a)}),t.bind(R,function(){var t,e,o=p(this),n=i.G_,r=i.E_;n&&n.MQ()?(a&&r.hide(),o.removeClass(b),i.I_()):(a&&r.show(),o.addClass(b),i.J_(),(e=(t=i.w_)&&t.find(M)[i.B_.fillType])&&!e.checked&&(e.checked=!0,p(e).trigger(S)))}),s.bind(E,function(t){27===t.keyCode&&(i.G_&&i.G_.MQ()?i.I_():i.close(),r.Ul.nl(t))})},B.prototype.OT=function(){var t=this.C_,e=this.B_,o=this.kj.CH,n=o?"3px":"0px",r=o?"24px":"18px";t&&(t.css([C,"top"],[e.x,e.y]),this.Ao(),this.H_(),this.D_.css(A,n),this.E_.css(T,r),this.hZ())},B.prototype.J_=function(){var t,e,o,n,r,i,a,s=this.kj;this.G_||(this.G_=new _(s.parent.xv(),s),this.w_=this.G_.yo()),e=(t=this.C_).css(C),o=t.css("top"),n=parseFloat(o),i=this.G_,a=this.B_,i.z_=a.fillType,isNaN(n)||(r=n+t.height()+2),this.w_.css([C,"top"],[e,r]),i.Ao(),i.QQ(),i.v_.unbind(k).bind(k,function(t,e){a.fillType=e})},B.prototype.I_=function(){var t=this.G_;t&&(t.y_(),t.close())},B.prototype.hZ=function(){var t=this.G_,e=this.C_;t&&(t.MQ()&&e.trigger(R),e.trigger(N))},B.prototype.close=function(){var t,e=this.kj;this.hZ(),s.unbind(E),F.prototype.close.call(this),(t=e.Xs)&&(t.style.cursor="default"),e&&e.zt()},e.K_=B},"./dist/plugins/fill/fill.entry.js":function(t,o,e){"use strict";function n(t){for(var e in t)o.hasOwnProperty(e)||(o[e]=t[e])}Object.defineProperty(o,"__esModule",{value:!0}),e("./dist/plugins/fill/drag-fill.js"),e("./dist/plugins/fill/fill-event.js"),n(e("./dist/plugins/fill/fill-ui.js")),n(e("./dist/plugins/fill/fill.js")),n(e("./dist/plugins/fill/fill.ns.js"))},"./dist/plugins/fill/fill.js":function(t,e,o){"use strict";var u,n,r,p,i,d,a,$,y,v,C,tt,s,l,c,k,h,f,g,et,ot,nt,m,E,b,rt,w,x,T,A,S,M,I,N,R,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J,Z,q,K,Y,Q,X,it,at,st,lt,ut,ct,ht=this&&this.__extends||(B=function(t,e){return(B=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}B(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function ft(t){return!pt(t)&&a.Na(t)}function pt(t){return"string"==typeof t}function dt(t,e){return-1!==t.lastIndexOf(e)}function gt(t){var e=[t];return e.rowCount=1,e.colCount=k(t),e}function mt(t){return t}function yt(t,e,o,n){var r=gt(e),i=gt(o),a=gt([n]),s=t?u.Common.qc(r,i,a,!0,mt,$,$,$):u.Common.sc(r,i,a,!0,$,$,$),l=s&&s[0][0];return typeof l===et?u.Common.o.Lma(l,13):l}function bt(t){return t.toLowerCase()}function vt(){this.Uk="",this.kja="",this.Tyb=0,this.Xyb=1,this._padding=""}function Ct(t){this.Ryb=-1,this.Syb=[],this.Tyb=-1,this.kj=t}function wt(t){this.e_=[],this.f_=[],this.Oyb=[],this.Nc=$,this.Pyb=[],this.Qyb=$,this.g_=tt(t)?-1:t}function xt(t){var e,o=t.length,n=1;if(1<o)for(n=t[1]-t[0],e=2;e<o;e++)if(n!==t[e]-t[e-1]){n=0;break}return n}function Tt(t,e){return 0<t?(t-1)%e:e-Math.abs(t)%e-1}function At(t){for(var e="",o=0;o<t;)e+="0",o++;return e}function St(t,e){return 12*(e.getFullYear()-t.getFullYear())+(e.getMonth()-t.getMonth())}function Mt(t,e){var o,n=t.length,r=!0;for(o=2;o<n&&(r=e===St(t[o-1],t[o]));o++);return r}function It(t){return"0"===t[0]}function Nt(e,t,o){var n,r,i,a,s,l=o?1:2,u=o?2:1;return t.every(function(t){return!!(n=t.match(e.Yyb))&&(r=n[l],(s=r.length)>e.Zyb&&It(r)&&(e.Zyb=s),i=parseInt(r,10),a=n[u],tt(e.Qyb)&&(e.Qyb=a),a!==e.Qyb?(e.$yb=!0,e.Qyb=$,e.Pyb=[]):e.Pyb.push(i),!0)})}function Rt(t){var e,o,n,r,i,a;this.fzb=[new S,new M,new I],this.hzb=new L,this.izb=new H,e=b.culture(),o=b.q4(e).isJCKCulture,n=new R(t),r=new D,i=new j,a=new _,this.gzb=o?[n,r,new P,i,a,new O]:[n,r,i,a]}function kt(){var t=null!==J&&J.apply(this,arguments)||this;return t.t_=!0,t}function Et(){return null!==Z&&Z.apply(this,arguments)||this}function Dt(){return null!==q&&q.apply(this,arguments)||this}function jt(){var t=null!==K&&K.apply(this,arguments)||this;return t.Yyb=/^(.*\D+)(\d+)(\D+.*)$/,t}function _t(){var t=null!==Y&&Y.apply(this,arguments)||this;return t.Yyb=/^(\d+)(\D+.*)$/,t}function Ot(){var t=null!==Q&&Q.apply(this,arguments)||this;return t.Yyb=/^(.*\D+)(\d+)$/,t}function Ft(){var t=null!==X&&X.apply(this,arguments)||this;return t.Yyb=/^\d+$/,t}function Pt(t){var e=it.call(this)||this;return e.ezb=new w(t),e}function Lt(){var t=at.call(this)||this;return t.Yyb=$,t.Pyb=[],t.Qyb=$,t.$yb=!1,t.Zyb=0,t.Nc=nt,t.t_=!1,t.czb=!1,t.dzb=new x,t}function Ht(){return null!==st&&st.apply(this,arguments)||this}function Bt(){return null!==lt&&lt.apply(this,arguments)||this}function Vt(){return null!==ut&&ut.apply(this,arguments)||this}function zt(){var t=null!==ct&&ct.apply(this,arguments)||this;return t.azb=0,t.Nc=ot,t}function Wt(){}function Gt(t){t.forEach(function(t){t&&t.dispose()})}function Ut(t){this.kj=t,this.AX=!1,this.cLb=[]}Object.defineProperty(e,"__esModule",{value:!0}),u=o("@grapecity/js-sheets-common"),n=o("Core"),r=o("@grapecity/js-calc"),p=o("SheetsCalc"),i=o("./dist/plugins/fill/fill.ns.js"),d=!!r,a=u.Common.j,$=null,y=void 0,v=Math.floor,C=n.kf,tt=a.Fa,s=a.Pa,l=u.Common.k,c=l.Eb,k=l.ac,h=u.Common.l,f=h.Ra,g=h.Xb,et="number",ot="date",nt="string",m=new u.Common.ResourceManager(i.SR),E=m.getResource.bind(m),b=u.Common.CultureManager,(U=e.AutoFillType||(e.AutoFillType={}))[U.copyCells=0]="copyCells",U[U.fillSeries=1]="fillSeries",U[U.fillFormattingOnly=2]="fillFormattingOnly",U[U.fillWithoutFormatting=3]="fillWithoutFormatting",U[U.clearValues=4]="clearValues",U[U.auto=5]="auto",(G=e.FillDirection||(e.FillDirection={}))[G.left=0]="left",G[G.right=1]="right",G[G.up=2]="up",G[G.down=3]="down",(W=e.FillSeries||(e.FillSeries={}))[W.column=0]="column",W[W.row=1]="row",(z=e.FillType||(e.FillType={}))[z.direction=0]="direction",z[z.linear=1]="linear",z[z.growth=2]="growth",z[z.date=3]="date",z[z.auto=4]="auto",(V=e.FillDateUnit||(e.FillDateUnit={}))[V.day=0]="day",V[V.weekday=1]="weekday",V[V.month=2]="month",V[V.year=3]="year",wt.prototype.h_=function(){return k(this.e_)},wt.prototype.Ey=function(){var t,e,o=[],n=this.f_;for(t=0;t<k(n);t++)e=n[t],o.push("object"===this.Nc?this.Wh(e):e);return o},wt.prototype.i_=function(){var t,e,o,n=this.e_;if(0<k(n)){for(e=[],o=void 0,-1===(t=this.g_)&&(t=n[0]),o=0;o<k(n);o++)e[o]=n[o]-t+1;return e}return $},wt.prototype.j_=function(){var t=this.f_;return k(t)?t:$},wt.prototype.Eb=function(t,e,o){if(!ft(o))throw Error(E().Exp_NumberOnly);tt(this.Nc)&&(this.Nc=o instanceof Date?ot:et),c(this.e_,t,e),c(this.f_,t,s(o))},wt.prototype.Sb=function(t,e){var o=tt(this.Nc);ft(e)?(o&&(e instanceof Date?this.Nc=ot:this.Nc=et),this.f_.push(s(e))):o&&(this.Nc=pt(e)?nt:"default"),this.e_.push(t),this.Oyb.push(e)},wt.prototype.k_=function(t){return this.Nc===ot?this.Wh(t):t},wt.prototype.Wh=function(e){var o=$;if(e instanceof Date)o=e;else if(r)try{o=r.Convert.Wh(e)}catch(t){o=e}return o},rt=wt,Ct.prototype.no=function(){this.kj=$},Ct.prototype.Uyb=function(){var t=this.kj;return t.parent&&t.parent.Txb()||[]},Ct.prototype.Vyb=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g=t.length,m=!1;if(t&&0<g)for(e=bt(t[0]),o=this.Uyb(),l=s=a=i=r=n=void 0,n=0;n<o.length;n++)if(0<=(a=(i=(r=o[n]).map(function(t){return bt(t)})).indexOf(e))){for(s=a,u=i.length,f=h=c=void 0,p=1;p<g;p++){if(h=bt(t[p]),!(0<=(c=i.indexOf(h)))){m=!1;break}if(f=c-s+u,l){if(l!==f){m=!1;break}}else m=!0,l=f,s=c}if(d=1===g,m||d){m=!0,this.Ryb=a,this.Syb=r,this.Tyb=d?1:l;break}}return m},Ct.prototype.ge=function(t){var e=this.Syb,o=this.Ryb,n=this.Tyb,r=e.length;return e[(o+n*Tt(t,r))%r]},w=Ct,vt.prototype.ge=function(t){var e=this.Tyb*(t-1)+this.Xyb,o=this._padding.length,n=""+Math.abs(e),r=n.length,i=this._padding+n,a=i.length;return n=o<r?n:i.substr(a-o),this.Uk+n+this.kja},x=vt,Wt.prototype.match=function(t){return!1},Wt.prototype.getTargetValue=function(t,e,o,n,r){},Wt.prototype.resetProp=function(){},Wt.prototype._yb=function(t,e){return t.indexOf(e+1)},Wt.prototype.dispose=function(){},ht(zt,ct=T=Wt),ht(Vt,ut=A=zt),Vt.prototype.match=function(t){var e=this.azb=St(t[0],t[1]),o=t.every(function(t){return 1===t.getDate()}),n=t.length,r=!0;return o&&2<n&&(r=Mt(t,e)),o&&r},Vt.prototype.getTargetValue=function(t,e){var o=t.Oyb[0],n=o.getFullYear(),r=e-1,i=o.getMonth()+this.azb*r;return new Date(n+parseInt(i/12,10),i%12,1)},S=Vt,ht(Bt,lt=A),Bt.prototype.match=function(t){var e=this.azb=St(t[0],t[1]),o=t.every(function(t){var e=t.getFullYear(),o=t.getMonth();return t.getDate()===new Date(e,o+1,0).getDate()}),n=t.length,r=!0;return o&&2<n&&(r=Mt(t,e)),o&&r},Bt.prototype.getTargetValue=function(t,e){var o=t.Oyb[0],n=o.getFullYear(),r=e-1,i=o.getMonth()+this.azb*r,a=n+parseInt(i/12,10),s=i%12;return new Date(a,s,new Date(a,1+s,0).getDate())},M=Bt,ht(Ht,st=A),Ht.prototype.match=function(t){var e,o,n,r,i,a,s=!1;return t.every(function(t){var e=t.getHours(),o=t.getMinutes(),n=t.getSeconds();return 0!==e||0!==o||0!==n})||(e=this.azb=St(t[0],t[1]),n=(a=0)<(o=t.every(function(t){var e=t.getDate();return(a=a||e)===e})?a:0),r=t.length,i=!0,this.bzb=o,n&&2<r&&(i=Mt(t,e)),s=n&&i),s},Ht.prototype.getTargetValue=function(t,e){var o=t.Oyb[0],n=o.getFullYear(),r=e-1,i=o.getMonth()+this.azb*r,a=n+parseInt(i/12,10);return new Date(a,i%12,this.bzb)},I=Ht,ht(Lt,at=T),Lt.prototype.resetProp=function(){this.Pyb=[],this.Zyb=0,this.Qyb=$,this.$yb=!1,this.t_=!1,this.czb=!1},Lt.prototype.getInternal=function(t){var e,o,n=!1,r=t[0];for(o=1;o<t.length;o++)if(e=t[o],1!==Math.abs(e-r)){n=!0;break}return n},ht(Pt,it=N=Lt),Pt.prototype.dispose=function(){this.ezb&&(this.ezb.no(),this.ezb=$)},Pt.prototype.match=function(t){return this.ezb.Vyb(t)},Pt.prototype.getTargetValue=function(t,e,o,n,r){var i,a=t.Oyb.length,s=this._yb(o,n),l=$;return-1!==s&&(i=a*r+s+1,l=this.ezb.ge(i)),l},R=Pt,ht(Ft,X=N),Ft.prototype.match=function(t){var e,o,n=this;return t.every(function(t){return!!t.match(n.Yyb)&&((o=t.length)>n.Zyb&&It(t)&&(n.Zyb=o),e=parseInt(t,10),n.Pyb.push(e),!0)})},Ft.prototype.getTargetValue=function(t,e,o,n,r){var i,a=t.Oyb,s=this.dzb,l=xt(this.Pyb),u=a.length,c=0!==l,h=c?0:Tt(e,u),f=this._yb(o,n),p=$;return this.t_=c,this.czb=this.getInternal(t.e_),-1!==f&&(s.Tyb=l,s.Xyb=this.Pyb[h],s._padding=At(this.Zyb),i=u*r+f+1,p=s.ge(i)),p},D=Ft,ht(Ot,Q=N),Ot.prototype.match=function(t){return Nt(this,t,!1)},Ot.prototype.getTargetValue=function(t,e,o,n,r){var i,a=t.Oyb,s=this.dzb,l=xt(this.Pyb),u=a.length,c=0!==l,h=c?0:Tt(e,u),f=this._yb(o,n),p=$;return this.t_=c,this.czb=this.getInternal(t.e_),-1!==f&&(s.Uk=this.Qyb,s.Tyb=l,s.Xyb=this.Pyb[h],s._padding=At(this.Zyb),i=u*r+f+1,p=s.ge(i)),p},j=Ot,ht(_t,Y=N),_t.prototype.match=function(t){return Nt(this,t,!0)},_t.prototype.getTargetValue=function(t,e,o,n,r){var i,a=t.Oyb,s=this.dzb,l=xt(this.Pyb),u=a.length,c=0!==l,h=c?0:Tt(e,u),f=this._yb(o,n),p=$;return this.t_=c,this.czb=this.getInternal(t.e_),-1!==f&&(s.kja=this.Qyb,s.Tyb=l,s.Xyb=this.Pyb[h],s._padding=At(this.Zyb),i=u*r+f+1,p=s.ge(i)),p},_=_t,ht(jt,K=N),jt.prototype.resetProp=function(){K.prototype.resetProp.call(this),this.iJc=$},jt.prototype.match=function(t){var e,o,n,r,i,a,s=this;return t.every(function(t){return!!(e=t.match(s.Yyb))&&(o=e[2],(a=o.length)>s.Zyb&&It(o)&&(s.Zyb=a),n=parseInt(o,10),r=e[1],tt(s.Qyb)&&(s.Qyb=r),i=e[3],tt(s.iJc)&&(s.iJc=i),r!==s.Qyb||i!==s.iJc?(s.$yb=!0,s.Qyb=$,s.iJc=$,s.Pyb=[]):s.Pyb.push(n),!0)})},jt.prototype.getTargetValue=function(t,e,o,n,r){var i,a=this,s=t.Oyb,l=a.dzb,u=xt(a.Pyb),c=s.length,h=0!==u,f=h?0:Tt(e,c),p=a._yb(o,n),d=$;return a.t_=h,a.czb=a.getInternal(t.e_),-1!==p&&(l.Uk=a.Qyb,l.kja=a.iJc,l.Tyb=u,l.Xyb=a.Pyb[f],l._padding=At(a.Zyb),i=c*r+p+1,d=l.ge(i)),d},F=["-","_",":",".",","],ht(Dt,q=O=jt),Dt.prototype.resetProp=function(){q.prototype.resetProp.call(this),this.jJc=$},Dt.prototype.match=function(t){var i,a,s,l,u,c,h=this;return t.every(function(e){var t,o,n,r=h.jJc;if(tt(r)?F.some(function(t){if(dt(e,t))return h.jJc=t,!0}):dt(e,r)){if(r=h.jJc,t=e.lastIndexOf(r),l=e.substring(0,t+1),tt(h.Qyb))h.Qyb=l;else if(h.Qyb!==l)return!1;if(o=e.substr(t+1),n=/^(\d+)(\D+.*)$/,i=o.match(n))return a=i[1],(c=a.length)>h.Zyb&&It(a)&&(h.Zyb=c),s=parseInt(a,10),u=i[2],tt(h.iJc)&&(h.iJc=u),u!==h.iJc?(h.Qyb=$,h.iJc=$,!(h.Pyb=[])):(h.Pyb.push(s),!0)}return!1})},P=Dt,ht(Et,Z=T),Et.prototype.getTargetValue=function(t,e,o){return yt(!0,t.j_(),o,e)},L=Et,ht(kt,J=T),kt.prototype.getTargetValue=function(t,e,o,n){var r=t.Oyb;return r[Tt(e,r.length)]},H=kt,Rt.prototype.getRule=function(t,e){var o,n,r,i=[],a=this.izb;for(t===ot?(i=this.fzb,a=this.hzb):t===nt?i=this.gzb:t===et&&(a=this.hzb),o=0;o<i.length;o++)if(r=void 0,(n=i[o]).resetProp(),n.match(e)){if(r=n.$yb,tt(r)||!1===r)return n;if(!0===r)return a}return a},Rt.prototype.no=function(){var t=this;t.fzb&&(Gt(t.fzb),t.fzb=$),t.gzb&&(Gt(t.gzb),t.gzb=$),t.hzb&&(t.hzb.dispose(),t.hzb=$),t.izb&&(t.izb.dispose(),t.izb=$)},e.Gyb=Rt,Ut.prototype.D$=function(t,e,o,n,r){var i=t?1:2;tt(n)&&tt(r)?this.E$(e,o,i):this.E$(e,o,i,n,r,$)},Ut.prototype.E$=function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A=this.kj,S=A.Tq(t),M=S.row,I=S.col,N=S.rowCount,R=S.colCount;if(A._modelManager.MTa(M,I,N,R))throw Error(E().Exp_RangeContainsMergedCell);for(f=0,d=(p=1===e)?R:N,g=p?M:I,m=p?M+N:I+R,y=(h=3<arguments.length)?1:d,v=(b=this.kj._eventHandler.A$).row===M&&b.rowCount===N&&b.col>I||b.col===I&&b.colCount===R&&b.row>M,a=g;a<m;a++)if(C=v&&h?I+R-1:I,w=v&&h?M+N-1:M,(x=p?this.l_(a,C,1,y,e):this.l_(w,a,y,1,e))&&x.h_())for(u=x.e_[0],h?(c=v?x.f_[k(x.f_)-1]:x.f_[0],s=this.m_(v,c,d,o,n,r,i),v&&(f=d-k(s),u=x.e_[k(x.e_)-1])):s=this.n_(x,d,o),l=0;l<k(s);l++)T=x.k_(s[l]),p?this.o_(A,a,u,a,I+f+l,T,o):this.o_(A,u,a,M+f+l,a,T,o)},Ut.prototype.l_=function(t,e,o,n,r){for(var i,a=$,s=this.kj,l=1===r,u=l?e+n-1:t+o-1,c=l?e:t;c<=u;)ft(i=l?s.getValue(t,u):s.getValue(u,e))&&(a=a||new rt(c)).Eb(0,u,i),u--;return a},Ut.prototype.m_=function(t,e,o,n,r,i,a){var s,l,u,c=[],h=e,f=0<=r,p=tt(i);for(s=0;s<o;s++)l=i<=h,u=h<=i,t&&(p||f&&l||!f&&u)?(c.unshift(h),1===n?h-=r:2===n?h/=r:3!==n||tt(a)||(h=this.p_(!0,a,e,h,r,s+1))):!t&&(p||f&&u||!f&&l)&&(c.push(h),1===n?h+=r:2===n?h*=r:3!==n||tt(a)||(h=this.p_(!1,a,e,h,r,s+1)));return c},Ut.prototype.n_=function(t,e,o){var n,r=[],i=1===o;if(i||2===o){for(1===t.h_()&&t.Sb(t.e_[0]+1,i?t.k_(t.f_[0]+1):t.Ey()[0]),n=0;n<e;n++)r.push(yt(!!i,t.j_(),t.i_(),n+1));return r}return $},Ut.prototype.B$=function(t,e,o,n,r){var i=this.kj,a=i._modelManager,s=i.Tq(t),l=s.row,u=s.col,c=s.rowCount,h=s.colCount,f=i.Tq(i._eventHandler.A$),p=f.row,d=f.col;if(a.qu(p,d,f.rowCount,f.colCount)||a.qu(l,u,c,h))throw Error(E().Exp_ChangeMergedCell);return this.q_(f,c,h,e,o,!(l<p||u<d),n,r)},Ut.prototype.q_=function(t,e,o,n,r,i,a,s){var l,u,c,h,f=i?1:-1,p=t.row,d=t.col,g=t.rowCount,m=t.colCount;if(1===n){if(l=v(o/m),u=o%m,!r)for(h=1;h<l;h++)c=C(p,d+h*f*m,g,m),this.r_(t,c,n,4,r,i,y,y,y,a,s);if(r&&1<l&&0===u&&(--l,u=m),0<l&&0<u)return c=C(p,i?d+l*m:d-l*m+m-u,g,u),this.r_(t,c,n,4,r,i,$,i?0:m-u,y,a,s)}else{if(l=v(e/g),u=e%g,this.AX||(c=C(p+f*g,d,e-g,o),this.dLb(t,c,f)),!r)for(h=1;h<l;h++)c=C(p+h*f*g,d,g,m),this.r_(t,c,n,4,r,i,$,$,!0,a,s);if(r&&1<l&&0===u&&(--l,u=g),0<l&&0<u)return c=C(i?p+l*g:p-l*g+g-u,d,u,m),this.r_(t,c,n,4,r,i,i?0:g-u,$,!0,a,s)}},Ut.prototype.r_=function(t,e,o,n,r,i,a,s,l,u,c){var h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G=this.kj,U=1===o,J=U?t.row:t.col,Z=U?t.col:t.row,q=U?e.row:e.col,K=U?e.col:e.row,Y=U?t.rowCount:t.colCount,Q=U?t.colCount:t.rowCount,X=U?e.colCount:e.rowCount;for(d=0;d<Y;d++){for(y=m=$,b=0,w=v=J+d,x=C=q+d,T=(U?s:a)||0,A=U?0:T,S=U?$:l,M=$;b<Q;)if(R=$,k=I=Z+b,E=N=K+b-T,U||(v=I,I=w,C=N,N=x),p=G._modelManager.findSpan(v,I),(h=G.getFormula&&G.getFormula(v,I))&&""!==h||(R=G.getValue(v,I)),(D=this.AX)&&tt(M)&&(M=!1===i?G.getValue(Z+Q-1,I):G.getValue(v,I)),D||4!==n||!ft(R)&&!pt(R)||(m=m||new rt,f=ft(R)?R instanceof Date?ot:et:nt,(y=y||f)!==f))if(!D&&R&&m&&m.h_()){if(g=this.s_(U,t,e,w,x,m,r,i,A,S,u,c),r&&g)return g;y=m=$}else{if(D||!p||p&&(U?p.row:p.col)===w)if(j=E==K+X-1,_=D?M:R,r){if(D)return _;if(p&&j||!p&&(j&&i||!i&&E===K))return R}else E<K+X&&K<=E&&(D||U||!U&&!(l&&G.Ps&&G.Ps(E)))&&(D&&-1!==this.cLb.indexOf(C)||this.o_(G,v,I,C,N,_,n,u,c));p?b+=U?p.colCount:p.rowCount:b++}else m.Sb(k,R),p?b+=U?p.colCount:p.rowCount:b++;if(this.AX)for(O=t.row,F=t.col,P=t.rowCount,L=t.colCount,B=H=void 0,V=!1===i?-1:1,z=1;z<P;z++)for(H=O+V*z,W=0;W<L;)B=F+W,-1===this.cLb.indexOf(H)&&this.o_(G,O,F,H,B,M,n,u,c),W++;if(m&&m.h_()&&(g=this.s_(U,t,e,w,x,m,r,i,A,S,u,c),r&&!tt(g)))return g}return $},Ut.prototype.dLb=function(t,e,o){var n,r,i,a,s,l,u,c=this.kj,h=c.tables,f=t.union(e),p=f.row,d=f.rowCount,g=t.row,m=t.col,y=t.rowCount,b=t.colCount;if(h)for(n=h.s$(g,m,y,b),r=0;r<n.length;r++)if(i=n[r].xr,a=this.cLb,s=void 0,i&&i.isFiltered&&i.isFiltered()){for(l=0;l<d;l++)s=p+o*l,i.isRowFilteredOut(s)&&this.cLb.push(s);if(0<a.length){this.AX=!0;break}}if(u=c.xr,!0!==this.AX&&u&&u.isFiltered&&u.isFiltered()){for(a=this.cLb,s=void 0,l=0;l<d;l++)s=p+o*l,u.isRowFilteredOut(s)&&this.cLb.push(s);0<a.length&&(this.AX=!0)}},Ut.prototype.o_=function(t,e,o,n,r,i,a,s,l){var u,c,h,f=t._modelManager;d&&(t.hasFormula(e,o)||t.hasFormula(n,r))&&(t.setFormula(n,r,$),0!==a&&4!==a||(u=t.Bj(),t.getFormula(e,o)&&p.CalcOperatorAdjustor.copyFormula(u,e,o,u,n,r,1,1,y,!0))),t.setValue(n,r,i),h=l?0:64,s&&(h|=128),h|=1024,t.ax(e,o,n,r,1,1,h,y,!0),t.removeSpan(n,r,3),(c=f.findSpan(e,o))&&e===c.row&&o===c.col&&t.Sq(n,r,c.rowCount,c.colCount,3)},Ut.prototype.s_=function(t,e,o,n,r,i,a,s,l,u,c,h){var f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I=this.kj,N=t?o.col:o.row,R=t?e.col:e.row,k=t?o.colCount:o.rowCount,E=t?e.colCount:e.rowCount;if(l=l||0,m=i.h_(),y=(N-R-l)/E,b=this.t_(i.e_,i.f_),v=i.Nc,b){for(d=[],p=0;p<m;p++)d[p]=p+1;f=m}else g=i.e_[0],f=i.e_[m-1]-g+1,1===m&&v!==nt&&i.Sb(i.e_[0]+1,i.k_(i.f_[0]+1)),d=i.i_();for(p=0;p<f;p++)if(C=i.Oyb,x=w=void 0,v!==ot&&v!==nt||(w=I.Fyb&&I.Fyb.getRule(v,C)),A=N+k-1,M=(S=(w?(x=w.getTargetValue(i,f*y+p+1,d,p,y),b=w.t_?w.t_:b,T=!!w.czb&&w.czb,b&&!T):(x=yt(!0,i.j_(),d,f*y+p+1),b))?i.e_[p]:g+p)+y*E,a){if(b&&(s&&M===A||!s&&M===N)||!b&&M+l===A)return i.k_(x)}else M<N+k&&N<=M&&(t?this.o_(I,n,S,r,M,i.k_(x),4,c,h):u&&I.Ps&&I.Ps(M)||this.o_(I,S,n,M,r,i.k_(x),4,c,h));return $},Ut.prototype.t_=function(t,e){var o,n,r,i=k(e);if(i<=1||k(t)!==i)return!1;for(o=t[1]-t[0],n=e[1]-e[0],r=2;r<i;r++)if(t[r]-t[r-1]!=o||e[r]-e[r-1]!=n)return!1;return!0},Ut.prototype.C$=function(t,e){var o,n=this.kj,r=n._modelManager.getSpans(),i=n.Tq(t),a=i.row,s=i.col,l=i.rowCount,u=i.colCount;o=0===e?C(a,s+u-1,l,1):1===e?C(a,s,l,1):C(2===e?a+l-1:a,s,1,u),(o=n.su(r,o))&&this.u_(o,a,s,l,u,e)},Ut.prototype.u_=function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d=t.row,g=t.col,m=t.rowCount,y=t.colCount,b=this.kj._modelManager;if(c=0===i?(p=b.MTa(e,o,n,r-y),h=0,f=-1*y,l=r,u=y,1):1===i?(p=b.MTa(e,o+y,n,r-y),h=0,l=r,u=f=y,1):(h=2===i?(p=b.MTa(e,o,n-m,r),-1*m):(p=b.MTa(e+m,o,n-m,r),m),l=n,u=m,f=0),p)throw Error(E().Exp_TargetContainsMergedCells);if(l%u!=0)throw Error(E().Exp_MergedCellsIdentical);for(a=v(l/u),s=1;s<a;s++)this.r_(t,C(d+s*h,g+s*f,m,y),c,0)},Ut.prototype.p_=function(t,e,o,n,r,i){var a=t?-1:1,s=v(i*r),l=Math.abs(r),u=g(1<e?o:n);if(0===e)u.setDate(u.getDate()+a*r);else if(1===e)for(;0<l;)u.setDate(u.getDate()+a*(0<r?1:-1)),6!==u.getDay()&&0!==u.getDay()&&l--;else 2===e?u.setMonth(u.getMonth()+a*s):u.setFullYear(u.getFullYear()+a*s);return f(u)},e.z$=Ut},"./dist/plugins/fill/fill.ns.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("./dist/plugins/fill/fill.res.en.js");e.SR={en:n}},"./dist/plugins/fill/fill.res.en.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CopyCells="Copy Cells",e.FillSeries="Fill Series",e.FillFormattingOnly="Fill Formatting Only",e.FillWithoutFormatting="Fill Without Formatting",e.Exp_NumberOnly="Only works for Numbers",e.Exp_RangeContainsMergedCell="Range should not have merged cells.",e.Exp_TargetContainsMergedCells="Target range should not have merged cells.",e.Exp_MergedCellsIdentical="This operation requires the merged cells to be identically sized.",e.Exp_FillRangeContainsMergedCell="Cannot fill range that contains a merged cell.",e.Exp_FillCellsReadOnly="The cells you are trying to fill are protected and therefore read-only.",e.Exp_ChangeMergedCell="Cannot change part of merged cell.",e.Exp_ColumnReadOnly="The column you are trying to change is protected and therefore read-only.",e.Exp_RowReadOnly="The row you are trying to change is protected and therefore read-only.",e.Exp_CellReadOnly="The cell you are trying to change is protected and therefore read-only.",e.Exp_RangeIsNull="range is null",e.Exp_ChangePartOfArray="Cannot change part of an array."},"./dist/plugins/formulaTextbox/formulaTextBox.entry.js":function(t,o,e){"use strict";function n(t){for(var e in t)o.hasOwnProperty(e)||(o[e]=t[e])}Object.defineProperty(o,"__esModule",{value:!0}),n(e("./dist/plugins/formulaTextbox/formulatextbox.js")),n(e("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js")),e("./dist/plugins/formulaTextbox/formulatextbox-event.js"),e("./dist/plugins/formulaTextbox/formulatextbox-actions.js"),e("./dist/plugins/formulaTextbox/formulatextbox-render.js")},"./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js":function(t,e,o){"use strict";var c,h,n;function i(t){var e=c.Ul.Nl("textarea");return c.GC$(e).css({display:"none"}),c.GC$(t).append(e),e}function r(){}function a(){var t=this;t.nT=-1,t.Mk=-1,t._text="",t.Q2=-1,t.kj=null,t.MH=!1,t.R2=-1,t.I0=null,t.OC=null,t.f1=null}Object.defineProperty(e,"__esModule",{value:!0}),c=o("Core"),h=o("./dist/plugins/formulaTextbox/formulatextbox.js"),e._createEditorElement=i,a.prototype.$b=function(){var t=this;t.S2(),t.nT=-1,t.Mk=-1,t._text="",t.Q2=-1,t.MH=!1,t.R2=-1,t.kj=null,t.OC=null,t.f1=null},a.prototype.S2=function(){var t,e,o=this;o.kj.Js||(t=o.kj.getCellType(o.nT,o.Mk),e={sheet:o.kj,row:o.nT,col:o.Mk,sheetArea:3},o.I0&&o.I0.firstChild&&t.deactivateEditor(o.I0.firstChild.firstChild,e)),c.GC$(o.I0).remove(),o.I0=null},a.prototype.T2=function(t){var e=this,o=t._formulaTextBox;o&&(e._text=o.text(),e.nT=t.getActiveRowIndex(),e.Mk=t.getActiveColumnIndex(),e.Q2=o.caret(),e.MH=o.MH,e.R2=o.C1(),e._isSelectMode=o._isSelectMode,e.C5=o.C5,e.Nfa=o.Nfa,e.kj=t,e.OC=t.parent,e.f1=t._eventHandler.bG())},a.prototype.VF=function(t){t._formulaTextBox&&(this._text=t._formulaTextBox.text(),this.Q2=t._formulaTextBox.caret(),this.MH=t._formulaTextBox.MH,this.R2=t._formulaTextBox.C1())},a.prototype.U2=function(t){var e=t._formulaTextBox;e&&(e._isSelectMode=this._isSelectMode,e.C5=this.C5,e.Nfa=this.Nfa,e.text(this._text),e.caret(this.Q2),this.MH&&(e.B1(),e.C1(this.R2)))},a.prototype.V2=function(t){var e,o=t.oldSheet,n=o&&o._formulaTextBox;if(n)if(n.close(),(!this.kj||this.kj.Js)&&n.M0()||this.C5!==n.C5){this.T2(o),e=o.getValue(o.Jl,o.Kl,3),o.suspendEvent();try{if(!o.endEdit(!0))return}finally{o.resumeEvent()}o.setValue(o.Jl,o.Kl,e,3,!0),o._editorStatus=1,t.needTriggerSheetChange=!1}else this._text&&(this.VF(o),n.destroy(),o._formulaTextBox=null,t.needTriggerSheetChange=!1)},a.prototype.W2=function(t){var e,o=t.oldSheet,n=t.newSheet,r=this;n.Js||(r.I0&&""===r._text&&(o.GJ(),r.$b()),r._text&&r.kj===n?(n._editorStatus=0,n.zt(),n.suspendEvent(),r._isSelectMode?(e=i(n.parent._host),h._attachFormulaTextBox(n,e),n._editorStatus=2,n._render._paintFormulaTextBox()):n.startEdit(!1),n.resumeEvent(),r.U2(n),r.VK(n,r.nT,r.Mk),o.GJ(),r.$b()):r._text&&!r.I0?(n._editorStatus=1,o._editorStatus=1,r.X2(n),n.EJ()):r._text&&r.kj!==n&&(n._editorStatus=1,o._editorStatus=1,r.X2(n),o.GJ(),n.EJ()))},a.prototype.X2=function(t){var e,o,n,r,i,a,s,l=this,u=l.kj;u.Js||(e=l.nT,o=l.Mk,n=u.getCellType(e,o),r={sheet:u,row:e,col:o,sheetArea:3,canvasOffset:this.f1},n.isImeAware(r)&&(t._editorStatus=1,i=n._createCellTypeElement(r),l.I0&&l.S2(),l.I0=i,c.GC$(i).css("position","absolute"),a=u.getCellRect(e,o),c.GC$(i).attr("id","across"),s=u.getActualStyle(e,o),n._activateEditorWrapper(i,s,a,r),(l.OC&&l.OC.getHost()||document.body).insertBefore(i,null),l._isSelectMode&&c.GC$(i).css({display:"none"}),h._attachFormulaTextBox(t,n.getEditingElement(),!0),i.firstChild&&!l._isSelectMode&&n.focus(i.firstChild.firstChild),l.U2(t),n._updateEditorWrapper(i,s,a,r)))},a.prototype.VK=function(t,e,o){var n,r=t.getCellType(e,o),i=t._editor,a=t.am(),s=t.getActualStyle(e,o),l=t.getCellRect(e,o);l&&0<l.width&&0<l.height&&l.x>=a.kt&&l.y>=a.nt&&l.x+l.width<=a.lt+a.js&&l.y+l.height<=a.ot+a.gs&&(n={sheet:t,row:e,col:o,sheetArea:3},i&&i.parentNode&&r._updateEditorWrapper(i.parentNode.parentNode,s,l,n))},n=a,r.Q0=function(t,e){r.H0||(r.H0=new n),r.H0.V2(e)},r.R0=function(t,e){r.H0||(r.H0=new n),r.H0.W2(e)},e.G0=r},"./dist/plugins/formulaTextbox/formulatextbox-actions.js":function(t,e,o){"use strict";var R,n,k,i,E,b;function D(t){var e=t._formulaTextBox,o=t._eventHandler;return e.MH?o.E2:o.E2={anchorRow:t.Jl,anchorCol:t.Kl,leadingRow:t.Qr,leadingCol:t.Rr}}function s(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M=t._formulaTextBox,I=t.parent,N=I&&I.options;if(M&&M.M0()&&N&&N.allowUserEditFormula&&N.enableFormulaTextbox){switch(a=(i=D(t)).anchorRow,s=i.anchorCol,l=i.leadingRow,u=i.leadingCol,E(n)&&(n=a),E(r)&&(r=s),c=t._eventHandler,e){case 3:g=t.iy(n,r,o,l);break;case 4:g=t.hy(n,r,o,l);break;case 1:g=t.HJ(n,r,o,u);break;case 2:g=t.LJ(n,r,o,u);break;case 5:g=t.OJ();break;case 6:g=t.NJ()}g&&(h=g.row,f=g.col,p=g.leadingCellRow?g.leadingCellRow:h,d=g.leadingCellCol?g.leadingCellCol:f,t.IJ(h,f)&&(i.anchorRow=h,i.anchorCol=f,i.leadingRow=p,i.leadingCol=d,m=t.pivotTables&&t.pivotTables.findPivotTable(p,d),y=M.shift,b=M.ctrl,C=(v=m&&m.getPivotInfoImp(p,d,!1,!0))&&v.area,!M.Nfa&&m&&v&&4===C?(M.uMc=new R.Range(p,d,1,1),w=v.valueFieldName,x=v.rowInfos,T=v.colInfos,(x||T)&&((A=t._eventHandler.vMc(C,w,x,T,m.position()))&&(M._appendRange(A,y,!b,!0),M._isWorking=!1))):(delete M.uMc,(S=k._rangeToString(c.kj,R.kf(h,f,1,1)))&&M._appendRange(S,!1,!0)),0<=h&&0<=f&&t.Yq(h,f)))}}function l(){}Object.defineProperty(e,"__esModule",{value:!0}),R=o("Core"),n=o("@grapecity/js-sheets-common"),k=o("./dist/plugins/formulaTextbox/formulatextbox.js"),i=o("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),E=n.Common.j.Fa,R.Commands.Ox=function(t,e){if(t){if(2===t._editorStatus)return!1;var o=t._formulaTextBox;return o&&o.M0()?s(t,e,!1):(o&&(t=b.O2(t)),t.yx(e,!1)),!0}return!1},R.Commands.Qx=function(t,e,o,n){if(t){if(2===t._editorStatus)return!1;var r=t._formulaTextBox;return r&&r.M0()?s(t,e,!1,o,n):(r&&(t=b.O2(t)),t.yx(e,!1,o,n)),!0}return!1},R.Commands.Rx=function(t,e,o){if(t){if(2===t._editorStatus)return!1;var n=t._formulaTextBox;return n&&n.M0()?(i=e,a=o,g=(r=t)._formulaTextBox,m=r.parent,y=m&&m.options,g&&g.M0()&&y&&y.allowUserEditFormula&&y.enableFormulaTextbox&&(s=r._eventHandler,u=(l=D(r)).anchorRow,c=l.anchorCol,(h=g.MH?(f=g.m1(),k._stringToRange(r,f.text)):R.kf(u,c,1,1))&&(p=r.UJ(h,i,a,u,c),(d=k._rangeToString(s.kj,p))&&g._appendRange(d,!0,!1))),!0):(n&&(t=b.O2(t)),!!t.endEdit()&&(t.Sx(e,o),!0))}var r,i,a,s,l,u,c,h,f,p,d,g,m,y;return!1},l.fv=function(t){return l.O2(t)},l.Xx=function(t){return l.O2(t)},l.Yx=function(t){return l.O2(t)},l.O2=function(t){var e=t,o=i.G0.H0;return o&&o._text&&(e=o.kj,l.G2(e)),e},l.G2=function(t,e){var o,n;void 0===e&&(e=!0),o=t.parent,(n=i.G0.H0)&&n._text&&o.hw(t,e)},l.Zx=function(t,e,o){var n,r,i=!1,a=t._formulaTextBox;return a&&a.M0()?((n=D(t)).anchorRow=e,n.leadingRow=e,(r=k._rangeToString(t,R.kf(n.anchorRow,n.anchorCol,1,1)))&&a._appendRange(r,!1,!0),t.mq(o),i=!0):a&&(t=l.O2(t)),{sheet:t,r:i}},l._x=function(t,e,o){var n,r,i=!1,a=t._formulaTextBox;return a&&a.M0()?((n=D(t)).anchorRow=e,n.leadingRow=e,(r=k._rangeToString(t,R.kf(n.anchorRow,n.anchorCol,1,1)))&&a._appendRange(r,!1,!0),t.mq(o),i=!0):a&&(t=l.O2(t)),{sheet:t,r:i}},l.pzb=function(t,e){var o=!1,n=e?5:6,r=t._formulaTextBox,i=t.Jl,a=t.Kl;return r&&r.M0()?(r.MH||(t._eventHandler.E2={anchorRow:i,anchorCol:a,leadingRow:t.Qr,leadingCol:t.Rr}),s(t,n,!1,i,a),o=!0):r&&(t=l.O2(t)),{sheet:t,r:o}},l.ay=function(t){return l.pzb(t,!0)},l.by=function(t){return l.pzb(t,!1)},l.ey=function(t){return l.O2(t)},l.gy=function(t){return l.O2(t)},l.jy=function(t){var e,o,n,r=i.G0.H0;if(r&&r._text&&(t=r.kj,e=r.nT,o=r.Mk,l.G2(t,!1),k._detachFormulaTextBox(t),r._isSelectMode||t.Sr(e,o,void 0,void 0,1),t.isEditing()))return n=t.getValue(e,o,3),!!t._endEditImp(!0,void 0,void 0,!0)&&(t.setValue(e,o,n,3,!0),!0)},b=l,R.Commands.Wx=b},"./dist/plugins/formulaTextbox/formulatextbox-event.js":function(t,e,o){"use strict";var k,d,g,E,y,n,v,C;Object.defineProperty(e,"__esModule",{value:!0}),k=o("Core"),d=o("@grapecity/js-calc"),g=o("SheetsCalc"),E=o("./dist/plugins/formulaTextbox/formulatextbox.js"),y=o("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),n=k.GC$.extend,v=Math.max,C=Math.min,n(k.iI.prototype,{D2:function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I=this,N=I.kj,R=N._formulaTextBox;R&&(I.Kka(),e=N.frozenRowCount(),o=N.frozenColumnCount(),(n=R.MH)&&I.E2||(I.E2={anchorRow:-1,anchorCol:-1,leadingRow:-1,leadingCol:-1}),r=N.getRowCount(),i=N.getColumnCount(),a=t.hitTestType,s=t.row,l=t.col,u=I.shift,c=I.ctrl,f=(h=I.E2).anchorRow,p=h.anchorCol,g=d=-1,0===a?(d=e?N.ar():N.lq,g=o?N.$q():N.qq,m=k.kf(-1,-1,-1,-1),R._appendRange(E._rangeToString(N,m),u,!c),I._isWorking=!0):1===a?(d=e?N.ar():N.lq,g=l,m=N.Jx(0,l,r-1,l,!0),u&&0<=p&&(m=N.Jx(0,l,r-1,p,!0)),m=k.kf(-1,m.col,-1,m.colCount),R._appendRange(E._rangeToString(N,m),u,!c),I._isWorking=!0):2===a?(d=s,g=o?N.$q():N.qq,m=N.Jx(s,0,s,i-1,!0),u&&0<=f&&(m=N.Jx(s,0,f,i-1,!0)),m=k.kf(m.row,-1,m.rowCount,-1),R._appendRange(E._rangeToString(N,m),u,!c),I._isWorking=!0):3===a&&(g=l,void 0!==(d=s)&&void 0!==l&&(y=t.row,b=t.col,w=(C=(v=t.pivotTableInfo)&&v.getPivotInfoImp(y,b,!1,!0))&&C.area,x=t.tableSelectInfo&&t.tableSelectInfo.tableSelection,!R.Nfa&&v&&C&&4===w?(R.uMc=new k.Range(y,b,1,1),T=C.valueFieldName,A=C.rowInfos,S=C.colInfos,!A&&!S||(M=I.vMc(w,T,A,S,v.position()))&&(R._appendRange(M,u,!c,!0),I._isWorking=!0,I.SLc=!0)):(delete R.uMc,x?m=x:(m=N.Jx(s,l,s,l,!0),m=k.kf(m.row,m.col,1,1),u&&0<=f&&0<=p&&(m=N.Jx(s,l,f,p,!0))),R._appendRange(E._rangeToString(N,m),u,!c),I._isWorking=!0))),I.DG=I._isWorking,u&&n||(h.anchorRow=d,h.anchorCol=g,h.leadingRow=d,h.leadingCol=g),I.rG={KG:t.rowViewportIndex,MG:t.colViewportIndex,sG:t.hitTestType},I.qG())},vMc:function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p=this.kj;if(4===t)return 0,s=r.row,l=r.col,u=k.kf(s,l,1,1),i=E._rangeToString(p,u,!0),c=[],h=[],(h=Array.isArray(o)&&Array.isArray(n)?o.concat(n):Array.isArray(o)&&o||Array.isArray(n)&&n)&&h.forEach(function(t){"number"==typeof t.fieldName?c.push(t.fieldName):c.push('"'+t.fieldName+'"'),"number"==typeof t.itemName?c.push(t.itemName):c.push('"'+t.itemName+'"')}),f='GETPIVOTDATA("'+e+'",'+i,""!==(a=c.join(","))&&(f+=","+a),f+")"},F2:function(t){var e,o,n=!1,r=y.G0.H0;if(r&&r.I0)if(e=r.kj,(o=t._formulaTextBox)&&e.setFormula(r.nT,r.Mk,o.text()),e!==t){if(k.Commands.Wx.G2(e),!e.endEdit())return;n=!0}else o&&(o.destroy(),t._formulaTextBox=null),r.$b();return n},EG:function(){var t,e=this.rG;e&&this._isWorking&&(3===(t=e.sG)?this.H2():2===t?this.I2():1===t&&this.J2())},H2:function(){var t,e,o,n,r=this.E2,i=r.anchorRow,a=r.anchorCol,s=this.fH(),l=this.gH();0<=i&&0<=a&&0<=s&&0<=l&&(e=(t=this.kj).Jx(s,l,i,a,!0),(o=E._rangeToString(t,e))&&(n=t._formulaTextBox,this.SLc?e.equals(n.uMc)||(delete n.uMc,n._appendRange(o,!0,!0)):n._appendRange(o,!0,!1))),this.NG()},I2:function(){var t,e,o,n=this.E2.anchorRow,r=this.fH();0<=n&&0<=r&&(e=(t=this.kj).Jx(r,0,n,t.getColumnCount()-1,!0),e=k.kf(e.row,-1,e.rowCount,-1),(o=E._rangeToString(t,e))&&t._formulaTextBox._appendRange(o,!0,!1)),this.NG()},J2:function(){var t,e,o,n=this.E2.anchorCol,r=this.gH();0<=n&&0<=r&&(e=(t=this.kj).Jx(0,r,t.getRowCount()-1,n,!0),e=k.kf(-1,e.col,-1,e.colCount),(o=E._rangeToString(t,e))&&t._formulaTextBox._appendRange(o,!0,!1)),this.NG()},yH:function(){this.RG(),this.rG=null,this._isWorking=!1,this.DG=!1},iG:function(t){var e,o,n,r,i,a,s,l,u=this.kj,c=this._oa(),h=t.formulaRangeHitInfo;h&&h.inBorder&&c&&(c.MH&&c._stopAppending(),c.close(),!(o=(e=h.paramRange)&&e.text)||(n=E._stringToRange(u,o))&&(this.Kka(),r=u.Tq(n),i=t.row,a=t.col,i<r.row&&(i=r.row),i>=r.row+r.rowCount&&(i=r.row+r.rowCount-1),a<r.col&&(a=r.col),a>=r.col+r.colCount&&(a=r.col+r.colCount-1),s=i-r.row,l=a-r.col,this._isWorking=!0,this.FG=!0,this.K2={paramRange:e,fromRange:n,rowOffset:s,colOffset:l},this.rG={KG:t.rowViewportIndex,MG:t.colViewportIndex,sG:t.hitTestType},this.qG()))},GG:function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b;this._isWorking&&this.FG&&(t=this.fH(),e=this.gH(),0<=t&&0<=e&&(n=(o=this.K2).fromRange,r=o.rowOffset,i=o.colOffset,a=o.toRow,s=o.toCol,l=e,t===a&&l===s||(o.toRow=t,o.toCol=l,c=(u=this.kj).getRowCount(),h=u.getColumnCount(),f=n.row,p=n.col,d=n.rowCount,g=n.colCount,m=f<0?-1:v(0,C(c-d,t-r)),y=p<0?-1:v(0,C(h-g,e-i)),(b=E._rangeToString(u,k.kf(m,y,d,g)))&&this._oa()._repalceRange(o.paramRange.index,b,!0))),this.NG())},zH:function(){var t;this.RG(),this._isWorking=!1,this.FG=!1,this.K2=null,(t=this._oa()).onRangeMoved&&t.onRangeMoved()},jG:function(t){var e,o,n,r,i,a,s,l,u,c,h,f=this.kj,p=this._oa(),d=t.formulaRangeHitInfo;if(d&&p&&(p.MH&&p._stopAppending(),o=(e=d.paramRange)&&e.text,e&&o&&(n=E._stringToRange(f,o)))){if(this.Kka(),r=n.row,i=n.row<0?-1:n.row+n.rowCount-1,a=n.col,s=n.col<0?-1:n.col+n.colCount-1,d.inTopLeft)l=i,u=s,c=r,h=a;else if(d.inTopRight)l=i,u=a,c=r,h=s;else if(d.inBottomLeft)l=r,u=s,c=i,h=a;else{if(!d.inBottomRight)return;l=r,u=a,c=i,h=s}this._isWorking=!0,this.HG=!0,this.L2={paramRange:e,anchorRow:l,anchorCol:u,toRow:c,toCol:h},this.rG={KG:t.rowViewportIndex,MG:t.colViewportIndex,sG:t.hitTestType},this.qG()}},kG:function(t,e){var o=t._formulaTextBox;return o&&o.M0()?(this.D2(e),!0):!!this.F2(t)},IG:function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b;this._isWorking&&this.HG&&(t=this.fH(),e=this.gH(),0<=t&&0<=e&&(n=(o=this.L2).anchorRow,r=o.anchorCol,i=o.toRow,a=o.toCol,l=e,(s=t)===i&&l===a||(o.toRow=s,o.toCol=l,c=(u=this.kj).getRowCount(),h=u.getColumnCount(),p=r<0?h-1:r,d=C(f=n<0?c-1:n,s),g=C(p,l),m=v(f,s)-d+1,y=v(p,l)-g+1,0===d&&m===c&&(m=d=-1),0===g&&y===h&&(y=g=-1),(b=E._rangeToString(u,k.kf(d,g,m,y)))&&this._oa()._repalceRange(o.paramRange.index,b,!0))),this.NG())},AH:function(){var t,e;this.RG(),this._isWorking=!1,this.HG=!1,this.L2=null,!(t=this._oa())._isSelectMode||-(t.W0=1)!==(e=t.text().lastIndexOf(",",t.caret()))&&(t.W0=e+1),t.onRangeResized&&t.onRangeResized()},vr:function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d=this.kj,g=this._oa(),m=g&&g.l1();if(!m||0===m.length||!g.UQa)return null;if(n=t.rowViewportIndex,r=t.colViewportIndex,this.qH(n,r,e,o))return null;for(l=m.length-1;0<=l;l--)if(!1!==(i=m[l]).allowDrag&&((!(u=y.G0.H0)||!u._text)&&(a=E._stringToRange(d,i.text)))){if(c=(s=d.getRangeRect(n,r,a)).x-2,h=s.x+s.width+1-5,f=s.y-2,p=s.y+s.height+1-5,5+c<=e&&e<h&&(1+f<=o&&o<=3+f||1+p<=o&&o<=3+p))return{paramRange:i,inBorder:!0};if(5+f<=o&&o<p&&(1+c<=e&&e<=3+c||1+h<=e&&e<=3+h))return{paramRange:i,inBorder:!0};if(h<=e&&e<5+h&&p<=o&&o<5+p)return{paramRange:i,inBottomRight:!0};if(c<=e&&e<5+c&&p<=o&&o<5+p)return{paramRange:i,inBottomLeft:!0};if(h<=e&&e<5+h&&f<=o&&o<5+f)return{paramRange:i,inTopRight:!0};if(c<=e&&e<5+c&&f<=o&&o<5+f)return{paramRange:i,inTopLeft:!0}}return null},_oa:function(){var t=this.kj;return t._formulaTextBox||t._formulaTextBoxForChart},ly:function(){var t,e,o,n,r,i,a,s,l,u,c,h,f=this.kj,p=f._formulaTextBox;if(p)if(t=f.Jl,e=f.Kl,n=(o=f.parent)&&1===o.options.referenceStyle,r=new g.SheetParserContext(f,n,d._createCellIdentity(t,e)),i=new d.Parser,p.MH)for(l=p.u1(),u=0;u<l.length;u++){a=l[u];try{s=i.parse(r,a.text)}catch(t){s=null}s&&1===s.type&&(this.M2(s,t,e,!0,!0),p._repalceRange(a.index,i.unparse(r,s)))}else{if(!(a=p.m1()))return;try{s=i.parse(r,a.text)}catch(t){s=null}if(!s)return;1!==s.type||s.sf()?1===s.type&&(this.N2(s,t,e),p._repalceRange(a.index,i.unparse(r,s))):(c=a.textOffset+a.text.lastIndexOf(":"),p.caret()<=c?(this.M2(s,t,e,!0,!1),h=i.unparse(r,s),p._repalceRange(a.index,h),p.caret(a.textOffset+h.lastIndexOf(":"))):(this.M2(s,t,e,!1,!0),p._repalceRange(a.index,i.unparse(r,s))))}},M2:function(t,e,o,n,r){var i,a,s=t.rowRelative,l=t.columnRelative;n&&(s&&l?(t.rowRelative=!1,t.columnRelative=!1,t.row+=e,t.column+=o):!s&&l?(t.rowRelative=!0,t.columnRelative=!1,t.row-=e,t.column+=o):(t.columnRelative=!0,t.column-=o)),i=t.endRowRelative,a=t.endColumnRelative,r&&(i&&a?(t.endRowRelative=!1,t.endColumnRelative=!1,t.endRow+=e,t.endColumn+=o):!i&&a?(t.endRowRelative=!0,t.endColumnRelative=!1,t.endRow-=e,t.endColumn+=o):(t.endColumnRelative=!0,t.endColumn-=o))},N2:function(t,e,o){var n=t.rowRelative,r=t.columnRelative;n&&r?(t.rowRelative=!1,t.columnRelative=!1,t.row+=e,t.column+=o):!n&&r?(t.rowRelative=!0,t.columnRelative=!1,t.row-=e,t.column+=o):(t.columnRelative=!0,t.column-=o)},Kka:function(){var t,e=this.kj._formulaTextBox;!e||(t=e._host)&&e.Cia(t)&&e.Jka()}})},"./dist/plugins/formulaTextbox/formulatextbox-render.js":function(t,e,o){"use strict";var n,B,V,z,W,r,G;function u(t,o,e,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_=t.kj,O=_._eventHandler,F=i&&i.l1(),P=F&&F.length,L=Kt&&Kt._legacyWynbi&&Kt._legacyWynbi.spreadChartEditState&&Kt._legacyWynbi.spreadChartEditState.pivotTableManager,H=[];if(L&&(a=L.getPivotTableBySheet(t.kj))){if(P=0,!(s=a.text2Ranges(i.text(),_.name()))||!s.length)return;H=s}if(!(P<=0&&H.length<=0)&&(l=t.VI(e,n,r))){for(o.save(),o.rect(l.x,l.y,l.width,l.height),o.clip(),o.beginPath(),t.XI(e,n,H,l).forEach(function(t,e){t&&0!==t.width&&0!==t.height&&(o.beginPath(),o.lineWidth=2,o.strokeStyle=W.DEFAULT_RANGE_COLORS[e%W.DEFAULT_RANGE_COLORS.length],o.rect(t.x+1,t.y+1,t.width-3,t.height-3),o.stroke())}),u=[],c=O.isFormulaRangeHoving,h=O.tH,f=O.FG,p=O.K2,d=O.HG,g=O.L2,w=0;w<P;w++)if(y=(m=F[w]).text,b=m.ranges&&0<m.ranges.length?m.ranges:[V._stringToRange(_,y)]){if((x=z.G0.H0)&&x.kj&&void 0!==y)if(G.Bb(y,"!")){if(T=G.Ib(y,"!"),_.name()!==T&&"'"+_.name()+"'"!==T)continue}else if(A=G.Ib(y,"["),S=_.tables,!(_.getCustomNames()[A]||S&&S.findByName(A)))continue;for(v=t.XI(e,n,b,l),M=0;M<v.length;M++)(I=v[M])&&0<I.width&&0<I.height&&(C=i.o1(w),i.t1(m)||m.isPivotClickCell?(c&&h.paramRange.index===w&&(o.beginPath(),o.lineWidth=2,o.strokeStyle=C,o.rect(I.x+1,I.y+1,I.width-3,I.height-3),o.stroke()),t.fJ(o,I,C)):(c&&h.paramRange.index===w||f&&p.paramRange.index===w||d&&g.paramRange.index===w?(o.beginPath(),o.lineWidth=2,o.strokeStyle=C,o.rect(I.x+1,I.y+1,I.width-3,I.height-3)):(o.beginPath(),o.lineWidth=2,o.strokeStyle=C,o.rect(I.x,I.y,I.width-1,I.height-1)),o.stroke()),i.n1(m)&&((N=B.Common.pc.ec(C)).a=.1,o.beginPath(),o.fillStyle=B.Common.pc.bc(N),o.fillRect(I.x+1,I.y+1,I.width-3,I.height-3)),u.push({rect:I,color:C,allowDrag:m.allowDrag}))}if(0<u.length&&i.UQa)for(R=u.length,w=0;w<R;w++)I=u[w].rect,C=u[w].color,k=I.x-2,E=I.x+I.width+1-5,D=I.y-2,j=I.y+I.height+1-5,!1!==u[w].allowDrag&&((x=z.G0.H0)&&x._text||(o.beginPath(),o.fillStyle=C,o.fillRect(k,D,5,5),o.fillRect(E,D,5,5),o.fillRect(k,j,5,5),o.fillRect(E,j,5,5)));o.beginPath(),o.restore()}}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),B=o("@grapecity/js-sheets-common"),V=o("./dist/plugins/formulaTextbox/formulatextbox.js"),z=o("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),W=o("./dist/plugins/formulaTextbox/formulatextbox.js"),r=n.GC$.extend,G=B.Common.u,r(n.oJ.prototype,{_paintFormulaTextBox:function(){var t,e,o=this.kj;0<o.Xq||(t=o.am(),e=this.bm(),this.Mx(t.x,t.y,t.width,t.height),this.Pw(e))}}),n.Worksheet.$n("formulatextboxrender",{paintAdornment:function(t){var e,o,n,r=t.ctx,i=t.clipRect,a=this._render,s=this.am(),l=this._eventHandler._oa();if(l)for(o=0;o<=2;o++)for(n=0;n<=2;n++)(e=s.Ft(o,n))&&0!==e.width&&0!==e.height&&u(a,r,o,n,i,l)}})},"./dist/plugins/formulaTextbox/formulatextbox.js":function(t,c,e){"use strict";var p,y,b,w,x,v,u,d,o,T,A,S,C,M,f,n,h,g,r,i,I,a,s,N,m,R,k,l,E,D,j,_,O,F,P;function L(t){var o,n=[];return w.GC$.each(t,function(t,e){(o=e.description())&&(o.name=t,n.push(o))}),n}function H(t){var e=p.getMapping()&&p.getMapping().builtInFunctionsMapping;return e&&e[t]&&e[t].alias||t}function B(i,t,e){var o,n,a,s,l,r,u=i.parent,c=u&&u.options;(t&&c&&c.allowUserEditFormula&&c.enableFormulaTextbox||e)&&(i._formulaTextBox&&i._formulaTextBox.destroy(),i._formulaTextBox=new P(t,null,u),o=i._formulaTextBox.text(),n=i.getFormulaInformation(i.Jl,i.Kl),"="!==o[0]||n&&n.hasFormula||(o="'"+o,i._formulaTextBox.text(o)),a=i._formulaTextBox,s=i._eventHandler,l=i._render,a.bind("AppendStarted",function(){a.close();var t=i._editorStatus;1!==t&&(i._editorStatus=1,i._raiseEditorStatusChanged(t,1))}),a.bind("AppendEnded",function(){l._paintFormulaTextBox()}),a.bind(N,function(t,e){if(!i.Js){if(e&&e.type!==I){s._updateEditingEditor(e);var o=i.Jl,n=i.Kl,r=i.getCellType(o,n);i.Wq(w.Events.EditChange,{sheet:i,sheetName:i.name(),row:o,col:n,editingText:r.getEditorValue(i._editor)})}l._paintFormulaTextBox(),i.Wq(w.Events.FormulaTextBoxTextChanged,{sheet:i,sheetName:i.name(),text:a.text()})}}),a.bind("CaretChanged",function(){l._paintFormulaTextBox(),i.Wq(w.Events.FormulaTextBoxCaretChanged,{sheet:i,sheetName:i.name(),caret:a.caret()})}),a.add((r=[],w.GC$.each(p.sR()._h,function(t,e){p.Functions.bi[t]&&(e.name=t,r.push(e))}),r)),a.add(L(p.Functions.ci)),a.add(L(i.Su).concat(L(u.Su))),l._paintFormulaTextBox())}function V(t){t._formulaTextBox&&(t._formulaTextBox.destroy(),t._formulaTextBox=v,t._render._paintFormulaTextBox());var e=t.parent&&t.parent.CF;S.activeElement===(e&&e._host)&&t._eventHandler.Qq()}function z(t){var e,o=["FILTER","RANDARRAY","SEQUENCE","SORT","SORTBY","UNIQUE"];for(e=0;e<o.length;e++)if(t===o[e])return 1}function W(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v=this,C=t;if(v._isSelectMode=!1,v.Nfa=!1,v._needSheetName=!0,v.Ac=[],v.Bc=[],v._gc=[],e&&e.rangeSelectMode&&(!0===e.absoluteReference&&(v.Nfa=!0),!1===e.needSheetName&&(v._needSheetName=!1),v._isSelectMode=!0,v.D5=!1,v.E5=!1,v.cga=t,a=t,s=v,(b=w.GC$(a)).attr("contenteditable","false"),l=T("table"),w.GC$(l).css("border-spacing","0"),w.GC$(l).css("width","100%"),b.append(l),u=T("tbody"),l.appendChild(u),c=document.createElement("tr"),u.appendChild(c),h=document.createElement("td"),w.GC$(h).css("padding-right","0px"),c.appendChild(h),f=document.createElement("td"),w.GC$(f).css("width","23px"),w.GC$(f).css("padding-right","0px"),c.appendChild(f),p=b.width()-w.GC$(f).width(),d=T("div"),g=T("div"),w.GC$(g).width(p),w.GC$(g).css({"overflow-y":"auto","overflow-x":"hidden",height:"20px"}),g.appendChild(d),h.appendChild(g),m=T("div"),f.appendChild(m),w.GC$(d).css({display:"inline-block",float:"left",height:"auto",outline:"none"}),w.GC$(d).width(p),w.GC$(d).attr("contenteditable","true"),w.GC$(d).attr("spellcheck","false"),(y=w.GC$(m)).css({display:"block",float:"right",width:"23px",height:"23px",background:k,"background-repeat":"no-repeat"}),y.bind("click",function(){s.D5?(s.OC.Wq("RangeSelectEnding",s),s.endSelectMode()):s.startSelectMode()}),C=(n={contentDiv:d,button:m}).contentDiv,v.sia=n.button,v.tia=t,v.C5=F,F++),v.UQa=!0,v.ad(o&&o.getHost()||S.body),C&&v.N0(C),o&&(v.O0=!0,v.P0(o),v.OC._unbind(w.Events.FormulatextboxActiveSheetChanging,x.G0.Q0),v.OC._bind(w.Events.FormulatextboxActiveSheetChanging,x.G0.Q0),v.OC._unbind(w.Events.FormulatextboxActiveSheetChanged,x.G0.R0),v.OC._bind(w.Events.FormulatextboxActiveSheetChanged,x.G0.R0)),r=v.text(),v._tokens=v.T0(r),v.Cia(C)){v.V0(v._tokens);try{(i=A.getSelection()).selectAllChildren(C),0<i.rangeCount&&i.collapseToEnd()}catch(t){}w.GC$(v._host).data(D,r)}}function G(t){return"gcAttachedFormulaTextBox"===t.target.getAttribute("gcuielement")}Object.defineProperty(c,"__esModule",{value:!0}),p=e("@grapecity/js-calc"),y=e("SheetsCalc"),b=e("@grapecity/js-sheets-common"),w=e("Core"),x=e("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),v=null,u=Math.max,d=Math.min,o=w.GC$.extend,T=w.Ul.Nl,A=window,S=document,C=b.Common.u,M=w.Ul.nl,f=b.Common.j.Fa,n=w.Ul.Ml,h=n.msie&&parseInt(n.version,10)<10,g=C.Nb,r="formulatextbox",i="gcUIElement",I="input",a=".gcFormulaTextBoxInternal",s=".gcFormulaTextBox",N="TextChanged",m="CaretChanged",R={left:37,right:39,up:38,down:40,tab:9,enter:13,pup:33,pdn:34,end:35,home:36,esc:27},c.DEFAULT_RANGE_COLORS=["#0000ff","#008000","#9900cc","#800000","#00cc33","#cc6600","#cc0099"],k='url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARCAIAAACw+gCQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJSSURBVDhPY3hILqBYZ/eqV81LXpbNfp7S/yS0+Z5p+olD5x5OWXGyYcaBmql7yifuLOnbBkRFPVuACKIFqjNzwv2Qhhue5ReByK/qYlDtxb///n35+efd1z/PP/wB6vn2+/f7b79ffgIhiBaoTlPP5I2bN2/asmX7jh3Hjh+ft3wLUOfX779ef/h+6+nHtXsuffrx+/bj16euvwQiiBaETiAy904NTasGantRkvA8wetpsO0NJ839htKb9l/Jal6T3rgytX4FEEG0QHXuOnbr55+/P379AyIg40m8x8uZ3U+aC49bKn64eHzX0es4Xds0Y9ejl++vPXx3+f77Nx9/3PU3e5YR/CTM4WGs53pVPqBrgX6+8+QNFtdmNq0q6NpU1LOpe/6+o+fvH3fR36XCc9dE/KG3EdDNQPaF7VunLTuY0bA0omg2RAtUZ1LNUohjgCEJDJVtdlpPty6dr8x3yUDsvoPqRm2hqcp8Jy+9WbH/7cQ1EB0wnXEVCyBBt+fc8+NXXy9Yf/znz5/31swFaliiKjBZme/yrSe7z36YsuZBy4KbEC1QnRFFcxKqFgP1A1Fq7ZKcpqU1EzYuWX/kxIa1/WBtizYcAwqG5E71SZsA0QLVGZI3A+Lax+/+ACMwvHDmsn1v1xx8e+jSp83HXgP1ALmztryYsv4ZEEG0QHUGZk+FuHbHqadABORO3fC8Z/mdvmU3Oxdd9cuY1LX0VsOci/WzQQiiBaET4lQgii1fEFU6F4iAXgC6JShnakDWZKBmoDshCKIFqpMMQK7Ohw8BTajNa73pg9oAAAAASUVORK5CYII=")',l="background",E="background-repeat",D="text-before",j="caret-before",c._rangeToString=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m;return e?(n=Kt&&Kt._legacyWynbi&&Kt._legacyWynbi.spreadChartEditState&&Kt._legacyWynbi.spreadChartEditState.pivotTableManager)&&(r=n.getPivotTableBySheet(t))?1===e.colCount&&1===e.rowCount?r.rangeToFormula(e.row,e.col):"":(i=t._formulaTextBox,l=(s=(a=x.G0.H0)&&a.kj||t).Jl,u=s.Kl,h=(c=t.parent)&&1===c.options.referenceStyle,f=15,(t._formulaTextBox&&t._formulaTextBox.Nfa||o)&&(f=0),e.row<0&&e.col<0&&(e=new w.Range(0,-1,t.getRowCount(),-1)),d=(p=t.tables)&&p.find(e.row,e.col),(a&&a.Nfa||o)&&(f=0),i&&!i._isSelectMode&&function(t,e){if(t){var o=!1,n=!1;if(1===e.rowCount){if(t.hasHeadersRow()&&e.row===t.startRow())return 1;if(t.hasTotalsRow()&&e.row===t.endRow())return 1}else t.hasHeadersRow()&&e.row===t.startRow()&&(e.rowCount===t.dataRange().rowCount+1&&(o=!0),t.hasTotalsRow()&&e.rowCount===t.dataRange().rowCount+1+1&&(o=!0)),e.row===t.dataRange().row&&(e.rowCount===t.dataRange().rowCount&&(o=!0),t.hasTotalsRow()&&e.rowCount===t.dataRange().rowCount+1&&(o=!0));return e.col+e.colCount<=t.startColumn()+t.dataRange().colCount&&(n=!0),o&&n}}(d,e)?(a&&a._text&&a.kj!==t&&(l=u=-1),y.rangeToFormulaWithStructReference(t,e,l,u,f,h,d)):(g=y.rangeToFormula(e,l,u,f,h),(a&&a._text||t._formulaTextBox&&t._formulaTextBox._isSelectMode&&t._formulaTextBox._needSheetName)&&(m=t.name(),g=(y.jma(m.split(""),!1)?m:"'"+m.replace(/'/g,"''")+"'")+"!"+g),g)):v},w.Events.FormulaTextBoxTextChanged="FormulaTextBoxTextChanged",w.Events.FormulaTextBoxCaretChanged="FormulaTextBoxCaretChanged",A.Yl.km.push(function(t,e){var o,n=x.G0;e||!t.endEdit||!n||(o=n.H0)&&o.I0&&t._formulaTextBox&&(t._formulaTextBox&&t._formulaTextBox.destroy(),t._formulaTextBox=v,o.$b())}),c._attachFormulaTextBox=B,c._detachFormulaTextBox=V,c._stringToRange=function(t,e){var o,n,r,i;if(!e)return v;r=(n=(o=x.G0.H0)&&o.kj||t).Jl,i=n.Kl;try{return y.formulaToRange(t,e,r,i)}catch(t){}return v},o(w.DC.prototype,{bE:function(t){return!(t&&t._formulaTextBox&&t._formulaTextBox.M0())}}),w.Worksheet.$n(r,{startEdit:function(t){B(this,t.element)},endEdit:function(){V(this)}}),_=w.DC.prototype,O=_.dE,w.DC.$n(r,{preProcessMouseDbClick:function(t){var e=w.sJc(this.OC),o=e?e._formulaTextBox:void 0,n=o&&o.M0(),r=x.G0.H0;n?t.r=!1:r&&r.I0&&r.$b()}}),_.dE=function(){var t=w.sJc(this.OC),e=t&&t._formulaTextBox,o=x.G0.H0,n=o&&o._text;return O.call(this)&&!n&&!e},F=1,W.prototype.j5=function(t){var e,o,n,r,i,a,s=this;s._startingEdit(),s._startEdit(),s.E5=!0,e=x._createEditorElement(s.OC._host),(o=s.a1())&&(o.suspendPaint(),B(o,e,!0),(n=o._formulaTextBox)._isSelectMode=!0,n.C5=s.C5,n.Nfa=s.Nfa,n._needSheetName=s._needSheetName,t&&(s.text(t),s.caret(t.length)),r=s.text(),(i=s.caret())<=0&&(i=r.length),s.focus(),s.caret(i),s.MH=!0,-(s.W0=1)!==(a=r.lastIndexOf(",",i))&&(s.W0=a+1),r||(s.text("="),r="=",s.caret(1),i=1),0!==r.indexOf("=")&&(r="="+r,i++),n.text(r),n.caret(i),n.MH=s.MH,n.W0=s.W0,o.resumePaint())},W.prototype.startSelectMode=function(t){var e=t;e&&0!==e.indexOf("=")&&(e="="+e),this._isSelectMode=!0,this.D5=!0,w.GC$(this.sia).css([l,E],['url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+U1BKUyBBbm90aGVyLVNlbGVjdGluZzwvdGl0bGU+CiAgICA8ZyBpZD0iU1BKUy1Bbm90aGVyLVNlbGVjdGluZyIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IlN3aXRjaC1yb3cvY29sdW1uIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgMS4wMDAwMDApIj4KICAgICAgICAgICAgPHJlY3QgaWQ9IlJlY3RhbmdsZS04IiBmaWxsPSIjRDVENUQ1IiB4PSIwIiB5PSIwIiB3aWR0aD0iMTYiIGhlaWdodD0iMTMiPjwvcmVjdD4KICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgZmlsbD0iI0ZGRkZGRiIgeD0iMyIgeT0iNSIgd2lkdGg9IjEwIiBoZWlnaHQ9IjQiPjwvcmVjdD4KICAgICAgICAgICAgPHBhdGggZD0iTTMsNSBMMTMsNSBMMTMsOSBMMyw5IEwzLDUgWiBNNCw2IEw0LDggTDEyLDggTDEyLDYgTDQsNiBaIiBpZD0i55+p5b2iIiBmaWxsPSIjNjY2NjY2IiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICAgICAgPHBhdGggZD0iTTAsMCBMMTYsMCBMMTYsMTMgTDAsMTMgTDAsMCBaIE0xLDEgTDEsMTIgTDE1LDEyIEwxNSwxIEwxLDEgWiIgaWQ9IuefqeW9oiIgZmlsbD0iIzY2NjY2NiIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICAgICAgICAgIDxnIGlkPSLnvJbnu4QtOCI+CiAgICAgICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjODFCRUZDIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTQiIGhlaWdodD0iMiI+PC9yZWN0PgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTE2LDAgTDE2LDQgTDAsNCBMMCwwIEwxNiwwIFogTTE1LDEgTDEsMSBMMSwzIEwxNSwzIEwxNSwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiMzNjdGQzkiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPgogICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDxnIGlkPSLnvJbnu4QtOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMi41ODc3NjcsIDYuMDAwMDAwKSIgZmlsbC1ydWxlPSJub256ZXJvIj4KICAgICAgICAgICAgICAgIDxwb2x5Z29uIGlkPSJTaGFwZSIgZmlsbD0iI0ZBNzU0MSIgcG9pbnRzPSI1LjQxMjIzMjg1IDcgMi40MTIyMzI4NSAzLjk5NTM1Mjk1IDQuNDEyMjMyODUgMy45OTUzNTI5NSA0LjQxMjIzMjg1IDEgNi40MTIyMzI4NSAxIDYuNDEyMjMyODUgMy45OTUzNTI5NSA4LjQxNDAzOTk4IDMuOTk1MzUyOTUiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMC44MjY2NDAyLDIuOTk1MzUyOTUgTDUuNDEyMDE5ODEsOC40MTUwOTU5NCBMMC4wMDA2NTkxMTExNjIsMi45OTUzNTI5NSBMMy40MTIyMzI4NSwyLjk5NTM1Mjk1IEwzLjQxMjIzMjg1LDAgTDcuNDEyMjMyODUsMCBMNy40MTIyMzI4NSwyLjk5NTM1Mjk1IEwxMC44MjY2NDAyLDIuOTk1MzUyOTUgWiBNNS40MTIyMzI4NSw3IEw4LjQxNDAzOTk4LDMuOTk1MzUyOTUgTDYuNDEyMjMyODUsMy45OTUzNTI5NSBMNi40MTIyMzI4NSwxIEw0LjQxMjIzMjg1LDEgTDQuNDEyMjMyODUsMy45OTUzNTI5NSBMMi40MTIyMzI4NSwzLjk5NTM1Mjk1IEw1LjQxMjIzMjg1LDcgWiIgaWQ9IlNoYXBlIiBmaWxsPSIjRkZGRkZGIj48L3BhdGg+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==")',"no-repeat"]),this.j5(e)},W.prototype.endSelectMode=function(){this.D5=!1,this.H5(),w.GC$(this.sia).css([l,E],[k,"no-repeat"])},W.prototype.H5=function(){var t=this.a1();t&&(t._endEditImp(!0,void 0,!0),t.repaint())},W.prototype.rgc=function(t){this._gc=[t]},W.prototype.ahc=function(){return this._gc},W.prototype.destroy=function(){var t=this;t.D5&&t.H5(),t._gc=v,t.MH=!1,t.W0=-1,t.X0(),t.Y0(),w.GC$(t._funcsPopup).remove(),w.GC$(t.$0).remove(),w.GC$(t._0).remove()},W.prototype.bind=function(t,e,o){var n=this._host;n&&t&&(t=t.split(/\s+/).join(s+" "),w.GC$(n).bind(t+s,e,o))},W.prototype.unbind=function(t,e){var o=this._host;o&&t&&(t=t.split(/\s+/).join(s+" "),w.GC$(o).unbind(t+s,e))},W.prototype.unbindAll=function(){var t=this._host;t&&w.GC$(t).unbind(s)},W.prototype.caret=function(t){var e,o,n=this._host;if(n)return e=S.activeElement===n,o=w.GC$(n),0===arguments.length?e?this.b1(n).end:o.data(j):void(t!==this.caret()&&(e?(this.c1(n,t),o.data(j,this.b1(n).end)):o.data(j,t),this.Wq(m,{})))},W.prototype.b1=function(t){var e,o,n,r=-1,i=-1;return this.d1(t)?(r=t.selectionStart,i=t.selectionEnd):this.Cia(t)&&0<(e=A.getSelection()).rangeCount&&((n=(o=e.getRangeAt(0)).cloneRange()).selectNodeContents(t),n.setEnd(o.endContainer,o.endOffset),i=(""+n).length,(n=o.cloneRange()).selectNodeContents(t),n.setEnd(o.startContainer,o.startOffset),r=(""+n).length,n.detach()),{start:r,end:i}},W.prototype.c1=function(t,e){var o,n,r,i;this.d1(t)?t.setSelectionRange(e,e):!this.Cia(t)||(r=this.e1(t,e))&&(o=A.getSelection(),n=S.createRange(),(i=r.node)&&1===i.childNodes.length?n.setStart(i.firstChild,r.offset):i.lastChild&&i.lastChild.length&&n.setStart(i.lastChild,i.lastChild.length),n.collapse(!0),o.removeAllRanges(),o.addRange(n),this._isSelectMode&&(t.parentElement.scrollTop=t.parentElement.scrollHeight))},W.prototype.text=function(t){var e,o,n,r,i,a,s,l=this,u=l._host,c=l.a1();if(!u||!c||c.Js)return"";if(e=l.d1(u),o=l.Cia(u),0===arguments.length){if(n="",e)n=u.value;else if(o){if(0<u.getElementsByClassName("gcsj-func-gray-formula").length)return"";0<=(n=(n=h?w.Ul.Woa(u):u.innerText).replace(/\r\n?/g,"\n")).indexOf(" ")&&(n=w.Ul.Ika(n," "," "))}return n}null!=t||(t=""),t!==l.text()&&(r=l.mLb(t),l._tokens=r?l.T0(r):l.T0(t),e?u.value=t:o&&(i=l.nLb(l._tokens,t),l.V0(i),l.caret(t.length)),a={},(s=x.G0.H0)&&s._text&&(a={sheet:s.kj,editor:s.I0&&s.I0.firstChild.firstChild,canvasOffset:s.f1}),l.Wq(N,a)),l.oLb&&l.pLb()},W.prototype.BXc=function(){w.GC$(this._host).data(D,this.text())},W.prototype.autoComplete=function(t){return 0===arguments.length?this.g1:void(this.g1=t)},W.prototype.showHelp=function(t){return 0===arguments.length?this.h1:void(this.h1=t)},W.prototype.add=function(t){var e,o;if(t)if(w.GC$.isArray(t))for(e=t.length,o=0;o<e;o++)this.Sb(t[o]);else this.Sb(t)},W.prototype.Sb=function(t){var e,o,n,r,i=t&&g(H(t.name));if(i){for(o=(e=this.i1).length,n=0;n<o;n++){if((r=g(e[n].name))===i)return;if(i<r)break}e.splice(n,0,t)}},W.prototype.remove=function(t){var e,o,n;if(t)for(t=g(t),o=(e=this.i1).length,n=0;n<o;n++)if(g(e[n].name)===t){e.splice(n,1);break}},W.prototype.workbook=function(t){return 0===arguments.length?this.OC:void(t===v?this._isSelectMode&&this.H5():(this.P0(t),this.j1()))},W.prototype.P0=function(t){t&&(this.OC&&this.Y0(),this._host&&(this.OC=t))},W.prototype.l1=function(){var t,e,o,n,r=[],i=this._tokens,a=i&&i.length,s=0,l=0;if(0<a)for(o=0;o<a;o++)e=(t=i[o]).text,11===t.type&&(r.push({textOffset:s,text:e,ranges:t.ranges,index:l,allowDrag:t.allowDrag}),l++),s+=e.length;return(n=this.uMc)&&r.push({ranges:[n],index:l,allowDrag:!1,isPivotClickCell:!0}),r},W.prototype.m1=function(){var t,e,o,n,r,i=this._host,a=this.l1();if(i&&a&&0<a.length)for(t=this.caret(),e=a.length,n=o=void 0,r=0;r<e;r++){if((n=(o=a[r]).textOffset)<t&&t<=n+o.text.length)return o;if(t<=n)break}return v},W.prototype.n1=function(t){var e,o,n;return!!t&&(e=this.caret(),o=t.text,(n=t.textOffset)<e&&e<=n+o.length)},W.prototype.o1=function(t){var e,o,n,r,i,a,s,l=this.l1(),u=l.length;if(t<0||u<=t)return"";for(e=[],r=n=0;r<u;r++){for(o=l[r],i=!1,a=0;a<e.length;a++)if(o.text&&e[a].text.replace(/\s+/g,"").toUpperCase()===o.text.replace(/\s+/g,"").toUpperCase()){i=!0;break}if(i){if(t===r){n=a;break}}else if(e.push(o),t===r){n=e.length-1;break}}return(s=c.DEFAULT_RANGE_COLORS)[n%s.length]},W.prototype.M0=function(){var t,e,o;return!!this.MH||!!this._isSelectMode||!!(t=this.s1(this.caret()))&&(e=t.type,o=t.text,1===e||8===e||7===e&&"%"!==o||5===e||9===e||15===e)},W.prototype.t1=function(t){if(!t||!this.MH)return!1;var e=this.W0,o=this.caret(),n=t.textOffset;return e<=n&&n<o},W.prototype.u1=function(){var t,e,o=[],n=this.l1(),r=n.length;if(0<r)for(e=0;e<r;e++)t=n[e],this.t1(t)&&o.push(t);return o},W.prototype._appendRange=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g=this,m=g._host;if(t&&m){if(!g.MH){if(!g.M0())return;e=!1,g.MH=!0,g.W0=g.caret(),g.Wq("AppendStarted",{})}r=g.W0,i=g.text(),a=g.caret(),i||(i="=",r=g.W0=1,a=1),s=a,o&&(e=!1,i=i.substr(0,r)+(a<0?"":i.substr(a)),g._tokens=g.T0(i),s=a=r),l=g.s1(a),e?(u=(u=i.substr(0,a)).substr(0,u.length-l.text.length)).length>=r&&(l.text=t,s=u.length+t.length):(c=g._tokens,h=b.Common.k.Cb(c,l),f=g._isSelectMode&&1<c.length&&h===c.length-1&&11===l.type,n?(t=r<a||f?i+this.w1()+t:i.slice(0,a)+t+i.slice(a),g._tokens=g.T0(t)):r<a||f?(c.splice(h+1,0,{text:this.w1(),type:8}),c.splice(h+2,0,{text:t,type:11}),t=","+t):c.splice(h+1,0,{text:t,type:11}),s=a+t.length),g.z1(),p={},(d=x.G0.H0)&&d._text&&(p={sheet:d.kj,editor:d.I0&&d.I0.firstChild.firstChild,canvasOffset:d.f1}),g.Wq(N,p),g.caret(s)}},W.prototype._stopAppending=function(){this.MH&&(this.MH=!1,this.W0=-1,this.Wq("AppendEnded",{}))},W.prototype.B1=function(){this.MH=!0,this.W0=this.caret()},W.prototype.C1=function(t){return void 0!==t&&(this.W0=t),this.W0},W.prototype._repalceRange=function(t,e,o){var n,r,i,a,s,l,u;if(this._host&&!(t<0)&&e){for(n="",r=!1,a=(i=this._tokens)&&i.length,u=l=0;u<a;u++){if(11===(s=i[u]).type&&l++===t){i[u]={text:e,type:11},r=!0;break}n+=s.text}r&&(this.z1(),this.Wq(N,{}),o?this.caret(this.text().length):this.caret(n.length+e.length))}},W.prototype.j1=function(){var t,e,o=this;o.OC&&(t=o._host,o.OC&&t&&(t.setAttribute(i,"gcAttachedFormulaTextBox"),o._isSelectMode||(o.OC.CF=o),o.OC._bind(w.Events.FormulatextboxEditStarted,o,o.E1),o.OC._bind(w.Events.FormulatextboxEnterCell,o,o.F1),o.OC._bind(w.Events.FormulatextboxEditEnded,o,o.G1),o.OC._bind(w.Events.FormulatextboxActiveSheetChanged,o,o.H1),o.OC._bind(w.Events.FormulatextboxRangeChanged,o,o.I1),o.OC._bind(w.Events.FormulaTextBoxTextChanged,o,o.J1),o.OC._bind(w.Events.FormulaTextBoxCaretChanged,o,o.K1),o.OC._bind(w.Events.ValueChanged,o,o.qLb),(e=w.sJc(o.OC))&&!o._isSelectMode&&o.text(o._getEditText(e,e.Jl,e.Kl)),o._bind(N,o,o.M1),o._bind(m,o,o.N1)))},W.prototype.refresh=function(t){var e,o=this.OC;!o||(e=w.sJc(o))&&!this._isSelectMode&&(this._isWorking=!!t||this._isWorking,this.text(this._getEditText(e,e.Jl,e.Kl)),this._isWorking=!1)},W.prototype.Y0=function(){var t=this,e=t.OC;!t.O0&&e&&(t._isSelectMode||(e.CF=null,e._unbind(w.Events.FormulatextboxEditStarted,t.E1),e._unbind(w.Events.FormulatextboxEnterCell,t.F1),e._unbind(w.Events.FormulatextboxEditEnded,t.G1),e._unbind(w.Events.FormulatextboxActiveSheetChanged,t.H1),e._unbind(w.Events.FormulatextboxRangeChanged,t.I1),e._unbind(w.Events.FormulaTextBoxTextChanged,t.J1),e._unbind(w.Events.FormulaTextBoxCaretChanged,t.K1),e._unbind(w.Events.ValueChanged,t.qLb),t._unbind(N,t.M1),t._unbind(m,t.N1)),t.text("")),t.OC=null},W.prototype._startingEdit=function(){var t,e;this._isWorking||(this._isWorking=!0,(e=(t=this.OC)&&w.sJc(t))&&!e.isEditing()?(this._isSelectMode||e.EF(null,e.Jl,e.Kl,null,null,!1,null),this.Q1=!0):this.Q1=!1,this._isWorking=!1,this._isFuncsShown||this._openFuncHelp())},W.prototype.rLb=function(){var t=this._host,e=this.sLb;t.insertBefore(e,t.firstChild),e.innerText=this.oLb},W.prototype.tLb=function(t,e){t&&this.uLb!==e&&(this.uLb=e,t.style.display=e?"":"none")},W.prototype.pLb=function(){var t,e=this._host;this.Cia(e)?((t=this.sLb)||((t=this.sLb=T("span")).className="gcsj-func-gray-formula"),this.tLb(t,!0),this.rLb()):e.placeholder=this.oLb},W.prototype.vLb=function(){var t;this.oLb&&(this.oLb="",t=this._host,this.Cia(t)?this.tLb(this.sLb,!1):t&&(t.placeholder=""))},W.prototype._startEdit=function(){var t,e,o,n,r,i,a=this.OC,s=a&&w.sJc(a);s&&(t=s._formulaTextBox,this.Q1&&t&&(e=t.text(),(o=this.text())!==e&&(n=this.caret(),r=s.getFormulaInformation(s.getActiveRowIndex(),s.getActiveColumnIndex()),this.text(e),r.isArrayFormula&&(n>=o.length&&--n,n=u(0,n-1)),this.caret(n))),!(this.Q1&&t||this._isSelectMode)||2!==(i=s._editorStatus)&&(s._editorStatus=2,s._raiseEditorStatusChanged(i,2)))},W.prototype._getEditText=function(t,e,o){var n,r,i,a,s,l="";if(t){if(r=(n=t.parent)&&n.options,(i=t.getFormulaInformation(e,o))&&i.hasFormula){if(l="="+i.formulaWithCulture,i.isDynamicArray)return this.oLb=l,"";this.oLb="",i.isArrayFormula&&(l="{"+l+"}")}else a=t.getActualStyle(e,o),l="string"==typeof(s=t.getValue(e,o))&&a.quotePrefix||0<l.length&&"="===l[0]&&r&&r.allowUserEditFormula?"'"+s:w.Ul.Il(a,s,t)||"";this.vLb()}return l},W.prototype.H1=function(t,e){var o,n=t.data;n._isWorking||(o=e.newSheet,n._isSelectMode||(n._isWorking=!0,n.close(),e&&n.text(n._getEditText(o,o.Jl,o.Kl)),n._isWorking=!1))},W.prototype.E1=function(t){var e,o,n,r=t.data;r._isWorking||(n=(o=(e=r.OC)&&w.sJc(e))&&o._formulaTextBox)&&r._isSelectMode===n._isSelectMode&&r.C5===n.C5&&(r.vLb(),r._isWorking=!0,r.text(n.text()),r._isWorking=!1)},W.prototype.F1=function(t,e){var o=t.data;o._isSelectMode||o._isWorking||(o._isWorking=!0,e&&o.text(o._getEditText(e.sheet,e.row,e.col)),o._isWorking=!1)},W.prototype.I1=function(t,e){var o,n,r,i,a,s=t.data;s._isWorking||s._isSelectMode||(s._isWorking=!0,e&&(o=e.sheet,n=e.row,r=e.col,i=e.rowCount,a=e.colCount,new w.Range(n,r,i,a).contains(o.Jl,o.Kl)&&s.text(s._getEditText(o,o.Jl,o.Kl))),s._isWorking=!1)},W.prototype.G1=function(t,e){var o=t.data;return o._isSelectMode&&o.D5&&o.E5?void(e.ignore=!0):void(o._isWorking||(o._isWorking=!0,o.close(),e&&e.sheet._formulaTextBox&&!e.sheet._formulaTextBox._isSelectMode&&!o._isSelectMode&&o.text(o._getEditText(e.sheet,e.row,e.col)),o._isWorking=!1))},W.prototype.qLb=function(t,e){var o=e.sheet,n=o&&o.parent&&o.parent.CF;n&&n.e2()===e.row&&n.f2()===e.col&&n.a1()===o&&t.data instanceof W&&(e.text=o.getText(e.row,e.col),t.data.J1(t,e))},W.prototype.J1=function(t,e){var o,n=t.data;n._isWorking||e.sheet._formulaTextBox&&(n._isSelectMode!==e.sheet._formulaTextBox._isSelectMode||n.C5!==e.sheet._formulaTextBox.C5)||(n._isWorking=!0,e&&(o=n.caret(),n.text(e.text),n.caret(o)),n._isWorking=!1)},W.prototype.K1=function(t,e){var o=t.data;o._isWorking||e.sheet._formulaTextBox&&(o._isSelectMode!==e.sheet._formulaTextBox._isSelectMode||o.C5!==e.sheet._formulaTextBox.C5)||(o._isWorking=!0,e&&o.caret(e.caret),o._isWorking=!1)},W.prototype.M1=function(t){var e,o,n,r,i,a,s,l,u=t.data;if(!u._isWorking&&(o=(e=u.OC)&&w.sJc(e))){if(o.isEditing()||(u._startingEdit(),u.focus()),u._isWorking=!0,n=o.Jl,r=o.Kl,i=o._formulaTextBox,a=o.getCellType(n,r),i){if(u._isSelectMode!==i._isSelectMode||u.C5!==i.C5)return;s=i.caret(),i.text(u.text()),i.caret(s)}else l={sheet:o,row:n,col:r,sheetArea:3},a.setEditorValue(o._editor,u.text(),l);u._isWorking=!1}},W.prototype.N1=function(t){var e,o,n,r=t.data;r._isWorking||(o=(e=r.OC)&&w.sJc(e))&&o.isEditing()&&((n=o._formulaTextBox)&&(r._isSelectMode!==n._isSelectMode||r.C5!==n.C5)||(r._isWorking=!0,n&&(n.caret(r.caret()),r._openFuncHelp()),r._isWorking=!1))},W.prototype.ad=function(t){var e,o,n,r=this;r.T1=!1,r.U1=!1,r.MH=!1,r.W0=-1,r.i1=[],r.g1=!0,r.h1=!0,r.V1=!0,(e=T("div")).className="gcsj-func-ac-popup",e.style.display="none",e.setAttribute(i,"gcFuncACPopup"),t.insertBefore(e,v),r._funcsPopup=e,r._isFuncsShown=!1,(o=T("div")).className="gcsj-func-help-popup",o.style.display="none",o.setAttribute(i,"gcFuncHelpPopup"),t.insertBefore(o,v),r.$0=o,r._isFuncHelpShown=!1,w.GC$(e).bind("mouseover",function(){r.V1=!1}).bind("mouseout",function(){r.V1=!0}),w.GC$(o).bind("mouseover",function(){r.V1=!1}).bind("mouseout",function(){r.V1=!0}),w.GC$(e).bind("scroll",function(){r.X1&&clearTimeout(r.X1),r.X1=A.setTimeout(function(){r._host&&r._host.focus()},100)}),(n=T("div")).style.display="none",n.setAttribute(i,"gcFuncHelpDiv"),t.insertBefore(n,v),r._0=n,r.OC=null,r._isWorking=!1,r.Q1=!1,r.O0=!1},W.prototype.N0=function(t){var m,y,e;t&&(y=(m=this).Cia(t),(m.d1(t)||y)&&(e=w.GC$(t),m._host&&m.X0(),m._host=t,n&&(n.msie||n.chrome)?y||h||n.chrome?(m._bind("focus",function(){e.data(D,m.text())}),m._bind("click",function(){e.focus()}),"input keydown keyup cut paste".split(" ").forEach(function(t){m._bind(t,function(){m.Y1()})})):m._bind(I,function(){m.Z1()}):m._bind(I,function(){if(y){var t=m._host.lastChild;n.chrome&&t&&"BR"===t.tagName&&m._host.removeChild(t)}m.Z1()}),m._bind("keydown",function(t){var e,o,n,r,i,a,s,l,u,c=t.ctrlKey,h=t.shiftKey,f=t.altKey,p=t.metaKey,d=c||h||f||p,g=t.keyCode;!d&&m._isFuncsShown&&(g===R.down?(m._1(1),M(t)):g===R.up?(m._1(-1),M(t)):g===R.tab&&(m._completeFunc(),M(t))),g===R.esc&&m.close(),m.b2(t),o=(e=w.sJc(m.OC))&&e._eventHandler.LH(t),m._isSelectMode&&o&&(n=e._formulaTextBox)&&n.MH&&n._stopAppending(),y&&(o?(8===g?G(t)&&w.uHb.processBackspaceAndLeftArrowKeyEvent(t,!0):46===g&&G(t)&&w.uHb.processDeleteAndRightArrowKeyEvent(t,!0),m.Jka()):13===g&&(c||f)?(!G(t)||0<(u=A.getSelection()).rangeCount&&(a=u.getRangeAt(0),(s=S.createElement("span")).innerHTML="<br/>​",a.insertNode(s),(l=S.createRange()).setStartAfter(s),l.setEndAfter(s),l.collapse(!1),u.removeAllRanges(),u.addRange(l)),m.Jka(!0)):37===g?G(t)&&w.uHb.processBackspaceAndLeftArrowKeyEvent(t,!1):39===g&&G(t)&&w.uHb.processDeleteAndRightArrowKeyEvent(t,!1),y&&c&&(90===g||89===g)&&M(t)),r=m.text(),w.Ul.sl()&&y&&p&&(i=void 0,90===g&&(h?(i=m.Bc.pop())&&(m.text(i),m.Ac.push(r)):(i=m.Ac.pop()||"",m.text(i),m.Bc.push(r)),t.preventDefault(),t.stopPropagation()))}),m._bind("keyup",function(t){var e,o,n,r;m.b2(t),e=m.text(),y&&(o=void 0,n=t.keyCode,(r=t.ctrlKey)&&90===n?(o=m.Ac.pop()||"",m.text(o),m.Bc.push(e)):!r||89!==n||(o=m.Bc.pop())&&(m.text(o),m.Ac.push(e)))}),m._bind("focus",function(t){n&&n.mozilla&&!m._host.innerText&&(m._host.innerText=""),m.b2(t),m._isSelectMode&&m.D5&&(m.E5=!0,m.j5())}),m._bind("blur",function(){m.V1&&m.close(),m._isSelectMode&&(m.H5(),m.E5=!1)}),m._bind("mousedown",function(){m.E5=!0,m.uLb&&(m.vLb(),m.wLb=!0),m._startingEdit()}),m._bind("mouseup",function(){if(m.wLb){m.wLb=!1;var t=m._host,e=A.getSelection();t!==e.anchorNode&&e.selectAllChildren(t)}m._startEdit()}),m._bind("click",function(t){var e,o,n;m.MH&&m._stopAppending(),(n=(o=(e=m.OC)&&w.sJc(e))&&o._formulaTextBox)&&n.MH&&!n._isSelectMode&&n._stopAppending(),m.b2(t)}),m._bind("compositionstart",function(){m.T1=!0}),m._bind("compositionend",function(){m.T1=!1,(n.edge||n.chrome)&&m.Y1()})))},W.prototype.X0=function(){var t,e=this._host;e&&((t=w.GC$(e)).removeData(D),t.removeData(j),t.removeAttr(i),this.nu(),this.unbindAll(),this._isSelectMode&&(w.GC$(this.cga).empty(),this.cga=v),this._host=v)},W.prototype.Y1=function(){var t=w.GC$(this._host),e=this.text();t.data(D)!==e&&(this.T1||t.data(D,e),this.Z1())},W.prototype.b2=function(t){var e,o;n&&n.msie?setTimeout((e=this,o=t,function(){e.d2(e,o)}),10):this.d2(this,t)},W.prototype.d2=function(t,e){var o,n,r,i,a,s=e.keyCode,l=s===R.left||s===R.right||s===R.home||s===R.end||s===R.pdn||s===R.pup||s===R.tab||s===R.enter;if(t.g1||(l=l||s===R.up||s===R.down),o=void 0!==e.button,l||o){if(n=t._host,r=w.GC$(n),(i=t.b1(n)).start!==i.end)return;a=i.end,r.data(j)!==a&&(r.data(j,a),t.Wq(m,{}),t._openFuncHelp())}},W.prototype.e2=function(){var t=this.a1();return t?t.Jl:void 0},W.prototype.f2=function(){var t=this.a1();return t?t.Kl:void 0},W.prototype.a1=function(){if(this.OC)return w.sJc(this.OC)},W.prototype.parseInternal=function(t,e,o,n){var r,i,a=[];return t&&"="===t[0]&&function(t,e){var o,n=0;for(o=0;o<t.length;o++)t[o]===e&&n++;return n}(t,'"')%2!=1?(r=new p.Parser,i=y.qzb(r,t,e,o,n,!0),a=this.i2(i)):(a.push({text:t,type:17}),a)},W.prototype.T0=function(t){return this.parseInternal(t,this.a1(),this.e2(),this.f2())},W.prototype.Z1=function(){var t,e,o,n=this,r=n.text();return"\n"!==r&&0<=r.indexOf("\n")?void n.Wq(N,{type:I}):(t=n._host,e=w.GC$(t),n.U1=!0,n._tokens=n.T0(r),n.Cia(t)?n.T1||("\n"===r?(e.empty(),n.Wq(N,{type:I})):(o=n.caret(),n.V0(n._tokens),n.Wq(N,{type:I}),n.caret(o))):n.Wq(N,{type:I}),o=n.caret(),e.data(j)!==o&&(e.data(j,o),n.Wq(m,{})),n._openFuncs(),void(n._isFuncsShown||n._openFuncHelp()))},W.prototype.j2=function(){return b.Common.CultureManager.q4().NumberFormat},W.prototype.h2=function(){var t=this.j2();return t&&t.arrayGroupSeperator||";"},W.prototype.l2=function(){var t=this.j2();return t&&t.arrayListSeparator||","},W.prototype.w1=function(){var t=this.j2();return t&&t.listSeparator||","},W.prototype.g2=function(){var t=this.j2();return t&&t.numberDecimalSeparator||"."},W.prototype.i2=function(t){var e,o,n,r,i=[],a=[],s=this.h2(),l=this.l2(),u=!1;for(e=0;e<t.length;e++)0<e&&e<t.length-1&&";"===t[e-1].text&&","===t[e].text&&"ARRAYROW"===t[e+1].text||(o=t[e],n=this.m2(o,a),r=o.text,2===n?i.push({text:r,type:n}):u&&8===n&&","===r?i.push({text:l,type:9}):u&&8===n&&";"===r?i.push({text:s,type:10}):8===n?i.push({text:r,type:n}):3===n?("ARRAY"===r&&(u=!0),i.push({text:"{",type:3})):4===n?"ARRAY"===r?(u=!1,i.push({text:"}",type:4})):i.push({text:r,type:4}):6===n?i.push({text:")",type:n}):13===n?i.push({text:b.Common.o.nb(r),type:n,ranges:o.ranges,allowDrag:o.canDrag}):null!==n&&i.push({text:r,type:n,ranges:o.ranges,allowDrag:o.canDrag}));return i},W.prototype.m2=function(t,e){var o,n=t.type,r=t.subType,i=t.text,a=t.value;if(1===n){if(1===r)return"ARRAY"===i||"ARRAYROW"===i?(e.push(3),3):(e.push(5),"@"===a||"("===a.trim()?5:2);if(2===r){if(")"===a.trim())return 6;if(0<e.length){if(3===(o=e[e.length-1]))return e.pop(),4;if(5===o)return e.pop(),6}}if("="===a.trim())return 1}else if(3===n){if(0===r)return 8}else{if(5===n||6===n||4===n)return 7;if(0===n)return 7===r||0===r?11:5===r?12:4===r?13:3!==r&&6===r?16:14;if(7===n)return 15;if(8===n)return 17}return 17},W.prototype.z1=function(){var t,e=this._host,o=this._tokens,n="",r=o&&o.length;for(t=0;t<r;t++)n+=o[t].text;this.d1(e)?e.value=n:this.Cia(e)&&this.V0(o)},W.prototype.d1=function(t){var e=t&&t.tagName;return"TEXTAREA"===e||"INPUT"===e},W.prototype.Cia=function(t){return t&&"DIV"===t.tagName&&"true"===t.contentEditable},W.prototype.Dia=function(t){return"gcEditingInput"===w.GC$(t).attr(i)},W.prototype.bW=function(t){return t&&"="===t[0]},W.prototype._bind=function(t,e,o){var n=this._host;n&&t&&(t=t.split(/\s+/).join(a+" "),w.GC$(n).bind(t+a,e,o))},W.prototype._unbind=function(t,e){var o=this._host;o&&t&&(t=t.split(/\s+/).join(a+" "),w.GC$(o).unbind(t+a,e))},W.prototype.nu=function(){var t=this._host;t&&w.GC$(t).unbind(a)},W.prototype.Wq=function(t,e){var o=this._host;o&&w.GC$(o).trigger(t,e)},W.prototype.s1=function(t){var e,o,n,r,i;if(t<=0)return v;if(0<(o=(e=this._tokens)&&e.length))for(r=void(n=0),i=0;i<o;i++)if(t<=(n+=(r=e[i]).text.length))return r;return v},W.prototype.n2=function(){var t,e,o,n,r,i=this.OC;if(i&&(t=w.sJc(i))&&(e=t.getCalcService().allowDynamicArray,o=t._formulaTextBox)){for(r=(n=[].concat(o.i1)).length-1;0<=r;r--)!e&&n[r]&&z(n[r].name)?n.splice(r,1):n[r].isFunc=!0;return n.concat(this.o2(i,t)).concat(this.q2(i.sheets)).concat(this.wMc(i))}return this.i1},W.prototype.o2=function(t,e){var o,n=[],r=e.getCustomNames();return r&&w.GC$.each(r,function(t,e){n.push({name:e.Cj,description:e.kT})}),(o=t.getCustomNames())&&w.GC$.each(o,function(t,e){n.push({name:e.Cj,description:e.kT})}),n},W.prototype.q2=function(t){var r=[];return t.forEach(function(t){var e,o,n=t.tables;if(n&&(e=n.all()))for(o=0;o<e.length;o++)r.push({name:e[o].name(),description:p.sR().Fbx_TableName_Description+e[o].name()})}),r},W.prototype.wMc=function(t){var e,o=[],n=t.pJc;for(e=0;e<n.length;e++)o.push({name:n[e].name(),description:p.sR().Fbx_TableSheetName_Description+n[e].name()});return o},W.prototype.s2=function(t,e){var o,n,r,i;for(t=g(t),C.Bb(t,"[")&&(t=t.substr(t.lastIndexOf("[")+1),t=C.Gb(t,"@","")),o=[],n=e&&e.length,i=0;i<n;i++)r=e[i],0===g(H(r.name)).indexOf(t)&&o.push(r);return o},W.prototype.t2=function(){var t,e,o,n,r,i=this.caret();if(i<=0)return"";if(0<(e=(t=this._tokens)&&t.length))for(n=void(o=0),r=0;r<e;r++){if(o+(n=t[r]).text.length>=i)return n.text.substring(0,i-o);o+=n.text.length}return""},W.prototype.u2=function(){var t,e,o,n,r,i,a,s,l,u=this.caret(),c=this._tokens,h=c&&c.length,f=[],p=0;for(e=0;e<h;e++){if(t=c[e],f.push(t),6===t.type)for(o=0;0<f.length;)if(6===(n=f.pop()).type&&o++,5===n.type&&o--,0===o){0<f.length&&(n=f[f.length-1])&&2===n.type&&f.pop();break}if(u<=(p+=t.text.length))break}if(0<f.length)for(r=0;0<f.length;)if(8===(t=f.pop()).type)r++;else if(2===t.type){for(i=g(t.text),s=(a=this.n2())&&a.length,l=void 0,e=0;e<s;e++)if(l=a[e],g(H(l.name))===i)return{func:l,activeParamterIndex:r,isFunc:l.isFunc};break}return v},W.prototype._openFuncs=function(){var t,e,o,n,r,i,a,s,l=this,u=l.v2();if(l.g1&&l.bW(l.text())&&u&&0<u.length&&!l.MH&&!l.T1&&!l._isSelectMode){for(l._closeFuncHelp(),t=l._funcsPopup,8<u.length?(t.style.height="204px",t.style.overflowY="scroll"):(t.style.height="auto",t.style.overflowY=""),e="",o=u.length,n=void 0,r=0;r<o;r++)e+="<div class='gcsj-func-ac-row'><div class='gcsj-func-ac-row-name' isFunc="+(n=u[r]).isFunc+">"+H(n.name)+"</div><div class='gcsj-func-ac-row-description'>"+(n.description||"")+"</div></div>";(i=w.GC$(l._funcsPopup)).html(e).show(),l._isFuncsShown=!0,0<(a=i.find(".gcsj-func-ac-row")).length&&(s="gcsj-ac-row-active",w.GC$(a[0]).addClass(s),a.bind("mouseover",function(){a.removeClass(s),w.GC$(this).addClass(s)}),a.bind("click",function(){l._completeFunc()})),l._position()}else l._closeFuncs()},W.prototype.v2=function(){var t,e,o,n,r,i,a,s=this.s1(this.caret()),l=s&&s.text,u=[],c=this._tokens.indexOf(s);if(s&&14===s.type)return u;if(0<(t=this.A2(c)).length){for(r in e=JSON.parse(JSON.stringify(p.sR().B2)),o=p.getMapping()&&p.getMapping().tableFunctionsMapping,n=[],e)(i=o&&o[e[r].name])&&(e[r].name=i),n.push(e[r]);if(u=u.concat(t).concat(n),C.jb(l,"[")||C.jb(l,"[@"))return u}else u=this.n2();return a=[],(l=this.t2())&&(a=this.s2(l,u)),a},W.prototype.A2=function(t){var e,o,n,r,i,a,s,l,u=[],c=this._tokens,h=c&&c.length;if(t<0||t>=c.length)return u;if(o=(e=this.OC)&&w.sJc(e),n={},void 0!==t&&t!==v||(t=h),o&&(r=c[t],a=(i=o.tables)&&i.findByName(C.Ib(r.text,"[")),f(a)&&(a=e.getSheetTab(C.Ib(r.text,"["))),void 0!==a&&a!==v&&!n[a])){for(n[a]=!0,s=0,l="";l!==v;)l=a.getColumnName(s),s++,l!==v&&u.push({name:l,description:""});if(0<u.length)return u}return u},W.prototype._closeFuncs=function(){w.GC$(this._funcsPopup).hide(),this._isFuncsShown=!1},W.prototype._1=function(t){var e,o,n,r,i,a,s=w.GC$(this._funcsPopup).find(".gcsj-func-ac-row"),l=s.length;if(0!==l){if(e="gcsj-ac-row-active",o=0,t)for(n=0;n<l;n++)if(w.GC$(s[n]).hasClass(e)){o=n+t;break}r=w.GC$(this._funcsPopup).scrollTop(),s.removeClass(e),(i=0)<l&&(i=s[0].offsetHeight),o=u(o,0),a=s[o=d(o,l-1)],w.GC$(a).addClass(e),a.offsetTop+a.offsetHeight>w.GC$(this._funcsPopup).scrollTop()+w.GC$(this._funcsPopup).height()?w.GC$(this._funcsPopup).scrollTop(w.GC$(this._funcsPopup).scrollTop()+i):a.offsetTop<w.GC$(this._funcsPopup).scrollTop()?w.GC$(this._funcsPopup).scrollTop(a.offsetTop):w.GC$(this._funcsPopup).scrollTop(r)}},W.prototype._completeFunc=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g=this,m=w.GC$(g._funcsPopup).find(".gcsj-ac-row-active .gcsj-func-ac-row-name"),y=m.text(),b="true"===m.attr("isFunc");if(y){for(t=g.caret(),o=(e=g._tokens)&&e.length,i=r=n=0,a=v;i<o&&!(t<=n+(r=(a=e[i]).text.length));)i++,n+=r;s=t-n,l=a.text,c=u=0,C.Bb(l,"[")?-1===(u=l.lastIndexOf("[",s-1))?(u=l.indexOf("["),a.text=-1===u?y:y+l.substr(u),u=0):(u++,"@"===l.charAt(u)&&(u+=1),-1===(c=l.indexOf("]",s))&&(c=l.length),a.text=l.substring(0,u)+y+l.substr(c)):(a.text=y,(h=l.substr(s))&&1<(f=g.T0("="+h)).length&&e.splice(i+1,0,f[1])),a.type=b?2:11,d=e[p=i+1],!b||d&&5===d.type||e.splice(p,0,{text:"(",type:5}),g._closeFuncs(),g._host.focus(),g.z1(),g.caret(n+y.length+u+(b?1:0)),g._openFuncHelp(),g._tokens=g.T0(g.text()),g.Wq(N,{})}},W.prototype._openFuncHelp=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f=this;if(f._isFuncsShown&&f._closeFuncs(),(t=f.u2())!==v&&!0===t.isFunc)if(e=f.w1(),f.h1&&f.bW(f.text())&&t&&!f.MH&&!f.T1&&!f._isSelectMode){for(r=(n=(o=t.func).parameters)&&n.length,i=d(r-1,t.activeParamterIndex),a=void 0,s="",l=0;l<r;l++)u=(a=n[l]).name,a.repeatable&&(u+=e+"..."),a.optional&&(u="["+u+"]"),c=l===r-1?"":e+" ",s+=u=l===i?"<span class='gcsj-func-help-paramter gcsj-func-help-paramter-active'>"+u+"</span>"+c:"<span class='gcsj-func-help-paramter'>"+u+"</span>"+c;h="<div class='gcsj-func-help-title'><div class='gcsj-func-help-formula'><span class='gcsj-func-help-formula-name'>"+H(o.name)+"</span><span class='gcsj-func-help-paramter-paren'>(</span>"+s+"<span class='gcsj-func-help-paramter-paren'>)</span></div></div><div class='gcsj-func-help-body'><div class='gcsj-func-help-section-content'><div class='gcsj-func-help-section'><div class='gcsj-func-help-section-title'>"+p.sR().Fbx_Summary+"</div><div class='gcsj-func-help-section-content'>"+(o.description||"")+"</div></div></div></div>",w.GC$(f.$0).html(h).show(),f._isFuncHelpShown=!0,f._position()}else f._closeFuncHelp();else f._closeFuncHelp()},W.prototype._closeFuncHelp=function(){w.GC$(this.$0).hide(),this._isFuncHelpShown=!1},W.prototype.close=function(){this._closeFuncs(),this._closeFuncHelp()},W.prototype.BH=function(t,e){var o,n,r,i,a,s;return!this.MH&&(o=t.ctrlKey||t.shiftKey||t.altKey||t.metaKey,n=t.keyCode,r=t.ctrlKey,i=t.altKey,a=t.metaKey,(s=t.srcElement||t.target)&&e&&e.isEditing&&"gcAttachedFormulaTextBox"===s.getAttribute("gcUIElement")?67===n&&(r||a)&&!i||88===n&&(r||a)&&!i:this._isFuncsShown&&!o&&(n===R.down||n===R.up||n===R.tab))},W.prototype._position=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p=v;if(this._isFuncsShown?p=this._funcsPopup:this._isFuncHelpShown&&(p=this.$0),p){if(t=w.GC$(this._host),e=w.GC$(p),(o=x.G0.H0)&&o.kj)return n=o.kj.getCellRect(o.nT,o.Mk),r=o.f1,void e.css("top",n.y+n.height+r.top).css("left",n.x+r.left);i=t.parent(),a=t.outerHeight(),this.Dia(this._host)&&(a=(i=i.parent()).outerHeight()),s=i.css("top"),l=parseFloat(s),isNaN(l)||(s=l),u=i.css("left"),"auto"===s&&(s=t.offset().top,u=t.offset().left),c=s+a,w.GC$(S.body).outerHeight()<c+(h=e.outerHeight())&&0<=(f=s-h)&&(c=f),e.css("top",c).css("left",u)}},W.prototype.focus=function(){w.GC$(this._host).focus()},W.prototype.V0=function(t){var e,o,n,r,i="",a="",s=t&&t.length,l=0;for(o=0;o<s;o++)n="",11===(e=t[o]).type&&(n=" style='color: "+this.o1(l)+"'",l++),this._0.innerText=e.text,i+="<span"+n+" class='gcsj-func-color-text'>"+this._0.innerHTML+"</span>",a+=e.text;if(a||this.text())if(r=this._host,i)r.innerHTML="<span class='gcsj-func-color-content'>"+i+"</span>";else for(;r.firstChild;)r.removeChild(r.firstChild)},W.prototype.e1=function(t,e){var o,n,r,i=w.GC$(t).find(".gcsj-func-color-content .gcsj-func-color-text"),a=i.length;for(e=u(0,e),r=0;r<a;r++)if((e-=(n=(o=i[r]).innerText).length)<=0)return{node:o,offset:n.length+e};return n?{node:o,offset:n.length}:v},W.prototype.iIb=function(t,e){var o=A.getSelection(),n=this._host.children[0],r=document.createRange();r.setStart(n,t),r.setEnd(n,e),o.removeAllRanges(),o.addRange(r)},W.prototype.Jka=function(t){var e=this._host,o=this.Cia(e),n=this.text();o&&n&&(n=t?n.substr(0,n.length-2):n,this.Ac.push(n))},W.prototype.nLb=function(t,e){var o,n,r,i,a,s,l;if(e)for(r=n=o=0,i=e.length,a=0;a<t.length;a++){for(s=t[a].text;n<i;n++)if((l=e[n].toUpperCase())===(s[r]?s[r].toUpperCase():void 0))r+=1;else{if("\n"!==l)break;n+1<i&&"​"===e[n+1]&&(n+=1)}t[a].text=e.substring(o,n),o=n,r=0}return t},W.prototype.mLb=function(t){var e,o,n,r,i;if("="===t[0]&&-1!==t.indexOf("\n")){for(e=[],o=t.length,n=!1,r=0;r<o;r++)'"'===(i=t[r])&&(n=!n),n||"\n"!==i?e.push(i):r+1<o&&"​"===t[r+1]&&(r+=1);return e.join("")}},P=W,c.FormulaTextBox=P},"./dist/plugins/sheetsCalc/calc-spreadjs.js":function(t,e,o){"use strict";var M,n,m,y,D,b,j,a,I,_,O,F,P,L,H,v,A,C,u,r,i,s,l,c,h,f,p,d,g,w,x,T,S=this&&this.__extends||(p=function(t,e){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}p(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function N(t,e,o,n){var r,i,a,s=d.call(this,t&&t.yj(),e,o,n)||this;for(t=t||new M.Worksheet,s.kj=t,s.row=o&&o.row||0,s.column=o&&o.col||0,i=(r=t.getCalcService()).getResolvers(),a=0;a<i.length;a++)if(i[a]instanceof y.SheetReferenceResolver)return s;return r.addResolver(new y.SheetReferenceResolver(t)),r.addResolver(new y.StructureReferenceResolver(t)),s}function R(t){var e=g.call(this,O)||this;return e.references=t,e}function k(t,e,o,n,r){this.Cj=t,this.Uu=o,this.Vu=n,this.Lf=e,A(r)||(this.kT=r)}function E(t){var e=x.call(this,O)||this;return e.createSourceModel=function(t){return new D.CalcSourceModel(t,this)},e.Qu=t,e}function B(t,e){var o=T.call(this,O)||this;return o.getCalcSourceModel=function(){return this.Bf},o.createSourceModel=function(t){return new D.CalcSourceModel(t,this)},o.getRangeKey=function(t,e){return t.id+","+e.row+","+e.col+","+e.rowCount+","+e.colCount},o.getSheetRangeReference=function(t){var e,o,n,r,i,a=this.kj,s=a&&a.parent;if(t.endSource&&s&&s.sheets&&t.endSource instanceof B){for(e=s.sheets,o=!1,n=void 0,r=[],i=0;i<e.length;i++){if((n=e[i].yj())===this)o=!0;else if(n===t.endSource){r.push(n.getReference(t));break}o&&r.push(n.getReference(t))}return new c(r)}},o.kj=t,o.Wz=e||3,o}function V(t,e,o,n,r,i){var a,s=t&&t instanceof M.Worksheet&&t,l=new D.Parser;return o=o===F?0:o,n=n===F?0:n,a=new h(s,!!r,D._createCellIdentity(o,n)),i&&(a.culture=!0),l.parse(a,e)}function z(t,e,o,n,r){var i,a,s=t.Cf();return o===F&&(o=t.getActiveRowIndex()),n===F&&(n=t.getActiveColumnIndex()),i=!0,r&&r.convertNullToZero!==F&&(i=r.convertNullToZero),a=t.yj(),s._evaluateParsedFormula(a,e,D._createCellIdentity(o,n),!1,i)}function W(t,e,o,n,r){var i,a,s,l,u=t.row,c=t.col,h=t.row+t.rowCount-1,f=t.col+t.colCount-1,p=!1,d=!1,g=!1,m=!1;return 4<=arguments.length&&(u-=(p=0!=(1&n))?e:0,h-=(d=0!=(4&n))?e:0,c-=(g=0!=(2&n))?o:0,f-=(m=0!=(8&n))?o:0),r&&(i=function(t,e,o){if(1===t.rowCount){if(e.hasHeadersRow()&&t.row===e.startRow())return 2;if(e.hasTotalsRow()&&t.row===e.endRow())return 8;if(o===t.row)return 1}else{if(e.hasHeadersRow()&&t.row===e.startRow()){if(t.rowCount===e.dataRange().rowCount+1)return 6;if(e.hasTotalsRow()&&t.rowCount===e.dataRange().rowCount+1+1)return 14}if(t.row===e.dataRange().row){if(t.rowCount===e.dataRange().rowCount)return 3;if(e.hasTotalsRow()&&t.rowCount===e.dataRange().rowCount+1)return 12}}return F}(t,r,e),l=r,a=(s=t).col===l.startColumn()&&s.colCount===l.dataRange().colCount?1:1===s.colCount?2:s.col>=l.startColumn()&&s.col+s.colCount-1<=l.endColumn()?4:F,i&&a)?y.StructureReferenceResolver.create(r,i,a,t.col-r.dataRange().col,t.col+t.colCount-r.dataRange().col-1):1===t.rowCount&&1===t.colCount?D.rf(O,O,u,c,p,g):(t.row<0&&(u=h=b.BAND_INDEX_CONST),t.col<0&&(c=f=b.BAND_INDEX_CONST),D.uf(O,O,u,c,h,f,p,g,d,m,e,o))}function G(t,e,o,n){var r,i,a,s,l,u,c,h;if(!e)return null;if(o=o||0,n=n||0,(r=t.Cf().parse(t.yj(),e,o,n,!0,!0))&&((!(i=r.source)||13!==r.type)&&1===r.type&&r.endSource)){for(a=r.source,s=r.endSource,l=a.getSources(s),u=!1,c=0;c<l.length;c++)if(l[c]===t.yj()){u=!0;break}r=u&&r}return!r||!r.getRange||i&&i!==t.yj()?null:(h=r.getRange(o,n))?new M.Range(h.row,h.col,h.rowCount,h.colCount):null}function U(t,e,o,n,r,i){var a,s,l,u="";for(a=0;a<o.length;a++)s=W(o[a],n,r,i),l=t.unparse(e,s),u+=0<a?", "+l:l;return u}Object.defineProperty(e,"__esModule",{value:!0}),M=o("Core"),n=o("Core"),m=o("@grapecity/js-sheets-common"),y=o("./dist/plugins/sheetsCalc/parser-sheets.js"),D=o("@grapecity/js-calc"),b=o("./dist/plugins/sheetsCalc/calc.ns.js"),j=m.Common.j,a=m.Common.u,I=j.Ia,_=j.za,O=null,F=void 0,P=["v","n","s","b","d","sn"],L=D.Errors.Value,D.Errors.Calc,H=m.Formatter&&m.Formatter.GeneralFormatter,v=D.Convert.vf,D.Convert._isReference,D.Convert.Ca,D.Errors.Reference,D.Errors.NotAvailable,D.Errors.Name,m.Common.A,m.Common.B,A=j.Fa,C=function(t){return D.Convert.Na(t,!0)},u=M.Range.prototype.contains,r=a.Nb,(i=D.CalcSource.prototype).referenceToArray=function(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d,g,m,y,b,v,C=1,w=1,x=[],T=t.getRangeCount();if(0===T)return x.isError=!0,x;for(d=this.getRowCount(),g=this.getColumnCount(),o=o===F||o,m=0;m<T;m++){if(o||(p=[],x.push(p)),0===(C=t.getRowCount(m)))return x.isError=!0,x;if(0===(w=t.getColumnCount(m)))return x.isError=!0,x;if(c=t.getRow(m),h=t.getColumn(m),d<=c||g<=h)return(x=[O]).rowCount=1,x.colCount=1,x.rangeCount=1,x;for(d<c+C&&(C=d-c),g<h+w&&(w=g-h),y=void 0,b=0;b<C;b++)for(l=c+b,o||(y=[],p.push(y)),v=0;v<w;v++){if(u=h+v,f=this.getValue(l,u),n&&D.Convert.vf(f))return(x=[f]).isError=!0,x;if(f=D.Convert.wf(f,e,!D.ExcelCompatibleCalcMode,i,s),r&&f===D.Convert.CalcConvertedError)return(x=[L]).isConvertError=!0,x;f===O&&i||(o?x.push(f):y.push(f))}}return o||1!==T||(x=x[0]),x.rowCount=C,x.colCount=w,x.rangeCount=T,x},i.getSheetReference=function(){return this.Df=this.Df||new D.CalcReference(this),this.Df},(w=s=e.ReferenceStyle||(e.ReferenceStyle={}))[w.a1=0]="a1",w[w.r1c1=1]="r1c1",n.ReferenceStyle=s,k.prototype.getName=function(){return this.Cj},k.prototype.getRow=function(){return this.Uu},k.prototype.getColumn=function(){return this.Vu},k.prototype.getExpression=function(){return this.Lf},k.prototype.getComment=function(){return this.kT},k.prototype.fg=function(t,e){e&&e.push({type:"customName",nameInfo:this,expr:this.Lf}),this.Lf=t},l=k,e.NameInfo=l,n.NameInfo=l,D.CalcSource.prototype.createSourceModel=function(t){return new D.CalcSourceModel(t,this)},g=D.CalcReference,S(R,g),R.prototype.toArray=function(t,e,o,n,r){var i,a,s=this.references,l=[];for(i=0;i<s.length;i++){if((a=s[i]._source.referenceToArray(s[i],t,e,o,n,r)).isError&&o)return a;e?Array.prototype.push.apply(l,a):l.push(a[0]),i||(l.rowCount=a.rowCount,l.colCount=a.colCount)}return l.rangeCount=s.length,l},c=R,e.SheetRangeReference=c,d=D.ParserContext,S(N,d),N.prototype.getExternalSource=function(t,e){var o,n,r,i=this.kj.parent;if(t&&(!i||i.name!==t))return O;if(!i)return a.Mb(this.kj.name(),e)?this.kj.yj():O;if((o=i.sheets)&&0<o.length)for(n=0;n<o.length;n++)if(r=o[n],a.Mb(r.name(),e))return r.yj();return D.ParserContext.prototype.getExternalSource.call(this,t,e)},N.prototype.getExternalSourceToken=function(t){return t.getName()},N.prototype.getTableByName=function(t){var e,o,n=this.kj.tables,r=n?n.findByName(t):O;if(!r&&(e=this.kj.parent&&this.kj.parent.sheets))for(o=0;o<e.length&&(!(n=e[o].tables)||!(r=n.findByName(t)));o++);return r||this.kj.parent&&this.kj.parent.getSheetTab(t)},N.prototype.getTableByIndex=function(t,e){var o=this.kj.tables;return o?o.find(t,e):O},N.prototype.setSource=function(t){(this.source=t)&&t.getSheet&&(this.kj=t.getSheet())},N.prototype.no=function(){this.kj&&this.kj.no()},h=N,e.SheetParserContext=h,new m.Common.ResourceManager(M.SR),T=D.CalcSource,S(B,T),B.prototype.startCalculation=function(){this.Hu||this.xLb()},B.prototype.endCalculation=function(){this.Hu=O,this.zIc(),this.Iu=O;var t=this.Bf.ug(!1);t&&t.clearListenersCache(),this._service.calcOnDemand&&this.kj.repaint()},B.prototype.ZIc=function(){var t=this;t.$Ic?t.Iu&&(t._Ic=t._Ic.concat(t.Iu),t.Iu=[]):(t._Ic=t.Iu||[],t.$Ic=setTimeout(function(){t.zIc(t._Ic),delete t._Ic,delete t.$Ic},0))},B.prototype.zIc=function(t){var e,o=t||this.Iu;o&&0<o.length&&(e=this.kj).Wq(M.Events.RangeChanged,{isUndo:!1,sheet:e,sheetName:e.name(),row:0,col:0,rowCount:e.getRowCount(),colCount:e.getColumnCount(),changedCells:o,action:6},e.vxb)},B.prototype.clearValueCache=function(){this.xLb()},B.prototype.xLb=function(){var t=this.getRowCount(),e=this.getColumnCount();this.Hu={rowCount:t,colCount:e,arrayInfo:[]},this.Iu=[]},B.prototype.OHb=function(){this.Hu=O,this.Iu=O},B.prototype.getValue=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d=[];for(o=2;o<arguments.length;o++)d[o-2]=arguments[o];if(n=this.kj,"number"==typeof t)r=arguments[0],i=arguments[1],e=arguments[2];else if((t=t).row!==F)r=t.row,i=t.col;else if(t.name)return null;return a=this.Wz,e=e||0,r<0||i<0?L:n.Ju&&n.Ku===r&&n.Lu===i?n.Mu:(s=this.Hu,l=P[e],s?(u=s.rowCount,c=s.colCount,p=f=h=void 0,u<=r||c<=i?O:((p=(f=(f=(h=(h=s[r])||(s[r]={}))[i])||(h[i]={v:n.getValue(r,i,a)}))[l])===F&&(p=D.Convert.wf(f.v,e,!D.ExcelCompatibleCalcMode),f[l]=p),p=M.Ul.w0a(p))):r>=this.getRowCount()||i>=this.getColumnCount()?O:this.kj.getValue(r,i,a))},B.prototype.getIdentity=function(t,e){var o=e.row,n=e.rowCount||1,r=e.column,i=e.columnCount||1;return-1===o&&(o=0,n=this.getRowCount()),-1===r&&(r=0,i=this.getColumnCount()),this.getName()+"."+o+"."+n+"."+r+"."+i},B.prototype.getReference=function(t){var e,o,n,r,i,a,s=t.row,l=t.col;if(-1===s&&(t.row=0,t.rowCount=this.getRowCount()),-1===l&&(t.col=0,t.colCount=this.getColumnCount()),e=!1,t.spillRef)if(o=this.yLb().getAnchorCell(s,l))t.rowCount=o.rowCount,t.colCount=o.colCount,e=!o.isValid;else{if(r=(n=this.getCalcSourceModel()).Qf(s,l))return r.row===s&&r.col===l?(t.rowCount=r.rowCount,t.colCount=r.colCount,new D.CalcReference(this,[t])):void 0;if(!(i=n.Kf(s,l))||33!==i.type)return i&&("@"===i.functionName||i instanceof D.ReferenceExpression)?(t.rowCount=1,t.colCount=1,new D.CalcReference(this,[t])):void 0;e=!0,t.rowCount=1,t.colCount=1}return a=new D.CalcReference(this,[t]),e&&(a.isSpillError=!0),a},B.prototype.getSources=function(t){var e,o,n,r,i;if(this.kj&&this.kj.parent&&this.kj.parent.sheets&&t instanceof B){for(e=this.kj.parent.sheets,o=!1,n=void 0,r=[],i=0;i<e.length;i++){if((n=e[i].yj())===this&&(o=!0),n===t){r.push(n);break}o&&r.push(n)}return r}},B.prototype.Ppb=function(r,i){var a,s=this.Hu,l=s&&s.arrayInfo;l&&(a=!1,l.forEach(function(t,e){if(t){var o=t.reference,n=t.key;u.call(o._identities[0],r,i)&&(delete s[n],l[e]=F,a=!0)}}),a&&(s.arrayInfo=[],l.forEach(function(t){t&&s.arrayInfo.push(t)})))},B.prototype.referenceToArray=function(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S=1,M=1,I=[],N=this.kj,R=this.Hu,k=P[e],E=t.getRangeCount();if(0===E)return I.isError=!0,I;if(R&&(f=R[g=t.getRangeCount()+"_"+t.getRow(0)+"_"+t.getColumn(0)+"_"+t.getRowCount(0)+"_"+t.getColumnCount(0)+"_"+e+"_"+o]))return f;for(m=this.getRowCount(),y=this.getColumnCount(),o=o===F||o,b=0;b<E;b++){if(o||(p=[],I.push(p)),0===(S=t.getRowCount(b)))return I.isError=!0,I;if(0===(M=t.getColumnCount(b)))return I.isError=!0,I;if(c=t.getRow(b),h=t.getColumn(b),m<=c||y<=h)return(I=o?[O]:[[O]]).rowCount=1,I.colCount=1,I.rangeCount=1,I;for(m<c+S&&(S=m-c),y<h+M&&(M=y-h),C=v=void 0,w=N.Ju,x=0;x<S;x++)for(l=c+x,o||(v=[],p.push(v)),R&&(R[l]||(R[l]={}),d=R[l]),T=0;T<M;T++){if(u=h+T,w&&N.Ku===l&&N.Lu===u)f=N.Mu,w=!1;else{if(R?(C=d[u])?f=C.v:(f=N.getValue(l,u,this.Wz),C=d[u]={v:f}):f=N.getValue(l,u,this.Wz),a&&("@"===((A=N.getFormatter())instanceof H?A.formatString():A)?f=N.getText(l,u):f instanceof Date&&(f=j.Pa(f)),_(C)||(C=d[u]={v:f})),n&&D.Convert.vf(f))return(I=[f]).isError=!0,I;if(C&&C[k]!==F)f=C[k];else if(f=D.Convert.wf(f,e,!D.ExcelCompatibleCalcMode,i,s),C&&(C[k]=f),r&&C===f)return(I=[L]).isConvertError=!0,I}D.Convert.j$a(f,i)||(o?I.push(f):v.push(f))}}return o||1!==E||(I=I[0]),I.rowCount=S,I.colCount=M,I.rangeCount=E,R&&!isNaN(E)&&!isNaN(S)&&!isNaN(M)&&100<E*S*M&&E*S*M<1e6&&R.arrayInfo.length<50&&(R[g]=I,R[g].rowCount=S,R[g].colCount=M,R[g].rangeCount=E,R.arrayInfo.push({reference:t,key:g})),I},B.prototype.getColumnCount=function(){var t=this.kj;return t.Js?0:t.getColumnCount(this.Wz)},B.prototype.getRowCount=function(){var t=this.kj;return t.Js?0:t.getRowCount(this.Wz)},B.prototype.isHiddenRow=function(t,e){var o=this.kj;return!((!o.Nu||!o.Nu())&&e)&&0===o.getRowHeight(t)},B.prototype.getName=function(){var t=this.Wz,e=A(this.JXc)?this.kj.name():this.JXc;return t===M.SheetArea.colHeader?e+"CH":t===M.SheetArea.rowHeader?e+"RH":e},B.prototype.yLb=function(){var t=this.ZHb;return t=t||(this.ZHb=this.kj._modelManager.ZHb)},B.prototype.setArray=function(t,e,o,n,r){return this.yLb().setArray(this,t,e,o,n,r)},B.prototype.updateItem=function(t,e,o){return this.yLb().updateItem(this,t,e,o)},B.prototype.GIb=function(t,e){this.yLb().GIb(t,e)},B.prototype.HIb=function(){this.yLb().HIb()},B.prototype.setValue=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S=[];for(e=1;e<arguments.length;e++)S[e-1]=arguments[e];if(o=this.kj,i=this.Wz,(t=t).row!==F)n=t.row,r=t.col,a=1;else{if(t.name)return;n=arguments[0],r=arguments[1],a=2}s=arguments[a],l=arguments[a+1],(u=this.Hu)&&(!(c=u[n])||(h=c[r])&&(h.v=s,h.b!==F&&(h.b=F),h.d!==F&&(h.d=F),h.n!==F&&(h.n=F),h.s!==F&&(h.s=F),h.sn=F)),f=M.Ul.x0a(s),p=o._modelManager,d=!1,m=(g=o.tables)&&g.find(n,r),3===i&&m&&(y=m.showHeader()&&n===m.headerIndex(),b=m.showFooter()&&n===m.footerIndex(),y||b||(d=m.yq(n,r,f))),v=o.wq,3===i&&!d&&v&&v.Ou&&(w=!1,(C=v.getValue(n,r)).hasBinding&&(x=void 0,x=u?(x=(T=u.bindingRows=u.bindingRows||{})[n])||(T[n]=I({},o.getDataItem(n))):I({},o.getDataItem(n)),p.Cp(n,r,{Dp:x,Ep:C.value}),w=v.setValue(n,r,f,p.zTa)),d="dataManagerBindingSource"===v.CL?w:C.hasBinding),d||("string"==typeof f&&f.hyperlink&&(A={url:f.hyperlink},p.setHyperlink&&p.do("setHyperlink",n,r,A),delete f.__proto__.hyperlink),p.do("setValue",n,r,f,i,!0,!0,arguments[a+2])),o.cJc=!0,this.Iu?this.Iu.push({row:n,col:r}):o.Wq(M.Events.CellChanged,{sheet:o,sheetName:o.name(),row:n,col:r,sheetArea:i,propertyName:"value",oldValue:l,newValue:s})},B.prototype.getCustomFunction=function(t){return this.kj?this.kj.Pu(t):O},B.prototype.getCustomName=function(t){t=r(t);var e=this.kj?this.kj.getCustomName(t):O;return e?e.getExpression():O},B.prototype.getSheet=function(){return this.kj},B.prototype.setFormula=function(t,e,o){},B.prototype.setArrayFormula=function(t,e,o,n,r){},B.prototype.setFormulaByName=function(t,e){},B.prototype.refresh=function(){this.kj.repaint()},B.prototype.toJSON=function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C=e,w=t.data||{},x=!0,T=this.Cf();for(T.UIc=!0,c=0;c<=o;c++)if(i=w.dataTable||{},a=C[c]){for(x=!(l=i[c]),l=l||{},h=0;h<=n;h++)if((s=a[h])&&s.Lf){u=l[h]||{};try{f=T.unparse(this,s.Lf,c,h,!1,!0),p=-1<f.indexOf("LET(")&&"LET",d=void 0,p&&(A(u.prefix)&&(u.prefix={}),f=(d=f).replace(/_xlpm\./g,"")),!s.Pf&&f&&0===f.indexOf("@")&&G(this.kj,f.slice(1,f.length),0,0)&&(f=f.slice(1,f.length),p&&(d=d.slice(1,d.length))),s.Pf?s.Pf.row===c&&s.Pf.col===h&&(u.arrayInfo=s.Pf,u.formula=f,p&&(u.prefix[p]=d)):(u.formula=f,p&&(u.prefix[p]=d)),x=!1,l[h]=u}catch(t){}}if(x){if(i!==w.dataTable)continue}else i[c]=l;w.dataTable=i}if(r){for(g=w.columnDataArray||[],m=0;m<r.length;m++)(y=r[m])&&y.Lf&&(b=this.Cf().unparse(this,y.Lf,0,m,!1,!0),(v=g[m]||{}).formula=b,g[m]=v);0<g.length&&(w.columnDataArray=g)}_(w)||(t.data=w),delete T.UIc},f=B,(e.SheetSource=f).prototype.getParserContext=function(t,e,o){return e=e||D._createCellIdentity(0,0),new h(this.kj,t,e,o)},x=D.CalcSource,S(E,x),E.prototype.getCustomFunction=function(t){return this.Qu?this.Qu.getCustomFunction(t):O},E.prototype.getCustomName=function(t){var e=this.Qu?this.Qu.getCustomName(t)||this.Qu.aJb(t):O;return e?e.getExpression():O},e.SpreadSource=E,e.formulaToExpression=V,e.expressionToFormula=function(t,e,o,n,r,i){var a,s=t&&t instanceof M.Worksheet&&t,l=new D.Parser;return o=o===F?0:o,n=n===F?0:n,(a=new h(s,!!r,D._createCellIdentity(o,n))).YSa=i,l.unparse(a,e)},e.evaluateFormula=function(t,e,o,n,r){return o===F&&(o=0),n===F&&(n=0),z(t,V(t,e,o,n,r,!0),o,n)},e.evaluateExpression=z,e.rangeToExpression=W,e.rangeToFormula=function(t,e,o,n,r){var i=W(t,e,o,n),a=new h(O,!!r,D._createCellIdentity(e,o)),s=(new D.Parser).unparse(a,i);return a.no(),s},e.rangeToFormulaWithStructReference=function(t,e,o,n,r,i,a){var s=W(e,o,n,r,a),l=new h(t,!!i,D._createCellIdentity(o,n));return(new D.Parser).unparse(l,s)},e.formulaToRange=G,e.formulaToRanges=function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g=[],m=[];if(!e)return g;for(i={},o=o||0,n=n||0,a=new D.Parser,s=y.qzb(a,e,t,o,n,F,r),l=0;l<s.length;l++)if((u=s[l].sheetRanges)&&!_(u))for(c=0;c<u.sheets.length;c++)for((m=i[h=u.sheets[c]])||(i[h]=m=[],g.push({sheetName:h,ranges:m})),f=u[h],p=0;p<f.length;p++)d=f[p],m.push(new M.Range(d.row,d.col,d.rowCount,d.colCount));return g},e.rangesToFormula=function(t,e,o,n,r){var i=new D.Parser,a=new h(O,!!r,D._createCellIdentity(e,o)),s=U(i,a,t,e,o,n);return a.no(),s},e.ALb=U,e.RangeReferenceRelative={allAbsolute:0,startRowRelative:1,startColRelative:2,endRowRelative:4,endColRelative:8,rowRelative:5,colRelative:10,allRelative:15},e.goalSeek=function(t,e,o,n,r,i,a){var s,l,u,c,h=n.getValue(e,o),f=!1,p=(C(h)?+h:0)-a,d=n.getValue(r,i),g=(C(d)?+d:0)-a;if(C(d)&&Math.abs(g)<.001)f=!0;else if(v(d))f=!1;else for(s=p+(0===p?.01:.01*p),u=0;!f&&u<100;u++)s=m.Common.o.Lma(s,13),t.setValue(e,o,s),d=n.getValue(r,i),l=(C(d)?+d:0)-a,C(d)&&Math.abs(l)<.001?f=!0:s=v(d)?(p+s)/2:p-s==0?p+(0===p?.01:.01*p):g-l==0?p+2*(s-p):(c=s-l*(p-s)/(g-l),p=s,g=l,c);return f||t.setValue(e,o,h),f}},"./dist/plugins/sheetsCalc/calc.ns.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BAND_INDEX_CONST=-2147483648,e.MAX_ROW_COUNT=1048576,e.MAX_COLUMN_COUNT=16384},"./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js":function(t,e,o){"use strict";var lt,n,ut,A,L,r,C,X,a,ct,ht,w,x,V,z,i;function s(t,e){var o,n,r,i;return e=e||this,o=a(t.row,e.row),n=a(t.column,e.column),r=X(t.row+t.rowCount,e.row+e.rowCount),i=X(t.column+t.columnCount,e.column+e.columnCount),r<=o||i<=n?ht:{row:o,column:n,rowCount:r-o,columnCount:i-n,intersectWith:s}}function l(t,e,o,n,r,i,a,s){this.Rj=t,this.Vj=e,this.Wj=o,this.Qj=n,this.Tj=r,this.Uj=i,this.Xj=a,this.Yj=s}function R(t,e,o,n){return(!n||t<e)&&o}function W(t,e,o,n){var r=t[e];(r=r||(t[e]={}))[o]=n}function G(t,e,o){var n=t[e];return n&&n[o]}function $(){}function T(t,e,o,n,r,i,a,s,l,u,c,h){var f,p,d,g;return 0<=o||!r?(f=n+(r?o:0),p=i+(a?o:0),d=c&&N(s,t,c),g=!c&&N(s,t,c),(d||g)&&(!h&&l+u<=o||h&&l<=o)&&(f-=r?u:0,p-=a?u:0),d=c&&N(s,e,c),g=!c&&N(s,e,c),(d||g)&&(!h&&l<=f||h&&(r&&l<=o+n||!r&&l<=n)?(f+=u,p+=u):(!h&&l<=p||h&&(a&&l<=o+i||!a&&l<=i))&&(p+=u)),f-=r?o:0,p-=a?o:0,h&&l+u<=o&&(f+=r?u:0,p+=a?u:0),{index:f,endIndex:p}):{index:n,endIndex:i}}function S(t,e,o,n,r,i,a,s,l,u,c,h){if(e&&!h){var f=l?r.row:r.column,p=l?r.rowRelative:r.columnRelative,d=void 0;if(l&&0<=o||!l&&0<=n||!p){if(u)d=T(t,e,l?o:n,f,p,-1,!1,i,a,s,l,c).index;else if(d=function(t,e,o,n,r,i,a,s,l,u){var c,h,f,p,d;if(0<=o||!r){if(c=n+(r?o:0),h=l&&N(i,t,l),f=!l&&N(i,t,l),(h||f)&&a<=o&&(c+=r?s:0),h=l&&N(i,e,l),f=!l&&N(i,e,l),h||f)if(p=o+n,d=o+s+n,!u&&a+s<=c||u&&a+s<=p)c-=s;else if(!u&&a<=c||u&&a<=p&&a<=d&&d<=a+s)return x;return c-=r?o:0,u&&a<=o&&(c-=r?s:0),c}return n}(t,e,l?o:n,f,p,i,a,s,l,c),w(d))return lt.Hh(d);d!==f&&(r=r.offset(l?d-f:0,l?0:d-f,!0))}}return r}function M(t,e,o,n,r,i,a,s,l,u,c,h){var f,p,d,g,m,y,b,v;if(e&&!h){if(3===(f=r.tf())||l&&2===f||!l&&1===f)return r;if(p=l?r.rowRelative:r.columnRelative,d=l?r.endRowRelative:r.endColumnRelative,g=l?r.row:r.column,m=l?r.endRow:r.endColumn,y=void 0,l&&0<=o||!l&&0<=n||!p||!d){if(u)y=T(t,e,l?o:n,g,p,m,d,i,a,s,l,c);else if(y=function(t,e,o,n,r,i,a,s,l,u,c,h){var f,p,d,g,m,y,b;if(0<=o||!r){if(f=n+(r?o:0),p=i+(a?o:0),d=l+u-1,g=c&&N(s,t,c),m=!c&&N(s,t,c),(g||m)&&l<=o&&(f+=r?u:0,p+=a?u:0),g=c&&N(s,e,c),m=!c&&N(s,e,c),g||m)if(y=o+n,b=o+i,!h&&d<f||h&&d<y)f-=u,p-=u;else{if(!h&&l<=f&&p<=d||h&&l<=y&&b<=d)return x;!h&&p<l||h&&b<l||(!h&&d<=p||h&&d<=b?(f=!h&&f<=l||h&&y<=l?f:l,p-=u):p=l-1)}return f-=r?o:0,p-=a?o:0,h&&l<=o&&(f-=r?u:0,p-=r?u:0),{index:f,endIndex:p}}return{index:n,endIndex:i}}(t,e,l?o:n,g,p,m,d,i,a,s,l,c),w(y))return lt.Hh(y);b=y.index,v=y.endIndex,b===g&&v===m||(r=r.offset2(l?b-g:0,l?0:b-g,l?v-m:0,l?0:v-m,o,n))}}return r}function I(t,e,o,n,r,i,a,s,l,u,c,h){var f,p,d,g,m,y,b,v,C=I,w=n;if(n){if(1===n.type&&n.sf()||33===n.type)w=S(t,n.source||t,e,o,n,r,i,a,s,l,c,h);else if(1===n.type)w=M(t,n.source||t,e,o,n,r,i,a,s,l,c,h);else if(10===n.type)(f=C(t,e,o,n.value,r,i,a,s,l,ct,c,h))!==n.value&&(w=lt.Lh(f));else if(9===n.type)p=C(t,e,o,n.value,r,i,a,s,l,ct,c,h),d=n.value2&&C(t,e,o,n.value2,r,i,a,s,l,ct,c,h),p===n.value&&d===n.value2||(w=lt.Kh(n.operatorType,p,d));else if(7===n.type){for(g=ht,y=m=void 0,v=(b=n).arguments.length,y=0;y<v;y++)if((f=C(t,e,o,m=b.arguments[y],r,i,a,s,l,ct,c,h))!==m){(g=[])[y]=f;break}if(g){for(y=0;y<v;y++)m=b.arguments[y],g[y]!==ct&&g[y]!==ht||(g[y]=C(t,e,o,m,r,i,a,s,l,ct,c,h));w=lt.Jh(b,g)}}else c||s||13!==n.type||(w=function(t,e,o,n,r){if(t){if(e)return e.offsetWhenInsertRemoveColumn(o,n,r)}return e}(t,n,i,a,l));return w}}function h(r,i,a,s,t,e,o,n,l,u){var c=r.getSheet(),h=c.uja&&(c.parent||c).tja(),f=c._modelManager&&c._modelManager.dUa();!function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T;if(t)for(u=0;u<t.length;u++){for(h=c=!0,f=A.maxRowCount-1,p=A.maxColumnCount-1,r=t[u].validator,d=r.n5,g=0,m=d.length;g<m&&(y=d[g],b=y.rowCount,v=y.colCount,s=y.row,l=y.col,-1!==b&&(h=!1,f=s<f?s:f),-1!==v&&(c=!1,p=l<p?l:p),c||h);g++);if(!(o&&h||!o&&c)&&(a=t[u].sheet,C=a.yj(),i=r.condition(),(w=i.getExpressions())&&0<w.length)){for(x=0;x<w.length;x++)T=w[x],w[x]=e(C,T,f,p);i.setExpressions(w,n)}}}(h,function(t,e,o,n){return i.call(this,t,o,n,e,r,a,s,l,u)},l,f)}function U(t){var n=[],e=t.parent;return(e&&e.sheets||[t]).forEach(function(e){var t=e.conditionalFormats,o=t&&t.getRules();o&&o.length&&o.forEach(function(t){t.xyb&&n.push({rule:t,sheet:e})})}),n}function f(r,i,a,s,l,u){var t=r.getSheet();J(U(t),function(t,e,o,n){return i.call(this,t,o,n,e,r,a,s,l,u)},t._modelManager&&t._modelManager.dUa(),l,u)}function J(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D;if(t)for(i=0,a=t.length;i<a;i++){if(l=(s=t[i].rule).ranges(),c=(u=V(l)).r,h=u.c,p=(f=t[i].sheet).yj(),d=s.condition(),(g=f.tables)&&l&&1===l.length&&(y=(m=l[0]).row,b=m.col,v=m.rowCount,C=m.colCount,w=void 0,r&&n?w=g.KFc(y,b,v,C):f.dJb&&f.zFc&&(w=[f.zFc]),w&&w.length)){for(x=!1,T=0,A=w.length;T<A;T++)if(M=(S=w[T]).row,I=S.col,N=S.rowCount,R=S.colCount,y===M&&v===N&&I<=b&&b+C<=I+R){x=!0;break}if(x)continue}if(d||(s.initCondition(),d=s.condition()),(k=d&&d.getExpressions())&&0<k.length){for(E=0;E<k.length;E++)D=k[E],k[E]=e(p,D,c,h);d.setExpressions(k,o)}}}function N(t,e,o){var n=o?{2:!0}:{1:!0};return t===e||t.kj===e.kj&&(3===t.Wz&&n[e.Wz]||n[t.Wz]&&3===e.Wz)}function k(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b=k,v=e;if(e)if(e.source)if(a=e.source,(s=e.endSource)&&a!==s){if(!(l=a.kj&&a.kj.parent))return lt.Ih;s===o?(u=o.VDc,v.endSource=l.getSheet(u-1).yj()):a===o&&(c=o.VDc,v.source=l.getSheet(c).yj()),delete o.VDc,v.source===v.endSource&&delete v.endSource}else(t!==o&&a===o||t===o&&a!==o)&&(v=lt.Ih);else if(10===e.type)(n=b(t,e.value,o))!==e.value&&(v=lt.Lh(n));else if(9===e.type)h=b(t,e.value,o),f=e.value2&&b(t,e.value2,o),h===e.value&&f===e.value2||(v=lt.Kh(e.operatorType,h,f));else if(7===e.type){for(p=ht,d=e.arguments.length,i=0;i<d;i++)if((n=b(t,r=e.arguments[i],o))!==r){(p=[])[i]=n;break}if(p){for(i=0;i<d;i++)r=e.arguments[i],p[i]!==ct&&p[i]!==ht||(p[i]=b(t,r,o));v=lt.Jh(e,p)}}else 8===e.type&&(g=t||o,m=C(e.value),(y=g.getCustomName(m))&&y.source?a=y.source:(y=(g._service.getGlobalSourceModel()||g.getCalcSourceModel()).getSource().getCustomName(m))&&y.source&&(a=y.source),a&&(t!==o&&a===o||t===o&&a!==o)&&(v=lt.Ih));return v}function u(t,e,o,n,r){return k(t,n,r)}function E(t,e,o,n,r,i,a,s){return a?lt.BLb(s,t,e,o,n,r,i):lt.rf(t,e,o,n,r,i)}function j(t,e){if(!(e=t.getIntersect(e,0,0)))return ht;var o=t.row,n=t.col,r=t.rowCount,i=t.colCount;return t.rowCount===e.rowCount&&t.colCount===e.colCount||(t.rowCount===e.rowCount?(t.col===e.col&&(n=t.col+e.colCount),i=t.colCount-e.colCount):t.colCount===e.colCount&&(t.row===e.row&&(o=t.row+e.rowCount),r=t.rowCount-e.rowCount)),L.kf(o,n,r,i)}function _(t,e,o,n){var r,i=j(t,e);return i?(r=i.union(o),n?(r.col=t.col,r.colCount=t.colCount):(r.row=t.row,r.rowCount=t.rowCount)):r=o,{startRow:r.row,endRow:r.row+r.rowCount-1,startColumn:r.col,endColumn:r.col+r.colCount-1}}function O(t,e,o,n,r){var i,a=j(t,e),s=t.getIntersect(e,0,0);return s?(s.row+=n,s.col+=r,{startRow:(i=a?a.union(s):o).row,endRow:i.row+i.rowCount-1,startColumn:i.col,endColumn:i.col+i.colCount-1}):ht}function F(t,e){var o=t.row,n=t.col,r=t.rowCount,i=t.colCount,a=e.row,s=e.col,l=e.rowCount,u=e.colCount;return 1===r&&1!==i?s<n&&n<=s+u-1||s<=n+i-1&&n+i-1<s+u-1:1!==i||1===r||a<o&&o<=a+l-1||a<=o+r-1&&o+r-1<a+l-1}function ft(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y,b,v=(c=r,h=i,f=n.getRange(c,h),L.kf(f.row,f.col,f.rowCount,f.colCount)),C=v.row,w=v.row+v.rowCount-1,x=v.col,T=v.col+v.colCount-1,A=t.Vj,S=A+t.Xj-1,M=t.Wj,I=M+t.Yj-1,N=t.Tj,R=t.Uj,k=L.kf(A,M,t.Xj,t.Yj),E=L.kf(N,R,t.Xj,t.Yj),D=v.getIntersect(E,0,0);if(p=k,g=E,m=e,y=o,(d=v)&&p&&(!(b=d.getIntersect(p,0,0))&&d.getIntersect(g,0,0)||b&&b.rowCount===d.rowCount&&0!==y||b&&b.colCount===d.colCount&&0!==m))if(u=l=void 0,s=0!==e)if(u=A<=w&&w<=S,(l=A<=C&&C<=S)&&u)C+=e,w+=e;else if(l&&!u){if(e<=0)C+=e;else if(!(w<A+e)){if(!(S+e<w))return O(v,k,E,e,o);if(A===C)return _(v,k,E,s);C+=e}}else if(!l&&u){if(0<=e)w+=e;else if(!(S+e<C)){if(!(C<N))return O(v,k,E,e,o);if(S===w)return _(v,k,E,s);w+=e}}else D&&!D.equals(E)&&F(v,E)&&(C=(a=j(v,D)).row,w=a.row+a.rowCount-1,x=a.col,T=a.col+a.colCount-1);else if(u=M<=T&&T<=I,(l=M<=x&&x<=I)&&u)x+=o,T+=o;else if(l&&!u){if(o<0)x+=o;else if(!(T<M+o)){if(!(I+o<T))return O(v,k,E,e,o);if(M===x)return _(v,k,E,s);x+=o}}else if(!l&&u){if(0<o)T+=o;else if(!(I+o<x)){if(!(x<R))return O(v,k,E,e,o);if(I===T)return _(v,k,E,s);T+=o}}else D&&!D.equals(E)&&F(v,E)&&(C=(a=j(v,D)).row,w=a.row+a.rowCount-1,x=a.col,T=a.col+a.colCount-1);return{startRow:C,endRow:w,startColumn:x,endColumn:T}}function Z(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d=Z,g=n;if(1===n.type&&n.sf()||33===n.type)g=i?function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y,b=!!n.source,v=n.source||t,C=n.rowRelative,w=n.columnRelative,x=e,T=o,A=r.Qj.kj;if(i&&i.isCustomName&&(c=n.row,h=n.column,x=r.Tj+(c-r.Vj)+A.MLc(r.Tj,c-r.Vj+1,!0),T=r.Uj+(h-r.Wj)+A.MLc(r.Uj,h-r.Wj+1)),f=r.Nj(x),p=r.Oj(T),g=(d=33===n.type)&&n.contextSource,(0<=e||!C)&&(0<=o||!w)){if(a=n.row+(C?e:0),s=n.column+(w?o:0),i&&i.isNameID||t===r.Rj&&(u=t===r.Qj?r.Pj(r.Qj,e,o,1,1):(m=e,y=o,i&&i.crossSheetMoved&&(m-=f,y-=p),r.Sj(r.Rj,m,y,1,1))),v===r.Qj&&r.Pj(v,a,s,1,1)&&!r.Sj(v,a,s,1,1)&&(!C&&!w||!u))return lt.Ih;if(l=(b&&v===r.Rj||!b&&t===r.Rj)&&(!u&&r.Sj(r.Rj,a,s,1,1)||u&&r.Pj(r.Qj,C?a:a+f,w?s:s+p,1,1)),u&&(a-=C?f:0,s-=w?p:0),l&&(a+=f,s+=p),a-=C?e:0,s-=w?o:0,v=n.source,r.Rj!==r.Qj&&(l&&u?b&&(v=r.Qj):l?v=r.Qj:u&&!b&&(v=r.Rj)),a!==n.row||s!==n.column||v!==n.source)return E(v,ht,a,s,C,w,d,g)}else if((0<=e||!C)&&-1===o){if(a=n.row+(C?e:0),r.Pj(t,e,o,1,1)&&(a-=C?f:0),r.Sj(v,a,-1,1,-1))a+=f;else if(r.Pj(v,a,-1,1,-1))return lt.Ih;if((a-=C?e:0)!==n.row)return E(n.source,ht,a,n.column,C,n.columnRelative,d,g)}else if(-1===e&&0<=o&&!w){if(s=n.column+(w?o:0),r.Pj(t,e,o,1,1)&&(s-=w?p:0),r.Sj(v,a,s,1,1))s+=p;else if(r.Pj(v,a,s,1,1))return lt.Ih;if(s-=w?o:0,a!==n.row||s!==n.column)return E(n.source,n.endSource,n.row,s,n.rowRelative,w,d,g)}return n}(t,e,o,n,r,a):function(t,e,o,n,r){var i,a,s=n.source||t,l=n.rowRelative,u=n.columnRelative,c=r.Nj(e),h=r.Oj(o),f=33===n.type,p=f&&n.contextSource;if((0<=e||!l)&&(0<=o||!u)){if(i=n.row+(l?e:0),a=n.column+(u?o:0),r.Pj(t,e,o,1,1)?(i-=l?c:0,a-=u?h:0):r.Sj(t,i,a,1,1)&&(i+=l?c:0,a+=u?h:0),r.Sj(s,i,a,1,1)?(i+=c,a+=h):r.Pj(s,i,a,1,1)&&(i-=c,a-=h),a-=u?o:0,(i-=l?e:0)!==n.row||a!==n.column)return E(n.source,ht,i,a,l,u,f,p)}else if((0<=e||!l)&&-1===o){if(i=n.row+(l?e:0),r.Pj(t,e,-1,1,-1)?i-=l?c:0:r.Sj(t,i,-1,1,-1)&&(i+=l?c:0),r.Sj(s,i,-1,1,-1)?i+=c:r.Pj(s,i,-1,1,-1)&&(i-=c),(i-=l?e:0)!==n.row||a!==n.column)return E(n.source,ht,i,n.column,l,n.columnRelative,f,p)}else if(-1===e&&0<=o&&!u&&(a=n.column+0,r.Pj(t,-1,o,-1,1)?a-=0:r.Sj(t,-1,a,-1,1)&&(a+=0),r.Sj(s,-1,a,-1,1)?a+=h:r.Pj(s,-1,a,-1,1)&&(a-=h),a-=0,i!==n.row||a!==n.column))return E(n.source,ht,n.row,a,n.rowRelative,u,f,p);return n}(t,e,o,n,r);else if(1===n.type)g=i?function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J,Z,q,K,Y,Q,X,$,tt,et,ot=!!n.source,nt=ot?n.source:t,rt=n.tf(),it=e,at=o,st=r.Qj.kj;if(i&&i.isCustomName&&(C=n.row,w=n.column,it=r.Tj+(C-r.Vj)+st.MLc(r.Tj,C-r.Vj+1,!0),at=r.Uj+(w-r.Wj)+st.MLc(r.Uj,w-r.Wj+1)),x=r.Nj(it),T=r.Oj(at),A=i&&i.isDataValidator,et=t,S=(tt=r).Qj===tt.Rj&&et!==tt.Qj,M=!1,0===rt)if(a=n.rowRelative,s=n.columnRelative,l=n.endRowRelative,u=n.endColumnRelative,0<=e||!a||!l||0<=o||!s||!u){if(c=n.row+(a?e:0),h=n.endRow+(l?e:0),f=n.column+(s?o:0),d=h-c+1,g=(p=n.endColumn+(u?o:0))-f+1,!A&&S){if(r.Sj(r.Rj,c,f,d,g))return n.offset(x,T,!0);if(r.Pj(nt,c,f,d,g))return lt.Ih;if(nt!==r.Rj||nt!==r.Qj||0!==x&&0!==T)return n;M=!0}if(i&&i.isNameID||t===r.Rj&&(v=t===r.Qj?r.Pj(r.Qj,e,o,1,1):(I=e,N=o,i&&i.crossSheetMoved&&(I-=x,N-=T),r.Sj(r.Rj,I,N,1,1))),(M||t===nt&&t===r.Rj&&t===r.Qj)&&(R=e,k=o,v&&(R-=x,k-=T),0===x||0===T)){if(!(E=ft(r,x,T,n,R,k)))return lt.Ih;if(0===T&&x&&E.endColumn>=p&&E.startColumn<=f||0===x&&T&&E.endRow>=h&&E.startRow<=c)return D=E.startRow,j=E.startColumn,_=E.endRow,O=E.endColumn,D===c&&_===h&&j===f&&O===p?n:(a&&(D-=e),l&&(_-=e),s&&(j-=o),u&&(O-=o),lt.uf(n.source,ht,D,j,_,O,a,s,l,u,e,o))}if(v&&(F=r.Tj-r.Vj,P=r.Uj-r.Wj,d+=(a?-F:0)+(l?F:0),g+=(s?-P:0)+(u?P:0)),nt===r.Qj&&r.Pj(nt,c,f,d,g)&&!g&&(!a&&!s&&!l&&!u||!v))return lt.Ih;if(b=(ot&&nt===r.Rj||!ot&&t===r.Rj)&&(!v&&r.Sj(r.Rj,c,f,d,g)||v&&r.Pj(r.Qj,a?c:c+x,s?f:f+T,d,g)),v&&(c-=a?x:0,h-=l?x:0,f-=s?T:0,p-=u?T:0),L=!1,b)c+=m=x,h+=m,f+=y=T,p+=y;else if(r.Pj(nt,c,f,d,g)){if(!(H=r.intersectWith(nt,c,f,d,g))||H.rowCount!==d&&H.colCount!==g)return lt.Ih;c=H.row+x,f=H.col+T,h=c+H.rowCount,p=f+H.colCount,L=!0}if(c-=a?e:0,h-=l?e:0,f-=s?o:0,p-=u?o:0,r.Rj===r.Qj?nt=ot?n.source:ct:(nt=n.source,b&&v&&ot?nt=r.Qj:b&&v||(b?nt=r.Qj:v&&!ot&&(nt=r.Rj))),c!==n.row||f!==n.column||h!==n.endRow||p!==n.endColumn||L||nt!==n.source)return lt.uf(nt,ht,c,f,h,p,a,s,l,u,e,o)}else if(!(0<=e)&&a&&l||-1!==o){if(-1===e&&(0<=o||!s||!u)){if(f=n.column+(s?o:0),(p=n.endColumn+(u?o:0))<f)return lt.Ih;if(r.Pj(t,e,o,1,1)&&(f-=s?T:0,p-=u?T:0),g=p-f+1,r.Sj(nt,-1,f,-1,g))f+=y=T,p+=y;else if(r.Pj(nt,-1,f,-1,g))return lt.Ih;if(p-=u?o:0,(f-=s?o:0)!==n.column||p!==n.endColumn)return lt.uf(n.source,ht,n.row,f,n.endRow,p,n.rowRelative,s,n.endRowRelative,u,e,o)}}else{if(c=n.row+(a?e:0),(h=n.endRow+(l?e:0))<c)return lt.Ih;if(r.Pj(t,e,o,1,1)&&(c-=a?x:0,h-=l?x:0),d=h-c+1,r.Sj(nt,c,-1,d,-1))c+=m=x,h+=m;else if(r.Pj(nt,c,-1,d,-1))return lt.Ih;if(h-=l?e:0,(c-=a?e:0)!==n.row||h!==n.endRow)return lt.uf(n.source,ht,c,n.column,h,n.endColumn,a,n.columnRelative,l,n.endColumnRelative,e,o)}else if(1===rt){if(a=n.rowRelative,l=n.endRowRelative,0<=e||!a||!l){if(c=n.row+(a?e:0),(h=n.endRow+(l?e:0))<c)return lt.Ih;if(v=t===r.Rj&&t===r.Qj&&r.Pj(r.Qj,e,o,1,1),nt===r.Rj&&nt===r.Qj&&0===r.Wj&&0===r.Uj&&r.Yj===nt.getColumnCount()){if(B=r.Vj,V=r.Tj,v&&(c-=x,h-=x),W=B+(z=r.Xj),U=B<=h&&h<W,(G=B<=c&&c<W)&&U)return v?n:n.offset(x,T,!0);if(J=V+z,G&&V<=h?(c+=x,h<J&&V<=h&&(h=J-1,c=W)):U&&c<=J&&(h+=x,V<=c&&f<J&&(c=V,h=B-1)),h-=l?e:0,(c-=a?e:0)!==n.row||h!==n.endRow)return lt.uf(n.source,n.endSource,c,ut.BAND_INDEX_CONST,h,ut.BAND_INDEX_CONST,a,s,l,u,e,o)}if(v)return n.offset(-x,T,!0)}}else if(2===rt){if(s=n.columnRelative,u=n.endColumnRelative,f=n.column+(s?o:0),(p=n.endColumn+(u?o:0))<f)return lt.Ih;if(v=t===r.Rj&&t===r.Qj&&r.Pj(r.Qj,e,o,1,1),nt===r.Rj&&nt===r.Qj&&0===r.Vj&&0===r.Tj&&r.Xj===nt.getRowCount()){if(Z=r.Wj,q=r.Uj,v&&(f-=T,p-=T),Y=Z+(K=r.Yj),X=Z<=p&&p<Y,(Q=Z<=f&&f<Y)&&X)return v?n:n.offset(x,T,!0);if($=q+K,Q&&q<=p?(f+=T,p<$&&q<=p&&(p=$-1,f=Y)):X&&f<=$&&(p+=T,q<=f&&f<$&&(f=q,p=Z-1)),p-=u?o:0,(f-=s?o:0)!==n.column||p!==n.endColumn)return lt.uf(n.source,n.endSource,ut.BAND_INDEX_CONST,f,ut.BAND_INDEX_CONST,p,a,s,l,u,e,o)}if(v)return n.offset(x,-T,!0)}return n}(t,e,o,n,r,a):function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y=n.source||t,b=n.tf(),v=r.Nj(e),C=r.Oj(o);if(0===b){if(h=n.rowRelative,f=n.columnRelative,p=n.endRowRelative,d=n.endColumnRelative,!(0<=e)&&h&&p||!(0<=o)&&f&&d)if(!(0<=e)&&h&&p||-1!==o){if(-1===e&&(0<=o||!f||!d)){if(s=n.column+(f?o:0),l=n.endColumn+(d?o:0),s<l)return lt.Ih;if(r.Pj(t,-1,o,-1,1)?(s-=f?C:0,l-=d?C:0):r.Sj(t,-1,o,-1,1)&&(s+=f?C:0,l+=d?C:0),c=l-s,r.Sj(y,-1,s,-1,c)?(s+=m=C,l+=m):r.Pj(y,-1,s,-1,c)&&(s-=m=C,l-=m),l-=d?o:0,(s-=f?o:0)!==n.column||l!==n.endColumn)return lt.uf(n.source,ht,s,n.endRow,l,n.rowRelative,f,n.endRowRelative,d,e,o)}}else{if(i=n.row+(h?e:0),a=n.endRow+(p?e:0),i<a)return lt.Ih;if(r.Pj(t,e,-1,1,-1)?(i-=h?v:0,a-=h?v:0):r.Sj(t,e,-1,1,-1)&&(i+=h?v:0,a+=h?v:0),u=a-i,r.Sj(y,i,-1,u,-1)?(i+=g=v,a+=g):r.Pj(y,i,-1,u,-1)&&(i-=g=v,a-=g),a-=p?e:0,(i-=h?e:0)!==n.row||a!==n.endRow)return lt.uf(n.source,ht,i,n.column,a,n.endColumn,h,n.columnRelative,p,n.endColumnRelative,e,o)}else if(i=n.row+(h?e:0),a=n.endRow+(p?e:0),s=n.column+(f?o:0),l=n.endColumn+(d?o:0),u=a-i,c=l-s,r.Pj(t,e,o,1,1)?(i-=h?v:0,a-=p?v:0,s-=f?C:0,l-=d?C:0):r.Sj(t,i,s,u,c)&&(i+=h?v:0,a+=p?v:0,s+=f?C:0,l+=d?C:0),r.Sj(y,i,s,u,c)?(i+=g=v,a+=g,s+=m=C,l+=m):r.Pj(y,i,s,u,c)&&(i-=g=v,a-=g,s-=m=C,l-=m),a-=p?e:0,s-=f?o:0,l-=d?o:0,(i-=h?e:0)!==n.row||s!==n.column||a!==n.endRow||l!==n.endColumn)return lt.uf(n.source,ht,i,s,a,l,h,f,p,d,e,o)}else if(1===b){if(h=n.rowRelative,p=n.endRowRelative,0<=e||!h||!p){if(i=n.row+(h?e:0),a=n.endRow+(p?e:0),i<a)return lt.Ih;if(r.Pj(t,e,-1,1,-1)?(i-=h?v:0,a-=p?v:0):r.Sj(t,e,-1,1,-1)&&(i+=h?v:0,a+=p?v:0),u=a-i,r.Sj(y,i,-1,u,-1)?(i+=g=v,a+=g):r.Pj(y,i,-1,u,-1)&&(i-=g=v,a-=g),a-=p?e:0,(i-=h?e:0)!==n.row||a!==n.endRow)return lt.uf(n.source,ht,i,ut.BAND_INDEX_CONST,a,ut.BAND_INDEX_CONST,h,!1,p,!1,e,o)}}else if(2===b){if(f=n.columnRelative,d=n.endColumnRelative,s=n.column+(f?o:0),(l=n.endColumn+(d?o:0))<s)return lt.Ih;if(r.Pj(t,-1,o,-1,1)?(s-=f?C:0,l-=d?C:0):r.Sj(t,-1,o,-1,1)&&(s+=f?C:0,l+=d?C:0),c=l-s,r.Sj(y,-1,s,-1,c)?(s+=m=C,l+=m):r.Pj(y,-1,s,-1,c)&&(s-=m=C,l-=m),l-=d?o:0,(s-=f?o:0)!==n.column||l!==n.endColumn)return lt.uf(n.source,ht,ut.BAND_INDEX_CONST,s,ut.BAND_INDEX_CONST,l,!1,f,!1,d,e,o)}return n}(t,e,o,n,r);else if(10===n.type)(s=d(t,e,o,n.value,r,i,a))!==n.value&&(g=lt.Lh(s));else if(9===n.type)l=d(t,e,o,n.value,r,i,a),u=n.value2&&d(t,e,o,n.value2,r,i,a),l===n.value&&u===n.value2||(g=lt.Kh(n.operatorType,l,u));else if(7===n.type){for(c=ht,f=h=void 0,p=n.arguments.length,f=0;f<p;f++)if((s=d(t,e,o,h=n.arguments[f],r,i,a))!==h){(c=[])[f]=s;break}if(c){for(f=0;f<p;f++)h=n.arguments[f],c[f]!==ct&&c[f]!==ht||(c[f]=d(t,e,o,h,r,i,a));g=lt.Jh(n,c)}}return g}function H(t,e,o,n,r,i){t._g(e,o,n,r,!0,!1,i)}function p(t,e,o){var n,r,i,a,s,l,u,c=p,h=e;if(8===e.type){if(e.value===o&&(!e.source||e.source===t.getSource()))return lt.Hh(x,e.source)}else if(10===e.type)(n=c(t,e.value,o))!==e.value&&(h=lt.Lh(n));else if(9===e.type)a=c(t,e.value,o),s=e.value2&&c(t,e.value2,o),a===e.value&&s===e.value2||(h=lt.Kh(e.operatorType,a,s));else if(7===e.type){for(l=ht,u=e.arguments.length,i=0;i<u;i++)if((n=c(t,r=e.arguments[i],o))!==r){(l=[])[i]=n;break}if(l){for(i=0;i<u;i++)r=e.arguments[i],l[i]!==ct&&l[i]!==ht||(l[i]=c(t,r,o));h=lt.Jh(e,l)}}return h}Object.defineProperty(e,"__esModule",{value:!0}),lt=o("@grapecity/js-calc"),n=o("@grapecity/js-sheets-common"),ut=o("./dist/plugins/sheetsCalc/calc.ns.js"),A=o("./dist/plugins/sheetsCalc/parser-sheets.js"),L=o("Core"),r=n.Common.u,C=r.Nb,X=Math.min,a=Math.max,ct=void 0,ht=null,w=lt.Convert.vf,x=lt.Errors.Reference,V=L.util.l_a,l.prototype.Nj=function(t){var e,o,n=this.Qj.kj;return n&&n.KLc()&&0<=t?(e=t-this.Tj+1,o=n.NLc(this.Tj,e,!0),this.Tj-this.Vj+o):this.Tj-this.Vj},l.prototype.Oj=function(t){var e,o,n=this.Qj.kj;return n&&n.KLc()&&0<=t?(e=t-this.Uj+1,o=n.NLc(this.Uj,e),this.Uj-this.Wj+o):this.Uj-this.Wj},l.prototype.Sj=function(t,e,o,n,r){return this.Rj===t&&(-1===this.Vj||this.Vj<=e&&e+n<=this.Vj+this.Xj)&&(-1===this.Wj||this.Wj<=o&&o+r<=this.Wj+this.Yj)},l.prototype.Pj=function(t,e,o,n,r){var i=this.Qj.kj,a=i&&i.KLc(),s=this.Tj,l=this.Uj,u=this.Xj,c=this.Yj;return a&&(u+=i.MLc(s,u,!0),c+=i.MLc(l,c)),this.Qj===t&&(-1===s||s<=e&&e+n<=s+u)&&(-1===l||l<=o&&o+r<=l+c)},l.prototype.intersectWith=function(t,e,o,n,r){var i;return this.Qj!==t?ht:(i=this.Zj(t,e,o,n,r),this.Zj(t,this.Vj,this.Wj,n,r).intersectWith(i))},l.prototype.Zj=function(t,e,o,n,r){return{row:-1===e?0:e,column:-1===o?0:o,rowCount:-1===e||-1===n?t.rowCount:n,columnCount:-1===o||-1===r?t.colCount:r,intersectWith:s}},z=l,e.MoveSwapInfo=z,$.zj=function(t,e,o,n,r,i,a,s,l,u,c){var h,f,p,d,g,m=o,y=$,b=this.zj;if(!o)return m;if(10===(p=o.type))m=lt.Lh(b.call(y,t,e,o.value,n,r,i,a,s,l,u,c));else if(1===p&&o.sf()||33===p){if(h=X((o.source||e).getRowCount(),ut.MAX_ROW_COUNT),f=X((o.source||e).getColumnCount(),ut.MAX_COLUMN_COUNT),o.rowRelative&&(o.row+n<0||o.row+n>=h)||o.columnRelative&&(o.column+r<0||o.column+r>=f))return lt.Hh(x,o.source);m=o.offset(0,0,!1)}else if(1===p){if(h=X((o.source||e).getRowCount(),ut.MAX_ROW_COUNT),f=X((o.source||e).getColumnCount(),ut.MAX_COLUMN_COUNT),o.rowRelative&&!o.isFullColumn&&(o.row+n<0||o.row+n>h)||o.columnRelative&&!o.isFullRow&&(o.column+r<0||o.column+r>f)||o.endRowRelative&&!o.isFullColumn&&(o.endRow+n<0||o.endRow+n>h)||o.endColumnRelative&&!o.isFullRow&&(o.endColumn+r<0||o.endColumn+r>f))return lt.Hh(x,o.source,o.endSource);m=o.offset(0,0,!1,n,r)}else if(9===o.type)m=lt.Kh(o.operatorType,b.call(y,t,e,o.value,n,r,i,a,s,l,u,c),o.value2&&b.call(y,t,e,o.value2,n,r,i,a,s,l,u,c));else if(7===p){if(d=[],o.arguments&&0<o.arguments.length)for(g=0;g<o.arguments.length;g++)d[g]=b.call(y,t,e,o.arguments[g],n,r,i,a,s,l,u,c);m=lt.Jh(o,d)}else 13===p&&(m=o.offsetWhenCopy(t,e,n,r,i,a,s,l,u,c));return m},$.copyFormula=function(t,e,o,n,r,i,a,s,l,u){var c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J,Z=t,q=n,K=t.getSource(),Y=n.getSource(),Q=$;if(Z&&q){for(c=Y&&Y.getSheet()._modelManager.dUa(),f=o,p=r,d=i,g=a,m=s,(h=e)<0&&(h=0,g=X(t.rC(),n.rC())),o<0&&(f=0,m=X(t.cC(),n.cC())),r<0&&(p=0),i<0&&(d=0),y=new lt.CalcSourceModel(t.Cf(),K),x=Y.getSheet(),T=!u&&x.KLc(),A=g,S=m,M=x.getRowCount(),I=x.getColumnCount(),b=0;b<g;b++)for(v=0;v<m;v++)Z.Uf(y,b+h,v+f,b,v);for(N={},R=n.Cf(),C=b=0;b<g&&b+p<M;b++)if(k=b+p,T&&0===x.getRowHeight(k))g++;else if(l&&Y.isHiddenRow(k,!0))C++;else{for(w=v=0,m=S;v<m&&v+d<I;v++)if(E=v+d,T&&0===x.getColumnWidth(E))m++;else{if(D=y.Kf(C,w)){if(D===N)continue;if(j=r+b-e-C,_=i+v-o-w,D=Q.zj(K,Y,D,k,E,j,_,r,i,A,S),O=y.Qf(C,w),Y){if(T&&O)continue;if(O&&!O.isDynamicArray){for(F=O.rowCount,P=O.colCount,0<(L=h-O.row)&&(F-=L),(H=g-b)<F&&(F=H),0<(B=f-O.col)&&(P-=B),(V=m-v)<P&&(P=V),z=0;z<F;z++)for(W=0;W<P;W++)y.Rf(b+z,v+W,N);n.setArrayFormula(k,E,F,P,R.unparse(Y,D,k,E),ct,c)}else G=D?R.unparse(Y,D,k,E):ct,Y.setFormula(k,E,G),(U=y.Mf(C,w))&&(J=new lt.EvaluateContext(Y,lt._createCellIdentity(k,E),!1),U=(U=lt.Mh(J,D,!1,0,0))===D?ct:U),q.ig(k,E,D,U,O,c)}else q.Rf(k,E,D),q.Xf(k,E,O)}else q&&q.Kf(k,E)&&q.ig(k,E,ct,ct,ct,c);w++}C++}}},$.moveFormula=function(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O=t.Bj(),F=n.Bj(),P=O.Cf();if(O&&F){for(l=n.getRowCount(),u=n.getColumnCount(),c=O.dUa(),h=F.dUa(),f=P.ih(),e<0&&(e=0,a=X(t.getRowCount(),l)),r<0&&(r=0),o<0&&(o=0,s=X(t.getColumnCount(),u)),i<0&&(i=0),p=!(t===n&&t.name()===n.name()),g=s,m=d=a,(b=n.KLc())&&(d+=n.MLc(r,a,!0),g+=n.MLc(i,s)),O.Sg(e,o,a,s),H(O,e,o,a,s),F.Sg(r,i,d,g),H(F,r,i,d,g),v=[],C=0;C<a;C++)for(w=0;w<s;w++)x=O.Kf(C+e,w+o),T=O.Qf(C+e,w+o),A=O.Mf(C+e,w+o),x?(v.push({Lf:x,Pf:T,Nf:A}),O.Sf(C+e,w+o,c)):v.push(ht);for(N=p?{}:null,S=C=0;C<m&&C+r<l;C++)if(R=C+r,b&&0===n.getRowHeight(R))m++;else{for(M=w=0,y=s;w<y&&i+w<u;w++)if(k=w+i,b&&0===n.getColumnWidth(k))y++;else{if(E=v[S*s+M]){if(x=E.Lf,T=E.Pf,b&&T){M++;continue}P&&T&&!T.isDynamicArray&&T.row===e+C&&T.col===o+w&&(I=L.kf(R,k,T.rowCount,T.colCount)),D=T&&!T.isDynamicArray?I:ct,A=E.Nf,F.FTa(h,R,k),F.Rf(R,k,x),F.Xf(R,k,D),F.Wf(R,k,A),p&&(N[R+", "+k]=x)}else F.FTa(h,R,k),F.Rf(R,k,ct),F.Xf(R,k,ct);M++}S++}f.Dj(O,e,o,a,s),f.Dj(F,r,i,d,g),_=(j=O.getSource().getSheet()).uja&&(j.parent||j).tja(),f.Ej(_,O.getSource(),e,o,F.getSource(),r,i,a,s,!0,N),1==p&&f.Ej(_,O.getSource(),e,o,F.getSource(),r,i,a,s,!0,N)}},$.prototype.isAdjustCell=function(t){return t.preAdj||this.imb&&t===this.imb[0]},$.prototype.isAdjust=function(t){return t.preAdj||this.imb&&t===this.imb[0]},$.prototype.hh=function(t,e){var o,n;isNaN(e)||(this.imb||(this.imb={},this.jmb={}),o=this.imb[e],n=this.jmb[e],t&&!t.preAdj&&t!==o&&(o?n.nextAdj=t:this.imb[e]=t,t.preAdj=n,t.nextAdj=ht,this.jmb[e]=t))},$.prototype.Fj=function(t,e){var o,n,r;isNaN(e)||(o=this.imb&&this.imb[e],t&&(t.preAdj||t===o)&&(n=t.preAdj,r=t.nextAdj,n?n.nextAdj=r:this.imb[e]=r,r?r.preAdj=n:this.jmb[e]=n,t.preAdj=ht,t.nextAdj=ht))},$.prototype.Gj=function(t,e,o,n,r,i,a){this.Hj(t,I,e,o,n,r,i,a);var s=0,l=0,u=0,c=0;0===e&&(n&&r?u=o:n?s=o:r?c=o:l=o),h(t,I,e,o,0,0,0,0,n,r),f(t,I,e,o,n,r)},$.prototype.Hj=function(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I=this,N=I.imb;if(N){for(g={};N[0];)if(d=(l=(f=N[0]).ah).dUa(),p=l.getSource(),G(g,u=f.row,c=f.column))I.Fj(f,0);else{if(h=l.Kf(u,c))if(h=e.call(I,p,u,c,h,t,o,n,r,i,ct,a,s),m=l.Qf(u,c)){if(p===t&&(y=i?n:-n,r?o<=m.row&&(m.row+=y):o<=m.col&&(m.col+=y)),u===m.row&&c===m.col)if(m.isDynamicArray)l.fg(u,c,h,m,!0,R(r?u:c,o,d,t.id===p.id));else for(b=u;b<u+m.rowCount;b++)for(g[b]||(g[b]={}),v=c;v<c+m.colCount;v++)l.fg(b,v,h,m,b===u&&v===c,R(r?b:v,o,d,t.id===p.id)),W(g,b,v,!0)}else l.fg(u,c,h,m,!0,R(r?u:c,o,d,t.id===p.id));else(l.getRowExpression&&l.getRowExpression(u)||l.getColumnExpression&&l.getColumnExpression(c))&&l.Ag(u,c,1,1);I.Fj(f,0)}for(;N[1];)d=(l=(f=N[1]).ah).dUa(),u=f.row,l.getRowExpression&&(h=l.getRowExpression(u))&&l.fg&&(p=l.getSource(),l.fg(u,-1,e.call(I,p,u,-1,h,t,o,n,r,i),ct,!0,R(u,o,d,t.id===p.id))),I.Fj(f,1);for(;N[2];)d=(l=(f=N[2]).ah).dUa(),c=f.column,l.getColumnExpression&&(h=l.getColumnExpression(c))&&l.fg&&(p=l.getSource(),l.fg(-1,c,e.call(I,p,-1,c,h,t,o,n,r,i),ct,!0,R(c,o,d,t.id===p.id))),I.Fj(f,2);for(;N[3];)w=(C=N[3]).name,h=(l=C.ah).DTa(w),x=e.call(I,l.getSource(),0,0,h,t,o,n,r,i,{isNameID:!0}),l.gg(w,x),I.Fj(C,3);for(T in N)if(3<(A=+T)&&N.hasOwnProperty(T))for(;N[T];)M=(S=N[T]).ah,h=e.call(I,M,0,0,S.expression,t,o,n,r,i),M.setExpression(S.id,S.name,h),I.Fj(S,A)}},$.prototype.ph=function(t){H(t.getCalcSourceModel(),0,0,t.getRowCount(),t.getColumnCount()),this.Hj(t,u),h(t,u,0,0,0,0,0,0,!0,!1),f(t,u,0,0,!0,!1)},$.prototype.Ej=function(t,e,o,n,r,i,a,s,l,u,c){var h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P=this,L=Z,H=new z(e,o,n,r,i,a,s,l),B={};if(t&&function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g=e.Rj.getSheet()._modelManager.dUa();for(n=0;n<t.length;n++)if(r=t[n].validator,i=r.n5,a=V(i),s=a.r,l=a.c,u=t[n].sheet,c=u.yj(),h=r.condition(),(f=h.getExpressions())&&0<f.length){for(p=0;p<f.length;p++)d=f[p],f[p]=Z(c,s,l,d,e,o,{isDataValidator:!0});h.setExpressions(f,g)}}(t,H,u),_=H,O=u,J(U(F=e.getSheet()),function(t,e,o,n){return Z.call(this,t,o,n,e,_,O)},F._modelManager.dUa()),v={},y=P.imb){for(;y[0];)if(h=(f=y[0]).ah,p=f.row,d=f.column,m=h.dUa(),G(B,p,d))P.Fj(f,0);else{if(g=h.Kf(p,d),b=h.getSource(),g)if(C=ct,c&&c[p+", "+d]&&(b=e,C={crossSheetMoved:!0}),g=L.call(P,b,p,d,g,H,u,C),x=void 0,(w=h.Qf(p,d))&&!w.isDynamicArray)if(x=[(j=w).row,j.col,j.rowCount,j.colCount].join(","),p===w.row&&d===w.col)for(v[x]=!0,T=p;T<p+w.rowCount;T++)for(B[T]||(B[T]={}),A=d;A<d+w.colCount;A++)h.fg(T,A,g,w,T===p&&A===d,m),W(B,T,A,!0);else v[x]||(h.fg(p,d,g,w,!1,m),W(B,p,d,!0));else h.fg(p,d,g,w,!0,m);else(h.getRowExpression&&h.getRowExpression(p)||h.getColumnExpression&&h.getColumnExpression(d))&&h.Ag(p,d,1,1);P.Fj(f,0)}for(;y[1];)h=(f=y[1]).ah,p=f.row,m=h.dUa(),h.getRowExpression&&(g=h.getRowExpression(p))&&h.jg&&h.jg(p,L.call(P,b,p,-1,g,H,u),ct,m),P.Fj(f,1);for(;y[2];)h=(f=y[2]).ah,d=f.column,m=h.dUa(),h.getColumnExpression&&(g=h.getColumnExpression(d))&&h.kg&&h.kg(d,L.call(P,b,-1,d,g,H,u),ct,m),P.Fj(f,2);for(;y[3];)M=(S=y[3]).name,g=(h=S.ah).DTa(M),I=L.call(P,b,0,0,g,H,u),h.gg(M,I),P.Fj(S,3);for(N in y)if(3<(R=+N)&&y.hasOwnProperty(N))for(;y[N];)D=(E=(k=y[N]).ah).getSource(),g=L.call(P,D,0,0,k.expression,H,u),E.setExpression(k.id,k.name,g),P.Fj(k,R)}},$.prototype.Dj=function(t,e,o,n,r){var i,a,s,l,u,c=e+n,h=o+r;for(s=e;s<c;s++)for(l=o;l<h;l++)i=t.Yf(s,l),a=t.Kf(s,l),(i||a)&&(this.Fj(i,0),t.Q3(s,l,0),u=t.qg(s,l,!0),this.hh(u,0))},$.prototype.Ij=function(t,e,o){var n,r;for(n=e;-1!==n&&n<e+o;n++)(t.Yf(-1,n)||t.Kf(-1,n))&&(t.Q3(-1,n,2),r=t.sg(n,!0),this.hh(r,2))},$.prototype.Jj=function(t,e,o){var n,r;for(n=e;-1!==n&&n<e+o;n++)(t.Yf(n,-1)||t.Kf(n,-1))&&(t.Q3(n,-1,1),r=t.rg(n,!0),this.hh(r,1))},$.prototype.Kj=function(t){var e,o,n,r,i,a=t.Cf().getAllSourceModels();for(n=0;n<a.length;n++)if((r=a[n]).lmb)for(e=r.lmb(),i=0;i<e.length;i++)(o=e[i])&&o.isVolatile&&o instanceof lt.CellCalc&&!this.isAdjustCell(o)&&this.hh(o,0)},$.prototype.onBeforeAddRemoveRows=function(t,n,e){[t,e].forEach(function(t){if(t){var e=t.rC(),o=t.cC();t.Sg(n,0,e-n,o),t.Ug(n,e-n),H(t,n,-1,e-n,-1,!0)}})},$.prototype.onAfterAddRemoveRows=function(t,n,r,i,e,o){var a=this;[t,o].forEach(function(t){if(t){var e=t.rC(),o=t.cC();i?t.Ag(n,0,r,o):e+=r,a.Dj(t,n,0,e-n,o),a.Jj(t,n,e-n),a.Kj(t)}}),a.Gj(t.getSource(),n,r,!0,i,ct,e),t.Cf().autoCalculation&&t.Cf().recalculateAll(!1)},$.prototype.onAfterAddRemoveColumns=function(t,n,r,i,e,o){var a=this;[t,o].forEach(function(t){if(t){var e=t.rC(),o=t.cC();i?t.Ag(0,n,e,r):o+=r,a.Dj(t,0,n,e,o-n),a.Ij(t,n,o-n),a.Kj(t)}}),a.Gj(t.getSource(),n,r,!1,i,ct,e),t.Cf().autoCalculation&&t.Cf().recalculateAll(!1)},$.prototype.onBeforeAddRemoveColumns=function(t,n,e){[t,e].forEach(function(t){if(t){var e=t.rC(),o=t.cC();t.Sg(0,n,e,o-n),t.Wg(n,o-n),H(t,-1,n,-1,o-n,!0)}})},$.prototype.onAfterRemoveName=function(t,e){var o=t.wg(e,!1);o&&(o.updateListening(!0,!1),o.fh(),o.updateListeningOnRemoved())},$.prototype.adjustFormulaOnRemoveName=function(t,e,o){return p(t,e,o)},$.prototype.invalidName=function(t,e){var o;!e||(o=t.getCalcSourceModel().wg(e.toUpperCase(),!0))&&o.Yg()},$.prototype.onAfterRemoveTable=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p;for(a=0;a<t.length;a++)H((s=t[a]).source().getCalcSourceModel(),s.startRow(),s.startColumn(),s.endRow()-s.startRow()+1,s.endColumn()-s.startColumn()+1);if(l=this.imb)for(u={};l[0];)if(o=(c=l[0]).ah,G(u,n=c.row,r=c.column))this.Fj(c,0);else{if(i=o.Kf(n,r))if(i=$.adjustExpressionOnRemoveTable(i,t,n,r,e),(h=o.Qf(n,r))&&!h.isDynamicArray)for(h=L.kf(n,r,h.rowCount,h.colCount),f=n;f<n+h.rowCount;f++)for(u[f]||(u[f]={}),p=r;p<r+h.colCount;p++)o.fg(f,p,i,h,f===n&&p===r),W(u,f,p,!0);else o.fg(n,r,i,h,!0);else(o.getRowExpression&&o.getRowExpression(n)||o.getColumnExpression&&o.getColumnExpression(r))&&o.Ag(n,r,1,1);this.Fj(c,0)}},$.adjustExpressionOnRemoveTable=function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w=$.adjustExpressionOnRemoveTable;if(9===t.type){if(i=t.value,a=t.value2,s=w(i,e,o,n,r),l=a&&w(a,e,o,n,r),i!==s||a!==l)return lt.Kh(t.operatorType,s,l)}else if(7===t.type){for(u=!1,c=[],h=0;h<t.arguments.length;h++)p=w(f=t.arguments[h],e,o,n,r),u=u||f!==p,c.push(p);if(u)return lt.Jh(t,c)}else if(10===t.type){if((d=t.value)!==(g=w(d,e,o,n,r)))return lt.Lh(g)}else if(13===t.type)for(m=t,h=0;h<e.length;h++)if(m.baseTable===e[h])return r?lt.Ih:(y=m.getRange(-1===o?0:o,-1===n?0:n,!0),b=-1===o||1===m.referencePortions(),v=1===y.rowCount&&1===y.columnCount,C=m.source,v?lt.rf(C,ht,y.row,y.col,b,!1):lt.uf(C,ht,y.row,y.col,y.row+y.rowCount-1,y.col+y.colCount-1,b,!1,b,!1));return t},i=$,e.CalcOperatorAdjustor=i,lt.CalcService.prototype.uzb=function(){return new i},e.adjustFormulaOnMoveSwap=Z},"./dist/plugins/sheetsCalc/parser-sheets.js":function(t,g,e){"use strict";var o,n,B,V,P,L,d,r,i,m,z,W,u,a,s,l,y,p,c,h,f,b,v,C,w,x,T,A,S=this&&this.__extends||(v=function(t,e){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}v(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function M(t,e){var o=e+1;return t<0?t%o+o:e<t?t%o:t}function H(t){return new B.ErrorSource(t)}function G(t,e,o,n,r){var i,a,s=P.BAND_INDEX_CONST,l={cj:s,dj:s,ej:!0,fj:!0,gj:!1,li:0,Vka:!0},u=e?R(t,o,n,0):N(t,0,r);return u.hj?(l.cj=u.ij,l.ej=u.jj):(l.dj=u.ij,l.fj=u.jj),l.li=u.li,l.gj=u.gj,!u.gj||u.li>=t.length?l:!e&&u.hj||e&&!u.hj?{gj:!1}:(i=t[l.li],!e&&(B.isNumber(i)||"$"===i)||e&&("C"===i||"c"===i)?(a=e?R(t,o,n,l.li):N(t,l.li,r),l.li=a.li,!a.gj||!e&&!a.hj||e&&a.hj?l.gj=!1:(a.CLb&&(l.CLb=!0),l.li<t.length&&(l.Vka=!1),e?(l.dj=a.ij,l.fj=a.jj):(l.cj=a.ij,l.ej=a.jj),l.gj=!0),l):{gj:!1})}function I(t){return B.ei(t)||95===t.charCodeAt(0)}function N(t,e,o){var n,r,i,a,s,l,u,c,h,f={jj:!0,gj:!1},p=t.length;if(p<=e)return f;if("$"===t[e]&&(f.jj=!1,e++),p<=e)return f;if(r=0,i=t[n=e],a=!1,B.isNumber(i)&&"0"!==i){for(f.hj=!0;n<p&&B.isNumber(i);)++n<p&&(i=t[n]);if(n+1===p&&"#"===i&&o&&(a=!0),7<n-e)return f;for(s=n-1,l=0;e<=s;s--,l++)r+=(t[s].charCodeAt(0)-48)*y[l];if(r<=g.maxRowCount)return f.ij=r-1,f.li=a?p:n,f.CLb=a,f.gj=!0,f}else if(B.ei(i)){for(f.hj=!1;n<p&&B.ei(i);)++n<p&&(i=t[n]);if(3<n-e)return f;if(function(t,e,o){for(var n=t,r=e[t],i=!1;n<o&&!I(r);)++n<o&&(r=e[n]);if(n<o){for(;n<o&&I(r);)++n<o&&(r=e[n]);n<o&&(i=!0)}return i}(n,t,p))return f;for(r=0,c=u=n-1;e<=c;c--){if(!(65<=(h=t[c].charCodeAt(0))&&h<=90||97<=h&&h<=122))return f;r+=((32|h)-96)*m[u-c]}if(r<=g.maxColumnCount)return f.ij=r-1,f.li=n,f.gj=!0,f}return f}function R(t,e,o,n){var r,i,a,s,l,u={li:n,ij:P.BAND_INDEX_CONST,hj:!0,jj:!1,gj:!1},c=t.length;if(c<=n)return u;if("R"===(i=t[r=n])||"r"===i)u.hj=!0,a=e;else{if("C"!==i&&"c"!==i)return u;u.hj=!1,a=o}if(r++,c<=++n)return u.li=n,u.ij=a,u.jj=!0,u.gj=!0,u;if("["===(i=t[r])&&(n++,r++,u.jj=!0),c<=n)return u;if(s=!1,i=t[r],u.jj&&"-"===i&&(n++,r++,s=!0),c<=n)return u;if(i=t[r],!B.isNumber(i))return u.jj||(u.li=n,u.ij=a,u.jj=!0,u.gj=!0),u;for(;r<c&&B.isNumber(i);)++r<c&&(i=t[r]);if(l=parseInt(t.slice(n,r).join(""),10),u.jj){if(c<=r||"]"!==t[r])return u;r++}return l<(u.hj?g.maxRowCount:g.maxColumnCount)?(u.jj?(l=s?-l:l,u.ij=l+a):u.ij=l-1,u.li=r,u.gj=!0,u):void 0}function k(t,e,o,n){var r,i,a,s,l,u=t.source&&t.source._service,c=t.row||0,h=t.column||0,f=t.Eh;if(o.source===B.BangSource)n.push("!");else if(o.source&&!D(t,n,o.source,o.endSource))return void n.push("#","R","E","F","!");if(i=33===(r=o.type),8===r||5===r)n.push(""+o.value);else if(100===r)a="_xlpm.",o.bhc&&u.UIc?n.push(a+(""+o.value)):n.push(""+o.value);else if(o.value&&o._error)n.push(""+o.value);else if(i||o.sf()){if(l=a=s=void 0,i&&(a=(s=p[f?0:1]).prefix,l=s.surfix,n.push(a),o.isReferenceError))return n.push("#REF!"),void n.push(l);!o.source&&t.addSheetName&&t.source&&D(t,n,t.source,z),E(t.useR1C1,c,h,o.row,o.column,o.rowRelative,o.columnRelative,n),i&&n.push(l)}else!o.source&&t.addSheetName&&t.source&&D(t,n,t.source,z),function(t,e,o,n,r,i,a,s,l,u,c,h,f,p){3===(p=p||0)&&(r=0,a=t?t.getRowCount():g.maxRowCount-1,p=1),E(e,o,n,r,i,l,u,f,p);var d=P.BAND_INDEX_CONST;e&&r===a&&i===s&&(a===d||s===d)||a===d&&s===d||(f.push(":"),E(e,o,n,a,s,c,h,f,p))}(t.source,t.useR1C1,c,h,o.row,o.column,o.endRow,o.endColumn,o.rowRelative,o.columnRelative,o.endRowRelative,o.endColumnRelative,n,o.tf())}function E(t,e,o,n,r,i,a,s,l){var u,c,h,f,p;if(l=l||0,u=g.maxRowCount-1,(0===l||1===l)&&-u<n&&n<=2*u&&(n=M(n+=i?e:0,u)),c=g.maxColumnCount-1,(0===l||2===l)&&-c<r&&r<=2*c&&(r=M(r+=a?o:0,c)),h=n,f=r,3===(p=l)||0<=h&&0<=f||1===p&&0<=h||2===p&&0<=f)if(t){if(2!==l&&(s.push("R"),0<=n&&(e!==n||!i)&&(i?s.push("["+(n-e)+"]"):(n++,s.push(n+""))),r<0))return;1!==l&&(s.push("C"),o===r&&a||(a?s.push("["+(r-o)+"]"):(r++,s.push(r+""))))}else{if(0<=r&&(a||s.push("$"),s.push.apply(s,d(r+1).split(""))),n<0)return;n++,i||s.push("$"),s.push(n+"")}else s.push(""+B.Errors.Reference)}function D(t,e,o,n){if(t.getExternalSourceToken){if(o!==B.BangSource){var r=j(t,t.getExternalSourceToken(o).split(""),n&&t.getExternalSourceToken(n).split(""));if(!(0<r.length))return!1;e.push.apply(e,r)}return e.push("!"),!0}return!1}function j(t,e,o){if(!e||0===e.length||_(t,e)||_(t,o))return[];var n,r=e;if(F(e,!1)||o&&F(o,!1)){for(r=["'"],n=0;n<e.length;n++)"'"===e[n]&&r.push("'"),r.push(e[n]);if(o)for(r.push(":"),n=0;n<o.length;n++)"'"===o[n]&&r.push("'"),r.push(o[n]);r.push("'")}else if(o)for(r.push(":"),n=0;n<o.length;n++)r.push(o[n]);return r}function _(t,e){if(e&&0!==e.length&&t.Eh){var o="'"===e[0]?1:0;return"["===e[o]&&e.indexOf("]")>o}}function O(t,e){var o,n,r;if(!t||0===t.length)return!0;if(!e){if(B.isNumber(t[0]))return!1;if("RC"===(r=t.join("").toUpperCase())||"C"===r||"R"===r||s.test(r)||l.test(r)&&function(t){var e=t.search(/[0-9]/),o=t.substr(0,e),n=parseInt(t.substr(e),10);return(e<=2||3===e&&o<="XFD")&&n<=1048576}(r))return!1}for(n=0;n<t.length;n++)if(o=t[n],e){if("*"===o||":"===o||"["===o||"]"===o||"?"===o||"\\"===o||"/"===o)return!1}else if(a[o]||B.operaterTypesMap[o])return!1;return!0}function F(t,e){var o,n,r;return B.isDigit(+t[0])||(o=[],"["===(n=t)[0]&&(0<(r=t.lastIndexOf("]"))&&(o=t.slice(1,r),n=t.slice(r+1))),!function(t,e){var o,n;if(!t||0===t.length)return 1;for(n=0;n<t.length;n++)if(o=t[n],e){if("*"===o||":"===o||"["===o||"]"===o||"?"===o)return;if("'"===o&&(0===n||n>=t.length-1||"'"!==t[n+1]))return}else if("'"===o||"["===o||"]"===o||"?"===o||"%"===o||B.operaterTypesMap[o])return;return 1}(o)||!O(n,e))}function U(t){var e=new B.Expression(8);return e.value=t,e}function J(t){var e=t;return t&&3<=t.length&&"["===t[0]&&"0"===t[1]&&"]"===t[2]&&(e=3===t.length?"":t.substring(3)),e}function Z(t){var e=C.call(this,8e3)||this;return e.kj=t,e}function q(t,e,o,n,r){return 0===e.Nc&&0===e.hi||!n&&0===e.Nc&&4===e.hi&&(!r||o<t.length-2&&":"===t[o+1].ni&&0===t[o+2].Nc&&4===t[o+2].hi)}function K(t,e,o,n,r){return e<=t.startRow()&&o<=t.startColumn()&&e+n>t.endRow()&&o+r>t.endColumn()}function Y(t){var e=T.call(this,7900)||this;return e.kj=t,e}function Q(){return A.call(this,13)||this}function X(t,e,o){return t.slice(e,o).join("")}function $(t,e,o,n,r,i){var a,s,l,u,c,h,f=t,p=[],d="",g=!1,m=!1;if(1<r)g=!0,r--,p=e.slice(i,o),":"===(n=e[++o])&&(m="["===(n=e[++o]),d=(s=ot(e,o,n,r)).xj,o=s.tj,n=s.uj,r=s.wj);else if("["===n){for(m=!0,n=e[a=o-1];" "===n;)n=e[--a];":"!==n&&rt(),p=function(t){for(var e=t.length-1;0<=e&&" "===t[e];)e--;for(;0<=e&&" "!==t[e];)e--;return 0<=e?t.slice(e+1,t.length-e-1):t}(p=e.slice(i,a)),d=(s=ot(e,o,n=e[o],r)).xj,o=s.tj,n=s.uj,r=s.wj}else f.qj!==z&&16!==f.qj||(g=!0),0<(a=(l=e.slice(i,o)).indexOf(":"))?(p=l.slice(0,a),"["!==(d=l.slice(a+1))[0]&&rt()):p=l;if(u=tt(f,p,g),d?(c=tt(f,d,m),f.rj=4):(c=u,f.rj=2),c<u&&(h=u,u=c,c=h),f.oj=u,f.pj=c,++o<e.length)for(n=e[o];" "===n;)n=e[++o];return{tj:o,uj:n,wj:r}}function tt(t,e,o){var n,r,i,a;if(e&&function(t,e){var o,n,r;if(e)return 1;if(o="",o=t[0],"#"===(n=o)||"@"===o||" "===o||","===o||":"===o||"["===o||"]"===o)return;for(r=1;r<t.length;r++){if(","===(o=t[r])||":"===o||"["===o&&"'"!==n||"]"===o&&"'"!==n||"@"===o&&"'"!==n||"#"===o&&"'"!==n)return;n=o}return 1}(e,o)){for(n=[],r=0,i=e.length;r<i;r++)"'"===e[r]&&r<i-1&&r++,n.push(e[r]);return e=n,(a=t.lj.getColumnIndexInTable(e.join("")))<0&&rt(),a}return-1}function et(t){var e,o,n=[];for(o=0;o<t.length;o++)"["!==(e=t[o])&&"]"!==e&&"@"!==e&&"#"!==e&&"'"!==e||n.push("'"),n.push(e);return n}function ot(t,e,o,n){var r,i,a=!1;if("["===o)for(a=!0,n++,o=t[++e];" "===o;)o=t[++e];for(r=e;"]"!==o&&(","!==o||1<n);)"'"===o&&e++,o=t[++e];return e<=r&&rt(),i=t.slice(r,e),1<n&&n--,a||(i=function(t){for(var e,o=0,n=t.length;o<n&&" "===t[o];)o++;for(e=o,o=n-1;e<o&&" "===t[o];)o++;return e<=o?t.slice(e,o+1):t}(i)),{xj:i,tj:e,uj:o,wj:n}}function nt(t,e,o,n){for(var r,i,a,s=14,l=e;"]"!==o;)"'"===o&&e++,o=t[++e];for(r=function(t){var e,o=B.getMapping()&&B.getMapping().tableFunctionsMapping;if(!L.isNullOrUndefined(o))for(e in o)if(o[e].toLowerCase()===t)return e.toLowerCase();return t}(r=X(t,l,e).toLowerCase().trim()),i=!1,a=0;a<u.length;a++)if(r===u[a]){s=b[r],i=!0;break}if(i||rt(),++e>=t.length)n--;else{for(o=t[e];" "===o;)o=t[++e];if(","===o){for(n<=1&&rt(),o=t[++e];" "===o;)o=t[++e];"["===o&&(n++,o=t[++e])}1<n&&n--}return{vj:s,tj:e,uj:o,wj:n}}function rt(){throw i().Exp_FormulaInvalid}function it(t){return 1===t.Nc&&"ARRAY"===t.ni?1:0===t.Nc&&3===t.hi?(t.HTa||t.ni).length+2:0===t.Nc&&12===t.hi?t.ni.length+3:t.ni.length}function at(t,e,o){var n,r;t&&e&&((r=t[n=e.getName&&e.getName()||"!"])||(r=t[n]=[],t.sheets||(t.sheets=[]),t.sheets.push(n)),r.push(o))}function st(t,e,o,n,r,i){var a,s,l;if(t){for(;10===t.type;)t=t.value;if(12===t.type&&(t=t.value),!(2<=t.type&&t.type<=6))if(1===t.type)a=t.getRange(r,i),!n.source||t.source&&t.source!==n.source||e.push(a),at(o,t.source||n.source,a);else if(13===t.type)a=t.getRange(r,i),t.source===n.source&&a&&e.push(a),at(o,t.source||n.source,a);else if(8===t.type)s=W,t.source?t.source.Cf()&&(s=new B.EvaluateContext(t.source,B._createCellIdentity(r,i))):s=n,st(s.getName(t.value),e,o,s,r,i);else if(9===t.type)st(t.value,e,o,n,r,i),t.value2&&st(t.value2,e,o,n,r,i);else if(7===t.type)for(l=0;l<t.arguments.length;l++)st(t.arguments[l],e,o,n,r,i)}}Object.defineProperty(g,"__esModule",{value:!0}),o=e("Core"),n=e("@grapecity/js-sheets-common"),B=e("@grapecity/js-calc"),V=e("./dist/plugins/sheetsCalc/calc-spreadjs.js"),P=e("./dist/plugins/sheetsCalc/calc.ns.js"),L=e("./node_modules/util/util.js"),d=o.util.xq,r=new n.Common.ResourceManager(o.SR),i=r.getResource.bind(r),B.Errors.Reference,g.maxRowCount=1048576,g.maxColumnCount=16384,m=[1,26,676],u=["#all","#data","#headers","#totals","#this row"],a={" ":!(W=null),"'":!(z=void 0),"[":!0,"]":!0,"?":!0,"\\":!0,"%":!0,'"':!0,"(":!0,")":!0,"|":!0,"{":!0,"}":!0,"#":!0,"@":!0,"!":!0,$:!0,"^":!0,"（":!0,"）":!0,".":!0,";":!0},s=/^(R|C|RC)?(0*[1-9]\d*)/,l=/^[A-z]{1,3}0*[1-9]\d{0,6}$/,y=[1,10,100,1e3,1e4,1e5,1e6,1e6],p=[{prefix:"ANCHORARRAY(",surfix:")"},{prefix:"",surfix:"#"}],g.jma=O,g.validateSheetName=O,C=B.TokenResolver,S(Z,C),Z.prototype.resolveToken=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R=t.useR1C1,k=t.row||0,E=t.column||0,D=o.length,j=o[n],_=j.ni,O=j.Nc,F=j.hi;if(0!==O&&6!==F)return!1;if(0===O&&0===F&&n<D-2&&":"===o[n+1].ni&&12===o[n+2].hi&&o[n+2].ni.indexOf(":")<0||0===O&&12===F){if(u=l=void 0,_&&(0<_.indexOf(":")?(c=_.indexOf(":"),l=_.substring(1,c-1),u=_.substring(c+1,_.length-2)):("'"===(l=_).charAt(0)&&(l=l.substring(1,l.length-1)),0===F&&"'"===(u=o[n+2].ni).charAt(0)&&(u=u.substring(1,u.length-1)))),n++,s=!!l,(l=J(l))&&(i=(i=_?t.getExternalSource("",l):B.BangSource)||H(l),(u=J(u))&&(a=(a=t.getExternalSource("",u))||H(u),n+=2)),(j=o[n])&&"["===j.Qb[0])return!1;if(!j)return U(_);_=j.ni}if(h=n===D-1?W:o[n+1],q(o,j,n,R,!0)){if(f=t&&t.source&&t.source._service&&t.source._service.allowDynamicArray,!(p=G(j.Qb,R,k,E,f)).gj&&!s)return!1;if(j.hi=7,p.gj&&p.Vka){if(d=p.cj,g=p.dj,m=p.ej,y=p.fj,b=p.CLb,n<D-2&&5===h.Nc&&":"===h.ni&&q(o,h=o[n+2],n+2,R,!1)&&(v=G(h.Qb,R,k,E)).gj&&d===P.BAND_INDEX_CONST==(v.cj===P.BAND_INDEX_CONST)&&g===P.BAND_INDEX_CONST==(v.dj===P.BAND_INDEX_CONST))return k=d===P.BAND_INDEX_CONST?0:k,E=g===P.BAND_INDEX_CONST?0:E,{index:n+3,expr:B.uf(i,a,d-(m?k:0),g-(y?E:0),v.cj-(v.ej?k:0),v.dj-(v.fj?E:0),m,y,v.ej,v.fj,k,E)};if(d===P.BAND_INDEX_CONST||g===P.BAND_INDEX_CONST){if(R)return d-=d!==P.BAND_INDEX_CONST&&m?k:0,g-=g!==P.BAND_INDEX_CONST&&y?E:0,{index:n+1,expr:B.uf(i,a,d,g,d,g,m,y,m,y,k,E)};if(!i)return!1;r=U(_)}if(!r)return L.isNullOrUndefined(i)&&(x=k,T=E,(N=t.source)&&(S=N.q$a,M=N.cDc,I=N.dDc,!S||(0<=x&&x<M&&I<=T||M<=x&&0<=T&&T<I)&&(A=N)),i=A),C=d-(m?k:0),w=g-(y?E:0),{index:n+1,expr:r=b?B.BLb(t.source,i,a,C,w,m,y):B.rf(i,a,C,w,m,y)}}else r=U(_)}else if(6===j.hi)(r=new B.Expression(5)).value=B.CalcError.parse(j.ni);else{if(!i)return!1;r=U(_)}return i&&(r.source=i),a&&(r.endSource=a),{index:n+1,expr:r}},Z.prototype.unparse=function(t,e,o,n){var r=o&&o.type;return(1===r||8===r||5===r||33===r||100===r)&&(k(t,0,o,n),!0)},g.SheetReferenceResolver=Z,(x=c=g.StructReferencePortions||(g.StructReferencePortions={}))[x.ThisRow=1]="ThisRow",x[x.Headers=2]="Headers",x[x.Data=3]="Data",x[x.Totals=8]="Totals",x[x.HeadersAndData=6]="HeadersAndData",x[x.DataAndTotals=12]="DataAndTotals",x[x.All=14]="All",x[x.NotSpecific=16]="NotSpecific",(w=h=g.StructReferenceColumnSpecifier||(g.StructReferenceColumnSpecifier={}))[w.All=1]="All",w[w.NotSpecific=1]="NotSpecific",w[w.SingleColumn=2]="SingleColumn",w[w.ColumnRange=4]="ColumnRange",A=B.Expression,S(Q,A),Q.prototype.tableName=function(){return this.lj.tableName()},Object.defineProperty(Q.prototype,"baseTable",{get:function(){return this.lj},set:function(t){this.lj=t,this.source=t.source()},enumerable:!0,configurable:!0}),Q.prototype.JUa=function(){this.vzb=this.lj.startColumn()},Q.prototype.columnReferenceStart=function(){return this.oj+this.lj.startColumn()},Q.prototype.columnReferenceEnd=function(){return this.pj+this.lj.startColumn()},Q.prototype.referencePortions=function(){return this.qj},Q.prototype.referenceColumnSpecifier=function(){return this.rj},Q.prototype.getRange=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d=this.lj;switch(this.JUa(),u=d.startRow(),c=d.endRow(),h=d.hasTotalsRow(),f=d.hasHeadersRow(),this.qj){case 3:case 16:n=f?u+1:u,i=h?c-1:c;break;case 2:if(f)i=n=u;else{if(!o)return W;i=n=u-1}break;case 8:if(h)i=n=c;else{if(!o)return W;i=n=c+1}break;case 1:i=n=t;break;case 6:n=u+(o&&!f?-1:0),i=h?c-1:c;break;case 12:n=f?u+1:u,i=c+(o&&!h?1:0);break;case 14:default:n=u+(o&&!f?-1:0),i=c+(o&&!h?1:0)}return r=this.columnReferenceStart(),a=this.columnReferenceEnd(),p=d.endColumn(),1===this.rj&&(a=p),p<r||p<a?(this._error=!0,W):i<n||!o&&n<u||!o&&c<i?W:(s=i-n+1,l=a-r+1,B.qf(n,r,s,l))},Q.prototype.offsetWhenInsertRemoveColumn=function(t,e,o,n){var r,i,a=this.vzb;return t<a||t===a&&o&&!n||t>this.pj+a?this:(e=o?e:-e,r=t-a,(i=new Q).baseTable=this.lj,i.pj=this.pj+e,i.oj=this.oj,t<=a+this.oj&&(i.oj+=e,i.oj<r&&(i.oj=r)),i.rj=this.rj,i.qj=this.qj,i.pj<i.oj?B.Ih:i)},Q.prototype.offsetWhenCopy=function(t,e,o,n,r,i,a,s,l,u){var c,h,f,p,d,g=new V.SheetParserContext(e.kj,e._service.useR1C1,B._createCellIdentity(o,n)),m=g.getTableByIndex(o,n),y=this.offset();return m&&(c=o-r,h=n-i,f=a-r,p=s-i,d=void 0,(d=t===e?g.getTableByIndex(c,h):new V.SheetParserContext(t.kj,t._service.useR1C1,B._createCellIdentity(c,h)).getTableByIndex(c,h))!==m&&d===this.lj&&K(d,f,p,l,u)&&K(m,a,s,l,u)&&(y.baseTable=m)),y},Q.prototype.Jma=function(t){var e,o=new Q;return o.baseTable=this.lj,o.pj=this.pj,o.oj=this.oj,2===this.rj&&t&&(t%=e=this.lj.endColumn()-this.lj.startColumn()+1,o.oj+=t,o.oj<0&&(o.oj+=e),o.pj=o.oj),o.rj=this.rj,o.qj=this.qj,o},Q.prototype.offset=function(t,e,o){var n=new Q;return n.baseTable=this.baseTable,n.qj=this.qj,n.oj=this.oj,n.pj=this.pj,n.rj=this.rj,n},Q.prototype.Kma=function(t,e){var o=this.lj;return t>=o.startRow()&&e>=o.startColumn()&&t<=o.endRow()&&e<=o.endColumn()},Q.prototype.tzb=function(t,e,o){this.lj.wzb(t,e,o)},f=Q,g.xzb=f,T=B.TokenResolver,S(Y,T),Y.prototype.resolveToken=function(t,e,o,n){var r,i,a,s,l,u=o[n],c=o[n+1];if(0===u.Nc){if(i=r=void 0,0===u.hi||7===u.hi)r=u.ni;else{if(12!==u.hi||!c||0!==c.Nc||0!==c.hi||"["!==c.Qb[0])return W;"'"===(a=u.ni)[0]&&(a=a.substr(1,a.length-2)),r=a+c.ni,i=!0}if("]"===r.charAt(r.length-1))try{return s=new f,function(t,e,o){var n,r,i,a,s,l,u,c,h,f=o,p=0,d=e[p],g=function(t,e,o,n){for(var r,i,a=e.length;"["!==n&&o<a;)n=e[++o];return{sj:0<(i=o)?(r=X(e,0,i),t.getTableByName(r)):t.getTableByIndex(t.row,t.column),tj:o,uj:n}}(t,e,p,d),m=g.sj;for(m||rt(),f.baseTable=m,p=g.tj,d=e[++p],n=p;" "===d;)d=e[++p];for("@"!==d&&"["!==d&&(d=e[p=n]),a=i=!(r=1),s=e.length;0!==r&&p<s;)if("["===d&&(r++,d=e[++p]),"#"===d)i&&r<=1&&rt(),l=nt(e,p,d,r),u=l.vj,p=l.tj,d=l.uj,r=l.wj,i?2===f.qj&&3===u||2===u&&3===f.qj?f.qj=6:3===f.qj&&8===u||3===u&&8===f.qj?f.qj=12:rt():f.qj=u,i=!0;else if("@"===d){for((1<r||i)&&rt(),i=!0,f.qj=1,d=e[++p];" "===d;)d=e[++p];","===d&&rt()}else{for(c=p;!L.isNullOrUndefined(d)&&"]"!==d&&"["!==d;)if("'"===d&&p++,","===d){for(d=e[++p],h=p;" "===d;)d=e[++p];if("["===d){p=h,d=",";break}}else d=e[++p];if(c<p&&((a||"["===d&&1<r)&&rt(),l=$(f,e,p,d,r,c),p=l.tj,d=l.uj,r=l.wj,a=!0),"]"===d){if(0==--r)break;p>=e.length&&rt(),d=e[++p]}","===d&&(d=e[++p])}i||(f.qj=t.DLb?1:16),a||(f.oj=0,f.pj=f.lj.endColumn()-f.lj.startColumn(),f.rj=1)}(t,r.split(""),s),i?{index:n+2,expr:s}:s}catch(t){}else if(l=t.getTableByName&&t.getTableByName(r))return Y.create(l)}return W},Y.prototype.unparse=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p;return 13===o.type&&(i=(r=o).lj.KXc,a=L.isNullOrUndefined(i)?r.lj.tableName():i,t.YSa?(s=r.getRange(t.row,t.column,!0),k(t,0,B.uf(r.source,W,s.row,s.col,s.row+s.rowCount-1,s.col+s.colCount-1,!1,!1,!1,!1),n),!0):16===r.qj&&1===r.rj?(n.push(a),void(t.Eh&&n.push("[]"))):(u=n.length,t.source===r.lj.source()&&r.Kma(t.row,t.column)&&!t.Eh||(c=L.isNullOrUndefined(i)?r.lj.tableName():i,g.validateSheetName(c.split(""))||(c=j(t,c.split(""),null).join("")+"!"),n.push(c)),n.push("["),16!==r.qj&&(h=function(t,e,o){var n=B.getMapping()&&B.getMapping().tableFunctionsMapping,r=B.sR().B2,i=n?n["#All"]:r.All.name,a=n?n["#This row"]:r.thisRow.name,s=n?n["#Headers"]:r.Headers.name,l=n?n["#Data"]:r.Data.name,u=n?n["#Totals"]:r.Totals.name;switch(t){case 1:return o?"["+a+"]":"@";case 2:return e?"["+s+"]":s;case 3:return e?"["+l+"]":l;case 8:return e?"["+u+"]":u;case 6:return"["+s+"], ["+l+"]";case 12:return"["+l+"], ["+u+"]"}return e?"["+i+"]":i}(r.qj,1!==r.rj,t.Eh),n.push(h)),1!==r.rj&&(1===r.qj&&!t.Eh||16===r.qj||n.push(", "),(f=r.lj.getColumnName(r.oj))?f=et(f.split("")).join(""):l=!0,l||(4===r.rj?(p=r.lj.getColumnName(r.pj))?(p=et(p.split("")).join(""),n.push("[",f,"]:[",p,"]")):l=!0:1===r.qj&&!t.Eh&&!function(t){var e,o="";if("#"===(o=t[0])||" "===o||"@"===o||" "===o||","===o||":"===o||"["===o||"]"===o)return 1;for(e=1;e<t.length;e++)if(" "===(o=t[e])||","===o||":"===o||"["===o||"]"===o||"@"===o||"#"===o)return 1}(f)||16===r.qj?n.push(f):n.push("[",f,"]"))),l?(n.length=u,n.push("#REF!")):n.push("]"),!0))},Y.create=function(t,e,o,n,r){void 0===e&&(e=c.NotSpecific),void 0===o&&(o=h.NotSpecific),void 0===n&&(n=0),void 0===r&&(r=t.endColumn()-t.startColumn());var i=new f;return i.baseTable=t,i.qj=e,i.oj=n,i.pj=r,i.rj=o,i},g.StructureReferenceResolver=Y,b={"#all":14,"#data":3,"#headers":2,"#totals":8,"#this row":1},g.qzb=function(t,e,o,n,r,i,a){var s,l,u;t.setParserOption(i),s=[],l=e.split("");try{u=o.yj().getParserContext(!a&&o.Cf().useR1C1,B._createCellIdentity(n,r),W),s=t.parseToTokens(u,l,!1)}catch(t){}return function(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S=z,M=n.yj(),I=n.Cf();for(I?(s=new V.SheetParserContext(n,!a&&I.useR1C1,B._createCellIdentity(r,i)),S=new B.EvaluateContext(M,B._createCellIdentity(r,i),!1)):s=new B.ParserContext(W,!1,B._createCellIdentity(0,0)),s.ignoreError=!0,l=[],c=0;c<e.length;c++)try{if("["===(u=e[c]).ni||"#"===u.Qb[0]||3===u.hi){l.push({text:u.HTa||u.ni,type:u.Nc,subType:u.hi,canDrag:!1,ranges:u.ranges,value:u.ni});continue}if(N=t,R=s,D=h=[],L=P=F=O=_=j=void 0,H=(k=e)[E=c],c=H&&"function"!=typeof H&&0===H.Nc?(j=[],_=N.resolveToken(R,k,j,E)-1,1===(F=(O=j[0]).type)||13===F||33===F||8===F||5===F&&O.source?(P=k[_],L={mi:H.mi,li:P.li,Lf:O},D.push(L),_):E):E,f=void 0,0<h.length){for(p=0;p<h.length;p++)if((d=h[p])instanceof B.FormulaToken)l.push({text:o.slice(d.mi,d.li+1).join(""),type:d.Nc,subType:d.hi,canDrag:f,ranges:[],value:d.ni});else if(d.Lf){if(g=d.Lf,m=g.type,y=g.source,b=o.slice(d.mi,d.li+1).join(""),v=[],C={},f=!0,w=g.getRange&&g.getRange(r,i),8===m)f=!1,S&&(x=S,g.source&&(x=new B.EvaluateContext(g.source,B._createCellIdentity(r,i),!1)),st(x.getName(g.value),v,C,S,r,i));else if(13===m)f=!1,y===M&&w?v.push(w):v=null,at(C,y,w);else if(33===m)(y||g.contextSource)===M&&(w=w||B.getRangeForReference(g,r,i),v.push(w),y=y||M),at(C,y,w);else if(1===m)if(g.endSource)for(T=g.endSource,A=y.getSources(T),p=0;p<A.length;p++){if(A[p]===M){v.push(w);break}at(C,A[p],w)}else at(C,y||M,w),y&&y!==M||v.push(w);else v=null;v&&0<v.length?l.push({text:b,type:0,subType:7,canDrag:f,ranges:v,value:b,sheetRanges:C}):l.push({text:b,type:u.Nc,subType:u.hi,canDrag:f,ranges:v,value:b,sheetRanges:C})}}else l.push({text:u.ni,type:u.Nc,subType:u.hi,canDrag:!1,ranges:u.ranges,value:u.ni})}catch(t){l.push({text:u.ni,type:u.Nc,subType:u.hi,canDrag:!1,ranges:u.ranges,value:u.ni})}var N,R,k,E,D,j,_,O,F,P,L,H;return l}(t,s=function(t,e){var o,n,r,i,a,s,l,u,c,h;for(t.unshift(new B.FormulaToken("=",1,0,0,0)),i=[],a=0,r=t.length-1;0<r;r--)t[r].mi===t[r-1].mi&&t[r].ni===t[r-1].ni||(i[a]=t[r],a++);for(i[a]=t[r],i.reverse(),s=[],u=l=0;u<i.length-1;u++,l++)n=it(i[u]),s[l]=i[u],0<i[u+1].mi-i[u].mi-n&&(o=new B.FormulaToken(e.slice(i[u].mi+n,i[u+1].mi),7,i[u].mi+n),s[++l]=o);for(s[l]=i[u],n=it(s[l]),0<s.length&&e.length>s[l].mi+n&&(o=new B.FormulaToken(e.slice(s[l].mi+n,e.length),7,s[l].mi+n),s[l+1]=o),c=0;c<s.length;c++)h=s[c].ni.trim(),3===s[c].hi?s[c].ni='"'+s[c].ni+'"':"("===h||"{"===h?(s[c].Nc=1,s[c].hi=1):")"!==h&&"}"!==h||(s[c].Nc=1,s[c].hi=2);return s}(s,l),l,o,n,r,a)}},"./dist/plugins/sheetsCalc/sheetsCalc.entry.js":function(t,o,e){"use strict";function n(t){for(var e in t)o.hasOwnProperty(e)||(o[e]=t[e])}Object.defineProperty(o,"__esModule",{value:!0}),n(e("./dist/plugins/sheetsCalc/calc.ns.js")),n(e("./dist/plugins/sheetsCalc/parser-sheets.js")),n(e("./dist/plugins/sheetsCalc/calc-spreadjs.js")),n(e("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js")),n(e("./dist/plugins/sheetsCalc/worksheet-formula.js")),e("./dist/plugins/sheetsCalc/workbook-formula.js")},"./dist/plugins/sheetsCalc/workbook-formula.js":function(t,e,o){"use strict";var f,A,n,r,i,h,a,p,s,d,l;Object.defineProperty(e,"__esModule",{value:!0}),f=o("Core"),A=o("Core"),n=o("@grapecity/js-sheets-common"),r=o("@grapecity/js-calc"),i=o("./dist/plugins/sheetsCalc/calc-spreadjs.js"),h=o("./dist/plugins/sheetsCalc/calc-spreadjs.js"),a=i.SpreadSource,p=n.Common.u.Nb,s=new n.Common.ResourceManager(f.SR),d=s.getResource.bind(s),n.Common.j,(l=f.Workbook.prototype).qv=function(t){var e=this,o=e.Wu;e.Wu=new r.CalcService,e.Wu.useR1C1=1===e.options.referenceStyle,e.Wu.allowDynamicArray=e.options.allowDynamicArray,e.Wu.iterativeCalculation=e.options.iterativeCalculation,e.Wu.iterativeCalculationMaximumIterations=e.options.iterativeCalculationMaximumIterations,e.Wu.iterativeCalculationMaximumChange=e.options.iterativeCalculationMaximumChange,t&&o&&e.Wu.cloneFrom(o),e.yv=new a(e),e.zv=e.Wu.getGlobalSourceModel(e.yv)},l.addCustomFunction=function(t){this.Xu(t)},l.Xu=function(t){if(!(t&&t instanceof r.Functions.Function))throw Error(d().Exp_InvalidCustomFunction);this.Su[p(t.name)]=t},l.getCustomFunction=function(t){return t?this.Su[p(t)]:void 0},l.removeCustomFunction=function(t){t&&(delete this.Su[p(t)],this.iK())},l.clearCustomFunctions=function(){this.Su={}},l.addCustomName=function(t,e,o,n,r){this.Yu(this.Tu,t,e,o,n,!1,r)},l.H$a=function(t){return!this.Tu[p(t)]},l.isValidCustomName=function(t){return t&&f.Ul.G$a(t)&&this.H$a(t)},l.Yu=function(t,e,o,n,r,i,a){var s,l,u,c;if(!e||!o||!i&&!this.isValidCustomName(e))throw Error(d().Exp_InvalidCustomName);if(this.Wu){if(l=(s=f.sJc(this))?s.yj():null,u=void 0,i)try{u=this.Wu.parse(l,o,n,r,!1,!1,!0)}catch(t){}else u=this.Wu.parse(l,o,n,r);t[p(e)]=new h.NameInfo(e,u,n,r,a),i||((c={})[e]=e,this.Zu(c,!0))}},l.getCustomName=function(t){return t?this.Tu[p(t)]:void 0},l.aJb=function(t){return t?this.QHb[p(t)]:void 0},l.getCustomNames=function(){var o=[];return f.GC$.each(this.Tu,function(t,e){o.push(e)}),o},l.ELb=function(){var o=[];return f.GC$.each(this.QHb,function(t,e){o.push(e)}),o},l.removeCustomName=function(t){if(t){delete this.Tu[p(t)];var e={};e[t]=t,this.Zu(e,!1)}},l.RHb=function(t){if(t){delete this.QHb[p(t)];var e={};e[t]=t,this.Zu(e,!1)}},l.clearCustomNames=function(){var t=this.Tu;this.Tu={},this.Zu(t,!1)},l.FLb=function(){var t=this.QHb;this.QHb={},this.Zu(t,!1)},l.Zu=function(t,e){var o,n;if(t){for(n in o=this.zv,t)o&&o.updateNameCalc(n,e);this.iK()}},l.iK=function(){if(this.Wu&&!this.Wu.IsSuspended()){var t=this.getActiveSheet();t&&(t.suspendPaint(),this.Wu.recalculateAll(),t.resumePaint())}},l.getCalcService=function(){return this.Wu},l.Cf=function(){return this.Wu},l.suspendCalcService=function(t){this.Wu&&this.Wu.suspend(t)},l.resumeCalcService=function(t){this.Wu&&this.Wu.resume(t)},l.getCircularReference=function(){var t,e,o,n=this.chc();for(e in t=[],n=this.dhc(n))Object.prototype.hasOwnProperty.call(n,e)&&(o=e.split("\\"),t.push({row:+o[1],col:+o[2],rowCount:1,colCount:1,sheetName:o[0]}));return t},l.chc=function(){var f={};return this.sheets.forEach(function(t){var e,o,n,r,i,a,s,l=t.Bj(),u=t.getRowCount(),c=t.getColumnCount(),h=t.name();if(l)for(e=0;e<u;e++)for(o=0;o<c;o++)for(n=h+"\\"+e+"\\"+o,r=t.VXc(e,o),!f[n]&&0<r.length&&(f[n]={from:[],to:[]}),i=0;i<r.length;i++)s=(a=r[i]).sheetName+"\\"+a.row+"\\"+a.col,f[s]||(f[s]={from:[],to:[]}),f[s].from.push(n),f[n].to.push(s)}),f},l.dhc=function(o){var n,t,e;function r(t,e){t.splice(t.indexOf(e),1)}for(n=!0;0<Object.keys(o).length&&n;)for(e in n=!1,t=function(e){if(Object.prototype.hasOwnProperty.call(o,e)){var t=o[e];0===t.from.length?(t.to.forEach(function(t){r(o[t].from,e)}),delete o[e],n=!0):0===t.to.length&&(t.from.forEach(function(t){r(o[t].to,e)}),delete o[e],n=!0)}},o)t(e);return o},f.Workbook.$n("calc",{priority:1e3,init:function(){this.Su={},this.Tu={},this.QHb={}},toJson:function(t){var l,u,e,o,c,n,h,r=this.Su;f.GC$.isEmptyObject(r)||(t.customFunctions=r),l=[],u=[],e=this.getCustomNames(),o=this.ELb(),c=this.Wu,n=this.getActiveSheet(),h=n?n.yj():null,e&&c&&(f.GC$.each(e,function(t,e){var o,n=e.getName(),r=e.getRow(),i=e.getColumn(),a=e.getExpression(),s=e.getComment();a&&(o={name:n,formula:c.unparse(h,a,r,i,!1,!0),row:r,col:i},s&&(o.comment=s),l.push(o))}),f.GC$.each(o,function(t,e){var o,n=e.getName(),r=e.getRow(),i=e.getColumn(),a=e.getExpression(),s=e.getComment();a&&(o={name:n,formula:c.unparse(h,a,r,i,!1,!0),row:r,col:i},s&&(o.comment=s),u.push(o))}),0<l.length&&(t.names=l),0<u.length&&(t.formatStringNames=u))},fromJson:function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T=this.Wu;if(T&&T.suspend(),this.clearCustomNames(),n=t.names)for(r=0;r<n.length;r++)i=n[r],this.Yu(this.Tu,i.name,i.formula,i.row,i.col,!0,i.comment);if(this.FLb(),a=t.formatStringNames)for(r=0;r<a.length;r++)i=a[r],this.Yu(this.QHb,i.name,i.formula,i.row,i.col,!0,i.comment);if(this.clearCustomFunctions(),s=t.customFunctions)for(l in s)s.hasOwnProperty(l)&&(u=s[l],(c=A.getTypeFromString(u.typeName))&&((h=new c).fromJSON(u,e),this.Xu(h)));if(g=[],d=t.sheets){for(y in f=0,d)"string"==typeof y&&(b=d[y],p=this.getSheetFromName(b.name||y),g.push(p),p.nameFunctionsFromJSON(b,e,o),f++);for(m=g.length,f=0;f<m;f++)(p=g[f]).yj().q$a=!0,p.formulaFromJSON(d[p.name()],e,o)}for(v=t.noRecalc||o&&o.doNotRecalculateAfterLoad,T&&(v?T.resumeWithoutCalc():T.resume(!0)),C=0,w=g;C<w.length;C++)(x=(p=w[C]).yj()).HIb(),delete x.q$a},egc:function(a,t,s){var e,o,n,r,i,l,u,c,h,f,p,d,g,m,y,b=this,v=b.Wu;if(v&&v.suspend(),b.clearCustomNames(),e=a.names)for(o=0;o<e.length;o++)n=e[o],b.Yu(this.Tu,n.name,n.formula,n.row,n.col,!0,n.comment);if(b.clearCustomFunctions(),r=a.customFunctions)for(i in r)r.hasOwnProperty(i)&&(l=r[i],(u=A.getTypeFromString(l.typeName))&&((c=new u).fromJSON(l,t),b.Xu(c)));if(p=a.sheets,d=[],p){for(m in h=0,p)"string"==typeof m&&(y=p[m],f=b.getSheetFromName(y.name||m),d.push(f),f.nameFunctionsFromJSON(y,t,s),h++);for(g=d.length,h=0;h<g;h++)(f=d[h]).yj().q$a=!0,f.formulaFromJSON(p[f.name()],t,s)}s.incrementLoadTask.addTask(function(t,e,o){var n,r,i;for(v&&(a.noRecalc||s&&s.doNotRecalculateAfterLoad?v.resumeWithoutCalc():(v.resume(!0),b.getActiveSheet().$p())),n=0,r=d;n<r.length;n++)(i=(f=r[n]).yj()).HIb(),delete i.q$a},[v,a,s])}})},"./dist/plugins/sheetsCalc/worksheet-formula.js":function(t,e,o){"use strict";var y,f,n,P,c,k,L,g,h,r,b,v,u,i;function C(t){return t.Cf()}function a(){var t=this;return t.Ru?void(t.Ru=!1):(t.Su={},t.Tu={},t.eDc?t.eDc.clearAll():t.fDc=new c.SheetSource(t,y.SheetArea.colHeader),t.gDc?t.gDc.clearAll():t.hDc=new c.SheetSource(t,y.SheetArea.rowHeader),void(t.et?t.et.clearAll():t.ft=new c.SheetSource(t,y.SheetArea.viewport)))}function w(t,e,o,n,r,i){var a=t.Ms(e,o,n,r,i),s=a&&a.formulas;return s&&0<s.length}function x(t,e,o,n,r,i){var a,s=n.yj(),l=t&&t.formula;l&&(l=l.replace(/ANCHORARRAY\(([A-Z]+[0-9]+)\)/gi,"$1#").replace(/SINGLE\((.*)\)/gi,"@$1").replace(/ANCHORARRAY\((#[A-Z]+[\?!])\)/gi,"$1#"),(a=t.arrayInfo)&&!a.isDynamicArray?n.bv(e,o,u(a.rowCount,10),u(a.colCount,10),l,!0,i):(a&&a.isInvalid&&s.GIb(e,o),n._u(e,o,l,L,!0,i,!0,!a)))}function T(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m,y=r&&r.incrementLoadTask;if(y&&!y.isTerminated){for(s=y.isBusyFunc,l=i=i||0,t.suspendPaint(),u=new Date;l<o;){if(c=e[l])for(h=0;h<n;h++)x(c[h],l,h,t,0,a);if(l++,s&&s())break;if(30<new Date-u)break}t.resumePaint(),(f=(r=r||{})&&r.incrementalLoading)&&f.loading&&(f.loadStatus.formulaLoad+=l-i,d=f.loadStatus,g=r.doNotRecalculateAfterLoad,m=d.formulaLoad/d.total,p=g?.4*m+.5:.3*m+.4,f.loading(p,{sheet:t})),l<o&&r.incrementLoadTask.pushTask(T,[t,e,o,n,r,l])}}function p(n,r,i,a){var t=y.Worksheet._features;t&&g(t,function(t,e){var o=e.fromJsonAfterFormula;o&&o.call(n,r,i,a)})}function A(n,r,i,a,s){var t,l,u,c,e,o,h,f,p,d=!a&&n._modelManager.dUa();if(n.parent&&n.parent.sheets)for(c=n.parent.sheets,e=n.parent.getCustomNames(),o=n.parent.ELb(),h=!v(n.parent.AO)&&n.parent.aXc(),e&&g(e,function(t,e){l=e.getExpression(),(u=H(null,n,r,i,a,s,l))!==l&&e.fg(u,d)}),o&&g(o,function(t,e){l=e.getExpression(),(u=H(null,n,r,i,a,s,l))!==l&&e.fg(u,d)}),h&&g(h,function(t,e){l=e.getExpression(),(u=H(null,n,r,i,a,s,l))!==l&&e.fg(u,d)}),f=function(o){(t=c[o].getCustomNames())&&g(t,function(t,e){l=e.getExpression(),(u=H(c[o],n,r,i,a,s,l))!==l&&e.fg(u,d)})},p=0;p<c.length;p++)f(p);else(t=n.getCustomNames())&&g(t,function(t,e){l=e.getExpression(),(u=H(n,n,r,i,a,s,l))!==l&&e.fg(u,d)})}function H(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O=e.yj(),F=P.Hh(P.Errors.Reference,O);if(9===a.type){if(l=a.value,u=a.value2,c=H(t,e,o,n,r,i,l),h=u&&H(t,e,o,n,r,i,u),l!==c||u!==h)return P.Kh(a.operatorType,c,h)}else if(7===a.type){for(f=!1,p=[],d=void 0,g=0;g<a.arguments.length;g++)m=H(t,e,o,n,r,i,d=a.arguments[g]),f=f||d!==m,p.push(m);if(f)return P.Jh(a,p)}else if(1===a.type&&a.sf()){if(s=a.source||t&&t.yj(),v=y=a.row,C=b=a.column,s&&s===O&&(i&&!a.rowRelative||!i&&!a.columnRelative)){if(i&&r)y+=o<=y?n:0;else if(!i&&r)b+=o<=b?n:0;else if(i){if(o+n<=y)y-=n;else if(o<=y)return F}else if(o+n<=b)b-=n;else if(o<=b)return F;if(y!==v||b!==C)return P.rf(O,L,y,b,a.rowRelative,a.columnRelative)}}else if(1===a.type){if(s=a.source||t&&t.yj(),w=a.row,x=a.column,T=a.endRow,A=a.endColumn,S=a.rowRelative,M=a.columnRelative,I=a.endRowRelative,N=a.endColumnRelative,R=w,k=x,E=T,D=A,s&&s===O){if(i&&r)w+=!S&&o<=w?n:0,T+=!I&&o<=T?n:0;else if(!i&&r)x+=!M&&o<=x?n:0,A+=!N&&o<=A?n:0;else if(i&&!r){if(!S&&o<=w&&!I&&T<o+n)return F;if(S&&I||T<o)return a;if(!S)if(o+n<=w)w-=n;else if(!(w<o)){if(I)return F;o<w&&(w=o)}if(!I)if(o+n<=T)T-=n;else{if(S)return F;T<o+n&&(T=o-1)}}else{if(!M&&o<=x&&!N&&A<o+n)return F;if(M&&N||A<o)return a;if(!M)if(o+n<=x)x-=n;else if(!(x<o)){if(N)return F;o<x&&(x=o)}if(!N)if(o+n<=A)A-=n;else{if(M)return F;A<o+n&&(A=o-1)}}if(x!==k||A!==D||w!==R||T!==E)return P.uf(O,L,w,x,T,A,S,M,I,N)}}else if(10===a.type){if((j=a.value)!==(_=H(t,e,o,n,r,i,j)))return P.Lh(_)}else 13===a.type&&((s=a.source||t&&t.yj())&&s===O&&!i&&(a=a.offsetWhenInsertRemoveColumn(o,n,r)));return a}function m(t,e){var o,n,r,i,a,s,l,u=e.ah,c=u.getSource(),h=-1,f=-1;e.name?(n=e.name,i=e.id,v(i)?o=u.getNodeByName(n):(o={Lf:e.expression},r=!0)):(h=void 0===(h=e.row)?-1:h,f=void 0===(f=e.column)?-1:f,o=u.getNode(h,f)),a=o.Lf,s=o.Pf,l=t.unparse(c,a,h<0?0:h,f<0?0:f),s&&(!0!==t.allowDynamicArray||!0===t.allowDynamicArray&&!s.isDynamicArray)?h===s.row&&f===s.col&&u.setArrayFormula(s.row,s.col,s.rowCount,s.colCount,l):n?r?u.setFormula(i,n,l):u.setFormulaByName(n,l):u.setFormula(h,f,l,null,!0,!0),o.Lf.ehc=a.ehc}function E(t,e){var o=t.offset(0,0,!1,0,0);return o.rowRelative=o.endRowRelative=o.columnRelative=o.endColumnRelative=e,o}Object.defineProperty(e,"__esModule",{value:!0}),y=o("Core"),f=o("Core"),n=o("@grapecity/js-sheets-common"),P=o("@grapecity/js-calc"),c=o("./dist/plugins/sheetsCalc/calc-spreadjs.js"),k=o("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),L=null,g=y.GC$.each,h=n.Common.u.Nb,r=new n.Common.ResourceManager(y.SR),b=r.getResource.bind(r),v=n.Common.j.Fa,u=parseInt,(i=y.Worksheet.prototype).resetCalc=function(){a.call(this),this.Ru=!0},i.recalcAll=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g=C(this);if(g){if(this.suspendPaint(),g.suspend(!0),t)for(o=(e=this.parent)&&e.sheets||[this],n=0;n<o.length;n++){if(i=(r=o[n]).Tu,a=r.yj(),i)for(s in i)u=(l=i[s]).Lf,c=g.unparse(a,u,0,0),l.Lf=g.parse(a,c,0,0);for(h=a.getCalcSourceModel().getAllNodes(),f=0;f<h.length;f++)(d=(p=h[f]).calc)&&p.Lf&&m(g,d)}g.resume(!0),this.resumePaint()}},i.recalcRange=function(t,e,o,n){var r=C(this);r&&r.recalcRange(this.yj(),t,e,o,n)},i.recalcRows=function(t){var e,o=C(this);if(o&&!o.ignoreDirty()){for(o.suspend(),e=0;e<t.length;e++)o.recalculate(this.ft,t[e],-1);o.resume(!1)}},i.recalcCols=function(t){var e,o=C(this);if(o&&!o.ignoreDirty()){for(o.suspend(),e=0;e<t.length;e++)o.recalculate(this.ft,-1,t[e]);o.resume(!1)}},i.zq=function(t,e,o){var n,r=C(this);r&&!r.ignoreDirty()&&(n=this.ft,1===o?n=this.fDc:2===o&&(n=this.hDc),r.recalculate(n,t,e))},i.getCalcService=function(){return this.Wu||(this.Wu=new P.CalcService,this.yj(y.SheetArea.colHeader).setCalcService(this.Wu),this.yj(y.SheetArea.rowHeader).setCalcService(this.Wu),this.yj().setCalcService(this.Wu),this.Wu.initParserContext(this.yj())),this.Wu},i.Cf=function(){return this.getCalcService()},i.suspendCalcService=function(t){var e=C(this);e&&e.suspend(t)},i.resumeCalcService=function(t){var e=C(this);e&&e.resume(t)},i.yj=function(t){return v(t)||3===t?this.ft:1===t?this.fDc:2===t?this.hDc:L},i.Bj=function(t){var e=this;return 1===t?(!e.eDc&&e.fDc&&(e.eDc=e.Cf().getSourceModel(e.fDc)),e.eDc):2===t?(!e.gDc&&e.hDc&&(e.gDc=e.Cf().getSourceModel(e.hDc)),e.gDc):(!e.et&&e.ft&&(e.et=e.Cf().getSourceModel(e.ft)),e.et)},i.iDc=function(t,e,o,n,r){var i=this.Bj(r);return i&&i.tg(t,e,o,n,!0,!0)},i.Ns=function(t,e,o,n,r,i){var a=this.iDc(t,e,o,n,3);return!a&&r&&(n=this.getColumnCount(2),a=this.iDc(t,0,o,n,2)),!a&&i&&(o=this.getRowCount(1),a=this.iDc(0,e,o,n,1)),a},i.Ms=function(t,e,o,n,r){var i=this.Bj(r);return i&&i.tg(t,e,o,n,!1,!0)},i.Vq=function(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m;return void 0===r&&(r=!0),s=r&&this.Ns(t,e,o,n,i,a),l=!r&&(d=i,g=a,!(m=w(u=this,c=t,h=e,f=o,p=n,3))&&d&&(p=u.getColumnCount(2),m=w(u,c,0,f,p,2)),!m&&g&&(f=u.getRowCount(1),m=w(u,0,h,f,p,1)),m),!s&&!l||(this.Os(4,b().Exp_ChangePartOfArray),!1)},i.addCustomFunction=function(t){this.Xu(t),this.recalcAll()},i.Xu=function(t){if(!(t&&t instanceof P.Functions.Function))throw Error(b().Exp_InvalidCustomFunction);this.Su[h(t.name)]=t},i.getCustomFunction=function(t){return t?this.Su[h(t)]:L},i.removeCustomFunction=function(t){t&&(delete this.Su[h(t)],this.recalcAll())},i.clearCustomFunctions=function(){this.Su={},this.recalcAll()},i.Pu=function(t){var e,o;return t?(e=this.parent,!(o=this.getCustomFunction(t))&&e&&e.getCustomFunction&&(o=e.getCustomFunction(t)),o):L},i.addCustomName=function(t,e,o,n,r){this.Yu(t,e,o,n,!1,r)},i.getCustomName=function(t){return t?this.Tu[h(t)]:void 0},i.getCustomNames=function(){var o=[];return g(this.Tu,function(t,e){o.push(e)}),o},i.removeCustomName=function(t){var e,o;t&&(e=h(t),delete this.Tu[e],(o={})[e]=e,this.Zu(o,!1))},i.clearCustomNames=function(){var t=this.Tu;this.Tu={},this.Zu(t,!1)},i.createNameInfo=function(t,e,o,n,r){var i,a=C(this),s=this.yj();return a&&s?(i=a.parse(s,e,n,r),new c.NameInfo(t,i,n,r,o)):L},i.H$a=function(t){var e,o=!this.Tu[h(t)];return o&&((e=this.tables)&&(o=!e.findByName(t))),o},i.isValidCustomName=function(t){return t&&y.Ul.G$a(t)&&this.H$a(t)},i.Yu=function(t,e,o,n,r,i){var a,s,l,u;if(!t||!e||!r&&!this.isValidCustomName(t))throw Error(b().Exp_InvalidCustomName);if(a=C(this),s=this.yj(),a&&s){if(l=void 0,r)try{l=a.parse(s,e,o,n,!1,!1,!0)}catch(t){}else l=a.parse(s,e,o,n);this.Tu[h(t)]=new c.NameInfo(t,l,o,n,i),r||((u={})[t]=t,this.Zu(u,!0))}},i.Zu=function(t,e){var o,n=this.Bj();if(n){for(o in t)n.updateNameCalc(o,e);this.recalcAll()}},i.$u=function(t){var e,o;return t?(e=this.parent,!(o=this.getCustomName(t))&&e&&e.getCustomName&&(o=e.getCustomName(t)),o):L},i.setFormula=function(t,e,o,n){this._u(t,e,o,L,!1,n)},i._u=function(t,e,o,n,r,i,a,s,l){var u,c,h,f,p,d,g,m,y=this;return v(i)&&(i=3),t<0||t>=y.getRowCount(i)||e<0||e>=y.getColumnCount(i)?void y.Os(0,b().Exp_IndexOutOfRange):(u=0<=t?t:0,c=0<=e?e:0,h=y.yj(i),(n=n||(o&&y.Wu?y.Wu.parse(h,o,u,c,!1,r,r):L))&&s&&(n.ensureSingle=!0),f=y.tables,void(3===i&&0<=t&&0<=e&&f&&!f.Hma(t,e,1,1,o,n)||(p=y.Bj(i),d=y.conditionalFormats,p&&(g=p.getFormula(t,e),m=y._modelManager,p.setFormula(t,e,o,n,r,void 0,m.dUa(),l),d&&d.Nm(),a?y.WXc(y,[{row:t,col:e}],0):y.Bq("formula",t,e,i,g,o)),y.t4&&y.t4(t,e,1,1,i),y.$p())))},i.setArrayFormula=function(t,e,o,n,r,i){this.bv(t,e,o,n,r,!1,i)},i.bv=function(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d;if(void 0===a&&(a=3),l=this,t<0||t+o>l.getRowCount()||e<0||e+n>l.getColumnCount())l.Os(0,b().Exp_IndexOutOfRange);else if(l._modelManager.MTa(t,e,o,n))l.Os(0,b().Exp_ArrayFormulaSpan);else if(u=l.tables,!(3===a&&0<=t&&0<=e&&u)||u.Hma(t,e,o,n,r)){if(c=l.Bj(a),h=l.conditionalFormats,c&&(l.suspendEvent(),c.setArrayFormula(t,e,o,n,r,i,l._modelManager.dUa(),s),l.resumeEvent(),h&&h.Nm(),l.jm<1)){for(f=[],p=t;p<t+o;p++)for(d=e;d<e+n;d++)f.push({row:p,col:d});l.Bu(t,e,o,n,f,5,a,r)}l.$p()}},i.getFormula=function(t,e,o,n){var r=this.Bj(o);return r?r.getFormula(t,e,n):L},i.Ima=function(t,e,o){var n=this.Bj(o);return n?n.Kf(t,e):L},i.getFormulaInformation=function(t,e){var o,n,r,i,a,s={},l=this.Bj();return l&&((o=l.Kf(t,e))?(n=l.Qf(t,e),s.hasFormula=!0,n&&!n.isDynamicArray&&(s.baseRange=new y.Range(n.row,n.col,n.rowCount,n.colCount)),s.isArrayFormula=n&&!n.isDynamicArray,t=n?n.row:t,e=n?n.col:e,s.formula=this.Wu.unparse(this.ft,o,t,e),s.formulaWithCulture=this.Wu.unparse(this.ft,o,t,e,!0),s.hasFormula=!!s.formula):(r=this._modelManager.getDynamicArrayInfo(t,e))&&r.isValid&&(i=r.row,a=r.col,t===i&&e===a||(o=l.Kf(i,a),s.formulaWithCulture=this.Wu.unparse(this.ft,o,i,a,!0),s.hasFormula=!0,s.isDynamicArray=!0))),s},i.ngc=function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y;for(o||(o=this,n=t,r=e,i=[]),a=o.VXc(n,r),s=this.name(),l=0;l<a.length;l++){if(i[c=(u=a[l]).sheetName+"_"+u.row+"_"+u.col+"_"+u.rowCount+"_"+u.colCount])return!1;if(i[c]=!0,(u.row<=t&&t<u.row+u.rowCount||-1===u.rowCount)&&(u.col<=e&&e<u.col+u.colCount||-1===u.colCount)&&s===u.sheetName)return!0;for(h=u.sheetName===s?o:o.parent.getSheetFromName(u.sheetName),f=u.rowCount,p=u.row,d=u.colCount,g=u.col,-1===f&&(f=h.getRowCount(),p=0),-1===d&&(d=h.getColumnCount(),g=0),m=p;m<f+p;m++)for(y=g;y<d+g;y++)if(this.ngc(t,e,h,p,g,i))return!0}return!1},i.getPrecedents=function(t,e){var o,n,r,i,a=[],s=this.Bj();return s&&(o=s.Mf(t,e)||s.Kf(t,e),r=(n=this.getFormulaInformation(t,e).baseRange)?n.row:t,i=n?n.col:e,this.VGb(o,r,i,a),a=function(t){var e,o,n,r=[],i=[];for(e=0;e<t.length;e++)n=""+(o=t[e]).row+o.col+o.rowCount+o.colCount+o.sheetName,r.indexOf(n)<0&&(r.push(n),i.push(o));return i}(a)),a},i.getDependents=function(u,c){var h=[],t=this.parent&&this.parent.sheets||[this],f=this.name();return t.forEach(function(t){var e,o,n,r,i,a=t.getRowCount(),s=t.getColumnCount(),l=t.name();for(e=0;e<a;e++)for(o=0;o<s;o++)for(n=t.getPrecedents(e,o),r=0;r<n.length;r++)if((i=n[r]).sheetName===f&&(-1===i.row||i.row<=u&&u+1<=i.row+i.rowCount)&&(-1===i.col||i.col<=c&&c+1<=i.col+i.colCount)){h.push({row:e,col:o,rowCount:1,colCount:1,sheetName:l});break}}),h},i.VXc=function(t,e){var o,n,r,i,a,s,l,u,c,h={},f=this.Bj().qg(t,e),p=this.Bj().ug();if(f)for(n in o=f[0])o.hasOwnProperty(n)&&(a=(i=(r=o[n]).ah._source)?i.kj.name():this.name(),h[(i?i.kj._id:this._id)+" "+r.row+" "+r.column]={row:r.row,col:r.column,rowCount:1,colCount:1,sheetName:a});if(p)for(n in s=p[0])if(s.hasOwnProperty(n)&&((-1===(l=s[n]).row||l.row<=t&&t+1<=l.row+l.rowCount)&&(-1===l.col||l.col<=e&&e+1<=l.col+l.colCount)))for(c in u=l.content)a=(i=(r=u[c]).ah._source)?i.kj.name():this.name(),h[(i?i.kj._id:this._id)+" "+r.row+" "+r.column]={row:r.row,col:r.column,rowCount:1,colCount:1,sheetName:a};return function(t){var e,o=[];for(e in t)t.hasOwnProperty(e)&&o.push(t[e]);return o}(h)},i.VGb=function(t,e,o,n){var r,i,a,s,l;if(t)switch(t.type){case P.ExpressionType.reference:case P.ExpressionType.structReference:case P.ExpressionType.spillReference:r=t.getRange(e,o),n.push({row:r.row,col:r.col,rowCount:r.rowCount,colCount:r.colCount,sheetName:t.source&&t.source.kj?t.source.kj.name():this.name()});break;case P.ExpressionType.operator:this.VGb(t.value,e,o,n),this.VGb(t.value2,e,o,n);break;case P.ExpressionType.expand:case P.ExpressionType.parentheses:this.VGb(t.value,e,o,n);break;case P.ExpressionType.name:i=this.$u(t.value),this.VGb(i.getExpression(),e,o,n);break;case P.ExpressionType.function:for(a=t.arguments,s=0;s<a.length;s++)l=a[s],this.VGb(l,e,o,n)}},i.hasFormula=function(t,e){var o=this.Bj();return!!o&&o.hasFormula(t,e)},i.dv=function(){var t,e,o,n,r,i=this.Bj();if(i)for(t=0,e=i.rC(),o=i.cC();t<e;){for(n=0;n<o;)(r=i.qg(t,n))&&(r.ng(),r.og()),n++;t++}},i.clearFormula=function(t,e,o,n,r){var i,a;for(t<0&&(t=0,o=this.getRowCount()),e<0&&(e=0,n=this.getColumnCount()),i=0;i<o;i++)if(r(this,i+t))for(a=0;a<n;a++)this.setFormula(i+t,a+e,L)},i.nameFunctionsFromJSON=function(t,e,o,n){var r,i,a,s,l,u,c,h;if(t){if(r=t.customFunctions)for(i in r)r.hasOwnProperty(i)&&(a=r[i],(s=f.getTypeFromString(a.typeName))&&((l=new s).fromJSON(a,e),this.Xu(l)));if((u=t.names)&&0<u.length){for(c=0;c<u.length;c++)h=u[c],this.Yu(h.name,h.formula,h.row,h.col,!0,h.comment);this.dv()}n&&n()}},i.formulaFromJSON=function(t,e,a){var s,l,u;t&&(s=this,l=a&&a.ignoreFormula,u=a&&a.incrementalLoading,[t.colHeaderData,t.rowHeaderData,t.data].forEach(function(t,e){var o,n,r,i;t&&!l&&t.dataTable&&(o=e+1,n=t.dataTable,r=s.getRowCount(o),i=s.getColumnCount(o),u?T(s,n,r,i,a,0,o):function(t,e,o,n,r){var i,a,s;for(i=0;i<o;i++)if(a=e[i])for(s=0;s<n;s++)x(a[s],i,s,t,0,r)}(s,n,r,i,o))}),u?a.incrementLoadTask.pushTask(p,[s,t,e,a]):p(s,t,e,a))},i.ev=function(t){var e=this,o=e.Wu;o&&!t||(e.Wu=t||new P.CalcService,e.yj(y.SheetArea.colHeader).setCalcService(e.Wu),e.yj(y.SheetArea.rowHeader).setCalcService(e.Wu),e.yj(y.SheetArea.viewport).setCalcService(e.Wu),e.Wu.initParserContext(e.yj()),o?(t.setSourceModel(e.fDc,o.getSourceModel(e.fDc)),t.setSourceModel(e.hDc,o.getSourceModel(e.hDc)),t.setSourceModel(e.ft,o.getSourceModel(e.ft))):(e.eDc=e.Wu.getSourceModel(e.fDc),e.gDc=e.Wu.getSourceModel(e.hDc),e.et=e.Wu.getSourceModel(e.ft)))},i.setCalc=function(t,e){this.Wu=t,this.ft=e||this.ft,this.et=t.getSourceModel(this.ft),this.parent&&(this.parent.Wu=t)},i.fv=function(){this._endEditImp(!1,1)},i.mUa=function(t,e){var o,n,r,i,a,s,l,u,c=this,h=t.changeType,f=t.row,p=t.rowCount,d=t.col,g=t.colCount,m=c.Bj();m&&(n=(o=c._modelManager).dUa(),r=C(m),i=m._source,a=r.ih(),s=r.lh.asyncManager,"addingRows"===h?c.Vq(f,0,0,c.getColumnCount(),void 0,!0,!1)?(l=c.Bj(2),a.onBeforeAddRemoveRows(m,f,l),e||y.clearSpillValuesOnAddRemove(o,f,p,!0,!0),A(c,f,p,!0,!0),[m,l].forEach(function(t){t.addRows(f,p)}),s.addRows(i,f,p)):t.canAdd=!1:"addRows"===h?(r.suspend(),l=c.Bj(2),a.onAfterAddRemoveRows(m,f,p,!0,e,l),r.resume(!1),n&&n.push({type:"addRows",row:f,rowCount:p})):"deletingRows"===h?c.Vq(f,0,p,c.getColumnCount(),void 0,!0,!1)?(l=c.Bj(2),a.onBeforeAddRemoveRows(m,f,l),e||y.clearSpillValuesOnAddRemove(o,f,p,!1,!0),A(c,f,p,!1,!0),[m,l].forEach(function(t){t.deleteRows(f,p)}),s.deleteRows(i,f,p)):t.canDelete=!1:"deleteRows"===h?(r.suspend(),l=c.Bj(2),a.onAfterAddRemoveRows(m,f,p,!1,e,l),r.resume(!1),n&&n.push({type:"deleteRows",row:f,rowCount:p})):"addingColumns"===h?c.Vq(0,d,c.getRowCount(),0,void 0,!1,!0)?(u=c.Bj(1),a.onBeforeAddRemoveColumns(m,d,u),e||y.clearSpillValuesOnAddRemove(o,d,g,!0,!1),A(c,d,g,!0,!1),[m,u].forEach(function(t){t.addColumns(d,g)}),s.addColumns(i,f,p)):t.canAdd=!1:"addColumns"===h?(r.suspend(),u=c.Bj(1),a.onAfterAddRemoveColumns(m,d,g,!0,e,u),r.resume(!1),n&&n.push({type:"addColumns",col:d,colCount:g})):"deletingColumns"===h?c.Vq(0,d,c.getRowCount(),g,void 0,!1,!0)?(u=c.Bj(1),a.onBeforeAddRemoveColumns(m,d,u),e||y.clearSpillValuesOnAddRemove(o,d,g,!1,!1),A(c,d,g,!1,!1),[m,u].forEach(function(t){t.deleteColumns(d,g)}),s.deleteColumns(i,f,p)):t.canDelete=!1:"deleteColumns"===h&&(r.suspend(),u=c.Bj(1),a.onAfterAddRemoveColumns(m,d,g,!1,e,u),r.resume(!1),n&&n.push({type:"deleteColumns",col:d,colCount:g})))},i.nUa=function(t,e,o){var n=o.type;"addRows"===n?(o.changeType="deletingRows",this.mUa(o,!0),o.changeType="deleteRows",this.mUa(o,!0)):"deleteRows"===n?(o.changeType="addingRows",this.mUa(o,!0),o.changeType="addRows",this.mUa(o,!0)):"addColumns"===n?(o.changeType="deletingColumns",this.mUa(o,!0),o.changeType="deleteColumns",this.mUa(o,!0)):"deleteColumns"===n?(o.changeType="addingColumns",this.mUa(o,!0),o.changeType="addColumns",this.mUa(o,!0)):"customName"===n?o.nameInfo.fg(o.expr):"condition"===n&&o.condition.setExpressions(o.expressions)},i.gUa=function(t){var e,o=C(this),n=this.Bj();for(o.suspend();t.length;)(e=t.pop()).type?this.nUa(o,n,e):n.$Va.apply(n,e);o.resume(!1)},i.getReferenceRange=function(t){var e,o=this.yj(),n=this.getCalcService().evaluate(o,t,0,0,!0);if(n instanceof P.CalcReference&&(e=n.getSource().getName(),0<n.getRangeCount()))return{sheetName:e,range:y.kf(n.getRow(0),n.getColumn(0),n.getRowCount(0),n.getColumnCount(0))}},e.kDc=A,e.vyb=function(t,e,o,n,r,i,a,s,l,u){k.CalcOperatorAdjustor.copyFormula(t.Bj(),e,o,n.Bj(),r,i,a,s,l,u)},e.uyb=function t(e,o,n,r,i,a,s,l,u,c){var h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R;if(9===c.type){if(h=c.value,f=c.value2,p=t(e,o,n,r,i,a,s,l,u,h),d=f&&t(e,o,n,r,i,a,s,l,u,f),h!==p||f!==d)return P.Kh(c.operatorType,p,d)}else if(7===c.type){for(g=!1,m=[],y=void 0,b=0;b<c.arguments.length;b++)v=t(e,o,n,r,i,a,s,l,u,y=c.arguments[b]),g=g||y!==v,m.push(v);if(g)return P.Jh(c,m)}else if(1===c.type){if(C=!c.rowRelative&&!c.columnRelative,w=!c.endRowRelative&&!c.endColumnRelative,x=o.yj(),(!c.source||c.source===x)&&C&&w)return T=i.yj(),A=new k.MoveSwapInfo(x,n,r,T,a,s,l,u),S=E(c,!0),M={isCustomName:!0},(I=k.adjustFormulaOnMoveSwap(x,0,0,S,A,!0,M))===S?c:1===I.type&&E(I,!1)||I}else if(10===c.type&&(N=c.value)!==(R=t(e,o,n,r,i,a,s,l,u,N)))return P.Lh(R);return c},y.Worksheet.$n("calc",{priority:1e3,init:a,dispose:function(t){var e,o,n,r=this;!1!==t.clearCache&&(r.ft=L,r.hDc=L,r.fDc=L,r.Wu=L,(e=r.et)&&(!0===t.isSheetDestroy?e.eHb():e.rzb(),r.et=L),(o=r.gDc)&&(!0===t.isSheetDestroy?o.eHb():o.rzb(),r.gDc=L),(n=r.eDc)&&(!0===t.isSheetDestroy?n.eHb():n.rzb(),r.eDc=L))},attach:function(t){t instanceof y.Workbook?this.ev(t.Wu):this.ev()},onLayoutChanged:function(t){this.Cf().isAdjustSuspended()||this.mUa(t)},toJson:function(t,e){var n,l,o,u,r,i,a,c=this,s=c.Su;y.GC$.isEmptyObject(s)||(t.customFunctions=s),n=e&&e.newWorkSheetName,l=[],o=c.getCustomNames(),u=C(c),r=c.Bj(),i=r._source,o&&u&&(!v(n)&&r&&i&&(i.JXc=n),g(o,function(t,e){var o,n=e.getName(),r=e.getRow(),i=e.getColumn(),a=e.getExpression(),s=e.getComment();a&&(o={name:n,formula:u.unparse(c.yj(),a,r,i,!1,!0,!0),row:r,col:i},s&&(o.comment=s),l.push(o))}),0<l.length&&(t.names=l),delete i.JXc),e&&e.ignoreFormula||(a=[c.et,c.eDc,c.gDc],[t.data,t.colHeaderData,t.rowHeaderData].forEach(function(t,e){var o=a[e];o&&(i=o._source,v(n)||(i.JXc=n),o.toJSON({data:t}),delete i.JXc)}))},fromJson:function(t,e,o,n){o&&o.incrementalLoading||(this.clearCustomFunctions(),this.clearCustomNames()),n&&(this.nameFunctionsFromJSON(t,e,o),this.formulaFromJSON(t,e,o))},setName:function(t){(function(t){var e,o,n,r,i,a,s,l,u,c,h=C(t),f=[h.getSourceModel(t.yj(y.SheetArea.colHeader)),h.getSourceModel(t.yj(y.SheetArea.rowHeader)),h.getSourceModel(t.yj())];for(e=0;e<f.length;e++){if(!(o=f[e]))return;for(n=o.getAllNodes(),r=0;r<n.length;r++)if(i=n[r].calc)for(a=i.Ze,s=void 0,l=0;l<a.length;l++)if(u=i[a[l]])for(c in u)(s=u[c])&&s instanceof P.PathCalc&&m(h,s)}})(this),C(this.Bj()).lh.asyncManager.changeSourceName(t.oldName,t.newName)},beforeSetName:function(){this.uja&&(this.parent||this).tja()}})},"./dist/plugins/sparkline/functions-sparkline.js":function(t,e,d){"use strict";var I,S,f,v,g,m,y,C,w,o,r,N,n,i,b,x,R,a,s,l,p,u,k,T,E,c,h,A,M,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J,Z,q,K,Y,Q,X,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ht,ft,pt,dt,gt,mt,yt,bt,vt,Ct,wt,xt,Tt,At,St,Mt,It,Nt,Rt,kt,Et,Dt,jt,_t,Ot,Ft,Pt,Lt=this&&this.__extends||(gt=function(t,e){return(gt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}gt(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function Ht(t){return 0===t}function Bt(t){return 0===t||2===t}function Vt(t){return Bt(t)||8===t}function zt(t){return 0===t||1===t}function Wt(t){return 0<=t&&t<=2}function Gt(t){return 2===t||3===t}function Ut(t){return 1===t||2===t}function Jt(t,e){var o,n,r,i,a,s,l,u,c,h,f=[];if(C(t))for(o=0,n=t.getRangeCount();o<n;o++)for(r=t.getRowCount(o),i=t.getColumnCount(o),a=0;a<r;a++)for(s=0;s<i;s++)f.push(t.getValue(o,a,s));else if(e&&w(t))for(l=t.getRowCount(),u=t.getColumnCount(),c=0;c<l;c++)for(h=0;h<u;h++)f.push(t.getValue(c,h));return f}function Zt(t,e,o){var n,r,i,a,s,l,u,c,h=[];if(C(t)){if(e<t.getRangeCount())for(n=t.getRowCount(e),r=t.getColumnCount(e),i=0;i<n;i++)for(h[i]=[],a=0;a<r;a++)h[i].push(t.getValue(e,i,a))}else if(o&&w(t))for(s=t.getRowCount(),l=t.getColumnCount(),u=0;u<s;u++)for(h[u]=[],c=0;c<l;c++)h[u][c]=t.getValue(u,c);return h}function qt(t){var e;return C(t)?e=t.getValue(0,0,0):N(t)||(e=t),e}function Kt(){return yt.call(this)||this}function Yt(){return bt.call(this)||this}function Qt(){return vt.call(this)||this}function Xt(){return Ct.call(this)||this}function $t(){return wt.call(this)||this}function te(){return xt.call(this)||this}function ee(){return Tt.call(this)||this}function oe(){return At.call(this)||this}function ne(){return St.call(this)||this}function re(){return Mt.call(this)||this}function ie(){return It.call(this)||this}function ae(){return Nt.call(this)||this}function se(){return Rt.call(this)||this}function le(){return kt.call(this)||this}function ue(){return Et.call(this)||this}function ce(){return Dt.call(this)||this}function he(){var e,o,t=this.createFunction();t&&(e=t.name,o=t.evaluate,t.evaluate=function(){var t=o.call(this,arguments);return t instanceof I.CalcError?t:t?new U(e,t):null},(this.Cj=e)&&!I.Functions.findGlobalFunction(e)&&(I.Functions.ci[e]=t)),this.typeName=""}function fe(t,e){this.name=t,this.value=e,this.typeName="SparklineExValue"}function pe(t,m){function y(t){return new S.Range(t.getRow(0),t.getColumn(0),t.getRowCount(0),t.getColumnCount(0))}function b(t){return new S.Range(0,0,t.getRowCount(),t.getColumnCount())}var e=new o(t,2,5);return e.evaluate=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d=t[0],g=w(d);if((C(d)||g)&&0<(g?1:d.getRangeCount())){for(h in e=(g?b:y)(d),o=g?"":d.getSource().getSheet().name(),n=t[1],r=t[2],s=a=i=void 0,l=w(r),(C(r)||l)&&(s=l?"":r.getSource().getSheet().name(),0<(l?1:r.getRangeCount())&&(i=(l?b:y)(r),a=t[3])),u=function(t){var e,o,n,r,i,a={},s=!1,l=!0,u="",c="";if(t){for(e=0,o=(t=t.substr(1,t.length-2)).length;e<o;e++)":"===(n=t.charAt(e))?l=!1:","!==n||s?"'"===n||'"'===n||("("===n?s=!0:")"===n&&(s=!1),l?u+=n:c+=n):(a[u]=c,l=!(c=u=""));for(r in u&&(a[u]=c),a)a.hasOwnProperty(r)&&(i=a[r],N(i)||("TRUE"===i.toUpperCase()?a[r]=!0:"FALSE"===i.toUpperCase()?a[r]=!1:!k(i)&&isFinite(i)&&(a[r]=T(i))))}return a}(t[4]||"{}"),c={ac:"axisColor",fmc:"firstMarkerColor",hmc:"highMarkerColor",lastmc:"lastMarkerColor",lowmc:"lowMarkerColor",mc:"markersColor",nc:"negativeColor",sc:"seriesColor",deca:"displayEmptyCellsAs",rtl:"rightToLeft",dh:"displayHidden",dxa:"displayXAxis",sf:"showFirst",sh:"showHigh",slast:"showLast",slow:"showLow",sn:"showNegative",sm:"showMarkers",mmax:"manualMax",mmin:"manualMin",maxat:"maxAxisType",minat:"minAxisType",lw:"lineWeight"})c.hasOwnProperty(h)&&u.hasOwnProperty(h)&&(u[c[h]]=u[h]);return 1===(p=(f=new v.SparklineSetting(u)).options).maxAxisType&&(p.maxAxisType=0),1===p.minAxisType&&(p.minAxisType=0),{data:e,dataSheetName:o,dataOrientation:n,dateAxisData:i,dateAxisDataSheetName:s,dateAxisOrientation:a,sparklineType:m,displayDateAxis:i&&!N(a),setting:f,values:Zt(d,0,!0),dateValues:Zt(r,0,!0)}}},e.acceptsReference=Bt,e.acceptsArray=Bt,e}function de(t,e,o,n,r,i,a){var s,l,u=v.Sparkline.cT,c=a.sheet,h=c.parent.getSheetFromName(e.dataSheetName),f=c.parent.getSheetFromName(e.dateAxisDataSheetName),p=e.setting;p&&p.options||(p=new v.SparklineSetting(p)),s=p.options.displayHidden,l={sparklineType:e.sparklineType,displayDateAxis:e.displayDateAxis,zoomFactor:a.zoomFactor,values:u(e.values,h||c,s,e.data,e.dataOrientation),dateValues:u(e.dateValues,f||c,s,e.dateAxisData,e.dateAxisOrientation,!0),settings:p,getColor:function(t){if(c&&t){var e=S.Rm.Om(c,t);if(e)return e}return t}},(new b).paint(t,l,o,n,r,i)}function ge(){return jt.call(this)||this}function me(){return _t.call(this)||this}function ye(){return Ot.call(this)||this}function be(){return Ft.call(this)||this}function ve(){return Pt.call(this)||this}function Ce(t,e,o){return{value:t,font:e,label:o,normalFontHeight:a(e),normalFontWidth:s(o,e),fontAfterZoom:null}}function we(t){t&&(dt[t.name()]=t)}Object.defineProperty(e,"__esModule",{value:!0}),I=d("@grapecity/js-calc"),S=d("Core"),f=d("@grapecity/js-sheets-common"),v=d("./dist/plugins/sparkline/sparkline-wrapper.js"),C=I.Convert._isReference,w=I.Convert.Ca,o=I.Functions&&I.Functions.Function,r=I.Functions&&I.Functions.bi,N=f.Common.j.Fa,(n=S.GC$).inherit,i=n.extend,b=f.Sparklines.SparklineRender,x=f.Sparklines.SparklineExRenders,R=I.Errors.Value,a=S.util.fp,s=S.Vn.Xn,l=S.To.No,p=Math.floor,u=Math.min,k=isNaN,T=parseFloat,E="12px Calibri",c="PIESPARKLINE",h="AREASPARKLINE",A="SCATTERSPARKLINE",M="BULLETSPARKLINE",D="SPREADSPARKLINE",j="STACKEDSPARKLINE",_="HBARSPARKLINE",O="VBARSPARKLINE",F="VARISPARKLINE",P="BOXPLOTSPARKLINE",L="CASCADESPARKLINE",H="PARETOSPARKLINE",B="MONTHSPARKLINE",V="YEARSPARKLINE",z="GAUGEKPISPARKLINE",W="HISTOGRAMSPARKLINE",(mt=G=G||{})[mt.fit=1]="fit",mt[mt.entireFit=2]="entireFit",mt[mt.originFit=3]="originFit",mt[mt.custom=4]="custom",fe.prototype.toString=function(){return""},U=fe,e.SparklineExValue=U,he.prototype.name=function(){return this.Cj},he.prototype.createFunction=function(){return null},he.prototype.paint=function(t,e,o,n,r,i,a){},he.prototype.toJSON=function(){var t,e={};for(t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},he.prototype.fromJSON=function(t){if(t)for(var e in t)N(t[e])||(this[e]=t[e])},J=he,e.SparklineEx=J,Lt(ce,Dt=J),Z=ce,i((e.PieSparkline=Z).prototype,{createFunction:function(){var t=new o(c,1,255);return t.evaluate=function(t){var e=t[0],o=Jt(e,!0);return o.length<=0&&!N(e)&&o.push(e),{values:o,colors:Array.prototype.slice.call(t,1)}},t.acceptsReference=Ht,t.acceptsArray=Ht,t},paint:x[c]}),Lt(ue,Et=J),q=ue,i((e.AreaSparkline=q).prototype,{createFunction:function(){var t=new o(h,1,7);return t.evaluate=function(t){return{points:Jt(t[0],!0),mini:t[1],maxi:t[2],line1:t[3],line2:t[4],colorPositive:t[5],colorNegative:t[6]}},t.acceptsReference=Ht,t.acceptsArray=Ht,t},paint:x[h]}),Lt(le,kt=J),K=le,i((e.ScatterSparkline=K).prototype,{createFunction:function(){var t=new o(A,1,18);return t.evaluate=function(t){return{points1:Zt(t[0],0,!0),points2:Zt(t[1],0,!0),minX:t[2],maxX:t[3],minY:t[4],maxY:t[5],hLine:t[6],vLine:t[7],xMinZone:t[8],xMaxZone:t[9],yMinZone:t[10],yMaxZone:t[11],tags:t[12],drawSymbol:t[13],drawLines:t[14],color1:t[15],color2:t[16],dash:t[17]}},t.acceptsReference=zt,t.acceptsArray=zt,t},paint:x[A]}),Lt(se,Rt=J),Y=se,i((e.BulletSparkline=Y).prototype,{createFunction:function(){var t=new o(M,3,17);return t.evaluate=function(t){return{measure:qt(t[0]),target:qt(t[1]),maxi:qt(t[2]),good:qt(t[3]),bad:qt(t[4]),forecast:qt(t[5]),tickUnit:qt(t[6]),colorScheme:t[7],vertical:t[8],measureColor:t[9],targetColor:t[10],maxiColor:t[11],goodColor:t[12],badColor:t[13],forecastColor:t[14],allowMeasureOverMaxi:t[15],barSize:t[16]}},t.acceptsReference=function(t){return 0<=t&&t<=6},t},paint:x[M]}),Lt(ae,Nt=J),Q=ae,i((e.SpreadSparkline=Q).prototype,{createFunction:function(){var t=new o(D,1,7);return t.evaluate=function(t){var e,o,n,r,i,a,s,l,u=Jt(t[0],!0),c=[];if(!N(u)&&(c=function(t){var e,o,n,r,i,a={};for(o=void(e=0),n=t.length;e<n;e++)a[o=t[e]]?a[o]++:a[o]=1;for(i in r=[],a)a.hasOwnProperty(i)&&r.push({key:T(i),value:a[i]});return r.sort(function(t,e){return t.key-e.key})}(u=function(t){var e,o,n,r,i=[];for(n=o=0,r=t.length;o<r;o++)e=T(t[o]),!k(e)&&isFinite(e)&&(i[n]=e,n++);return i}(u)),3===(e=t[4])))for(o=0,n=c.length;o<n;o++){for(i=(r=c[o]).value,a=[],s=Math.max(100,10*i),l=0;l<s+i-1;l++)a.push(Math.random());r.randomNumbers=a}return{spreadData:c,showAverage:t[1],scaleStart:t[2],scaleEnd:t[3],style:e,colorScheme:t[5],vertical:t[6]}},t.acceptsReference=Ht,t.acceptsArray=Ht,t},paint:x[D]}),Lt(ie,It=J),X=ie,i((e.StackedSparkline=X).prototype,{createFunction:function(){var t=new o(j,1,13);return t.evaluate=function(t){return{points:Jt(t[0],!0),colorRange:Jt(t[1],!0),labelRange:Jt(t[2],!0),maximum:t[3],targetRed:t[4],targetGreen:t[5],targetBlue:t[6],targetYellow:t[7],color:t[8],highlightPosition:t[9],vertical:t[10],textOrientation:t[11],textSize:t[12]}},t.acceptsReference=Wt,t.acceptsArray=Wt,t},paint:x[j]}),Lt(re,Mt=J),$=re,i((e.HBarSparkline=$).prototype,{createFunction:function(){var t=new o(_,1,4);return t.evaluate=function(t){return{value:qt(t[0]),colorScheme:t[1],axisVisible:t[2],barHeight:t[3]}},t.acceptsReference=Ht,t},paint:x[_]}),Lt(ne,St=J),tt=ne,i((e.VBarSparkline=tt).prototype,{createFunction:function(){var t=new o(O,1,4);return t.evaluate=function(t){return{value:qt(t[0]),colorScheme:t[1],axisVisible:t[2],barWidth:t[3]}},t.acceptsReference=Ht,t},paint:x[O]}),Lt(oe,At=J),et=oe,i((e.VariSparkline=et).prototype,{createFunction:function(){var t=new o(F,1,10);return t.evaluate=function(t){return{variance:qt(t[0]),reference:qt(t[1]),mini:qt(t[2]),maxi:qt(t[3]),mark:qt(t[4]),tickUnit:qt(t[5]),legend:t[6],colorPositive:t[7],colorNegative:t[8],vertical:t[9]}},t.acceptsReference=function(t){return 0<=t&&t<=5},t},paint:x[F]}),Lt(ee,Tt=J),ot=ee,i((e.BoxPlotSparkline=ot).prototype,{createFunction:function(){function n(t,e){return C(t)&&!k(e)&&0<=e&&e<=100?r.PERCENTILE.evaluate(t,e/100):NaN}var t=new o(P,1,10);return t.evaluate=function(t){var e,o=t[0];return{points:Jt(o,!0),boxPlotClass:t[1],showAverage:t[2],scaleStart:qt(t[3]),scaleEnd:qt(t[4]),acceptableStart:qt(t[5]),acceptableEnd:qt(t[6]),colorScheme:t[7],style:t[8],vertical:t[9],perc02:n(o,2),perc09:n(o,9),perc10:n(o,10),perc90:n(o,90),perc91:n(o,91),perc98:n(o,98),q1:n(o,25),q3:n(o,75),median:n(o,50),stDev:C(e=o)?r.STDEVP.evaluate(e):NaN}},t.acceptsReference=Ht,t.acceptsArray=Ht,t},paint:x[P]}),Lt(te,xt=J),nt=te,i((e.CascadeSparkline=nt).prototype,{createFunction:function(){var t=new o(L,1,10);return t.evaluate=function(t){return{points:Jt(t[0],!0),pointIndex:qt(t[1]),labels:Jt(t[2],!0),minimum:qt(t[3]),maximum:qt(t[4]),colorPositive:t[5],colorNegative:t[6],vertical:t[7],itemTypeRange:Jt(t[8],!0),colorTotal:t[9]}},t.acceptsReference=Vt,t.acceptsArray=Vt,t},paint:x[L]}),Lt($t,wt=J),rt=$t,i((e.ParetoSparkline=rt).prototype,{createFunction:function(){var t=new o(H,2,12);return t.evaluate=function(t){return{points:Jt(t[0],!0),pointIndex:qt(t[1]),colorRange:Jt(t[2],!0),target:qt(t[3]),target2:qt(t[4]),highlightPosition:qt(t[5]),label:t[6],vertical:t[7],targetColor:t[8],target2Color:t[9],labelColor:t[10],barSize:t[11]}},t.acceptsReference=Bt,t.acceptsArray=Bt,t},paint:x[H]}),Lt(Xt,Ct=J),it=Xt,i((e.MonthSparkline=it).prototype,{createFunction:function(){var t=new o(B,3,7);return t.evaluate=function(t){var e,o,n,r,i,a,s,l,u,c=t[0],h=t[1],f=t[2],p=f;for((C(f)||w(f))&&(p=Zt(f,0,!0)),e=t[3],o=[],(C(e)||w(e))&&(o=Zt(e,0,!0)),n=[],r=[],i=0,a=p.length;i<a;i++)(s=p[i])&&("string"==typeof(l=s[0])&&(l=new Date(l)),l&&l.getFullYear()===c&&l.getMonth()+1===h&&(n[u=l.getDate()-1]=s[1],0<o.length&&(r[u]=o[i][0])));return 0<o.length?{year:c,month:h,values:n,colors:r}:{year:c,month:h,values:n,emptyColor:e,startColor:t[4],middleColor:t[5],endColor:t[6]}},t.acceptsReference=Gt,t.acceptsArray=Gt,t},paint:x[B]}),Lt(Qt,vt=J),Qt.daysOfMonth=function(t,e){switch(e){case 2:return t%4==0&&t%100!=0||t%400==0?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}},Qt.dayInYear=function(t){var e,o=t.getFullYear(),n=t.getMonth(),r=t.getDate();for(e=1;e<n+1;e++)r+=Qt.daysOfMonth(o,e);return r},at=Qt,i((e.YearSparkline=at).prototype,{createFunction:function(){var t=new o(V,2,6);return t.evaluate=function(t){var e,o,n,r,i,a,s,l,u,c=t[0],h=t[1],f=h;for((C(h)||w(h))&&(f=Zt(h,0,!0)),e=t[2],o=[],(C(e)||w(e))&&(o=Zt(e,0,!0)),n=[],r=[],i=0,a=f.length;i<a;i++)(s=f[i])&&("string"==typeof(l=s[0])&&(l=new Date(l)),l&&l.getFullYear()===c&&(n[u=at.dayInYear(l)-1]=s[1],0<o.length&&(r[u]=o[i][0])));return 0<o.length?{year:c,values:n,colors:r}:{year:c,values:n,emptyColor:e,startColor:t[3],middleColor:t[4],endColor:t[5]}},t.acceptsReference=Ut,t.acceptsArray=Ut,t},paint:x[V]}),Lt(Yt,bt=J),st=Yt,i((e.HistogramSparkline=st).prototype,{createFunction:function(){var h=this,t=new o(W,1,9);return t.acceptsArray=function(){return!0},t.evaluate=function(t){var e,o,n,r,i,a,s,l,u,c=t[0];if(!(c instanceof I.CalcArray||c instanceof I.CalcReference))throw I.CalcError;if(u=h.xMc(c),e=t[1],N(e)&&(e=!0),o=!0===t[2],n=t[3],N(n)&&(n=1),n<=0)throw I.CalcError;if(r=t[4],N(r)&&(r=1),1<r||r<=0)throw I.CalcError;return i=t[5]||"#5B9BD5",a=t[6],s=t[7]||"#000000",l=t[8]||"#C0C0C0",{values:e?h.yMc(u,n):h.zMc(u),continuous:e,paintLabel:o,barWidth:r,barColor:i,labelFontStyle:a,labelColor:s,edgeColor:l}},t.acceptsReference=function(t){return 0===t},t},xMc:function(t){var e,o,n=[];if(t instanceof I.CalcArray)for(e=t.toArray(1),o=0;o<e.length;o++)n.push(e[o]);else(e=Zt(t,0)).forEach(function(t){t.forEach(function(t){N(t)||"number"!=typeof t||isNaN(t)||n.push(t)})});return n},yMc:function(t,e){var o,n,r,i,a,s,l,u=[],c=0,h=this;for(t.forEach(function(t){u[c]=t,c++}),o=[],n=i=u[0],u.forEach(function(t){n=Math.min(t,n),i=Math.max(t,i)}),r=p(n/e)*e,a=Math.ceil(i/e)*e,s=1!==u.length?Math.round((a-r)/e):1,c=0;c<s;c++)o[c]=f.Common.o.Lma(c*e+r,15);for(i>=o[c-1]&&(o[c]=o[c-1]+e),l=[],c=0,s=o.length-1;c<s;c++)l[c]={value:0};for(0<l.length&&(l[0].axis="["+o[0]+","+o[1]+"]"),c=1;c<o.length-1;c++)N(o[c+1])?l[c].axis="("+o[c]+","+(o[c]+e)+"]":l[c].axis="("+o[c]+","+o[c+1]+"]";return u.forEach(function(t){var e=h.AMc(o,t);l[e].value++}),0<l.length&&0===l[0].value&&l.splice(0,1),l},zMc:function(t){var e,o,n,r,i={};for(e=0,o=t.length;e<o;++e)n=t[e],void 0===i[n]?i[n]=1:i[n]++;return(r=this.BMc(i)).sort(function(t,e){return t-e}),r.map(function(t){return{axis:t,value:i[t]}})},BMc:function(t){var e,o=[];for(e in t)t.hasOwnProperty(e)&&void 0!==t[e]&&null!==t[e]&&o.push(e);return o},AMc:function(t,e){var o,n,r,i,a=t.length;if(t[0]===e)return 0;if(0===a)return 0;o=0,r=p((n=a-1)/2);do{if(e>t[i=r]&&e<=t[r+1])return r;e<=t[r]?r=p(((n=r)+o)/2):e>t[r+1]&&(r=p(((o=r)+n)/2))}while(i!==r)},paint:function(t,e,o,n,r,i,a){var s,l,u=e.labelFontStyle,c=a.zoomFactor;N(u)&&(u=t.font),s=S.To.No(u,c),l=S.To.Ko(s.font),e.afterZoomFontStyle={fontStyle:l.fontStyle,fontFamily:l.fontFamily,fontSize:l.fontSize,fontWeight:l.fontWeight,fontPixelSize:s.fontSize},x[W](t,e,o,n,r,i,a)}}),Lt(Kt,yt=J),lt=Kt,i((e.ImageSparkline=lt).prototype,{createFunction:function(){var t=new o("IMAGE",1,10);return t.evaluate=function(t){var e=t[0],o=t[1]||G.fit,n=t[2],r=t[3],i=t[4]||0,a=t[5]||0,s=t[6],l=t[7],u=t[8],c=t[9];if(-1===[0,1,2].indexOf(u)&&(u=S.VerticalAlign.center),-1===[0,1,2].indexOf(c)&&(c=S.HorizontalAlign.center),o===G.custom&&(void 0===n||void 0===r))throw I.CalcError;return n=n<0?0:n,r=r<0?0:r,a=a<0?0:a,i=i<0?0:i,s=s<0?0:s,l=l<0?0:l,-1===[1,2,3,4].indexOf(o)&&(o=1),{url:e,drawType:o,height:n,width:r,clipY:i,clipX:a,clipWidth:l,clipHeight:s,vAlign:u,hAlign:c}},t},CMc:function(t,e,o,n,r){var i,a,s,l,u,c,h,f=t.width,p=t.height,d=t.x,g=t.y,m=e.width,y={clipX:0,clipY:0,clipHeight:e.height,clipWidth:m,paintX:0,paintY:0,paintHeight:0,paintWidth:0};if(f/p<(i=(y=this.DMc(y,e,o)).clipWidth/y.clipHeight))switch(a=n.vAlign,y.paintWidth=f,s=f/i,y.paintHeight=s,y.paintX=d,a){case S.VerticalAlign.top:y.paintY=g;break;case S.VerticalAlign.center:l=p-s,y.paintY=g+l/2;break;case S.VerticalAlign.bottom:y.paintY=g+p-s}else switch(u=n.hAlign,y.paintHeight=p,c=p*i,y.paintWidth=c,y.paintY=g,u){case S.HorizontalAlign.left:y.paintX=d;break;case S.HorizontalAlign.center:h=f-c,y.paintX=d+h/2;break;case S.HorizontalAlign.right:y.paintX=d+f-c}return y},EMc:function(t,e,o,n,r){var i={cutX:0,cutY:0,cutHeight:e.width,cutWidth:e.height,paintX:t.x,paintY:t.y,paintHeight:t.height,paintWidth:t.width};return this.DMc(i,e,o)},DMc:function(t,e,o){var n=e.width,r=e.height,i=o.clipX||0,a=o.clipY||0;return N(o.clipX)||(t.clipX=u(o.clipX,n)),N(o.clipY)||(t.clipY=u(o.clipY,r)),N(o.clipWidth)?t.clipWidth=n-t.clipX:t.clipWidth=o.clipWidth+i>n?n-i:o.clipWidth,N(o.clipHeight)?t.clipHeight=r-t.clipY:t.clipHeight=o.clipHeight+a>r?r-a:o.clipHeight,t},FMc:function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y,b=t.width,v=t.height,C=t.x,w=t.y,x={imgWidth:e.width,imgHeight:e.height,offsetX:0,offsetY:0};if(i=(x=this.GMc(x,e,o)).imgWidth,a=x.imgHeight,s=x.offsetX,l=x.offsetY,u=i*r,c=a*r,h={clipX:0,clipY:0,clipHeight:0,clipWidth:0,paintX:0,paintY:0,paintHeight:0,paintWidth:0},f=n.hAlign,p=n.vAlign,b<u){switch(h.paintWidth=b,h.paintX=C,d=(u-b)/u*i,f){case S.HorizontalAlign.left:h.clipX=x.offsetX;break;case S.HorizontalAlign.center:h.clipX=x.offsetX+d/2;break;case S.HorizontalAlign.right:h.clipX=x.offsetX+d}h.clipWidth=b}else{switch(h.clipWidth=i,h.clipX=0,g=b-(h.paintWidth=u),f){case S.HorizontalAlign.general:case S.HorizontalAlign.left:h.paintX=C;break;case S.HorizontalAlign.center:h.paintX=C+g/2;break;case S.HorizontalAlign.right:h.paintX=C+g}h.clipX+=s}if(v<c){switch(h.paintY=w,m=(c-(h.paintHeight=v))/c*a,p){case S.VerticalAlign.top:h.clipY=x.offsetY;break;case S.VerticalAlign.center:h.clipY=x.offsetY+m/2;break;case S.VerticalAlign.bottom:h.clipY=x.offsetY+m}h.clipHeight=v}else{switch(h.clipHeight=a,h.clipY=0,y=v-(h.paintHeight=c),p){case S.VerticalAlign.top:h.paintY=w;break;case S.VerticalAlign.center:h.paintY=w+y/2;break;case S.VerticalAlign.bottom:h.paintY=w+y}h.clipY+=l}return h},HMc:function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x={clipX:0,clipY:0,clipHeight:0,clipWidth:0,paintX:0,paintY:0,paintHeight:0,paintWidth:0},T=e.customWidth*r,A=e.customHeight*r;if(null===T||T<0||null===A||T<0)return x;if(i=t.width,a=t.height,s=t.x,l=t.y,u={imgWidth:e.width,imgHeight:e.height,offsetX:0,offsetY:0},c=(u=this.GMc(u,e,o)).imgWidth,h=u.imgHeight,f=u.offsetX,p=u.offsetY,d=n.hAlign,g=n.vAlign,i<T){switch(x.paintWidth=i,x.paintX=s,y=(m=(T-i)/T)*c,d){case S.HorizontalAlign.left:x.clipX=u.offsetX;break;case S.HorizontalAlign.center:x.clipX=u.offsetX+y/2;break;case S.HorizontalAlign.right:x.clipX=u.offsetX+y}x.clipWidth=u.imgWidth*(1-m)}else{switch(x.clipWidth=c,x.clipX=0,b=i-(x.paintWidth=T),d){case S.HorizontalAlign.general:case S.HorizontalAlign.left:x.paintX=s;break;case S.HorizontalAlign.center:x.paintX=s+b/2;break;case S.HorizontalAlign.right:x.paintX=s+b}x.clipX+=f}if(a<A){switch(x.paintY=l,C=(v=(A-(x.paintHeight=a))/A)*h,g){case S.VerticalAlign.top:x.clipY=u.offsetY;break;case S.VerticalAlign.center:x.clipY=u.offsetY+C/2;break;case S.VerticalAlign.bottom:x.clipY=u.offsetY+C}x.clipHeight=u.imgHeight*(1-v)}else{switch(x.clipHeight=N(o.clipHeight)?h:u.imgHeight,x.clipY=0,w=a-(x.paintHeight=A),g){case S.VerticalAlign.top:x.paintY=l;break;case S.VerticalAlign.center:x.paintY=l+w/2;break;case S.VerticalAlign.bottom:x.paintY=l+w}x.clipY+=p}return x},GMc:function(t,e,o){var n=e.width,r=e.height;return N(o.clipX)||(t.offsetX=u(n,o.clipX)),N(o.clipY)||(t.offsetY=u(r,o.clipY)),N(o.clipWidth)?t.imgWidth=n-t.offsetX:t.imgWidth=o.clipWidth+t.offsetX>n?n-t.offsetX:o.clipWidth,N(o.clipHeight)?t.imgHeight=r-t.offsetY:t.imgHeight=o.clipHeight+t.offsetY>r?r-t.offsetY:o.clipHeight,t},paint:function(t,e,o,n,r,i,a){var s,l={x:o,y:n,width:r,height:i},u=a.sheet.vu();try{s=e.url,u.ko(s)?this.IMc(t,e,l,a):u.fo(s)}catch(t){}},IMc:function(t,e,o,n){var r,i,a,s,l,u,c=e.url,h=n.sheet,f=e.drawType,p=h.bt;if(c&&"string"==typeof c&&p.bgc(c)){switch(i={width:(r=p.lo(c)).width,height:r.height},a={clipY:e.clipY,clipX:e.clipX,clipWidth:e.clipWidth,clipHeight:e.clipHeight},s={vAlign:e.vAlign,hAlign:e.hAlign},u=n.zoomFactor,f){case G.fit:l=this.CMc(o,i,a,s,u);break;case G.entireFit:l=this.EMc(o,i,a,s,u);break;case G.originFit:l=this.FMc(o,i,a,s,u);break;case G.custom:i.customWidth=e.width,i.customHeight=e.height,l=this.HMc(o,i,a,s,u)}l.img=r,x.IMAGESPARKLINE(t,l,o.x,o.y,o.width,o.height,n)}}}),Lt(ve,Pt=J),ut=ve,i((e.LineSparkline=ut).prototype,{createFunction:function(){return pe("LINESPARKLINE",0)},paint:de}),Lt(be,Ft=J),ct=be,i((e.ColumnSparkline=ct).prototype,{createFunction:function(){return pe("COLUMNSPARKLINE",1)},paint:de}),Lt(ye,Ot=J),ht=ye,i((e.WinlossSparkline=ht).prototype,{createFunction:function(){return pe("WINLOSSSPARKLINE",2)},paint:de}),Lt(me,_t=J),ft=me,i((e.RangeBlockSparkline=ft).prototype,{createFunction:function(){var t=new o("RANGEBLOCKSPARKLINE",2,2);return t.evaluate=function(t){var e=t[0],o=e.source.getSheet(),n=t[1],r=n.getSource().getSheet(),i=n.getRow(0),a=n.getColumn(0),s=n.getRowCount(0),l=n.getColumnCount(0),u=new S.Range(e.row,e.column,1,1),c=new S.Range(i,a,s,l);if(o.name()===r.name()&&c.containsRange(u))throw I.CalcError;return{templateSheetName:r.name(),templateRange:{row:i,col:a,rowCount:s,colCount:l},bindingObject:t[2]}},t.isContextSensitive=function(){return!0},t.acceptsReference=Ht,t},paint:function(t,e,o,n,r,i,a){var s,l,u,c,h,f=e.templateSheetName,p=e.templateRange;!f||(l=(s=a.sheet.parent)&&s.getSheetFromName(f))&&(m||(u=d("CellTypes"),m=u.Xgc,g=u.Wgc,y=u.paintRangeTemplate),c=(new m).YE(l,p),h=(new g).YE(l,p),y(t,{x:o,y:n,width:r,height:i},e.bindingObject,a,c,h.NJb))}}),Lt(ge,jt=J),pt=ge,i((e.GaugeKPISparkline=pt).prototype,{createFunction:function(){var t=new o(z,4,255);return t.evaluate=function(t){var e,o,n,r,i,a,s,l,u,c,h,f=[],p=t.length,d=qt(t[0]),g=qt(t[1]),m=qt(t[2]),y=qt(t[3]),b=qt(t[5]),v=qt(t[6]),C=qt(t[7]),w=qt(t[8]),x=qt(t[10]),T=qt(t[11]),A=qt(t[12]),S=t[4],M=t[13];if(!function(t,e,o,n,r,i,a,s){if(!(N(t)||N(e)||N(o)||N(n))&&!(k(t)||k(e)||k(o)||k(n))&&!(n<=o||e<o||n<e||t<o||n<t)&&(N(a)||0===a||1===a||2===a)){if(0===a||N(a)){if(!N(r)&&!N(i)&&(k(i)||k(r)||i<=r||r<-180||180<i))return;if(!N(s)&&(k(s)||1<s||s<0))return}return 1}}(d,g,m,y,x,T,M,A))return R;for(t[9]instanceof I.CalcArray&&(o=(l=t[9].toArray(2))[0],n=l[1],r=l[2],i=l[3]),o=o||"16px Calibri",n=n||"bold 22px Calibri",r=r||E,i=i||E,b=N(b)?d:b,v=N(v)?g:v,C=N(C)?m:C,w=N(w)?y:w,u={minAngle:N(x)?-90:x,maxAngle:N(T)?90:T,radiusRatio:N(A)?0:A,targetValueOption:Ce(d,o,b),currentValueOption:Ce(g,n,v),minValueOption:Ce(m,r,C),maxValueOption:Ce(y,i,w),gaugeType:N(M)?0:M,ranges:void 0,showLabel:!!N(S)||!!S},c=14;c<p;c++)if((h=t[c])instanceof I.CalcArray){if(a=(e=h.toArray(0))[0],s=e[1],N(a)||N(s)||k(a)||k(s)||s<a||a<m||y<a||y<s||s<m)return R;f.push({start:a,end:s,color:e[2]})}return u.ranges=f,u},t.acceptsArray=function(t){return 9===t||14<=t},t.acceptsReference=function(t){return t<=3&&0<=t||5<=t&&t<=8||10<=t&&t<=12},t},paint:function(t,e,o,n,r,i,a){var s=a.zoomFactor;e.currentValueOption.fontAfterZoom=l(e.currentValueOption.font,s).font,e.targetValueOption.fontAfterZoom=l(e.targetValueOption.font,s).font,e.minValueOption.fontAfterZoom=l(e.minValueOption.font,s).font,e.maxValueOption.fontAfterZoom=l(e.maxValueOption.font,s).font,x[z](t,e,o,n,r,i,a)}}),dt={},e.w_a=dt,o&&(we(new Z),we(new q),we(new K),we(new Y),we(new Q),we(new X),we(new $),we(new tt),we(new et),we(new ot),we(new nt),we(new rt),we(new it),we(new at),we(new ut),we(new ct),we(new ht),we(new ft),we(new pt),we(new st),we(new lt)),i(S.Workbook.prototype,{addSparklineEx:function(t){this.dT||(this.dT={});var e=this.dT;t&&(e[t.name()]=t)},getSparklineEx:function(t){var e,o=dt[t];return o||(e=this.dT)&&e[t]},removeSparklineEx:function(t){var e=this.dT;e&&(e[t]=void 0)}}),S.Workbook.$n("sparklineEx",{toJson:function(t){var e,o,n=this.dT,r=[];if(n){for(e in n)n.hasOwnProperty(e)&&((o=n[e].toJSON())&&o.typeName&&r.push(o));0<r.length&&(t.sparklineExs=r)}},fromJson:function(t){var e,o,n,r,i=t.sparklineExs;if(i)for(e=0;e<i.length;e++)o=i[e],(n=S.getTypeFromString(o.typeName))&&((r=new n).fromJSON(o),this.addSparklineEx(r))}})},"./dist/plugins/sparkline/sparkline-wrapper.entry.js":function(t,e,o){"use strict";var n,r;Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/sparkline/functions-sparkline.js"),e.w_a=n.w_a,e.PieSparkline=n.PieSparkline,e.AreaSparkline=n.AreaSparkline,e.ScatterSparkline=n.ScatterSparkline,e.BulletSparkline=n.BulletSparkline,e.SpreadSparkline=n.SpreadSparkline,e.StackedSparkline=n.StackedSparkline,e.HBarSparkline=n.HBarSparkline,e.VBarSparkline=n.VBarSparkline,e.VariSparkline=n.VariSparkline,e.BoxPlotSparkline=n.BoxPlotSparkline,e.CascadeSparkline=n.CascadeSparkline,e.ParetoSparkline=n.ParetoSparkline,e.MonthSparkline=n.MonthSparkline,e.YearSparkline=n.YearSparkline,e.LineSparkline=n.LineSparkline,e.ColumnSparkline=n.ColumnSparkline,e.WinlossSparkline=n.WinlossSparkline,e.RangeBlockSparkline=n.RangeBlockSparkline,e.GaugeKPISparkline=n.GaugeKPISparkline,e.SparklineEx=n.SparklineEx,e.SparklineExValue=n.SparklineExValue,e.HistogramSparkline=n.HistogramSparkline,e.ImageSparkline=n.ImageSparkline,r=o("./dist/plugins/sparkline/sparkline-wrapper.js"),e.EmptyValueStyle=r.EmptyValueStyle,e.SparklineAxisMinMax=r.SparklineAxisMinMax,e.SparklineSetting=r.SparklineSetting,e.SparklineType=r.SparklineType,e.DataOrientation=r.DataOrientation,e.Sparkline=r.Sparkline},"./dist/plugins/sparkline/sparkline-wrapper.js":function(t,e,o){"use strict";var M,p,d,r,l,I,N,n,g,C,i,m,c,S,v,w,h,a,s,u,f,y,b,x,T,A,R,k,E,D;function j(t,e){var o=r.formulaToRanges(t,e,0,0)[0],n=o&&o.ranges&&o.ranges[0];return n?{range:n,sheetName:o.sheetName}:S}function _(t,e,o,n){var r=this.ZA;r.JUa(t,e,n),n&&r.add(n.group()),this.Bq("sparkline",t,e,3,o,n)}function O(t){this.Ub=[],this.kj=t,this.xn={},this.qZa=[],this.rZa=[]}function F(t,e,o){return o?t>o.row+o.rowCount-1?o:t>o.row?I(o.row,o.col,o.rowCount+e,o.colCount):I(o.row+e,o.col,o.rowCount,o.colCount):S}function P(t,e,o){return o?t>o.col+o.colCount-1?o:t>o.col?I(o.row,o.col,o.rowCount,o.colCount+e):I(o.row,o.col+e,o.rowCount,o.colCount):S}function L(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g=new M.KTa;for(i=0;i<t.length;i++)for(s=(a=t[i]).PS,a.displayDateAxis&&(l=(n?F:P)(e,o,a.dateAxisData()),a.dateAxisData(l)),u=0;u<s.length;u++)c=s[u],e<=(n?c.row:c.column)&&(g.set(i,u,c),r.JUa(c.row,c.column,S),n?c.row+=o:c.column+=o),h=(n?F:P)(e,o,c.data()),c.data(h);for(f=0;f<t.length;f++)for(p=t[f].PS,d=0;d<p.length;d++)r.SUa(g.get(f,d))}function H(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y;for(a=0;a<n.length;a++)(s=n[a]).displayDateAxis&&(u=(l=s.OW())._modelManager,c=!1,i&&!u.zTa&&(u.zTa=[],c=!0),h=(o?F:P)(t,e,s.dateAxisData()),s.dateAxisData(h),c&&(i.push({sheetName:l.name(),changes:u.zTa}),u.zTa=v));for(f=0;f<r.length;f++)g=(d=(p=r[f]).bT())._modelManager,m=!1,i&&!g.zTa&&(g.zTa=[],m=!0),y=(o?F:P)(t,e,p.data()),p.data(y),m&&(i.push({sheetName:d.name(),changes:g.zTa}),g.zTa=v)}function B(t,e,o){var n=z(o.col,o.col+o.colCount-1,t,t+e-1);return n?I(o.row,n.start,o.rowCount,n.end-n.start+1):S}function V(t,e,o){var n=z(o.row,o.row+o.rowCount-1,t,t+e-1);return n?I(n.start,o.col,n.end-n.start+1,o.colCount):S}function z(t,e,o,n){var r,i,a,s,l,u=-1;if(n<t)return{start:u=t-(i=n-o+1),end:e-i};if(e<o)return{start:u=t,end:e};if(o<=t){for(a=e-t+1,s=0,r=t;r<=n&&r<=e;r++)s++;return{start:u=o,end:u+a-s-1}}for(l=0,r=t;r<=e;r++)-1===u&&(r<o||n<r)&&(u=r),(r<o||n<r)&&l++;return-1!==u&&0<l?{start:u,end:u+l-1}:S}function W(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y=new M.KTa,b=t.length,v=0;for(i=b-1;-1<i;i--){if((a=t[i]).displayDateAxis){if(s=(n?V:B)(e,o,a.dateAxisData()),N(s)){a.clear(),r.remove(a);continue}a.dateAxisData(s)}for(l=(l=[]).concat(a.PS),u=C(l),v=w(u,v),c=u-1;-1<c;c--)h=l[c],e<=(f=n?h.row:h.column)&&f<e+o?(a.remove(h),r.JUa(h.row,h.column,S)):(e<=f&&(r.JUa(h.row,h.column,S),n?h.row-=o:h.column-=o,y.set(i,c,h)),p=(n?V:B)(e,o,h.data()),N(p)?a.remove(h):h.data(p));a.count()<=0&&r.remove(a)}for(g=0;g<b;g++)for(m=0;m<v;m++)(d=y.get(g,m))&&r.SUa(d)}function G(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y,b;for(a=n.length-1;-1<a;a--)(s=n[a]).displayDateAxis&&(u=(l=s.OW())._modelManager,c=!1,i&&!u.zTa&&(u.zTa=[],c=!0),h=(o?V:B)(t,e,s.dateAxisData()),N(h)?(s.clear(),s.ZA.remove(s)):s.dateAxisData(h),c&&(i.push({sheetName:l.name(),changes:u.zTa}),u.zTa=v));for(f=r.length-1;-1<f;f--)g=(d=(p=r[f]).bT())._modelManager,m=!1,i&&!g.zTa&&(g.zTa=[],m=!0),y=(o?V:B)(t,e,p.data()),N(y)?((b=p.group()).remove(p),b.count()<=0&&b.ZA.remove(b)):p.data(y),m&&(i.push({sheetName:d.name(),changes:g.zTa}),g.zTa=v)}function U(t,e){this.displayDateAxis=!1,this.ZA=S,this.PS=[],this.XS=S,this.YS=1,this.setting=e,this.sparklineType=t}function J(t){var e;for(e in this.options={},b)b.hasOwnProperty(e)&&(this.options[e]=t&&t[e]?t[e]:b[e]);this.WS=S}function Z(t,e,o,n,r,i){this.row=t,this.column=e,this._S=n,this.aT=o,this.cb=new T(r,i),this.cb.add(this)}Object.defineProperty(e,"__esModule",{value:!0}),M=o("Core"),p=o("@grapecity/js-sheets-common"),d=o("@grapecity/js-calc"),r=o("SheetsCalc"),l=M.GC$.isEmptyObject,I=M.kf,N=p.Common.j.Fa,n=p.Common.k,g=n.Fb,C=n.ac,i=n.Bb,m=p.Sparklines.Vd,c=p.Sparklines.SparklineRender,S=null,v=void 0,w=Math.max,h=Number.MAX_VALUE,M.GC$.extend(M.lUa.prototype,{FUa:function(t){var e,o,n=this.zTa,r=arguments[1];if(n){switch(n.GUa||(n.GUa=[]),e={type:t},t){case 0:o=r&&r.sparkline?r.sparkline:S,e.HUa={row:r.row,col:r.col,sparkline:o};break;case 12:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:e.HUa=r}n.GUa.push(e)}},IUa:function(t){var e,o,n,r,i,a,s,l,u,c,h,f=this,p=t.HUa;switch(t.type){case 12:p.sparkline?(p.sparkline.row=p.row,p.sparkline.column=p.col,f.ZA.JUa(p.row,p.col,p.sparkline)):f.ZA.JUa(p.row,p.col,S);break;case 0:f.ZA.JUa(p.row,p.col,p.sparkline),p.sparkline&&!f.ZA.contains(p.sparkline.group())&&f.ZA.add(p.sparkline.group());break;case 1:for(n=o=e=void 0,r=C(p),i=0;i<r;i++)e=p[i].row,o=p[i].col,n=f.ZA.KUa(e,o),0===i&&n.cb.count()===r&&f.ZA.remove(n.cb),this.ZA.add(n.group(p[i].group).cb);break;case 2:for(a=[],s=0;s<C(p);s++)a.push(f.ZA.KUa(p[s].row,p[s].col));f.ZA.kj.groupSparkline(a);break;case 3:f.ZA.KUa(p.row,p.col).sparklineType(p.sparklineType);break;case 4:f.ZA.KUa(p.row,p.col).setting(p.setting);break;case 5:p.sparkline.data(p.data);break;case 15:f.ZA.KUa(p.row,p.col).dataSheetName(p.dataSheetName);break;case 6:f.ZA.KUa(p.row,p.col).dataOrientation(p.dataOrientation);break;case 7:f.ZA.KUa(p.row,p.col).displayDateAxis(p.displayDateAxis);break;case 8:l=(u=p.rangeInfo)?I(u.row,u.col,u.rowCount,u.colCount):u,p.group.dateAxisData(l);break;case 16:p.group.dateAxisDataSheetName(p.dateAxisDataSheetName);break;case 9:p.group.dateAxisOrientation(p.dateAxisOrientation);break;case 10:for(p.group.PS.forEach(function(t){f.ZA.vZa(t)}),p.group.PS=p.PS,c=p.group.PS,h=0;h<C(c);h++)c[h].group(p.group);c.forEach(function(t){f.ZA.tZa(t)});break;case 11:f.ZA.KUa(p.row,p.col).group(p.group);break;case 13:g(f.ZA.groups(),p),f.ZA.yZa(p);break;case 14:f.ZA.groups().push(p),f.ZA.zZa(p)}},LUa:function(t){var e;for(e=C(t)-1;0<=e;e--)this.IUa(t[e])},MUa:function(t,e){this.ZA.rI(t,e)},NUa:function(t,e){this.ZA.GR(t,e)},OUa:function(t,e){this.ZA.tI(t,e)},PUa:function(t,e){this.ZA.HR(t,e)},QUa:function(t,e,o,n){this.ZA.clear(t,e,o,n)},wZa:function(){var t=this.zTa;return t?(t.xZa||(t.xZa=[]),t.xZa):S}}),M.lUa.$n("sparkline",{init:function(){var t=this.kj;this.ZA=new u(t)},undo:function(t){var e,o,n=t.GUa;n&&this.LUa(n),e=this.kj,(o=t.xZa)&&o.forEach(function(t){e.parent.getSheetFromName(t.sheetName)._modelManager.undo(t.changes)})}}),a={init:function(){this.ZA=this._modelManager.ZA},dispose:function(t){if(!1!==t.clearCache){this.ZA&&(this.ZA.kj=S,this.ZA.evaluator=S,this.ZA=S),this._modelManager&&(this._modelManager.ZA=S)}},onLayoutChanged:function(t){var e,o=t.changeType,n=t.row,r=t.rowCount,i=t.col,a=t.colCount,s=this._modelManager;"addRows"===o?s.MUa(n,r):"deleteRows"===o?s.NUa(n,r):"addColumns"===o?s.OUa(i,a):"deleteColumns"===o?s.PUa(i,a):"clear"===o&&(e=t.type,3===t.sheetArea&&16==(16&e)&&s.QUa(n,i,r,a))},toJson:function(t,e){e&&e.ignoreStyle||(t.sparklineGroups=this.ZA.toJSON())},fromJson:function(t,e,o){var n=o&&o.ignoreStyle,r=this.ZA,i=t.sparklineGroupManager,a=e?i&&i.groups:t.sparklineGroups;a&&!n&&r.RUa(a,e)},setName:function(t){var e=t.oldName,o=t.newName;this.ZA.jOa(e,o)}},M.Worksheet.$n("sparkline",a),s={getSparkline:function(t,e){return this.ZA?this.ZA.KUa(t,e):S},setSparkline:function(t,e,o,n,r,i,a,s){var l,u,c,h,f,p;if(!this.ZA)return S;if("string"==typeof o){if(!(u=j(this,o)))return S;o=u.range,l=u.sheetName}if(c=new A(t,e,o,n,r,i),l&&l!==this.name()&&c.dataSheetName(l),a&&!N(s)){if(h=void 0,"string"==typeof a){if(!(f=j(this,a)))return S;a=f.range,h=f.sheetName}c.dateAxisData(a),h&&h!==this.name()&&c.dateAxisDataSheetName(h),c.dateAxisOrientation(s),c.group().displayDateAxis=!0}return p=this.getSparkline(t,e),this.removeSparkline(t,e),_.call(this,t,e,p,c),this.$p(),c},WLb:function(t,e,o){var n=this.getSparkline(t,e);_.call(this,t,e,n,o)},removeSparkline:function(t,e){var o,n,r,i=this.ZA;i&&(n={row:t,col:e,sparkline:o=this.getSparkline(t,e)},this._modelManager.FUa(0,n),o&&((r=o.group()).remove(o),r.count()<=0&&i.remove(r),_.call(this,t,e,o,S)),this.$p())},groupSparkline:function(t){var e,o,n,r,i,a,s=this.ZA;if(!s)return S;for(e=S,o=[],n=this._modelManager.zTa!==v,r=0;r<t.length;r++)(i=t[r])&&(n&&o.push({group:i.group().clone(),row:i.row,col:i.column}),e?((a=i.group()).remove(i),e.add(i),a.count()<=0&&s.remove(a)):e=i.group());return this.$p(),this._modelManager.FUa(1,o),e},ungroupSparkline:function(t){var e,o,n,r,i,a,s=this.ZA;if(s&&t){for(e=[],o=[],n=this._modelManager.zTa!==v,e=e.concat(t.PS),r=0;r<e.length;r++)(i=e[r])&&(n&&o.push({row:i.row,col:i.column}),t.remove(i),(a=t.clone()).add(i),s.add(a));s.remove(t),this._modelManager.FUa(2,o),this.$p()}}},M.GC$.extend(M.Worksheet.prototype,s),O.prototype.RUa=function(t,e){var o=this;o.fromJSON(t,e),o.groups().forEach(function(t){t.PS.forEach(function(t){o.SUa(t)})})},O.prototype.SUa=function(t){t&&this.JUa(t.row,t.column,t)},O.prototype.JUa=function(t,e,o){if(this.kj._modelManager.zTa){var n={row:t,col:e,sparkline:this.KUa(t,e)};this.kj._modelManager.FUa(12,n)}o?this.xn[t+"_"+e]=o:delete this.xn[t+"_"+e]},O.prototype.KUa=function(t,e){return this.xn[t+"_"+e]||S},O.prototype.groups=function(t){return 0===arguments.length?this.Ub:void(this.Ub=t)},O.prototype.add=function(t){this.kj._modelManager.FUa(13,t),this.groups().push(t),t.ZA=this,t.QS(),this.zZa(t)},O.prototype.zZa=function(t){var e=this;e.sZa(t),t.all().forEach(function(t){e.tZa(t)})},O.prototype.remove=function(t){this.kj._modelManager.FUa(14,t),g(this.groups(),t),this.yZa(t)},O.prototype.yZa=function(t){var e=this;e.uZa(t),t.all().forEach(function(t){e.vZa(t)})},O.prototype.contains=function(t){return i(this.groups(),t)},O.prototype.count=function(){return this.groups().length},O.prototype.rI=function(t,e){L(this.Ub,t,e,!0,this),H(t,e,!0,this.rZa,this.qZa,this.kj._modelManager.wZa())},O.prototype.tI=function(t,e){L(this.Ub,t,e,!1,this),H(t,e,!1,this.rZa,this.qZa,this.kj._modelManager.wZa())},O.prototype.GR=function(t,e){W(this.Ub,t,e,!0,this),G(t,e,!0,this.rZa,this.qZa,this.kj._modelManager.wZa())},O.prototype.HR=function(t,e){W(this.Ub,t,e,!1,this),G(t,e,!1,this.rZa,this.qZa,this.kj._modelManager.wZa())},O.prototype.jOa=function(e,o){this.rZa.forEach(function(t){t.dateAxisDataSheetName()===e&&t.dateAxisDataSheetName(o)}),this.qZa.forEach(function(t){t.dataSheetName()===e&&t.dataSheetName(o)})},O.prototype.tZa=function(t){var e,o,n=this.kj,r=t.dataSheetName();r&&r!==n.name()&&(!(e=n.parent.getSheetFromName(r))||(o=e.ZA.qZa).indexOf(t)<0&&o.push(t))},O.prototype.vZa=function(t){var e,o,n,r=t.dataSheetName();r&&(!(e=this.kj.parent.getSheetFromName(r))||0<=(n=(o=e.ZA.qZa).indexOf(t))&&o.splice(n,1))},O.prototype.sZa=function(t){var e,o,n=this.kj,r=t.dateAxisDataSheetName();r&&r!==n.name()&&(!(e=n.parent.getSheetFromName(r))||(o=e.ZA.rZa).indexOf(t)<0&&o.push(t))},O.prototype.uZa=function(t){var e,o,n,r=t.dateAxisDataSheetName();r&&(!(e=this.kj.parent.getSheetFromName(r))||0<=(n=(o=e.ZA.rZa).indexOf(t))&&o.splice(n,1))},O.prototype.clear=function(t,e,o,n){var r,i,a,s,l,u,c,h,f;if(0===arguments.length){for(r=this.Ub,i=C(r)-1;-1<i;i--)if(a=r[i]){for(s=a.count()-1;-1<s;s--)l=a.PS[s],this.JUa(l.row,l.column,S),a.remove(l);this.remove(a)}}else for(u=t;u<t+o;u++)for(c=e;c<e+n;c++)(h=this.RS(u,c))&&(this.JUa(h.row,h.column,S),(f=h.group()).remove(h),0===f.count()&&this.remove(f))},O.prototype.RS=function(t,e){var o,n,r,i,a=this.Ub;for(o=0;o<a.length;o++)for(n=a[o],r=0;r<n.count();r++)if((i=n.PS[r])&&i.row===t&&i.column===e)return i;return S},O.prototype.Zz=function(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S=this.kj;if(S){for(l=new M.KTa,u=o-t,c=n-e,p=S.getRowCount(),d=S.getColumnCount(),y=r,b=i,v=S.ZA,C=!s&&S.KLc(),g=h=0;h<r&&o+h<p;h++)if(C&&0===S.getRowHeight(o+h))r++;else if(a&&S.Ps&&S.Ps(o+h))g++;else{for(m=f=0,i=b;f<i&&n+f<d;f++)C&&0===S.getColumnWidth(n+f)?i++:((w=S.getSparkline(t+g,e+m))&&((x=w.clone()).row=o+h,x.column=n+f,T=x.dateAxisData(),C&&(u=o-t+h-g,c=n-e+f-m),!N(T)&&this.SS(T,u,c,p,d)&&x.dateAxisData(T.offset(c,u)),A=x.data(),!N(A)&&this.SS(A,u,c,p,d)&&x.data(A.offset(c,u)),this.add(x.group()),l.set(h,f,x)),m++);g++}for(h=0,r=y;h<r&&o+h<p;h++)if(C&&0===S.getRowHeight(o+h))r++;else if(!(a&&S.Ps&&S.Ps(o+h)))for(f=0,i=b;f<i&&n+f<d;f++)C&&0===S.getColumnWidth(n+f)?i++:v.JUa(o+h,n+f,l.get(h,f))}},O.prototype.SS=function(t,e,o,n,r){var i,a,s,l,u=this.TS(t);return!(!u||(i=w(u.row,0),a=w(u.col,0),s=u.row<0?n:u.rowCount,l=u.col<0?r:u.colCount,i+e<0||a+o<0||n<i+s+e||r<a+l+o))},O.prototype.aB=function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y,b=this.kj;if(b){for(l=b.KLc(),u=i,c=r,this.US(t,e,o,n,r,i),h=b.ZA,f=new M.KTa,g=b.getRowCount(),m=b.getColumnCount(),a=p=0;p<r&&p+o<g;p++)if(l&&0===b.getRowHeight(o+p))r++;else{for(s=d=0,i=u;d<i&&n+d<m;d++)l&&0===b.getColumnWidth(n+d)?i++:((y=b.getSparkline(t+a,e+s))&&(y.row=o+p,y.column=n+d,f.set(a,s,y)),h.JUa(t+a,e+s,S),s++);a++}for(a=p=0,r=c;p<r&&p+o<g;p++)if(l&&0===b.getRowHeight(o+p))r++;else{for(s=d=0,i=u;d<i&&n+d<m;d++)l&&0===b.getColumnWidth(n+d)?i++:(b.removeSparkline(o+p,n+d),h.JUa(o+p,n+d,f.get(a,s)),s++);a++}}},O.prototype.US=function(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S=this;if(a&&(S=a),l=(s=S.kj).KLc(),u=I(t,e,r,i),f=i,y=s.getRowCount(),b=s.getColumnCount(),v=S.Ub,l)for(m=d=0;d<r&&d+o<y;d++)if(0!==s.getRowHeight(o+d)){for(g=p=0,i=f;p<i&&p+n<b;p++)if(0!==s.getColumnWidth(n+p)){if(C=s.getSparkline(t+m,e+g))for(c=o-t+d-m,h=n-e+p-g,w=C.cb.PS,x=0;x<w.length;x++)(T=w[x])&&S.JMc(T,c,h,u);g++}else i++;m++}else r++;else for(c=o-t,h=n-e,x=0;x<v.length;x++)for(w=v[x].PS,A=0;A<w.length;A++)(C=w[A])&&S.JMc(C,c,h,u)},O.prototype.JMc=function(t,e,o,n){var r,i,a=t.dateAxisData(),s=this.TS(a);s&&n.containsRange(s)&&n.contains(t.row,t.column)&&t.dateAxisData(a.offset(o,e)),r=t.data(),(i=this.TS(r))&&n.containsRange(i)&&n.contains(t.row,t.column)&&t.data(r.offset(o,e))},O.prototype.TS=function(t){return t},O.prototype._A=function(t,e,o,n,r,i,a,s,l){var u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A=this.kj;if(A){if(t===A)return void this.Zz(e,o,n,r,i,a);for(u=n-e,c=r-o,h=A.ZA,f=!l&&A.KLc(),p=A.getRowCount(),d=A.getColumnCount(),g=a,b=m=0;m<i&&n+m<p;m++)if(f&&0===A.getRowHeight(n+m))i++;else if(s&&A.Ps&&A.Ps(n+m))b++;else{for(v=y=0,a=g;y<a&&r+y<d;y++)f&&0===A.getColumnWidth(r+y)?a++:((C=t.getSparkline(e+b,o+v))?((w=C.clone()).row=n+m,w.column=r+y,x=w.dateAxisData(),f&&(u=n+m-e-b,c=r-o+y-v),!N(x)&&this.SS(x,u,c,p,d)&&w.dateAxisData(x.offset(c,u)),T=w.data(),!N(T)&&this.SS(T,u,c,p,d)&&w.data(T.offset(c,u)),this.add(w.group()),h.JUa(n+m,r+y,w)):h.JUa(n+m,r+y,S),v++);b++}}},O.prototype.$A=function(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m,y,b=this.kj;if(b){if(t===b)return void this.aB(e,o,n,r,i,a);for(s=b.KLc(),l=a,u=t.ZA,c=b.ZA,p=b.getRowCount(),d=b.getColumnCount(),this.VS(t,e,o,n,r,i,a),h=0;h<i&&n+h<p;h++)if(s&&0===b.getRowHeight(n+h))i++;else for(f=0,a=l;f<a&&r+f<d;f++)s&&0===b.getColumnWidth(r+f)?a++:((g=t.getSparkline(e+0,o+0))?(g.row=n+h,g.column=r+f,y=(m=g.group()).clone(),m.remove(g),m.count()<=0&&u.remove(m),y.add(g),this.add(y),c.JUa(n+h,r+f,g)):c.JUa(n+h,r+f,S),u.JUa(e+0,o+0,S))}},O.prototype.VS=function(t,e,o,n,r,i,a){var s=this.kj;t&&s&&this.US(e,o,n,r,i,a,t.ZA)},O.prototype.toJSON=function(){var t,e=this.Ub,o=[];for(t=0;e&&t<e.length;t++)o.push(e[t].toJSON());return 0===o.length?v:o},O.prototype.fromJSON=function(t,e){var o,n,r;for(this.Ub.length=0,this.xn={},o=0;t&&o<t.length;o++)n=t[o],(r=new T).fromJSON(n,e),this.add(r)},u=O,(D=e.EmptyValueStyle||(e.EmptyValueStyle={}))[D.gaps=0]="gaps",D[D.zero=1]="zero",D[D.connect=2]="connect",(E=e.SparklineAxisMinMax||(e.SparklineAxisMinMax={}))[E.individual=0]="individual",E[E.group=1]="group",E[E.custom=2]="custom",f=p.Common.pc.bc(255,149,179,215),y=p.Common.pc.bc(255,36,64,98),b={axisColor:"black",firstMarkerColor:f,highMarkerColor:"Blue",lastMarkerColor:f,lowMarkerColor:"Blue",markersColor:y,negativeColor:"Brown",seriesColor:y,displayEmptyCellsAs:0,rightToLeft:!1,displayHidden:!1,displayXAxis:!1,showFirst:!1,showHigh:!1,showLast:!1,showLow:!1,showNegative:!1,showMarkers:!1,manualMax:0,manualMin:0,maxAxisType:0,minAxisType:0,lineWeight:1},J.prototype.clone=function(){return new J(this.options)},J.prototype.toJSON=function(){var t,e=this.options,o={};for(t in e)b[t]!==e[t]&&(o[t]=e[t]);return l(o)?v:o},x=J,e.SparklineSetting=x,(k=e.SparklineType||(e.SparklineType={}))[k.line=0]="line",k[k.column=1]="column",k[k.winloss=2]="winloss",(R=e.DataOrientation||(e.DataOrientation={}))[R.vertical=0]="vertical",R[R.horizontal=1]="horizontal",U.prototype.OW=function(){var t;return this.ZA&&(t=this.ZA.kj),t},U.prototype.TUa=function(){var t,e=this.OW();e&&e._modelManager.zTa&&(t={group:this,PS:this.PS.concat()},e._modelManager.FUa(10,t))},U.prototype.add=function(t){var e;t&&(this.TUa(),this.PS.push(t),t.group(this),this.QS(),(e=this.ZA)&&e.tZa(t),this.onGroupChanged())},U.prototype.clear=function(){this.TUa();var e=this.ZA;e&&this.PS.forEach(function(t){e.vZa(t)}),this.PS=[]},U.prototype.all=function(){return this.PS},U.prototype.remove=function(t){var e,o=this.PS;return this.TUa(),g(o,t),t.onSparklineChanged(),t.cb=this.clone(),this.QS(),(e=this.ZA)&&e.vZa(t),this.onGroupChanged(),o},U.prototype.contains=function(t){return i(this.PS,t)},U.prototype.onGroupChanged=function(){var t,e,o=this.PS;if(o)for(t=0;t<o.length;t++)(e=o[t])&&e.onSparklineChanged()},U.prototype.clone=function(){var t=this.setting?this.setting.clone():S,e=new U(this.sparklineType,t);return e.displayDateAxis=this.displayDateAxis,e.XS=this.XS,e.nZa=this.nZa,e.YS=this.YS,e},U.prototype.dateAxisData=function(t){var e,o,n=this;return 0===arguments.length?n.XS:((e=n.OW())&&e._modelManager.zTa&&(o={group:n,rangeInfo:n.XS?{row:n.XS.row,col:n.XS.col,rowCount:n.XS.rowCount,colCount:n.XS.colCount}:S},e._modelManager.FUa(8,o)),void(n.XS!==(n.XS=t)&&n.onGroupChanged()))},U.prototype.dateAxisDataSheetName=function(t){var e,o,n;return 0===arguments.length?this.nZa:(e=this.nZa,(o=this.OW())&&o._modelManager.zTa&&(n={group:this,dateAxisDataSheetName:e},o._modelManager.FUa(16,n)),e!==t&&(e&&o&&o.ZA.uZa(this),(this.nZa=t)&&o&&o.ZA.sZa(this),this.onGroupChanged()),this)},U.prototype.dateAxisOrientation=function(t){var e,o;return 0===arguments.length?this.YS:((e=this.OW())&&e._modelManager.zTa&&(o={group:this,dateAxisOrientation:this.YS},e._modelManager.FUa(9,o)),void(this.YS!==(this.YS=t)&&this.onGroupChanged()))},U.prototype.count=function(){return this.PS.length},U.prototype.QS=function(){var t,e,o,n,r,i,a,s,l=this.setting,u=this.PS;if(l&&((t=l.options).groupMaxValue=-h,t.groupMinValue=h,e=1===t.maxAxisType,o=1===t.minAxisType,e||o))for(n=0;n<u.length;n++)r=u[n],a=(i=this.ZS(r)).min,s=i.max,e&&t.groupMaxValue<s&&(t.groupMaxValue=s),o&&t.groupMinValue>a&&(t.groupMinValue=a)},U.prototype.ZS=function(t){var e,o,n,r,i,a=-h,s=h,l=t.data();if(l)for(o=(e=t.bT())&&e.parent.getSheetFromName(t.dataSheetName()),n=t.$S(l,t.dataOrientation(),!1,o||e),r=0;r<n.length;r++)(i=n[r])===m&&(i=0),"number"==typeof i&&(a=a<i?i:a,s=i<s?i:s);return{min:s,max:a}},U.prototype.toJSON=function(){var t,e,o,n,r,i,a={setting:this.setting?this.setting.toJSON():S,displayDateAxis:this.displayDateAxis,sparklineType:this.sparklineType,axisOrientation:this.YS,sparklines:this.PS.map(function(t){return t.toJSON()})},s=this.XS;for(e in s&&(a.axisReference={row:s.row,col:s.col,rowCount:s.rowCount,colCount:s.colCount,sheetName:this.nZa}),t={},a)a.hasOwnProperty(e)&&(o=a[e],r=o,i=void 0,i=!1,"setting"===(n=e)||"axisReference"===n?i=r===S:"displayDateAxis"===n?i=!1===r:"axisOrientation"===n?i=1===r:"sparklines"===n&&(i=0===r.length),i||(t[e]=o));return l(t)?v:t},U.prototype.fromJSON=function(t,e){var o,n,r,i,a,s,l,u,c;if(t&&(o=this,n=t.displayDateAxis,r=t.sparklineType,i=t.axisReference,a=t.axisOrientation,s=t.sparklines,o.setting=new x(t.setting),N(n)||(o.displayDateAxis=n),N(r)||(o.sparklineType=r),N(i)||(o.XS=I(i.row,i.col,i.rowCount,i.colCount),o.nZa=i.sheetName),N(a)||(o.YS=a),s))for(o.PS=[],l=0,u=s.length;l<u;l++)(c=new A).fromJSON(s[l]),o.add(c)},T=U,Z.prototype.group=function(t){var e,o,n,r,i=this;return 0===arguments.length?((e=i.cb)||((e=new T).add(i),i.cb=e),e):(o=i.cb,(n=i.bT())&&n._modelManager.zTa&&(r={row:i.row,col:i.column,group:o},n._modelManager.FUa(11,r)),t!==o&&(o&&o.remove(i),(i.cb=t)&&!t.contains(i)&&t.add(i),i.onSparklineChanged()),n&&n.$p(),i)},Z.prototype.sparklineType=function(t){var e,o,n,r;return 0===arguments.length?this.group().sparklineType:((o=(e=this.group()).sparklineType)!==t&&(e.sparklineType=t,(n=this.bT())&&n._modelManager.zTa&&(r={row:this.row,col:this.column,sparklineType:o},n._modelManager.FUa(3,r)),this.onSparklineChanged(),n&&n.$p()),this)},Z.prototype.onSparklineChanged=function(){var t=this.bT();t&&t.Wq(M.Events.SparklineChanged,{sheet:t,sheetName:t.name(),sparkline:this})},Z.prototype.setting=function(t){var e,o=this.group(),n=this.bT(),r=n&&n._modelManager.zTa;return 0===arguments.length?r?M.GC$.extend(!0,{},o.setting):o.setting:(r&&(e={row:this.row,col:this.column,setting:M.GC$.extend(!0,{},o.setting)},n._modelManager.FUa(4,e)),o.setting=t,n&&n.$p(),this)},Z.prototype.data=function(t){var e,o,n=this;return 0===arguments.length?n.aT:((e=n.bT())&&e._modelManager.zTa&&(o={row:n.row,col:n.column,sparkline:n,data:M.GC$.extend(!0,{},n.aT)},e._modelManager.FUa(5,o)),n.aT!==t&&(n.aT=t,n.onSparklineChanged()),e&&e.$p(),n)},Z.prototype.dataSheetName=function(t){var e,o,n,r=this;return 0===arguments.length?r.oZa:(e=r.oZa,(o=r.bT())&&o._modelManager.zTa&&(n={row:r.row,col:r.column,dataSheetName:e},o._modelManager.FUa(15,n)),e!==t&&(e&&o&&o.ZA.vZa(r),(r.oZa=t)&&o&&o.ZA.tZa(r),r.onSparklineChanged()),r)},Z.prototype.dataOrientation=function(t){var e,o;return 0===arguments.length?this._S:((e=this.bT())&&e._modelManager.zTa&&(o={row:this.row,col:this.column,dataOrientation:this._S},e._modelManager.FUa(6,o)),this._S!==t&&(this._S=t,this.onSparklineChanged()),e&&e.$p(),this)},Z.prototype.dateAxisData=function(t){var e=this.group();return 0===arguments.length?e.dateAxisData():(e.dateAxisData(t),this)},Z.prototype.dateAxisDataSheetName=function(t){var e=this.group();return 0===arguments.length?e.dateAxisDataSheetName():(e.dateAxisDataSheetName(t),this)},Z.prototype.dateAxisOrientation=function(t){var e=this.group();return 0===arguments.length?e.dateAxisOrientation():(e.dateAxisOrientation(t),this)},Z.prototype.displayDateAxis=function(t){var e,o,n=this.group();return 0===arguments.length?n.displayDateAxis:((e=this.bT())&&e._modelManager.zTa&&(o={row:this.row,col:this.column,displayDateAxis:n.displayDateAxis},e._modelManager.FUa(7,o)),n.displayDateAxis=t,this)},Z.prototype.clone=function(){var t=new Z;return t.row=this.row,t.column=this.column,t.data(this.data()),t.dataSheetName(this.dataSheetName()),t.dataOrientation(this.dataOrientation()),t.group(this.group().clone()),t},Z.prototype.paintSparkline=function(t,e,o,n,r){var i,a,s,l=this,u=l.bT();u&&u.parent&&(i=u.parent.getSheetFromName(l.dataSheetName()),a=u.parent.getSheetFromName(l.dateAxisDataSheetName())),this.lKb&&(u=this.lKb),s={sparklineType:l.sparklineType(),displayDateAxis:l.displayDateAxis(),zoomFactor:u.zoom(),values:l.hKb||l.$S(l.data(),l.dataOrientation(),!1,i||u),dateValues:l.jKb||l.$S(l.dateAxisData(),l.dateAxisOrientation(),!0,a||u),settings:l.setting(),getColor:function(t){if(u&&t){var e=M.Rm.Om(u,t);if(e)return e}return t}},(new c).paint(t,s,e,o,n,r)},Z.prototype.iKb=function(t){return this.$S(this.data(),this.dataOrientation(),!1,t)},Z.prototype.kKb=function(t){return this.$S(this.dateAxisData(),this.dateAxisOrientation(),!0,t)},Z.prototype.$S=function(t,e,o,n){var r=this.setting().options.displayHidden;return Z.cT(v,n,r,t,e,o)},Z.prototype.bT=function(){var t=this.group(),e=t&&t.ZA;return e?e.kj:S},Z.prototype.toJSON=function(){return{row:this.row,col:this.column,orientation:this._S,data:{row:this.aT.row,rowCount:this.aT.rowCount,col:this.aT.col,colCount:this.aT.colCount,sheetName:this.oZa}}},Z.prototype.fromJSON=function(t){var e,o,n,r,i;t&&(e=t.row,o=t.col,n=t.orientation,r=t.data,N(e)||(this.row=e),N(o)||(this.column=o),N(n)||(this._S=n),r&&(i=r,this.aT=I(i.row,i.col,i.rowCount,i.colCount),this.oZa=i.sheetName))},Z.cT=function(t,e,o,n,r,i){var a,s,l,u,c,h=[],f=1===r;if(e&&n)for(a=0,s=f?n.colCount:n.rowCount;a<s;a++)l=f?0:a,u=f?a:0,(c=t?t[l][u]:e.getValue(n.row+l,n.col+u))instanceof d.CalcError||(!o&&(e.getRowHeight(n.row+l)<=0||e.getColumnWidth(n.col+u)<=0)?c=NaN:N(c)||(i?c="number"==typeof c?p.Common.l.Xb(c):Date.parse(c):"number"!=typeof c&&(c=m)),h.push(c));return h},A=Z,e.Sparkline=A},"./dist/plugins/table/table-action.js":function(t,e,o){"use strict";var p,n,r,l,d,c,g,m,i,y,a,h,b,f,u,s,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J,Z=this&&this.__extends||(P=function(t,e){return(P=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}P(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function q(t,e){var o=L.call(this,t)||this;return o.lMb=e,o.aMb=e.tableName,o}function K(t,e){var o=H.call(this,t)||this,n=o;return n.kMb=e,n.cj=e.row,n.dj=e.col,n.Yw=e.newValue,o}function Y(t,e){var o=B.call(this,t)||this;return o.jMb=e,o.aMb=e.tableName,o}function Q(t,e){var o=V.call(this,t)||this;return o.iMb=e,o.aMb=e.tableName,o.dj=e.col,o.Jb=e.count,o}function X(t,e){var o=z.call(this,t)||this;return o.gMb=e,o.aMb=e.tableName,o.dj=e.col,o.Jb=e.count,o.dMb=e.isAfter,o}function $(t,e){var o=W.call(this,t)||this;return o.fMb=e,o.aMb=e.tableName,o.kJc=e.changeRows,o}function tt(t,e){var o=G.call(this,t)||this;return o.cMb=e,o.aMb=e.tableName,o.cj=e.row,o.Jb=e.count,o.dMb=e.isAfter,o}function et(t,e){var o=U.call(this,t)||this;return o.cMb=e,o.aMb=e.tableName,o.cj=e.row,o.Jb=e.count,o.dMb=e.isAfter,o}function ot(t,e){var o=J.call(this,t)||this;return o._Lb=e,o.aMb=e.tableName,o.bMb=e.resizeToRange,o}Object.defineProperty(e,"__esModule",{value:!0}),p=o("Core"),n=o("@grapecity/js-sheets-common"),r=o("./dist/plugins/table/table-util.js"),l=r.Util.$Lb,d=r.Util.PIb,c=r.Util.QIb,g=r.Util._getTable,m=r.Util._Mb,i=p.Commands.ActionBase,y=n.Common.j.Fa,a="tableResize",h="tableInsertRows",b="tableDeleteRows",f="tableInsertColumns",u="tableDeleteColumns",s="tableToRange",v="tableTotalRowFormula",C="DoInsertRows",w="tableShowFooter",x="tableInsertRowsAboveForContextMenu",T="tableInsertRowsBelowForContextMenu",A="tableDeleteRowsForContextMenu",S="tableInsertColumnsLeftForContextMenu",M="tableInsertColumnsRightForContextMenu",I="tableDeleteColumnsForContextMenu",Z(ot,J=i),ot.prototype.execute=function(){var t,e,o,n,r,i,a,s=!1;if(this.canExecute()){e=(t=this.kj)._modelManager,o=this.aMb,n=this._Lb,e.startTransaction(),this.Lz(t,!0);try{(r=t.tables.findByName(o))&&(i=r.range(),a=this.bMb,t.tables.resize(r,a),l(t,r,i,a),s=!0)}finally{this.Mz(t),n[p.Commands.bWa(t.name())]=e.endTransaction()}}return s},ot.prototype.undo=function(){var t,e,o,n,r=this.kj,i=this.aMb,a=!1;if(this.canUndo()){this.Lz(r,!0);try{t=this._Lb,e=r._modelManager,o=r.tables.findByName(i),(n=t[p.Commands.bWa(r.name())])&&(e.undo(n),l(r,o,t.resizeToRange,o.range()),e.wVa(n.uVa),a=!0)}finally{this.Mz(r,!0)}}return a},N=ot,p.Commands[a]={canUndo:!0,execute:function(t,e,o){return p.Commands.h4(t,N,e,o)}},Z(et,U=i),et.prototype.execute=function(){var t,e,o,n,r,i,a,s,l,u=!1;if(this.canExecute()){e=(t=this.kj)._modelManager,o=this.aMb,n=this.cj,r=this.Jb,i=this.dMb,e.startTransaction(),this.Lz(t,!0);try{(a=t.tables.findByName(o))&&(s=a.Xj,a.Nia(n,r,i),u=!0,a.Xj-s===r&&d(t,a,h,n,r,i))}finally{this.Mz(t),l=p.Commands.bWa(t.name()),this.cMb[l]=e.endTransaction()}}return u},et.prototype.undo=function(){var t,e,o,n,r,i,a,s,l=this.kj,u=!1;if(this.canUndo()){this.Lz(l,!0);try{t=this.cMb,e=l._modelManager,o=t[p.Commands.bWa(l.name())],n=t.row,r=t.count,i=t.isAfter,o&&(e.undo(o),e.wVa(o.uVa),(a=l.tables.findByName(this.aMb))&&(s=i?n+1:n,a.ihc(s,r),a.NAb(),a.WNb(s,r,m(!0)),d(l,a,b,n,r,void 0,a.nKb())),u=!0)}finally{this.Mz(l,!0)}}return u},R=et,p.Commands[h]={canUndo:!0,execute:function(t,e,o){return p.Commands.h4(t,R,e,o)}},Z(tt,G=i),tt.prototype.execute=function(){var t,e,o,n,r,i,a,s,l=this,u=!1;if(l.canExecute()){e=(t=l.kj)._modelManager,o=l.aMb,n=l.cj,r=l.Jb,i=l.dMb,e.startTransaction(),l.Lz(t,!0);try{(a=t.tables.findByName(o))&&(a.eMb(n,r,i,!1),d(t,a,h,n,r,i),l.cMb.row=n,l.cMb.count=r,u=!0)}finally{l.Mz(t),s=p.Commands.bWa(t.name()),l.cMb[s]=e.endTransaction()}}return u},tt.prototype.undo=function(){var t,e,o,n,r,i,a,s,l,u,c,h=this.kj,f=!1;if(this.canUndo()){this.Lz(h,!0);try{t=this.cMb,e=h._modelManager,o=t[p.Commands.bWa(h.name())],n=t.row,r=t.count,i=t.isAfter,o&&(s=(a=h.tables.findByName(this.aMb))&&a.LZ(),l=void 0,u=i?n+1:n,s&&(c=a.dataRange(),l=s.slice(u-c.row,u-c.row+r)),e.undo(o),e.wVa(o.uVa),a&&(a.ihc(u,r),a.NAb(),a.WNb(u,r,m(!0)),d(h,a,b,n,r,i,l||a.nKb())),f=!0)}finally{this.Mz(h,!0)}}return f},k=tt,p.Commands[C]={canUndo:!0,execute:function(t,e,o){return p.Commands.h4(t,k,e,o)}},Z($,W=i),$.prototype.execute=function(){var t,e,o,n,r,i,a,s,l,u,c=!1;if(this.canExecute()){e=(t=this.kj)._modelManager,o=this.aMb,n=this.kJc,e.startTransaction(),this.Lz(t,!0);try{if(r=t.tables.findByName(o))for(i=n.length-1;0<=i;i--)a=n[i].row,s=n[i].count,l=r.Xj,r.STa(a,s),c=!0,l-r.Xj===s&&d(t,r,b,a,s,void 0,r.nKb())}finally{this.Mz(t),u=p.Commands.bWa(t.name()),this.fMb[u]=e.endTransaction()}}return c},$.prototype.undo=function(){var t,e,o,n,r,i,a,s,l=this.kj,u=!1;if(this.canUndo()){this.Lz(l,!0);try{if(t=this.fMb,e=l._modelManager,o=t[p.Commands.bWa(l.name())],n=this.kJc,o)for(e.undo(o),e.wVa(o.uVa),(r=l.tables.findByName(this.aMb))&&r.NAb(),u=!0,i=n.length-1;0<=i;i--)a=n[i].row,s=n[i].count,d(l,r,h,a,s,!1)}finally{this.Mz(l,!0)}}return u},E=$,p.Commands[b]={canUndo:!0,execute:function(t,e,o){return p.Commands.h4(t,E,e,o)}},Z(X,z=i),X.prototype.execute=function(){var t,e,o,n,r,i,a,s,l,u=!1;if(this.canExecute()){e=(t=this.kj)._modelManager,o=this.aMb,n=this.dj,r=this.Jb,i=this.dMb,e.startTransaction(),this.Lz(t,!0);try{(a=t.tables.findByName(o))&&(s=a.OZ,a.hMb(n,r,i),u=!0,a.OZ-s===r&&c(t,a,f,n,r,i))}finally{this.Mz(t),l=p.Commands.bWa(t.name()),this.gMb[l]=e.endTransaction()}}return u},X.prototype.undo=function(){var t,e,o,n,r,i,a=this.kj,s=!1;if(this.canUndo()){this.Lz(a,!0);try{t=this.gMb,e=a._modelManager,o=t[p.Commands.bWa(a.name())],n=t.col,r=t.count,o&&(e.undo(o),e.wVa(o.uVa),(i=a.tables.findByName(this.aMb))&&i.NAb(),s=!0,c(a,i,u,n,r))}finally{this.Mz(a,!0)}}return s},D=X,p.Commands[f]={canUndo:!0,execute:function(t,e,o){return p.Commands.h4(t,D,e,o)}},Z(Q,V=i),Q.prototype.execute=function(){var t,e,o,n,r,i,a,s,l=!1;if(this.canExecute()){e=(t=this.kj)._modelManager,o=this.aMb,n=this.dj,r=this.Jb,e.startTransaction(),this.Lz(t,!0);try{(i=t.tables.findByName(o))&&(a=i.OZ,i.TTa(n,r),l=!0,a-i.OZ===r&&c(t,i,u,n,r))}finally{this.Mz(t),s=p.Commands.bWa(t.name()),this.iMb[s]=e.endTransaction()}}return l},Q.prototype.undo=function(){var t,e,o,n,r,i,a=this.kj,s=!1;if(this.canUndo()){this.Lz(a,!0);try{t=this.iMb,e=a._modelManager,o=t[p.Commands.bWa(a.name())],n=t.col,r=t.count,o&&(e.undo(o),e.wVa(o.uVa),(i=a.tables.findByName(this.aMb))&&i.NAb(),c(a,i,f,n,r,!(s=!0)))}finally{this.Mz(a,!0)}}return s},j=Q,p.Commands[u]={canUndo:!0,execute:function(t,e,o){return p.Commands.h4(t,j,e,o)}},Z(Y,B=i),Y.prototype.execute=function(){var t,e,o,n,r,i=!1;if(this.canExecute()){e=(t=this.kj)._modelManager,o=this.aMb,e.startTransaction(),this.Lz(t,!0);try{(n=t.tables.findByName(o))&&(t.tables.remove(n,3),i=!0)}finally{this.Mz(t),r=p.Commands.bWa(t.name()),this.jMb[r]=e.endTransaction()}}return i},Y.prototype.undo=function(){var t,e,o,n,r=this.kj,i=!1;if(this.canUndo()){this.Lz(r,!0);try{t=this.jMb,e=r._modelManager,(o=t[p.Commands.bWa(r.name())])&&(e.undo(o),e.wVa(o.uVa),(n=r.tables.findByName(this.aMb))&&n.NAb(),i=!0)}finally{this.Mz(r,!0)}}return i},_=Y,p.Commands[s]={canUndo:!0,execute:function(t,e,o){return p.Commands.h4(t,_,e,o)}},Z(K,H=i),K.prototype.execute=function(){var t,e,o,n,r,i,a=!1;if(this.canExecute()){(e=(t=this.kj)._modelManager).startTransaction(),this.Lz(t,!0);try{o=this.cj,n=this.dj,r=this.Yw,t.setFormula(o,n,r),r||t.setValue(o,n,null),a=!0}finally{this.Mz(t),i=p.Commands.bWa(t.name()),this.kMb[i]=e.endTransaction()}}return a},K.prototype.undo=function(){var t,e,o,n=this.kj,r=!1;if(this.canUndo()){this.Lz(n,!0);try{t=this.kMb,e=n._modelManager,(o=t[p.Commands.bWa(n.name())])&&(e.undo(o),e.wVa(o.uVa),r=!0)}finally{this.Mz(n,!0)}}return r},O=K,p.Commands[v]={canUndo:!0,execute:function(t,e,o){return p.Commands.h4(t,O,e,o)}},Z(q,L=i),q.prototype.execute=function(){var t,e,o,n,r,i=!1;if(this.canExecute()){e=(t=this.kj)._modelManager,o=this.aMb,e.startTransaction(),this.Lz(t,!0);try{(n=t.tables.findByName(o))&&(n.showFooter(!0),i=!0)}finally{this.Mz(t),r=p.Commands.bWa(t.name()),this.lMb[r]=e.endTransaction()}}return i},q.prototype.undo=function(){var t,e,o,n=this.kj,r=!1;if(this.canUndo()){this.Lz(n,!0);try{t=this.lMb,e=n._modelManager,(o=t[p.Commands.bWa(n.name())])&&(e.undo(o),e.wVa(o.uVa),r=!0)}finally{this.Mz(n,!0)}}return r},F=q,p.Commands[w]={canUndo:!0,execute:function(t,e,o){return p.Commands.h4(t,F,e,o)}},p.Commands[x]={canUndo:!0,execute:function(t,e,o){var n,r,i,a,s,l,u;return e.cmd=x,y(e.row)&&y(e.count)?(n=p.Commands.bT(t,e),l=s=a=i=void 0,1===(r=e.selections).length&&(i=r[0],(a=g(n,i))&&(s=i.row,l=i.rowCount,u=a.footerIndex()===s,e.row=u?s-1:s,e.count=l,e.tableName=a.name(),e.isAfter=u),p.Commands.h4(t,R,e,o))):p.Commands.h4(t,R,e,o)}},p.Commands[T]={canUndo:!0,execute:function(t,e,o){if(e.cmd=T,y(e.row)&&y(e.count)){var n=p.Commands.bT(t,e),r=e.selections,i=void 0,a=void 0,s=void 0,l=void 0;return 1===r.length&&(i=r[0],(a=g(n,i))&&(s=i.row,l=i.rowCount,e.row=s,e.count=l,e.tableName=a.name(),e.isAfter=!0),p.Commands.h4(t,R,e,o))}return p.Commands.h4(t,R,e,o)}},p.Commands[A]={canUndo:!0,execute:function(t,e,o){var n,r,i,a,s,l,u,c,h,f;if(e.cmd=A,y(e.changeRows)&&y(e.changeRows)){for(n=p.Commands.bT(t,e),r=e.selections,s=a=i=void 0,e.changeRows=[],l=0;l<r.length;l++){if(u=r[l],!(c=g(n,u)))return!1;if(i){if(i!==c)return!1}else i=c}for(l=0;l<r.length;l++)for(h=l+1;h<r.length;h++){if(u=r[l],f=r[h],u.row>=f.row&&u.row<=f.row+f.rowCount-1)return!1;if(u.row+u.rowCount-1>=f.row&&u.row+u.rowCount-1<=f.row+f.rowCount-1)return!1;if(u.row<=i.cj||u.row+u.rowCount>i.cj+i.Xj)return!1;if(f.row<=i.cj||f.row+f.rowCount>i.cj+i.Xj)return!1}for(r.sort(function(t,e){return t.row-e.row}),l=0;l<r.length;l++)a=(u=r[l]).row,s=u.rowCount,e.changeRows.push({row:a,count:s});return e.tableName=i.name(),p.Commands.h4(t,E,e,o)}return p.Commands.h4(t,E,e,o)}},p.Commands[S]={canUndo:!0,execute:function(t,e,o){if(e.cmd=S,y(e.col)&&y(e.count)){var n=p.Commands.bT(t,e),r=e.selections,i=void 0,a=void 0,s=void 0,l=void 0;return 1===r.length&&(i=r[0],(a=g(n,i))&&(s=i.col,l=i.colCount,e.col=s,e.count=l,e.tableName=a.name(),e.isAfter=!1),p.Commands.h4(t,D,e,o))}return p.Commands.h4(t,D,e,o)}},p.Commands[M]={canUndo:!0,execute:function(t,e,o){if(e.cmd=M,y(e.col)&&y(e.count)){var n=p.Commands.bT(t,e),r=e.selections,i=void 0,a=void 0,s=void 0,l=void 0;return 1===r.length&&(i=r[0],(a=g(n,i))&&(s=i.col,l=i.colCount,e.col=s,e.count=l,e.tableName=a.name(),e.isAfter=!0),p.Commands.h4(t,D,e,o))}return p.Commands.h4(t,D,e,o)}},p.Commands[I]={canUndo:!0,execute:function(t,e,o){if(e.cmd=I,y(e.col)&&y(e.count)){var n=p.Commands.bT(t,e),r=e.selections,i=void 0,a=void 0,s=void 0,l=void 0;return 1===r.length&&(i=r[0],(a=g(n,i))&&(s=i.col,l=i.colCount,e.col=s,e.count=l,e.tableName=a.name()),p.Commands.h4(t,j,e,o))}return p.Commands.h4(t,j,e,o)}},p.Commands.mMb=function(t){t.register(a,p.Commands[a]),t.register(h,p.Commands[h]),t.register(C,p.Commands[C]),t.register(b,p.Commands[b]),t.register(f,p.Commands[f]),t.register(u,p.Commands[u]),t.register(s,p.Commands[s]),t.register(v,p.Commands[v]),t.register(w,p.Commands[w]),t.register(x,p.Commands[x]),t.register(T,p.Commands[T]),t.register(A,p.Commands[A]),t.register(S,p.Commands[S]),t.register(M,p.Commands[M]),t.register(I,p.Commands[I])}},"./dist/plugins/table/table-event.js":function(t,e,o){"use strict";var f,n,p,r,i,d,l,a,m,b,v,s;Object.defineProperty(e,"__esModule",{value:!0}),f=o("Core"),n=o("@grapecity/js-sheets-common"),p=o("./dist/plugins/table/table.js"),r=o("./dist/plugins/table/table.ns.js"),i=o("./dist/plugins/table/table-util.js"),d=n.Common.j.Fa,l=Math.abs,a=new n.Common.ResourceManager(r.SR),m=a.getResource.bind(a),b=i.Util.nMb,v=i.Util.oMb,s=i.Util.pMb,f.GC$.extend(f.iI.prototype,{oIb:function(t,e){var o=this.qgc(t,e);o&&e.setSelection(o.row,o.col,o.rowCount,o.colCount)},qgc:function(t,e){var o,n,r,i,a,s,l,u,c=e.getSelections(),h=t.tableSelectInfo;if(!e.isEditing()||e.getActiveRowIndex()===t.row&&e.getActiveColumnIndex()===t.col||e.endEdit(),r=n=0,(o=h.table).NZ&&(n=1),o.MZ&&(r=1),i=null,a=h.action,s=e._formulaTextBox&&e._formulaTextBox.ahc(),!d(s)&&0<s.length&&(c=s),a===p.TableSelectionType.TABLE_ROW_SELECT)i=f.kf(t.row,o.dj,1,o.OZ);else if(a===p.TableSelectionType.TABLE_COL_SELECT){for(l=0;l<c.length;l++)if((u=c[l]).col===t.col&&u.row===o.cj+r&&1===u.colCount&&u.rowCount===o.Xj-r-n){i=f.kf(o.cj,t.col,o.Xj,1);break}d(i)&&(i=f.kf(o.cj+r,t.col,o.Xj-r-n,1))}else if(a===p.TableSelectionType.TABLE_CORNER_SELECT){for(l=0;l<c.length;l++)if((u=c[l]).col===o.dj&&u.row===o.cj+r&&u.colCount===o.OZ&&u.rowCount===o.Xj-r-n){i=f.kf(o.cj,o.dj,o.Xj,o.OZ);break}d(i)&&(i=f.kf(o.cj+r,o.dj,o.Xj-r-n,o.OZ))}else a===p.TableSelectionType.TABLE_SELECT&&(i=f.kf(o.cj,o.dj,o.Xj,o.OZ));return i},iJb:function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d,g,m=this.kj,y=null;return m&&!m.options.isProtected&&!m.isEditing()&&e&&e.showResizeHandle()&&(o=t.row,n=t.col,r=t.x,i=t.y,a=t.rowViewportIndex,s=t.colViewportIndex,l=b(m,e),u=v(m,e),o===l&&n===u&&(h=(c=m.getCellRect(o,n,a,s)).x,f=c.y,p=c.width,g=f+c.height,(d=h+p)-10<=r&&r<=d&&g-10<=i&&i<=g&&(y={x:r,y:i,table:e}))),y},pIb:function(t){var e,o,n,r,i,a=this;!0!==a.qIb&&!0!==a._isWorking&&(e=a.kj,(n=(o=t.resizeTableHitInfo)&&o.table)&&!n.hJb()&&(a.qIb=!0,a._isWorking=!0,a.qMb=n,a.rMb=n.cj,a.sMb=n.dj,a.tMb=n.Xj,a.uMb=n.OZ,r=a.rMb+a.tMb-1,i=a.sMb+a.uMb-1,a.vMb=e.getCellRect(r,i),a.wMb=n.range(),a.rG={KG:t.rowViewportIndex,MG:t.colViewportIndex,sG:t.hitTestType},a.qG()))},rIb:function(){var t=this,e=t.kj;t.rG&&t.qIb&&t._isWorking&&t.qMb&&(t.xMb(),t.yMb()&&(t.zMb=t.AMb(),t.BMb(),t.CMb(),(t.DMb||t.EMb()).equals(t.FMb)||(t.DMb=f.kf(t.FMb.row,t.FMb.col,t.FMb.rowCount,t.FMb.colCount),s(e,t.qMb,t.EMb(),t.FMb))),t.NG())},wIb:function(){var t,e=this,o=e.kj;return e.RG(),e.qIb&&e._isWorking&&e.FMb&&e.qMb?(e.qIb=!1,e._isWorking=!1,void(e.HMb()?(t=e.EMb(),e.IMb(),t.equals(e.FMb)?o._render.JMb():o.wu().execute({cmd:"tableResize",sheetName:o.name(),tableName:e.qMb.name(),resizeToRange:e.FMb}),e.GMb()):(e.GMb(),o._render.JMb()))):void e.GMb()},EMb:function(){var t=this.qMb;return f.kf(t.cj,t.dj,t.Xj,t.OZ)},xMb:function(){var t=this.fH(),e=this.gH();this.KMb=t,this.LMb=e},yMb:function(){var t=this.rMb,e=this.sMb,o=this.KMb,n=this.LMb;return(this.qMb.MZ?t+1:t)<=o&&e<=n},AMb:function(){var t=this.$F,e=this.vMb,o=e.x+e.width,n=e.y+e.height,r=t.x,i=t.y,a=l(n-i);return l(o-r)<=a?i<n?2:3:r<o?0:1},BMb:function(){var t=this,e=t.rMb,o=t.sMb,n=t.KMb,r=t.LMb,i=t.zMb,a=t.tMb,s=t.uMb;switch(i){case 0:case 1:s=l(r-o)+1;break;case 2:case 3:a=l(n-e)+1}t.FMb?(t.FMb.rowCount=a,t.FMb.colCount=s):t.FMb=f.kf(e,o,a,s)},CMb:function(){this.kj._render.JMb(),this.wMb=this.MMb()},MMb:function(){var t=this.FMb,e=t.row,o=t.col,n=t.rowCount,r=t.colCount;return f.kf(e,o,n,r)},IMb:function(){var t=this.qMb;2===this.zMb&&t.NZ&&(this.FMb.rowCount+=1)},HMb:function(){var t=this.kj,e=!1,o=t._modelManager,n=t.tables,r=this.qMb,i=this.FMb,a=i.row,s=i.col,l=i.rowCount,u=i.colCount,c=this.KMb,h=this.LMb,f=b(t,r),p=v(t,r),d=this.zMb,g=r.xr;return f&&p&&(o.MTa(a,s,l,u)||o.qu(a,s,l,u)?t.Os(6,m().Exp_TableResizeToSpan):g&&g.isFiltered()?2===d?t.Os(6,m().Exp_TableResizeWithHidden):3===d&&r.NZ?t.Os(6,m().Exp_TableResizeWithFilter):e=!0:2===d&&this.NMb(f,c)||0===d&&this.OMb(p,h)?t.Os(6,m().Exp_TableResizeWithHidden):1===d&&(n.rn(a,p+1,l,h-p)||n.HZ(a,p+1,l,h-p))||3===d&&(n.rn(f+1,s,c-f,u)||n.HZ(f+1,s,c-f,u))?t.Os(6,m().Exp_TableResizeToTable):e=!0),e},NMb:function(t,e){var o,n=this.kj,r=!1;for(o=t;e<o;o--)if(n.getRowHeight(o)<=0){r=!0;break}return r},OMb:function(t,e){var o,n=this.kj,r=!1;if(!r)for(o=t;e<o;o--)if(n.getColumnWidth(o)<=0){r=!0;break}return r},GMb:function(){this.qIb=!1,this._isWorking=!1,this.rG=null,this.FMb=null,this.DMb=null}})},"./dist/plugins/table/table-render.js":function(t,e,o){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),(0,(n=o("Core")).GC$.extend)(n.oJ.prototype,{JMb:function(){0<this.kj.Xq||this.im()}}),n.Worksheet.$n("tableRender",{paintAdornment:function(t){var e,o,n,r,i,a,s=t.ctx,l=this._eventHandler;l&&l.rG&&l.qIb&&(e=this,o=s,n=l.iH(),r=l.jH(),i=e._eventHandler.FMb,a=e.getRangeRect(n,r,i),o.strokeStyle=e.getSelectionBorderColor(),o.strokeRect(a.x,a.y,a.width,a.height))}})},"./dist/plugins/table/table-theme.js":function(t,e,o){"use strict";var l,f,a,u,n,r,i,s,c,h,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H;function B(){}function V(t,e,o,n,r,i,a,s,l,u){var c=this,h=arguments;f(j,function(t,e){c[e]=h[t]})}function z(t,e){return isNaN(e)?e:new l.LineBorder(t,e)}function W(t,e,o,n,r,i,a,s,l,u){var c=new _;return e&&(c.backColor=e),o&&(c.foreColor=o),n&&(c.font=M),r&&(c.borderLeft=z(t,r)),i&&(c.borderTop=z(t,i)),a&&(c.borderRight=z(t,a)),s&&(c.borderBottom=z(t,s)),l&&(c.borderHorizontal=z(t,l)),u&&(c.borderVertical=z(t,u)),c}function G(t){return 0===t?"Text 1":"Accent "+t}function U(t){var e,o=t-1,n=h,r=s(o/7);return 0<=r&&r<3&&(e="Light"+t,(n=[function(t){var e=G(t),o=e+" 80",n=new O;return n[p](W(e,0,e,1,0,0,0,1)),n[g](W(e,0,e,0,0,1,0,1)),n[b](W(e,o)),n[y](W(e,0,e,1)),n[m](W(e,0,e,1)),n[C](W(e,o)),n[d](W(e,0,e,1,0,1)),n},function(t){var e=G(t),o=new O;return o[p](W(e,e,F,1)),o[g](W(e,0,0,0,1,1,1,1)),o[b](W(e,0,0,0,0,1)),o[v](W(e,0,0,0,0,1)),o[C](W(e,0,0,0,1)),o[w](W(e,0,0,0,1)),o[y](W(e,0,0,1)),o[m](W(e,0,0,1)),o[d](W(e,0,0,1,0,6)),o},function(t){var e=G(t),o=e+" 80",n=new O;return n[p](W(e,0,0,1,0,0,0,2)),n[g](W(e,0,0,0,1,1,1,1,1,1)),n[b](W(e,o)),n[C](W(e,o)),n[y](W(e,0,0,1)),n[m](W(e,0,0,1)),n[d](W(e,0,0,1,0,6)),n}][r](o%7)).name&&n.name(e),n.builtInName&&n.builtInName(e)),n}function J(t){var e,o=t-1,n=h,r=s(o/7);return 0<=r&&r<4&&(e="Medium"+t,(n=[function(t){var e=G(t),o=e+" 20",n=e,r=e+" 80",i=new O;return i[p](W(o,n,F,1)),i[g](W(o,0,0,0,1,1,1,1,1)),i[b](W(o,r)),i[C](W(o,r)),i[y](W(o,0,0,1)),i[m](W(o,0,0,1)),i[d](W(o,0,P,1,0,6)),i},function(t){var e=G(t),o=F,n=e,r=e+" 60",i=e+" 80",a=new O;return a[p](W(o,n,F,1,0,0,0,2,0,1)),a[g](W(o,i,0,0,0,0,0,0,1,1)),a[b](W(o,r)),a[C](W(o,r)),a[y](W(o,n,F,1)),a[m](W(o,n,F,1)),a[d](W(o,n,F,1,0,2,0,0,0,1)),a},function(t){var e=G(t),o=e,n=0===t?P:"#D3D3D3",r=new O;return r[p](W(P,o,F,1,0,2,0,2)),r[g](W(n,0,0,0,1,new l.LineBorder(P,2),1,new l.LineBorder(P,2),0===t?1:0,1)),r[b](W(n,"#D3D3D3")),r[C](W(n,"#D3D3D3")),r[y](W(n,o,F)),r[m](W(n,o,F)),r[x](W(n,o,F,1)),r[T](W(n,o,F,1)),r[d](W(P,0,P,0,0,6)),r},function(t){var e=G(t),o=e,n=e+" 40",r=e+" 80",i=e+" 60",a=e+" 80",s=new O;return s[p](W(n,r,P,1,1,1,1,1,0,1)),s[g](W(n,r,0,0,1,1,1,1,1,1)),s[b](W(n,i)),s[C](W(n,i)),s[y](W(n,0,0,1)),s[m](W(n,0,0,1)),s[d](W(n,a,P,1,1,new l.LineBorder(o,2),1,1,0,1)),s}][r](o%7)).name(e),n.builtInName(e)),n}function Z(t){var e,o=t-1,n=h,r=s(o/7);return 0<=r&&r<2&&(e="Dark"+t,(n=[function(t){var e=G(t),o=P,n=0===t?e+" 25":e+" -25",r=0===t?e+" 50":e,i=0===t?e:e+" -50",a=new O;return a[p](W(F,o,F,1,0,0,0,2)),a[g](W(e,r,F)),a[b](W(e,n)),a[C](W(e,n)),a[y](W(F,n,F,1,0,0,2)),a[m](W(F,n,F,1,2)),a[d](W(F,i,F,1,0,2)),a},function(t){var e,o,n,r,i,a;function s(t,e){if(t<0||3<t)return"";return{tableBackground:["Background 1 -15","Accent 1 80","Accent 3 80","Accent 5 80"],stripColor:["Background 1 -35","Accent 1 60","Accent 3 60","Accent 5 60"],headerColor:["Text 1","Accent 2","Accent 4","Accent 6"]}[e][t]}return e=G(t),o=s(t,"headerColor"),n=s(t,"stripColor"),r=s(t,"tableBackground"),i=r,(a=new O)[p](W(e,o,F)),a[g](W(e,r)),a[b](W(e,n)),a[C](W(e,n)),a[y](W(e,0,0,1)),a[m](W(e,0,0,1)),a[d](W(P,i,0,1,0,6)),a}][r](o%7)).name(e),n.builtInName(e)),n}for(Object.defineProperty(e,"__esModule",{value:!0}),l=o("Core"),f=l.GC$.each,a=l.GC$.isEmptyObject,u=l.Ul.Ol,n=JSON.stringify,r=JSON.parse,i=l.Ul.Pl,s=Math.floor,c=void 0,h=null,A=[p="headerRowStyle",d="footerRowStyle",g="wholeTableStyle",m="highlightLastColumnStyle",y="highlightFirstColumnStyle",b="firstRowStripStyle",v="secondRowStripStyle",C="firstColumnStripStyle",w="secondColumnStripStyle","firstHeaderCellStyle","lastHeaderCellStyle",x="firstFooterCellStyle",T="lastFooterCellStyle"],S=["firstRowStripSize","secondRowStripSize","firstColumnStripSize","secondColumnStripSize"],M="bold 11pt calibri",j=["backColor","foreColor","font",I="borderLeft",N="borderTop",R="borderRight",k="borderBottom",E="borderHorizontal",D="borderVertical","textDecoration"],V.prototype.Yo=function(o,t,e,n,r){var i=this;e&&u(i[I])&&!u(o[I])&&(o[I]=i[I],o[I].level=20),t&&u(i[N])&&!u(o[N])&&(o[N]=i[N],o[N].level=20),r&&u(i[R])&&!u(o[R])&&(o[R]=i[R],o[R].level=20),n&&u(i[k])&&!u(o[k])&&(o[k]=i[k],o[k].level=20),t||!u(i[E])||u(o[N])||(o[N]=i[E],o[N].level=20),n||!u(i[E])||u(o[k])||(o[k]=i[E],o[k].level=20),e||!u(i[D])||u(o[I])||(o[I]=i[D],o[I].level=20),r||!u(i[D])||u(o[R])||(o[R]=i[D],o[R].level=20),f(j,function(t,e){0<=e.indexOf("border")||u(i[e])&&!u(o[e])&&(o[e]=i[e])})},V.prototype.Uo=function(){var t=new V,e=n(this.toJSON());return t.fromJSON(r(e)),t},V.prototype.toJSON=function(){var r=this,i={};return f(j,function(t,e){var o=r[e],n=o&&o.toJSON?o.toJSON():o;i[e]=a(n)?c:n}),i},V.prototype.fromJSON=function(r,i){if(r){var a=this;f(j,function(t,e){var o,n=r[e];u(n)&&(0<=e.indexOf("border")?((o=new l.LineBorder).fromJSON(n,i),a[e]=o):a[e]=n)})}},_=V,e.TableStyle=_,B.prototype.toJSON=function(){var o,n,r=this,t=r.builtInName();return t?{buildInName:t}:(o={name:r.name()},f(A,function(t,e){(n=r[e]())&&(o[e]=n.toJSON())}),f(S,function(t,e){1!==(n=r[e]())&&(o[e]=n)}),a(o)?c:o)},B.prototype.fromJSON=function(r,i){var a,t,e,o,n,s;if(r){if(a=this,t=r.buildInName)return n=a,s=L[t.toLowerCase()],n.name(s.name()),f(S,function(t,e){n[e](s[e]())}),f(A,function(t,e){var o=s[e]();n[e](o?o.Uo():h)}),void n.builtInName(s.builtInName(),!1);e=r.name,o=u(e)?e:r.Cj,u(o)&&a.name(o,!1),f(S,function(t,e){var o=r[e]!==c?r[e]:r["_"+e];o&&a[e](o,!1)}),f(A,function(t,e){var o,n=r[e]!==c?r[e]:r["_"+e];n&&((o=new _).fromJSON(n,i),a[e](o,!1))})}},O=B,(e.TableTheme=O).prototype.name=i("name"),O.prototype.builtInName=i("builtInName"),f(A,function(t,e){O.prototype[e]=i(e)}),f(S,function(t,e){O.prototype[e]=i(e,1)}),F="white",P="black",L=function(){},e.TableThemes=L,H=1;H<=28;H++)H<=21&&(L["light"+H]=U(H)),H<=11&&(L["dark"+H]=Z(H)),L["medium"+H]=J(H)},"./dist/plugins/table/table-util.js":function(t,e,o){"use strict";var h,r,i,n,a,s,l,c,f,p,u,d,m;function y(t){throw Error(t)}function g(t){t.suspendPaint()}function b(t){t.resumePaint()}function v(t){i&&t.suspendCalcService()}function C(t,e){i&&t.resumeCalcService(e)}function w(t){return t&&!(/\d/.test(t[0])||/[\s\+\-\*\\:%!\[\]]/.test(t)||-1!==["C","c","R","r"].indexOf(t)||/^[A-Za-z]{1,3}(\$)?\d+$/.test(t)||/^[Rr]\d*[Cc]\d*$/.test(t)||255<=t.length)}function x(t,e,o,n,r){return r=r===c||r,t.Wu.unparse(t.yj(),e,o,n,!1,r)}function T(t,e,o){var n=t.getValue(e,o);return n!==l&&s(n)||t.getSparkline&&t.getSparkline(e,o)||A(t.Iq(e,o))}function A(t){return!(!t||!(t.backColor||t.backgroundImage||t.borderBottom||t.borderLeft||t.borderRight||t.borderTop||t.diagonalDown||t.diagonalUp))}function S(t,e,o,n,r,i,a,s){return r<=t&&!(e===a&&e+n-1===s)&&(e<a&&a<=e+n||a<=e&&e<=s&&s<e+n-1)}function M(t,e,o,n,r,i,a,s){return a<=e&&!(t===r&&t+o-1===i)&&(t<r&&r<=t+o||r<=t&&t<=i&&i<t+o-1)}function I(t,e){var o=t.cj;return e-(t.MZ?o+1:o)}Object.defineProperty(e,"__esModule",{value:!0}),h=o("Core"),r=o("SheetsCalc"),i=o("@grapecity/js-calc"),n=o("@grapecity/js-sheets-common"),a=o("./dist/plugins/table/table.ns.js"),s=h.Ul.Ol,l=null,c=void 0,f=Math.max,p=n.Common.j.Fa,u=0,d=new n.Common.ResourceManager(a.SR),m=d.getResource.bind(d),e.Util={throwError:y,setFormulaToSheet:function(t,e,o,n,r){!n&&r&&(n=x(t,r,e,o)),i&&t._u(e,o,n,r)},setValue:function(t,e,o,n){t.setValue(e,o,n)},suspendPaint:g,resumePaint:b,ih:function(t){return t.Cf().ih()},suspendCalcService:v,resumeCalcService:C,RMb:function(t){t&&(g(t),t.suspendEvent(),v(t))},SMb:function(t){t&&(C(t),t.resumeEvent(),b(t))},getRowCount:function(t){return t.rowCount},getColCount:function(t){return t.colCount},isValidTableName:w,formulaToExpression:function(t,e,o,n,r){var i,a=t.yj();return a.DLb=r,i=t.Wu.parse(a,e,o,n,!1,!1,!1),delete a.DLb,i},expressionToFormula:x,checkTableName:function(t){var e,o,n;return!(!t||(w(t)||y(m().Exp_TableNameInvalid),e=this.name(),o=this.tc,t===e||o&&((n=o.findByName(t))&&this!==n)))},TMb:function(t,e,o){return{col:e,leadingCellRow:o,row:t}},nMb:function(t,e,o){var n=l,r=e.cj,i=e.endRow();for(o&&(i-=e.NZ?1:0);r<=i&&t.getRowHeight(i)<=0;)i--;return r<=i&&(n=i),n},oMb:function(t,e){for(var o=l,n=e.dj,r=e.endColumn();n<=r&&t.getColumnWidth(r)<=0;)r--;return n<=r&&(o=r),o},UMb:function(t,e){var o,n,r,i=e.tc,a=e.cj+e.Xj-1,s=e.dj,l=s+e.OZ-1,u=function(t){var e,o,n,r,i=t._modelManager,a=i._getSheetModel(3).dataTable,s=i.getLastNonNullRow(3,!0),l=t.getRowCount(),u=t.getColumnCount();for(n=l-1;-1<n;n--)if(e=a[n])for(r=0;r<u;r++)if((o=e[r])&&!p(o.value))return f(n,s);return f(-1,s)}(t),c=i?i.PMb():-1;return(o=a)<(u=f(u,c))&&(n=1+a,r=new h.Range(n,s,u-a,l-s+1),o=f(function(t,e,o,n,r){var i,a,s;for(i=o;e<=i;i--)for(a=n;a<=r;a++){if(A(t.Iq(i,a)))return i;if(T(t,i,a))return i;if(s=t._modelManager.findSpan(i,a))return s.row+s.rowCount-1}return-1}(t,n,u,s,l),i.PMb(r))),o},VMb:function(t,e){var o,n,r,i=e.tc,a=e.cj,s=a+e.Xj-1,l=e.dj+e.OZ-1,u=function(t){var e,o,n,r,i=t._modelManager,a=i._getSheetModel(3).dataTable,s=i.getLastNonNullCol(3,!0),l=t.getRowCount();for(n=t.getColumnCount()-1;-1<n;n--)for(r=0;r<l;r++)if((o=(e=a[r])&&e[n])&&!p(o.value))return f(n,s);return f(-1,s)}(t),c=i?i.QMb():-1;return(o=l)<(u=f(u,c))&&(n=1+l,r=new h.Range(a,n,s-a+1,u-l),o=f(function(t,e,o,n,r){var i,a,s;for(a=r;n<=a;a--)for(i=e;i<=o;i++){if(A(t.Iq(i,a)))return a;if(T(t,i,a))return a;if(s=t._modelManager.findSpan(i,a))return s.col+s.colCount-1}return-1}(t,a,s,n,u),i.QMb(r))),o},WMb:function(t,e,i,a,s,l,o,n,r,u){var c,h,f=t.getRowCount()-1,p=t.getColumnCount()-1,d=t._modelManager.getSpans(),g=e.tc&&e.tc.l$;return!n&&(!r&&f-a<o||r&&p-l<o)?(u||y(m().Exp_TableAddRowNoEnoughRoom),!0):(c=r?M:S,(h=d.some(function(t){var e=t.row,o=t.col,n=t.rowCount,r=t.colCount;return c(e,o,n,r,i,a,s,l)}))?u||y(m().Exp_TableAddRowIntersectSpan):g&&((h=g.some(function(t){var e=t.cj,o=t.dj,n=t.Xj,r=t.OZ;return c(e,o,n,r,i,a,s,l)}))&&!u&&y(m().Exp_TableAddRowIntersectTable)),h)},XMb:function(t,e,o){var n,r,i,a=e.row,s=e.col,l=a+e.rowCount,u=s+e.colCount;for(n=a;n<l;n++)for(r=s;r<u;r++)if((i=t.getCell(n,r)).value()||t._modelManager.findSpan(n,r)){if(o&&o.equals(new h.Range(i.row,i.col,1,1)))continue;return new h.Range(n,r,1,1)}return c},YMb:function(t,e){return{action:e,table:t}},ZMb:I,$Mb:function(t,e){return e-t.dj},_Mb:function(t){var e=u;return t&&u++,e},aNb:function(t){return"string"==typeof t},pMb:function(t,e,o,n){var r={sheet:t,table:e,oldRange:o,newRange:n};t.Wq(h.Events.TableResizing,r)},$Lb:function(t,e,o,n){var r={sheet:t,table:e,oldRange:o,newRange:n};t.Wq(h.Events.TableResized,r)},PIb:function(t,e,o,n,r,i,a){var s={sheet:t,table:e,propertyName:o,row:I(e,n),count:r};p(i)||(s.isAfter=i),a&&(s.deletedItem=a),t.Wq(h.Events.TableRowsChanged,s)},QIb:function(t,e,o,n,r,i){var a={sheet:t,table:e,propertyName:o,col:n-e.dj,count:r};p(i)||(a.isAfter=i),t.Wq(h.Events.TableColumnsChanged,a)},bNb:function(t,e,o){var n=0;if(t.VZ(e,o))for(n=2;t.VZ(e+n,n);)n++;return 0<n&&(e+=n),e},bW:function(t){return t&&"="===t[0]},cNb:function(t){var e,o,n=-1;if(t)for(e=t.arguments,o=0;o<e.length;o++)if(e[o]instanceof r.xzb){n=o;break}return n},dNb:function(t,e,o){var n=t.dataRange(),r=n.row,i=n.col;return(o?r:i)+e},eNb:function(t){var e=t;return t&&"="===t[0]&&(e=t.slice(1)),e},fNb:function(t,e){var o,n;for(n=0;n<t.length;n++)if((o=t[n])&&e===o.col)return o;return l},_getTable:function(t,e){var o,n,r;if(!e)return null;for(o=e.row;o<e.row+e.rowCount;o++)for(n=e.col;n<e.col+e.colCount;n++)if(t.tables&&(r=t.tables.find(o,n)))return r;return null},Pda:function(t,e){return e?t.tables.s$(e.row,e.col,e.rowCount,e.colCount):null},jhc:function(t){return p(t)||("string"!=typeof t&&(t+=""),t=t.replace(/\r\n?/g,"\n")),t},gNb:function(t){return t===c}}},"./dist/plugins/table/table.entry.js":function(t,o,e){"use strict";function n(t){for(var e in t)o.hasOwnProperty(e)||(o[e]=t[e])}Object.defineProperty(o,"__esModule",{value:!0}),e("./dist/plugins/table/table.interface.js"),e("./dist/plugins/table/table-event.js"),e("./dist/plugins/table/table-render.js"),e("./dist/plugins/table/table-action.js"),e("./dist/plugins/table/table-util.js"),n(e("./dist/plugins/table/table-theme.js")),n(e("./dist/plugins/table/table.js")),n(e("./dist/plugins/table/table.ns.js"))},"./dist/plugins/table/table.interface.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},"./dist/plugins/table/table.js":function(t,j,e){"use strict";var q,I,o,v,n,_,r,O,i,a,F,s,m,P,d,N,y,b,p,E,S,C,w,x,u,h,f,D,L,l,g,M,T,R,A,k,H,B,V,z,W,G,U,J,Z,K,Y,c,Q,X,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ht,ft,pt,dt,gt,mt,yt,bt,vt,Ct,wt,xt,Tt,At,St,Mt,It,Nt,Rt,kt,Et,Dt,jt,_t,Ot,Ft,Pt,Lt,Ht,Bt,Vt,zt,Wt,Gt,Ut,Jt,Zt,qt,Kt,Yt,Qt,Xt,$t,te,ee=this&&this.__extends||(Yt=function(t,e){return(Yt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}Yt(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),oe=this&&this.__assign||function(){return(oe=Object.assign||function(t){var e,o,n,r;for(o=1,n=arguments.length;o<n;o++)for(r in e=arguments[o])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function ne(t,e){var o,n,r=!1;if(!N(t[e]))for(o=t.length-1;e<o;o--){if(N(t[n=o-1])){r=!0;break}t[o]=t[n]}return r}function re(t,e){var o={position:q.ButtonPosition.right,imageType:q.ButtonImageType.dropdown,visibility:q.ButtonVisibility.onSelected,useButtonStyle:!1,command:"openList"},n={items:[{text:Wt().Table_None,value:null},{text:Wt().Table_Average,value:"=SUBTOTAL(101,["+e+"])"},{text:Wt().Table_Count,value:"=SUBTOTAL(103,["+e+"])"},{text:Wt().Table_Count_Numbers,value:"=SUBTOTAL(102,["+e+"])"},{text:Wt().Table_Max,value:"=SUBTOTAL(104,["+e+"])"},{text:Wt().Table_Min,value:"=SUBTOTAL(105,["+e+"])"},{text:Wt().Table_Sum,value:"=SUBTOTAL(109,["+e+"])"},{text:Wt().Table_StdDev,value:"=SUBTOTAL(107,["+e+"])"},{text:Wt().Table_Var,value:"=SUBTOTAL(110,["+e+"])"}]},r=new q.Style;return r.cellButtons=[o],r.dropDowns=[{type:q.DropDownType.list,option:n,submitCommand:"tableTotalRowFormula"}],r}function ie(t,e,o,n,r,i,a){var s,l=this;for(l.MZ=!a||a.showHeader===lt||a.showHeader,l.NZ=!(!a||a.showFooter===lt)&&a.showFooter,l.kNb=!(!a||a.useFooterDropDownList===lt)&&a.useFooterDropDownList,l.lNb=!(!a||a.showResizeHandle===lt)&&a.showResizeHandle,l.mNb=[],l.wq=st,l.xr=st,l.tc=st,l.lhc=!1,F(t)&&l.name(t),l.cj=F(e)?e:-1,l.dj=F(o)?o:-1,l.Xj=F(n)?n:-1,l.OZ=F(r)?r:-1,F(i)&&l.style(i),l.Nz=[],s=0;s<l.OZ;s++)l.Nz.push(new qt(s+1));l.ZX=st,l.LAb={},l.Bec=[],l.Ts=[],l.nNb=[],l.mhc=[],l.oNb=[],l.pNb=[],l.qNb=!0}function ae(n){return function(t,e){var o=this.kj;o&&t!==e&&(Jt.ao(o,"tableNameChanged",{oldName:e,newName:t}),o._modelManager.pVa(this,n,e))}}function se(t){this.kj=t,this.l$=[],this.$m=[],this.an=[]}function le(t,e,o,n,r,i){this.id(t),this.dataField(e),this.name(o||e||xt+this.id()),this.formatter(n),this.cellType(r),this.value(i)}function ue(t){var e=te.call(this)||this;return e.table(t),e}function ce(t,e,o,n,r){var i,a,s=0===r,l=s?t.Ts:t.nNb,u=-1;for(a=0;a<l.length;a++)if((i=l[a])&&i.key===n){u=a;break}-1<u&&l.splice(u,N(o)?1:o),s&&t.phc()}Object.defineProperty(j,"__esModule",{value:!0}),q=e("Core"),I=e("SheetsCalc"),o=e("@grapecity/js-sheets-common"),v=e("@grapecity/js-calc"),n=e("Filters"),_=e("Bindings"),r=e("./dist/plugins/table/table.ns.js"),O=e("./dist/plugins/table/table-theme.js"),i=e("./dist/plugins/table/table-util.js"),a=q.Ul.Pl,F=q.Ul.Ol,s=q.Ul.bc,m=q.GC$.inArray,P=q.GC$.each,d=q.GC$.isEmptyObject,N=o.Common.j.Fa,y=o.Common.l,b=o.Common.k.Bb,o.Common.k.ac,p=o.Common.D,E=i.Util.throwError,S=i.Util.setFormulaToSheet,C=i.Util.setValue,w=i.Util.suspendPaint,x=i.Util.resumePaint,u=i.Util.ih,h=i.Util.suspendCalcService,f=i.Util.resumeCalcService,D=i.Util.getRowCount,L=i.Util.getColCount,l=i.Util.checkTableName,g=i.Util.isValidTableName,M=i.Util.formulaToExpression,T=i.Util.expressionToFormula,R=i.Util.TMb,A=i.Util.nMb,k=i.Util.oMb,H=i.Util.UMb,B=i.Util.VMb,V=i.Util.WMb,z=i.Util.XMb,W=i.Util.YMb,G=i.Util.ZMb,U=i.Util.$Mb,J=i.Util._Mb,Z=i.Util.aNb,K=i.Util.RMb,Y=i.Util.SMb,c=i.Util.PIb,Q=i.Util.QIb,X=i.Util.bNb,$=i.Util.bW,tt=i.Util.cNb,et=i.Util.dNb,ot=i.Util.eNb,nt=i.Util.fNb,rt=i.Util.Pda,it=i.Util.jhc,at=i.Util.gNb,st=null,lt=void 0,ut=Math.min,ct=Math.ceil,ht=Math.max,ft=JSON.stringify,pt=JSON.parse,mt="highlightFirstColumn",yt="highlightLastColumn",bt="bandRows",vt="bandColumns",Ct="autoGenerateColumns",wt=".table",xt="Column",Mt="footerRowStyles",It=["id",dt="name",gt="cellType","value","formatter","dataField",Tt="footerFormula",At="dataAreaFormula",St="footerValue"],Nt="tableInsertRows",Rt="DoInsertRows",kt="tableShowFooter",Et="tableDeleteRows",Dt="tableInsertColumns",jt="tableDeleteColumns",_t="collection",Ot="tableColumn",Ft="dataSource",Pt="rowsChange",Lt="range",Ht="columns",Bt="tableExpression",Vt="sheetExpression",zt=new o.Common.ResourceManager(r.SR,"Tables"),Wt=zt.getResource.bind(zt),(Xt=Gt=j.TableSelectionType||(j.TableSelectionType={})).TABLE_ROW_SELECT="tableRowSelect",Xt.TABLE_COL_SELECT="tableColSelect",Xt.TABLE_CORNER_SELECT="tableCornerSelect",Xt.TABLE_SELECT="tableSelect",(Qt=Ut=Ut||{})[Qt.deleted=0]="deleted",Qt[Qt.dirty=1]="dirty",q.Worksheet.$n("table",{priority:2e3,init:function(){var m=this;m.tables=m._modelManager.noa,m.unbind(wt),m.bind(q.Events.BeforeDragDrop+wt,function(t,e){var o,n=m,r=m.tables,i=Wt().Exp_DragDropChangePartOfTable,a=e.fromRow,s=e.fromColumn,l=D(e),u=e.columnCount,c=n._eventHandler.gA,h=c.row,f=c.col,p=e.isDragInsert,d=e.isDragCopy,g=st;!p||-1!==a&&-1!==s||(0<=s?(m.isDragCopy&&(f<=s||s+u<=f)||!d&&(f<s||s+u<f))&&(o=!1,r.HZ(-1,f,-1,1)&&(o=!0,g=Wt().Exp_DragDropShiftTableCell),o||d||!r.HZ(-1,s,-1,u)||(g=i)):0<=a&&s<0&&(d&&(h<=a||a+l<=h)||!d&&(h<a||a+l<h))&&!d&&r.HZ(a,-1,l,-1)&&(g=i)),e.invalidMessage=g}),m.bind(q.Events.RowChanged+wt,function(t,e){var o=m.tables,n=o.$m,r=e.propertyName;"isVisible"===r?(!1===e.newValue?n[e.row]=0:n[e.row]=lt,o.hNb(e.row)):"height"===r&&(n[e.row]=lt,o.hNb(e.row))}),m.bind(q.Events.RowHeightChanged+wt,function(t,e){var o,n,r,i,a=m.tables,s=a.$m;for(o=0,n=e.rowList;o<n.length;o++)s[r=n[o]]=lt,i=e.sheet.getRowHeight(r),a.hNb(r,0<i)}),m.bind(q.Events.ColumnChanged+wt,function(t,e){var o=m.tables,n=o.an;"isVisible"===e.propertyName?(!1===e.newValue?n[e.col]=0:n[e.col]=lt,o.iNb(e.col)):"width"===e.propertyName&&(n[e.col]=lt,o.iNb(e.col))}),m.bind(q.Events.ColumnWidthChanged+wt,function(t,e){var o,n,r,i=m.tables,a=i.an;for(o=0,n=e.colList;o<n.length;o++)a[r=n[o]]=lt,i.iNb(r)}),m.bind(q.Events.RangeFiltered+wt,function(t,e){var o,n=m.tables,r=n.$m,i=e.sheet.xr.range;for(o=0;o<i.rowCount;o++)r[i.row+o]=lt,n.hNb(i.row+o)}),m.bind(q.Events.TableFiltered+wt,function(t,e){var o,n=m.tables,r=n.$m,i=e.table.range();for(o=0;o<i.rowCount;o++)r[i.row+o]=lt,n.hNb(i.row+o)}),m.bind(q.Events.TableFilterCleared+wt,function(t,e){m.tables.Nm()})},resetBinding:function(t){this.tables.IZ()},initBinding:function(t){var e,o,n,r,i=this.tables;for(i.IZ(),h(this),o=0,n=(e=i.all()).length;o<n;o++)(r=e[o])&&r.JZ();f(this)},dispose:function(t){!1!==t.clearCache&&(this.unbind(wt),this.tables&&(this.tables.no(),this.tables=null))},clearPendingChanges:function(){var t=this.tables;t&&t.Xec()},onGroupChanged:function(t){var e,o,n=this.tables;if(t.fromSetCollapsed)for(e=t.isRow?n.$m:n.an,o=t.start;o<=t.end;o++)e[o]=lt,t.isRow?n.hNb(o):n.iNb(o)},onLayoutChanged:function(t){var e,o=t.changeType,n=t.row,r=t.rowCount,i=t.col,a=t.colCount,s=this.tables;"addRows"===o?(s.rI(n,r),s.Nm()):"addRows2"===o?s.KZ(n,r):"deleteRows"===o?(s.GR(n,r),s.Nm()):"addColumns"===o?(s.tI(i,a),s.Nm()):"deleteColumns"===o?(s.HR(i,a),s.Nm()):"addColumns2"===o||"deleteColumns2"===o?s.khc(i):"clear"===o?(e=t.sheetArea,t.ignoreTable||3!==e&&!N(e)||s.$b(n,i,r,a,t.type)):"setRowCount"!==o&&"setColumnCount"!==o||s.Nm()},toJson:function(t,e){var o,n,r,i;o=this.tables,n=e&&e.ignoreStyle,r=e&&e.newWorkSheetName,n||(o&&(t.tables=o.toJSON(r)),e&&e.includeBindingSource&&((i=t.data).dataTable=i.dataTable||{},function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d,g=t.tables.all();for(o=0,n=g.length;o<n;o++)if(i=(r=g[o]).LZ(),s=(a=r.dataRange()).row,l=a.col,u=s+D(a)-1,c=l+L(a)-1,i)for(h=s;h<=u;h++)for(f=l;f<=c;f++)(p=r.ge(h,f)).gt&&(d=p.Qb,y.Ska(d)&&(d=y.Daa(d)),t.qI(e,h,f,d))}(this,i.dataTable)))},fromJson:function(t,e,o){var n=this.tables,r=t.tableManager,i=e?r&&r.tables:t.tables,a=o&&o.ignoreStyle;F(i)&&!a&&n&&n.fromJSON(i,e)},fromJsonAfterFormula:function(t,e,o){this.tables.all().forEach(function(t){t.formulaFromJSON()})},lastNonNullRowAndCol:function(){var t,e,o,n,r,i,a=0,s=0,l=this.tables.all();if(l)for(t=0,e=l.length;t<e;t++)(o=l[t])&&(a<(r=(n=o.range()).row+D(n)-1)&&(a=r),s<(i=n.col+L(n)-1)&&(s=i));return{lastNonNullRow:a,lastNonNullCol:s}},paintCell:function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y;t.isPrinting||t.sheetArea!==q.SheetArea.viewport||this.options.isProtected||(e=this.tables,o=t.ctx,r=(n=t.cell).row,i=n.col,(a=e.find(r,i))&&a.showResizeHandle()&&!a.hJb()&&(s=A(this,a),l=k(this,a),r===s&&i===l&&(u=n.x,c=n.y,h=n.width,f=n.height,p=this.zoom(),d=ct(4*p),g=ct(2*p),m=u+h,y=c+f,o&&0<h&&0<f&&(o.save(),o.rect(u,c,h,f),o.clip(),o.fillStyle="#485DB1",o.beginPath(),o.moveTo(m-d,y),o.lineTo(m,y),o.lineTo(m,y-g),o.lineTo(m-d,y-g),o.fill(),o.beginPath(),o.moveTo(m,y-g),o.lineTo(m-g,y-g),o.lineTo(m-g,y-d),o.lineTo(m,y-d),o.fill(),o.restore()))))},composeTableFooterList:function(t){var e=t.table,o=t.row,n=t.col,r=t.style;e.jNb(o,n,r)}}),q.Worksheet.prototype.PIb=function(t,e,o,n,r,i){var a=i?lt:t.nKb();c(this,t,e,o,n,r,a)},q.Worksheet.prototype.QIb=function(t,e,o,n,r){Q(this,t,e,o,n,r)},q.Workbook.prototype.jga=function(t){var e,o,n,r=this.sheets;if(r)for(n=0;n<r.length;n++)if((o=r[n].tables)&&(e=o.findByName(t)))return e;return st},ie.prototype.no=function(){var t=this;t.Nz=[],t.mNb=[],t.Ts=[],t.nNb=[],t.mhc=[],t.LAb={},t.Bec=[],t.kj=st,t.tc=st,t.xr&&(t.xr.no(),t.xr=st),t.Nm()},ie.prototype.Nm=function(){this.oNb=[],this.pNb=[]},ie.prototype.range=function(){return q.kf(this.cj,this.dj,this.Xj,this.OZ)},ie.prototype.dataRange=function(){var t=this.MZ?this.cj+1:this.cj,e=this.MZ?this.Xj-1:this.Xj;return this.NZ&&e--,q.kf(t,this.dj,e,this.OZ)},ie.prototype.headerIndex=function(){return this.MZ?this.cj:-1},ie.prototype.footerIndex=function(){return this.NZ?this.cj+this.Xj-1:-1},ie.prototype.showHeader=function(t){var e;return 0===arguments.length?this.MZ:(this.MZ!==t&&((e=this.kj)&&e.suspendPaint(),this.qVa(t),e&&e.resumePaint()),this)},ie.prototype.qVa=function(t){var e,o=this,n=o.kj;n&&n._modelManager.pVa(o,"showHeader",o.MZ),(o.MZ=t)?(0<o.cj&&(o.cj=o.cj-1,o.Xj+=1),o.PZ()):(e=o.cj,o.cj=o.cj+1,--o.Xj,o.QZ(e),o.RZ()),n&&v&&n.recalcRange(o.cj+(t?0:-1),o.dj,1,o.OZ)},ie.prototype.showFooter=function(t,e){var o;if(0===arguments.length)return this.NZ;if(this.NZ!==t){(o=this.kj)&&o.suspendPaint();try{this.rVa(t,!!e&&e)}finally{o&&o.resumePaint()}}return this},ie.prototype.expandBoundRows=function(t){return 0===arguments.length?this.lhc:(this.lhc!==t&&(this.lhc=t),this)},ie.prototype.rVa=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p=this,d=p.kj;if(d&&d._modelManager.pVa(p,"showFooter",p.NZ),o=p.Xj,t){if((!d||p.cj+o<d.getRowCount())&&(!e||p.rNb(!0,o)))for(p.NZ=t,p.Xj+=1,r=(n=p.Nz).length,i=p.footerIndex(),a=p.dj,s=0;s<r;s++)c=a+s,(u=(l=n[s])&&l.footerFormula())&&(h=T(d,u,i,c))&&(u=M(d,h,i,c),l.footerFormula(u));p.SZ()}else p.NZ=t,f=p.cj+o-1,--p.Xj,p.QZ(f),p.NAb(),p.Cec(0),e&&p.rNb(!1,o);d&&v&&d.recalcRange(p.cj+p.Xj+(t?-1:0),p.dj,1,p.OZ)},ie.prototype.rNb=function(t,e){var o,n=this.kj,r=this.cj+e,i=this.dj,a=this.OZ,s=i+a-1,l=H(n,this),u=r<=l,c=z(n,new q.Range(r,i,l-r+1,s-i+1)),h=(c&&c.row)===r;return!(h&&V(n,this,r,l,i,s,1)||(h&&u&&(o=t?r+1:r-1,n.moveTo(r,i,o,i,l-r+1,a,1023)),0))},ie.prototype.sNb=function(t){var e,o,n,r=this.Nz,i=r.length,a=this.dj,s=[],l=this.name();for(e=0;e<i;e++)o=a+e,n=this.getColumnName(e),s.push(re(0,n)),t||(0===e?this.j$(o,Wt().Table_Total,!0):e===i-1&&(r[e].footerFormula()||(this.tNb(o)?this.i$(e,"=SUBTOTAL(109,"+l+"["+n+"])"):this.i$(e,"=SUBTOTAL(103,"+l+"["+n+"])"))));this.mNb=s},ie.prototype.tNb=function(t){var e,o,n=this.kj,r=this.dataRange(),i=!0,a=r.rowCount,s=r.row;for(e=0;e<a;e++)if(o=n.getValue(s+e,t),!N(o)&&"number"!=typeof o){i=!1;break}return i},ie.prototype.uNb=function(){return this.mNb&&0<this.mNb.length},ie.prototype.vNb=function(t,e,o){var n=this.kj;this.uNb()&&(n&&n._modelManager.pVa(this,Mt,this.wNb()),0<=e&&(o?this.mNb.splice(t,e,o):this.mNb.splice(t,e)))},ie.prototype.wNb=function(){var t=this.mNb,e=[];return t.forEach(function(t){t&&e.push(t.clone())}),e},ie.prototype.xNb=function(t,e,o){var n=F(o)?re(this.name(),o):st;this.uNb()&&this.vNb(t,e,n)},ie.prototype.useFooterDropDownList=function(t){var e=this,o=e.kj;return 0===arguments.length?e.kNb:(o&&(o.suspendPaint(),e.kNb!==t&&(o._modelManager.pVa(e,"useFooterDropDownList",e.kNb),e.kNb=t,e.kNb&&!e.uNb()&&(e.sNb(),e.e$())),o.resumePaint()),e)},ie.prototype.showResizeHandle=function(t){var e=this.kj;return 0===arguments.length?this.lNb:(e&&(e.suspendPaint(),this.lNb!==t&&(e._modelManager.pVa(this,"showResizeHandle",this.lNb),this.lNb=t),e.resumePaint()),this)},ie.prototype.rowFilter=function(){return!this.xr&&j.MAb&&(this.xr=new j.MAb(this),this.xr.EZ(this.dataRange())),this.xr},ie.prototype.bindColumns=function(t){var e,o,n,r,i,a,s,l,u,c,h=[];if(t)for(e=ut(this.OZ,t.length),o=0;o<e;o++)(n=this.Nz[o])||(n=new qt(this.TZ()),this.Nz[o]=n),i=(r=t[o]).id(),a=r.name(),s=r.dataField(),l=r.value(),u=X(this,a,o),n.id(i),n.name(u),n.dataField(s),n.value(l),n.cellType(r.cellType()),n.formatter(r.formatter()),c={name:u,value:l,dataField:s},s&&h.push(c),this.xNb(o,1,u);this.yNb=h,this.wq&&(this.wq.qia=h)},ie.prototype.bindingPath=function(t){return 0===arguments.length?this.UZ:(this.UZ=t,this.JZ(),this)},ie.prototype.bind=function(t,e,o){var n=o;return N(t)||this.bindColumns(t),N(o)&&(n=this.LZ()),e&&(this.UZ=e,n=_.LL(n,e)),_.qL&&n&&this.zNb(n),this},ie.prototype.getColumnName=function(t){var e,o,n=this.Nz;return n&&0<=t&&t<n.length&&(e=n[t])?((o=e.name())!==st&&(o=s(o)),o):st},ie.prototype.setColumnName=function(t,e){var o,n,r,i,a=this;return a.VZ(e)||(o=a.Nz)&&0<=t&&t<o.length&&(r=(n=(n=o[t])||(a.Nz[t]=new qt(a.TZ()))).name(),i=a.kj,r!==e&&i&&(i._modelManager.sVa(n,"name",r),n.name(e)),a.MZ&&i&&i.setText(a.headerIndex(),a.dj+t,e),a.WZ(r,n.name(),t)),a},ie.prototype.WZ=function(t,e,o){var n,r=this.Nz[o];this.xNb(o,1,r.name()),(n=this.ZX)&&n.onColumnNameChanged(t,e)},ie.prototype.setColumnDataField=function(t,e){var o,n,r,i=this.Nz;return i&&0<=t&&t<i.length&&(o=(o=i[t])||(this.Nz[t]=new qt(this.TZ())),n=this.kj,r=o.dataField(),n&&e!==r&&n._modelManager.sVa(o,"dataField",r),o.dataField(e)),this},ie.prototype.getColumnDataField=function(t){var e,o,n=this.Nz;return n&&0<=t&&t<n.length&&(e=n[t])?((o=e.dataField())!==st&&(o=s(o)),o):st},ie.prototype.getColumnFormula=function(t){var e,o,n,r,i=this.Nz,a=this.kj;return i&&a&&0<=t&&t<i.length&&(e=i[t])?(o=this.footerIndex(),n=this.dj+t,(r=e.footerFormula())&&T(a,r,o,n,!1)):st},ie.prototype.setColumnFormula=function(t,e){return this.i$(t,e),this},ie.prototype.setColumnDataFormula=function(t,e){var o,n,r,i,a,s,l,u,c;if(v){if((o=this.Nz)&&0<=t&&t<o.length&&(n=o[t])){for(r=this.kj,h(r),i=t+this.dj,a=this.cj,s=this.Xj,this.showHeader()&&(a++,s--),this.showFooter()&&s--,l=M(r,e,a,i,!0),u=n.dataAreaFormula(),r&&l!==u&&r._modelManager.sVa(n,"dataAreaFormula",u),n.ANb(e),n.dataAreaFormula(l),c=a;c<a+s;c++)S(r,c,i,e,l);f(r,!1)}return this}},ie.prototype.getColumnValue=function(t){var e,o,n=this.Nz;return n&&0<=t&&t<n.length&&(e=n[t])?this.NZ&&e.footerFormula()&&(o=this.kj)?o.getValue(this.footerIndex(),this.dj+t):e.footerValue():st},ie.prototype.setColumnValue=function(t,e){var o,n,r=this.Nz,i=this.kj;return r&&0<=t&&t<r.length&&((o=r[t])&&(n=o.footerValue(),i&&e!==n&&i._modelManager.sVa(o,"footerValue",n),o.footerValue(e)),this.NZ&&i&&C(i,this.footerIndex(),this.dj+t,e)),this},ie.prototype.filterButtonVisible=function(t,e){var o,n,r,i,a=this.kj,s=this.rowFilter();if(!(t<0||t>=this.OZ))switch(o=arguments,o.length){case 0:return s&&s.filterButtonVisible();case 1:if("number"==(r=typeof(n=o[0])))return s&&s.filterButtonVisible(n);if("boolean"==r&&s){for(w(a),i=0;i<this.OZ;i++)s.filterButtonVisible(i,n);x(a)}return this;case 2:return s&&s.filterButtonVisible(t,e),this}},ie.prototype.allowAutoExpand=function(t){var e=this.kj;return 0===arguments.length?this.qNb:(this.qNb!==t&&(e._modelManager.pVa(this,"allowAutoExpand",this.qNb),this.qNb=t),this)},ie.prototype.Aq=function(){return!!this.ZX},ie.prototype.Yv=function(t){var e=this.tc;this.BNb(t),this.kj&&this.kj._modelManager&&this.kj._modelManager.CNb(this,e)},ie.prototype.BNb=function(t){var e;this.tc=t,this.kj=t&&t.kj,e=this.xr,t&&e&&e.kj!==t.kj&&e.table(this)},ie.prototype._bind=function(t){var o,n,e,r,i,a,s,l,u,c=this,h=c.autoGenerateColumns(),f=c.xr&&c.xr.qZ;if(c.RZ(),(o=c.kj)&&(n=c.dataRange(),h?o.cg(n.row,n.col,D(n),L(n),3,17,!1,!0):P(c.Nz,function(t,e){e.dataField()&&o.cg(n.row,n.col+t,D(n),1,3,17,!1,!0)})),h&&(e=c.range(),c.$b(e.row,e.col,D(e),L(e)),c.SZ(e.col,L(e),!0)),t.qia=c.yNb,c.wq=t)if(o&&o._modelManager.pVa(c,Lt,{row:c.cj,col:c.dj,rowCount:c.Xj,colCount:c.OZ}),r=t.getRowCount(),i=t.getColumnCount(),c.MZ&&r++,c.NZ&&r++,c.Xj=r,h){for(c.OZ=i,c.Nz=[],a=t.rL(),s=0;s<c.OZ;s++)l=new qt(s+1),c.Nz[s]=l,a&&(l.name(a[s]),l.dataField(a[s]));c.kNb&&(c.mNb=[],c.JNb(c.dj))}else u=[],c.Nz.forEach(function(t){var e=t.dataField();e&&u.push(e)}),t.Nka(u);c.xr&&(c.xr.EZ(c.dataRange()),c.xr.qZ=f)},ie.prototype.XZ=function(t){var e,o,n,r,i,a=this.wq;if(a&&(e=a.rL()))for(n=(o=this.Nz[t-this.startColumn()])&&o.dataField(),r=0,i=e.length;r<i;r++)if(e[r]===n)return r;return-1},ie.prototype.ge=function(t,e){var o,n=!1,r=lt,i=this.wq,a=t-this.dataRange().row;return i&&a<i.getRowCount()&&0<=(o=this.XZ(e))&&(n=!0,r=i.getValue(a,o).value),{gt:n,Qb:r}},ie.prototype.yq=function(t,e,o,n){var r,i,a,s,l,u,c=this.wq,h=G(this,t),f=this.xr,p=!1;return c&&0<=(r=this.XZ(e))&&(n&&f&&f.isRowFilteredOut(t)||(i=(a=c.getValue(h,r)).value,(l=(s=this.kj)&&s._modelManager)&&a.hasBinding&&i!==o&&(u=J(!0),this.DNb(t,h,u),l.ENb(this,t,st,u,Ut.dirty),l.Cp(t,e,{Ep:i})),c.setValue(h,r,o,l&&l.zTa)),p=!0),p},ie.prototype.Gq=function(t,e,o){var n=new q.Style;return this.Yo(t,e,n,o),n},ie.prototype.D3=function(t){var e,o=this.tc.$m,n=o[t];return n!==lt?n:(e=this.kj,n=o[t]=e.getRowHeight(t))},ie.prototype.C3=function(t){return this.kj.getColumnWidth(t)},ie.prototype.Yo=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J=this,Z=J.style();if(Z){if(r=J.kj,i=J.MZ,a=J.NZ,s=J.Nz,l=J.highlightLastColumn(),u=J.highlightFirstColumn(),c=J.headerIndex(),h=J.footerIndex(),f=i?t===J.cj+1:t===J.cj,p=a?t===J.cj+J.Xj-2:t===J.cj+J.Xj-1,d=e===J.dj,g=e===J.dj+J.OZ-1,m=i?t===c:t===J.cj,y=a?t===h:t===J.cj+J.Xj-1,b=Z.highlightLastColumnStyle(),v=Z.highlightFirstColumnStyle(),C=new q.Style,c===t)w=Z.lastHeaderCellStyle(),g&&l&&w&&w.Yo(C,!0,!0,!0,!0),x=Z.firstHeaderCellStyle(),d&&u&&x&&x.Yo(C,!0,!0,!0,!0),(T=Z.headerRowStyle())&&T.Yo(C,!0,d,!0,g),g&&l&&b&&b.Yo(C,!0,!0,!1,!0),d&&u&&v&&v.Yo(C,!0,!0,!1,!0);else if(h===t)A=Z.lastFooterCellStyle(),g&&l&&A&&A.Yo(C,!0,!0,!0,!0),S=Z.firstFooterCellStyle(),d&&u&&S&&S.Yo(C,!0,!0,!0,!0),(M=Z.footerRowStyle())&&M.Yo(C,!0,d,!0,g),g&&l&&b&&b.Yo(C,!1,!0,!0,!0),d&&u&&v&&v.Yo(C,!1,!0,!0,!0);else{if(g&&l&&b&&b.Yo(C,m,!0,y,!0),d&&u&&v&&v.Yo(C,m,!0,y,!0),I=i?t-J.cj-1:t-J.cj,N=e-J.dj,O=_=j=D=E=k=R=void 0,F=!n||"cellType"!==n&&"formatter"!==n,J.bandRows()&&F&&0<(k=(R=Z.firstRowStripSize())+Z.secondRowStripSize())){if(void 0===(E=J.oNb[t])){if(q.mn.nn&&q.mn.sn){for(P=q.mn.sn,L=J.dataRange().row;-1===P[L];)L++;if(t<L)return;I=P[t]-P[L]}else if(r){for(H=0,L=J.dataRange().row;L<t;L++)0<J.D3(L)&&H++;I=H}E=J.oNb[t]=I%k}D=Z.firstRowStripStyle(),j=Z.secondRowStripStyle(),E<R&&D?(_=0===E,O=p||E===R-1,D.Yo(C,_,d,O,g)):R<=E&&j&&(_=E===R,O=p||E===k-1,j.Yo(C,_,d,O,g))}if(J.bandColumns()&&F&&0<(k=(R=Z.firstColumnStripSize())+Z.secondColumnStripSize())){if(void 0===(E=J.pNb[e])){if(B=0,r)for(V=J.dj;V<e;V++)0<J.C3(V)&&B++;E=J.pNb[e]=B%k}D=Z.firstColumnStripStyle(),j=Z.secondColumnStripStyle(),E<R&&D?(_=0===E,O=g||E===R-1,D.Yo(C,f,_,p,O)):R<=E&&j&&(_=E===R,O=g||E===k-1,j.Yo(C,f,_,p,O))}s&&0<s.length&&(z=s[N])&&(W=z.cellType(),G=z.formatter(),W&&(C.cellType=W),G&&(C.formatter=G))}(U=Z.wholeTableStyle())&&U.Yo(C,m,d,y,g),J.Oka(o,C)}},ie.prototype.jNb=function(t,e,o){var n,r,i,a=this.NZ,s=this.kNb;this.footerIndex()===t&&a&&this.uNb()&&(n=this.mNb[e-this.dj])&&s&&(r=o.cellButtons,i=o.dropDowns,N(r)&&(r=[]),o.cellButtons=r.concat(n.cellButtons),N(i)&&(i=[]),o.dropDowns=i.concat(n.dropDowns))},ie.prototype.Oka=function(t,e){var o,n,r,i,a=t;N(a.backColor)&&(a.backColor=e.backColor),at(a.foreColor)&&(a.foreColor=e.foreColor),N(a.themeFont)&&N(a.font)?(a.themeFont=e.themeFont,a.font=e.font):!N(a.themeFont)&&N(a.font)&&(a.font=e.font),N(a.borderLeft)&&(o=e.borderLeft,a.borderLeft=o&&o.Uo()||o,a.borderLeft&&(a.borderLeft.level=20)),N(a.borderTop)&&(n=e.borderTop,a.borderTop=n&&n.Uo()||n,a.borderTop&&(a.borderTop.level=20)),N(a.borderRight)&&(r=e.borderRight,a.borderRight=r&&r.Uo()||r,a.borderRight&&(a.borderRight.level=20)),N(a.borderBottom)&&(i=e.borderBottom,a.borderBottom=i&&i.Uo()||i,a.borderBottom&&(a.borderBottom.level=20)),N(a.textDecoration)&&(a.textDecoration=e.textDecoration),N(a.cellType)&&(a.cellType=e.cellType),N(a.formatter)&&(a.formatter=e.formatter)},ie.prototype.YZ=function(t,e){var o,n,r,i,a,s=this;if((t!==s.cj||e!==s.dj)&&(o=s.kj)){if((t<0||o.getRowCount()<t+s.Xj||e<0||o.getColumnCount()<e+s.OZ)&&E(Wt().Exp_TableMoveOutOfRange),i=r=void 0,n=s.tc)for(i=0,a=(r=n.l$).length;i<a;i++)if(r[i]===s){r.splice(i,1),s.ZZ();break}o.moveTo(s.cj,s.dj,t,e,s.Xj,s.OZ,3),r&&i<=a&&(s.$Z(t,e),r.splice(i,0,s),s._Z()),this.Cec(1)}},ie.prototype.$Z=function(t,e){var o=this,n=o.kj;n&&n._modelManager.pVa(o,Lt,{row:o.cj,col:o.dj,rowCount:o.Xj,colCount:o.OZ}),o.cj=t,o.dj=e,o.a$(),o.Nm()},ie.prototype.ZZ=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m,y=this,b=y.kj;if(b&&v){for(n=y.Nz,r=y.footerIndex(),i=y.range(),s=(a=y.dataRange()).row,l=D(a),N(t)&&(t=0,e=n.length);t<e;t++)if(u=n[t],c=i.col+t,u){for(u.footerFormula()&&0<=r&&(S(b,r,c,st),C(b,r,c,st)),h=u.ANb(),f=ot(h),d=p=void 0,g=0;g<l;g++)d=s+g,p=b.getFormula(d,c),N(p)||(N(y.FNb)&&(y.FNb=[]),y.FNb.push({row:d,col:c,formula:p})),N(p)||!N(f)&&T(b,M(b,f,y.cj,c),d,c)===p||(N(y.GNb)&&(y.GNb=[]),m=nt(y.GNb,c),N(m)?((m={}).col=c,m.rowIndexes=[],m.rowIndexes.push(d),y.GNb.push(m)):m.rowIndexes.push(d));if(u.ANb(lt),u.dataAreaFormula())for(g=0;g<l;g++)S(b,d=s+g,c,st),C(b,d,c,st)}!0===o&&(y.FNb=[])}},ie.prototype.HNb=function(t,e,o){var n,r,i,a,s,l,u=this.kj,c=this.FNb;if(c){for(i=0;i<c.length;i++)n=!0,(r=c[i])&&(a=r.row,s=r.col,l=r.formula,t<=a&&(!0===o&&(a+=e),!1===o&&(a<t+e?n=!1:a-=e)),n&&S(u,a,s,l));this.FNb=[]}this.Gj(t,e,!0,o)},ie.prototype.INb=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T=this.kj,A=this.FNb;if(A){for(i=0;i<A.length;i++)n=!0,(r=A[i])&&(a=r.row,s=r.col,l=r.formula,t<=s&&(!0===o&&(s+=e),!1===o&&(s<t+e?n=!1:s-=e)),n&&S(T,a,s,l));for(u=this.GNb||[],c=void 0,i=0;i<u.length;i++)(c=u[i])&&t<=(h=c.col)&&(!0===o&&(c.col+=e),!1===o&&t+e<=h&&(c.col-=e));for(this.Gj(t,e,!1,o),p=(f=this.Nz).length,g=(d=this.dataRange()).row,m=d.col,y=d.rowCount,w=C=v=b=void 0,i=0;i<p;i++)if(w=m+i,(v=f[i])&&v.dataAreaFormula()){for(b=g,x=0;x<u.length;x++)if((c=u[x])&&c.col===w){for(;-1<c.rowIndexes.indexOf(b)&&b<g+y;)b++;break}b<g+y&&(C=T.getFormula(b,w))&&v.dataAreaFormula(M(T,C,g,w))}this.FNb=[],this.GNb=[]}},ie.prototype.Gj=function(t,e,o,n,r){var i,a,s,l,u,c,h=this.kj,f=this.Nz,p=this.footerIndex(),d=this.dataRange(),g=d.row,m=d.col,y=d.rowCount,b=d.colCount,v=h.Bj(),C=h.Wu;if(C&&v&&(i=C.ih())&&(r||(i.Dj(v,g,m,y,b),i.Gj(v._source,t,e,o,n,!0)),this.NZ))for(r||(i.Dj(v,p,m,1,b),i.Gj(v._source,t,e,o,n,!1)),c=0;c<b;c++)(a=f[c])&&(u=m+c,(s=a.footerFormula())&&(l=h.getFormula(p,u))&&(h&&h._modelManager.sVa(a,"footerFormula",s),a.footerFormula(M(h,l,p,u))))},ie.prototype._Z=function(){var l,u,c,h=this.kj;h&&v&&(l=this.footerIndex(),u=this.range(),c=this.dataRange(),P(this.Nz,function(t,e){var o,n,r,i=u.col+t,a=e.footerFormula(),s=e.dataAreaFormula();if(a&&0<=l&&S(h,l,i,st,a),s)for(o=0,n=D(c);o<n;o++)r=c.row+o,S(h,r,i,st,s)}))},ie.prototype.b$=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R=this,k=R.dataRange();if(!t.equals(R.range())){if(e=t.row,o=t.col,n=D(t),r=L(t),i=R.MZ,a=R.NZ,s=R.kNb,l=0,i&&(l+=1),a&&(l+=1),(u=R.kj)&&((n<l||r<1||e+n>u.getRowCount()||o+r>u.getColumnCount())&&E(Wt().Exp_TableResizeOutOfRange),e===R.cj&&t.intersect(R.cj,R.dj,R.Xj,R.OZ)||E(Wt().Exp_TableResizeInvalidRange),u._modelManager.pVa(R,Lt,{row:R.cj,col:R.dj,rowCount:R.Xj,colCount:R.OZ}),u._modelManager.pVa(R,Ht,R.Nz.slice())),c=R.Nz,f=(h=o)+r-1,p=R.dj,d=R.dj+R.OZ-1,g=R.OZ,R.dj=o,R.OZ=r,h<p){for(m=0,y=h;y<p;y++)b=new qt(R.TZ()),c.splice(m,0,b),m++;i&&R.PZ(0,p-h),a&&R.SZ(0,p-h)}else h<=d&&(R.ZZ(p,h),c.splice(0,h-p));if(d<f){for(y=1+d;y<=f;y++)b=new qt(R.TZ()),c.push(b);i&&R.PZ(g,f-d),a&&R.SZ(g,f-d),s&&R.JNb(g)}else p<=f&&(R.ZZ(f,d),c.splice(c.length-(d-f),d-f));n!==R.Xj&&(v=R.wq,w=(C=R.dataRange()).row,x=D(C),v?n>R.Xj?(T=w+x-1,A=n-R.Xj,u&&(S=T+A+1,(M=z(u,new q.Range(S,h,u.getRowCount()-S,f)))&&M.row<S||R.eMb(T,A,!0,!1))):u&&(I=R.Xj-n,R.STa(w+x-I,I)):(N=void 0,a&&(R.SZ(),N=R.footerIndex()),R.Xj=n,R.LNb(),a&&(R.e$(),R.QZ(N)))),R.a$(),R.f$(k,R.dataRange()),R.NAb(),R.Cec(0)}},ie.prototype.f$=function(t,e){var o,n,r,i,a,s,l,u,c,h,f=this.ZX;f&&(o=t.col,n=D(t),r=L(t),i=e.col,a=D(e),s=L(e),l=t.row+n,u=o+r,h=i+s,(c=e.row+a)<l&&f.onRowsRemoved(a,l-c),l<c&&f.onRowsAdded(n,c-l),o<i&&f.onColumnsRemoved(0,i-o),h<u&&f.onColumnsRemoved(s,u-h),i<o&&f.onColumnsAdded(0,o-i),u<h&&f.onColumnsAdded(o+r-i,h-u))},ie.prototype.a$=function(){var t=this.xr;t&&(t.EZ(this.dataRange()),t.reFilter())},ie.prototype.RZ=function(){var t=this.xr;t&&(t.unfilter(),t.reset())},ie.prototype.VZ=function(t,e){var o;for(t!==st&&(t=s(t)),o=0;o<this.OZ;o++)if(o!==e&&t===this.getColumnName(o))return!0;return!1},ie.prototype.g$=function(t){var e,o,n,r=this.Nz;return this.MZ&&r&&0<=(e=t-this.dj)&&e<r.length&&(o=r[e])?(n=o.name(),N(n)||(n=s(n)),n):st},ie.prototype.h$=function(t,e){var o,n,r,i,a,s=this.Nz;this.MZ&&s&&(o=s.length,0<=(n=t-this.dj)&&n<o&&(r=s[n])&&(i=r.name(),(a=this.kj)&&e!==i&&a._modelManager.sVa(r,"name",i),r.name(e),this.WZ(i,r.name(),n)))},ie.prototype.i$=function(t,e,o){var n,r,i=this.Nz,a=this.footerIndex(),s=this.dj+t,l=this.kj;v&&0<=t&&t<i.length&&(n=i[t],e&&!o&&l&&(o=M(l,e,a,s),this.NZ&&S(l,a,s,e,o)),n&&(r=n.footerFormula(),l&&o!==r&&l._modelManager.sVa(n,"footerFormula",r),n.footerFormula(o)))},ie.prototype.j$=function(t,e,o){var n,r,i,a,s=this.Nz;!o&&!this.NZ||!s||0<=(n=t-this.dj)&&n<s.length&&(r=s[n])&&(e===(i=r.footerValue())||(a=this.kj)&&(a._modelManager.sVa(r,"footerValue",i),a._modelManager.Cp(this.cj+this.Xj-1,t,{Ep:r.footerValue()})),r.footerValue(e))},ie.prototype.TZ=function(){var t,e,o=this.Nz,n=o&&o.length,r=[];for(e=0;e<n;e++)(t=o[e])&&t.k$()&&r.push(t.id());if(r.sort(function(t,e){return t-e}),0<(n=r.length)){for(e=0;e<n;e++)if(r[e]!==e+1)return e+1;return n+1}return 1},ie.prototype.dga=function(t,e){var o,n,r,i;if(t&&!this.VZ(t,e))return t;if(n=xt,r=0,t)n=t,r=1;else if(0<e&&(t=this.Nz[e-1].name(),i=/[0-9]+$/.exec(t))){if(o=(n=t.substr(0,i.index))+((r=parseInt(t.substr(i.index),10))+1),!this.VZ(o))return o;n=t,r=1}for(;;)if(o=n+ ++r,!this.VZ(o))return o},ie.prototype.PZ=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p=this,d=p.Nz,g=p.kj;if(p.MZ&&d&&g)for(n=d.length,r=p.headerIndex(),i=p.dj,N(t)&&(t=0),N(e)&&(e=n),s=ut(n,t+e),u=t;u<s;u++)(a=d[u])&&(c=p.tc.l$,-1<(h=m(p,c))&&c.splice(h,1),l=it(g.getValue(r,i+u)),-1<h&&c.splice(h,0,p),S(g,r,i+u,st),l&&!o?(v&&g.zq(r,i+u),(f=p.dga(l,u))===l?(g._modelManager.sVa(a,"name",a.name()),a.name(l)):g.setText(r,i+u,f)):(p.KNb=o,g.setText(r,i+u,a.name()),delete p.KNb))},ie.prototype.JNb=function(t){var e,o,n=this.Nz;for(e=t;e<n.length;e++)o=re(this.name(),n[e].name()),this.mNb.push(o)},ie.prototype.SZ=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p=this,d=p.Nz,g=p.kj;if(p.NZ&&d&&g)for(p.useFooterDropDownList()&&!p.uNb()&&p.sNb(),n=d.length,r=p.footerIndex(),i=p.dj,N(t)&&(t=0),N(e)&&(e=n),N(o)&&(o=p.nhc),s=ut(n,t+e),c=t;c<s;c++)(a=d[c])&&(u=g.getValue(r,i+c),N(u)||o?(p.KNb=o,C(g,r,i+c,a.footerValue()),delete p.KNb):(u!==(h=a.footerValue())&&g._modelManager.sVa(a,"footerValue",h),a.footerValue(u)),(l=g.Ima&&g.Ima(r,i+c))&&!o?(l!==(f=a.dataAreaFormula())&&g._modelManager.sVa(a,"dataAreaFormula",f),a.footerFormula(l)):p.S3||(p.KNb=o,S(g,r,i+c,st,a.footerFormula()),delete p.KNb))},ie.prototype.m$=function(t,e){var o,n,r,i,a,s,l=this.Nz;if(this.MZ&&l)for(o=l.length,N(t)&&(t=0),N(e)&&(e=o),r=ut(o,t+e),i=t;i<r;i++)(n=l[i])&&(a=n.name(),(s=this.kj)&&a!==st&&s._modelManager.sVa(n,"name",a),n.name(st),this.WZ(a,n.name(),i))},ie.prototype.n$=function(t){var e,o,n,r,i,a,s,l,u=this.dataRange();if(u.containsRange(t)){for(e=t.row,o=t.col,n=D(t),r=L(t),i=[],a=0;a<n;a++)for(s=0;s<r;s++)this.yq(e+a,o+s,st,!0),i.push({columnName:this.getColumnName(o+s-u.col),row:e+a-u.row,data:""});(l=this.ZX)&&l.onDataChanged(i)}},ie.prototype.o$=function(t,e){var o,n,r,i,a,s,l=this.Nz;if(this.NZ&&l)for(N(t)&&(t=0),N(e)&&(e=l.length),n=ut(l.length,t+e),r=t;r<n;r++)(o=l[r])&&(i=this.kj,a=o.footerFormula(),i&&st!==a&&i._modelManager.sVa(o,"footerFormula",a),o.footerFormula(st),s=o.footerValue(),i&&st!==s&&i._modelManager.sVa(o,"footerValue",s),o.footerValue(st))},ie.prototype.e$=function(){var t,e,o,n,r,i,a,s=this.Nz;if(this.NZ&&s&&(t=this.kj))for(e=s.length,n=this.dj,i=this.footerIndex(),a=0;a<e;a++)(o=s[a])&&(C(t,i,r=n+a,o.footerValue()),S(t,i,r,st,o.footerFormula()))},ie.prototype.QZ=function(t){var e,o,n,r,i=this.kj;if(i&&!(t<0||i.getRowCount()<=t))for(e=this.dj,o=this.OZ,r=0;r<o;r++)S(i,t,n=e+r,st),C(i,t,n,st)},ie.prototype.rI=function(t,e,o,n,r){var i,a,s,l=this,u=!1,c=o?1:0;return t>=l.cj+l.Xj+c||((i=l.kj)&&i._modelManager.pVa(l,Lt,{row:l.cj,col:l.dj,rowCount:l.Xj,colCount:l.OZ}),l.ohc(t,e,!1),a=l.cj,s=l.cj+l.Xj-1+c,t<=a&&!r?l.cj+=e:t<=s&&(n||(u=l.c$(t,e)),l.Xj+=e)),u},ie.prototype.KZ=function(t,e,o){var n,r,i,a=this,s=a.cj+a.Xj-1;!o&&t>=a.cj&&t<=s&&a.LNb(t,e),o||(a.Gj(t,e,!0,!0,!0),a.MNb()),n=a.ZX,r=a.dataRange().row,i=a.endRow(),r<=t&&t<=i&&n&&n.onRowsAdded(t-r,e),a.xr&&a.xr.rI(t,e)},ie.prototype.c$=function(t,e){var o,n,r,i=this.wq;return!!i&&(r=void 0,(n=(o=this.kj)&&o._modelManager.zTa)&&(r=(r=n.uVa)||[]),i.uL(G(this,t),e,r),!0)},ie.prototype.LNb=function(i,a){if(v){var s=this,l=s.kj,t=s.dataRange();N(i)&&(i=t.row),N(a)&&(a=t.rowCount),h(l),P(s.Nz,function(t,e){var o,n,r=e.dataAreaFormula();if(r)for(o=t+s.dj,n=i;n<i+a;n++)S(l,n,o,st,r)}),f(l,!1)}},ie.prototype.MNb=function(){if(v){var s,l,u=this,t=u.kj,c=t.Bj(),e=u.dataRange();N(s)&&(s=e.row),N(l)&&(l=e.rowCount),h(t),P(u.Nz,function(t,e){var o,n,r,i,a=e.NNb();if(a&&a.isArrayFormula)for(o=a.isDynamicArray,n=t+u.dj,r=s;r<s+l;r++)N(c.Qf(r,n))&&(i={row:r,col:n,rowCount:1,colCount:1,isDynamicArray:o},c.Xf(r,n,i))}),f(t,!1)}},ie.prototype.tI=function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g=this,m=o?1:0;if(!(t>=g.dj+g.OZ+m)){if(i=g.dj,(a=g.kj)&&(a._modelManager.pVa(g,Lt,{row:g.cj,col:g.dj,rowCount:g.Xj,colCount:g.OZ}),a._modelManager.pVa(g,Ht,g.Nz.slice())),t<=g.dj&&!r)g.dj+=e;else if(t<g.dj+g.OZ+m&&(g.OZ+=e,s=g.Nz)){for(l=t-g.dj,u=0;u<e;u++)c=g.TZ(),h=l+u,(f=new qt(c)).name(g.dga(st,h)),s.splice(h,0,f),p=g.getColumnName(h),g.xNb(h,0,p);n&&g.PZ(l,lt,!0)}g.xr&&g.xr.tI(t,e),i<=t&&(d=g.ZX)&&d.onColumnsAdded(t-i,e)}},ie.prototype.khc=function(){var t,o,n,r,i=this.kj.Bj();i&&this.NZ&&(t=this.Nz,o=this.footerIndex(),n=this.dj,t.forEach(function(t,e){r=i.Kf(o,n+e),N(r)||t.footerFormula(r)}))},ie.prototype.GR=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g=this,m=!1;return t>=g.cj+g.Xj||(i=(r=g.dataRange()).row,a=D(r),s=g.cj,l=g.cj+g.Xj-1,u=g.kj,c=g.wq,u&&((f=u._modelManager).pVa(g,Lt,{row:g.cj,col:g.dj,rowCount:g.Xj,colCount:g.OZ}),(h=f.zTa)&&(p=(p=h.uVa)||[])),g.ohc(t,e,!0),t<s?t+e<=s&&(g.cj-=e):t===s?g.MZ||(g.Xj-=ut(l-t+1,e),!o&&c&&(f&&f.ENb(g,t,e,n,Ut.deleted),c.wL(G(g,t),ut(l-t+1,e),p),m=!0)):t<=l&&(g.Xj-=ut(l-t+1,e),!o&&c&&(f&&f.ENb(g,t,e,n,Ut.deleted),c.wL(G(g,t),ut(l-t+1,e),p),m=!0),t===l&&g.NZ&&(u&&u._modelManager.pVa(g,"showFooter",g.NZ),g.NZ=!1)),g.xr&&g.xr.GR(t,e),i<=t&&t<i+a&&(d=g.ZX)&&d.onRowsRemoved(t-i,e)),m},ie.prototype.HR=function(t,e){var o,n,r,i,a,s=this,l=s.Nz;t>=s.dj+s.OZ||((o=s.kj)&&(o._modelManager.pVa(s,Lt,{row:s.cj,col:s.dj,rowCount:s.Xj,colCount:s.OZ}),o._modelManager.pVa(s,Ht,s.Nz.slice())),n=s.dj,r=s.dj,i=s.dj+s.OZ-1,t<r?t+e<=r?s.dj-=e:(s.dj=t,s.OZ-=t+e-r,l&&(l.splice(0,t+e-r),s.xNb(0,t+e-r))):(s.OZ-=ut(i-t+1,e),l&&(l.splice(t-r,ut(i-t+1,e)),s.xNb(t-r,ut(i-t+1,e)))),s.xr&&s.xr.HR(t,e),n<=t&&(a=s.ZX)&&a.onColumnsRemoved(t-n,e))},ie.prototype.$b=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m=this,y=o,b=n,v=m.kj;v&&(y=v.getRowCount(),b=v.getColumnCount()),r=t<0?0:t,i=e<0?0:e,a=t<0?y:o,s=e<0?b:n,l=q.kf(r,i,a,s),u=m.headerIndex(),m.MZ&&r<=u&&u<r+a&&(c=q.kf(u,m.dj,1,m.OZ),(h=l.getIntersect(c,y,b))&&m.m$(h.col-m.dj,L(h))),f=m.dataRange(),(p=l.getIntersect(f,y,b))&&m.n$(p),d=m.footerIndex(),m.NZ&&r<=d&&d<r+a&&(g=q.kf(d,m.dj,1,m.OZ),(h=l.getIntersect(g,y,b))&&m.o$(h.col-m.dj,L(h))),m.xr&&m.xr.$b(t,e,o,n)},ie.prototype.toJSON=function(t){var e,o,n,r,i,a,s,l,u,c=this,h=c.style(),f=c.rowFilter(),p="columns";for(N(t)?e=c.name():(e=t,c.KXc=e),o={name:[e,st],row:[c.cj,-1],col:[c.dj,-1],rowCount:[c.Xj,-1],colCount:[c.OZ,-1],showHeader:[c.MZ,!0],showFooter:[c.NZ,!1],useFooterDropDownList:[c.kNb,!1],showResizeHandle:[c.lNb,!1],highlightFirstColumn:[c.highlightFirstColumn(),!1],highlightLastColumn:[c.highlightLastColumn(),!1],bandRows:[c.bandRows(),!0],expandBoundRows:[c.expandBoundRows(),!1],bandColumns:[c.bandColumns(),!1],style:[h?h.toJSON():st,st],autoGenerateColumns:[c.autoGenerateColumns(),!0],bindingPath:[c.bindingPath(),lt],rowFilter:[f?f.toJSON():st,st],reservedElement:[c.ONb,st],allowAutoExpand:[c.qNb,!0],columns:[[]]},n=0;n<c.Nz.length;n++)i=(r=c.Nz[n].toJSON())[Tt],a=r[At],i&&(r[Tt]=T(c.kj,i,c.footerIndex(),n+c.dj)),a&&(r[At]=T(c.kj,a,c.dataRange().row,n+c.dj)),o[p][0][n]=r;for(l in o[p][1]=st,s={},o)(u=o[l])[0]!==u[1]&&(s[l]=u[0]);return d(s)?lt:s},ie.prototype.fromJSON=function(o,t){var n,e,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D;if(o){if(n=this,P([dt,mt,yt,bt,vt,Ct],function(t,e){F(o[e])&&n[e](o[e],!1)}),e=o.row,F(e)&&(n.cj=e),r=o.col,F(r)&&(n.dj=r),i=o.rowCount,F(i)&&(n.Xj=i),a=o.colCount,F(a)&&(n.OZ=a),s=o.showHeader,F(s)&&(n.MZ=s),l=o.showFooter,F(l)&&(n.NZ=l),u=o.expandBoundRows,F(u)&&(n.lhc=u),c=o.useFooterDropDownList,F(c)&&(n.kNb=c),h=o.showResizeHandle,F(h)&&(n.lNb=h),(f=o.style)&&((p=new O.TableTheme).fromJSON(f,t),n.style(p)),d=o.dataSource,g=o.dataBinding,m=o.bindingPath,t?(d&&_.qL&&(n.wq=new _.qL,n.wq.bind(d)),g&&_.qL&&(n.wq=new _.qL,n.wq.fromJSON(g))):m&&(n.UZ=m,b=(y=n.kj)&&y.getDataSource&&y.getDataSource(),_.CellBindingSource&&b instanceof _.CellBindingSource&&(v=_.LL(b.getSource(),m))&&(n.wq=new _.qL,n.wq.bind(v))),C=o.columns){for(x=(w=C).length,T=n.Nz=[],S=A=void 0,M=0;M<x;M++)S=w[M],(A=new qt(n.TZ())).fromJSON(S),I=A.name(),N=n.dga(I,M),T.push(A),N!==I&&n.setColumnName(M,N);n.Qdc()}n.kNb&&n.sNb(!0),(R=o.rowFilter)&&(k=j.MAb&&new j.MAb)&&(k.table(n),k.fromJSON(R,t),n.xr=k,n.xr.reFilter()),(E=o.reservedElement)&&(n.ONb=E),D=o.allowAutoExpand,F(D)&&(n.qNb=D)}},ie.prototype.formulaFromJSON=function(){var t,e,o,n,r,i,a=this.kj,s=a.Bj(),l=this.Nz,u=this.footerIndex(),c=this.dataRange().row,h=this.dj;for(o=0;o<l.length;o++)e=o+h,(n=(t=l[o]).footerFormula())&&"string"==typeof n&&t.footerFormula(M(a,n,u,e)),(r=t.dataAreaFormula())&&s&&(i=s.Qf(c,e),N(i)||t.NNb({isArrayFormula:!0,isDynamicArray:i.isDynamicArray})),r&&"string"==typeof r&&t.dataAreaFormula(M(a,r,c,e))},ie.prototype.Qdc=function(){var t,e,o=this.Nz,n=o.length;for(e=0;e<n;e++)(t=o[e]).id()<1&&t.id(this.TZ())},ie.prototype.startRow=function(){return this.cj},ie.prototype.startColumn=function(){return this.dj},ie.prototype.endRow=function(){return this.cj+this.Xj-1},ie.prototype.endColumn=function(){return this.dj+this.OZ-1},ie.prototype.hasHeadersRow=function(){return this.MZ},ie.prototype.hasTotalsRow=function(){return this.NZ},ie.prototype.tableName=function(){return this.name()},ie.prototype.getColumnIndexInTable=function(n){n=n.toLowerCase().replace(/\u00A0/g," ");var r=-1,i=o.Common.u.Gb(n,"\r\n","\n");return N(n)||P(this.Nz,function(t,e){var o=(""+e.name()).toLowerCase().replace(/\u00A0/g," ");if(o===n||o===i)return r=t,!1}),r},ie.prototype.source=function(){var t=this.kj;return t&&t.yj&&t.yj()},ie.prototype.JZ=function(){var t,e,o,n=this.kj;!n||(t=this.bindingPath())&&(e=n.getDataSource&&n.getDataSource(),_.CellBindingSource&&e instanceof _.CellBindingSource&&(o=_.LL(e.getSource(),t),this.zNb(o)))},ie.prototype.zNb=function(t){var e,o,n,r,i,a,s,l=this,u=l.kj;if(t){o=(e=l.dataRange()).row,n=D(e),(r=new _.qL).bind(t,u._modelManager.zTa),i=r.getRowCount();try{w(u),l.wq=st,n<i?l.lhc?u.addRows(o+n,i-n):((a=u.wq)&&a.aLb&&(a.bLb=!0),l.PNb=!0,0===n?l.Nia(o,i):l.Nia(o+n-1,i-n,!0),delete l.PNb):i<n&&(l.lhc?u.deleteRows(o+i,n-i):(l.PNb=!0,l.STa(o+i,n-i),delete l.PNb)),l._bind(r),(s=v&&u.Cf())&&!s.IsSuspended()&&u.recalcAll()}finally{x(u)}}},ie.prototype.clone=function(){var t=new ie,e=ft(this.toJSON());return t.Yv(this.tc),t.fromJSON(pt(e)),t},ie.prototype.p$=function(t){var e=new _.qL;e.bind(t),this.wq=e},ie.prototype.Az=function(t){if(t&&!t.bindingPath()){var e=t.wq;e&&this.p$(e.getSource())}},ie.prototype.LZ=function(){var t=this.wq;return t?t.getSource():st},ie.prototype.q$=function(){var t=this.wq;return t?t.getRowCount():0},ie.prototype.Eec=function(t,e){var o,n=this.Bec;e?n.push(t):-1!==(o=n.indexOf(t))&&n.splice(o,1)},ie.prototype.Cec=function(e){var o=this;o.Bec.forEach(function(t){t.Jec(o,e)}),2===e&&(o.Bec=[])},ie.prototype.wzb=function(t,e,o){var n;this.OAb||(((n=this.LAb)[o]||(n[o]={}))[[t,e].join(",")]=!0)},ie.prototype.NAb=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p=this.kj,d=p&&p.getCalcService&&p.getCalcService();if(this.OAb=!0,d)for(r in r=void 0,n=this.LAb)if(i=d.jh[r])for(l in a=i.dUa(),s=n[r])c=+(u=l.split(","))[0],h=+u[1],(f=i.Kf(c,h))?(this.QNb(c,h)||this.RNb(f,t,e,o,!1,c,h),i.fg(c,h,f,void 0,!1,a)):delete s[l];else delete n[r];delete this.OAb},ie.prototype.SNb=function(t,e,o){var n,r,i,a,s,l,u,c,h,f=this.kj,p=f&&f.getCalcService();if(this.OAb=!0,p)for(r in r=void 0,n=this.LAb)for(a in i=p.jh[r],n[r])l=+(s=a.split(","))[0],u=+s[1],(c=i.Kf(l,u))&&t===l&&e===u&&-1<(h=tt(c))&&(c.arguments[h]=o);delete this.OAb},ie.prototype.QNb=function(t,e){var o,n,r=this.footerIndex(),i=!1;return-1<r&&t===r&&(n=(o=this.dj)+this.OZ,i=o<=e&&e<n),i},ie.prototype.sort=function(t,e){var o=this.kj,n=this.dataRange(),r=this.rowFilter();o&&0<=t&&t<n.colCount&&(o.suspendPaint(),o.sortRange(n.row,n.col,n.rowCount,n.colCount,!0,[{index:t+n.col,ascending:e}]),r&&(r.zZ={index:t+n.col,ascending:e}),o.resumePaint())},ie.prototype.hJb=function(){return!!this.wq},ie.prototype.eMb=function(t,e,o,n,r){var i,a,s,l,u,c,h,f=this,p=f.kj,d=f.cj,g=f.dj,m=f.Xj,y=f.OZ,b=d+m-1,v=o?t+1:t,C=v+e,w=f.dataRange();K(p);try{f.eJb(!1),f.TNb(),f.rI(v,e,o,!1,!0),f.NAb(),i=q.CopyToOptions.value|q.CopyToOptions.formula|q.CopyToOptions.comment|q.CopyToOptions.outline|q.CopyToOptions.sparkline|q.CopyToOptions.span|q.CopyToOptions.style|q.CopyToOptions.tag|q.CopyToOptions.bindingPath|q.CopyToOptions.hyperlink,n&&!f.UNb&&(s=(a=1+b)+e,l=r-a+1,p.moveTo(a,g,s,g,l,y,i)),u=b-v+1,(!o||t!==b)&&0<u&&(p.dJb=!0,p.zFc=w,p.moveTo(v,g,C,g,u,y,i),delete p.zFc,delete p.dJb),c=p._modelManager,h=f.dataRange(),c._Ua&&c._Ua(v,e,[h],!0),c.CVa&&c.CVa(v,e,[h]),f.VNb(),f.KZ(v,e,!0),f.LNb(),f.HNb(v,e,!0),f.MNb(),f.tc.Nm()}finally{f.eJb(!0),Y(p),f.Cec(0),p.recalcAll(!0)}},ie.prototype.eJb=function(t){this.kj.eJb(t)},ie.prototype.insertRows=function(t,e,o){N(t)||N(e)||e<=0||(t=et(this,t,!0),this.Nia(t,e,o))},ie.prototype.Nia=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p;N(t)||N(e)||e<=0||(n=this.kj,i=(r=this.dataRange()).row,0===(a=r.rowCount)&&t===i||!(t<i||i+a<=t)||E(Wt().Exp_RowParamOutOfRange),s=this.cj,l=this.dj,u=this.Xj,h=l+this.OZ-1,p=(c=s+u-1)<(f=H(n,this)),V(n,this,1+c,f,l,h,e)||this.eMb(t,e,o,p,f))},ie.prototype.deleteRows=function(t,e){N(t)||N(e)||e<=0||(t=et(this,t,!0),this.STa(t,e))},ie.prototype.STa=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T;if(!(N(t)||N(e)||e<=0||(n=(o=this).kj,i=(r=o.dataRange()).row,a=r.rowCount,(t<i||i+a<=t)&&E(Wt().Exp_RowParamOutOfRange),s=o.cj,l=o.dj,h=s+(u=o.Xj)-1,f=l+(c=o.OZ)-1,(u<=1||t===i&&!o.MZ&&!o.NZ&&a<=e)&&E(Wt().Exp_TableDeleteCountInvalid),d=h<(p=H(n,o)),V(n,o,h+1,p,l,f,e,!0)))){K(n);try{o.eJb(!1),g=o.hJb(),m=void 0,g&&(m=J(!0),o.WNb(t,e,m)),o.TNb(),o.GR(t,e,lt,m),o.NAb(),y=ut(e,h-t+1),n.clear(t,l,y,c,3,383),b=q.CopyToOptions.value|q.CopyToOptions.formula|q.CopyToOptions.comment|q.CopyToOptions.outline|q.CopyToOptions.sparkline|q.CopyToOptions.span|q.CopyToOptions.style|q.CopyToOptions.tag|q.CopyToOptions.bindingPath|q.CopyToOptions.hyperlink,t+e<=h&&!g&&n.moveTo(t+e,l,t,l,h-e-t+1,c,b),d&&(C=(v=h+1)-y,w=p-v+1,n.moveTo(v,l,C,l,w,c,b)),x=n._modelManager,T=o.dataRange(),x.aVa&&x.aVa(t,e,[T],!0),o.VNb(),o.LNb(),o.HNb(t,e,!1),o.tc.Nm()}finally{o.eJb(!0),Y(n),o.Cec(0),n.recalcAll(!0)}}},ie.prototype.insertColumns=function(t,e,o){N(t)||N(e)||e<=0||(t=et(this,t,!1),this.hMb(t,e,o))},ie.prototype.hMb=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M;if(!(N(t)||N(e)||e<=0||(r=(n=this).kj,a=(i=n.dataRange()).row,s=i.col,l=i.rowCount,u=i.colCount,(t<s||s+u<=t)&&E(Wt().Exp_ColParamOutOfRange),c=n.cj,h=n.dj,p=c+(f=n.Xj)-1,m=(d=h+n.OZ-1)<(g=B(r,n)),V(r,n,c,p,d+1,g,e,!1,!0)))){b=(y=o?t+1:t)+e,K(r);try{n.eJb(!1),n.TNb(),v=!n.hJb(),w=(C=d+1)+e,x=g-C+1,T=q.CopyToOptions.value|q.CopyToOptions.formula|q.CopyToOptions.comment|q.CopyToOptions.outline|q.CopyToOptions.sparkline|q.CopyToOptions.span|q.CopyToOptions.style|q.CopyToOptions.tag|q.CopyToOptions.bindingPath|q.CopyToOptions.hyperlink,m&&r.moveTo(c,C,c,w,f,x,T),n.tI(y,e,o,v,!0),n.XNb(y,e,!0),n.NAb(y,e,!0),o&&t===d||!v||(r.dJb=!0,A=n.NZ?1:0,r.moveTo(a,y,a,b,l+A,d-y+1,T),delete r.dJb),S=r._modelManager,M=n.dataRange(),S.bVa&&S.bVa(y,e,[M],!0),S.EVa&&S.EVa(y,e,[M]),n.VNb(),n.LNb(),n.INb(y,e,!0),I.kDc(r,y,e,!0,!1),n.tc.Nm()}finally{n.eJb(!0),Y(r),n.Cec(0),r.recalcAll(!0)}}},ie.prototype.deleteColumns=function(t,e){N(t)||N(e)||e<=0||(t=et(this,t,!1),this.TTa(t,e))},ie.prototype.TTa=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x;if(!(N(t)||N(e)||e<=0||(n=(o=this).kj,i=(r=o.dataRange()).col,a=r.colCount,(t<i||i+a<=t)&&E(Wt().Exp_ColParamOutOfRange),s=o.cj,l=o.dj,h=s+(u=o.Xj)-1,f=l+(c=o.OZ)-1,p=o.NZ?1:0,(c<=1||t===l&&c<=e)&&E(Wt().Exp_TableDeleteCountInvalid),g=f<(d=B(n,o)),V(n,o,s,h,f+1,d,e,!0,!0)))){K(n);try{o.eJb(!1),o.TNb(),o.HR(t,e),o.XNb(t,e,!1),o.NAb(t,e,!1),m=ut(e,f-t+1),n.clear(s,t,u,m,3,383),y=q.CopyToOptions.value|q.CopyToOptions.formula|q.CopyToOptions.comment|q.CopyToOptions.outline|q.CopyToOptions.sparkline|q.CopyToOptions.span|q.CopyToOptions.style|q.CopyToOptions.tag|q.CopyToOptions.bindingPath|q.CopyToOptions.hyperlink,t+e<=f&&n.moveTo(s,t+e,s,t,u-p,f-e-t+1,y),g&&(v=(b=f+1)-m,C=d-b+1,n.moveTo(s,b,s,v,u,C,y)),w=n._modelManager,x=o.dataRange(),w.cVa&&w.cVa(t,e,[x],!0),o.VNb(!0),o.LNb(),o.INb(t,e,!1),I.kDc(n,t,e,!1,!1),o.tc.Nm()}finally{o.eJb(!0),Y(n),o.Cec(0),n.recalcAll(!0)}}},ie.prototype.TNb=function(){var t=this.kj,e=this.tc.l$;t&&t._modelManager.tVa([this]),e.splice(e.indexOf(this),1),this.ZZ()},ie.prototype.VNb=function(t){this.PNb=!0,this.nhc=t,this.tc.Cz(this),delete this.nhc,delete this.PNb},ie.prototype.XNb=function(t,e,o){var n,r,i,a=this.Nz,s=a.length,l=U(this,t);for(r=l;r<s;r++)i=void 0,o?l+e-1<r&&(i=r-e):l<=r&&(i=r+e),(n=a[r].footerFormula())&&this.RNb(n,t,e,o,!0,i)},ie.prototype.RNb=function(t,e,o,n,r,i,a){var s,l,u,c,h=this.kj;if(0<o&&t&&t.arguments)for(s=t.arguments,u=l=void 0,c=0;c<s.length;c++)(l=s[c])instanceof I.xzb&&(h&&(r?h._modelManager.YNb(this,l,i):h._modelManager.ZNb(this,l,i,a)),l.JUa(),u=l.offsetWhenInsertRemoveColumn(e,o,n,r),s[c]=u)},ie.prototype.ru=function(t){var e,o,n,r,i,a,s,l=this.wq,u=this.kj,c=this.MZ?1:0,h=this.cj+c+t,f=this.dj;if(!l||0===l.getRowCount())return st;if(e=this.OZ,o={},n=l.ru(t))for(r in n)p(n,r)&&"function"!=typeof r&&(o[r]=n[r]);for(i=0;i<e;i++)s=(a=this.Nz[i])&&a.dataField(),a&&s&&0<s.length&&N(o[s])&&(o[s]=u.getValue(h,f+i));return o},ie.prototype.WNb=function(t,e,o){var n,r,i,a,s=[],l=this.wq;if(l)for(r=l.getRowCount(),i=0;i<e;i++)a=st,(n=G(this,t+i))<r&&(a=this.ru(n)),s.push({key:o,data:a});this.Ts=s},ie.prototype.nKb=function(){var o=[],t=this.Ts;return t&&P(t,function(t,e){e&&!q.GC$.isFunction(e)&&o.push(e.data)}),o},ie.prototype.DNb=function(t,e,o){var n,r,i,a;0<this.kj.gga||(n=this.nNb,(r=this.wq)&&(i=st,e<r.getRowCount()&&(i=this.ru(e)),a={key:o,data:i},n[t]=a))},ie.prototype.ohc=function(t,e,o){var n,r,i;if(!(0<this.kj.gga))if(n=this.nNb,o)r=n.splice(t,e),this.mhc.push({rowIndex:t,count:e,deletedDirtyItems:r});else for(i=0;i<e;i++)n.splice(t,0,st)},ie.prototype.ihc=function(t,e){this.nNb.splice(t,e)},ie.prototype.phc=function(){var t,e,o=this.mhc.pop(),n=o.rowIndex,r=o.count,i=o.deletedDirtyItems;for(t=0;t<r;t++)e=i[t],this.nNb[n+t]=oe({},e)},ie.prototype.getDirtyRows=function(){var t,e,o,n=this.nNb,r=[];for(o=0;o<n.length;o++)t=n[o],N(t)||(e=G(this,o),r.push({row:e,originalItem:t.data,item:this.ru(e)}));return r},ie.prototype.clearPendingChanges=function(){this.nNb=[]},ie.prototype.footerRowDropDowns=function(t,e){var o,n,r,i,a=this.mNb[t];if(a){if(1===arguments.length)return a.dropDowns&&a.dropDowns.slice();if(o=a.dropDowns[0],e)return n=e.listOption,r=e.submitCommand,i=e.type,n&&(o.option=n),r&&(o.submitCommand=r),F(i)&&(o.type=i),this}},ie.prototype.checkTableLastRow=function(t){var e=this.dataRange();return this.headerIndex()===t||e.row+e.rowCount-1!==t},ie.prototype.checkTableLastCol=function(t){var e=this.dataRange();return e.col+e.colCount-1!==t},ie.prototype.PIb=function(t,e,o,n,r){var i,a,s,l=this.kj;c(l,this,o?Et:Nt,t,e,n,r),i=l._modelManager,a=o?Nt:Et,s=!o&&lt,i&&i.ZVa(["tableRowsChanged",this,a,t,e,s,o])},ie.prototype.QIb=function(t,e,o,n){var r,i,a,s=this.kj;Q(s,this,o?jt:Dt,t,e,n),r=s._modelManager,i=o?Dt:jt,a=!o&&lt,r&&r.ZVa(["tableColumnsChanged",this,i,t,e,a])},Jt=ie,j.Table=Jt,q.Zn(Jt),Jt.prototype.name=a(dt,"",ae(dt),l),Jt.prototype.bandRows=a(bt,!0,ae(bt)),Jt.prototype.bandColumns=a(vt,!1,ae(vt)),Jt.prototype.highlightFirstColumn=a(mt,!1,ae(mt)),Jt.prototype.highlightLastColumn=a(yt,!1,ae(yt)),Jt.prototype.style=a("style",lt,ae("style")),Jt.prototype.autoGenerateColumns=a(Ct,!0,ae(Ct)),n&&n.HideRowFilter&&(Zt=n.HideRowFilter,ee(ue,te=Zt),ue.prototype.oZ=function(){return 0},ue.prototype.pZ=function(){return this.range.colCount},ue.prototype.table=function(t){return 0===arguments.length?this.sj:void((this.sj=t)&&(this.kj=t.kj))},ue.prototype.unfilter=function(t,e){var o,n=this.kj;n&&n.suspendPaint(),te.prototype.unfilter.call(this,t,e),(o=this.sj)&&o.tc&&o.tc.Nm(),n&&n.resumePaint()},ue.prototype.rI=function(t,e){var o=this.sj;te.prototype.rI.call(this,t,e),o&&this.BZ(o.dataRange())},ue.prototype.GR=function(t,e){var o=this.sj;te.prototype.GR.call(this,t,e),o&&this.BZ(o.dataRange())},ue.prototype.no=function(){this.sj=st,this.kj=st},j.MAb=ue),le.prototype.k$=function(){return 0<this.id()},le.prototype.toJSON=function(){var n=this,r={};return P(It,function(t,e){var o=n[e]();N(o)||(e===gt&&o.toJSON&&"function"==typeof o.toJSON?r[e]=o.toJSON():r[e]=o)}),d(r)?lt:r},le.prototype.fromJSON=function(s){if(s){var l=this;P(It,function(t,e){var o,n,r,i,a=s[e]!==lt?s[e]:s["_"+e];N(a)||e===gt&&(o=a.typeName,(r=(n=q.CellTypes&&q.CellTypes._o)&&n[o]||n[a.type]||q.getTypeFromString(o))&&((i=new r).fromJSON(a,!1),a=i)),N(a)||l[e](a,!1)})}},qt=le,(j.TableColumn=qt).prototype.id=function(t){var e=a("id",lt,function(t){this.name()||this.name(xt+t)});return 0===arguments.length?e.call(this):N(t)?this:e.call(this,t)},qt.prototype.name=a(dt,lt,function(t){if(!t){this.name(xt+this.id())}}),qt.prototype.formatter=a("formatter"),qt.prototype.cellType=a(gt),qt.prototype.value=a("value"),qt.prototype.dataField=a("dataField"),qt.prototype.footerValue=a(St),qt.prototype.dataAreaFormula=a(At),qt.prototype.footerFormula=a(Tt),qt.prototype.ANb=a("dataAreaFormulaStr"),qt.prototype.NNb=a("isArrayFormula"),se.prototype.no=function(){var t,e,o=this.l$,n=o.length;for(e=0;e<n;e++)(t=o[e])&&t.no();this.l$=[],this.Nm(),this.kj=st},se.prototype.Nm=function(){var t,e,o;for(this.$m=[],this.an=[],e=(t=this.l$).length,o=0;o<e;o++)t[o].Nm()},se.prototype.hNb=function(t,e){var o,n,r=this.l$,i=r.length;for(n=0;n<i;n++)o=r[n],!e&&ne(o.oNb,t)?o.oNb=[]:N(o.oNb[t])||(o.oNb[t]=lt)},se.prototype.iNb=function(t){var e,o,n=this.l$,r=n.length;for(o=0;o<r;o++)ne((e=n[o]).pNb,t)?e.pNb=[]:N(e.pNb[t])||(e.pNb[t]=lt)},se.prototype.add=function(t,e,o,n,r,i,a){return this.LA(this.kj,t,e,o,n,r,!0),this.Cz(new Jt(t,e,o,n,r,i||O.TableThemes.medium2,a))},se.prototype.addFromDataSource=function(t,e,o,n,r,i){var a,s,l,u,c;if(n||E(Wt().Exp_TableDataSourceNullError),_.qL)return(a=this.kj).suspendPaint(),(s=new _.qL).bind(n),l=s.getRowCount()+1,u=s.getColumnCount(),(c=this.add(t,e,o,l,u,r,i))._bind(s),a.clearPendingChanges(),a.resumePaint(),c},se.prototype.find=function(t,e){var o,n,r,i=this.l$,a=i.length;for(n=0;n<a;n++)if((r=(o=i[n]).range()).row<=t&&t<r.row+D(r)&&r.col<=e&&e<r.col+L(r))return o;return st},se.prototype.findByName=function(t){var e,o,n=this.l$,r=n.length;for(o=0;o<r;o++)if((e=n[o]).name().toLowerCase()===t.toLowerCase())return e;return st},se.prototype.pJb=function(t,e,o,n){var r,i,a=this.l$,s=a.length,l=q.kf(t,o,e,n),u=[];for(i=0;i<s;i++)r=a[i],l.containsRange(r.range())&&u.push(r);return u},se.prototype.s$=function(t,e,o,n){var r,i,a=this.l$,s=a.length,l=[];for(i=0;i<s;i++)(r=a[i]).range().intersect(t,e,o,n)&&l.push(r);return l},se.prototype.KHb=function(){var t=this.kj,e=this.find(t.Jl,t.Kl);if(e)return t.cm(new q.Range(-1,e.dj,-1,e.OZ))},se.prototype.Cz=function(t,e){var o;if(t)return this.findByName(t.name())&&E(Wt().Exp_TableHasSameNameError),(o=this.kj).suspendPaint(),t.Yv(this),o._modelManager.tVa([]),this.l$.push(t),t.PNb||t.JZ(),t.showHeader()&&t.PZ(),!e&&t.showFooter()&&t.SZ(),this.t$(t),o.resumePaint(),t},se.prototype.vV=function(t){var e,o=m(t,this.l$);return-1<o?((e=this.kj)&&e._modelManager.tVa([t]),this.l$.splice(o,1),this.u$([t],!1),t):st},se.prototype.remove=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y;if(Z(t)&&(t=this.findByName(t)),t&&(e=e||0,t.RZ(),t=this.vV(t))){o=t.range(),n=this.kj;try{if(w(n),r=o.row,i=o.row+D(o),a=o.col,s=o.col+L(o),u=l=void 0,c=t.showHeader(),h=t.headerIndex(),1!=(1&e))for(l=r;l<i;l++)for(u=a;u<s;u++)S(n,l,u,st),C(n,l,u,st);else if(t.hJb()){if(c)for(l=h,u=a;u<s;u++)n.setValue(l,u,t.getColumnName(u-o.col));for(d=(p=(f=t.dataRange()).row)+D(f),m=g=void 0,l=p;l<d;l++)for(u=a;u<s;u++)(g=t.Nz[U(t,u)])&&(m=t.ru(G(t,l))[g.dataField()],N(m)||n.setValue(l,u,m))}else if(c)for(l=h,u=a;u<s;u++)n.setValue(l,u,t.getColumnName(u-o.col));if(2==(2&e))for(l=r;l<i;l++)for(u=a;u<s;u++)y=n.getStyle(l,u)||new q.Style,t.Yo(l,u,y),n.setStyle(l,u,y)}finally{x(n)}t.Cec(2)}return t},se.prototype.move=function(t,e,o){var n,r,i,a=this.kj;if(Z(t)&&(t=this.findByName(t)),t&&0<=e&&0<=o&&(n=t.range(),0===(i=(r=this.s$(e,o,D(n),L(n))).length)||1===i&&r[0]===t)){w(a);try{t.YZ(e,o)}finally{x(a)}}},se.prototype.resize=function(t,e){var o,n,r,i,a,s,l,u,c,h=this.kj;if(Z(t)&&(t=this.findByName(t)),t&&(o=t.range(),n=t.dataRange(),i=e,3===(r=arguments).length&&(i=q.kf(o.row,o.col,r[1],r[2])),i&&(a=D(i),s=L(i),0<=a&&0<=s&&this.s$(i.row,i.col,a,s).length<=1))){K(h);try{t.b$(i),t.hJb()||(l=h.conditionalFormats,u=h.uja,c=i.rowCount-o.rowCount,l&&l.XXc(o,n,c),u&&u.XXc(o,n,c))}finally{Y(h)}}},se.prototype.all=function(){var o=[];return P(this.l$,function(t,e){o.push(e)}),o},se.prototype.Xec=function(t){var e,o=t||this.l$,n=o.length;for(e=0;e<n;e++)o[e].clearPendingChanges()},se.prototype.Nec=function(t,e,o,n){var r,i,a=[],s=this.l$,l=s.length;for(r=0;r<l;r++)(i=s[r]).cj>=t&&i.dj>=e&&i.cj+i.Xj<=t+o&&i.dj+i.OZ<=e+n&&a.push(i);return a},se.prototype.Oec=function(t,e,o,n){var r=this.s$(t,e,o,n),i=this.Nec(t,e,o,n),a=[];return 0<i.length?r.forEach(function(t){-1===i.indexOf(t)&&a.push(t)}):a=r,a},se.prototype.Pec=function(t,e,o){var n,r,i=t.length;for(n=0;n<i;n++)if((r=t[n].range()).row<=e&&e<r.row+D(r)&&(o<0||r.col<=o&&o<r.col+L(r)))return!0;return!1},se.prototype.LA=function(t,e,o,n,r,i,a){var s,l,u,c;return e?g(e)?o<0||r<1||o+r>t.getRowCount()?(a&&E(Wt().Exp_TableInvalidRow),!1):n<0||i<1||n+i>t.getColumnCount()?(a&&E(Wt().Exp_TableInvalidColumn),!1):(s=t.tables).rn(o,n,r,i)?(a&&E(Wt().Exp_TableIntersectError),!1):s.findByName(e)?(a&&E(Wt().Exp_TableHasSameNameError),!1):(u=(l=v&&t.Ms(o,n,r,i))&&l.ranges,c=!0,u&&P(l,function(t,e){if(1<D(e)||1<L(e))return a&&E(Wt().Exp_ArrayFormulaTable),c=!1}),c):(a&&E(Wt().Exp_TableNameInvalid),!1):(a&&E(Wt().Exp_TableEmptyNameError),!1)},se.prototype.$Hb=function(t,e,o,n){var r,i,a=[],s=this.l$;for(r=0;r<s.length;r++)(i=s[r]).cj>=t&&i.dj>=e&&i.cj+i.Xj<=t+o&&i.dj+i.OZ<=e+n&&a.push(i.name());return a},se.prototype.HZ=function(t,e,o,n){var r,i,a,s,l=this.all();if(l)for(r=q.kf(t,e,o,n),i=l.length,a=void 0,s=0;s<i;s++)if(a=l[s].range(),r.intersect(a.row,a.col,D(a),L(a))&&!r.containsRange(a))return!0;return!1},se.prototype.rn=function(t,e,o,n){var r,i=this.l$,a=i.length;for(r=0;r<a;r++)if(i[r].range().intersect(t,e,o,n))return!0;return!1},se.prototype._getTable=function(t,e,o,n,r){var i,a,s,l=t.tables.all(),u=l.length,c=[];for(a=0;a<u;a++)(s=(i=l[a]).range()).row>=e&&s.col>=o&&s.row+s.rowCount<=e+n&&s.colCount+s.col<=o+r&&c.push({table:i,index:a});return c},se.prototype.zxb=function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p=o.tables.all(),d=p.length;if(!N(e)&&(a=n.row-e.row,s=n.col-e.col,0!==(l=this._getTable(t,e.row,e.col,e.rowCount,e.colCount)).length))for(u=0;u<d;u++)for(i=p[u],c=0;c<l.length;c++)if(h=l[c],(!r||u!==h.index)&&(f=h.table.range(),i.range().intersect(f.row+a,f.col+s,f.rowCount,f.colCount)))return o.Os(6,Wt().Exp_TableIntersectError),!0;return!1},se.prototype.KZ=function(t,e){var o,n,r=this.l$;for(o=0,n=r.length;o<n;o++)r[o].KZ(t,e)},se.prototype.rI=function(t,e){var o,n,r,i,a,s,l,u,c,h,f=this.l$,p=[];for(o=0,n=f.length;o<n;o++)i=(r=f[o]).LZ(),b(p,i)?r.rI(t,e,!0):r.rI(t,e)&&p.push(i);a=this.kj;try{for(w(a),l=s=void 0,o=0,n=f.length;o<n;o++)s=(r=f[o]).q$(),l=r.dataRange(),0<s&&s!==D(l)&&(u=s,r.showHeader()&&(u+=1),r.showFooter()&&(u+=1),c=r.range(),h=q.kf(c.row,c.col,u,L(l)),r.b$(h))}finally{x(a)}},se.prototype.tI=function(t,e){var o,n=this.l$,r=n.length;for(o=0;o<r;o++)n[o].tI(t,e)},se.prototype.khc=function(t){var e,o,n,r,i=this.l$,a=i.length;for(r=0;r<a;r++)o=(e=i[r]).dj,n=e.endColumn(),o<=t&&t<=n&&e.khc()},se.prototype.GR=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p=this.l$,d=[],g=[],m=[];for(o=0,n=p.length;o<n;o++)i=(r=p[o]).LZ(),t<=(a=r.range()).row&&a.row+D(a)<=t+e?m.push(r):(b(d,i)?r.GR(t,e,!0):(r.hJb()&&r.WNb(t,e,J(!0)),r.GR(t,e)&&d.push(i)),g.push(r));this.kj._modelManager.tVa(m),this.l$=g,this.u$(m,!0),s=this.kj;try{for(w(s),p=this.l$,u=l=void 0,o=0,n=p.length;o<n;o++)l=(r=p[o]).q$(),u=r.dataRange(),0<l&&l!==D(u)&&(c=l,r.showHeader()&&(c+=1),r.showFooter()&&(c+=1),h=r.range(),f=q.kf(h.row,h.col,c,L(u)),r.b$(f))}finally{x(s)}},se.prototype.HR=function(t,e){var o,n,r,i=this.l$,a=[],s=[],l=i.length;for(n=0;n<l;n++)t<=(r=(o=i[n]).range()).col&&r.col+L(r)<=t+e?s.push(o):(o.HR(t,e),a.push(o));this.kj._modelManager.tVa(s),this.l$=a,this.u$(s,!0)},se.prototype.$b=function(t,e,o,n,r){var i,a,s,l,u,c=q.kf(t,e,o,n),h=[],f=this.kj;if(1==(1&r)){for(l=[],a=(i=this.l$).length,u=0;u<a;u++)s=i[u],c.containsRange(s.range())?h.push(s):l.push(s);for(a=l.length,u=0;u<a;u++)(s=l[u]).$b(t,e,o,n);f&&f._modelManager.tVa(h),this.l$=l}if(2==(2&r))for(a=(i=this.l$).length,u=0;u<a;u++)s=i[u],c.containsRange(s.range())&&(f&&f._modelManager.pVa(s,"style",s.style()),s.style(st));return this.u$(h,!0),h},se.prototype.u$=function(t,e){if(t&&0!==t.length){var o=this.kj;q.GC$.each(t,function(t,e){e.Aq()&&e.getSlicerData().onTableRemoved(e),e.uNb()&&(o&&o._modelManager.pVa(e,Mt,e.wNb()),e.mNb=[])}),v&&(i=this.kj,r=t,a=e,s=i.parent,l=u(i),s?(n(s.getCustomNames(),r),P(s.sheets,function(t,e){n(e.getCustomNames(),r)})):n(i.getCustomNames(),r),l.onAfterRemoveTable(r,a))}function n(t,r){P(t,function(t,e){var o=e.getExpression(),n=I.CalcOperatorAdjustor.adjustExpressionOnRemoveTable(o,r,-1,-1,a);n!==o&&(e.fg(n),l.invalidName(i.yj(),e.getName()))})}var i,r,a,s,l},se.prototype.t$=function(t){t&&t.Aq()&&t.getSlicerData().onTableAdded(t)},se.prototype.v$=function(t){for(var e=1,o=t,n=this.MXc();!this.NXc(o,n);)o=t+e,e++;return o},se.prototype.MXc=function(){var t,e,o,n,r,i=[];for(t=0,e=this.kj.parent.sheets;t<e.length;t++)for(o=0,n=e[t].tables.all();o<n.length;o++)r=n[o],i.push(r);return i},se.prototype.NXc=function(t,e){var o,n;for(o=0,n=e;o<n.length;o++)if(n[o].name().toLowerCase()===t.toLowerCase())return!1;return!0},se.prototype.ge=function(t,e){var o=!1,n=st,r=this.find(t,e);return r&&(r.showHeader()&&t===r.headerIndex()?(n=r.g$(e),N(n)||(n=s(n)),o=!0):(o=(n=r.ge(t,e)).gt,n=n.Qb)),{gt:o,Qb:n}},se.prototype.yq=function(t,e,o){var n=!1,r=!0,i=this.find(t,e);return i&&!0!==i.KNb&&(i.showHeader()&&t===i.headerIndex()?i.VZ(o)?r=!1:(o=N(o)?o:s(o),i.h$(e,o)):i.showFooter()&&t===i.footerIndex()?i.j$(e,o):n=i.yq(t,e,o)),n||!r},se.prototype.Hma=function(t,e,o,n,r,i){var a=this.find(t,e);if(v&&a){if(1<o||1<n)return this.kj.Os(0,Wt().Exp_ArrayFormulaTable),!1;if(a.showHeader()&&t===a.headerIndex()&&r)return!1;!a.KNb&&a.showFooter()&&t===a.footerIndex()&&(N(r)||a.j$(e,st),a.i$(e-a.dj,r,i))}return!0},se.prototype.IZ=function(){var t,e,o,n=this.all();for(t=0,e=n.length;t<e;t++)(o=n[t]).bindingPath()&&(o.wq=st)},se.prototype.dB=function(t,e){var o,n,r,i=[];if(this&&(o=this.all()))for(r=o.length-1;0<=r;r--)n=o[r],t.containsRange(n.range())&&(e&&(this.kj&&this.kj._modelManager.tVa([n]),this.l$.splice(r,1),n.ZZ(lt,lt,e)),i.push(n));return i},se.prototype.eB=function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p=[];for(a=0,s=t.length;a<s;a++)l=t[a],c=u=void 0,i?c=l:(u=l.bindingPath()?lt:l.LZ(),(c=new Jt).Yv(this),c.fromJSON(pt(ft(l.toJSON()))),c.name(this.v$(c.name())),p.push(c)),h=c.range(),c.S3=!0,c.$Z(n+h.row-e,r+h.col-o),this.Cz(c,i),i?(f=c.ZX)&&(f.kj=this.kj,f.refresh()):u&&c.p$(u),c.S3=!1;for(a=0;a<p.length;a++)p[a].formulaFromJSON()},se.prototype.R3=function(t){for(var e=0,o=t.length;e<o;e++)t[e]._Z()},se.prototype.toJSON=function(t){var e,o=this.l$,n=[];if(o)for(e=0;e<o.length;e++)t?n.push(o[e].toJSON(this.v$(o[e].name()))):n.push(o[e].toJSON());return 0===n.length?lt:n},se.prototype.fromJSON=function(t,e){var o,n,r,i;if(t)for(this.l$=[],this.Nm(),o=0,n=t.length;o<n;o++)r=t[o],(i=new Jt).Yv(this),this.l$.push(i),i.fromJSON(r,e)},se.prototype.containTableHeaderTotalRowForSheet=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f=this.kj;if(f&&(t=f.getSelections(),r=n=o=void 0,(e=f.tables)&&t))for(i=e.l$,u=l=s=a=void 0,c=0;c<t.length;c++)for(r=(n=(o=t[c]).row)+o.rowCount-1,h=0;h<i.length;h++)if(s=(a=i[h]).range(),l=a.headerIndex(),u=a.footerIndex(),!o.containsRange(s)&&(n<=l&&l<=r||n<=u&&u<=r))return!0;return!1},se.prototype.containTableHeaderTotalRow=function(){var t,e,o,n,r,i,a,s,l=this.kj,u=!1;if(l&&(t=l.getSelections(),o=e=void 0,l.tables&&t)){if(1<t.length)return u;n=t[0],s=a=i=void 0,(r=rt(l,n))&&1===r.length&&(o=(e=n.row)+n.rowCount-1,a=(i=r[0]).headerIndex(),s=i.footerIndex(),(e<=a&&a<=o||e<=s&&s<=o)&&(u=!0))}return u},se.prototype.noRoomToInsertColumn=function(){var t,e,o,n,r,i,a,s,l=this.kj;return!!(l&&(t=l.getSelections(),(e=l.tables)&&t&&1===t.length&&(n=(o=t[0]).row,r=o.col,i=o.colCount,a=e.find(n,r),s=l.getColumnCount(3),a&&a.endColumn()+i>=s)))},se.prototype.noRoomToInsertRow=function(){var t,e,o,n,r,i,a,s,l=this.kj;return!!(l&&(t=l.getSelections(),(e=l.tables)&&t&&1===t.length&&(n=(o=t[0]).row,r=o.col,i=o.rowCount,a=e.find(n,r),s=l.getRowCount(3),a&&a.endRow()+i>=s)))},se.prototype.checkTableRow=function(){var t,e,o,n,r,i,a,s=this.kj;return!!(s&&(t=s.getSelections(),(e=s.tables)&&t&&1===t.length&&(n=(o=t[0]).row,r=o.col,a=(i=e.find(n,r))&&i.range(),i&&a&&!i.MZ&&!i.NZ&&1===a.rowCount)))},se.prototype.checkTableCol=function(){var t,e,o,n,r,i,a,s=this.kj;return!!(s&&(t=s.getSelections(),(e=s.tables)&&t&&1===t.length&&(n=(o=t[0]).row,r=o.col,(a=(i=e.find(n,r))&&i.range())&&1===a.colCount)))},se.prototype.isAcrossTables=function(){var t,e,o,n=this.kj,r=!1;if(n&&(t=n.getSelections(),n.tables&&t)){if(1<t.length)return r;e=t[0],(o=rt(n,e))&&(r=1<o.length)}return r},se.prototype.isWholeTableCol=function(){var t,e,o,n,r,i,a,s,l=this.kj,u=!1;return l&&(t=l.getSelections(),l.tables&&t&&(1<t.length?u=!0:(e=t[0],1===(o=rt(l,e)).length&&(r=(n=o[0]).dj,i=n.OZ,a=e.col,s=e.colCount,u=r===a&&i===s)))),u},se.prototype.containTableHeader=function(){var t,e,o,n,r,i,a=this.kj,s=!1;if(a&&(t=a.getSelections(),o=e=void 0,a.tables&&t)){if(1<t.length)return s;n=t[0],(r=rt(a,n))&&1===r.length&&(i=r[0].headerIndex(),o=(e=n.row)+n.rowCount-1,e<=i&&i<=o&&(s=!0))}return s},se.prototype.mKb=function(){var t,e,o,n,r,i,a,s,l=this.kj,u=!1;if(l&&(t=l.getSelections(),(e=l.tables)&&t)){if(o=l.getActiveRowIndex(),n=l.getActiveColumnIndex(),1<t.length||!e.find(o,n))return u;for(r=e.l$,i=t[0],a=void 0,s=0;s<r.length;s++)a=r[s],i&&i.intersect(a.cj,a.dj,a.Xj,a.OZ)&&(u=!0)}return u},se.prototype.PMb=function(t){var e,o,n,r,i=-1,a=this.l$;if(a)for(e=a.length,n=o=void 0,r=0;r<e;r++)o=a[r].range(),t&&!o.intersect(t.row,t.col,t.rowCount,t.colCount)||i<(n=o.row+o.rowCount-1)&&(i=n);return i},se.prototype.QMb=function(t){var e,o,n,r,i=-1,a=this.l$;if(a)for(e=a.length,n=o=void 0,r=0;r<e;r++)o=a[r].range(),t&&!o.intersect(t.row,t.col,t.rowCount,t.colCount)||i<(n=o.col+o.colCount-1)&&(i=n);return i},se.prototype.fIb=function(t,e,o,n){var r,i,a,s,l,u;if(!this.kj.options.isProtected&&0!==(r=this.all()).length)for(s=0;s<r.length;s++)(i=r[s]).qNb&&(a=i.range(),l=e&&e.equals(a),u=e&&0!==this.kj._modelManager.getSpans(e,3).length,e&&(l||u)||(i.UNb=n,this.$Nb(i,a,t,o),delete i.UNb))},se.prototype.$Nb=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T=this.kj,A=null,S=!1,M=e.row+e.rowCount-1,I=new q.Range(e.row,e.col,e.rowCount,e.colCount);if(t.showFooter()){if(r=new q.Range(e.row+e.rowCount-1,e.col,1,e.colCount),o.row===r.row&&o.col>=e.col&&o.col+o.colCount<=e.col+e.colCount)return;S=!0,I.rowCount--}if(i=o.row,a=o.col,s=o.row+o.rowCount-1,l=o.col+o.colCount-1,u=e.row+e.rowCount-1,c=e.col+e.colCount-1,h=lt,f=T.getRowCount(),p=I.contains(i-1,a)&&!I.contains(i,a),S||(p=p&&l<=c&&a>=e.col),d=I.contains(i,a-1)&&!I.contains(i,a)&&s<=M&&i>=e.row,I.contains(i,a)&&!I.contains(s,l)){if(g=ht(u,s)-e.row+1,m=ht(c,l)-e.col+1,c<l&&(y=z(T,new q.Range(e.row,1+c,e.rowCount,l-c)))&&l>y.col&&(m=e.colCount),A=new q.Range(e.row,e.col,g,m),S&&(A.rowCount++,s++),u<s&&(h=z(T,new q.Range(1+u,e.col,A.row+A.rowCount-1,e.colCount))),h&&0<(b=s-h.row+1)){if(z(T,new q.Range(f-Math.abs(b),e.col,Math.abs(b),e.colCount)))return void T.Os(6,Wt().Exp_TableAddRowNoEnoughRoom);T.moveTo(h.row,e.col,A.row+A.rowCount,e.col,f-A.row-A.rowCount,e.colCount,2047)}}else if(p&&!S){if(A=new q.Range(i,e.col,o.rowCount,e.colCount),(v=z(T,A,o))&&!o.containsRange(v))return}else if(d&&(A=new q.Range(e.row,a,e.rowCount,o.colCount),(v=z(T,A,o))&&!o.containsRange(v)))return;if(p&&!S&&$(n)&&(t.useFooterDropDownList(!0),x=t,(w=T).wu().execute({cmd:kt,sheetName:w.name(),tableName:x.name()})),A){if(e.containsRange(A))return;C=e.union(A),this._Nb(t,e,C)}},se.prototype._Nb=function(t,e,o){var n=this.kj,r=n.getParent();r&&r.commandManager().execute({cmd:"tableResize",sheetName:n.name(),tableName:t.name(),resizeToRange:o})},se.prototype.gJb=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m,y=this.kj,b=o.col,v=o.row,C=Gt.TABLE_SELECT,w=Gt.TABLE_CORNER_SELECT,x=Gt.TABLE_COL_SELECT,T=Gt.TABLE_ROW_SELECT,A=y.getActiveRowIndex(),S=y.getActiveColumnIndex();if(-1===o.rowViewportIndex&&(n=y.getCellRect(v,b,o.rowViewportIndex,o.colViewportIndex),(r=this.find(A,S))instanceof Jt&&r.showHeader()&&A>=r.cj&&A<r.cj+r.Xj&&S>=r.dj&&S<r.dj+r.OZ&&r.cj<y.lq&&r.cj+r.Xj>y.lq&&o.col<r.dj+r.OZ&&o.col>=r.dj))if(t>n.x+5&&t<n.x+n.width-18&&e<n.height-5){for(i=y.getSelections(),a=0;a<i.length;a++)if(!((s=i[a]).col===o.col&&1===s.colCount&&s.row===r.cj&&s.rowCount===r.Xj||s.col===o.col&&1===s.colCount&&-1===s.row&&s.rowCount===y.getRowCount()))return W(r,x)}else if(t>n.x+18)return W(r,"default");if(l=y.getCellRect(v,b),this.find(v,b)instanceof Jt&&-1!==o.colViewportIndex&&-1!==o.rowViewportIndex){if(u=!1,r=this.find(v,b),c=this.find(A,S),h=!0,1===(i=y.getSelections()).length&&(f=i[0]).row<=v&&f.row+f.rowCount>v&&f.col<=b&&f.col+f.colCount>b&&(h=!1),r===c&&(u=!0),b===r.dj&&v===r.cj){if(h&&u&&(t<=l.x+2||e<=l.y+2))return W(r,C);if(t>l.x+2&&t<l.x+18&&e>l.y+2&&e<l.y+6)return W(r,w);if(t>l.x+18&&e>l.y+2&&e<l.y+6)return W(r,x);if(t>l.x+2&&t<l.x+18&&e>l.y+6)return W(r,T)}if(b===r.dj+r.OZ-1&&v===r.cj){if(h&&u&&(t>=l.x+y.getColumnWidth(b)-2||e<=l.y+2))return W(r,C);if(t<l.x+y.getColumnWidth(b)-2&&e>l.y+2&&e<l.y+6)return W(r,x)}if(b===r.dj&&v===r.cj+r.Xj-1){if(h&&u&&(t<=l.x+2||e>=l.y+y.getRowHeight(v)-2))return W(r,C);if(t>l.x+2&&t<l.x+18&&e<l.y+y.getRowHeight(v)-2)return W(r,T)}if(h&&u&&b>r.dj&&b<r.dj+r.OZ&&v===r.cj&&e<=l.y+2)return W(r,C);if(b>r.dj&&b<r.dj+r.OZ&&v===r.cj&&e>l.y+2&&e<l.y+6)return W(r,x);if(h&&u&&v>r.cj&&v<r.cj+r.Xj&&b===r.dj&&t<=l.x+2)return W(r,C);if(v>r.cj&&v<r.cj+r.Xj&&b===r.dj&&t>l.x+2&&t<l.x+18)return W(r,T);if(p=y.getColumnWidth(r.dj+r.OZ-1),d=y.getRowHeight(r.cj+r.Xj-1),g=l.x+p,m=l.y+d,u&&(v>r.cj&&v<r.cj+r.Xj&&b===r.dj+r.OZ-1&&g-2<=t&&t<=g||b>r.dj&&b<r.dj+r.OZ&&v===r.cj+r.Xj-1&&m-2<=e&&e<=m)){if(b===r.dj+r.OZ-1&&v===r.cj+r.Xj-1&&m-10<=e&&g-10<=t)return st;if(h)return W(r,C)}}return st},se.prototype.bJb=function(t,e){var o,n,r,i,a=this.kj;if(this.find(t,e)instanceof Jt){for(n=0,(o=this.find(t,e)).NZ&&(n=1),r=0,o.MZ&&(r=1);0<t&&0===a.getRowHeight(t-1);)t--;if(1===r&&e===o.dj&&t===o.cj)return i=A(a,o,!0),R(i,o.dj+o.OZ-1,i);if(e===o.dj&&t===o.cj)return i=A(a,o,!0),R(i,o.dj+o.OZ-1,i);if(t>o.cj&&t<o.cj+o.Xj-n&&e===o.dj)return t===o.cj+r?(t=A(a,o,!0),R(t,o.dj+o.OZ-1,t)):R(t-1,o.dj+o.OZ-1,t-1)}return null},se.prototype.cJb=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A=this.kj;if(this.find(t,e)instanceof Jt){for(n=0,(o=this.find(t,e)).NZ&&(n=1),r=0,o.MZ&&(r=1),i=A.getRowCount()-1;t+1<A.getRowCount()&&0===A.getRowHeight(t+1);)t++;if(i!==t&&e===o.dj+o.OZ-1&&t<o.cj+o.Xj-n)return a=o.cj+o.Xj,l=(s=o.dj)+o.OZ-1,u=R(t+1,o.dj,t+1),t===a-n-1&&(o.qNb?(c=H(A,o),1===n&&V(A,o,a,c,s,l,1,!0,!1,!0)||(f=((h=z(A,new q.Range(a,s,c-a+1,l-s+1)))&&h.row)===a,a!==A.getRowCount()&&(f?(C=o,w=t,x=1,T=!0,(v=A).wu().execute({cmd:Nt,sheetName:v.name(),tableName:C.name(),row:w,count:x,isAfter:T})):(g=o,m=t,y=1,b=!0,(d=A).wu().execute({cmd:Rt,sheetName:d.name(),tableName:g.name(),row:m,count:y,isAfter:b}))))):u=R(t,1+l,t)),u;if(A.getRowCount()-1===t&&e===o.dj+o.OZ-1&&0===n){for(p=o.cj+r;p+1<A.getRowCount()&&0===A.getRowHeight(p);)p++;return p+1===A.getRowCount()&&0===A.getRowHeight(p)?R(o.cj,o.dj,o.cj):R(p,o.dj,p)}}return null},se.prototype.fg=function(){var t,e=this.l$,o=e.length;for(t=0;t<o;t++)e[t].e$()},se.prototype.Cec=function(t,e){var o,n,r,i,a,s,l=this.l$,u=l.length;for(o=0;o<u;o++)n=l[o],t?(r=n.cj,i=n.cj+n.Xj-1,r<=e&&e<=i&&n.Cec(0)):(a=n.dj,s=n.dj+n.OZ-1,a<=e&&e<=s&&n.Cec(0))},se.prototype.KFc=function(t,e,o,n,r){var i,a,s,l=this.s$(t,e,o,n),u=[];for(i=0,a=l.length;i<a;i++)s=l[i].dataRange(),r?s.rowCount+=o:s.colCount+=n,u.push(s);return u},Kt=se,j.TableManager=Kt,($t=j.TableRemoveOptions||(j.TableRemoveOptions={}))[$t.none=0]="none",$t[$t.keepData=1]="keepData",$t[$t.keepStyle=2]="keepStyle",q.GC$.extend(q.lUa.prototype,{CNb:function(t,e){var o=this.zTa;o&&(o.uVa||(o.uVa=[]),o.uVa.push({type:"changeTableManager",table:t,oldTableManager:e}))},pVa:function(t,e,o){var n=this.zTa;n&&(n.uVa||(n.uVa=[]),n.uVa.push({type:"property",table:t,name:e,value:o}))},tVa:function(t){var e,o,n=this.zTa;n&&(n.uVa||(n.uVa=[]),e=n.uVa,o=this.noa,e.push({type:_t,tableList:o.l$.slice(),changedTables:t}))},sVa:function(t,e,o){var n=this.zTa;n&&(n.uVa||(n.uVa=[]),n.uVa.push({type:Ot,tableColumn:t,name:e,value:o}))},vVa:function(t,e,o){var n=t.getValue(e,o).value,r=this.zTa;r&&(r.uVa||(r.uVa=[]),r.uVa.push({type:Ft,bindingManager:t,row:e,col:o,oldValue:n}))},ENb:function(t,e,o,n,r){var i=this.zTa;i&&(i.uVa||(i.uVa=[]),i.uVa.push({type:Pt,table:t,key:n,row:e,count:o,stateType:r}))},YNb:function(t,e,o){var n=this.zTa;n&&(n.aOb||(n.aOb=[]),n.aOb.push({type:Bt,table:t,expression:e,col:o}))},ZNb:function(t,e,o,n){var r=this.zTa;r&&(r.bOb||(r.bOb=[]),r.bOb.push({type:Vt,table:t,expression:e,row:o,col:n}))},wVa:function(t){var e,o,n,r,i,a,s,l;if(t)for(function(t){var e,o;if(t)for(e=t.length-1;0<=e;e--)(o=t[e]).bindingManager.sUa(o)}(t.rUa),e=t.length-1;0<=e;e--)switch(o=t[e],n=void 0,o.type){case _t:r=this.noa,i=o.changedTables,r.l$=o.tableList,i&&0<i.length&&i.forEach(function(t){t&&(t.e$(),t.JZ())});break;case Ot:o.tableColumn[o.name](o.value);break;case"property":n=o.table,a=o.name,s=o.value,a===Lt?(n.cj=s.row,n.dj=s.col,n.Xj=s.rowCount,n.OZ=s.colCount):a===Ht?n.Nz=s:a===Mt?n.mNb=s:n[a](s),n.Cec(0);break;case"changeTableManager":n=o.table,l=o.oldTableManager,n.BNb(l);break;case Ft:o.bindingManager.setValue(o.row,o.col,o.oldValue);break;case Pt:ce(o.table,o.row,o.count,o.key,o.stateType)}},cOb:function(t){var e,o,n,r,i,a,s;if(t){for(e=void 0,o=t.length-1;0<=o;o--)(n=t[o]).type===Bt&&(e=n.table,r=n.expression,i=n.col,a=void 0,(a=e.Nz[i].footerFormula())&&(-1<(s=tt(a))&&(a.arguments[s]=r)));e&&e.e$()}},dOb:function(t){var e,o,n,r,i;if(t)for(e=t.length-1;0<=e;e--)(o=t[e]).type===Vt&&(n=o.expression,r=o.row,i=o.col,o.table.SNb(r,i,n))}}),q.lUa.$n("table",{priority:7e3,init:function(){this.noa=new Kt(this.kj)},clearPendingChanges:function(t){var e=this.tables;e&&e.Xec(t.tableList)},undoAddRows:function(t){var e=this.kj,o=t.row,n=t.rowCount;e.tables.s$(o,-1,n,-1).forEach(function(t){t.WNb(o,n,J(!0))})},getValue:function(t){var e,o=t.row,n=t.col,r=t.sheetArea,i=this.kj.tables;3!==r||!i||i.find(o,n)&&(e=i.ge(o,n),t.isValueGet=e.gt,t.value=e.Qb)},setValue:function(t){var e,o=t.row,n=t.col,r=t.value,i=t.sheetArea,a=this.kj.tables;3!==i||!a||a.find(o,n)&&((e=t.changes)&&(e.uVa||(e.uVa=[])),t.isValueSet=a.yq(o,n,r))},undo:function(t){var e=t.uVa,o=t.aOb,n=t.bOb;e&&this.wVa(e),o&&this.cOb(o),n&&this.dOb(n),this.noa.Nm()}}),q.Workbook.$n("table",{init:function(){q.Commands.mMb(this.commandManager())},onCultureChanged:function(){Wt()}})},"./dist/plugins/table/table.ns.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("./dist/plugins/table/table.res.en.js");e.SR={en:n}},"./dist/plugins/table/table.res.en.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_DragDropShiftTableCell="This operation is not allowed. The operation is attempting to shift cells in a table on your worksheet.",e.Exp_DragDropChangePartOfTable="Cannot complete operation: You are attempting to change a portion of a table row or column in a way that is not allowed.",e.Exp_TableEmptyNameError="The table name cannot be empty.",e.Exp_TableNameInvalid="The table name is not valid.",e.Exp_TableInvalidRow="Invalid row index or row count.",e.Exp_TableInvalidColumn="Invalid column index or column count.",e.Exp_TableIntersectError="The tables cannot be intersected.",e.Exp_TableHasSameNameError="The current worksheet already exists in a table with the same name.",e.Exp_TableDataSourceNullError="Table datasource cannot be null.",e.Exp_TableMoveOutOfRange="The table cannot be moved out of the sheet.",e.Exp_TableResizeOutOfRange="The invalid row count, column count, and table cannot be resized out of the sheet.",e.Exp_ArrayFormulaTable="multi-cell array formulas are not allowed in tables.",e.Exp_TableResizeInvalidRange="The headers must remain in the same row, and the resulting table range must overlap the original table range.",e.Exp_TableResizeToSpan="Cannot complete operation: A table cannot overlap with a table or merged cells.",e.Exp_TableResizeWithFilter="Cannot shift cells in a filtered range or table.",e.Exp_TableResizeWithHidden="Cannot resize a table that's adjacent to a hidden row or column.",e.Exp_TableResizeToTable="Cannot complete operation: Operations that include cells both inside and outside a table range, and operation that affect cells that overlap multiple tables are not allowed.",e.Exp_RowParamOutOfRange="The param row out of data range of table.",e.Exp_ColParamOutOfRange="The param col out of data range of table.",e.Exp_TableDeleteCountInvalid="The param count to delete will cause empty table.",e.Exp_TableAddRowIntersectSpan="This won't work because it would move cells in a span on your worksheet.",e.Exp_TableAddRowIntersectTable="This won't work because it would move cells in a table on your worksheet.",e.Exp_TableAddRowNoEnoughRoom="Cannot insert new cells because it would push non-empty cells of the end of worksheet. These cells might appear empty but have blank values, some formatting, or a formula. Delete enough rows or columns to make room for what you want to insert and then try again.",e.Table_Total="Total",e.Table_None="None",e.Table_Average="Average",e.Table_Count="Count",e.Table_Count_Numbers="Count Numbers",e.Table_Max="Max",e.Table_Min="Min",e.Table_Sum="Sum",e.Table_StdDev="StdDev",e.Table_Var="Var"},"./dist/plugins/touch/touch.entry.js":function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),function(t){for(var e in t)o.hasOwnProperty(e)||(o[e]=t[e])}(e("./dist/plugins/touch/touch.js"))},"./dist/plugins/touch/touch.js":function(t,e,o){"use strict";var R,Tt,n,At,r,k,i,y,h,l,St,a,_,s,F,P,j,Mt,It,v,u,f,b,c,p,C,w,d,E,D,O,L,H,B,V,g,m,z,x,W,G,T,A,S,U,M,I,N,J,Z,q,K,Y,Q,X,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ht,ft,pt,dt,gt,mt,yt,bt,vt,Ct,wt,xt,Nt,Rt,kt,Et,Dt,jt,_t,Ot,Ft,Pt,Lt=this&&this.__extends||(Ft=function(t,e){return(Ft=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}Ft(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function Ht(t){return t.height}function Bt(t){return t.width}function Vt(t){clearInterval(t)}function zt(){return(new Date).valueOf()}function Wt(t,e){var o,n;return t&&e&&(0,0,o=t.X-e.X,n=t.Y-e.Y,j(o)<13&&j(n)<13&&c(o*o+n*n)<Mt(15,15))}function Gt(t){return t.getActiveSheet()}function Ut(t){return t.getSelections()}function Jt(t){return t.frozenTrailingColumnCount()}function Zt(t){return t.frozenTrailingRowCount()}function qt(t,e){return t.getColumnCount(e)}function Kt(t,e){return t.getRowCount(e)}function Yt(t){var e=k(t).offset(),o=G.body,n=0,r=0;return e&&(n=e.top+o.clientTop||0,r=e.left+o.clientLeft||0),{FB:n,EB:r}}function Qt(){this.rM=[],this.sM={length:0},this.tM=new J,this.uM=new Z}function Xt(t,e){var o=u(e.Y,e.X)-u(t.Y,t.X);return f<o?o-=2*f:o<-f&&(o+=2*f),o}function $t(t,e){return c((e.X-t.X)*(e.X-t.X)+(e.Y-t.Y)*(e.Y-t.Y))}function te(t){return j(t)<=2220446049250313e-31}function ee(){}function oe(){var t=this;t.AN=0,t.BN=0,t.CN=1,t.DN=0,t.EN=0,t._process=0,t.FN=511,t.GN=new et,t.HN=20,t.IN=new K}function ne(t){return new q(t?b(t.X):-1,t?b(t.Y):-1)}function re(){this.FP=[]}function ie(t,e){this.BP=t,this.CP=e,this.UO=0,this.VO=0,this.AP=0,this.DP=c(t*t+e*e)}function ae(t){this.zP=t,this.AP=0}function se(t){this.zP=t,this.AP=0}function le(t,e,o,n,r){t?this.qP=t:(this.xP=new q(e,o),this.yP=n,this.lO=r)}function ue(){this.Jb=0,this.oI=0,this.pP=10,this.qP=[]}function ce(t,e){var o=t*e;return 4<o?o=4:o<.5&&(o=.5),o}function he(t){this.kj=t}function fe(t,e){return z(-e/(t/e+1)+e+"")}function pe(t,e){return z(e*(-e/(t-e)-1)+"")}function de(t,e,o,n,r,i){t.fillStyle=e,t.fillRect(o,n,r,i)}function ge(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d=t.am(),g=t._render,m=t.options.sheetAreaOffset,y=m.left,b=m.top,v=g.zI(!1),C=g.bm(),w=g.vI(),x=t.jt(1),T=ye(t),A=d.$Lc,S=d.sKc,M=d._Lc,I=d.pKc,N=d.zr,R=1<=y?1:0,k=1<=b?1:0,E=Bt(d);C.save(),w.save(),r=t.Rt(-1),(i=x.findRow(r))&&(o=d.qt,0<(n=i.y-o-1-k)&&(e?(a=d.Br,de(C,s=(p=Tt.Im.Km(0,"gc-rowHeader-normal"))&&p.backgroundColor,N,o,a-1,n+1),de(w,s,N,o,a-1,n+1),de(C,v,N+a,o,E-a-T.width,n),de(w,v,N+a,o,E-a-T.width,n)):(de(C,v,N,o,E,n),de(w,v,N,o,E,n)))),U<I&&(de(C,v,N,M,E,n=I-U-k),de(w,v,N,M,E,n)),l=t.it(1),o=d.Ar,n=Ht(d),u=t.Ot(-1),(c=l.findCol(u))&&(N=d.pt,0<(E=c.x-N-1-R)&&(e?(de(C,f=function(t,e,o,n,r){var i,a,s,l,u,c=Tt.Im.Km(0,"gc-columnHeader-normal"),h=c&&c.backgroundImage,f=c&&c.backgroundColor;if(h&&-1!==h.indexOf("linear-gradient"))for(a=Tt.Ul.wl(h),i=t.createLinearGradient(e+n/2,o,e+n/2,o+r),s=0,l=a.length;s<l;s++)u=a[s],i.addColorStop(u.point,u.color);else f&&(i=f);return i}(C,N,o,E+1,(h=d.Cr)-1),N,o,E+1,h-1),de(w,f,N,o,E+1,h-1),de(C,v,N,o+h,E,n-h-T.height),de(w,v,N,o+h,E,n-h-T.height)):(de(C,v,N,o,E,n),de(w,v,N,o,E,n)))),U<S&&(de(C,v,A,o,E=S-U-R,n),de(w,v,A,o,E,n)),w.restore(),C.restore()}function me(t,e,o,n,r,i){t.beginPath(),t.strokeStyle=e,t.moveTo(o,n),t.lineTo(r,i),t.stroke()}function ye(t){var e=t.options.sheetAreaOffset;return t.Gt&&t.Gt()||{x:e.left,y:e.top,width:0,height:0}}function be(t,e){var o=0;return t||(o|=1),e||(o|=2),o}function ve(t){this.kj=t}function Ce(t,e,o,n,r){e===n&&o===r||(t._modelManager.setCellState(e,o,Tt.CellStatesType.active,!1,Tt.SheetArea.viewport),t.xIb&&t.xIb(Tt.CellStatesType.active,e,o,Tt.SheetArea.viewport),t._modelManager.setCellState(n,r,Tt.CellStatesType.active,!0,Tt.SheetArea.viewport),t.xIb&&t.xIb(Tt.CellStatesType.active,n,r,Tt.SheetArea.viewport))}function we(t,e){var o,n=Pt.call(this,e,Tt.Ul.vl(t._host))||this,r=n;return r.JQ=32,r.KQ=45,r.LQ={},r.MQ=!1,r.OC=t,o=r.yo(),(r.NQ=o).addClass("gc-toolstrip-default ui-state-default well"),o.appendTo(r.zo()),o.hide(),r.OQ(),r.PQ(),r.QQ(),n}function xe(t,e,o){this.BQ=o,this.yM=new kt(e),this.CQ=new pt(e),this.DQ=new Et(t,"sheet",this.yM,100,10),this.BQ.xN(this.DQ,!0)}function Te(t){this.KN=!1,this.hQ=new ht(t),this.iQ=new ft(t),this.kj=t}function Ae(t,e,o){var n,r;this.yM=new kt(this),this.DQ=new Et(t,"tabStrip",this.yM,1,-1),this.BQ=o,this.CQ=new jt(e),n=this.CQ,(r=this.DQ).eN=function(t){return n.lQ(t)},r.fN=function(t){return n.pQ(t)},r.hN=function(t){return n.qQ(t)},r.iN=function(t){return n.sQ(t)},r.jN=function(t){return n.yQ(t)}}function Se(t){this.YJc=t}function Me(){}function Ie(t){this.tc=t}function Ne(t){this.Cj=function(){for(var t=0,e="separator"+t;G.getElementById(e);)e="separator"+ ++t;return e}(),t&&(this.RQ=t)}function Re(t,e,o,n,r){this._font="normal 12px Arial";this.Cj=t,this._text=e,this.fR=o,n&&(this.VQ=n),r&&(this.RQ=r)}function ke(t,e,o,n){var r=t.vu();r.ko(e)?o.drawImage(r.lo(e),n.x,n.y,Bt(n),Ht(n)):r.fo(e)}function Ee(t){var e,o,n=F,r=Ut(t),i=r.length;return t.CH&&0<i&&(e=r[i-1],o=t.cm(e),n=new Tt.Rect(o.x+Bt(o)-17,o.y+Ht(o),17,20)),n}function De(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y=t.Er(e),b=t.Fr(o),v=t.am().Ft(y,b),C=(s=e,l=o,u=(a=t).Er(s),c=a.Fr(l),h=a.jt(u),f=a.it(c),(m=g=d=p=0)<h.length&&(p=h[0].row,d=h[h.length-1].row),0<f.length&&(g=f[0].col,m=f[f.length-1].col),Tt.kf(p,g,d-p+1,m-g+1)),w=C.row<=e&&e<=C.row+C.rowCount-1&&v.y<=r&&r<=v.y+Ht(v),x=C.col<=o&&o<=C.col+C.colCount-1&&v.x<=n&&n<=v.x+Bt(v);return i&&i.colCheck?x:(i&&i.rowCheck||x)&&w}function je(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x=Ut(t),T=[];if(t.CH&&0<x.length)for(e=x[x.length-1],o=t.cm(e),n=t.am(),r=e.row,i=e.row+e.rowCount-1,a=e.col,s=e.col+e.colCount-1,-1!==e.row&&-1!==e.col?(De(t,r,a,o.x,o.y)&&(T[0]=new Tt.Rect(o.x-8,o.y-8,16,16)),De(t,i,s,o.x+Bt(o),o.y+Ht(o))&&(T[1]=new Tt.Rect(o.x+Bt(o)-8,o.y+Ht(o)-8,16,16))):-1!==e.row?(l=n.Ft(1,0),u=n.Ft(1,1),c=l.x+(Bt(l)+Bt(u))/2-8,h=qt(t)-1-Jt(t),(p=(f=t.it(1)).findCol(h))&&((d=t.it(0)[0]||f[0])&&(c=d.x+(p.x+Bt(p)-d.x)/2-8)),De(t,r,a,c+8,o.y,{rowCheck:!0})&&(T[0]=new Tt.Rect(c,o.y-8,16,16)),De(t,i,s,c+8,o.y+Ht(o),{rowCheck:!0})&&(T[1]=new Tt.Rect(c,o.y+Ht(o)-8,16,16))):-1!==e.col&&(l=n.Ft(0,1),u=n.Ft(1,1),g=l.y+(Ht(l)+Ht(u))/2-8,m=Kt(t)-1-Zt(t),(b=(y=t.jt(1)).findRow(m))&&((v=t.jt(0)[0]||y[0])&&(g=v.y+(b.y+Ht(b)-v.y)/2-8)),De(t,r,a,o.x,g+8,{colCheck:!0})&&(T[0]=new Tt.Rect(o.x-8,g,16,16)),De(t,i,s,o.x+Bt(o),g+8,{colCheck:!0})&&(T[1]=new Tt.Rect(o.x+Bt(o)-8,g,16,16))),C=void 0,w=T.length-1;0<=w;w--)(!(C=T[w])||C.x<0||C.y<0)&&(T[w]=F);return T}Object.defineProperty(e,"__esModule",{value:!0}),R=o("@grapecity/js-sheets-common"),Tt=o("Core"),n=o("./dist/plugins/touch/touch.res.en.js"),e.SR={en:n},At=R.Common.j.Fa,r=Tt.Go,(k=Tt.GC$).extend,i=k.isEmptyObject,y=Tt.Ul.Nl,h=Tt.Ul.nl,l=Tt.Ul.Ml.mozilla,St=Tt.Im.Lm,a=Tt.Ul.rl(),_=a.ipad,s=_||a.iphone,F=null,P=void 0,j=Math.abs,Mt=Math.min,It=Math.max,v=Math.pow,u=Math.atan2,f=Math.PI,b=Math.round,c=Math.sqrt,p=Math.atan,C=Math.log,w=Math.floor,d="touch",E="none",D="MSPointerDown",O="MSPointerMove",L="MSPointerUp",H="pointerdown",B="pointermove",V="touchstart",g="MSPOINTER_TYPE_TOUCH",m=isNaN,z=parseInt,x=parseFloat,W=window,G=document,T=W.Yl,A="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB",S="AAAAAElFTkSuQmCC",U=1,Tt.Rxb.touch=!0,M=new R.Common.ResourceManager(e.SR,"Touch"),I=M.getResource.bind(M),Qt.prototype.vM=function(t){this.tM.vM=t},Qt.prototype.wM=function(t){this.tM.wM=t},Qt.prototype.xM=function(o){var n=this;n.tM.xM=function(t){if(o){o(t);var e=n.yM;e&&e.zM()}}},Qt.prototype.AM=function(t){this.tM.AM=t},Qt.prototype.BM=function(t){this.tM.BM=t},Qt.prototype.CM=function(t){this.uM.CM=t},Qt.prototype.DM=function(t){this.uM.DM=t},Qt.prototype.EM=function(t){this.uM.EM=t},Qt.prototype.FM=function(t){this.GM=t},Qt.prototype.HM=function(t){this.IM=t},Qt.prototype.JM=function(t,e){var o=e?e.KM:this.LM.KM;return Tt.Ul.Z3(t,o)},Qt.prototype.MM=function(t,e){var o,n,r,i,a,s=e.pointerType,l=e.target,u=e.offsetX,c=e.offsetY;s!==e[g]&&s!==d||(n=(o=this.JM(l,t)).EB,r=o.FB,this.NM(t,l,e.pointerId,new q(u+n,c+r),e.timeStamp)&&h(e),"sheet"===this.LM.OM&&(i=e.pageX-(u+n),a=e.pageY-(c+r),this.LM.KM.canvasOffset={top:a,left:i}))},Qt.prototype.PM=function(t){var e,o=t.pointerType,n=t.pointerId;if(o===t[g]||o===d){if(this.sM[n]===P)return!1;e=this.JM(t.target),this.aB(n,new q(t.offsetX+e.EB,t.offsetY+e.FB),t.timeStamp)&&h(t)}},Qt.prototype.QM=function(t){var e,o=t.pointerType,n=t.pointerId;if(o===t[g]||o===d){if(this.sM[n]===P)return!1;e=this.JM(t.target),this.RM(n,new q(t.offsetX+e.EB,t.offsetY+e.FB))&&h(t)}},Qt.prototype.SM=function(t){var e,o=t.pointerType,n=t.pointerId;if(o===t[g]||o===d){if(this.sM[n]===P)return!1;e=this.JM(t.target),this.TM(n,new q(t.offsetX+e.EB,t.offsetY+e.FB))&&h(t)}},Qt.prototype.UM=function(t,e){var o,n,r,i=Yt(t.KM),a=e.changedTouches,s=!1;for(o=0;o<a.length;o++)n=a[o],r=l?zt():e.timeStamp,s=this.NM(t,e.target,n.identifier,new q(n.pageX-i.EB,n.pageY-i.FB),r)||s;s&&h(e)},Qt.prototype.VM=function(t){var e,o,n,r=Yt(this.LM.KM),i=t.changedTouches,a=!1;for(e=0;e<i.length;e++)o=i[e],n=l?zt():t.timeStamp,a=this.aB(o.identifier,new q(o.pageX-r.EB,o.pageY-r.FB),n)||a;a&&h(t)},Qt.prototype.WM=function(t){var e,o,n=Yt(this.LM.KM),r=t.changedTouches,i=!1;for(e=0;e<r.length;e++)o=r[e],i=this.RM(o.identifier,new q(o.pageX-n.EB,o.pageY-n.FB))||i;i&&h(t)},Qt.prototype.XM=function(t){var e,o,n=Yt(this.LM.KM),r=t.changedTouches,i=!1;for(e=0;e<r.length;e++)o=r[e],i=this.TM(o.identifier,new q(o.pageX-n.EB,o.pageY-n.FB))||i;i&&h(t)},Qt.prototype.YM=function(t){var e,o,n=this.LM,r=this.ZM;n!==r&&(e=k(n.KM).offset(),o=k(r.KM).offset(),t.X+=e.left-o.left,t.Y+=e.top-o.top)},Qt.prototype.$M=function(t,e){var o,n,r,i,a,s=this,l=s.rM;for(s.ZM=F,s.yM=F,n=0;n<l.length;n++)if(l[n]===t){if(r=l[n],a=i=F,r._M&&!r._M()){for(n=0;n<l.length;n++)if((o=l[n])!==r&&0<=o.aN&&o.aN<r.aN&&(!o._M||o._M())){i=o;break}if(i===F)return!1}if(r.bN&&!r.bN()){for(n=0;n<l.length;n++)if((o=l[n])!==r&&0<=o.aN&&o.aN<r.aN&&(!o.bN||o.bN())){a=o;break}if(a===F)return!1}i===F&&(i=r),a===F&&(a=r),s.LM=r,s.ZM=i,s.cN=a,s.vM(a.dN||F),s.wM(i.eN||F),s.BM(i.fN||F),s.AM(i.gN||F),s.xM(i.hN||F),s.CM(a.iN||F),s.DM(a.jN||F),s.EM(a.kN||F),s.FM(i.GM||F),s.HM(i.IM||F),i.lN&&(s.yM=r.lN);break}return!0},Qt.prototype.NM=function(t,e,o,n,r){var i=this;return!(i.sM[o]!==P||0===i.sM.length&&!i.$M(t,e)||!i.ZM||!(i.sM.length>=i.ZM.mN)&&(i.yM&&i.yM.nN()||(i.YM(n),i.yM&&0===i.sM.length&&i.yM.oN(),i.sM[o]={id:o,time:zt(),position:n},i.sM.length++,i.tM.pN(e,o,n,r),i.tM.qN(o,n,i.sM.length,r),1===i.sM.length&&i.uM.qN(n),1===i.sM.length&&i.GM&&i.GM({rN:n}),0)))},Qt.prototype.aB=function(t,e,o){return!(this.sM[t]===P||this.yM&&this.yM.sN()||(this.YM(e),this.sM[t]={id:t,time:zt(),position:e},this.tM.tN(t,e,o),0))},Qt.prototype.RM=function(t,e){var o=this;return o.sM[t]!==P&&(delete o.sM[t],o.sM.length--,!(o.yM&&o.yM.uN()||(o.YM(e),o.tM.vN(t),o.tM.wN(),0===o.sM.length&&(o.uM.vN(e),o.uM.wN()),0===o.sM.length&&o.IM&&o.IM({rN:e}),o.yM&&0===o.sM.length&&0===o.tM._process&&o.yM.zM(),0)))},Qt.prototype.TM=function(t,e){return this.RM(t,e)},Qt.prototype.xN=function(e,t){var o,n,r,i,a,s=this,l="."+e.OM,u=".gcSheet",c=D+u,h=O+u+l,f=L+u+l,p="MSPointerCancel"+u+l,d="MSLostPointerCapture"+u+l,g=H+u,m=B+u+l,y="pointerup"+u+l,b="LostPointerCapture"+u+l,v="pointercancel"+u+l,C=V+u,w="touchmove"+u,x="touchend"+u,T="touchcancel"+u;function A(){k(G).unbind(h).unbind(m).unbind(f).unbind(y).unbind(p).unbind(v).unbind(d).unbind(b)}function S(t){k(G).bind(h,M).bind(f,I).bind(m,M).bind(y,I).bind(p,N).bind(d,N).bind(b,N).bind(v,N),s.MM(e,t)}function M(t){s.PM(t)}function I(t){s.QM(t),0===s.sM.length&&A()}function N(t){s.SM(t),0===s.sM.length&&A()}o=e.KM,n=s.rM,0<=(r=R.Common.k.Cb(n,e))&&t||r<0&&!t||(i=Tt.Ul._Va(),t?i?(a=o.style,At(a.msTouchAction)||(a.msTouchAction=E),At(a.touchAction)||(a.touchAction=E),k(o).bind(c,S).bind(g,S)):(k(o).bind(C,function(t){s.UM(e,t)}),k(o).bind(w,function(t){s.VM(t)}).bind(x,function(t){s.WM(t)}).bind(T,function(t){s.XM(t)})):i?k(o).unbind(c).unbind(g):k(o).unbind(C).unbind(w).unbind(x).unbind(T),t?n.push(e):n.splice(r,1))},Qt.prototype.no=function(){var t,e=this.rM;for(t=e.length-1;0<=t;t--)this.xN(e[t],!1)},N=Qt,e.TouchEventProvider=N,oe.prototype.pN=function(t,e,o,n){var r,i=this;3===i._process&&i.JN(!0),i.KN=2===i._process&&1===i.GN.MN(),i.NN=t,(r={}).Np=e,r.ON=o,r.PN=o,i.GN.QN(r),i.RN=n,1<i.GN.MN()&&(i.SN=!1,i.TN=!1,1===i._process&&i.UN())},oe.prototype.qN=function(t,e,o,n){0===this._process&&1===o&&this.VN(this.GN.WN(0).PN)},oe.prototype.tN=function(t,e,o){var n,r,i,a,s,l,u,c=this;if(0!==c.FN&&c.GN.XN(t)){if(1===c._process&&1===c.GN.MN()){if(n=c.YN(),!c.ZN(1)&&!c.ZN(2)&&!n)return;if(Wt(e,r=c.GN.$N(t).PN))return;i=j(e.X-r.X),a=j(e.Y-r.Y),c._N(i,a)}if(!(o-c.RN<20)){if(c.GN.$N(t).aO=e,1<(s=c.GN.MN()))for(l=0;l<s;l++)if(!(u=c.GN.WN(l)).aO)return;for(c.bO(o),c.RN=o,s=c.GN.MN(),l=0;l<s;l++)(u=c.GN.WN(l)).ON=u.aO,u.aO=F}}},oe.prototype.wN=function(){this.cO&&(this.dO(this.cO),this.cO=F)},oe.prototype.vN=function(t){var e=this;e.GN.XN(t)&&(e.GN.eO(t),2===e._process?0===e.GN.MN()&&(e.ZN(64)||e.ZN(256)||e.ZN(128)?e.fO():e.JN(!0)):3===e._process?e.JN(!0):1===e._process&&e.JN(!1))},oe.prototype.bO=function(t){var e,o,n,r,i=this,a=i.gO(),s=a.hO,l=a.iO,u=a._position,c=i.jO(),h=c.kO,f=c.eb,p=c.lO;if(i.AN+=s,i.BN+=l,i.CN*=f,i.DN+=h,i.EN+=p,(e={}).lO=p,e.kO=h,e.mO=t-i.RN,e.hO=s,e.iO=l,i.IN.nO(e),i.oO=u,1===i._process||2===i._process){if(1===i._process&&i.UN())return;if((o=new tt).pO=p,o.qO=h,o.rO=f,o.sO=new q(s,l),n=new Y(i.IN),r=new rt(i.NN,i.tO(),o,!1,u,n),i.uO(r),r.vO)return void i.JN(!0)}},oe.prototype.UN=function(){var t;return this._process=2,t=new at(this.NN,this.GN.MN(),this.tO(),this.GN.WN(0).PN),this.wO(t),!!t.vO&&(this.JN(!0),!0)},oe.prototype._N=function(t,e){var o,n,r,i,a,s=(n=e,a=i=!1,0===(o=t)||(r=p(n/o)/f*180)<20&&(i=!0),(0===o||75<(r=p(n/o)/f*180)&&r<105)&&(a=!0),{yN:i,zN:a});this.SN=s.yN,this.TN=s.zN},oe.prototype.gO=function(){var t=this.xO(),e=t.yO,o=t.zO,n=new q(e.X,e.Y);return{hO:e.X-o.X,iO:e.Y-o.Y,_position:n}},oe.prototype.jO=function(){var t,e,o,n,r,i,a,s,l,u=0,c=1,h=0;return this.ZN(16)&&1===this.GN.MN()&&this.YN()&&(e=this.GN.WN(0).aO,o=this.GN.WN(0).ON,n=this.AO,r=new q(n._Center.X,n._Center.Y),i=new q(o.X-r.X,o.Y-r.Y),a=new q(e.X-r.X,e.Y-r.Y),s=Mt(1,v($t(o,r)/n._Radius,4)),l=Xt(i,a),u=m(l)?0:l*s),1<this.GN.MN()&&(u=(t=this.BO()).kO,c=t.eb,h=t.lO),{kO:u=u/f*180,eb:c,lO:h}},oe.prototype.BO=function(){var t,e,o,n,r,i,a,s,l,u,c=this,h=c.xO(),f=h.yO,p=h.zO,d=c.YN(),g=d?c.AO._Center:new q(0,0),m=0,y=1,b=0,v=0,C=0,w=0,x=0,T=c.GN.MN();for(t=0;t<T;t++)o=(e=c.GN.WN(t)).aO,n=e.ON,r=$t(o,f),i=$t(n,p),a=d?new q(n.X-g.X,n.Y-g.Y):new q(n.X-p.X,n.Y-p.Y),s=d?new q(o.X-g.X,o.Y-g.Y):new q(o.X-f.X,o.Y-f.Y),l=$t(n,g),u=$t(o,g),i>=c.HN&&r>=c.HN&&(C++,w+=r,x+=i,(!d||l>=c.HN)&&u>=c.HN&&(m+=Xt(a,s),v++));return 0<v&&c.ZN(16)?m/=v:m=0,0<C&&c.ZN(32)?(c.KN||(y=w/x),b=(w-x)/C,c.CO=w/C):c.CO=0,{kO:m,eb:y,lO:b}},oe.prototype.ZN=function(t){return 0!=(this.FN&t)},oe.prototype.xO=function(){var t,e,o,n,r,i=0,a=0,s=0,l=0,u=this.GN,c=u.MN();for(t=0;t<c;t++)o=(e=u.WN(t)).ON,n=e.aO,i+=o.X,a+=o.Y,s+=n.X,l+=n.Y;return r=new q(i/c,a/c),{yO:new q(s/c,l/c),zO:r}},oe.prototype.YN=function(){var t=this.AO;return t&&!m(t._Radius)},oe.prototype.VN=function(t){var e=new st(this.NN,this.FN,F,t);return e.DO=511,this.EO(e),this.FO=e.DO,0===e.DO?(this.JN(!1),!1):(this.FN=e.DO,this.AO=e.GO,this._process=1,!0)},oe.prototype.JN=function(t){var e,o=this,n=3===o._process;o._process=0,o.HO&&(Vt(o.HO),o.HO=F),t&&(e=new nt(o.NN,o.tO(),n,ne(o.oO),new Y(o.IN)),3===o._process?o.cO=e:o.dO(e)),o.IN.IO(),o.GN.IO(),o.AO=F,o.AN=0,o.BN=0,o.CN=1,o.DN=0,o.EN=0,o.SN=!1,o.TN=!1,o.FN=0},oe.prototype.fO=function(){var t,e,o=this,n={},r=new Y(o.IN);return n.JO=o.ZN(64)?r.KO().X:0,n.LO=o.ZN(64)?r.KO().Y:0,n.MO=o.ZN(256)?r.pO():0,n.NO=o.ZN(128)?r.OO():0,0===n.JO&&0===n.LO&&0===n.MO&&0===n.NO?void o.JN(!0):(n.PO=new $(n.JO,n.LO),n.QO=new Q(n.MO),n.RO=new X(n.NO),r=new Y(F,n.JO,n.LO,n.NO,n.MO),t=new it(o.NN,o.tO(),new tt,r,n.QO,n.RO,n.PO),o.SO(t),n.PO=t.TO,n.QO=t.QO,n.RO=t.RO,n.PO.UO<=0&&n.PO.VO<=0&&n.PO.WO(.003),n.QO.XO()<=0&&n.QO.WO(.002),n.RO.XO()<=0&&n.RO.WO(.003),e=zt(),n.YO=e,n.ZO=e,n.$O=0,n._O=0,o._process=3,void(o.HO=W.setInterval(function(){try{o.aP(n)}catch(t){}},20)))},oe.prototype.aP=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d=this,g=zt(),m=g-t.ZO;if(0!=m){if(e=t.JO,o=t.LO,n=t.MO,r=t.NO,t.JO=d.bP(m,t.PO.UO,t.JO),t.LO=d.bP(m,t.PO.VO,t.LO),t.MO=d.bP(m,t.QO.XO(),t.MO),t.NO=d.bP(m,t.RO.XO(),t.NO),e=(e+t.JO)/2,o=(o+t.LO)/2,n=(n+t.MO)/2,r=(r+t.NO)/2,t.ZO=g,i=!1,te(e)&&te(o)&&te(n)&&te(r)&&(i=!0),a=m*e,s=m*o,l=m*n,u=m*r,c=1,0<d.CO&&(d.CO+2*l<0&&(l=-d.CO/2+1),0!==d.CO&&(c=(d.CO+2*l)/d.CO)),d.EN+=l,d.DN+=u,d.AN+=a,d.BN+=s,d.CN*=c,d.CO+=l,d.oO=new q(d.oO.X+a,d.oO.Y+s),t.$O+=a,t._O+=s,i){if(a=b(t.$O),s=b(t._O),te(a)&&te(s))return void d.JN(!0)}else 1<=j(t.$O)&&(a=t.$O,t.$O-=a),1<=j(t._O)&&(s=t._O,t._O-=s);return(h=new tt).sO=new q(a,s),h.rO=c,h.pO=l,h.qO=u,f=new Y(F,t.JO,t.LO,t.NO,t.MO),p=new rt(d.NN,d.tO(),h,!0,ne(d.oO),f),d.uO(p),p.vO?void d.JN(!0):void(i&&d.JN(!0))}},oe.prototype.bP=function(t,e,o){return te(o)?0:(((n=o<0?o+e*t:o-e*t)<0&&0<o||0<n&&o<0)&&(n=0),n);var n},oe.prototype.tO=function(){var t=new tt;return t.pO=this.EN,t.qO=this.DN,t.rO=this.CN,t.sO=new q(this.AN,this.BN),t},oe.prototype.cP=function(t,e,o,n){var r,i=this,a=new tt,s=new tt,l=0,u=0,c=0,h=0,f=i.ZN(4)&&i.SN,p=i.ZN(8)&&i.TN;return!i.ZN(1)||p||t&&!i.ZN(64)||(a.sO.X=e.sO.X,s.sO.X=o.sO.X,l=n.KO().X),!i.ZN(2)||f||t&&!i.ZN(64)||(a.sO.Y=e.sO.Y,s.sO.Y=o.sO.Y,u=n.KO().Y),!i.ZN(32)||t&&!i.ZN(256)?(a.rO=e.rO,s.rO=1):(a.rO=e.rO,a.pO=e.pO,s.rO=o.rO,s.pO=o.pO,h=n.pO()),!i.ZN(16)||t&&!i.ZN(128)||(a.qO=e.qO,s.qO=o.qO,c=n.OO()),r=new Y(F,l,u,c,h),new ot(a,s,r)},oe.prototype.EO=function(t){this.vM&&t&&this.vM(t)},oe.prototype.wO=function(t){this.wM&&t&&this.wM(t)},oe.prototype.dO=function(t){var e;this.xM&&t&&(e=this.cP(!1,t.dP,t.dP,t.eP),t.dP=e.dP,t.eP=e.eP,this.xM(t))},oe.prototype.SO=function(t){var e;this.AM&&t&&(e=this.cP(!1,t.dP,t.fP,t.eP),t.dP=e.dP,t.fP=e.fP,t.eP=e.eP,this.AM(t))},oe.prototype.uO=function(t){var e;this.BM&&t&&(e=this.cP(t.gP,t.dP,t.fP,t.eP),t.dP=e.dP,t.fP=e.fP,t.eP=e.eP,this.BM(t))},J=oe,ee.prototype.qN=function(t){var e,o=this;o._pointerCount++,1<o._pointerCount||(e=zt(),o.hP&&Wt(t,o.hP)&&e-o.iP<400?o.Jb++:(o.hP=t,o.Jb=1),o.jP=t,o.iP=e)},ee.prototype.wN=function(){this.cO&&(this.cO instanceof lt?this.kP(this.cO):this.cO instanceof ut&&this.lP(this.cO),this.cO=F)},ee.prototype.vN=function(t){var e,o=this;o._pointerCount--,0<o._pointerCount||(e=zt(),Wt(t,o.jP)?1e3<e-o.iP?o.cO=new ut(o.jP):1<o.Jb?(o.Jb=0,o.mP(new ct(o.hP)),o.hP=F):o.cO=new lt(o.jP):o.hP=F)},ee.prototype.nP=function(){this.hP=F},ee.prototype.kP=function(t){this.CM&&t&&this.CM(t)},ee.prototype.mP=function(t){this.DM&&t&&this.DM(t)},ee.prototype.lP=function(t){this.EM&&t&&this.EM(t)},Z=ee,q=function(t,e){this.X=t,this.Y=e},e.oP=q,ue.prototype.rP=function(t){var e,o,n,r,i,a;if(0===this.Jb)return 0;for(e=0,o=(1+this.Jb)*this.Jb/2,n=this.Jb-1;0<=n;n--)r=0,i=this.sP(n),0===t?r=i.hO:1===t?r=i.iO:2===t?r=i.lO:3===t&&(r=i.kO),a=this.tP(r,i.mO),e+=a*=n+1;return e/o},ue.prototype.tP=function(t,e){return t/e},ue.prototype.sP=function(t){return this.qP[this.uP(t)]},ue.prototype.vP=function(){return this.qP[this.Jb-1]},ue.prototype.nO=function(t){var e,o,n=this;for(10===n.Jb&&n.wP(),n.Jb++,n.qP[n.uP(n.Jb-1)]=t,e=20*n.pP,o=0;o<n.Jb;o++)t.mO-n.qP[o].mO>e&&(n.wP(),o--)},ue.prototype.wP=function(){this.oI++,this.oI===this.pP&&(this.oI=0),this.Jb--},ue.prototype.IO=function(){this.Jb=0},ue.prototype.uP=function(t){return(this.oI+t)%this.pP},K=ue,le.prototype.KO=function(){return this.xP||(this.xP=new q(this.qP.rP(0),this.qP.rP(1))),this.xP},le.prototype.OO=function(){return At(this.yP)&&(this.yP=this.qP.rP(3)),this.yP},le.prototype.pO=function(){return At(this.lO)&&(this.lO=this.qP.rP(2)),this.lO},Y=le,se.prototype.XO=function(){var t=this._DesiredExpansion,e=this._DesiredDeceleration,o=this.zP;return m(t)||0===t?m(e)?this.AP:e:.5*o*o/t},se.prototype.WO=function(t){this.AP=t},Q=se,ae.prototype.XO=function(){var t=this._DesiredRotation,e=this._DesiredDeceleration,o=this.zP;return m(t)||0===t?m(e)?this.AP:e:.5*o*o/t},ae.prototype.WO=function(t){this.AP=t},X=ae,ie.prototype.EP=function(){var t=this,e=t._DesiredDisplacement,o=t.DP,n=t.BP,r=t.CP,i=t.XO();m(e)||0===e?m(i)||0===i?(t.UO=0,t.VO=0):(t.UO=i*j(n)/o,t.VO=i*j(r)/o):(t.UO=.5*o*j(n)/e,t.VO=.5*o*j(r)/e)},ie.prototype.XO=function(){var t=this._DesiredDeceleration;return m(t)&&m(this._DesiredDisplacement)?this.AP:t},ie.prototype.WO=function(t){this.AP=t,this.EP()},$=ie,tt=function(){this.sO=new q(0,0),this.rO=0,this.qO=0,this.pO=0},re.prototype.XN=function(t){var e,o=this.FP;for(e=0;e<o.length;e++)if(o[e].Np===t)return!0;return!1},re.prototype.QN=function(t){this.FP.push(t)},re.prototype.eO=function(t){var e,o=this.FP;for(e=0;e<o.length;e++)if(o[e].Np===t){o.splice(e,1);break}},re.prototype.MN=function(){return this.FP.length},re.prototype.WN=function(t){return this.FP[t]},re.prototype.$N=function(t){var e,o,n=this.FP;for(e=0;e<n.length;e++)if((o=n[e]).Np===t)return o;return F},re.prototype.IO=function(){var t=this.FP;t.splice(0,t.length)},et=re,ot=function(t,e,o){this.dP=t,this.fP=e,this.eP=o},nt=function(t,e,o,n,r){this.GP=t,this.dP=e,this.gP=o,this.rN=n,this.eP=r},e.ManipulationCompletedEventArgs=nt,rt=function(t,e,o,n,r,i){this.GP=t,this.dP=e,this.fP=o,this.gP=n,this.rN=r,this.eP=i},e.ManipulationDeltaEventArgs=rt,it=function(t,e,o,n,r,i,a){this.GP=t,this.dP=e,this.fP=o,this.eP=n,this.QO=r,this.RO=i,this.TO=a},at=function(t,e,o,n){this.GP=t,this.HP=e,this.dP=o,this.rN=n},e.ManipulationStartedEventArgs=at,st=function(t,e,o,n){this.GP=t,this.DO=e,this.GO=o,this.rN=n},e.ManipulationStartingEventArgs=st,lt=function(t){this.rN=t},ut=function(t){this.rN=t},ct=function(t){this.rN=t},he.prototype.IP=function(t,e){var o=this.Xs;return o?t===Tt.En.Nn(o)&&e===Tt.En.On(o)||Tt.En.Pn(o,t,e):(o=y("canvas"),Tt.En.Kn(o,F,this.kj),Tt.En.Pn(o,t,e)),o},he.prototype.JP=function(t,e,o,n){var r=Tt.En.Nn(t),i=Tt.En.On(t),a=this.IP(r,i),s=a.getContext("2d"),l=Tt.En.Ln(a),u=Tt.En.Mn(a);Tt.Bn.Cn(s,1,1),s.drawImage(t,0,0,Bt(a),Ht(a),0,0,Bt(a),Ht(a)),Tt.Bn.Cn(s,l,u),this.Xs=a,this.KP=e,this.LP=o,this.MP=n},he.prototype.NP=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p=this.kj,d=Tt.En.Nn(t),g=Tt.En.On(t),m=Jt(p),y=Zt(p),b=0<m?1:0,v=0<y?1:0,C=this.LP,w=ye(p),x=this.KP,T=p.am(),A=e/this.MP,S=t.getContext("2d"),M=Tt.En.Ln(t),I=Tt.En.Mn(t),N=this.Xs;S.save(),S.fillStyle=o,S.fillRect(0,0,d,g),h=p.rowOutlines,f=p.columnOutlines,h&&h.jp(p,S,F,!0),f&&f.jp(p,S,F,!1),n=C.x+Bt(C),r=C.y+Ht(C),i=x.lt-n-b,a=x.ot-r-v,s=w.x+Bt(w),l=w.y+Ht(w),u=i*A,c=a*A,n*=M,r*=I,i*=M,a*=I,s*=M,l*=I,u*=M,c*=I,Tt.Bn.Cn(S,1,1),S.drawImage(N,n,r,i,a,s,l,u,c),0<m&&(n=x.lt-b,r=C.y+Ht(C),i=x.js+b,a=x.ot-r-v,s=T.lt-b,l=w.y+Ht(w),u=T.js+b,c=a*A,n*=M,r*=I,i*=M,a*=I,s*=M,l*=I,u*=M,c*=I,S.drawImage(N,n,r,i,a,s,l,u,c)),0<y&&(n=C.x+Bt(C),r=x.ot-v,i=x.lt-n-b,a=x.gs+v,s=w.x+Bt(w),l=T.ot-v,u=i*A,c=T.gs+v,n*=M,r*=I,i*=M,a*=I,s*=M,l*=I,u*=M,c*=I,S.drawImage(N,n,r,i,a,s,l,u,c)),0<m&&0<y&&(n=x.lt-b,r=x.ot-v,i=x.js+b,a=x.gs+v,s=T.lt-b,l=T.ot-v,u=T.js+b,c=T.gs+v,n*=M,r*=I,i*=M,a*=I,s*=M,l*=I,u*=M,c*=I,S.drawImage(N,n,r,i,a,s,l,u,c)),Tt.Bn.Cn(S,M,I),S.restore()},he.prototype.OP=function(){var t=this.kj,e=t.zoom(),o=t._render.vI();o&&this.JP(o.canvas,t.am(),ye(t),e)},he.prototype.PP=function(t){var e,o,n,r,i,a,s=this.kj;if(s.endEdit()&&(e=ce(t,this.MP),o=s.zoom(),n=s.name(),o!==e)){if(r={sheet:s,sheetName:n,oldZoomFactor:o,newZoomFactor:e,cancel:!1},s.Wq(Tt.Events.ViewZooming,r),!0===r.cancel)return;e=r.newZoomFactor,s.XSa(e),s.Wq(Tt.Events.UserZooming,{sheet:s,sheetName:n,oldZoomFactor:o,newZoomFactor:e}),s.Wq(Tt.Events.ViewZoomed,{sheet:s,sheetName:n,oldZoomFactor:o,newZoomFactor:e}),s.invalidateLayout(),(a=(i=s._render).bm())&&this.NP(a.canvas,e,i.zI(!1)),s.QP&&s.QP(F,e),s.RP&&s.RP(F)}},he.prototype.SP=function(t){var e,o=this.kj,n=o.name(),r=ce(t,this.MP),i=o.zoom();if(r!==i){if(e={sheet:o,sheetName:n,oldZoomFactor:i,newZoomFactor:r,cancel:!1},o.Wq(Tt.Events.ViewZooming,e),!0===e.cancel)return;r=e.newZoomFactor,o.XSa(r),o.Wq(Tt.Events.UserZooming,{sheet:o,sheetName:n,oldZoomFactor:i,newZoomFactor:r}),o.Wq(Tt.Events.ViewZoomed,{sheet:o,sheetName:n,oldZoomFactor:i,newZoomFactor:r})}o.oq=!0,o.jq=!0,o.$p()},ht=he,e.TP=ht,ve.prototype.VP=function(t){this.kj.eCb=t},ve.prototype.WP=function(t){this.kj.cCb=t},ve.prototype.XP=function(){this.kj.invalidateLayout()},ve.prototype.ju=function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R=this,k=R.kj,E=k.options,D=function(t,e,o,n){var r,i,a,s,l,u,c,h=o,f=0,p=0,d=t.ss,g=t.am(),m=g.qt,y=t.jt(1).findRow(h),b=t.parent,v=b&&b.options.scrollByPixel&&b.options.scrollbarMaxAlign;if(y)if(0<e){for(r=t.Rt(-1),f=m-y.y;r<h&&f<e;)h--,f+=d.Sl(h);p=e-f}else if(e<0){if(a=0,s=n,v){if(l=t.frozenRowCount(),u=t.getRowCount()-t.frozenTrailingRowCount()-1,i=(c=t.LHb(t.oKc(g),l,u)).cj,a=c.UP,s=n+e,i<h||h===i&&s<a)return F}else i=t.ns();for(f=-(y.y+Ht(y)-m);h<i&&e<f;)h++,f-=d.Sl(h);p=e-f,v&&h===i&&s<a&&(e=(p=a+d.Sl(h))+f)}return{cj:h,UP:p,_Xc:e}}(k,t,k.lq,k.cCb);if(!D)return!1;if(i=D.cj,a=D.UP,t=D._Xc,k.lq=i,0<k.Xq)return!1;if(s=k.Dr(),u=(l=k.am()).qt,c=k.oKc(l),h=l.gs,f=l.ot,p=l.pKc,d=s?s.x:l.x,g=Bt(l),v=E.sheetAreaOffset,C=k.qKc,g+=v.left,t<0)R.YP=0,x=w=void(R.ZP=0),(T=k.jt(1))&&0<T.length&&(w=T.findRow(i)),w&&(x=T[T.length-1]).row>=i&&(m=2+v.top,y=u+j(t),0<=(b=Mt(u+c,x.y+Ht(x))-y)&&(b-=m,R.WP(a-Ht(w)),o.x=d,o.y=y,o.width=g,o.height=b,o.tx=d,o.ty=u,A=C?c:c+h+p,n.x=d,n.y=u+b,n.width=g,n.height=A-b));else if(0<t){if(S=k.Rt(-1),I=M=void 0,k.parent&&k.parent.options.scrollByPixel&&0<a&&(t-=a,a=0),i===S&&0<a)if(0<R.YP&&0<R.ZP){if(a=I=fe(M=R.YP+t,200),(t=I-R.ZP)<=0)return e;if(e&&20<=I)return!0;R.YP=M,R.ZP=I}else{if(200<=a&&(t-=a-199,a=199,t<=0))return e;if(M=pe(a,200),I=a,e&&20<=I)return!0;R.YP=M,R.ZP=I}else R.YP=0,R.ZP=0;t<(C?c:c+h)&&(m=2+v.top,y=u,b=c-t,0<Zt(k)&&(b-=U),R.WP(a),!C&&0<p&&(N=Mt(s.height-h-U,f-U+t),r.x=d,r.y=f-U,r.width=g,r.height=h+U,r.tx=d,r.ty=N),o.x=d,o.y=y,o.width=g,o.height=b+(C?0:Mt(t,p)-U),o.tx=d,o.ty=y+t,n.x=d,n.y=y,n.width=g,n.height=t+m)}return!1},ve.prototype.lu=function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k=this,E=k.kj,D=function(t,e,o,n){var r,i,a,s,l,u,c,h=o,f=0,p=0,d=t.ss,g=t.am(),m=g.pt,y=t.it(1).findCol(h),b=t.parent,v=b&&b.options.scrollByPixel&&b.options.scrollbarMaxAlign;if(y)if(0<e){for(r=t.Ot(-1),f=m-y.x;r<h&&f<e;)h--,f+=d._m(h);p=e-f}else if(e<0){if(a=0,s=n,v){if(l=t.frozenColumnCount(),u=t.getColumnCount()-t.frozenTrailingColumnCount()-1,i=(c=t.MHb(t.rKc(g),l,u)).dj,a=c.UP,s=n+e,i<h||h===i&&s<a)return F}else i=t.ps();for(f=-(y.x+Bt(y)-m);h<i&&e<f;)h++,f-=d._m(h);p=e-f,v&&h===i&&s<a&&(e=(p=a+d._m(h))+f)}return{dj:h,UP:p,aYc:e}}(E,t,E.qq,E.eCb);if(!D)return!1;if(i=D.dj,a=D.UP,t=D.aYc,E.qq=i,0<E.Xq)return!1;if(s=E.Dr(),u=(l=E.am()).pt,c=E.rKc(l),h=l.js,f=l.lt,p=l.sKc,d=s?s.y:l.y,g=Ht(l),w=E.options.sheetAreaOffset,x=E.tKc,g+=w.top,t<0)k.$P=0,A=T=void(k._P=0),(S=E.it(1))&&0<S.length&&(T=S.findCol(i)),T&&(A=S[S.length-1]).col>=i&&(m=2+w.left,y=u+j(t),0<=(b=Mt(u+c,A.x+Bt(A))-y)&&(b-=m,k.VP(a-Bt(T)),o.x=y,o.y=d,o.width=b,o.height=g,o.tx=u,o.ty=d,M=x?c:c+h+p,n.x=u+b,n.y=d,n.width=M-b,n.height=g));else if(0<t){if(I=E.Ot(-1),E.parent&&E.parent.options.scrollByPixel&&0<a&&(t-=a,a=0),i===I&&0<a)if(0<k.$P&&0<k._P){if(a=C=fe(v=k.$P+t,200),(t=C-k._P)<=0)return e;if(e&&20<=C)return!0;k.$P=v,k._P=C}else{if(200<=a&&(t-=a-199,a=199,t<=0))return e;if(v=pe(a,200),C=a,e&&20<=C)return!0;k.$P=v,k._P=C}else k.$P=0,k._P=0;t<(x?c:c+h)&&(m=2+w.left,y=u,b=c-t,0<Jt(E)&&(b-=U),k.VP(a),N=0,!x&&0<p&&(N=h,R=Mt(s.width-N-U,f-U+t),r.x=f-U,r.y=d,r.width=N+U,r.height=g,r.tx=R,r.ty=d),o.x=y,o.y=d,o.width=b+(x?0:Mt(t,p)-U),o.height=g,o.tx=y+t,o.ty=d,n.x=y,n.y=d,n.width=t+m,n.height=g)}return!1},ve.prototype.aQ=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J,Z,q,K,Y,Q,X,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ht,ft,pt,dt,gt,mt=this.kj,yt=!0,bt=!0,vt=mt._render,Ct=vt.bm(),wt=0!=(2&o),xt=0!=(1&o);if(xt||wt)return l={},u={},c=mt.Dr(),h=mt.am(),f=c?c.y:h.y,p=Ht(h),d=c?c.x:h.x,g=Bt(h),wt&&(i={},r={},yt=this.ju(e,n,r,i,l),m=l.x,y=l.y,b=Bt(l),v=Ht(l),C=l.tx,w=l.ty,At(m)||vt.Ow(m,y,b,v,C,w),vt.Ow(r.x,r.y,Bt(r),Ht(r),r.tx,r.ty)),xt&&(a={},s={},bt=this.lu(t,n,a,s,u),x=u.x,T=u.y,A=Bt(u),S=Ht(u),M=u.tx,I=u.ty,At(x)||vt.Ow(x,T,A,S,M,I),vt.Ow(a.x,a.y,Bt(a),Ht(a),a.tx,a.ty),wt||(i=s)),(N=mt.parent)&&!N.options.scrollbarShowMax&&(xt&&(mt.oq=!0),wt&&(mt.jq=!0)),this.XP(),R=mt.rowOutlines&&!mt.rowOutlines.iT()?1:0,k=mt.columnOutlines&&!mt.columnOutlines.iT()?1:0,xt&&wt?vt._l(Ct,new Tt.Rect(i.x,i.y,Bt(i),Ht(i)+R),new Tt.Rect(s.x,s.y,Bt(s)+k,Ht(s))):vt._l(Ct,new Tt.Rect(i.x,i.y,Bt(i)+k,Ht(i)+R)),E=new Tt.Rect(d,f,g,p),(D=mt.getSelections())&&0<D.length&&(j=mt.getRangeRect(1,1,D[0]),_=It(E.x+E.width,j.x+j.width),O=It(E.y+E.height,j.y+j.height),E.x=Mt(E.x,j.x),E.y=Mt(E.y,j.y),E.width=_-E.x+1,E.height=O-E.y+1),vt.Pw(Ct,E),X=!0,rt=(Q=mt).am(),it=Q._render,at=Q.options.gridline.color,st=Tt.Im.Km(0,"gc-columnHeader-normal"),lt=st&&st.borderBottomColor,ut=it.bm(),ct=Q.jt(1),ht=ye(Q),ft=rt.zr,pt=Bt(rt),dt=Q.Rt(-1),(gt=ct.findRow(dt))&&($=rt.qt,0<(tt=gt.y-$)&&(me(ut,at,ft,gt.y-.5,ft+pt-ht.width,gt.y-.5),X&&(0===ht.width&&me(ut,at,rt.zr-.5,$,rt.zr-.5,gt.y),me(ut,lt,rt.kt-.5,$,rt.kt-.5,gt.y)))),et=Q.it(1),$=rt.Ar,tt=Ht(rt),ot=Q.Ot(-1),(nt=et.findCol(ot))&&(ft=rt.pt,0<(pt=nt.x-ft)&&(me(ut,at,nt.x-.5,$,nt.x-.5,$+tt-ht.height),X&&(0===ht.height&&me(ut,at,ft,rt.Ar-.5,nt.x,rt.Ar-.5),me(ut,lt,ft,rt.nt-.5,nt.x,rt.nt-.5)))),ge(mt,!0),this.bQ(xt,wt),L=!0,G=(P=mt).am(),U=P._render.bm(),J=P.jt(1),Z=ye(P),q=P.Rt(-1),K=J.findRow(q),Y=St("gc-group").color,K&&(H=G.qt,0<K.y-H&&L&&0<Z.width&&0===G.Br&&me(U,Y,G.kt-.5,H,G.kt-.5,K.y)),B=P.it(1),V=P.Ot(-1),(z=B.findCol(V))&&(W=G.pt,0<z.x-W&&L&&0<Z.height&&0===G.Cr&&me(U,Y,W,G.nt-.5,z.x,G.nt-.5)),F=mt.options.sheetAreaOffset,mt.options.rowHeaderVisible||vt.B0a(Ct,new Tt.Rect(d,f,2,p+F.top)),mt.options.colHeaderVisible||vt.B0a(Ct,new Tt.Rect(d,f,g+F.left,2)),yt&&bt},ve.prototype.bQ=function(t,e){var o,n=this.kj;e&&n.os(),t&&n.qs(),n._eventHandler._updateEditingEditor(),(o=n._modelManager.Ky)&&o.cQ()},ve.prototype.dQ=function(i,a,s){function l(t,e,o,n){return v(.75,t/=o)*n*(e?1:-1)}function t(t,e,o){return t=j(t),C(t/=o)/C(.75)*e}var u=this,c=u.kj,h=t(i,10,200),f=t(a,10,200),p=i,d=a,g=0,m=0,y=!1,b=!1;u.jI=W.setInterval(function(){var t,e,o,n,r;return y&&b?(c.ss.jn(),(t=c.parent)&&!t.options.scrollbarShowMax&&(c.oq=!0,c.jq=!0),c.ss.kn(),c.cCb=0,c.eCb=0,c.$p(),c.qs(),c.os(),Vt(u.jI),void(u.jI=F)):(f+=20,void(100<(h+=20)&&100<f?(u.aQ(i-g,a-m,be(y,b),s),b=y=!0):(100<h&&!y&&(u.aQ(i-g,0,1,s),y=!0),100<f&&!b&&(u.aQ(0,a-m,2,s),b=!0),e=l(h,0<i,10,200),o=l(f,0<a,10,200),n=w(p-e),r=w(d-o),u.aQ(n,r,be(y,b),s),p=e,d=o,g+=n,m+=r)))},20)},ve.prototype.qG=function(t){var e=this,o=e.kj,n=o.ss;e.jI&&(n.kn(),Vt(e.jI),e.jI=F),e.$P=0,e._P=0,e.YP=0,e.ZP=0,e.eQ=o.lq,e.fQ=o.qq,t&&n.hn()},ve.prototype.NG=function(t,e){var o,n=this.kj.parent,r=n.options.scrollbarAppearance===Tt.ScrollbarAppearance.mobile,i=n.nKc,a=n.kKc,s=n.ku,l=z(t.X+""),u=z(t.Y+""),c=(o=0,(o|=0!==l?1:0)|(0!==u?2:0));return r&&(0!==u&&(i.Jwa(Tt.ScrollbarState.show),s.Rdc(!0)),0!==l&&(a.Jwa(Tt.ScrollbarState.show),s.Rdc(!1))),this.aQ(l,u,c,e)},ve.prototype.gQ=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d=this.kj,g=this.eQ,m=d.lq,y=this.fQ,b=d.qq;return d.parent&&d.parent.options.scrollByPixel?(d.ss.kn(),d.$p(),void this.kXc()):(o=(e=d.am()).pt,n=e.qt,r=d.it(1),a=d.ps(),s=1,r&&0<r.length&&(i=r.findCol(b),b<a&&i&&i.x+Bt(i)-o<Bt(i)/2?b++:s=-1),l=d.jt(1),c=d.ns(),h=1,l&&0<l.length&&(u=l.findRow(m),m<c&&u&&u.y+Ht(u)-n<Ht(u)/2?m++:h=-1),p=f=0,r&&0<r.length&&(f=o-(i=r.findCol(b)).x),l&&0<l.length&&(p=n-(u=l.findRow(m)).y),m!==g&&d.mq(m,0,g),b!==y&&d.rq(b,0,y),f*=s,p*=h,void this.dQ(f,p,t))},ve.prototype.kXc=function(){var t=this.kj,e=this.eQ,o=t.lq,n=this.fQ,r=t.qq;e!==o&&t.Wq(Tt.Events.TopRowChanged,{sheet:t,sheetName:t.name(),oldTopRow:e,newTopRow:o}),n!==r&&t.Wq(Tt.Events.LeftColumnChanged,{sheet:t,sheetName:t.name(),oldLeftCol:n,newLeftCol:r})},ft=ve,Te.prototype.jQ=function(t){var e=this.kj,o=e.am(),n=o.pt,r=o.qt,i=o.$Lc,a=o._Lc,s=o.lt,l=o.ot,u=t.rN,c=e.qKc,h=e.tKc,f=0,p=this.kQ(u.X,u.Y),d=p.dragInfo,g=p.x,m=p.y;p&&(p.resizeInfo||d&&"corner"===d.side||p.selectionHitInfo)?(f|=2,f|=1):(r<=m&&(c&&m<l||!c&&m<a)&&(f|=2),n<=g&&(h&&g<s||!h&&g<i)&&(f|=1),f|=96,e.parent&&(f|=12)),t.DO=f},Te.prototype.lQ=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C={e:t,r:F};if(Te.ao(this,"preProcessManipulationStarted",C),!C.r)if(e=t.rN,n=(o=this.kj).parent,r=o._eventHandler,i=o._render,s=(a=this.kQ(e.X,e.Y)).dragInfo,l=a.selectionHitInfo,(o.yt=a).resizeInfo){if(!o.endEdit())return;r.fG(a)}else if(s&&"corner"===s.side)r.hG&&r.hG(a);else if(l){if(!o.endEdit())return;u=l.isHeader,c=l.isFirstIndicator,h=l.type,u&&r.ZG(a,!0),f=a.hitTestType,a.hitTestType=h,r.bH(a),a.hitTestType=f,p=o,d=c,g=h,u||(y=(m=Ut(p))[m.length-1],b=p.Jl,v=p.Kl,d?3===g?(p.Jl=y.row+y.rowCount-1,p.Kl=y.col+y.colCount-1):2===g?(p.Jl=y.row+y.rowCount-1,p.Kl=0):1===g&&(p.Jl=0,p.Kl=y.col+y.colCount-1):3===g?(p.Jl=y.row,p.Kl=y.col):2===g?(p.Jl=y.row,p.Kl=0):1===g&&(p.Jl=0,p.Kl=y.col),Ce(p,b,v,p.Jl,p.Kl)),o.mQ=!1,i.DH()}else o.nQ&&(o.nQ().oQ=!1),o.mQ=!1,i.DH(),1<t.HP&&n&&n.options.allowUserZoom?(this.KN=!1,this.hQ.OP()):(this.KN=!0,this.iQ.qG(1===t.HP))},Te.prototype.pQ=function(t){var e,o,n,r,i,a,s,l,u,c,h={e:t,r:F};if(Te.ao(this,"preProcessManipulationDelta",h),!h.r&&(e=t.rN,n=(o=this.kj)._eventHandler,r=o.yt,i=e.X,a=e.Y,r))if(s=r.dragInfo,l=r.selectionHitInfo,r.resizeInfo)n.$F={e:t,x:i,y:a},n.WG();else if(s&&"corner"===s.side)n.$F={e:t,x:i,y:a},n.CG&&n.CG();else if(l||n.xG){if(l){if(!n.rG||!n._isWorking)return;if(!0===n.DA)return;u=l.type,n.$F={e:t,x:i,y:a},3===u?n.cH():2===u?n.dH():1===u&&n.eH()}}else this.KN?t.vO=this.iQ.NG(t.fP.sO,t.gP):(c=t.dP.rO,this.hQ.PP(c))},Te.prototype.qQ=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d={e:t,r:F};Te.ao(this,"preProcessManipulationCompleted",d),d.r||(o=(e=this.kj)._eventHandler,e.mQ=!0,r=(n=e.yt).selectionHitInfo,n.resizeInfo?o.YG():n.dragInfo&&o.BG?(o.xH&&o.xH(),e.parent.touchToolStrip.rQ()):r||o.xG?(o.hH(),r&&(a=e,s=r.isHeader,l=r.isFirstIndicator,u=r.type,s||(h=(c=Ut(a))[c.length-1],f=a.Jl,p=a.Kl,l&&(3===u?(a.Jl=h.row,a.Kl=h.col):2===u?(a.Jl=h.row,a.Kl=0):1===u&&(a.Jl=0,a.Kl=h.col)),Ce(a,f,p,a.Jl,a.Kl))),e._render.im()):(e.nQ&&(e.nQ().oQ=!0),this.KN?this.iQ.gQ(t.gP):(i=t.dP.rO,this.hQ.SP(i))))},Te.prototype.sQ=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D=this,j={e:t,r:F};if(Te.ao(D,"preProcessTapped",j),j.r)D.kj.repaint();else if(e=t.rN,o=D.kj,n=o.parent,r=!1,o.Uja=P,D.tQ(),o.uQ&&o.uQ(),(i=o._modelManager.Ky)&&i.vQ(),a=o._eventHandler,l=(s=D.kQ(e.X,e.Y,!0)).filterButtonHitInfo,u=s.hitTestType,c=s.row,h=s.col,f=s.outlineHitInfo)o.isEditing()||(p=f.what,d=o.rowOutlines,g=o.columnOutlines,"rg"===p||"rgh"===p?d&&d.UL(o,f):"cg"!==p&&"cgh"!==p||g&&g.UL(o,f));else if(o.yt=s,l){if(!o.endEdit())return;(m=l.rowFilter)&&m.openFilterDialog(l)}else if(!s.resizeInfo&&o.Qs(s.rowViewportIndex<0?-1:c,s.colViewportIndex<0?-1:h)){if(o.wQ&&!a.BG&&n.touchToolStrip.rQ(),y=o.getActiveRowIndex(),b=o.getActiveColumnIndex(),v=s.cellTypeHitInfo){if(C=o.getCellType(v.row,v.col,u),v.sheet||(v.sheet=o),D.Sia(C,v))if(w=v.sheetArea,!At(w)&&3!==w||c===y&&h===b)o._render.DH();else{if(o.suspendPaint(),!o.endEdit())return;if(x={sheet:o,sheetName:o.name(),row:y,col:b,cancel:!1},o.Wq(Tt.Events.LeaveCell,x),!0===x.cancel)return;T=o._modelManager.getSelections(),A=o._modelManager.getSpan(c,h),S=[Tt.kf(A.row,A.col,A.rowCount,A.colCount)],o.yu(T,S),o.Wq(Tt.Events.FloatingElementSelected,{type:"worksheet"}),M=v.isReservedLocation&&v.isFocusAware,o.Sr(c,h,P,P,M?0:1),I={sheet:o,sheetName:o.name(),row:c,col:h},o.Wq(Tt.Events.EnterCell,I),o.Wq(Tt.Events.FormulatextboxEnterCell,I),o.Au(T),o.Uja=!0,a.cs&&a.cs(c,h),o.resumePaint(),r=!0}C.processCellAndPaddingMouseDown(v),C.XGb(v)}if(v&&v.isReservedLocation)return!0;v&&(v.cellButtonHitInfo||v.outlineColumnHitInfo)&&(r=!0),o.Wq(Tt.Events.CellClick,{sheet:o,sheetName:o.name(),sheetArea:u,row:s.row,col:s.col});try{if(a.mG=s,N=o.isEditing(),R=o.endEdit(),o.CH&&_&&N&&R&&(a.shift=!1),N&&y===o.getActiveRowIndex()&&b===o.getActiveColumnIndex()&&!R)return}finally{a.mG=F}if(At(c)||At(h))return;3===u&&a.cs&&a.cs(c,h),function(t,e,o,n){var r,i,a,s,l,u,c,h,f=!1,p=t._modelManager.getSelections();for(r=0,i=p.length;r<i;r++){if(a=p[r],(s=3===n||At(n))&&(a=t.Tq(a)),l=a.row,u=a.col,c=a.rowCount,h=a.colCount,s)f=l<=e&&e<l+c&&u<=o&&o<u+h;else if(2===n)f=-1===u&&l<=e&&e<l+c;else if(1===n)f=-1===l&&u<=o&&o<u+h;else if(0===n)return f;if(f)break}return f}(o,c,h,u)&&!r?D.xQ=W.setTimeout(function(){var t={x:s.x,y:s.y,handled:!1},e=n.touchToolStrip;o.Wq(Tt.Events.TouchToolStripOpening,t),t.handled||e.open(s.x,s.y-100),D.tQ()},420):(o.Wq(Tt.Events.FloatingElementSelected,{type:"worksheet"}),k=o._modelManager.getSelections(),a.ZG(s),E=o._modelManager.getSelections(),o.yu(k,E),a.hH())}},Te.prototype.Sia=function(t,e){return!(t&&t.activedOnClick&&!t.activedOnClick()&&e.isReservedLocation)},Te.prototype.yQ=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y={e:t,r:F};if(Te.ao(this,"preProcessDoubleTapped",y),!y.r)if(e=this.kj,o=t.rN,this.tQ(),(i=e.yt)&&(e.Wq(Tt.Events.CellDoubleClick,{sheet:e,sheetName:e.name(),sheetArea:i.hitTestType,row:i.row,col:i.col}),a=i.resizeInfo))if(s=e._modelManager.getSelections(),"sizeRow"===a.action||"sizeHiddenRow"===a.action){if(l=[],e.tp(a.index)){for(n=0;n<s.length;n++)if(-1===(r=s[n]).col)for(r=e.Tq(r),u=0;u<r.rowCount;u++)l.push({row:r.row+u})}else l.push({row:a.index});e.wu().execute({cmd:"autoFitRow",sheetName:e.name(),rows:l,columnHeader:1===a.sheetArea})}else{if(c=[],e.sp(a.index)){for(n=0;n<s.length;n++)if(-1===(r=s[n]).row)for(r=e.Tq(r),h=0;h<r.colCount;h++)c.push({col:r.col+h})}else c.push({col:a.index});e.wu().execute({cmd:"autoFitColumn",sheetName:e.name(),columns:c,rowHeader:2===a.sheetArea})}else!((f=this.kQ(o.X,o.Y,!0))&&0<=f.row&&0<=f.col&&0<=f.rowViewportIndex&&0<=f.colViewportIndex)||f.resizeInfo||e.options.isProtected&&e.tq(f.row,f.col,"locked")||((p=e.isCtrlPressed(f.hitTestType))||e.Tr(),d=e.Er(f.row),g=e.Fr(f.col),m=!0,e.Jl===f.row&&e.Kl===f.col||(m=!1),e.Kr(f.row,f.col,d,g,m),p?e.$p():e.addSelection(f.row,f.col,1,1),e._eventHandler.dI(!1,!0),e.EF(e.Ws(),f.row,f.col))},Te.prototype.zQ=function(t){var e,o=this.kj,n=t.rN,r=this.kQ(n.X,n.Y);o.isEditing()?r.row===o.Jl&&r.col===o.Kl||o._eventHandler.cI(r):(this._target=r,(e=this.kQ(n.X,n.Y,!0))&&e.cellTypeHitInfo&&e.cellTypeHitInfo.isEditting||o._eventHandler.cI(e))},Te.prototype.AQ=function(t){var e,o,n,r,i=this.kj;i.isEditing()||(o=!0,(e=this._target)&&((n=e.cellTypeHitInfo)&&n.isReservedLocation||(r=i.getCellType(e.row,e.col))&&r.isEditting())&&(o=!1),o&&i._eventHandler.dI(!0))},Te.prototype.kQ=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O=this.kj;return O.am(),n={x:t,y:e,rowViewportIndex:F,colViewportIndex:F,row:-1,col:-1,resizeInfo:F,hitTestType:F,outlineHitInfo:F,filterButtonHitInfo:F,dragInfo:F,cellTypeHitInfo:F,selectionHitInfo:F},r=O.rowOutlines,i=O.columnOutlines,r&&(a=r.hitTest(O,t,e)),!a&&i&&(a=i.hitTest(O,t,e)),a?n.outlineHitInfo=a:(s=O.nr(e),l=O.or(t),n.rowViewportIndex=s,n.colViewportIndex=l,n.row=O.pr(e,s),n.col=O.qr(t,l),0<=s&&s<=2&&0<=l&&(u=O.rr(s,l,P,n.row,n.col))&&(n.row=u.row,n.col=u.col),n.hitTestType=O.sr(s,l),d=p=f=h=c=void 0,v=n,C=t,w=e,x=10,N=(b=O).parent,R=b._eventHandler,k=b.options,E=v.rowViewportIndex,D=v.colViewportIndex,j=Ut(b),_=F,b.CH&&0<j.length&&(A=(T=j[j.length-1]).row,S=T.row+T.rowCount-1,M=T.col,I=T.col+T.colCount-1,N&&!N.options.allowUserResize||(-1!==A&&-1===M&&0<=E&&D<0&&k.rowHeaderVisible?!(_=R.mH(b,v,x,2,w))||"sizeRow"!==_.action&&"sizeHiddenRow"!==_.action||2!==_.sheetArea||_.index===S||(_=F):-1===A&&-1!==M&&E<0&&0<=D&&k.colHeaderVisible&&(!(_=R.oH(b,v,x,1,C))||"sizeCol"!==_.action&&"sizeHiddenCol"!==_.action||1!==_.sheetArea||_.index===I||(_=F)))),c=_,(p=(f=O.xr)&&f.hitTest(n,t,e))||(p=(y=(m=(g=O.tables)&&g.find(n.row,n.col))&&m.xr)&&y.hitTest(n,t,e)),O.wQ?(h=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m=F,y=e.rowViewportIndex,b=e.colViewportIndex;if(At(y)||At(b))return m;if(r=t.parent,i=t._getActiveSelectedRange(),0<=y&&0<=b&&1===t._modelManager.getSelections().length){if(a=t.Tq(i),s=Jt(t),l=Zt(t),u=qt(t)-s,c=Kt(t)-l,1===b&&0<s&&a.col<u&&a.col+a.colCount>u&&(h=t.Hr(b))&&0<h.length&&o>(f=h[h.length-1]).x+Bt(f))return m;if(1===y&&0<l&&a.row<c&&a.row+a.rowCount>c&&(p=t.Gr(y))&&0<p.length&&n>(d=p[p.length-1]).y+Ht(d))return m}return(g=Ee(t))&&(m||(g.x-=Bt(g),g.y-=Ht(g),g.width*=3,g.height*=3,g.contains(o,n)&&(m={action:"drag",side:"corner"})),r&&r.options.allowUserDragFill||m&&"corner"===m.side&&(m.side=F)),m}(O,n,t,e),n.dragInfo=h):c?n.resizeInfo=c:p?n.filterButtonHitInfo=p:o?n.cellTypeHitInfo=O.yr(n,t,e):(d=function(t,e,o,n){var r,i,a,s,l,u,c,h,f;if(0===t.selectionPolicy())return F;for(r=e.hitTestType,i=je(t),a=Ut(t),s=3,t.CH&&0<a.length&&(-1!==(l=a[a.length-1]).row&&-1!==l.col?s=3:-1!==l.row?s=2:-1!==l.col&&(s=1)),u=0;u<i.length;u++)if((c=i[u])&&(c.x-=Bt(c),c.y-=Ht(c),c.width*=3,c.height*=3,c.contains(o,n)))return At(e.row)&&(h=t.jt(1))&&0<h.length&&(e.row=h[h.length-1].row),At(e.col)&&(f=t.it(1))&&0<f.length&&(e.col=f[f.length-1].col),{x:o,y:n,type:s,isHeader:!1,isFirstIndicator:0===u};return 1===r?{x:o,y:n,type:1,isHeader:!0}:2===r?{x:o,y:n,type:2,isHeader:!0}:F}(O,n,t,e),n.selectionHitInfo=d)),n},Te.prototype.tQ=function(){var t=this.xQ;t&&(clearTimeout(t),this.xQ=F)},pt=Te,e.TouchEventHandler=pt,Tt.Zn(pt),xe.prototype.EQ=function(){var e=this.CQ,t=this.DQ;t.dN=function(t){return e.jQ(t)},t.eN=function(t){return e.lQ(t)},t.fN=function(t){return e.pQ(t)},t.hN=function(t){return e.qQ(t)},t.iN=function(t){return e.sQ(t)},t.jN=function(t){return e.yQ(t)},t.GM=function(t){return e.zQ(t)},t.IM=function(t){return e.AQ(t)}},xe.prototype.FQ=function(){var t=this.DQ;t&&(this.BQ.xN(t,!1),t.dN=F,t.eN=F,t.fN=F,t.gN=F,t.hN=F,t.iN=F,t.jN=F,t.kN=F,t.GM=F,t.IM=F,this.DQ=F)},xe.prototype.GQ=function(t){return this.yM.GQ()},xe.prototype.HQ=function(t){return this.yM.HQ()},xe.prototype.IQ=function(t){return this.yM.IQ()},dt=xe,gt="gc-toolstrip-button",mt="gc-toolstrip-text",yt="gc-toolstrip-image",bt="gc-toolstrip-item",vt="gc-touch-sperate-line",Ct="height",wt="button",Lt(we,Pt=r),we.prototype.open=function(t,e){var o,n,r;if(Gt(this.OC)&&(Tt.Vl.Zl(F,!0),this.NQ.css({left:t,top:e}),this.Ao(),this.MQ=!0,this.Do(),!i(this.LQ)))for(n in o=this.LQ)o.hasOwnProperty(n)&&(!(r=o[n]).RQ||r.RQ.call(this)?k("#"+n).show():k("#"+n).hide())},we.prototype.add=function(t){var e,o,n;t&&(e=this.LQ,t instanceof Rt?(o=t.name())&&(e[o]=t,this.SQ(t.TQ(vt,this.KQ+"px"))):t instanceof Nt&&(n=t.name(),this.getItem(n)||(e[n]=t,this.SQ(t.TQ(yt,this.JQ+"px",mt,gt)))))},we.prototype.getItem=function(t){return this.LQ[t]},we.prototype.getItems=function(){var t,e=[],o=this.LQ;if(i(o))return F;for(t in o)o.hasOwnProperty(t)&&e.push(o[t]);return e},we.prototype.remove=function(t){var e;return this.getItem(t)?(k("#"+t).parent().remove(),e=this.LQ[t],delete this.LQ[t],e):F},we.prototype.clear=function(){this.NQ&&(this.NQ.find("td."+bt).remove(),this.LQ={})},we.prototype.close=function(){var t,e;T.Hm(),this.NQ&&this.NQ.hide(),this.MQ=!1,this.Eo(),(t=Gt(this.OC))&&(t.zt(),0<(e=Ut(t)).length&&!t.wQ&&-1===e[0].row&&-1===e[0].col&&t.Tr())},we.prototype.imageAreaHeight=function(t){return 0===arguments.length?this.JQ:(0<t&&(this.JQ=t,this.NQ.find("span."+yt).css(Ct,t+"px")),this)},we.prototype.itemHeight=function(t){var e=this.NQ.find("button."+gt);return 0===arguments.length?x(e.css(Ct)):(0<t&&e.css(Ct,t+"px"),this)},we.prototype.itemWidth=function(t){var e=this.NQ.find("button."+gt);return 0===arguments.length?x(e.css("width")):(0<t&&(t<x(e.css("min-width"))&&e.css("min-width",t+"px"),e.css("width",t+"px")),this)},we.prototype.separatorHeight=function(t){return 0===arguments.length?this.KQ:(0<t&&(this.KQ=t,this.NQ.find("div."+vt).css(Ct,t+"px")),this)},we.prototype.OQ=function(){var t=k(y("table")).css({padding:0,display:"table"}).attr({cellspacing:0,cellpadding:0});this.UQ=k(y("tr")).appendTo(t),t.appendTo(this.NQ)},we.prototype.no=function(){var t=this.NQ;t&&(this.MQ&&T.Hm(),t.unbind("click"),t.remove(),this.Eo(),this.NQ=F)},we.prototype.QQ=function(){var i=this;i.NQ.bind("click",function(t){var e,o,n,r=t.target;r.tagName.toLowerCase()===wt?e=r.id:(o=r.parentElement)&&o.tagName.toLowerCase()===wt&&(e=o.id),n=i.LQ[e],e&&n&&n.VQ.call(i)})},we.prototype.SQ=function(t){this.NQ&&t&&k(y("td")).append(t).appendTo(this.UQ).addClass(bt)},we.prototype.PQ=function(){var t,e,o,n,r,i,a;function s(t){for(var e=0,o=t+e;G.getElementById(o);)o=t+ ++e;return o}n=(e={0:A+(t="gAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAA")+"A8ElEQVRIS92VwQ3CMAxFe+qZERiHY8dgDI4cYYNOhDhwY4ayQviW4q/Eddu0KRe+9CQ72P8rEpAmhPBT3ENLd76EiPv5HO5hSmK+KYTFsz+04A4G9NZ0hAizn7jTos2MFRYYugFZQlscoFzRZsYKCwwNulAqnZddtJmxwiIZ3oT6WFh4S2tQHwsLb2kN6mNh4S2tQX0sLLwly4IyY4WFZ2gReV/ZhBOQH2ddgKcYwBAc7R/weL0ZgqO6gGPXE1E0JlBdwJx2CUhvkCL63xvw33QKUc0N+B5MIaq5gb5o8kotBszJDShFlkvQ+ZHBvoTmC+fiVfoq/m86"+S,1:A+t+"BkklEQVRIS7WTUXECQRBEcYCFOIiESAAH/OYPCcQBEogDJCABCUhAwqXf1QzVM0cojko+Xt3ObG/33t7eYhiGf6UU68+vneD5Mu4HpZDgKja+YCYH94NSSHAUg3glZC9k8zgAYwLmhuS6o/tBKUJ8CTGsoveIsin3g1LEAkxzAd/kXbihwxwatGys+EEpEAT5LR6FuDmMb+t+UAoEwVL44h7CvB8lGxrn3A9KkaLAj8pDMD9HL/v0ZgfAQfSAk/WgXAT3g1K4MPCj2AoPhNvRJO4HpejigF1jxtjNy9Ek7gel6GIjfzoP+Ihewf2gFPcWNNL817/c/aAUKXpbfy/FXlzFIM6gOYy3Gp+iz/xBPHeLQGLAMI2PNmYOw1uojZfdCyYNCXexiGcGpiljdp9hsBGjvnvBpCHhRbgBZChjAgj0eXrX7gWThoR992lAMGOOLMfJuIHuBZMGQuE75KN66Cpq14xH2L1g0kixyLNm3I8sNbwJulHfvWDSkJArmou4hlxXeh4AvBEBuZnnbtHfMix+AHqkr6wgQ4Q7"+S,2:A+t+"A3UlEQVRIS72PwQ3CMAxFOwrjcOyZCTgyAjfWYCJO3JiCCVL/iFSO9W0MDTzpqYob+ztTKeWn0uJIadE6H8/ljXsR96q6tzt4YogH/olPcQ2R8mp3CHRBwO3+6EKkvNodcDkSgyyoAx0iRz/AA/8Op0sdtJuv1Va3Ct8FYHgL8dgUAGxIe41+kRAH6CbdaGW86nFAhnaXLSLEAbqJCbxlUgEZ2DIgFaCbmMBbJhWQgS0DUgG6iQm8ZVIBGTYFsK21oN3F1yrEARnsIM/u8JeAT9S9nrQ4UlocKS2Os0wLtkPMdu9POt0AAAAASUVORK5CYII=",3:A+"UAAAAXCAIAAABrvZPKAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAIdJREFUOE/tzEEKgCAQheEOWLdx351adYc8Qgs3rbuAUC9nkkF0BKNN9CMy0Xx25llf8Edr7d57j/tlP4wTHf4W/b7gsT0vLs7Sz9bFWfM9nrDXE9ITphlVPO512wkkM++FNF86vBfKeKR43rjLe5QwOvxPVPSoipHmkY5RxSMFo7rXY9+eMSdet07b6c/bnwAAAABJRU5ErkJggg=="})[0],r=e[1],i=e[2],a=e[3],(o=this).WQ=new Nt(s("wijspread_toolstrip_paste"),I().ToolStrip_PasteText,n,o.XQ),o.YQ=new Nt(s("wijspread_toolstrip_cut"),I().ToolStrip_CutText,r,o.ZQ),o.$Q=new Nt(s("wijspread_toolstrip_copy"),I().ToolStrip_CopyText,i,o._Q),o.aR=new Nt(s("wijspread_toolstrip_autofill"),I().ToolStrip_AutoFillText,a,o.bR,o.cR),o.add(o.WQ),o.add(o.YQ),o.add(o.$Q),o.add(new Rt(o.cR)),o.add(o.aR)},we.prototype.cR=function(){var t,e,o,n=Gt(this.OC);if(!n)return!1;for(t=Ut(n),e=0;e<t.length;e++)if(-1===(o=t[e]).row&&-1===o.col)return!1;return!0},we.prototype.bR=function(){var t;this.close(),!(t=Gt(this.OC))||Ut(t).length<=1&&(t.wQ=!0,t._render.im())},we.prototype.rQ=function(){var t=Gt(this.OC);t&&(t.wQ=!1,t._render.im())},we.prototype._Q=function(){var t=Gt(this.OC);t&&(this.dR=t.ux(!0)),this.close()},we.prototype.ZQ=function(){var t=Gt(this.OC);t&&(this.dR=t.sx(!0)),this.close()},we.prototype.XQ=function(){var t=this.dR,e=Gt(this.OC);e&&!At(t)&&e.vx({pasteHtml:t.copyHtml,pasteText:t.copyText}),this.close()},we.prototype.eR=function(){var t="span."+mt;k("#"+this.WQ.Cj).find(t).text(I().ToolStrip_PasteText),k("#"+this.YQ.Cj).find(t).text(I().ToolStrip_CutText),k("#"+this.$Q.Cj).find(t).text(I().ToolStrip_CopyText),k("#"+this.aR.Cj).find(t).text(I().ToolStrip_AutoFillText)},xt=we,e.TouchToolStrip=xt,Re.prototype.name=function(t){return 0===arguments.length?this.Cj:(k("#"+this.Cj).attr("id",t),k("#"+this.Cj+"Text").attr("id",t+"Text"),k("#"+this.Cj+"Image").attr("id",t+"Image"),this.Cj=t,this)},Re.prototype.text=function(t){return 0===arguments.length?this._text:(this._text=t,k("#"+this.name()+"Text").text(t),this)},Re.prototype.font=function(t){var e=k("#"+this.name()+"Text");return 0===arguments.length?this._font:(this._font=t,e.css("font",t),this)},Re.prototype.foreColor=function(t){var e=k("#"+this.name()+"Text");return 0===arguments.length?this.Nra?this.Nra:e.css("color"):(e.css("color",t),this)},Re.prototype.image=function(t){return 0===arguments.length?this.fR:(this.fR=t,k("#"+this.name()+"Image").css("background-image","url("+t+")"),this)},Re.prototype.TQ=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p=this.name(),d=this.font(),g=this.text(),m=k(y("span"));return m.attr("id",p+"Image"),m.addClass(t),m.css({"background-image":"url("+this.image()+")","background-repeat":"no-repeat",display:"block",height:e,"background-position-x":"50%"}),(r=k(y("span"))).attr("id",p+"Text"),r.addClass(o),r.css("font",d),r.text(g),s=d,l=g,u=o,h=y("span"),f=G.body,h.className=u,h.style.font=s,h.style.cssFloat="left",h.textContent=l,f.insertBefore(h,F),c=k(h).width(),f.removeChild(h),(i=60)<c&&(i=c),(a=k(y(wt))).attr("type",wt),a.attr("id",p),a.addClass(n+" gc-toolstrip-button-style ui-state-default ui-widget btn btn-default"),a.css({"box-sizing":"content-box",border:"0px",padding:"4px",margin:"3px",width:i+"px"}),a.append(m),a.append(r),a[0]},Nt=Re,e.TouchToolStripItem=Nt,Ne.prototype.name=function(){return this.Cj},Ne.prototype.TQ=function(t,e){var o=k(y("div"));return o.attr("id",this.name()),o.addClass(t),o.css({width:"1px",height:e,display:"inline-block;","background-color":"#CCC","margin-left":"5px","margin-right":"5px",opacity:.6}),o[0]},Rt=Ne,e.TouchToolStripSeparator=Rt,Ie.prototype.oN=function(){this.gR=2,this.tc.CH=!0},Ie.prototype.zM=function(){this.gR=0,this.hR=zt()},Ie.prototype.nN=function(){return 1===this.gR},Ie.prototype.uN=function(){return 1===this.gR},Ie.prototype.sN=function(){return 1===this.gR},Ie.prototype.GQ=function(){if(2===this.gR)return!0;if(this.hR){if(zt()-this.hR<=200)return this.iR++,!0;this.hR=0,this.iR=0,this.gR=1}else this.gR=1;return this.tc.CH=!1},Ie.prototype.HQ=function(){return this.iR?(this.iR--,!0):2===this.gR||(this.gR=0,!1)},Ie.prototype.IQ=function(){return 2===this.gR},kt=Ie,e.jR=kt,Et=function(t,e,o,n,r){this.KM=t,this.lN=o,this.OM=e,this.mN=n,this.aN=r},e.kR=Et,Me.prototype.lR=function(t,e){var o,n,r=t,i=r.touches,a=r.targetTouches,s=r.changedTouches;!1!==r.isPrimary&&(i&&1<=i.length&&a&&1<=a.length&&(i[0].clientX!==a[0].clientX||i[0].clientY!==a[0].clientY)||(h(t),o=At(s)?r:s[0],(n=G.createEvent("MouseEvents")).initMouseEvent(e,!0,!0,W,1,o.screenX,o.screenY,o.clientX,o.clientY,!1,!1,!1,!1,0,F),t.target.dispatchEvent(n)))},Me.prototype.NM=function(t){var e,o=t.pointerType;if(!o||o===t[g]||o===d){if((e=t.data).mR)return;e.mR=!0,e.nR=!1,e.lR(t,"mouseover"),e.lR(t,"mousemove"),e.lR(t,"mousedown")}},Me.prototype.aB=function(t){var e,o=t.pointerType;if(!o||o===t[g]||o===d){if(!(e=t.data).mR)return;e.nR=!0,e.lR(t,"mousemove")}},Me.prototype.RM=function(t){var e,o=t.pointerType;if(!o||o===t[g]||o===d){if(!(e=t.data).mR)return;e.lR(t,"mouseup"),e.lR(t,"mouseout"),e.nR||e.lR(t,"click"),e.mR=!1}},Me.prototype.oR=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d=this;"."!==o.charAt(0)&&(o="."+o),n=D+o,r=O+o,i=L+o,a=H+o,s=B+o,l="pointerup"+o,u=V+o,c="touchmove"+o,h="touchend"+o,f=Tt.Ul._Va(),e?f?(p=t.style,At(p.msTouchAction)||(p.msTouchAction=E),At(p.touchAction)||(p.touchAction=E),k(t).bind(n,d,d.NM).bind(a,d,d.NM),k(G).bind(r,d,d.aB).bind(s,d,d.aB).bind(i,d,d.RM).bind(l,d,d.RM)):k(t).bind(u,d,d.NM).bind(c,d,d.aB).bind(h,d,d.RM):f?(k(t).unbind(n).unbind(a),k(G).unbind(r).unbind(s).unbind(i).unbind(l)):k(t).unbind(u).unbind(c).unbind(h)},Dt=Me,e.pR=Dt,Se.prototype.lQ=function(t){var e,o,n,r,i,a,s,l,u=t.rN,c=this.YJc,h=c.zJc(),f=Gt(c.OC);c.FD&&c.GD(f,!1),"resize"===(e=c.hitTest(u.X,u.Y).element)?(c.HD=!0,c.ID=u.X):"tab"!==e&&"newSheet"!==e&&""!==e||(o=c.Xs,n=Tt.En.Nn(o),r=Tt.En.On(o),a=(i=this.IP(n,r)).getContext("2d"),s=Tt.En.Ln(i),l=Tt.En.Mn(i),Tt.Bn.Cn(a,1,1),a.drawImage(o,0,0,Bt(i),Ht(i),0,0,Bt(i),Ht(i)),Tt.Bn.Cn(a,s,l),this.Xs=i,this.qR=c.gq,this.rR=c.VC(),this.sR=c.UC(),this.KC=c.TC(),c.SC=h),this.tR=c.jw(-1),this.uR=c.rD(c.sD())},Se.prototype.pQ=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k=t.rN.X,E=this.YJc,D=E.zJc();if(E.HD)e=k-E.ID,n=(o=E.OC).options,r=o.xs.clientWidth,n.tabStripRatio=o.Iv()+e/r,i=E.AJc()/r,o.Iv()<i?(n.tabStripRatio=i,E.ID=E.AJc()):1<=o.Iv()?(n.tabStripRatio=1,E.ID=r):E.ID=k;else{if(a=this.Xs,s=this.qR,!a||At(s))return;l=this.tR,u=this.uR,c=this.KC,h=this.rR,f=this.sR,p=D?t.dP.sO.X:t.dP.sO.Y,d=this.vR(p,s),E.gq=d.gq,g=d.Oz,(0<p&&s===l&&E.gq===l||p<0&&s===u&&E.gq===u)&&(g=0),0<p&&g+c<p?p=g+c:p<0&&p<g-c&&(p=g-c),0!==p&&(y=(m=E.Xs).getContext("2d"),b=Tt.En.Ln(m),v=Tt.En.Mn(m),y.save(),y.clearRect(0,0,Tt.En.Nn(m),Tt.En.On(m)),C=E.Dr(),E.dD(y,C),D?(w=void 0,T=void(x=0),A=Ht(C),M=S=void 0,0<p?(0<(T=f-(S=(w=h)+p))&&(Tt.Bn.Cn(y,1,1),y.drawImage(a,w*b,x,T*b,A*v,S*b,x,T*b,A*v),Tt.Bn.Cn(y,b,v)),M=p-g,f-h<=p&&(M=0),w=h,0<(T=g)&&(Tt.Bn.Dn(y,M,0),E.iE(y,new Tt.Rect(w,x,T,A)),Tt.Bn.Dn(y,-M,0))):p<0&&(0<(T=f-(w=(S=h)+j(p)))&&(Tt.Bn.Cn(y,1,1),y.drawImage(a,w*b,x,T*b,A*v,S*b,x,T*b,A*v),Tt.Bn.Cn(y,b,v)),M=p-g,f-h<=j(p)&&(M=0),w=f-(T=j(g)),0<T&&(Tt.Bn.Dn(y,M,0),E.iE(y,new Tt.Rect(w,x,T,A)),Tt.Bn.Dn(y,-M,0))),Tt.Bn.Cn(y,1,1),w=0,T=h,y.drawImage(a,w*b,x,T*b,A*v,w*b,x,T*b,A*v),I=Tt.Im.Lm(""),2007<z(I.zIndex)&&(w=f,T=C.x+Bt(C)-E.AJc()-w,y.drawImage(a,w*b,x,T*b,A*v,w*b,x,T*b,A*v)),w=Bt(C)-E.AJc(),T=E.AJc(),y.drawImage(a,w*b,x,T*b,A*v,w*b,x,T*b,A*v)):(x=void(w=0),T=Bt(C),R=N=A=void 0,0<p?(0<(A=f-(N=(x=h)+p))&&(Tt.Bn.Cn(y,1,1),y.drawImage(a,w*b,x*v,T*b,A*v,w*b,N*v,T*b,A*v),Tt.Bn.Cn(y,b,v)),R=p-g,f-h<=p&&(R=0),x=h,0<(A=g)&&(Tt.Bn.Dn(y,0,R),E.iE(y,new Tt.Rect(w,x,T,A)),Tt.Bn.Dn(y,0,-R))):p<0&&(0<(A=f-(x=(N=h)+j(p)))&&(Tt.Bn.Cn(y,1,1),y.drawImage(a,w*b,x*v,T*b,A*v,w*b,N*v,T*b,A*v),Tt.Bn.Cn(y,b,v)),R=p-g,f-h<=j(p)&&(R=0),x=f-(A=j(g)),0<A&&(Tt.Bn.Dn(y,0,R),E.iE(y,new Tt.Rect(w,x,T,A)),Tt.Bn.Dn(y,0,-R))),Tt.Bn.Cn(y,1,1),x=0,A=h,y.drawImage(a,w*b,x*v,T*b,A*v,w*b,x*v,T*b,A*v),I=Tt.Im.Lm(""),2007<z(I.zIndex)&&(x=f,A=C.y+Ht(C)-E.AJc()-x,y.drawImage(a,w*b,x*v,T*b,A*v,w*b,x*v,T*b,A*v)),x=Ht(C)-E.AJc(),A=E.AJc(),y.drawImage(a,w*b,x*v,T*b,A*v,w*b,x*v,T*b,A*v)),Tt.Bn.Cn(y,b,v),y.restore())}},Se.prototype.qQ=function(t){var e=this.YJc;e.HD?(e.HD=!1,e.OC.aq()):(e.SC=P,e.repaint())},Se.prototype.sQ=function(t){var e,o,n,r,i=this.YJc,a=i.OC,s=t.rN,l=Gt(a);i.FD&&i.GD(l,!1),e=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],n=(o=i.hitTest(s.X,s.Y)).element,a.mv=!0;try{0<=e.indexOf(n)?i.JD(o.index,!0):"tab"===n?i.KD(o.index,o.position):"newSheet"===n&&i.MD(o.position)}finally{a.mv=!1,(r=Gt(a))!==l&&(r.CH=!0,r.zt())}},Se.prototype.yQ=function(t){return this.YJc.cE(t.rN.X,t.rN.Y)},Se.prototype.IP=function(t,e){var o=this.Xs;return o?t===Tt.En.Nn(o)&&e===Tt.En.On(o)||Tt.En.Pn(o,t,e):(o=y("canvas"),Tt.En.Kn(o,this.YJc.OC),Tt.En.Pn(o,t,e)),o},Se.prototype.vR=function(t,e){var o=this.YJc,n=o.WC,r=o.BJc,i=this.tR,a=this.uR,s=o.zJc(),l=e,u=0;if(0<t){for(;i<=l&&!(t<u);)u+=s?n[l]:r,l--;l<i&&(l=i)}else if(t<0&&-1!==a){for(;l<=a&&!(u<t);)u-=s?n[l]:r,l++;a<l&&(l=a)}return{gq:l,Oz:u}},jt=Se,Ae.prototype.EQ=function(){var t=this.BQ;t&&t.xN(this.DQ,!0)},Ae.prototype.FQ=function(){var t=this.BQ;t&&t.xN(this.DQ,!1)},Ae.prototype.GQ=function(t){return this.yM.GQ()},Ae.prototype.HQ=function(t){return this.yM.HQ()},Ae.prototype.IQ=function(t){return this.yM.IQ()},_t=Ae,Tt.oJ.prototype.DH=function(){var t=this.kj,e=Ut(t),o=e.length;t.Xq<=0&&0<o&&this.im(e[o-1],P,P,!0)},Tt.Worksheet.$n(d,{init:function(){this.wQ=!1,this.mQ=!0},setHost:function(t){var e=this.parent,o=e&&e.BQ||new N,n=new dt(t[0],this,o);n.EQ(),this.wR=n},dispose:function(t){this.wR&&this.wR.FQ(),!1!==t.clearCache&&(this.wR=F)},startEdit:function(){this._render.DH()},paintAdornment:function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w=t.ctx;this.CH&&(this.options.isProtected||(i=w,v=(r=this).am(),C=Ut(r),r.CH&&0<C.length&&(h=(c=C[C.length-1]).row,f=c.row+c.rowCount-1,p=c.col,d=c.col+c.colCount-1,m="AAAAAQCAYAAAAf8/9hAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADs",(g=r.parent)&&!g.options.allowUserResize||(-1!==h&&-1===p&&r.getRowResizable(f)?(y=r.Er(f),a=A+m+"MAAA7DAcdvqGQAAABaSURBVDhPY/z//z8DLsDIyAiWBKphBAtgAUxQGgPANIMAMhsdYDUAmwZchtDOC8SCgTcA5DfcgUAEoNwFo7GAPQxwJVtsYYHVBdgU4gpInF5A1oBLMwMDAwMApuAtD6Z7YxQAAAAASUVORK5CYII=",s=r.getCellRect(f,qt(r,2)-1,y,-1),(u=v.fm(y)).y<=s.y&&s.y+Ht(s)<=u.y+Ht(u)&&(l=new Tt.Rect(v.kt-16,s.y+Ht(s)-8,16,16))):-1===h&&-1!==p&&r.getColumnResizable(d)&&(b=r.Fr(d),a=A+m+"IAAA7CARUoSoAAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjEwMPRyoQAAAE1JREFUOE/ljtEKACAIA/v/nzZ9mFhsJPRocLEuGS4zk/iJyyP/D6gE0wrYoCqoLoUafPl8fEBln3ulSscfErk65TMjMFRBhUowosDWBoHpba8+C7w0"+S,s=r.getCellRect(Kt(r,1)-1,d,-1,b),(u=v.gm(b)).x<=s.x&&s.x+Bt(s)<=u.x+Bt(u)&&(l=new Tt.Rect(s.x+Bt(s)-8,v.nt-16,16,16))),a&&l&&ke(r,a,i,l)))),this.wQ?(o=w,(n=Ee(e=this))&&ke(e,A+"EAAAATCAIAAAD5x3GmAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2 + oZAAAAGhJREFUOE / djkEOwCAIBHk6P98u1lKo1diEU + dggOyAAkC + YPl / Onx3WDmiytm4aulQoKba + 4uiO77YhHDH5SqnRa0If / Nhq0fnjPob2h5oVXJI0rJA3h1ya1kgU4f4nQfVzozk7APgAIEqATZbalz1"+S,o,n)):function(t,e,o){var n,r,i,a;if(Tt.needPaintSelection(t)){if(t.isEditing()||!e||0===t.selectionPolicy())return;if(i=void 0,0<(r=(n=je(t)).length)){for(o.save(),o.fillStyle=t.m_a()||"white",o.strokeStyle=t.getSelectionBorderColor(),a=0;a<r;a++)(i=n[a])&&(o.beginPath(),o.arc(i.x+Bt(i)/2,i.y+Ht(i)/2,Bt(i)/2,0,2*Math.PI,!1),o.fill(),o.stroke());o.restore()}}}(this,this.mQ,w))},preProcessMouseDown:function(t){var e=t.e,o=this.wR;(s||o.GQ(e))&&(h(e),t.r=!0)},preProcessMouseMove:function(t){var e=t.e,o=this.wR;(s||o.IQ(e))&&(h(e),t.r=!0)},preProcessMouseUp:function(t){var e=t.e,o=this.wR;(s||o.HQ(e))&&(h(e),t.r=!0)},preProcessMouseDbClick:function(t){(s||this.CH)&&(t.r=!0)},preProcessMouseOut:function(t){s&&(t.r=!0)},preProcessMouseWheel:function(t){s&&(t.r=!0)}}),Tt.Workbook.$n(d,{init:function(){this.BQ=new N},setHost:function(){this.touchToolStrip=new xt(this,this.xv())},dispose:function(){var t=this.BQ,e=this.touchToolStrip;t&&t.no(),e&&(e.no(),this.touchToolStrip=F)},onCultureChanged:function(){var t=this.touchToolStrip;t&&t.eR()}}),Tt.DC.$n(d,{setHost:function(){var t=new _t(this.Xs,this,this.OC.BQ);t.EQ(),this.wR=t},dispose:function(){var t=this.wR;t&&(t.FQ(),this.wR=F)},preProcessMouseDown:function(t){var e=this.wR,o=t.e;(s||e.GQ(o))&&(h(o),t.r=!1)},preProcessMouseMove:function(t){var e=this.wR,o=t.e;(s||e.IQ(o))&&(h(o),t.r=!1)},preProcessMouseUp:function(t){var e=this.wR,o=t.e;(s||e.HQ(o))&&(h(o),t.r=!1)},preProcessMouseDbClick:function(t){var e=Gt(this.OC);(s||e&&e.CH)&&(t.r=!1)},preProcessMouseOut:function(t){s&&(t.r=!1)}}),Ot=".gcScrollbar",Tt.hv.$n(d,{initEvents:function(t){(this.xR=new Dt).oR(t,!0,Ot)},dispose:function(t){var e=this.xR;e&&e.oR(t,!1,Ot)}})},"./dist/plugins/touch/touch.res.en.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ToolStrip_PasteText="Paste",e.ToolStrip_CutText="Cut",e.ToolStrip_CopyText="Copy",e.ToolStrip_AutoFillText="AutoFill"},"./dist/plugins/validation/datavalidation-event.js":function(t,e,o){"use strict";var n,r,q,K,Y,Q,X,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ht,ft,pt,dt;Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("@grapecity/js-sheets-common"),q=o("@grapecity/js-calc"),K=o("./dist/plugins/validation/datavalidation.js"),Y=r.Common.j.Fa,Q=r.Common.l,X=r.Common.u,$=n.Ul,tt=n.kf,et=$.rl(),ot=$.Ml,nt=n.GC$,rt=$.Nl,it=$.hZa,at=$.nl,st=document,lt=Math.max,ut=Math.min,ct="position",ht="absolute",ft="background-color",pt="z-index",dt="gcUIElement",nt.extend(n.iI.prototype,{cs:function(e,o){var n,r,t,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J;function Z(t,e){if(t&&t[e])return"function"==typeof t[e]?t[e]():t[e]}if((t=(r=(n=this).kj)&&r.parent)&&(r.hm()&&((i=t.getActiveSheet())||(a=t.getActiveSheetTab())&&(i=a.kj),i&&r.name()===i.name()&&((s=r.getDataValidator(e,o))&&(l=r.getCellRect(e,o),!n.oG(l)&&(u=t.xv(),c=t.getHost(),h=$.vl(c),Z(s,"showInputMessage")&&Z(s,"inputMessage")&&(d=(f=X.Gb)((p=X.Ob)(Z(s,"inputTitle")),"\n","<br/>"),g=f(p(Z(s,"inputMessage")),"\n","<br/>"),m=rt("span"),nt(m).css(ct,ht).css("border","1px #C0C0C0 solid").css("padding","3px 8px 3px 8px").css(ft,"#FFFFFF").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css("font","normal normal normal 12px/normal Arial").width("auto").height("auto").css("top",l.y+l.height+5).css("left",l.x+l.width/2).css(pt,h).html("<b>"+d+"</b><br/>"+g).attr(dt,"gcValidationInputMessage").appendTo(u),r.KH=m),s&&3===Z(s,"type")&&Z(s,"inCellDropdown")&&Z(s,"condition"))))))){for(y=Z(s,"condition").getValidListImp(r,e,o),b=Z(s,"condition").CIc(),v=y.length,C=rt("select"),w=r.getText(e,o),x=-1,T=st.createDocumentFragment(),A=RegExp(String.fromCharCode(32),"g"),S=String.fromCharCode(160),M=0;M<v;M++)I=y[M].text,Y(I)||q&&I instanceof q.CalcError||(x<0&&I===w&&(x=M),I instanceof Date&&(I=Q.Vb(I,"M/d/yyyy h:mm:ss")),(N=rt("option")).value=I,N.text=I.replace(A,S),T.appendChild(N));C.appendChild(T),C.selectedIndex=0<x?x:0,R=r.getActualStyle(e,o),k=r._render,E=R&&R.font?R.font:k.Bl(),1<r.zoom()&&(E=k.Cl(E)),j=1,(D=r._modelManager.getSpans(tt(e,o,1,1)))&&0<D.length&&D[0]&&(j=D[0].colCount),_=o+j-1==r.getColumnCount()-1,O=r.Sl(e),F=r.parent&&r.parent.options.useTouchLayout,O=ut(F?50:15,O),P=ot.safari&&(et.ipad||et.iphone),L=et.android,W=z=V=B=H=void 0,W=P?(H=l.width+3,B=l.height+3,V=l.y-1.5,z=l.x-1.5,"white"):(H=lt(l.width+(_?0:O),r.defaults.colWidth),B=8<v?140:"auto",V=l.y+l.height,z=(G=l.x+l.width+(_?0:O)-H)<r.Vs().left?l.x:G,""),U=nt(C).css("outline","none").css(ct,ht).css("font",it(E)).css(pt,h).css(ft,W).width(H).height(B).css("left",z).attr(dt,"gcValidationSelect").appendTo(u).attr("size",2<v?v:2).hide().bind("click",function(){L||(n.pG(C,e,o,y,b),P&&nt(r.y$).show())}).bind("keydown",function(t){13!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey?27!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey||nt(C).hide():n.pG(C,e,o,y,b),P&&nt(r.y$).show()}).bind("change",function(){L&&n.pG(C,e,o,y,b)}),nt(c).height()<(B=U.outerHeight()+1)+V&&B<V&&(P||(V=l.y-B)),U.css("top",V),P&&U.bind("blur",function(){n.pG(C,e,o,y,b),nt(r.y$).show()}),r.lm=C,(J=rt("input")).type="image",J.src=K.zW(),J.alt="v",nt(J).css(ct,ht).width(O).height(O).css("top",l.y+l.height-(O+3)).css("left",l.x+l.width-(_?O:0)).css(pt,h).css(ft,"white").css("border","1px solid gray").attr(dt,"gcValidationButton").appendTo(u).bind("click",function(t){r.isEditing()&&!r.endEdit()||(nt(r.lm).toggle().focus(),P&&nt(r.y$).toggle(),at(t))}),r.y$=J}}})},"./dist/plugins/validation/datavalidation.entry.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),o("./dist/plugins/validation/datavalidation-event.js");var n=o("./dist/plugins/validation/datavalidation.js");e.CriteriaType=n.CriteriaType,e.DataValidationResult=n.DataValidationResult,e.ErrorStyle=n.ErrorStyle,e.DefaultDataValidator=n.DefaultDataValidator,e.HighlightType=n.HighlightType,e.HighlightPosition=n.HighlightPosition,e.zW=n.zW,e.bW=n.bW,e.createNumberValidator=n.createNumberValidator,e.createDateValidator=n.createDateValidator,e.createTimeValidator=n.createTimeValidator,e.createTextLengthValidator=n.createTextLengthValidator,e.createFormulaValidator=n.createFormulaValidator,e.createFormulaListValidator=n.createFormulaListValidator,e.createListValidator=n.createListValidator},"./dist/plugins/validation/datavalidation.js":function(t,e,o){"use strict";var l,n,r,u,i,a,d,g,h,s,c,m,f,p,y,b,v,P,L,H,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_;function O(t){this.id=O.w$,O.w$++,this.QAb=s(x),t&&(this.condition(t),this.condition().ignoreBlank(this.ignoreBlank())),this.n5=[]}function F(t){return a&&t&&"="===t[0]}function B(t,e,o,n){var r,i,a,s,l=m,u=m,c=m,h=m;return F(e)?l=g(e,"="):u=e,F(o)?c=g(o,"="):h=o,r=m,6===t&&((i=d(1,3,u,l)).integerValue(n),(a=d(1,5,h,c)).integerValue(n),r=d(0,1,m,m,m,m,m,i,a)),7===t&&((i=d(1,4,u,l)).integerValue(n),(a=d(1,2,h,c)).integerValue(n),r=d(0,0,m,m,m,m,m,i,a)),0<=t&&t<=5&&(r=d(1,t,u,l)).integerValue(n),(s=new I(r)).type(n?1:2),s.comparisonOperator(t),s}function V(t,e,o,n,r){var i,a,s,l,u,c=m,h=m,f=m,p=m;if(F(e)?c=g(e,"="):h=e,F(o)?f=g(o,"="):p=o,i=m,6===t&&(a=d(n,5,h,c),s=d(n,3,p,f),i=d(0,1,m,m,m,m,m,a,s)),7===t&&(a=d(n,2,h,c),s=d(n,4,p,f),i=d(0,0,m,m,m,m,m,a,s)),0<=t&&t<=5){switch(t){case 0:l=0;break;case 1:l=1;break;case 2:l=4;break;case 3:l=5;break;case 4:l=2;break;case 5:l=3}i=d(n,l,h,c)}return(u=new I(i)).type(r),u.comparisonOperator(t),u}function z(t,e,o){return V(t,e,o,5,4)}function W(t,e,o){return V(t,e,o,13,5)}function G(t,e,o){var n,r,i,a,s=m,l=m,u=m,c=m;return F(e)?s=g(e,"="):l=e,F(o)?u=g(o,"="):c=o,n=m,6===t&&(r=d(7,3,l,s),i=d(7,5,c,u),n=d(0,1,m,m,m,m,m,r,i)),7===t&&(r=d(7,4,l,s),i=d(7,2,c,u),n=d(0,0,m,m,m,m,m,r,i)),0<=t&&t<=5&&(n=d(7,t,l,s)),(a=new I(n)).type(6),a.comparisonOperator(t),a}function U(t){if(!a)return m;var e=new I(d(4,m,m,g(t,"="),4));return e.type(7),e}function J(t){if(!a)return m;var e=new I(r.Condition.fromFormula(t));return e.type(3),e}function Z(t){var e=new I(r.Condition.fromSource(t));return e.type(3),e}function q(t,e){if(t&&e&&e.length)return e.map(function(t){return this.Tq(t)}.bind(t))}function K(t,e){var s=t.getRowCount(),l=t.getColumnCount();return e.map(function(t){return o=s,n=l,r=(e=t).rowCount,i=e.colCount,a=P(e.row,e.col,r,i),0===e.row&&r===o&&(a.row=-1),0===e.col&&i===n&&(a.col=-1),a;var e,o,n,r,i,a})}function Y(t,e){var o,n,r,i,a,s,l,u,c=e.Eja;for(n=0,r=t.row,i=t.rowCount;n<i;n++,r++)if(o=c[r])for(a=0,s=t.col,l=t.colCount;a<l;a++,s++)(u=o[s])&&u.IW(t,e),o[s]=f}function Q(t){var e,o,n=[];if(t)for(e in t)(o=t[e])&&n.push(o);return n}function X(t){this.WS=t,this.Dja={},this.Eja={},this.SAb=[]}Object.defineProperty(e,"__esModule",{value:!0}),l=o("@grapecity/js-sheets-common"),n=o("Core"),r=o("ConditionalFormatting"),u=o("SheetsCalc"),i=o("@grapecity/js-calc"),a=!!i,d=r.$V,g=l.Common.u.Db,h=l.Common.j.Fa,s=l.Common.j.C4,c=n.GC$,m=null,f=void 0,y=(p=n.Ul).Pl,b=p.Ol,v=p.T$a,P=n.kf,L=Math.min,H=Math.max,C=l.Common.l,w=".validator",x={type:0,color:"red"},T={type:1,color:"red",position:1},A={type:2,color:"red",position:5,image:null},S=window,(_=e.CriteriaType||(e.CriteriaType={}))[_.anyValue=0]="anyValue",_[_.wholeNumber=1]="wholeNumber",_[_.decimalValues=2]="decimalValues",_[_.list=3]="list",_[_.date=4]="date",_[_.time=5]="time",_[_.textLength=6]="textLength",_[_.custom=7]="custom",(j=e.DataValidationResult||(e.DataValidationResult={}))[j.forceApply=0]="forceApply",j[j.discard=1]="discard",j[j.retry=2]="retry",(D=e.ErrorStyle||(e.ErrorStyle={}))[D.stop=0]="stop",D[D.warning=1]="warning",D[D.information=2]="information",(E=e.HighlightType||(e.HighlightType={}))[E.circle=0]="circle",E[E.dogEar=1]="dogEar",E[E.icon=2]="icon",(k=e.HighlightPosition||(e.HighlightPosition={}))[k.topLeft=0]="topLeft",k[k.topRight=1]="topRight",k[k.bottomRight=2]="bottomRight",k[k.bottomLeft=3]="bottomLeft",k[k.outsideLeft=4]="outsideLeft",k[k.outsideRight=5]="outsideRight",M=["errorStyle","ignoreBlank","preciseCompareDate","inCellDropdown","showInputMessage","showErrorMessage","inputTitle","errorTitle","inputMessage","errorMessage","comparisonOperator","type","condition"],O.prototype.value1=function(t,e){var o,n=this.condition(),r=n&&n.item1()?n.item1():n;return r?(o=r.formula(t,e))&&0<o.length?"="+g(c.trim(""+o),"="):r.expected():m},O.prototype.value2=function(t,e){var o,n=this.condition(),r=n&&n.item2()?n.item2():n;return r?(o=r.formula(t,e))&&0<o.length?"="+g(c.trim(""+o),"="):r.expected():m},O.prototype.isValid=function(t,e,o,n){var r,i,a,s=this.condition();if(s){if(this.ignoreBlank()&&(h(n)||""===n))return!0;if(i=void 0,!h(r=n))switch(this.type()){case 0:return!0;case 2:case 1:i=function(t){if(h(t))return 0;if("number"==typeof t)return t;if("string"==typeof t){var e=parseFloat(t);if(!isNaN(e)&&""+e===t)return e}return m}(n),h(i)||(r=i);break;case 4:case 5:i=function(t){var e,o,n,r;if(t instanceof Date)return t;if("string"!=typeof t)return"number"==typeof t&&!isNaN(t)&&(e=l.Common.l.Xb(t))||m;if(!(e=l.Common.l.Qa(t)))if(isNaN(t)){if(e=new Date(t),isNaN(e.valueOf()))return m;try{if(o=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,n=l.Common.u.ib(l.Common.u.Db(t.replace(/ |\n/g,"")," ")," "),(r=o.exec(n))&&4===r.length&&(-1===r.indexOf(""+e.getFullYear())||-1===r.indexOf(""+e.getMonth())||-1===r.indexOf(""+e.getDate())))return m}catch(t){return m}}else if(!(e=l.Common.l.Xb(parseFloat(t))))return m;return e}(n),h(i)||(r=i)}t&&(t.lRa=!0),a=void 0;try{a=s.evaluate(t,e,o,r,r)}catch(t){a=!0}finally{t&&(t.lRa=!1)}return a}return!0},O.prototype.reset=function(){var t=this;t.errorStyle(0),t.ignoreBlank(!0),t.preciseCompareDate(!1),t.inCellDropdown(!0),t.showInputMessage(!0),t.showErrorMessage(!0),t.inputTitle(""),t.errorTitle(""),t.inputMessage(""),t.errorMessage(""),t.comparisonOperator(6),t.type(0),t.condition(m),t.n5.length=0},O.prototype.getValidList=function(t,e,o){var n=this.condition();return n!==m&&3===this.type()&&12===n.conType()?n.getValidList(t,e,o):m},O.prototype.highlightStyle=function(t){var e,o;if(0===arguments.length)return this.QAb;if(!h(t)){if(this.QAb.type!==t.type)switch(t.type){case 1:this.QAb=s(T);break;case 2:this.QAb=s(A);break;default:this.QAb=s(x)}for(o in e=this.QAb)e.hasOwnProperty(o)&&t.hasOwnProperty(o)&&(e[o]=t[o]);return this.kj&&this.kj.repaint(),this}},O.prototype.toJSON=function(o){var t,n=this,r={};return M.forEach(function(t){var e=n[t]();n[t].isDefault(e)||(r[t]=e&&e.toJSON?e.toJSON(o):e)}),t=n.n5.map(function(t){return-1===t.row&&-1===t.col?P(-1,0,t.rowCount,t.colCount):t}),r.ranges=u.rangesToFormula(t,0,0,15,!1),r.highlightStyle=JSON.stringify(n.QAb),c.isEmptyObject(r)?f:r},O.prototype.fromJSON=function(r,i,a){var s,t,e,o,n;r&&!c.isEmptyObject(r)&&(s=this,r.ranges&&(s.n5=u.formulaToRanges(a,r.ranges,0,0,!0)[0].ranges),r.highlightStyle&&(s.QAb=JSON.parse(r.highlightStyle)),M.forEach(function(t){var e,o,n=r[t];b(n)&&("condition"===t?((e=d()).fromJSON(r.condition,a,i),s.condition(e,!1),(o=e.ranges())&&o.length?s.n5=o:e.ranges(s.n5),e.context(a)):s[t](n,!1))}),(t=r.validatorInfo)&&(e=a.Wu.useR1C1,o=function(t,e){var o,n,r;if(!h(t))return 1===t||2===t?o=B(e.operator,e.value1,e.value2,1===t):3===t?e.value?o=Z(e.value):e.formula&&(o=J(e.formula)):4===t||5===t?(n=e.value1,r=e.value2,n&&"/OADate("===n.substr(0,8)&&(n=C.Rka(n)),r&&"/OADate("===r.substr(0,8)&&(r=C.Rka(r)),o=(5===t?W:z)(e.operator,n,r)):6===t?o=G(e.operator,e.value1,e.value2):7===t&&void 0!==e.formula&&(o=U(e.formula)),o?o.condition():void 0}(r.type,t),n=t.operator,o&&(o.ranges(s.n5),o.ignoreBlank(s.ignoreBlank()),o.context(a),e&&v(o),s.condition(o)),h(n)||s.comparisonOperator(n)))},O.prototype.clone=function(t){var e,o;return this.Nja?((e=this.condition())&&e.initExpression(),this):((o=new O).fromJSON(this.toJSON(t),!1,t||this.kj),o.n5=[],o)},O.prototype.context=function(t){if(t){this.xc=t;var e=this.condition();e&&(e.ranges(this.n5),e.context(t))}return this.xc},O.prototype.xja=function(t){var e,o;if(t){for(e=this.n5,o=0;o<e.length;o++)if(e[o].containsRange(t))return;e.push(t)}},O.prototype.IW=function(t,e){var k,E,D,j,_,O,o,F,n=this.n5;t&&n.length&&(k=t.row,E=t.col,D=t.rowCount,j=t.colCount,O=!(_=[]),o=this.kj,F=o&&[o.getRowCount(),o.getColumnCount()],n.forEach(function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R=(o=k,n=E,r=D,i=j,a=F,(e=t).intersect(o,n,r,i)?(s=e.rowCount,l=e.colCount,u=H(0,e.row),c=H(0,e.col),p=f=h=!1,o=H(0,o),n=H(0,n),d=(a=a||[-1,-1])[0],g=a[1],-1===s&&(s=d-u,f=!0),-1===l&&(l=g-c,h=!0),-1===r&&(r=d-o),-1===i&&(i=g-n,p=!0),y=(m=u)+s-1,v=(b=c)+l-1,w=(C=o)+r-1,T=(x=n)+i-1,A=[],-1!==m&&-1!==b&&-1!==C&&-1!==x&&(0<x-b&&(S=P(m,b,f?-1:s,x-b),A.push(S)),0<v-T&&(M=P(m,1+T,f?-1:s,v-T),A.push(M)),0<C-m&&(I=P(m,H(x,b),C-m,h&&p?-1:L(T,v)-H(x,b)+1),A.push(I)),0<y-w&&(N=P(1+w,H(x,b),y-w,h&&p?-1:L(T,v)-H(x,b)+1),A.push(N))),A.PAb=!0,A):[e]);R.PAb&&(O=!0),_.push(R)}),this.n5=[].concat.apply([],_),O&&e.RAb(this))},O.prototype.l1=function(){return this.n5},O.prototype.yyb=function(){this.condition()&&this.condition().initExpression()},O.prototype.YXc=function(t){this.condition()&&this.condition().ranges(t)},O.prototype.XXc=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p=!1;for(this.yyb(),r=0,i=(n=this.n5).length;r<i;r++)s=(a=n[r]).row,l=a.rowCount,u=a.col,c=a.colCount,h=s===t.row&&l===t.rowCount&&t.col<=u&&c<=t.colCount,f=s===e.row&&l===e.rowCount&&e.col<=u&&c<=e.colCount,(h||f)&&(n[r]=P(s,u,l+o,c),p=!0);return p&&this.YXc(n),p},O.prototype.rI=function(t,e,o){var n,r,i,a,s,l,u;if(!(t<0||e<=0)){for(this.condition()&&this.condition().initExpression(),n=0;n<this.n5.length;n++){if(i=(r=this.n5[n]).row,o&&0<o.length){for(a=!1,s=0,l=o.length;s<l;s++)if((u=o[s])&&u.row===r.row&&u.row+u.rowCount-e===r.row+r.rowCount&&r.row===t){r.rowCount+=e,a=!0;break}if(a)break}t<=i?r.row+=e:t<=i+r.rowCount&&(r.rowCount+=e)}this.condition()&&this.condition().ranges(this.n5)}},O.prototype.GR=function(r,i){if(!(r<0||i<=0)){this.condition()&&this.condition().initExpression();var a=[];this.n5.forEach(function(t){var e,o=t.row,n=t.rowCount;r<o?((e=r+i-o)<=0?o-=i:(o-=e,t.rowCount-=e),o<0&&(t.rowCount+=o,o=0),t.row=o):o<=r&&r<o+n&&(t.rowCount-=L(i,o+n-r)),(0<t.rowCount||-1===t.row&&-1===t.rowCount)&&a.push(t)}),this.n5=a,this.condition()&&this.condition().ranges(this.n5)}},O.prototype.tI=function(t,e,o){var n,r,i,a,s,l,u,c;if(!(t<0||e<=0)){for(this.condition()&&this.condition().initExpression(),n=0;n<this.n5.length;n++){if(r=this.n5[n],o&&0<o.length){for(a=i=!1,s=0,l=o.length;s<l;s++)if(!(u=o[s])||u.containsRange(r)){if(u&&u.col===r.col&&u.col+u.colCount-e===r.col+r.colCount&&u.col===t){r.colCount+=e,a=!0;break}}else i=!0;if(i)continue;if(a)break}t<=(c=r.col)?r.col+=e:t<=c+r.colCount&&(r.colCount+=e)}this.condition()&&this.condition().ranges(this.n5)}},O.prototype.HR=function(r,i){if(!(r<0||i<=0)){this.condition()&&this.condition().initExpression();var a=[];this.n5.forEach(function(t){var e,o=t.col,n=t.colCount;r<o?((e=r+i-o)<=0?o-=i:(o-=e,t.colCount-=e),o<0&&(t.colCount+=o,o=0),t.col=o):o<=r&&r<o+n&&(t.colCount-=L(i,o+n-r)),(0<t.colCount||-1===t.col&&-1===t.colCount)&&a.push(t)}),this.n5=a,this.condition()&&this.condition().ranges(this.n5)}},O.w$=1,I=O,e.DefaultDataValidator=I,N={errorStyle:y("errorStyle",0),ignoreBlank:y("ignoreBlank",!0,function(t){this.condition()&&this.condition().ignoreBlank(t)}),preciseCompareDate:y("preciseCompareDate",!1,function(t){this.condition()&&this.condition().preciseCompareDate(t)}),inCellDropdown:y("inCellDropdown",!0),showInputMessage:y("showInputMessage",!0),showErrorMessage:y("showErrorMessage",!0),inputTitle:y("inputTitle",""),errorTitle:y("errorTitle",""),inputMessage:y("inputMessage",""),errorMessage:y("errorMessage",""),comparisonOperator:y("comparisonOperator",6),condition:y("condition",m),type:y("type",0)},c.extend(I.prototype,N),e.zW=function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMOSURBVHjaXJNdaJRHFIbfM7PfGremUTfkpxgpiheiBOmFtYUgRXNRqNnd75sEhBoIKhrwQpFUUSsihhIQ41+FNrUGqYhRY43STZqgARNRTIzRaFqz6xJTtals3K8xRQ3x7UV215+LB2bOxTNn3jMDs+mEIgmS+LwQiqSQ9JG03FHX54666pn7TLmJEZVIjCCRGMkYGxvNiI9FvaENZzLw/PmqtCDFV/4WkERw8TI03K6XqqrNWLBgPoafDmNwMCbd3TestpMDHpJAuIcWSZjSUrnS0SFOWamXJLpuDYAkAiYAkioYDCIej0+Lx12QrervFxOemjWfCvIyIcmTVeLVC1986OkUklhRtlgutLYrkpnOKlt1dl0BSfTHmnCnm5oTm0AS6I0xLaDLrK1PusTp/cb7/rUAyH8kSL+Vqt0ebpuGP699LCRROAdqf/suGforCpLi4DMpAOQQLAEgfE2sRDZIv5cknGxi74HDFnZ/32olk9f//vOTPIj05ZnKZpp14QlnfZgpTOXvNGsvjrvuH9MnOwAOYlhQ/UPYmxRkJVvzPHw8JF8EdrKoZEeapSt2cHDo4Sxn7R0hiV8/hEQe3Ad21jZNJQnbDklSBBas0ddvRj2Fi4qZIhaL+Q3ni8N0ZohGe4Dv6sKZfFP0kvkSWLZdGvLpiUTuTS9cVMxI5H5+fz+UfXyOto/Ns5bUL7dyjsBjTsKDbbVnM0iqYNHXYi9ZLiSlaRbFn089zlzvwN1IzkDlmDhfdiin5KgOBY5qO9iojX1K9+VRcOCXnlySsFkOkjj/WGschtR0Kt/Ga9D2aYj5DWKaIeYSxTlFMS2T66udBDbXHS94Z97ZUB8Ayt7+iVVddlkzl5LCvrklvQ9dr1fnF0IQbng5O/VQsmAJSfnxSLuqCG3Rxxpfz3xbXv0IEkzm5YR7lXOCGs6+PVNJYjaQnoKwSgBIDSqkjjPUuv3QLP9ImW+hG1/lKJtzp5jaCmW2nrNAUpOUkqrWrJUb23T5rhZf0eoWhbeEKX7O4eTPHe8DSTjF59T/AwCfnhbaDaIICgAAAABJRU5ErkJggg=="},e.bW=F,e.createNumberValidator=B,e.createDateValidator=z,e.createTimeValidator=W,e.createTextLengthValidator=G,e.createFormulaValidator=U,e.createFormulaListValidator=J,e.createListValidator=Z,c.extend(n.Worksheet.prototype,{getDataValidator:function(t,e,o){var n=this.dMc(t,e,o);return n?n[0]:f},dMc:function(t,e,o){return h(o)&&(o=3),3===o?this.uja.Aja(t,e):f},setDataValidator:function(t,e,o,n,r,i){var a,s,l,u,c=this.uja;if(arguments.length<5&&(r=o,i=n,o=-1===t?-1:1,n=-1===e?-1:1),h(i)&&(i=3),3===i){if(a=this.getDataValidator(t,e,i),(s=1===o&&1===n)&&a===r)return;this._modelManager.zVa(),l=P(t,e,o,n),c.Cja(l),r&&c.Bja(r,l),u="validator",s&&(this.Bq(u,t,e,i,a,r),-1!==t&&-1===e?this.kq(t,i,u,r,a):-1===t&&-1!==e&&this.pq(e,i,u,r,a)),this.$p()}},isValid:function(t,e,o){var n,r=this;try{if(r.Ku=t,r.Lu=e,r.Mu=o,r.Ju=!0,n=r.getDataValidator(t,e))return n.isValid(r,t,e,o)}finally{r.Ku=-1,r.Lu=-1,r.Mu=m,r.Ju=!1}return!0},hm:function(){var t,e,o,n;return!this.x$&&(this.x$=!0,(t=this.KH)&&((e=t.parentNode)&&e.removeChild(t),this.KH=m),(o=this.y$)&&(c(o).unbind("click"),(e=o.parentNode)&&e.removeChild(o),this.y$=m),(n=this.lm)&&(c(n).unbind("keydown").unbind("blur").unbind("click").unbind("change"),(e=n.parentNode)&&e.removeChild(n),this.lm=m),!(this.x$=!1))},tja:function(){var t,e,o,n=[],r=this.uja,i=r&&r.Dja;if(i)for(t in i)(o=(e=i[t])&&e.condition())&&o.getExpressions&&0<o.getExpressions().length&&n.push({validator:e,sheet:this});return n}}),c.extend(n.Workbook.prototype,{tja:function(){var o=[];return this.sheets.forEach(function(t){var e=t.tja();e&&e.length&&e.forEach(function(t){o.push(t)})}),o}}),c.extend(n.CellRange.prototype,{validator:function(t){var e=this.sheet,o=this.sheetArea,n=this.row,r=this.col,i=this.rowCount,a=this.colCount;return 0===arguments.length?e.getDataValidator(n,r,o):(e.setDataValidator(n,r,i,a,t,o),this)}}),X.prototype.no=function(){this.WS=m},X.prototype.UV=function(t){return q(this.WS,t)},X.prototype.EW=function(t){return K(this.WS,t)},X.prototype.QV=function(t){var e,o,n=this.Dja;if(this.Eja={},n)for(e in n)(o=n[e])&&(t&&delete o.yja,this.FW(o,!0));this.Fja()},X.prototype.RAb=function(t){var e=this.SAb;-1===e.indexOf(t)&&e.push(t)},X.prototype.FW=function(e,t){var o=this,n=o.UV(e.l1()),r=o.WS,i=r.getRowCount(),a=r.getColumnCount();n&&(o.SAb.length=0,n.forEach(function(t){!function(t,e,o,n,r){var i,a,s,l,u,c,h=n.Eja,f=t.row,p=t.col,d=t.rowCount,g=t.colCount;for(e<=f+d-1&&(d=e-f),o<=p+g-1&&(g=o-p),i=0,a=f;i<d;i++,a++)for((s=h[a])||(h[a]=s={}),l=0,u=p;l<g;l++,u++)(c=s[u])&&c!==r&&c.IW(t,n),s[u]=r}(t,i,a,o,e)}),t||o.Fja())},X.prototype.GW=function(t){var e=this,o=e.UV(t.l1());e.SAb.length=0,o.forEach(function(t){Y(t,e)}),e.Fja()},X.prototype.HW=function(t){t&&Y(this.WS.Tq(t),this),this.Fja()},X.prototype.Fja=function(){var e,t=this.SAb;t.length&&(e=this.Dja,t.forEach(function(t){t.l1().length?t.condition()&&t.condition().ranges(t.l1()):(delete e[t.id],delete t.kj)}),t.length=0)},X.prototype.Bja=function(t,e){var o=this.WS;if(e&&(t.kj&&o!==t.kj&&(t=t.clone(o)),t.kj=o,t.xja(e)),o)return t.context(o),this.Dja[t.id]=t,this.FW(t),t},X.prototype.Cja=function(t){if(t){var e=this.WS;this.HW(t),e.$p()}},X.prototype.$b=function(){this.WS&&(this.Dja={},this.QV())},X.prototype.Aja=function(t,n){var r,e,o,i=this.Dja;return 0===arguments.length?Q(i):(r=[],e=this.Eja,t===f&&(t=-1),n===f&&(n=-1),-1===t&&-1===n?Q(i):(-1!==t&&-1!==n?(o=e[t])&&o[n]&&r.push(o[n]):-1===t?c.each(e,function(t,e){var o=e[n];o&&-1===r.indexOf(o)&&r.push(o)}):(o=e[t])&&c.each(o,function(t,e){e&&-1===r.indexOf(e)&&r.push(e)}),r))},X.prototype.XXc=function(t,e,o){var n,r,i=this.WS._modelManager,a=this.Dja,s=!1;if(!h(a)){for(n in i.zVa(),a)(r=a[n])&&r.XXc(t,e,o)&&(s=!0);s&&this.QV()}},X.prototype._V=function(t,e,o,n){var r,i,a=this.Dja;if(a)for(r in a)(i=a[r])&&(o?i.rI(t,e,n):i.tI(t,e,n));this.QV()},X.prototype.rI=function(t,e,o){this._V(t,e,!0,o)},X.prototype.tI=function(t,e,o){this._V(t,e,!1,o)},X.prototype.aW=function(t,e,o){var n,r,i=this.Dja;if(i)for(n in i)(r=i[n])&&(o?r.GR(t,e):r.HR(t,e),0===r.n5.length&&(i[n]=f));this.QV()},X.prototype.GR=function(t,e){this.aW(t,e,!0)},X.prototype.HR=function(t,e){this.aW(t,e,!1)},X.prototype.toJSON=function(t){var e,o,n=this.Dja,r=[];for(e in n)(o=n[e])&&r.push(o.toJSON(t));return r},X.prototype.fromJSON=function(t,o,n){var r=this,i=r.WS;r.Dja={},t&&t.length&&(t.forEach(function(t){var e=new I;e.fromJSON(t,o,n),e.kj=i,r.Dja[e.id]=e}),r.QV())},X.prototype.vja=function(t,e,o){this.WS.setDataValidator(t,e,o)},R=X,c.extend(n.lUa.prototype,{zVa:function(){var t,e,o,n,r,i=this.zTa;if(i&&!i.AVa){for(o in e=[],t=this.uja.Dja)(n=t[o])&&(r=n.n5.map(function(t){return P(t.row,t.col,t.rowCount,t.colCount)}),e.push({validator:n,ranges:r}));i.AVa=e}},BVa:function(t){var e,o;t&&(e=this.uja,o={},t.forEach(function(t){var e=t.validator;e.n5=t.ranges,e.condition()&&e.condition().ranges(e.n5),o[e.id]=e}),e.Dja=o,e.QV(!1))},CVa:function(t,e,o){this.zVa(),this.uja.rI(t,e,o)},DVa:function(t,e){this.zVa(),this.uja.GR(t,e)},EVa:function(t,e,o){this.zVa(),this.uja.tI(t,e,o)},FVa:function(t,e){this.zVa(),this.uja.HR(t,e)},GVa:function(t){this.zVa(),this.uja.HW(t)},HVa:function(){this.zVa(),this.uja.QV()}}),n.lUa.$n("validator",{init:function(){this.uja=new R(this.kj)},undo:function(t){var e=t.AVa;e&&this.BVa(e)},dispose:function(t){!1!==(t&&t.clearCache)&&this.uja&&(this.uja.no(),this.uja=m)}}),n.Worksheet.$n("validator",{init:function(){var o=this;o.uja=o._modelManager.uja,o._unbind(n.Events.FloatingElementSelected+w),o._bind(n.Events.FloatingElementSelected+w,function(t,e){"worksheet"!==e.type&&o.hm()})},dispose:function(t){this.hm(),t.clearCache&&this.uja.$b(),!1!==t.clearCache&&this._unbind(n.Events.FloatingElementSelected+w)},onLayoutChanged:function(t){var e=t.changeType,o=t.row,n=t.rowCount,r=t.col,i=t.colCount,a=t.sheetArea,s=this._modelManager,l=this.tables;"addRows"===e?s.CVa(o,n,l&&l.KFc(o,-1,n,-1,!0)):"deleteRows"===e?s.DVa(o,n):"addColumns"===e?s.EVa(r,i,l&&l.KFc(-1,r,-1,i,!1)):"deleteColumns"===e?s.FVa(r,i):"clear"===e?3===a&&2==(2&t.type)&&s.GVa(P(o,r,n,i)):"setColumnCount"!==e&&"setRowCount"!==e||3!==a&&1!==a||s.HVa()},toJson:function(t,e){var o,n=this.uja,r=e&&e.ignoreStyle;!n||r||(o=n.toJSON(this))&&o.length&&(t.validations=o)},fromJson:function(t,e,o){var n,r=o&&o.ignoreStyle;t&&t.validations&&!r&&(n=t.validations,this.uja.fromJSON(n,e,this))}}),n.Style.$n("validator",{fromJson:function(t){if("validator"===t.p){var e=new I;e.fromJSON(t.v,t.noSchema,t.context),this.validator=e,t.r=!0}}}),S.Yl.km.push(function(t,e){!e&&t.hm&&t.hm()})},"./node_modules/process/browser.js":function(t,e){var o,n,r,i,a,s,l=t.exports={};function u(){throw Error("setTimeout has not been defined")}function c(){throw Error("clearTimeout has not been defined")}function h(e){if(o===setTimeout)return setTimeout(e,0);if((o===u||!o)&&setTimeout)return o=setTimeout,setTimeout(e,0);try{return o(e,0)}catch(t){try{return o.call(null,e,0)}catch(t){return o.call(this,e,0)}}}function f(){i&&a&&(i=!1,a.length?r=a.concat(r):s=-1,r.length&&p())}function p(){var t,e;if(!i){for(t=h(f),i=!0,e=r.length;e;){for(a=r,r=[];++s<e;)a&&a[s].run();s=-1,e=r.length}a=null,i=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===c||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function g(){}!function(){try{o="function"==typeof setTimeout?setTimeout:u}catch(t){o=u}try{n="function"==typeof clearTimeout?clearTimeout:c}catch(t){n=c}}(),i=!(r=[]),s=-1,l.nextTick=function(t){var e,o=Array(arguments.length-1);if(1<arguments.length)for(e=1;e<arguments.length;e++)o[e-1]=arguments[e];r.push(new d(t,o)),1!==r.length||i||h(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=g,l.addListener=g,l.once=g,l.off=g,l.removeListener=g,l.removeAllListeners=g,l.emit=g,l.prependListener=g,l.prependOnceListener=g,l.listeners=function(t){return[]},l.binding=function(t){throw Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(t){throw Error("process.chdir is not supported")},l.umask=function(){return 0}},"./node_modules/util/node_modules/inherits/inherits_browser.js":function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;function o(){}o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t}},"./node_modules/util/support/isBufferBrowser.js":function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},"./node_modules/util/util.js":function(t,k,d){(function(a){var t,n,o,e,r=Object.getOwnPropertyDescriptors||function(t){var e,o=Object.keys(t),n={};for(e=0;e<o.length;e++)n[o[e]]=Object.getOwnPropertyDescriptor(t,o[e]);return n},s=/%[sdj%]/g;function l(t,e){var o={seen:[],stylize:u};return 3<=arguments.length&&(o.depth=arguments[2]),4<=arguments.length&&(o.colors=arguments[3]),C(e)?o.showHidden=e:e&&k.Ia(o,e),A(o.showHidden)&&(o.showHidden=!1),A(o.depth)&&(o.depth=2),A(o.colors)&&(o.colors=!1),A(o.customInspect)&&(o.customInspect=!0),o.colors&&(o.stylize=i),m(o,t,o.depth)}function i(t,e){var o=l.styles[e];return o?"["+l.colors[o][0]+"m"+t+"["+l.colors[o][1]+"m":t}function u(t,e){return t}function m(e,o,n){var t,r,i,a,s,l,u,c,h,f,p,d,g;if(e.customInspect&&o&&N(o.inspect)&&o.inspect!==k.inspect&&(!o.constructor||o.constructor.prototype!==o))return T(t=o.inspect(n,e))||(t=m(e,t,n)),t;if(r=function(t,e){if(A(e))return t.stylize("undefined","undefined");if(T(e)){var o="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(o,"string")}return x(e)?t.stylize(""+e,"number"):C(e)?t.stylize(""+e,"boolean"):w(e)?t.stylize("null","null"):void 0}(e,o))return r;if(i=Object.keys(o),f={},i.forEach(function(t,e){f[t]=!0}),a=f,e.showHidden&&(i=Object.getOwnPropertyNames(o)),I(o)&&(0<=i.indexOf("message")||0<=i.indexOf("description")))return y(o);if(0===i.length){if(N(o))return s=o.name?": "+o.name:"",e.stylize("[Function"+s+"]","special");if(S(o))return e.stylize(RegExp.prototype.toString.call(o),"regexp");if(M(o))return e.stylize(Date.prototype.toString.call(o),"date");if(I(o))return y(o)}return l="",u=!1,c=["{","}"],v(o)&&(u=!0,c=["[","]"]),N(o)&&(l=" [Function"+(o.name?": "+o.name:"")+"]"),S(o)&&(l=" "+RegExp.prototype.toString.call(o)),M(o)&&(l=" "+Date.prototype.toUTCString.call(o)),I(o)&&(l=" "+y(o)),0!==i.length||u&&0!=o.length?n<0?S(o)?e.stylize(RegExp.prototype.toString.call(o),"regexp"):e.stylize("[Object]","special"):(e.seen.push(o),h=u?function(e,o,n,r,t){var i,a,s=[];for(i=0,a=o.length;i<a;++i)R(o,i+"")?s.push(b(e,o,n,r,i+"",!0)):s.push("");return t.forEach(function(t){t.match(/^\d+$/)||s.push(b(e,o,n,r,t,!0))}),s}(e,o,n,a,i):i.map(function(t){return b(e,o,n,a,t,u)}),e.seen.pop(),d=l,g=c,60<(p=h).reduce(function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)?g[0]+(""===d?"":d+"\n ")+" "+p.join(",\n  ")+" "+g[1]:g[0]+d+" "+p.join(", ")+" "+g[1]):c[0]+l+c[1]}function y(t){return"["+Error.prototype.toString.call(t)+"]"}function b(t,e,o,n,r,i){var a,s,l;if((l=Object.getOwnPropertyDescriptor(e,r)||{value:e[r]}).get?s=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(s=t.stylize("[Setter]","special")),R(n,r)||(a="["+r+"]"),s||(t.seen.indexOf(l.value)<0?-1<(s=w(o)?m(t,l.value,null):m(t,l.value,o-1)).indexOf("\n")&&(s=i?s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n")):s=t.stylize("[Circular]","special")),A(a)){if(i&&r.match(/^\d+$/))return s;a=(a=JSON.stringify(""+r)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),t.stylize(a,"string"))}return a+": "+s}function v(t){return Array.isArray(t)}function C(t){return"boolean"==typeof t}function w(t){return null===t}function x(t){return"number"==typeof t}function T(t){return"string"==typeof t}function A(t){return void 0===t}function S(t){return c(t)&&"[object RegExp]"===h(t)}function c(t){return"object"==typeof t&&null!==t}function M(t){return c(t)&&"[object Date]"===h(t)}function I(t){return c(t)&&("[object Error]"===h(t)||t instanceof Error)}function N(t){return"function"==typeof t}function h(t){return Object.prototype.toString.call(t)}function f(t){return t<10?"0"+t.toString(10):t.toString(10)}function R(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function p(t,e){if(!t){var o=Error("Promise was rejected with a falsy value");o.reason=t,t=o}return e(t)}k.format=function(t){var e,o,n,r,i,a;if(!T(t)){for(e=[],o=0;o<arguments.length;o++)e.push(l(arguments[o]));return e.join(" ")}for(o=1,r=(n=arguments).length,i=(t+"").replace(s,function(t){if("%%"===t)return"%";if(r<=o)return t;switch(t){case"%s":return n[o++]+"";case"%d":return+n[o++];case"%j":try{return JSON.stringify(n[o++])}catch(t){return"[Circular]"}default:return t}}),a=n[o];o<r;a=n[++o])i+=w(a)||!c(a)?" "+a:" "+l(a);return i},k.deprecate=function(t,e){if(void 0!==a&&!0===a.noDeprecation)return t;if(void 0===a)return function(){return k.deprecate(t,e).apply(this,arguments)};var o=!1;return function(){if(!o){if(a.throwDeprecation)throw Error(e);a.traceDeprecation?console.trace(e):console.error(e),o=!0}return t.apply(this,arguments)}},t={},k.debuglog=function(e){if(A(n)&&(n=a.env.NODE_DEBUG||""),e=e.toUpperCase(),!t[e])if(RegExp("\\b"+e+"\\b","i").test(n)){var o=a.pid;t[e]=function(){var t=k.format.apply(k,arguments);console.error("%s %d: %s",e,o,t)}}else t[e]=function(){};return t[e]},(k.inspect=l).colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},l.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},k.isArray=v,k.isBoolean=C,k.isNull=w,k.isNullOrUndefined=function(t){return null==t},k.isNumber=x,k.isString=T,k.isSymbol=function(t){return"symbol"==typeof t},k.isUndefined=A,k.isRegExp=S,k.isObject=c,k.isDate=M,k.isError=I,k.isFunction=N,k.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},k.isBuffer=d("./node_modules/util/support/isBufferBrowser.js"),o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],k.log=function(){var t,e;console.log("%s - %s",(t=new Date,e=[f(t.getHours()),f(t.getMinutes()),f(t.getSeconds())].join(":"),[t.getDate(),o[t.getMonth()],e].join(" ")),k.format.apply(k,arguments))},k.inherits=d("./node_modules/util/node_modules/inherits/inherits_browser.js"),k.Ia=function(t,e){var o,n;if(!e||!c(e))return t;for(n=(o=Object.keys(e)).length;n--;)t[o[n]]=e[o[n]];return t},e="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0,k.promisify=function(i){if("function"!=typeof i)throw new TypeError('The "original" argument must be of type Function');if(e&&i[e]){var t;if("function"!=typeof(t=i[e]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,e,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){var o,n,t,e=new Promise(function(t,e){o=t,n=e}),r=[];for(t=0;t<arguments.length;t++)r.push(arguments[t]);r.push(function(t,e){t?n(t):o(e)});try{i.apply(this,r)}catch(o){n(o)}return e}return Object.setPrototypeOf(t,Object.getPrototypeOf(i)),e&&Object.defineProperty(t,e,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(i))},k.promisify.custom=e,k.callbackify=function(i){if("function"!=typeof i)throw new TypeError('The "original" argument must be of type Function');function t(){var t,e,o,n,r=[];for(t=0;t<arguments.length;t++)r.push(arguments[t]);if("function"!=typeof(e=r.pop()))throw new TypeError("The last argument must be of type Function");o=this,n=function(){return e.apply(o,arguments)},i.apply(this,r).then(function(t){a.nextTick(n,null,t)},function(t){a.nextTick(p,t,n)})}return Object.setPrototypeOf(t,Object.getPrototypeOf(i)),Object.defineProperties(t,r(i)),t}}).call(this,d("./node_modules/process/browser.js"))},"./node_modules/webpack/buildin/global.js":function(t,e){var o;o=function(){return this}();try{o=o||Function("return this")()}catch(t){"object"==typeof window&&(o=window)}t.exports=o},"./node_modules_local/@grapecity/js-calc-advancedfunctions/dist/gc.spread.calcengine.advancedfunctions.js":function(t,e,o){var n,r,i="object"==typeof i?i:{};function a(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,a),e.l=!0,e.exports}i.Spread=i.Spread||{},i.Spread.CalcEngine=i.Spread.CalcEngine||{},i.Spread.CalcEngine.AdvancedFunctions=(r={},a.m=n={"./src/advancedFunctions.entry.ts":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("CalcEngine");e.Functions=n.Functions,o("./src/functions-db.ts"),o("./src/functions-eng.ts"),o("./src/functions-fin.ts"),o("./src/functions-lookup.ts"),o("./src/functions-stat.ts")},"./src/functions-db.ts":function(t,e,o){"use strict";var a,l,m,g,y,b,v,C,w,n,x,T,r,A,i,s,S,u,c,h;function f(t,e,o){this.Gk=t,this.Hk=e,this.Wob=o}function p(t,e,o){var n=this;if(n.cj=0,n.Jk=t,n.Kk=o,n.Xob={},3===arguments.length){if(n.Lk=n.Mk(t,e),t.rowCount<2||t.colCount<1||o.rowCount<2||o.colCount<1||n.Lk<0||n.Jk.colCount<=n.Lk)throw i}else if(2===arguments.length&&(n.Lk=-1,t.rowCount<2||t.colCount<1||o.rowCount<2||o.colCount<1))throw i}function d(t,e,o,n){for(var r,i=0,a=new S(t,e,o);a.Pk();)r=a.Ok(),(r=n?y(r):r)&&i++;return v(i)}function M(t,e,o,n,r,i,a){for(var s,l,u,c,h=a?1:0,f=0,p=0,d=new S(t,e,o);d.Pk();)if(s=d.Ok(),y(s)){if(l=g(s),T(l))return w;h=a?h*l:h+l,f+=l*l,p++}else if(b(s))return s;return i||a?v(h):(u=Math.max(0,(p*f-h*h)/(p*(p-r))),c=n?Math.sqrt(u):u,p<=1?C:v(c))}Object.defineProperty(e,"__esModule",{value:!0}),a=o("Common"),l=o("CalcEngine"),m=a.Common.q,g=l.Convert.Pa,y=l.Convert.Na,b=l.Convert.vf,v=l.Convert.Nh,C=l.Errors.DivideByZero,w=l.Errors.Value,n=l.Functions.ak,x=l.Functions.jk,T=isNaN,r=a.Common.u,A=r.kb,i=l.sR().Exp_InvalidCast,f.prototype.Ik=function(t){var e=l.evaluateOperator({"=":9,"<>":10,"<":11,"<=":12,">":13,">=":14}[this.Gk],t,this.Hk);return!!l.Functions.ik(e)&&l.Convert.Vh(e)},s=f,p.prototype.Mk=function(t,e){var o,n;if(x(e)){for(o=0;o<t.colCount;o++)if((n=l.Convert.bc(t[0][o]))&&this.Nk(n,e))return o;return-1}return l.Convert.Rh(e)-1},p.prototype.Ok=function(){if(this.cj<=0||this.Jk.rowCount<=this.cj)throw l.sR().Exp_InvalidOperation;return this.Jk[this.cj][this.Lk]},p.prototype.Pk=function(){for(var t=!1,e=this.Jk.rowCount;!t&&this.cj<e;)this.cj++,this.cj<e&&(t=this.Qk());return t},p.prototype.Rk=function(t){var e,o,n,r,i;if(x(t)){for(e=["=","<>","<=",">=","<",">"],o=l.Convert.bc(t),r=n=void 0,n=0;n<e.length;n++)if(a.Common.u.kb(o,e[n]))return o=o.substring(e[n].length),i=a.Common.o.lb(o),T(i)?this.Nk("true",o)?t=!0:this.Nk("false",o)?t=!1:(t=o,r=0===n):t=i,new s(e[n],t,r);return new s("=",t)}return t?new s("=",t):null},p.prototype.Yob=function(t,e){var o,n=this.Xob,r=[t,e].join(","),i=n[r];return i||n[o="_"+r]||(i=n[r]=this.Rk(this.Kk[t][e]),n[o]=!0),i},p.prototype.Qk=function(){var t,e,o,n,r,i,a,s,l,u=!1,c=this.Kk,h=this.cj,f=c.rowCount,p=c.colCount,d=this.Jk,g=this.Zob;if(!g){for(n=c[0],g=[],e=0;e<p;e++){if((o=this.Mk(d,n[e]))<0)return!1;g[e]=o}this.Zob=g}for(t=1;!u&&t<f;t++)for(u=!0,e=0;u&&e<p;e++)if(r=this.Yob(t,e)){if(i=d[h][g[e]],"="===r.Gk&&(a=r.Hk,x(a)&&x(i))){s=m.ub(a,!0),l=r.Wob,u=s?m.sb("^"+s+(l?"$":"")).test(i):l?i.toLowerCase()===a.toLowerCase():A(i,a,!0);continue}u=r.Ik(i)}return u},p.prototype.Nk=function(t,e){return t.toLowerCase()===e.toLowerCase()},S=p,n("DAVERAGE",function(t,e,o){for(var n,r,i=0,a=0,s=new S(t,e,o);s.Pk();){if(n=s.Ok(),b(n))return n;if(y(n)){if(r={value:0},!l.Convert.Th(n,r))return w;i+=r.value,a++}}return 0===a?C:v(i/a)},3,3,h=[c={Yi:!0,Hi:4,Ii:0},{Yi:!0},c],u="!= 1",u),n("DCOUNT",function(t,e,o){return d(t,e,o,!0)},3,3,h,u,u),n("DCOUNTA",function(t,e,o){return d(t,e,o,!1)},3,3,h,u,u),n("DGET",function(t,e,o){var n,r=new S(t,e,o);return r.Pk()?(n=r.Ok(),r.Pk()?l.Errors.Number:n):w},3,3,h,u,u),n("DMAX",function(t,e,o){for(var n,r,i=!1,a=-l.Functions.hk,s=new S(t,e,o);s.Pk();){if(n=s.Ok(),b(n))return n;if(y(n)){if(r=g(n),T(r))return w;(!i||a<r)&&(a=r),i=!0}}return i?v(a):0},3,3,h,u,u),n("DMIN",function(t,e,o){for(var n,r,i=!1,a=l.Functions.hk,s=new S(t,e,o);s.Pk();){if(n=s.Ok(),b(n))return n;if(y(n)){if(r=g(n),T(r))return w;(!i||n<a)&&(a=n),i=!0}}return i?v(a):0},3,3,h,u,u),n("DPRODUCT",function(t,e,o){return M(t,e,o,!1,0,!1,!0)},3,3,h,u,u),n("DSTDEV",function(t,e,o){return M(t,e,o,!0,1)},3,3,h,u,u),n("DSTDEVP",function(t,e,o){return M(t,e,o,!0,0)},3,3,h,u,u),n("DSUM",function(t,e,o){return M(t,e,o,!1,0,!0)},3,3,h,u,u),n("DVAR",function(t,e,o){return M(t,e,o,!1,1)},3,3,h,u,u),n("DVARP",function(t,e,o){return M(t,e,o,!1,0)},3,3,h,u,u)},"./src/functions-eng.ts":function(t,e,o){"use strict";var n,p,M,r,v,j,_,O,F,d,i,a,s,P,l,I,f,u,c,h,L,g,m,y,b,C,w,x,T,A,S,N,R,k,E,D,H,B,V,z,W,G,U,J,Z,q,K,Y,Q,X,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ht,ft,pt,dt,gt,mt,yt,bt,vt,Ct,wt,xt,Tt,At,St,Mt,It,Nt,Rt,kt,Et,Dt,jt,_t,Ot,Ft,Pt;function Lt(t,e){return new p.Functions.Ui(t,e)}function Ht(t,e){return{Ld:t,_c:e}}function Bt(t,e){var o,n=[];for(o=0;o<M(t);o++)n.push(Ht(t[o],e[o]));return n.push(Ht(null,0)),n}function Vt(t,e,o){var n,r,i,a,s,l,u,c=100,h=.5*t,f=h*h;for(h=d(h,P(e)),n=p.Functions.tk(e),r=1,i=0,a=P(e),l=.9*(s=h/n),u=!1;s!==l&&0!==c;)h*=f,n*=++i,r*=++a,l=s,s=o||u?s+h/n/r:s-h/n/r,c--,u=!u;return s}function zt(t,e){var o=d(e,10),n=parseInt(t,e);return l(n)?f:o/2<=n?n-o:n}function Wt(t,e,o){t<0&&(t+=d(e,10));var n,r=t.toString(e),i=o-M(r);for(n=0;n<i;n++)r="0"+r;return r.toUpperCase()}function Gt(t,e){if(t<0)return f;var o=zt(t,e);return g(o)?f:o}function Ut(t,e,o){var n=Wt(t,o,e.Qb);return 0<=n&&e.Qb<M(n)&&e.$i?f:n}function Jt(t,e,o,n,r){var i,a;return t<0?f:(i=zt(t,o),g(i)||r&&(i<-r||r-1<i)?f:(a=Wt(i,n,e.Qb),0<=i&&e.Qb<M(a)&&e.$i?f:a))}function Zt(t,e){var o=Number.POSITIVE_INFINITY,n=t.Pi(),r=t.Qi();return l(n)||n===o||l(r)||r===o?f:t.bc(e)}function qt(t,e,o,n){var r=t,i=e,a=o.Pi(),s=o.Qi();return{Ri:t=n?r*a-i*s:r+a,Si:e=n?r*s+i*a:i+s}}function Kt(t,e){var o,n,r,i,a,s,l,u,c=e?1:0,h=0;for(n=0;n<M(t);n++)if(p.Convert.Ca(t[n]))for(l=t[n],r=0;r<l.rowCount;r++)for(i=0;i<l.columnCount;i++){if(!(o=b(l.getValue(r,i))))return f;c=(s=qt(c,h,o,e)).Ri,h=s.Si}else if(p.Convert._isReference(t[n]))for(u=t[n],a=0;a<u.getRangeCount();a++)for(r=0;r<u.getRowCount(a);r++)for(i=0;i<u.getColumnCount(a);i++){if(!(o=b(u.getValue(a,r,i))))return f;c=(s=qt(c,h,o,e)).Ri,h=s.Si}else{if(!(o=b(t[n])))return f;c=(s=qt(c,h,o,e)).Ri,h=s.Si}return Zt(Lt(c,h))}function Yt(t,e){var o=h(t*O(2)),n=2*o-1;return e.$i&&(n=2*(o=h(e.Qb*O(2)))-1-n),n}function Qt(t){return 1-Yt(t,{$i:!1})}function Xt(t){var e,o=["cup","mmHg","J","sec","cel","kel","hh","Wh","wh","flb","BTU"];for(e=0;o[e];e++)if(0===t.localeCompare(o[e]))return;return 1}function $t(t,e,o){var n,r,i=0,a=1;for(n=0;t[n].Ld;n++)if(0===o.localeCompare(t[n].Ld))return{Tk:!0,Uk:a,Vk:i=t[n]._c};if(e)for(n=0;e[n].Ld;n++)o.substr(0,1)===e[n].Ld.substr(0,1)&&Xt(o)&&(a=e[n]._c);for(n=0;t[n].Ld;n++)if(r=M(t[n].Ld),o.substr(1,r)===t[n].Ld.substr(0,r)&&Xt(o))return{Tk:!0,Uk:a,Vk:i=t[n]._c};return{Tk:!1,Uk:a,Vk:i}}function te(t){if(!(0<=Mt.indexOf(t))){var e=[t.slice(0,1),t.slice(1)],o=e[0],n=e[1];return 0<=Tt.indexOf(o)&&0<=Mt.indexOf(n)}}function ee(t){for(var e=0;e<V.length;e++)if(t===V[e].Ld)return 1;return"sec"===t.slice(1)||"s"===t.slice(1)}function oe(t){var e,o,n,r,i,a,s;if(-1<t.indexOf(vt.bit)?(n=(e=[t.slice(0,-3),t.slice(-3)])[0],i=e[1]):-1<t.indexOf(vt.byte)&&(n=(o=[t.slice(0,-4),t.slice(-4)])[0],i=o[1]),n)for(s=0;St[s].Ld;s++)n===St[s].Ld&&(r=St[s]._c);else r=1;return i===vt.bit?a=bt[0]._c:i===vt.byte&&(a=bt[1]._c),{Uk:r,Vk:a}}function ne(t){var e,o,n=1;if(Ct[t])return{unit:t,prefixNumber:n};if("K"!==Ct[t.slice(1)]&&"kel"!==Ct[t.slice(1)])return{unit:void 0,prefixNumber:n};for(e=t.slice(0,1),t=t.slice(1),o=0;At[o].Ld;o++)e===At[o].Ld&&(n=At[o]._c);return{unit:t,prefixNumber:n}}function re(t,e,o,n){var r,i;if(""===t&&""===e)return u;if(i={value:0},!0!==w(t,r={value:0})||!0!==w(e,i))return u;if(e=i.value,(t=r.value)<0||C<t||t%1!=0)return f;if("bitOperator"===o){if(e<0||C<e||e%1!=0)return f}else if("shiftOperator"===o&&0===t)return 0;return n(t,e)}function ie(t,e){if(""===t)return f;if(!0===t||!1===t)return u;var o=b(t);return o?e(o):f}function ae(t){var e=t.Pi(),o=t.Qi();return Lt(j(e)*y(o,!1),_(e)*y(o,!0))}function se(t){var e=t.Pi(),o=t.Qi();return Lt(_(e)*y(o,!1),-(j(e)*y(o,!0)))}function le(t){var e=t.Pi(),o=t.Qi();return Lt(y(e,!0)*_(o),y(e,!1)*j(o))}function ue(t){var e=t.Pi(),o=t.Qi();return Lt(y(e,!1)*_(o),y(e,!0)*j(o))}function ce(t,e){var o,n,r=t.Pi(),i=t.Qi(),a=e.Pi(),s=e.Qi();return Math.abs(s)<Math.abs(a)?Lt((r+i*(o=s/a))/(a+s*o),(i-r*o)/(a+s*o)):Lt((i+r*(n=a/s))/(s+a*n),(i*n-r)/(s+a*n))}function he(t,e){return t.Pi()===e.Pi()&&t.Qi()===e.Qi()}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),p=o("CalcEngine"),M=n.Common.k.ac,r=void 0,v=Math.abs,j=Math.sin,_=Math.cos,O=Math.sqrt,F=Math.log,d=Math.pow,i=Math.exp,a=Math.E,s=Math.atan2,P=parseFloat,l=isNaN,I=p.Errors.NotAvailable,f=p.Errors.Number,u=p.Errors.Value,c=p.Functions.ak,h=p.Functions.qk,L=p.Convert.Nh,g=p.Convert.vf,m=p.Functions.MathHelper,y=m.Dk,b=p.Functions.Wi,C=0xffffffffffff,w=p.Convert.Th,x=Lt(1,0),T=.00220462262184878,R=Bt(["g","sg","lbm","u","ozm","grain","cwt","shweight","uk_cwt","lcwt","hweight","stone","ton","uk_ton","LTON","brton"],[1,685217658567918e-19,T,602214179421676e9,.0352739619495804,15.432358352941462,A=T/100,A,S=T/112,S,S,.00015747304441777001,110231131092439e-20,N=T/2240,N,N]),D=(E=(k=1e4/254)/12)/3,B=Bt(["m","mi","Nmi","in","ft","yd","ang","Pica","ell","ly","pc","pica","survey_mi","parsec","Picapt"],[1,.000621371192237334,1/1852,k,E,D,1e10,2834.64566929134,.8748906386701663,105700083402462e-30,H=324077928966473e-31,236.2204724409449,.00062136994949495,H,2834.64566929134]),V=Bt(["yr","day","hr","mn","sec","d","min","s"],[1,365.25,8766,525960,31557600,365.25,525960,31557600]),z=Bt(["Pa","atm","mmHg","p","at","psi","Torr"],[1,986923266716013e-20,.007500637554192,1,986923266716013e-20,.000145037737730209,.0075006168270417]),W=Bt(["N","dyn","lbf","dy","pond"],[1,1e5,.22480894309971,1e5,101.971621297793]),U=Bt(["HP","W","h","w","PS"],[1,G=745.69987158227,1,G,1.013869665424]),Y=Bt(["J","e","c","cal","eV","HPh","Wh","flb","BTU","ev","hh","wh","btu"],[1,1e-7,K=.239005736137667,K,J=624150964712042e4,Z=1/(3600*G),1/3600,.737562149277265,q=.000947817120313317,J,Z,1/3600,q]),Q=Bt(["T","ga"],[1,1e4]),lt=Bt(["tsp","tspm","tbs","oz","cup","pt","qt","uk_qt","gal","uk_gal","l","uk_pt","us_pt","lt","ang3","ang^3","barrel","bushel","ft3","ft^3","in3","in^3","ly3","ly^3","m3","m^3","mi3","mi^3","yd3","yd^3","Nmi3","Nmi^3","Pica3","Pica^3","Picapt3","Picapt^3","GRT","regton","MTON","L"],[1,.98578431875,1/3,1/6,1/48,1/96,1/192,.00433684471160932,1/768,.00108421117790233,X=.00492892159375,.00867368942321863,1/96,X,$=1e27*X,$,1/32256,.000139870932189991,tt=.00017406322338,tt,.30078125,.30078125,et=82073596535e-54,et,ot=492892159375e-17,ot,nt=118251117638e-26,nt,rt=64467860511e-16,rt,it=775941468987e-27,it,at=112266,at,at,at,st=1740632233796e-18,st,4351580584491e-18,X]),ut=Bt(["admkn","kn","m/h","m/hr","m/s","m/sec","mph"],[1,1.00063930885529,1853.184,1853.184,.514773333333333,.514773333333333,1.15151515151515]),yt=Bt(["m2","m^2","ft2","ft^2","in2","in^2","yd2","yd^2","uk_acre","us_acre","ang2","ang^2","ar","ha","Morgen","mi2","mi2","Nmi2","Nmi^2","Pica2","Picapt2","Pica^2","Picapt^2","ly2","ly^2"],[1,1,ct=10.7639104167097,ct,ht=144*ct,ht,ft=ct/9,ft,.000247105381467165,.000247104393046628,1e20,1e20,.01,1e-4,4e-4,pt=ft/3097600,pt,dt=2.91553349598123e-7,dt,gt=8035216.07043214,gt,gt,gt,mt=111725076312873e-46,mt]),bt=Bt(["bit","byte"],[1,.125]),vt={bit:"bit",byte:"byte"},Ct={K:"K",kel:"kel",cel:"cel",C:"C",F:"F",fah:"fah",Rank:"Rank",Reau:"Reau"},wt=273.15,xt=459.67,At=Bt(Tt=["Y","Z","E","P","T","G","M","k","h","e","d","c","m","u","n","p","f","a","z","y"],[1e24,1e21,1e18,1e15,1e12,1e9,1e6,1e3,100,10,.1,.01,.001,1e-6,1e-9,1e-12,1e-15,1e-18,1e-21,1e-24]),St=Bt(["Y","Z","E","P","T","G","M","k","h","e","d","c","m","u","n","p","f","a","z","y","Yi","Zi","Ei","Pi","Ti","Gi","Mi","ki"],[1e24,1e21,1e18,1e15,1e12,1e9,1e6,1e3,100,10,.1,.01,.001,1e-6,1e-9,1e-12,1e-15,1e-18,1e-21,1e-24,Math.pow(2,80),Math.pow(2,70),Math.pow(2,60),Math.pow(2,50),Math.pow(2,40),Math.pow(2,30),Math.pow(2,20),Math.pow(2,10)]),Mt=["sg","lbm","ozm","grain","cwt","shweight","uk_cwt","lcwt","hweight","stone","uk_ton","lcwt","hweight","stone","uk_ton","LTON","brton","ton","mi","Nmi","in","ft","yd","ell","Pica","survey_mi","Picapt","psi","Torr","lbf","HP","h","PS","HPh","flb","BTU","hh","btu","tsp","tspm","tbs","oz","cup","pt","us_pt","uk_pt","qt","UK_qt","gal","uk_gal","barrel","bushel","ft3","ft^3","in3","in^3","mi3","mi^3","yd3","yd^3","Nmi3","Nmi^3","Picapt3","Picapt^3","Pica3","Pica^3","GRT","regton","MTON","kn","admkn","uk_acre","us_acre","ft2","ft^2","in2","in^2","ly2","ly^2","Morgen","mi2","mi^2","Nmi2","Nmi^2","Pica2","Picapt^2","Pica^2","Picapt^2","yd2","yd^2"],Nt={Hi:5},Dt={Hi:8},jt={Hi:8,Oi:!0},Ot=[{Hi:0,aj:"<= 0"},Et={Hi:2,aj:"< 0"}],Ft=[It={Hi:0},{Hi:0,_i:0}],Pt=[Rt={Hi:5,aj:["checkLength 10"]},kt={Zi:!0,Hi:2,_i:1,aj:["< 1","> 10"]}],c("BESSELI",function(t,e){return L(Vt(t,e,!0))},2,2,_t=[It,Et]),c("BESSELJ",function(t,e){return L(Vt(t,e,!1))},2,2,_t),c("BESSELK",function(t,e){var o,n,r,i,a,s,l,u,c,h=17976931348623157e292,f=.5772156649015329,p=0,d=.25*t*t,g=1,m=0,y=1,b=2/t;if(0<e){for(m=-f,i=1;i<e;i++)m+=1/i,g*=i+1;if(y=b,1===e)p=1/t;else{for(o=a=g/e,i=l=s=1;i<e;i++){if(o+=n=(a/=e-i)*(l*=-d)/(s*=i),h-v(n)<v(o)||1<b&&h/b<y)return h;y*=b}if(n=v(o*=.5),1<y&&h/y<n||1<n&&h/n<y)return h;p=o*y}}for(c=-f,n=0===e?(m=c,1):(m+=1/e,1/g),o=(c+m-(u=2*F(t/2)))*n,r=1;n*=d/(r*(r+e)),c+=1/r,m+=1/(r+e),r++,11102230246251565e-32<v(n/(o+=(c+m-u)*n)););return o=.5*o/y,0!=(1&e)&&(o=-o),L(p+=o)},2,2,Ot),c("BESSELY",function(t,e){var p=[.0007969367292973471,.08283523921074408,1.239533716464143,5.447250030587687,8.74716500199817,5.303240382353949,1],d=[.0007621256162081731,.07313970569409176,1.1271960812968493,5.112079511468076,8.424045901417724,5.214515986823615,1],g=[.0009244088105588637,.08562884743544745,1.2535274390105895,5.470977403304171,8.761908832370695,5.306052882353947,1],m=[.0005713231280725487,.06884559087544954,1.105142326340617,5.073863861286015,8.399855543276042,5.209828486823619,1],y=[-.011366383889846916,-1.2825271867050931,-19.553954425773597,-93.20601521237683,-177.68116798048806,-147.07750515495118,-51.41053267665993,-6.050143506007285],b=[.05108625947501766,4.982138729512334,75.82382841325453,366.7796093601508,710.8563049989261,597.4896124006136,211.68875710057213,25.207020585802372],v=[64.3178256118178,856.4300259769806,3882.4018360540163,7240.467741956525,5930.727011873169,2062.0933166032783,242.0057402402914],C=[74.23732770356752,1056.4488603826283,4986.410583376536,9562.318924047562,7997.041604473507,2826.1927851763908,336.0936078106983],w=[15592.436785523574,-14663929.59039716,5435264770.518765,-982136065717.9115,87590639439536.7,-0xc5090e8ec6601,0x9d4a5b305a0018,-0x41b52d6418d9ec],x=[1263204747.9017804,-647355876379.1603,114509511541823.73,-8127702555013251,0x2cf35a16e6cd620,-0xacf20aeef158b80],T=[1041.2835366425984,626107.330137135,268919633.39381415,86400248710.3935,20297961275010.555,3171577528429750.5,0x37a4bf79f36ba00],A=[594.3015923461282,235564.09294306856,73481194.44597217,18760131610.870617,3882312774962.3857,620557727146953.8,0xf41f1e2a3d2440,0x3721e321ece8fe00],f=[-4794432209.782018,1956174919465.5657,-249248344360967.72,9708622510473064],S=[-899971225.7055594,452228297998.19403,-72749424522181.83,0xd15a1534be241],M=[499.563147152651,173785.4016763747,48440965.83399621,11185553704.535683,2112775201154.892,310518229857422.56,0x710505f9ecba70,0x17be34c7b662cc00],I=[620.8364781180543,256987.25675774884,83514679.14319493,22151159547.97925,4749141220799.914,784369607876235.9,89522233618462740,0x49de55d9c0a4e400],N=.7978845608028654,R=2.356194490192345,k=.7853981633974483;function E(t,e,o,n){var r=0,i=P(e[r++]),a=o;for(n&&(i+=t,a--);i=i*t+P(e[r++]),0!=--a;);return i}function D(t,e){var o,n,r,i,a,s=e?p:d,l=e?g:m,u=e?y:b,c=e?v:C,h=e?M:I;return t<=5?(n=t*t,e&&t<1e-5?1-n/4:(r=(n-(e?5.783185962946784:14.681970642123893))*(n-(e?30.471262343662087:49.2184563216946)),r*=o=E(n,e?f:S,3)/E(n,h,8,!0),e?r:r*t)):(o=5/t,r=E(n=e?25/(t*t):o*o,s,6)/E(n,l,6),i=E(n,u,7)/E(n,c,7,!0),(r=r*_(a=t-(e?k:R))-o*i*j(a))*N/O(t))}function s(t,e){var o,n,r,i,a,s=e?p:d,l=e?g:m,u=e?y:b,c=e?v:C,h=e?T:A,f=e?7:8;return t<=5?(o=(e?1:t)*E(n=t*t,e?w:x,e?7:5)/E(n,h,f,!0),o+=.6366197723675814*(e?F(t)*D(t,!0):D(t,!1)*F(t)-1/t)):(o=5/t,r=E(n=e?25/(t*t):o*o,s,6)/E(n,l,6),i=E(n,u,7)/E(n,c,7,!0),(r=r*j(a=t-(e?k:R))+o*i*_(a))*N/O(t))}return L(function(t,e){var o,n=s(t,!0),r=s(t,!1),i=1,a=2*i;if(0===e)return n;if(1===e)return r;for(;o=a*r/t-n,n=r,r=o,a+=2,++i<e;);return o}(t,e))},2,2,Ot),c("BIN2DEC",function(t){return Gt(t,2)},1,1,Rt),c("BIN2HEX",function(t,e){return Jt(t,e,2,16)},1,2,Pt,r,r,{bk:1}),c("BIN2OCT",function(t,e){return Jt(t,e,2,8)},1,2,Pt,r,r,{bk:1}),c("DEC2BIN",function(t,e){return Ut(t,e,2)},1,2,[{Hi:0,aj:["< -512","> 511"]},kt],r,r,{bk:1}),c("DEC2HEX",function(t,e){return Ut(t,e,16)},1,2,[{Hi:0,aj:["< -549755813888","> 549755813887"]},kt],r,r,{bk:1}),c("DEC2OCT",function(t,e){return Ut(t,e,8)},1,2,[{Hi:0,aj:["< -536870912","> 536870911"]},kt],r,r,{bk:1}),c("HEX2BIN",function(t,e){return Jt(t,e,16,2,512)},1,2,Pt,r,r,{bk:1}),c("HEX2DEC",function(t){return Gt(t,16)},1,1,Rt),c("HEX2OCT",function(t,e){return Jt(t,e,16,8,536870912)},1,2,Pt,r,r,{bk:1}),c("OCT2BIN",function(t,e){return Jt(t,e,8,2,512)},1,2,Pt,r,r,{bk:1}),c("OCT2DEC",function(t){return Gt(t,8)},1,1,Rt),c("OCT2HEX",function(t,e){return Jt(t,e,8,16,549755813888)},1,2,Pt,r,r,{bk:1}),c("ERF",Yt,1,2,[It,{Zi:!0,Hi:0}],r,r,{bk:1}),c("ERF.PRECISE",function(t){return Yt(t,{$i:!1})},1,1,It),c("ERFC",Qt,1,1,It),c("ERFC.PRECISE",Qt,1,1,It),c("DELTA",function(t,e){return p.Zh.Yh(t,e)?1:0},1,2,Ft,r,r,{bk:1}),c("GESTEP",function(t,e){return e<=t?1:0},1,2,Ft,r,r,{bk:1}),c("COMPLEX",function(t,e,o){return"i"!==o&&"j"!==o?p.Errors.Value:Zt(Lt(t,e),o)},2,3,[It,It,{Hi:5,_i:"i"}],r,r,{bk:2}),c("IMABS",function(t){return L(O(t.Ri*t.Ri+t.Si*t.Si))},1,1,Dt),c("IMAGINARY",function(t){return L(t.Si)},1,1,Dt),c("IMARGUMENT",function(t){return 0===t.Ri&&0===t.Si?p.Errors.DivideByZero:L(s(t.Si,t.Ri))},1,1,Dt),c("IMCONJUGATE",function(t){return Zt(Lt(t.Ri,-t.Si))},1,1,Dt),c("IMCOS",function(t){return Zt(Lt(_(t.Ri)*y(t.Si,!1),-j(t.Ri)*y(t.Si,!0)))},1,1,Dt),c("IMDIV",function(t,e){var o=t.Ri,n=t.Si,r=e.Ri,i=e.Si;return Zt(Lt((o*r+n*i)/(r*r+i*i),(n*r-o*i)/(r*r+i*i)))},2,2,[Dt,jt]),c("IMEXP",function(t){return Zt(Lt(i(t.Ri)*_(t.Si),i(t.Ri)*j(t.Si)))},1,1,Dt),c("IMLN",function(t){var e=t.Ri,o=t.Si;return Zt(Lt(F(O(e*e+o*o)),s(o,e)))},1,1,jt),c("IMLOG10",function(t){var e=t.Ri,o=t.Si,n=m.Ek(a,10);return Zt(Lt(n*F(O(e*e+o*o)),n*s(o,e)))},1,1,jt),c("IMLOG2",function(t){var e=t.Ri,o=t.Si,n=m.Ek(a,2);return Zt(Lt(n*F(O(e*e+o*o)),n*s(o,e)))},1,1,jt),c("IMREAL",function(t){return L(t.Ri)},1,1,Dt),c("IMSIN",function(t){return Zt(Lt(j(t.Ri)*y(t.Si,!1),_(t.Ri)*y(t.Si,!0)))},1,1,Dt),c("IMSQRT",function(t){var e,o,n=t.Ri,r=t.Si;return 0===n&&0===r?"0":(e=O(n*n+r*r),o=s(r,n),Zt(Lt(O(e)*_(o/2),O(e)*j(o/2))))},1,1,Dt),c("IMSUB",function(t,e){return Zt(Lt(t.Ri-e.Ri,t.Si-e.Si))},2,2,[Dt,Dt]),c("IMPOWER",function(t,e){var o,n,r=t.Ri,i=t.Si;return 0===r&&0===i?0<e?"0":f:(o=O(r*r+i*i),n=s(i,r),Zt(Lt(d(o,e)*_(e*n),d(o,e)*j(e*n))))},2,2,[Dt,{Hi:2}]),c("IMPRODUCT",function(){return Kt(arguments,!0)},1,255,r,-1,-1),c("IMSUM",function(){return Kt(arguments,!1)},1,255,r,-1,-1),c("CONVERT",function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S;if(ne(e).unit&&ne(o).unit)return function(t,e,o){var n,r=ne(e);switch(r.unit){case Ct.Rank:n=function(t,e){var o,n=ne(e);switch(n.unit){case Ct.Rank:return t;case Ct.Reau:return.8*(t-xt-32)*5/9;case Ct.C:case Ct.cel:return 5*(t-xt-32)/9;case Ct.F:case Ct.fah:return t-xt;case Ct.K:case Ct.kel:return o=n.prefixNumber,(wt+5*(t-xt-32)/9)/o}}(t,o);break;case Ct.Reau:n=function(t,e){var o,n=ne(e);switch(n.unit){case Ct.Rank:return 1.25*t*9/5+32+xt;case Ct.Reau:return t;case Ct.C:case Ct.cel:return 1.25*t;case Ct.F:case Ct.fah:return 1.25*t*9/5+32;case Ct.K:case Ct.kel:return o=n.prefixNumber,(1.25*t+wt)/o}}(t,o);break;case Ct.C:case Ct.cel:n=function(t,e){var o,n=ne(e);switch(n.unit){case Ct.Rank:return 9*t/5+32+xt;case Ct.Reau:return.8*t;case Ct.cel:case Ct.C:return t;case Ct.F:case Ct.fah:return 9*t/5+32;case Ct.K:case Ct.kel:return o=n.prefixNumber,(t+wt)/o}}(t,o);break;case Ct.F:case Ct.fah:n=function(t,e){var o,n=ne(e);switch(n.unit){case Ct.Rank:return t+xt;case Ct.Reau:return 4*(t-32)/9;case Ct.F:case Ct.fah:return t;case Ct.C:case Ct.cel:return 5*(t-32)/9;case Ct.K:case Ct.kel:return o=n.prefixNumber,(5*(t-32)/9+wt)/o}}(t,o);break;case Ct.K:case Ct.kel:n=function(t,e){var o,n=ne(e);switch(n.unit){case Ct.Rank:return 9*t/5;case Ct.Reau:return.8*(t-wt);case Ct.C:case Ct.cel:return t-wt;case Ct.F:case Ct.fah:return 9*(t-wt)/5+32;case Ct.K:case Ct.kel:return o=n.prefixNumber,t/o}}(t*r.prefixNumber,o)}return n}(t,e,o);if(g=o,m=-1<(d=e).indexOf("bit")||-1<d.indexOf("byte"),y=-1<g.indexOf("bit")||-1<g.indexOf("byte"),1==(n=m&&y?2:y||m?1:0))return I;if(2==n)return b=t,v=o,C=oe(e),w=oe(v),b*C.Uk/C.Vk*w.Vk/w.Uk;if(ee(e)&&ee(o))return x=t,T=o,A=$t(V,At,e),S=$t(V,At,T),x*A.Uk/A.Vk*S.Vk/S.Uk;if(te(e)||te(o))return I;for(r=[R,B,z,W,Y,U,Q,lt,Q,ut,yt],i=0;i<M(r);i++)if(l=(s=$t(a=r[i],At,e)).Tk,u=s.Vk,c=s.Uk,h=(s=$t(a,At,o)).Tk,f=s.Uk,p=s.Vk,l&&h&&0!==u&&0!==f)return t*c/u*p/f;return I},3,3,[{Hi:1},Nt,Nt]),c("BITAND",function(t,e){return re(t,e,"bitOperator",function(t,e){return t&e})},0,2),c("BITLSHIFT",function(t,e){return re(t,e,"shiftOperator",function(t,e){if(48<=e)return f;if(e<0&&t<1<<-e)return 0;var o=t<<e;return C<o?f:o})},0,2),c("BITOR",function(t,e){return re(t,e,"bitOperator",function(t,e){return t|e})},0,2),c("BITRSHIFT",function(o,n){return re(o,n,"shiftOperator",function(t,e){return 53<e?f:0<=n?o>>n:o<<-n})},0,2),c("BITXOR",function(t,e){return re(t,e,"bitOperator",function(t,e){return t^e})},0,2),c("IMCOSH",function(t){return ie(t,function(t){return Zt(ue(t),t.lja())})},1,1),c("IMCOT",function(t){return ie(t,function(t){return he(ae(t),Lt(0,0))?f:Zt(ce(se(t),ae(t)),t.lja())})},1,1),c("IMCSC",function(t){return ie(t,function(t){return he(t,Lt(0,0))?f:Zt(ce(x,ae(t)),t.lja())})},1,1),c("IMCSCH",function(t){return ie(t,function(t){return he(le(t),Lt(0,0))?f:Zt(ce(x,le(t)),t.lja())})},1,1),c("IMSEC",function(t){return ie(t,function(t){return he(se(t),Lt(0,0))?f:Zt(ce(x,se(t)),t.lja())})},1,1),c("IMSECH",function(t){return ie(t,function(t){return he(ue(t),Lt(0,0))?f:Zt(ce(x,ue(t)),t.lja())})},1,1),c("IMSINH",function(t){return ie(t,function(t){return Zt(le(t),t.lja())})},1,1),c("IMTAN",function(t){return ie(t,function(t){return Zt(ce(ae(e=t),se(e)),t.lja());var e})},1,1)},"./src/functions-fin.ts":function(t,e,o){"use strict";var b,s,v,l,C,n,E,j,w,d,y,x,a,u,c,g,S,T,A,_,M,i,I,m,f,N,R,h,D,r,p,k,O,F,P,L,H,B,V,z,W,G,U,J,Z,q,K,Y,Q,X,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ht,ft,pt,dt,gt,mt,yt,bt,vt;function Ct(t){return t.getMonth()}function wt(t){return t.getDate()}function xt(t){return t.getFullYear()}function Tt(t){return t instanceof Date?b.Common.l.Ra(t):t}function At(t,e,o){var n=xt(e)-xt(t),r=Ct(e)-Ct(t)+12*n,i=wt(e)-wt(t),a=-1;return 0===o?a=s.Functions.uk(t,e):0<=E(o,[1,2,3])?a=Tt(e)-Tt(t):4===o&&(a=30*r+i),a}function St(t,e,o,n,r){var i,a=A(1+t,e),s=l(a)?a:D;return 0===t?e:x(s)||(i=l(a=(a-1)/t)?a:D,x(i))?D:l(a=(-o*s-n)/((1+t*r)*i))?a:D}function Mt(t,e,o,n){var r=xt(e),i=Ct(e),a=wt(e),s=new Date(1,0,1),l=0,u=a===P(r,i),c=12/o,h=r-xt(t);for(s.setFullYear(1),0<h&&(h=(h-1)*o);h++,(s=new Date(r,i,a)).setMonth(i-h*c),u&&(l=P(xt(s),Ct(s)),s=new Date(xt(s),Ct(s),l)),L(t,s)<0;);return n&&(h--,(s=new Date(r,i,a)).setMonth(i-h*c),u&&(l=P(xt(s),Ct(s)),s=new Date(xt(s),Ct(s),l))),s}function It(t,e,o,n){return H(Mt(t,e,o,!1),t,n)}function Nt(t,e,o,n){return 0<=E(n,[0,2,4,5])?360/o:3===n?365/o:H(Mt(t,e,o,!1),Mt(t,e,o,!0),1)}function Rt(t,e,o,n){return H(t,Mt(t,e,o,!0),n)}function kt(t,e,o){var n=xt(e),r=Ct(e),i=wt(e),a=new Date(n,r,i),s=r-Ct(t)+12*(n-xt(t));if(a.setMonth(Ct(a)-s),i===P(n,r))for(;wt(a)!==P(xt(a),Ct(a));)a.setDate(wt(a)+1);return wt(t)>=wt(a)&&s--,C(""+(1+s/(12/o)))}function Et(t,e,o){return 0<e?(o.Wk?o.Xk?_(t-o.Yk)<_(o.Zk-o.Yk)&&(o.Zk=t,o.$k=e):e<o.$k&&(o.Zk=t,o.$k=e):(o.Zk=t,o.$k=e,o.Wk=!0),[!1,o]):e<0?(o.Xk?o.Wk?_(t-o.Zk)<_(o.Zk-o.Yk)&&(o.Yk=t,o._k=e):-e<-o._k&&(o.Yk=t,o._k=e):(o.Yk=t,o._k=e,o.Xk=!0),[!1,o]):isNaN(e)?[!1,o]:(o.al=t,[!0,o])}function Dt(t,e,o,n,r){var i,a=Mt(t,o,n,!0),s=Mt(t,o,n,!1);if(0<=L(a,e))return H(t,e,r)/Nt(s,a,n,r);for(i=H(t,a,r)/Nt(s,a,n,r);;){if(s=new Date(xt(a),Ct(a),wt(a)),a.setMonth(Ct(a)+12/n),0<=L(a,e))return i+H(s,e,r)/Nt(s,a,n,r);i+=1}}function jt(t,e,o,n,r,i,a){var s,l=It(t,e,i,a),u=Rt(t,e,i,a),c=Nt(t,e,i,a),h=C(""+kt(t,e,i)),f=0,p=100*o/i,d=1+n/i,g=u/c;for(s=0;s<h;s++)f+=p/A(d,g+s);return r/A(d,h-1+u/c)+f-l/c*p}function _t(t,e,o,n,r,i,a,s,l){var u,c,h,f=H(s,t,a),p=H(t,l,a),d=H(s,l,a),g=Nt(t,e,i,a),m=C(""+kt(t,e,i)),y=100*o/i,b=1+n/i;if(g<p)switch(a){case 0:case 4:u=H(l,e,a),m=1+C(""+M(u/g));break;default:for(c=new Date(xt(l),Ct(l),wt(l)),m=0;m<32767;m++)if(h=new Date(xt(c),Ct(c),wt(c)),c.setMonth(Ct(c)+12/i),0<=L(c,e)){m+=C(""+M(H(h,e,a))/Nt(h,c,i,a))+1;break}f=g*Dt(s,t,l,i,a),p=g*Dt(t,l,l,i,a),d=g*Dt(s,l,l,i,a)}return r/A(b,m-1+p/g)+y*(d/g/A(b,p/g)+A(b,-p/g)*(A(b,-m)-1/b)/(1/b-1)-f/g)}function Ot(t,e){var o=t.substr(0,3),n={ATS:13.7603,BEF:40.3399,DEM:1.95583,ESP:166.386,EUR:1,FIM:5.94573,FRF:6.55957,GRD:340.75,IEP:.787564,ITL:1936.27,LUX:40.3399,LUF:40.3399,NLG:2.20371,PTE:200.482,SIT:245.18};return n[o]?k(n[o],e):-1}function Ft(t,e,o,n,r){var i=A(1+t,e);return-(0===t?n+o*e:n*i+o*(0<r?1+t:1)*(i-1)/t)}function Pt(t,e,o,n,r,i,a){if(i<r||o<i||0!==a&&1!==a)return D;var s,l,u,c,h,f,p,d,g,m=(h=n,f=0,p=a,g=A(1+(u=e),c=o),0===u?d=(h+f)/c:(d=f*u/(g-1)+h*u/(1-1/g),0<p&&(d/=1+u)),-d),y=0;for(1===r&&(t&&(y=m),a<=0&&(y+=t?n*e:-n),r++),s=r;s<=i;s++)l=0<a?Ft(e,s-2,m,n,1)-m:Ft(e,s-1,m,n,0),y+=t?m-l*e:l;return t?y:y*e}function Lt(t,e,o,n){var r=A(1+o,n),i=-(t*r*o+e*(r-1));return l(i)?i:D}function Ht(t,e,o,n,r){return E(n,[1,2,4])<0||0<=L(e,o)?D:t(e,o,n,r)}function Bt(t,e,o,n,r,i){if(E(i,[1,2,4])<0||0<L(e,o))return D;var a=function(t,e,o,n){var r,i=0,a=0;for(t*=100/c(o),e/=o,e++,r=1;r<n;r++)i+=r*t/A(e,r);for(i+=n*(t+100)/A(e,n),r=1;r<n;r++)a+=t/A(e,r);return(i/=a+=(t+100)/A(e,n))/c(o)}(n,r,i,kt(e,o,i));return t?a/(1+r/i):a}function Vt(t,e,o,n,r,i,a,s,l){var u,c,h,f;if(E(a,[1,2,4])<0||0<L(e,o)||0<L(n,e))return D;for(u=new Date(xt(n),Ct(n),wt(n));u.setMonth(Ct(u)+12/a),L(u,o)<0;);return c=Dt(n,e,u,a,s),h=Dt(n,o,u,a,s),f=Dt(e,o,u,a,s),t?(i*a+100*r*(h-c*(1+l*f/a)))/(l*f+a):(a*(i-l)+100*r*(h-c))/(f*l+100*r*c*f/a)}function zt(t,e,o){var n,r,i;return 0===o?R:(n=(e<0?M:m)(e),r=A(10,M(p.Ek(o,10))),i=e-n,a(n+(t?i*r/o:i*o/r)))}function Wt(t,e,o,n){var r,i,a=d(e),s=0,l=1+t,u=0;if(.75<=l&&l<=1.25&&12<a&&n&&(u=2.5),o)for(r=0;r<a;r++){if(i=-(r-u)*e[r]*Math.pow(l,-(r-u)-1),isNaN(i))return s;s+=i}else for(r=0;r<a;r++){if(i=e[r]*Math.pow(l,-(r-u)),isNaN(i))return s;s+=i}return s}function Gt(t,e,o,n){var r,i,a=0,s=d(e);for(t<=-1&&(t=1e-10-1),r=0;r<s;r++){if((i=Tt(n[r])-Tt(n[0]))<0)return[!1,o];a+=e[r]/p.Ck(t,i/365)}return l(a)?o=isNaN(a)?5e-324:a:a===Number.POSITIVE_INFINITY?o=O:a===Number.NEGATIVE_INFINITY&&(o=-O),[!0,o]}function Ut(t,e,o,n){var r,i,a;return-1<t&&0!==t?(i=A(1+t,(r=o).bl-(n?1:0)),a=(A(1+t,r.bl)-1)/t,[!0,e=n?-r.cl*a/t+i*r.bl*(r.dl+r.cl*(r.Nc+1/t)):r.dl*i+r.cl*(1+t*r.Nc)*a+r.el,o]):[!1,e,o]}function Jt(t,e,o,n,r,i,a,s,l,u,c,h,f,p,d){var g,m,y,b,v=0,C=0,w=o-r,x=o+r,T=2===t;if(w<i.fl&&(w=o),x>i.gl&&(x=o),w===x)return T?[!1,n,i,a]:[!1,n,i];if(m=0===t?(g=e(a,s,l,w,c,h,f,p,d)-u,e(a,s,l,x,c,h,f,p,d)-u):1===t?(g=e(w,a,v,s),e(x,a,C,s)):(g=Ut(w,v,a),Ut(x,C,a)),j(g)){if(b=g[2],v=g[1],!(y=g[0]))return T?[y,n,i,b]:[y,n,i]}else v=g;if(j(m)){if(b=m[2],C=m[1],!(y=m[0]))return T?[y,n,i,b]:[y,n,i]}else C=m;return n=(C-v)/(x-w),T?[!0,n,i,b]:[!0,n,i]}function Zt(t,e,o,n,r,i,a,s,l,u,c,h,f){var p;return n<o.fl||n>o.gl?[!1,o]:(o=(p=Et(n,t?Wt(n,r):e(r,i,a,n,l,u,c,h,f)-s,o))[1],[!!p[0],o])}function qt(t,e,o){var n,r,i=0;return e<t.fl||e>t.gl?[!1,t,o]:(o=(n=Ut(e,i,o))[2],i=n[1],n[0]?(t=(r=Et(e,i,t))[1],[!!r[0],t,o]):[n[0],t,o])}function Kt(t,e,o,n,r,i,a,s,l,u){var c,h,f,p,d=0,g=t?15:2;if(!o.Wk||!o.Xk)return t?[!1,o,n]:[!1,o];for(h=_(o.Zk-o.Yk)/(_(o.Zk)+_(o.Yk)),c=0;c<100+4*g;c++)if(0,f=c%4==0?1:c%4==2?2:3,o=(p=t?Xt(o,n,h,d,0,f):e?$t(!0,o,d,0,0,f,Gt,h,r,n,Jt):$t(!1,o,d,0,0,f,jt,h,i,a,s,n,r,l,u))[1],t&&(n=p[2]),d=t?p[3]:p[2],p[0])return t?[!0,o,n]:[!0,o];return t?[!1,o,n]:[!1,o]}function Yt(t,e,o,n,r,i,a,s,l,u,c,h,f){var p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E=o.hl/2,D=!1;for(d=0;d<20;d++){if(n<o.fl||n>o.gl){if(!t||o.Xk&&o.Wk||!(n<=-1))return[!1,o];n=-1,D=!0}if(y=t?Gt(n,r,0,i):e(r,i,a,n,l,u,c,h,f)-s,j(y)){if(m=y[1],!(g=y[0]))return[g,o]}else m=y;if(o=(b=Et(n,m,o))[1],b[0])return[!0,o];if(D)return[!1,o];if(v=o.Xk&&o.Wk?_(o.Zk-o.Yk):o.gl-o.fl,C=(_(n)<1e-10?v:_(n))/1e6,w=0,o=(b=t?Jt(1,Gt,n,w,C,o,r,i):Jt(0,e,n,w,C,o,r,i,a,s,l,u,c,h,f))[2],w=b[1]<0?b[1]:-b[1],!(g=b[0]))return[g,o];if(0===w)return[!1,o];if((x=n-1.000001*m/w)===n)return o.al=n,[!0,o];if(t&&o.Xk&&o.Wk&&(x<(A=(T=[o.Zk,o.Yk])[0])==x<(S=T[1])&&(M=!0,S<A&&(A=(p=[S,A])[0],S=p[1],M=!1),N=(I=[o.$k,o._k])[0],R=I[1],x=A+_((M?N:R)/(R-N))*(S-A))),k=_(x-n)/(_(n)+_(x)),n=x,k<E)return o.al=n,[!0,o]}return[!1,o]}function Qt(t,e,o,n){var r,i,a,s,l,u;for(r=0;r<32;r++){if(o<t.fl||o>t.gl)return[!1,t];if(t=(a=Et(o,i=Wt(o,e,!1,!0),t))[1],a[0])return[!0,t];if(0===(s=Wt(o,e,!0,!0)))return[!1,t];if((l=o-1.0000001*i/s)===o)return t.al=o,[!0,t];if(u=_(l-o)/(_(o)+_(l)),o=l,u<n)return t.al=o,[!0,t]}return[!1,t]}function Xt(t,e,o,n,r,i){var a,s,l,u,c,h,f;if(1===i){if(e=(s=Ut(a=(t.Zk+t.Yk)/2,r,e))[2],r=s[1],!s[0])return[S,t,e,n];if(0===r)return[!0,t=Et(a,r,t)[1],e,n];if(0===I(r*r-t.$k*t._k))return[S,t,e,n]}else if(2===i){if(l=void 0,c=u=0,.1<o)return Xt(t,e,o,n,r,i=3);if(0==(h=n++%4))l=t.Zk,u=t.$k;else if(2==h)l=t.Yk,u=t._k;else if(e=(s=Ut(l=(t.Zk+t.Yk)/2,u,e))[2],u=s[1],!s[0])return[S,t,e,n];if(e=(f=Jt(2,void 0,l,c,_(t.Zk-t.Yk)/1e6,t,e))[3],t=f[2],c=f[1],!f[0]||0===c)return[S,t,e,n];if((a=l-1.01*u/c)<t.Zk&&a<t.Yk||a>t.Zk&&a>t.Yk)return[S,t,e,n]}return[!1,t,e,n]}function $t(t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m){var y,b,v,C,w,x,T,A;switch(i){case 0:n=e.Zk-e.$k*((e.Yk-e.Zk)/(e._k-e.$k));break;case 1:if(n=(e.Zk+e.Yk)/2,y=t?a(n,u,r,l):a(h,f,l,n,c,p,d,g,m)-u,j(y)){if(r=y[1],!y[0])return[S,e,o,n,r,i]}else r=y;if(0===r)return[!0,e=Et(n,r,e)[1],o,n,r,i];if(0===(b=I(r*r-e.$k*e._k)))return[S,e,o,n,r,i];n+=(n-e.Zk)*r/b;break;case 3:n=(e.Zk+e.Yk)/2;break;case 2:if(v=void 0,C=0,x=0,.1<s)return $t(t,e,o,n,r,i=3,a,s,l,u,c,h,f,p,d);if(0==(T=o++%4))v=e.Zk,C=e.$k;else if(2==T)v=e.Yk,C=e._k;else if(v=(e.Zk+e.Yk)/2,y=t?a(v,u,C,l):a(h,f,l,v,c,p,d,g,m)-u,j(y)){if(C=y[1],!y[0])return[S,e,o,n,r,i]}else C=y;if(w=_(e.Zk-e.Yk)/1e6,e=(A=t?c(1,a,v,x,w,e,u,l):Jt(0,a,v,x,w,e,h,f,l,u,c,p,d,g,m))[2],x=A[1],!A[0]||0===x)return[S,e,o,n,r,i];if((n=v-1.01*C/x)<e.Zk&&n<e.Yk||n>e.Zk&&n>e.Yk)return[S,e,o,n,r,i]}return y=t?a(n,u,r,l):a(h,f,l,n,c,p,d,g,m)-u,j(y)&&(r=y[1],!y[0])?[S,e,o,n,r,i]:Et(n,r,e)[0]?[!0,e,o,n,r,i]:(s=_(e.Zk-e.Yk)/(_(e.Zk)+_(e.Yk)))<e.hl?(e._k<r&&(r=e._k,n=e.Yk),e.$k<r&&(r=e.$k,n=e.Zk),e.al=n,[!0,e,o,n,r,i]):[!1,e,o,n,r,i]}function te(t,e){var o,n,r,i=arguments,a=0,s=1;for(n=1;n<d(i);n++){if((r=u(i[n],1,!0,!0,!1,!0)).isError)return r[0];for(o=0;o<d(r);o++)r[o]!==g&&(a+=r[o]/A(1+t,s++))}return a}function ee(t,e,o){return Tt(Mt(t,e,o,!0))}function oe(t,e,o){return Tt(Mt(t,e,o,!1))}function ne(t,e,o,n){var r,i,a=n.hl,s=n.Xk&&n.Wk?[n.Zk,n.Yk]:function(t,e,o,n){for(var r=o-.5,i=o+.5,a=0;0<Gt(r,t,0,e)[1]*Gt(i,t,0,e)[1]&&a++<n;)r-=.5,i+=.5;return n<=a?[0,0]:[r,i]}(t,e,o,100),l=s[0],u=s[1],c=Gt(l,t,0,e)[1],h=Gt(u,t,0,e)[1],f=0;for(r=0;r<100&&!(0<c*h);r++)if((i=Gt(f=(l+u)/2,t,0,e)[1])*c<0?(u=f,h=i):(l=f,c=i),_(l-u)<a)return[!0,f];return[!1,f]}function re(t,e,o,n,r){var i,a,s=r/o;return(i=(1<=s?(s=1)===n?t:0:t*A(1-s,n-1))-((a=t*A(1-s,n))<e?e:a))<0?0:i}function ie(t,e,o,n,r,i){var a,s,l,u=0,c=0,h=M(r),f=h,p=t-e,d=!1;for(l=1;l<=f;l++)d?s=c:(a=re(t,e,o,l,i))<(c=p/(n-(l-1)))?(s=c,d=!0):p-=s=a,l===f&&(s*=r+1-h),u+=s;return u}function ae(t,e,o,n){var r,i,a;return""===t&&""===e&&""===o?h:(t=V(t,r={value:0}),e=V(e,i={value:0}),o=V(o,a={value:0}),!0===t&&!0===e&&!0===o?n(r,i,a):h)}Object.defineProperty(e,"__esModule",{value:!0}),b=o("Common"),s=o("CalcEngine"),v=b.Common.j.C4,l=isFinite,C=parseInt,n=b.Common.j,E=n.Ea,j=n.Ca,w=n.Fa,d=b.Common.k.ac,y=s.Convert.Rh,x=s.Convert.vf,a=s.Convert.Nh,u=s.Convert.Ph,c=s.Convert.Pa,g=s.Convert.CalcConvertedError,S=null,T=void 0,A=Math.pow,_=Math.abs,M=Math.ceil,i=Math.log,I=Math.sqrt,m=Math.floor,f=Math.max,N=Math.min,R=s.Errors.DivideByZero,h=s.Errors.Value,D=s.Errors.Number,r=s.Functions.ak,p=s.Functions.MathHelper,k=p.Ak,O=s.Functions.hk,F=s.Functions.lk,P=s.Functions.nk,L=s.Functions.mk,H=s.Functions.pk,B=s.Functions.vk,V=s.Convert.Th,U={Hi:0,aj:"< 1"},J={Hi:0,aj:"< 0"},Z={_i:.1,Hi:0},q={_i:2,Hi:0},K={_i:1e3,Hi:0,aj:"<= 0"},X={_i:!(Q={Hi:5}),Hi:7},ot={_i:0,Hi:2},rt={Hi:2,aj:"= 0",bj:R},at={Hi:4,Ii:1,Ji:!0,Ki:!0},st={Hi:4,Ii:1,Ji:!0,Mi:!0,Ki:!0},lt={Hi:4,Ii:4,Ji:!0,Ki:!0,Mi:!0,breakOnConvertError:!0},ut={Hi:4,Ii:1,Ji:!0,Ki:!0,breakOnConvertError:!0},ct={Hi:4,Ii:11,Ji:!0,Ki:!0,breakOnConvertError:!0},ht=[Y={Hi:6},Y,$={Hi:2},nt={_i:0,Hi:2,aj:["< 0","> 4"]}],ft=[Y,Y,z={Hi:0},z,$,nt],pt=[Y,Y,G={Hi:0,aj:"<= 0"}],dt=[z,Y,Y,z,$,G,{_i:0,Hi:2,aj:["< 0","> 4","= 2"]}],mt=[Y,Y,G,G,nt],yt=[G,tt={Hi:2,aj:"<= 0"},G,et={Hi:2,aj:"< 1"},$,$],bt=[G,et],vt=[z,it={Hi:2,aj:"< 0"}],r("FV",function(t,e,o,n,r){r=r?1:0;var i=A(1+t,e);return a(-(i=0===t?o*e+n:n*i+o*(1+t*r)*(i-1)/t))},3,5,gt=[z,z,z,W={_i:0,Hi:0},W],T,T,{bk:[3,4]}),r("FVSCHEDULE",function(t,e){for(var o=0;o<d(e);o++)e[o]!==g&&(t*=1+e[o]);return t},2,2,[z,at],1,1),r("NPV",te,2,T,z,"> 0","> 0"),r("PV",function(t,e,o,n,r){if(r=r?1:0,0===t)return a(-(o*e+n));var i=A(1+t,e);return-1===t?R:a(-(n+o*(1+t*r)*(i-1)/t)/i)},3,5,gt,T,T,{bk:[3,4]}),r("RECEIVED",function(t,e,o,n,r){var i,a,s;return 0<=L(t,e)?D:(i=At(t,e,r),a=F(t,r),i<=0||a<=0?D:(s=1-n*i/a)<=0?D:o/s)},4,5,mt,T,T,{bk:3}),r("XNPV",function(t,e,o){var n,r=d(e),i=0;if(r!==d(o))return D;if(e.some(function(t){return t===g}))return h;for(n=0;n<r;n++)i+=e[n]/A(1+t,(o[n]-o[0])/365);return i},3,3,[z,ut,ut],"!= 0","!= 0"),r("CUMIPMT",function(t,e,o,n,r,i){return Pt(!1,t,e,o,n,r,i)},6,6,yt),r("CUMPRINC",function(t,e,o,n,r,i){return Pt(!0,t,e,o,n,r,i)},6,6,yt),r("IPMT",function(t,e,o,n,r,i){return o+1<=e||0!==i&&1!==i?D:Lt(n,St(t,o,n,r,i),t,e-1)},4,6,[z,U,U,z,W,ot],T,T,{bk:[4,5]}),r("ISPMT",function(t,e,o,n){return a(n*t*(e/o-1))},4,4,[z,$,rt,z]),r("PMT",function(t,e,o,n,r){r=r?1:0;var i=A(1+t,e);return a(-(i=0===t?(o+n)/e:(o*i+n)/((1+t*r)*(i-1)/t)))},3,5,[z,{Hi:0,aj:"= 0",bj:R},z,W,W],T,T,{bk:[3,4]}),r("PPMT",function(t,e,o,n,r,i){var a,s;return i=i?1:0,o+1<=e?D:(a=St(t,o,n,r,i),x(a)||(s=Lt(n,a,t,e-1),x(s))?D:a-s)},4,6,[z,U,z,z,W,W],T,T,{bk:[4,5]}),r("COUPDAYBS",function(t,e,o,n){return Ht(It,t,e,o,n)},3,4,ht,T,T,{bk:3}),r("COUPDAYS",function(t,e,o,n){return Ht(Nt,t,e,o,n)},3,4,ht,T,T,{bk:3}),r("COUPDAYSNC",function(t,e,o,n){return Ht(Rt,t,e,o,n)},3,4,ht,T,T,{bk:3}),r("COUPNCD",function(t,e,o){return Ht(ee,t,e,o)},3,4,ht,T,T,{bk:3}),r("COUPNUM",function(t,e,o){return Ht(kt,t,e,o)},3,4,ht,T,T,{bk:3}),r("COUPPCD",function(t,e,o){return Ht(oe,t,e,o)},3,4,ht,T,T,{bk:3}),r("DURATION",function(t,e,o,n,r){return Bt(!1,t,e,o,n,r)},5,6,ft,T,T,{bk:5}),r("MDURATION",function(t,e,o,n,r){return n<0||o<0?D:Bt(!0,t,e,o,n,r)},5,6,ft,T,T,{bk:5}),r("NPER",function(t,e,o,n,r){return r=r?1:0,0===t?0===e?R:a(-(o+n)/e):a(i((e*(1+t*r)-n*t)/(o*t+e*(1+t*r)))/i(1+t))},3,5,[{Hi:0,aj:"<= -1"},z,z,W,W],T,T,{bk:[3,4]}),r("YIELD",function(t,e,o,n,r,i,a){var s,l,u,c,h,f,p;if(E(i,[1,2,4])<0||0<L(t,e))return D;if(kt(t,e,i)<=1)return s=It(t,e,i,a),l=Rt(t,e,i,a),(r/100+o/i-(n/100+s/(u=Nt(t,e,i,a))*o/i))/(n/100+s/u*o/i)*(i*u/l);if(f=(p=Yt(!(f={fl:0,gl:1e3,hl:1e-10,Wk:!(h=.1),Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0}),jt,f,h,t,e,o,n,r,i,a))[1],!(c=p[0])){for(h=1e-10;h<f.gl;h*=2)f=Zt(!1,jt,f,h,t,e,o,n,r,i,a)[1];f=(p=Kt(!1,!1,f,t,e,o,n,r,i,a))[1],c=p[0]}return c?f.al:D},6,7,[Y,Y,J,G,G,$,nt],T,T,{bk:6}),r("YIELDDISC",function(t,e,o,n,r){return 0<=L(t,e)?D:(n/o-1)/B(t,e,r)},4,5,[Y,Y,G,G,nt],T,T,{bk:3}),r("YIELDMAT",function(t,e,o,n,r,i){var a;return 0<=L(t,e)?D:(a=1+B(o,e,i)*n,a/=r/100+B(o,t,i)*n,a--,a/=B(t,e,i))},5,6,[Y,Y,Y,J,G,nt],T,T,{bk:5}),r("AMORDEGRC",function(t,e,o,n,r,i,a){var s=1/i;return 0<s&&s<1||1<s&&s<2||2<s&&s<3||4<s&&s<5||0<L(e,o)?D:function(t,e,o,n,r,i,a){var s,l,u,c,h,f=1/i;if(i*=f<3?1:f<5?1.5:f<=6?2:2.5,c=B(e,o,a),x(c))return 0;for(u=(t-=l=m(c*i*t+.5))-n,s=0;s<r;s++){if((u-=l=m(i*t+.5))<0)return 0==(h=r-s)||1==h?m(.5*t+.5):0;t-=l}return l}(t,e,o,n,r,i,a)},6,7,dt,T,T,{bk:6}),r("AMORLINC",function(t,e,o,n,r,i,a){return 0<L(e,o)?D:(u=r,d=(s=t)*(c=i),g=s-(l=n),m=B(e,o,a),x(m)?0:(p=y(f=(s-l-(h=m*c*s))/d),0===u?h:u<=p?d*(f<1?f:1):u===p+1?g-d*p-h:0));var s,l,u,c,h,f,p,d,g,m},6,7,dt,T,T,{bk:6}),r("ODDFYIELD",function(t,e,o,n,r,i,a,s,l){var u,c,h,f=.1;if(E(s,[1,2,4])<0||0<L(o,t)||0<L(t,n)||0<L(n,e))return D;if(u=(c=Yt(!(u={fl:0,gl:1e3,hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0}),_t,u,f,t,e,r,i,a,s,l,o,n))[1],h=c[0]){for(f=1e-10;f<u.gl;f*=2)u=Zt(!1,_t,u,f,t,e,r,i,a,s,l,o,n)[1];u=(c=function(t,e,o,n,r,i,a,s,l,u,c){var h,f,p,d,g,m,y,b=0,v=t?15:2;if(!e.Wk||!e.Xk)return[!1,e];for(f=_(e.Zk-e.Yk)/(_(e.Zk)+_(e.Yk)),h=0;h<100+4*v;h++)if(d=p=0,g=h%4==0?1:h%4==2?2:3,e=(m=t?$t(!0,e,b,p,d,g,Wt,f,T,o,Jt):$t(!1,e,b,p,d,g,_t,f,a,s,l,o,n,u,c,r,i))[1],b=m[2],p=m[3],!(t&&m[0]===S||!t&&w(m[0]))){if(m[0])return[!0,e];if(e=(y=Et(p,d=t?Wt(p,o):_t(o,n,a,p,l,u,c,r,i)-s,e))[1],y[0])return[!0,e];if((f=_(e.Zk-e.Yk)/(_(e.Zk)+_(e.Yk)))<e.hl)return e._k<d&&(d=e._k,p=e.Yk),e.$k<d&&(p=e.Zk),e.al=p,[!0,e]}return[!1,e]}(!1,u,t,e,o,n,r,i,a,s,l))[1],h=c[0]}return h?u.al:D},8,9,[Y,Y,Y,Y,J,G,G,$,nt],T,T,{bk:8}),r("ODDLYIELD",function(t,e,o,n,r,i,a,s){return Vt(!1,t,e,o,n,i,a,s,r)},7,8,[Y,Y,Y,J,G,G,z,nt],T,T,{bk:7}),r("ODDLPRICE",function(t,e,o,n,r,i,a,s){return Vt(!0,t,e,o,n,i,a,s,r)},7,8,[Y,Y,Y,J,J,G,$,nt],T,T,{bk:7}),r("TBILLEQ",function(t,e,o){var n,r=Tt(e)-Tt(t);return 0<=L(t,e)||365<r?D:0==(n=360-o*r)?R:n<0?D:a(365*o/n)},3,3,pt),r("TBILLYIELD",function(t,e,o){var n=Tt(e)-Tt(t);return 0<=L(t,e)||365<n?D:(100-o)/o*(360/n)},3,3,pt),r("IRR",function(t,e){var o,n,r,i,a,s=d(t),l=[],u=!1,c=!1,h={fl:-1,gl:9999999,hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0};for(1<_(e)&&(e=.1),o=-1,r=n=0;r<s;r++)(i=t[r])!==g&&(0!==i&&(n=l.length+1,-1===o&&(o=l.length)),l.push(i),0<i&&(u=!0),i<0&&(c=!0));return l=l.slice(o,n+1),!u||!c||d(l)<2?D:(h=(a=function(t,e,o){for(var n,r,i,a,s,l,u,c=t.hl/2,h=0;0===e[h];)h++;for(n=e.slice(h),i=[!1,null],a=[o],.1!==o&&a.push(.1),a.push(-.1,.99*t.gl,t.fl+.01),s=0;!i[0]&&s<a.length;s++)i=Qt(v(t),n,a[s],c),p=n,m=g=d=void 0,(f=i)[0]&&(d=f[1].al,g=15,"number"==typeof d&&-10<d&&d<10&&((1<(m=""+d).indexOf("000000000000")||1<m.indexOf("999999999999"))&&(g=14)),d=b.Common.o.Lma(d,g),(.001<(y=te(d,p))||y<-.001)&&(f[0]=!1));var f,p,d,g,m,y;if(!i[0]){for(l=0,s=1,u=n.length;s<u;s++)l+=n[s];r=-l/n[0]-1,i=Qt(v(t),n,r,c)}return i}(h,l,e))[1],a[0]?h.al:D)},1,2,[st,Z],0,0,{bk:1}),r("MIRR",function(t,e,o){var n,r,i,a,s=0,l=0,u=0,c=0,h=0,f=[],p=d(t);if(p<2)return R;for(n=0;n<p;n++)(r=t[n])!==g&&(f.push(r),u++,0!==r&&(0<r?s++:l++));if(l<1||s<1)return R;for(i=0;i<u;i++)0!==(a=f[i])&&(0<a?c+=a/A(1+o,i):h+=a/A(1+e,i));return 0===h||0===c||o<=-1?R:A(-c*A(1+o,u)/(h*(1+o)),1/(u-1))-1},3,3,[st,z,z],0,0),r("XIRR",function(t,e,o){var n,r,i,a,s,l,u,c=d(t);if(c!==d(e))return D;for(i=c-1;0<=i;i--)n=0<t[i]||n,r=t[i]<0||r,e[i]===g&&(0!==t[i]?e[i]=0:(t.splice(i,1),e.splice(i,1)));return n&&r?0===t[0]?0===o?4.88281e-9:2.98023e-9:(a=(s=Yt(!0,Jt,a={fl:-1,gl:1e10,hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0},o,t,e))[1],s[0]?(l=a.al,Math.abs(l)<a.hl?2.98023e-9:l):(u=ne(t,e,o,a))[0]?u[1]:D):D},2,3,[ct,lt,Z],"!= 2","!= 2",{bk:2}),r("RATE",function(t,e,o,n,r,i){var a,s,l,u,c,h;if(r=r?1:0,a=A(17976931348623157e282,1/t),l=(u=function(t,e,o){var n,r,i,a,s,l,u,c,h=t.hl/2;for(n=0;n<100;n++){if(a=void 0,l=s=0,o<t.fl||o>t.gl)return[!1,t,e];if(e=(u=Ut(o,s,e))[2],s=u[1],!(a=u[0]))return[a,t,e];if(t=(c=Et(o,s,t))[1],c[0])return[!0,t,e];if(e=(u=Ut(o,l,e,!0))[2],l=u[1],!(a=u[0]))return[a,t,e];if(0===l)return[!1,t,e];if((r=o-1.000001*s/l)===o)return t.al=o,[!0,t,e];if(i=_(r-o)/(_(o)+_(r)),o=r,i<h)return t.al=o,[!0,t,e]}return[!1,t,e]}(s={hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0,fl:f(-1e10,1-a),gl:N(1e10,a-1)},l={bl:t,cl:e,dl:o,el:n,Nc:r},i))[2],s=u[1],!(c=u[0])){for(h=2;(!s.Xk||!s.Wk)&&h<100;h*=2)l=(u=qt(s,i*h,l))[2],l=(u=qt(s=u[1],i/h,l))[2],s=u[1];s=(u=Kt(!0,!1,s,l))[1],c=u[0]}return c?s.al:D},3,6,[G,z,z,W,{_i:0,Hi:2,aj:"< 0",bj:h},Z],T,T,{bk:[3,4,5]}),r("VDB",function(t,e,o,n,r,i,a){return r<n?D:t<e&&0===n&&1===r?t-e:function(t,e,o,n,r,i,a){var s,l,u,c,h=m(n),f=h,p=M(r),d=p,g=0;if(a)for(s=f+1;s<=d;s++)l=re(t,e,o,s,i),s===f+1?l*=N(r,h+1)-n:s===d&&(l*=r+1-p),g+=l;else u=o,c=void 0,n!==m(n)&&1<i&&o/2<=n&&(c=n-o/2,n=o/2,r-=c,u+=1),t-=ie(t,e,o,u,n,i),g=ie(t,e,o,o-n,r-n,i);return g}(t,e,o,n,r,i,a)},5,7,[J,J,it,J,J,q,X],T,T,{bk:[5,6]}),r("ACCRINT",function(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k;if(E(i,[1,2,4])<0||0<=L(t,o))return D;if(1===i||0===a||4===a)return M=n,I=r,R=At(S=t,o,N=a),k=F(S,N),R<0||k<=0?D:I*M*(R/k);for(s=t.getFullYear(),l=t.getMonth(),u=t.getDate(),c=o.getFullYear(),h=o.getMonth(),f=o.getDate(),p=e.getMonth(),d=e.getDate(),g=[],m=[],y=[],b=[31,28,31,30,31,30,31,31,30,31,30,31],v=0;v<i;v++)g[v]=(p+12*v/i)%12,m[v]=d<=b[g[v]]?d:b[g[v]],2===a?y[v]=360/i:3===a&&(y[v]=365/i);for(v=0;v<i;v++)w=g[C=v===i-1?0:v+1]>g[v]?2001:2002,y[v]=Tt(new Date(w,g[C],m[C]))-Tt(new Date(2001,g[v],m[v]));for(x=0,T=Tt(o);s<c||s===c&&l<h||s===c&&l===h&&u<f;){for(v=0;v<i&&(l<g[v]||l===g[v]&&u<m[v])&&(0===v||g[v]>g[v-1]);)v++;for(;v<i&&(l>g[v]||l===g[v]&&u>=m[v])&&(l!==g[++v-1]||u!==m[v-1]););C=--v===i-1?0:v+1,w=12<=l+12/i?s+1:s,A=Tt(new Date(s,l,u)),x+=r*n/i*(Math.min(Tt(new Date(w,g[C],m[C])),T)-A)/y[v],s=w,l=g[C],u=m[C]}return x},6,8,[Y,Y,Y,G,K,$,nt],T,T,{bk:[4,6,7]}),r("ACCRINTM",function(t,e,o,n,r){if(0<L(t,e))return D;var i=At(t,e,r),a=F(t,r);return i<0||a<=0?D:n*o*i/a},3,5,[Y,Y,G,K,nt],T,T,{bk:[3,4]}),r("DISC",function(t,e,o,n,r){if(0<=L(t,e))return D;var i=F(t,r),a=At(t,e,r);return a<=0||i<=0?D:(n-o)/n*(i/a)},4,5,[Y,Y,G,G,nt],T,T,{bk:3}),r("EFFECT",function(t,e){return A(1+t/e,e)-1},2,2,bt),r("INTRATE",function(t,e,o,n,r){if(0<=L(t,e))return D;var i=At(t,e,r),a=F(t,r);return i<=0||a<=0?D:(n-o)/o*(a/i)},4,5,mt,T,T,{bk:3}),r("NOMINAL",function(t,e){return e*(A(1+t,1/e)-1)},2,2,bt),r("DB",function(t,e,o,n,r){var i,a,s,l;if(o+(r<12?1:0)<n)return D;if(0===t)return 0;for(i=k(1-A(e/t,1/o),3),s=a=0,l=1;l<=n;l++)a+=s=1===l?t*i*r/12:l===o+1?(t-a)*i*(12-r)/12:(t-a)*i;return s},4,5,[J,z,et,et,{_i:12,Hi:2,aj:["< 1","> 12"]}],T,T,{bk:3}),r("DDB",function(t,e,o,n,r){var i,a=0,s=0;if(o<n)return D;if(t<=e)return 0;for(i=1;i<=n;i++)a+=s=N(s=r/o*(t-a),t-a-e);return s},4,5,[J,z,tt,tt,{_i:2,Hi:0,aj:"<= 0"}],T,T,{bk:3}),r("SLN",function(t,e,o){return(t-e)/o},3,3,[z,z,rt]),r("SYD",function(t,e,o,n){return o<n?D:(t-e)*(o-n+1)*2/(o*(o+1))},4,4,[z,J,et,tt]),r("DOLLARDE",function(t,e){return e<1?R:zt(!0,t,e)},2,2,vt),r("DOLLARFR",function(t,e){return 0===e?R:zt(!1,t,e)},2,2,vt),r("PRICE",function(t,e,o,n,r,i,a){return E(i,[1,2,4])<0||0<L(t,e)?D:jt(t,e,o,n,r,i,a)},6,7,[Y,Y,J,J,G,$,nt],T,T,{bk:6}),r("PRICEDISC",function(t,e,o,n,r){if(0<=L(t,e))return D;var i=At(t,e,r),a=F(t,r);return i<=0||a<=0?D:n-o*n*i/a},4,5,mt,T,T,{bk:3}),r("PRICEMAT",function(t,e,o,n,r,i){var a,s,l,u,c;return 0<=L(t,e)?D:(a=At(t,e,i),s=At(o,e,i),l=At(o,t,i),u=F(t,i),l<=0||u<=0||a<=0||s<=0?D:0==(c=1+a/u*r)?D:(100+s/u*n*100)/c-l/u*n*100)},5,6,[Y,Y,Y,J,J,nt],T,T,{bk:5}),r("ODDFPRICE",function(t,e,o,n,r,i,a,s,l){return E(s,[1,2,4])<0||0<L(o,t)||0<L(t,n)||0<L(n,e)?D:_t(t,e,r,i,a,s,l,o,n)},8,9,[Y,Y,Y,Y,J,J,G,$,nt],T,T,{bk:8}),r("TBILLPRICE",function(t,e,o){var n=Tt(e)-Tt(t);return 0<=L(t,e)||365<n?D:100*(1-o*n/360)},3,3,[Y,Y,G]),r("EURO",function(t){var e=Ot(t,2);return 0<=e?e:D},1,1,Q),r("EUROCONVERT",function(t,e,o,n,r){var i,a,s,l,u,c;return i=0,n||(c=o.substr(0,3),i=0<=E(c,["BEF","LUF","ESP","ITL","LUX"])?0:2),r.$i||(r.Qb=(u=e.substr(0,3),0<=E(u,["BEF","LUF","ESP","ITL","PTE","GRD","LUX"])?0:2)),s=Ot(e,r.Qb),l=Ot(o,r.Qb),0<=s&&0<=l?(a=t*l/s,n||(a=k(a,i)),a):h},3,5,[z,Q,Q,X,{Zi:!0,Hi:2,_i:3,aj:"< 3",bj:h}],T,T,{bk:[3,4]}),r("PDURATION",function(t,e,o){return ae(t,e,o,function(t,e,o){var n,r;return 0<e.value&&0<t.value&&0<o.value?(n=(Math.log(o.value)-Math.log(e.value))/Math.log(1+t.value),(r=Math.abs(n))<=179769e303?22250738585072014e-324<=r?n:0:R):D})},3,3),r("RRI",function(r,t,e){return ae(r,t,e,function(t,e,o){if(0<e.value&&0<t.value&&0<=o.value){r=Math.pow(o.value/e.value,1/t.value)-1;var n=Math.abs(r);if(n<=179769e303)return 22250738585072014e-324<=n?r:0}return D})},3,3)},"./src/functions-lookup.ts":function(t,e,o){"use strict";var u,N,v,C,b,m,n,i,w,x,r,a,R,T,A,s,l,k,E,c,D,S,M,h,f,p,d,I,g,y,j,_,O,F,P,L,H,B,V,z,W,G,U,J,Z,q,K,Y=this&&this.__extends||(Z=function(t,e){return(Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}Z(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function Q(t,e,o,n){return{row:t,col:e,rowCount:o,colCount:n}}function X(t,e,o){var n,r;return w(t)?v:t.isArray||t.isReference?((n=t.colCount)<e&&(r=e,e=o,o=r),t[o*n+e]):t[0]}function $(t,e,o){return o&&(null===t||null===e)||!w(e)&&((w(t)||s(t,!0))&&s(e,!0)||d(t)&&d(e)||I(t)&&I(e))}function tt(t,e,o,n,r){if(t<0||e<0||e<t||o<t||e<o)return-1;if(r)return j=t,_=e,F=O=o,L=P=n,O;if(P){if(_<++O){if(P!==L)return-1;O=F-1,P=!1}}else if(--O<j){if(P!==L)return-1;O=F+1,P=!0}return O}function et(t,e,o){var n=i(t),r=o;return n===e?r=0:e<n?r=1:n<e&&(r=2),r}function ot(e,o,n){var r,t,i,a;if(e===o)return 0;if(I(e)){if(!o&&0===x(""+e))return 0;if(s(o)&&!s(e))return 1;if(d(o))return 2;if(I(o)){r=void 0;try{r=(t=u.Common.CultureManager.getCultureInfo()).localeCompare?n?t.localeCompare(""+e,""+o):t.localeCompare(e.toLowerCase(),o.toLowerCase()):n?(""+e).localeCompare(""+o):e.toLowerCase().localeCompare(o.toLowerCase())}catch(t){r=n?(""+e).localeCompare(""+o):e.toLowerCase().localeCompare(o.toLowerCase())}return r<0?r=2:0<r&&(r=1),r}return o instanceof Date?et(e,o,1):-1}return I(o)?e||0!==x(""+o)?s(e)?2:d(e)?1:e instanceof Date?et(e,o,2):-1:0:d(e)&&s(o)?1:d(o)&&s(e)?2:(i=l(e))===(a=l(o))?0:i<a?2:1}function nt(t,e,o){var n=X(t,e,o);return w(n)?0:n}function rt(t,e,o,n){var r,i,a,s,l=-1,u=0,c=-1,h=-1,f=n?e.rowCount:e.colCount;if(--f<u)return-1;for(;u<=f;){for(r=v,a=t[0],1<=o!=(2===l)&&(c=h),i=h=tt(u,f,h=T((u+f)/2),0<=o,!0);!$(a,r)&&-1!==h&&!$(a,r=n?X(e,0,h):X(e,h,0));)h=tt(0,0,0,!1,!1),0<=o&&h<i?f=h:o<0&&i<h&&(u=h);if(-1===h&&1<=o!=(2===l))return c;if(-1===h)return-1;if(l=ot(a,r,!1),1<=o&&1===l)u=h+1;else if(1<=o&&2===l)f=h-1;else if(o<=-1&&1===l)f=h-1;else if(o<=-1&&2===l)u=h+1;else if(0===l){for(;o<=-1&&u<h||0<=o&&h<f;){if(s=0<=o?h+1:h-1,null===(r=n?nt(e,0,s):nt(e,s,0)))return-1;if(!$(a,r))break;if(0!==(l=ot(a,r,!1)))break;h=s}return h}}return 1<=o!=(2===l)?h:c}function it(t,e,o,n,r,i){var a,s,l,u,c,h,f=v,p=-1,d=t[0],g=I(d),m=b.zb(d),y=n?e.rowCount:e.colCount;for(g&&m&&(l=b.sb(m)),s=0;s<y;s++)if(c=r?y-1-s:s,$(d,u=n?X(e,0,c):X(e,c,0),i))if(h=I(u),a=g&&h&&m?(l.lastIndex=0,l.test(u)?0:1):ot(d,u,!1),1<=o&&1===a)a=-1,0<=p&&(a=ot(u,f,!1)),(p<0||0<=p&&1===a)&&(p=c,f=u);else if(o<=-1&&2===a)a=-1,0<=p&&(a=ot(u,f,!1)),(p<0||0<=p&&2===a)&&(p=c,f=u);else if(0===a)return c;return p}function at(t,e){var o,n;if(!e)for(o=x(t),n=void 0,n=1;n<o;n++)if(2===ot(t[n-1],t[n],!1))return;return 1}function st(t){var e=q.call(this,C)||this;return e.il=t,e}function lt(t,e,o,n,r,i){var a,s=K.call(this,t,[Q(e,o,n,r)])||this;return s.getValue=function(t,e,o){var n=this.Nc;return 0===n?this.getRow(0)+1+e:1===n?this.getColumn(0)+1+o:H.getValue.call(this,t,e,o)},(a=s).cj=e,a.Lk=o,a.Xj=n,a.Yj=r,a.Nc=i,s}function ut(t,e,o){var n,r,i,a,s;if(!t)return D;if(t.arrayFormulaMode,!(e=e!==C?e:t.getReference(t.source,Q(t.row,t.column,t.rowCount,t.columnCount)))||1!==e.getRangeCount())return D;if(i=[],o){if(a=e.getRow(0)+1,1<(r=e.getRowCount(0))){for(n=0;n<r;n++)i.push([a+n]);return new N.CalcArray(i)}return a}if(s=e.getColumn(0)+1,1<(r=e.getColumnCount(0))){for(n=0;n<r;n++)i.push(s+n);return new N.CalcArray([i])}return s}function ct(t,e,o,n,r,i){var a,s,l,u,c,h,f;return t&&o instanceof N.CalcReference?(l=o.getRowCount(0),u=o.getColumnCount(0),s=o.create([{row:o.getRow(0),col:o.getColumn(0),rowCount:i?l:1,colCount:i?1:u}]),gt(t,o,s.getRow(0),s.getColumn(0),s.getRowCount(0),s.getColumnCount(0))):(o instanceof N.CalcArray?(l=o.getRowCount(),u=o.getColumnCount()):Array.isArray(o)&&(l=o.rowCount,u=o.colCount),s=o),i&&u<n||!i&&l<n?S:(a=N.Convert.Ph(s,0,!0,!1,!1)).isError||a.isConvertError?S:0<=(c=r||r===C?rt(e,a,1,i):it(e,a,0,i))?t&&o instanceof N.CalcReference?(h=i?c:n-1,f=i?n-1:c,gt(t,o,o.getRow(0)+h,o.getColumn(0)+f,1,1),o.getValue(0,h,f)):i?nt(a,n-1,c):nt(a,c,n-1):M}function ht(t,e,o,n,r){return ct(t,e,o,n,r,!1)}function ft(t,e,o,n,r){return ct(t,e,o,n,r,!0)}function pt(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g=e;if(!g.isArray&&!g.isReference)return M;if(r=g.colCount,i=g.rowCount,1<r&&1<i)return D;if(2===o&&(2===n||-2===n))return D;if(a=2===n&&!at(g,!0),s=-2===n&&!at(g,!1),a||s)return M;if(u=(l=t)&&t[0],c=-1,w(o)&&(o=0),!w(n)&&0!==n||(n=1),-1===n&&(h=!0),0!==o&&2!==o||(f=0),1===n||-1===n){if(1===o)f=-1;else if(-1===o){if(b.ub(u))return M;f=1}c=it(l,g,f,1<i,h,!0)}else if(2===n||-2===n){if(1===r&&1===i){if(!$(u,p=g[0]))return M;if(0===(d=ot(u,p,!1)))return 1;if(0===o)return 0===d?1:M;if(1===o)return 2===d?1:M;if(-1===o)return 1===d?1:M}c=rt(l,g,f=2===n?1:-1,1<i)}return-1!==c&&(0!==o||xt(u,g[c]))?!xt(u,g[c])&&(2===n&&1===o||-2===n&&-1===o)?c+2:c+1:M}function dt(t,e,o,n){return t+=e,n?0!==o&&(t+="[",t+=""+o,t+="]"):t+=o,t}function gt(t,e,o,n,r,i){var a,s,l,u,c,h;t&&t.identity&&(a=t.identity.row,s=t.identity.col,l=t.source.getCalcSourceModel().qg(a,s),u=e.getSource(),l&&u.getRangeKey&&(c={id:u.id,row:o,col:n,rowCount:r,colCount:i},h=u.getRangeKey(u,c),l.eOb||(l.eOb={}),l.eOb[h]=c))}function mt(t,e){var o;return void 0===e&&(e=!1),k(t)||E(t)?o=t.toArray(0,!1):t.length&&t[0].length&&(o=t),o?yt(o,e):R(t)?t:D}function yt(t,e){var o,n,r,i,a,s,l;if(void 0===e&&(e=!1),n=t.rowCount,r=t.colCount,n||r||(n=t.length,r=t[0].length),i=t,e){for(i=[],a=0;a<r;a++)for(s=[],i.push(s),l=0;l<n;l++)s.push(t[l][a]);n=(o=[r,n])[0],r=o[1]}return i.rowCount=n,i.colCount=r,i}function bt(t){return 1===t||-1===t}function vt(t,a){var s=a.length;t.sort(function(t,e){var o,n,r,i;for(o=0;o<s;o++)if(r=(n=a[o])[0],0!==(i=N.gOb(t[r],e[r])))return n[1]?i:-i;return 0})}function Ct(t,o,e){if(e)t.forEach(function(t,e){t.push(o[e][0])});else{var n=o[0];t.forEach(function(t,e){t.push(n[e])})}}function wt(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I;for(void 0===o&&(o=1),n=[],r=3;r<arguments.length;r++)n[r-3]=arguments[r];if(l=s=0,u=D,E(t)?i=t:k(t)&&(s=(a=t).getRow(),l=a.getColumn()),c=i||a){if(h=c.getColumnCount(),f=c.getRowCount(),R(t))return u;for(p=[],d=void 0,b=y=void(m=g=0),v=1,C=arguments.length;v<C;v+=2){if(x=[].concat(mt(w=arguments[v])),R(x))return u;if(T=w.getRowCount(),A=w.getColumnCount(),g||(g=(d=1===A)?2:1,b=[].concat(mt(t,!d))),!(!d&&1===T&&A===h||d&&1===A&&T===f))return u;if(S=E(w),k(w)&&(M=void 0,d?0<=(M=l-w.getColumn())&&M<h?y=M:S=!0:0<=(M=s-w.getRow())&&M<f?y=M:S=!0),S&&(m+=1,y=d?h++:f++,Ct(b,x,d)),!bt(I=arguments[v+1]||1))return u;p.push([y,1===I])}return vt(b,p),m&&b.forEach(function(t){t.length-=m}),new N.CalcArray(d?b:yt(b,!0))}return u}function xt(t,e){return t===e||r(t)&&r(e)&&a(t)===a(e)||R(t)&&R(e)&&t._code===e._code}function Tt(t,e){var o,n;for(o=0,n=t.length;o<n;o++)if(!xt(t[o],e[o]))return;return 1}Object.defineProperty(e,"__esModule",{value:!0}),u=o("Common"),N=o("CalcEngine"),v=null,C=void 0,b=u.Common.q,m=u.Common.j,n=u.Common.l,i=n.lb,w=m.Fa,m.G,x=u.Common.k.ac,r=n.Ska,a=n.Ra,R=N.Convert.vf,T=N.Convert.Rh,A=N.Convert.Sh,s=N.Convert.Na,l=N.Convert.Pa,k=N.Convert._isReference,E=N.Convert.Ca,c=N.Convert.bc,D=N.Errors.Value,S=N.Errors.Reference,M=N.Errors.NotAvailable,h=N.Errors.Null,f=N.Errors.Calc,p=N.Functions.ak,d=N.Functions.ik,I=N.Functions.jk,g=1048576,y=16384,H=N.CalcReference.prototype,K=N.CalcReference,Y(lt,K),lt.prototype.type=function(){return this.Nc},lt.prototype.toArray=function(t,e){var o,n,r,i,a,s,l=[],u=this.cj,c=this.Lk,h=this.Nc,f=this.getRangeCount(),p=this.Xj,d=this.Yj;for(o=0;o<f;o++)for(e||(r=[],l.push(r)),a=0;a<p;a++)for(e||(i=[],r.push(i)),s=0;s<d;s++)n=0===h?u+1+a:1===h?c+1+s:H.getValue.call(this,o,u+a,c+s),e?l.push(n):i.push(n);return e||1!==f||(l=l[0]),l.rowCount=p,l.colCount=d,l.rangeCount=f,l},q=N.CalcArray,Y(st,q),st.prototype.getRowCount=function(){return N.CalcArrayHelper.getColumnCount(this.il)},st.prototype.getColumnCount=function(){return N.CalcArrayHelper.getRowCount(this.il)},st.prototype.getValue=function(t,e){return N.CalcArrayHelper.getValue(this.il,e,t)},B=st,z={Hi:7},G={Hi:2},U={Hi:2,aj:"<= 0",bj:D},J={Hi:4,Ii:0,Ji:!0},p("ADDRESS",function(t,e,o,n,r){var i,a=3===o||4===o||7===o||8===o,s=2===o||4===o||6===o||8===o,l="";return t<1&&(n||!a)||g<t||e<1&&(n||!s)||y<e||o<1||8<o?D:(l=function(t,e){if(e&&0<x(e)){var o=void 0,n=!N.ei(e[0])&&"_"!==e[0];for(o=1;!n&&o<x(e);o++)n=!N.fi(e[o])&&"_"!==e[o];n?(t+="'",t+=e.replace("'","''"),t+="'"):t+=e,t+="!"}return t}(l,r),l=n?(l=function(t,e,o){o||(t+="$");for(var n=t.length;.1<e;e=parseInt(""+(e-1)/26,10))t=u.Common.u.Eb(t,n,String.fromCharCode("A".charCodeAt(0)+(e-1)%26));return t}(l,e,s),i=l,a||(i+="$"),i+t):(l=dt(l,"R",t,a),dt(l,"C",e,s)))},2,5,[W={Hi:2},W,{_i:1,Hi:2},V={_i:!0,Hi:7},{_i:"",Hi:5}],C,C,{bk:[2,3,4]}),p("INDEX",function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y;function b(t){return!w(t)&&!t._error}if(s=(a=t)!==(i=v)&&a.acceptsReference,l=a!==v&&a.arrayFormulaMode,e instanceof N.CalcReference){if(u={value:-1},c=e,r===C&&(r=1),(r=b(r)&&A(r,u)?u.value-1:i)>=c.getRangeCount())return S;if(r===i||r<0)return D;if(h=c.getRowCount(r),f=c.getColumnCount(r),p=c.getRow(r),d=c.getColumn(r),m=g=void 0,3===x(arguments)){if(1!==h&&1!==f)return S;1!==f?(n=o,o=1):1!==h&&(n=1)}if(o===C&&(o=0),-1===(o=b(o)&&A(o,u)?u.value-1:i)){if(1!==h&&!s&&!l&&(p>a.row||a.row>=p+h))return D}else{if(o<-1||o===i)return D;if(h<=o)return S;g=o+p}if(n===C&&(n=0),-1===(n=b(n)&&A(n,u)?u.value-1:i)){if(1!==f&&!s&&!l&&(d>a.column||a.column>=d+f))return D}else{if(n<-1||n===i)return D;if(f<=n)return S;m=n+d}return-1===o&&-1===n?(g=p,m=d):-1===o?(g=p,f=1):h=(-1===n?m=d:f=1,1),gt(t,c,g,m,h,f),c.create([Q(g,m,h,f)])}if(N.Convert.Ca(e))return h=(y=e).getRowCount(),o=o!==C?T(o):-1,n=n!==C?T(n):-1,1!==(r=r!==C?T(r)-1:1)?S:(-1===o&&-1===n?o=n=0:-1===n&&1===h&&(n=o,o=1),o=-1===o?0:o,n=-1===n?0:n,h=y.getRowCount(),f=y.getColumnCount(),o<0||n<0||r<0?D:(h<o&&1===h&&n===C&&(n=o,o=0),h<o||f<n?S:0===o&&0===n?y.slice(0,0,h,f):0===o?y.slice(0,n-1,h,1):0===n?y.slice(o-1,0,1,f):y.getValue(o-1,n-1)))},2,4,C,0,0,{bk:[1,2,3],KMc:[0],dk:!0,fk:3}),p("OFFSET",function(t,e,o,n,r,i){var a,s,l;return t?e&&e instanceof N.CalcReference&&1===e.getRangeCount()?(r=r!==C?T(r):e.getRowCount(0),i=i!==C?T(i):e.getColumnCount(0),a=e.getRow(0)+o,s=e.getColumn(0)+n,r<=0||i<=0||a<0||s<0?S:(l=e.create([{row:a,col:s,rowCount:r,colCount:i}]),gt(t,e,a,s,r,i),l)):D:M},3,5,[{},W,W],0,0,{bk:[3,4],KMc:[0],dk:!0,fk:2,returnReference:!0}),p("ROW",function(t,e){return ut(t,e,!0)},0,1,C,-1,C,{dk:!0,KMc:-1,expandColumns:!1}),p("COLUMN",function(t,e){return ut(t,e,!1)},0,1,C,-1,C,{bk:0,dk:!0,KMc:-1,expandRows:!1}),p("ROWS",function(t){return N.CalcArrayHelper.getRowCount(t)},1,1,C,-1,-1,{KMc:-1,expandColumns:!1,ck:!0}),p("COLUMNS",function(t){return N.CalcArrayHelper.getColumnCount(t)},1,1,C,-1,-1,{KMc:-1,expandRows:!1,ck:!0}),p("TRANSPOSE",function(t){return new B(t)},1,1,C,-1,-1),p("LOOKUP",function(t,e,o){var n,r,i,a,s,l,u,c=[];if(e)for(n=0;n<e.length;n++)c.push(e[n]);if(e.colCount<=e.rowCount?(c.colCount=e.colCount,c.rowCount=Math.ceil(c.length/c.colCount)):(c.rowCount=e.rowCount,c.colCount=Math.ceil(c.length/c.rowCount)),w(e.isReference)||(c.isReference=e.isReference),w(e.isArray)||(c.isArray=e.isArray),c.rangeCount=e.rangeCount,a=c.colCount,s=c.rowCount,l=t,o===C)return u=s<a?ht(C,l,c,s,!0):ft(C,l,c,a,!0),R(u)?M:u;if(i=N.Convert.Ph(o,0,!0,!1,!1)){if(1<i.colCount&&1<i.rowCount)return M}else i=c;return 0<=(r=rt(l,c,1,!(s<a)))?(a=i.colCount,(s=i.rowCount)<a?nt(i,r,s-1):nt(i,a-1,r)):M},2,3,[J,{Hi:4,Ii:0,Ji:!0,xTa:!0}],"!= 0","!= 0",{fk:1}),p("HLOOKUP",ht,3,4,[J,{},U,z],1,1,{dk:!0,KMc:[1]}),p("VLOOKUP",ft,3,4,[J,{},U,z],1,1,{dk:!0,KMc:[1],TAb:!0}),p("XLOOKUP",function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y=e.getRowCount(),b=e.getColumnCount(),v=1===y&&1===b,C=o.getRowCount(),w=o.getColumnCount(),x=1===y&&1<=b,T=1===C&&1<=w;if(v){if(1<C&&1<w)return D}else if(x&&b!==w||!x&&y!==C)return D;if((a=pt(t,N.Convert.Ph(e,0,!0),r,i))===M)return s="string"==typeof n?n:M,v?s:new N.CalcArray([[s]]);if(a===D)return D;if(0<a){if(v)return o;if(--a,l=[],N.Convert.Ca(o)){if(x)for(u=0;u<C;u++)c=o.getValue(0,a),l.push([c]);else h=T?[o.getValue(0,a)]:[o.getValue(a,0)],l.push(h);return new N.CalcArray(l)}if(o instanceof N.CalcReference)return p=(f=o).getRow(),d=f.getColumn(),g=C,m=w,x?(d=f.getColumn()+a,m=1):(p=f.getRow()+a,g=1),f.create([{row:p,col:d,rowCount:g,colCount:m}])}},3,6,[J,{},{},{Hi:5},{Hi:2,_i:0},{Hi:2,_i:1}],[1,2],[1,2],{bk:[3,4,5]}),p("CHOOSE",function(t){var e=arguments;return t<1||x(e)<=t?D:w(e[t])?0:e[t]},2,255,W,">= 1",">= 1",{gk:">= 1",isBranch:!0,findTestArgument:0,findBranchArgument:function(t){var e={value:-1};return R(t)?-1:(A(t,e),e.value)}}),p("MATCH",function(t,e,o){var n,r,i,a=t,s=e;return s.isArray||s.isReference?(n=s.colCount,r=s.rowCount,i=-1,1<n&&1<r||1===o&&!at(s,!0)||-1===o&&!at(s,!1)?M:(o===C?o=1:o===v&&(o=0),1===o?i=rt(a,s,1,1<r):0===o?i=it(a,s,0,1<r):-1===o&&(i=rt(a,s,-1,1<r)),-1===i?M:i+1)):M},2,3,[J,J,G],1,1,{}),p("XMATCH",pt,2,4,[J,J,G,G],1,1,{}),p("INDIRECT",function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g;return t?e?(i={row:n=t.row,col:r=t.column},a=(a=t.parser)||(t.parser=new N.Parser),(l=(s=t.source).parserContext)?(l.useR1C1=!o,l.row=i.row||0,l.column=i.col||0,l.baseIdentity=i,l.source=t.source):(s.parserContext=l=t.source?t.source.getParserContext(!o,i):new N.ParserContext(t.source,!o,i),l.onlyValidateSourceNameWithSpecial=!0),o?u=a.parse(l,e):(u=(h=(h=s.expressions)||(s.expressions={}))[e])||(u=a.parse(l,e),h[e]=u),u?(8===u.type&&(u=u.source?(c=u.source).getCustomName(u.value):t.getName(u.value)),!u||m.Ea(u.type,[1,13])<0?S:(c=u.source||t.source,25===u.type||26===u.type?c.getValueByName(u.nameIdentity):(f=u.getRange(n,r),13===u.type&&(c=u.source),p=t.source.getCalcSourceModel().qg(t.identity.row,t.identity.col),d=c.getReference(f),f.id=c.id,p&&c.getRangeKey&&(g=c.getRangeKey(c,f),p.eOb||(p.eOb={}),p.eOb[g]=f),d))):S):S:M},1,2,[{Hi:5},V],C,C,{bk:2,dk:!0}),p("HYPERLINK",function(t,e){var o;return(o=c(2===arguments.length?e:t)).__proto__.hyperlink=c(t),o},1,2),p("AREAS",function(){var t,e=0;for(t=0;t<x(arguments);t++){if(0===arguments[t].length)return h;arguments[t].isReference&&(e+=arguments[t].rangeCount)}return e},1,C,{Hi:4,Ji:!0,Ki:!0,Xi:!0},-1,-1),p("FORMULATEXT",function(t,e){var o=e.getRow(0),n=e.getColumn(0),r=e.getSource().getCalcSourceModel().getFormula(o,n);return r?"="+r:M},1,1,C,-1,C,{dk:!0}),p("ISFORMULA",function(t,e){var o=e.getRow(0),n=e.getColumn(0);return!!e.getSource().getCalcSourceModel().getFormula(o,n)},1,1,C,-1,C,{dk:!0}),p("SORT",function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A;if(void 0===e&&(e=1),void 0===o&&(o=1),void 0===n&&(n=!1),r=[].concat(mt(t,n)),R(r))return r;if(i=r,a=[],k(e)||E(e)){if(h=(c=e.toArray(0,!1)).rowCount,f=c.colCount,p=0,k(o)||E(o)){if(p=(l=o.toArray(0,!1)).rowCount,1!==f){if(f<1||1!==l.colCount&&l.colCount!==f||1!==h||!function(t){if(t&&t.length&&0<=t.length){for(var e=0;e<t.length;e++)if("number"!=typeof t[e])return;return 1}}(c[0]))return D;if((d=[]).push(t),n)for(i=yt(i,n),g=0;g<f;g++){for(m=[],y=0;y<i[0].length;y++)m.push(i[c[0][g]-1][y]);d.push(new N.CalcArray([m])),1===p?d.push(l[0][0]):d.push(l[g][0])}else for(g=0;g<f;g++){for(m=[],y=0;y<i.length;y++)m.push([i[y][c[0][g]-1]]);d.push(new N.CalcArray(m)),1===p?d.push(l[0][0]):d.push(l[g][0])}return wt.apply(wt,d)}if(1!==l.colCount||1!==p&&p!==h)return D;1===p&&(u=l[p=0][0])}else u=o;for(s=0;s<h;s++)a.push([c[s][0],s<p?l[s][0]:u])}else if(k(o)||E(o)){if(1!==(l=o.toArray(0,!1)).colCount||1!==l.rowCount)return D;a.push([e,l[0][0]])}else a.push([e,o]);for(b=i.colCount,v=[],C=0,w=a;C<w.length;C++){if(T=(x=w[C])[0],A=x[1],T<1||b<T||!bt(A))return D;v.push([T-1,1===A])}return vt(i,v),new N.CalcArray(n?yt(i,n):i)},1,4,C,[0,1,2],[0,1,2],{bk:[1,2,3]},!0),p("SORTBY",wt,2,C,C,[0,"%= 1"],[0,"%= 1"],C,!0),p("UNIQUE",function(t,e,i){var o,a,s,l;return void 0===e&&(e=!1),void 0===i&&(i=!1),o=mt(t,e),R(o)?o:(s=[],l=(a=o).rowCount,a.forEach(function(t,e){var o,n,r;if(!t.duplicated){for(o=0,n=e+1;n<l;n++)Tt(t,r=a[n])&&(r.duplicated=!0,o++);i&&0!==o||s.push(t)}}),new N.CalcArray(e?yt(s,e):s))},1,3,C,[0],[0],{bk:[1,2]},!0),p("FILTER",function(t,e,o){var n,r,i,a=mt(t);return R(a)?a:(n=a,r=[].concat(mt(e)),i=[],1===r.length&&r[0].length===n[0].length?n.forEach(function(t,e){var o=[];t.forEach(function(t,e){r[0][e]&&o.push(t)}),i.push(o)}):n.forEach(function(t,e){r[e][0]&&i.push(t)}),0===i.length?w(o)?f:o:new N.CalcArray(i))},2,3,C,[0,1,2],[0,1,2],C,!0),p("@",function(t,e){var o,n,r,i,a,s,l,u,c,h;return E(e)?e.getValue(0,0):k(e)?(n=(o=e).getColumn(),r=o.getRow(),i=o.getColumnCount(),a=o.getRowCount(),u=(s=t.row)-r,c=(l=t.column)-n,h=t.source===o.getSource(),1===a&&(!h||r!==s)&&0<=c&&c<i?o.getValue(0,0,c):1===i&&(!h||n!==l)&&0<=u&&u<a?o.getValue(0,u,0):1===a&&1===i?o.getValue(0,0,0):D):e},1,1,C,[0],[0],{dk:!0},!0)},"./src/functions-stat.ts":function(t,e,o){"use strict";var a,z,S,W,G,M,I,s,N,R,w,x,u,d,g,p,U,k,J,Z,l,E,T,q,K,m,D,Y,A,Q,j,r,c,_,y,O,n,i,h,b,f,v,C,F,P,L,H,B,V,X,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ht,ft,pt,dt,gt,mt,yt,bt,vt,Ct,wt,xt,Tt,At,St,Mt,It,Nt,Rt,kt,Et,Dt,jt,_t,Ot,Ft,Pt,Lt,Ht,Bt,Vt,zt,Wt,Gt,Ut,Jt,Zt,qt,Kt;function Yt(t){var e,o,n;return e=0===t?0:3<=(o=.5*Math.abs(t))?1:o<1?((((((((.000124818987*(n=o*o)-.001075204047)*n+.005198775019)*n-.019198292004)*n+.059054035642)*n-.151968751364)*n+.319152932694)*n-.5319230073)*n+.797884560593)*o*2:(((((((((((((-45255659e-12*(o-=2)+.00015252929)*o-19538132e-12)*o-.000676904986)*o+.001390604284)*o-.00079462082)*o-.002034254874)*o+.006549791214)*o-.010557625006)*o+.011630447319)*o-.009279453341)*o+.005353579108)*o-.002141268741)*o+.000535310849)*o+.999936657524,0<t?.5*(e+1):.5*(1-e)}function Qt(t,e,o,n){var r,i,a=[];return fe(t,a),0===(r=S(a))||e<a[0]||a[r-1]<e?q:0!==(i=1===r?1:function(t,e,o){var n,r,i,a,s,l=S(t);if(e!==t[0]){for(a=t[i=0],r=1;r<l&&t[r]<e;r++)t[r]!==a&&(a=t[i=r]);t[r]!==a&&(i=r),n=e===t[r]?o?i/(l-1):(r+1)/(l+1):0===i?0:(s=(e-t[i-1])/(t[i]-t[i-1]),o?(i-1+s)/(l-1):(i+s)/(l+1))}else n=o?0:1/(l+1);return n}(a,e,n))?l(i*N(10,o))/N(10,o):i}function Xt(t){return[22250738585072014e-324,17976931348623157e292,N(2,-53),N(2,-52),r.Ek(2,10)][t-1]||0}function $t(t,e,o){var n,r=0,i=0;if(e<1)return 0;for(n=1;n<=e;n++)if(o<(i+=k(Q(t[r=e-n]))))return r;return r}function te(t,e,o){var n,r,i,a,s;if(o<1||1e3<o||t<-1.1||1.1<t)return NaN;for(n=2*t,i=r=0,a=0,s=1;s<=o;s++)i=r,a=n*(r=a)-i+Q(e[o-s]);return.5*(a-i)}function ee(t){var e,o=[.16663894804518634,-1384948176067564e-20,9.81082564692473e-9,-1809129475572494e-26,6221098041892606e-29,-3399615005417722e-31,2683181998482699e-33,-2.868042435334643e-20,39628370610464347e-38,-6831888753985767e-39,14292273559424982e-41,-35475981581010704e-43,1025680058010471e-43,-3.401102254316749e-30,1276642195630063e-46],n=$t(o,15,Xt(3)),r=1/J(Xt(3)),i=U(w(Z(Xt(2)/12),-Z(12*Xt(1))));return t<10?NaN:i<=t?4930380657631324e-47:t<r?te((e=10/t)*e*2-1,o,n)/t:1/(12*t)}function oe(t){var e=[1.037869356274377,-.13364301504908918,.019408249135520562,-.0030107551127535777,.0004869461479715485,-8105488189317536e-20,13778847799559525e-21,-2380221089435897e-21,4.1640416213865184e-7,-7.359582837807599e-8,1.3117611876241675e-8,-2.3546709317742423e-9,4.2522773276035e-10,-771908941348408e-25,1407574648135907e-26,-25769072058024682e-28,4734240666629442e-28,-8724901267474264e-29,1612461490274055e-29,-29875652015665774e-31,5548070120908289e-31,-10324619158271569e-32,19250239203049852e-33,-3595507346526515e-33,6726454253787686e-34,-1260262416873522e-34,2.364488440860621e-20,-44419377050807936e-37,8354659446403425e-37,-15731559416479563e-38,29653128740247425e-39,-5594958348181595e-39,1056635426883568e-39,-19972483680670205e-41,3778297781883936e-41,-7153158688908174e-42,13552488463674214e-43,-25694673048487566e-44,48747756066216946e-45,-9.254211253084972e-30,1.757859784176024e-30,-3341002667773101e-46,6353393618023618e-47],o=$t(e,43,.1*Xt(3));return t<=-1?NaN:k(t)<=.375?t*(1-t*te(t/.375,e,o)):Z(t+1)}function ne(t){var e,o,n,r,i,a,s=1,l=[1,.5772156649015329,-.6558780715202538,-.0420026350340952,.1665386113822915,-.0421977345555443,-.009621971527877,.007218943246663,-.0011651675918591,-.0002152416741149,.0001280502823882,-201348547807e-16,-12504934821e-16,1133027232e-15,-2.056338417e-7,6.116095e-9,5.0020075e-9,-1.1812746e-9,1.043427e-10,77823e-16,-36968e-16,51e-14,-206e-16,-54e-16,14e-16];if(171<t)return 1e308;if(t===A(t))if(0<t)for(e=1,r=2;r<t;r++)e*=r;else e=1e308;else{if(1<k(t)){for(n=k(t),i=A(n),o=s=1;o<=i;o++)s*=n-o;n-=i}else n=t;for(a=l[24],o=23;0<=o;o--)a=a*n+l[o];e=1/(a*n),1<k(t)&&(e*=s,t<0&&(e=-g/(t*e*u(g*t))))}return e}function re(t){var e,o,n,r,i,a=0,s=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059],l=t;if(t<=0)return 1e308;if(1===t||2===t)return 0;for(t<=7&&(l=t+(a=A(7-t))),o=1/(l*l),n=2*g,r=s[9],e=8;0<=e;e--)r=r*o+s[e];if(i=r/l+.5*Z(n)+(l-.5)*Z(l)-l,t<=7)for(e=1;e<=a;e++)i-=Z(l-1),--l;return i}function ie(t,e){var o,n,r,i=n=t;return e<i&&(i=e),n<e&&(n=e),i<0?NaN:0===i?F:10<=i?(o=ee(i)+ee(n)-ee(i+n),-.5*Z(n)+.9189385332046728+o+(i-.5)*Z(i/(i+n))+n*oe(-i/(i+n))):10<=n?(o=ee(n)-ee(i+n),r=io(i),O(r)?NaN:Q(r)+o+i-i*Z(i+n)+(n-.5)*oe(-i/(i+n))):Z(ne(i)*(ne(n)/ne(i+n)))}function ae(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d=Xt(3),g=Z(d),m=Xt(1),y=Z(m),b=t,v=e,C=o;if(v/(v+C)<t&&(b=1-b,v=o,C=e),(v+C)*b/(v+1)<d)n=0,y<(i=v*Z(R(b,m))-Z(v)-ie(v,C))&&0!==b&&(n=U(i)),b===t&&v===e||(n=1-n);else{if(0===(l=C-x(C))&&(l=1),n=0,y<=(i=v*Z(b)-ie(l,v)-Z(v))&&(r=(n=U(i))*v,1!==l))for(s=A(R(g/Z(b),4)),u=1;u<=s;u++)n+=(r=r*((a=u)-l)*b/a)/(v+a);if(1<C){for(i=v*Z(b)+C*Z(1-b)-ie(v,C)-Z(C),c=A(R(i/y,0)),r=U(i-c*y),f=C*(h=1/(1-b))/(v+C-1),p=0,C===(s=A(C))&&--s,u=1;u<=s&&!(f<=1&&r/d<=p);u++)1<(r=(C-(a=u)+1)*h*r/(v+C-a))&&(--c,r*=m),0===c&&(p+=r);n+=p}b===t&&v===e||(n=1-n),n=R(w(n,1),0)}return n}function se(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g;function m(t,e){return t<0&&0<e||0<t&&e<0}for(r=t.ge(e),i=t.ge(o),s=0;s<1e3&&!m(r,i);s++)k(r)<=k(i)?((e+=2*((a=e)-o))<0&&(e=0),o=a,i=r,r=t.ge(e)):(o+=2*((a=o)-e),e=a,r=i,i=t.ge(o));if(0===r)return e;if(0===i)return o;if(!m(r,i))return n.jl=!0,0;for(h=i,p=u=r,d=.5*((f=l=e)+(c=o)),g=!0,s=0;s<500&&1e-307<k(p)&&o-e>222045e-21*R(k(e),k(o));)(g=g&&(u!==h&&h!==p&&p!==u&&(e<(d=l*p*h/(p-u)/(h-u)+f*h*u/(h-p)/(u-p)+c*u*p/(u-h)/(p-h))&&d<o)))||(d=.5*(e+o),c=o,h=i,g=!0),l=c,c=f,f=d,u=h,h=p,m(r,p=t.ge(d))?(o=f,i=p):(e=f,r=p),g=g&&2*k(p)<=k(h),++s;return f}function le(t,e){var o,n,r,i,a=S(e);for(o=0;o<a;o++)i=(r=(n=Q(e[o]))-t.M)/(t.N+1),t.M+=i,t.Q+=t.N*r*i,t.N++,t.kl+=n}function ue(t){var e,o=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],n=1.000000000190015,r=t,i=t+5.5;for(i-=(t+.5)*Z(i),e=0;e<=5;e++)n+=o[e]/++r;return-i+Z(2.5066282746310007*n/t)}function ce(t,e){var o,n,r,i,a=S(e);for(o=0;o<a;o++)(n=e[o])!==P&&(i=(r=n-t.M)/(t.N+1),t.M+=i,t.Q+=t.N*r*i,t.N++,t.kl+=n)}function he(t){t.sort(function(t,e){return t-e})}function fe(t,e){var o,n;for(o=0;o<S(t);o++)(n=t[o])!==P&&e.push(n);he(e)}function pe(t,e,o){var n,r,i,a,s,l,u,c,h=Math.expm1||function(t){return U(t)-1},f=Math.log1p||function(t){return Z(1+t)};return t<=0?0:1<=t?1:1===o?N(t,e):1===e?-h(o*f(-t)):(r=.5-t+.5,i=f(-t),s=Z(a=t),(c=(l=e)/(e+(u=o))<t)&&(l=o,u=e,a=r,s=i,i=Z(r=t)),n=function(t,e,o){var n,r,i,a,s,l,u,c,h,f=1,p=1,d=1-(e+o)/(e+1)*t;a=0===d?(n=0,r=1):(n=1)*(r=1/d),s=i=1,l=!5e4;for(;n=(f=(n+(c=s*(o-s)*t/(((u=e+2*s)-1)*u))*f)*r)+(h=-(e+s)*(e+o+s)*t/(u*(u+1)))*n*r,0!=(d=(p=(d+c*p)*r)+h*d*r)&&(l=k(a-(i=n*(r=1/d)))<222045e-21*k(a)),a=i,s+=1,s<5e4&&!l;);return a}(a,l,u),n/=l,n*=1<l&&1<u&&l/(l+u)<.97&&u/(l+u)<.97?de(a,l,u)*a*r:U(l*s+u*i-ge(!1,l,u)),c&&(n=.5-n+.5),1<n&&(n=1),n<0&&(n=0),n)}function de(t,e,o){var n,r,i,a,s,l;return 1===e?1===o?1:2===o?-2*t+2:t<=.01?o+o*U((o-1)*Z(1-t))-1:o*N(.5-t+.5,o-1):1===o?2===e?e*t:e*N(t,e-1):t<=0&&!(e<1&&0===t)||1<=t&&!(o<1&&1===t)?0:(n=Z(Xt(2)),r=Z(Xt(1)),i=Z(t<.1?1+t:1-t),a=(e-1)*Z(t),s=(o-1)*i,l=ge(!1,e,o),a<n&&r<a&&s<n&&r<s&&l<n&&r<l&&a+s<n&&r<a+s?N(t,e-1)*N(.5-t+.5,o-1)/ge(!0,e,o):U(a+s-l))}function ge(t,e,o){var n,r,i,a,s,l,u,c=o,h=e;return o<e&&(n=c,c=h,h=n),t&&c+h<171.624376956302?ye(c)/ye(c+h)*ye(h):(r=5.52468004077673,i=ve(c),i/=ve(c+h),i*=ve(h),a=c+h+r,s=t?i*J(a/(c+r)/(h+r)):Z(i)+.5*(Z(a)-Z(c+r)-Z(h+r)),l=c/(h+r),u=-c*Z(1+h/(c+r))-h*Z(1+l)-r,t?U(u)*s:u+s)}function me(t){var e=ve(t),o=t+6.02468004077673-.5,n=N(o,t/2-.25);return e*=n,e/=U(o),e*=n,t<=20&&t===r.wk(t)&&(e=l(e)),e}function ye(t){var e,o=Z(g),n=Z(Xt(2));return 171.624376956302<t?K:1<=t?me(t):.5<=t?me(t+1)/t:-.5<=t?n<=me(t+2)-Z(t+1)-Z(k(t))?K:me(t+2)/(t+1)/t:n<=(e=me(1-t)+Z(k(u(g*t))))-o?0:e<0&&n<o-e?K:U(o-e)*(u(g*t)<0?-1:1)}function be(t){return 171.624376956302<=t?me(t):1<=t?Z(me(t)):.5<=t?Z(me(t+1)/t):me(t+2)-Z(t+1)-Z(t)}function ve(t){var e,o,n,r,i=[23531376880.41076,42919803642.6491,35711959237.35567,17921034426.03721,6039542586.352028,1439720407.3117216,248874557.86205417,31426415.585400194,2876370.6289353725,186056.26539522348,8071.672002365816,210.82427775157936,2.5066282746310002],a=[0,39916800,120543840,150917976,105258076,45995730,13339535,2637558,357423,32670,1925,66,1];if(t<=1)for(e=i[12],o=a[12],n=11;0<=n;--n)e*=t,e+=i[n],o*=t,o+=a[n];else for(r=1/t,e=i[0],o=a[0],n=1;n<=12;++n)e*=r,e+=i[n],o*=r,o+=a[n];return e/o}function Ce(t,e){return t<=0?0:(r=(o=e/2)*Z(n=t/2)-n-be(o),i=U(r),o+1<n?1-i*function(t,e){for(var o=Xt(3),n=.5*o,r=1/o,i=0,a=0,s=1-t,l=e+2-t,u=0,c=e+1,h=1,f=1,p=l*e,d=e,g=c/p,m=!1,y=0;u=c*(l+=2)-h*(a=(s+=1)*(i+=1)),0!=(f=p*l-d*a)&&(m=k((g-(y=u/f))/y)<=n,g=y),h=c,d=p,p=f,k(c=u)>r&&(h*=o,c*=o,d*=o,p*=o),!m&&i<1e4;);return m?g:T}(o,n):i*function(t,e){for(var o=.5*Xt(3),n=t,r=1/t,i=r,a=1;i+=r=r*e/(n+=1),a+=1,o<r/i&&a<=1e4;);return 1e4<a?T:i}(o,n));var o,n,r,i}function we(t,e,o,n){var r,i,a,s=c(o,t);return O(s)?s:(r=Q(s),s=c(n-o,e-t),O(s)?s:(i=Q(s),s=c(n,e),O(s)?s:(a=Q(s),D(r*i/a))))}function xe(t,e,o){var n,r=pe(e/(e+t*t),e/2,.5);switch(o){case 1:return.5*r;case 2:return r;case 3:return N(1+t*t/e,-(e+1)/2)/(J(e)*ge(!0,.5,e/2));case 4:return n=.5*pe(e/(t*t+e),.5*e,.5),t<0?n:1-n}return T}function Te(t,e,o){var n,r,i,a={jl:!1},s=se((n=t,i=o,{ge:function(t){return n-xe(t,r,i)}}),.5*(r=e),e,a);return a.jl?q:s}function Ae(t,e){var o,n,r,i,a,s=!1,l=0;for(n=0;n<S(e);n++)for(a=e[n],r=0;r<S(a);r++)if(i=a[r],y(i)||f(i)||v(i))o=v(i)?0:Q(i),(!s||t&&l<o||!t&&o<l)&&(l=o),s=!0;else if(O(i))return i;return l}function Se(t,e,o,n){var r,i,a,s=0,l=0,u=0;for(r=0;r<S(e);r++)(i=e[r])!==P&&(i<o?s++:o<i?u++:l++);return 0===l?q:(a=(0===n?u:s)+1,t?a:a+(l-1)/2)}function Me(t,e,o,n){var r,i={ll:0,ml:0,n:0},a=function(t,e,o){var n,r,i,a,s,l,u,c;for(i=0;i<S(t);i++)for(l=!!(s=t[i]).isArray,u=!!s.isReference,a=0;a<S(s);a++)if((r=s[a])!==W)if(v(r)){if(z.ExcelCompatibleCalcMode){if(l)continue;if(u){e.n++;continue}}if(c={value:0},z.Convert.Th(r,c))n=c.value,e.ll+=n,e.ml+=n*n;else if(!s.isArray&&!s.isReference)return T;e.n++}else{if(O(r))return r;!y(r)||o&&"boolean"==typeof r&&s.isArray||(n=Q(r),e.ll+=n,e.ml+=n*n,e.n++)}}(t,i,n);return O(a)?a:i.n<=e?E:(r=R(0,(i.n*i.ml-i.ll*i.ll)/(i.n*(i.n-e))),r=o?J(r):r,D(r))}function Ie(t,e,o){var n,r,i,a,s,l=0,u=0,c=0,h=0,f=S(e);if(f!==S(o))return q;for(i=0;i<f;i++)n=e[i],r=o[i],n!==P&&r!==P&&(l+=n,u+=r,h++);if(h<=1)return E;for(a=l/h,s=u/h,i=0;i<f;i++)n=e[i],r=o[i],n!==P&&r!==P&&(c+=(n-a)*(r-s));return D(t?c/h:c/(h-1))}function Ne(t,e){var o,n,r,i,a=t?1:0,s=0;for(r=0;r<S(e);r++)for(o=e[r],i=0;i<S(o);i++)if((n=o[i])!==P){if(n<=0)return K;a=t?a*n:a+1/n,s++}return t?s<=0?E:D(N(a,1/s)):0===a?E:D(s/a)}function Re(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B=e.rowCount,V=e.colCount;if(l=(o=t?o!==G?Y(o,1,!1,!0,!0):e:(i=o!==G?o:function(t,e){var o=[];for(a=0;a<t;a++)for(o[a]=[],s=0;s<e;s++)o[a][s]=a*e+s+1;return new z.CalcArray(o)}(B,V),Y(i,1,!1,!0,!0))).rowCount,u=o.colCount,B===l&&V===u&&(n||!r)){for(f=t?l*u:Q(l*u),I=void(M=S=A=T=x=0),a=0;a<l;a++)for(s=0;s<u;s++)p=o[a][s],d=e[a][s],t&&(d=Z(d)),x+=p,T+=p*p,A+=d,S+=d*d,M+=p*d;return v=f*T-x*x,h=n?(f*M-x*A)/v:M/T,I=n?(A*T-x*M)/v:0,t&&(h=U(h),I=U(I)),y=[[h,I]],r&&(y[1]=[],y[2]=[],y[3]=[],y[4]=[],E=S-I*A-h*M,D=(k=f*M-x*A)*k/((N=f*T-x*x)*(R=f*S-A*A)),f<3?(y[1][0]=K,y[1][1]=K,y[2][1]=K,y[3][0]=K):(y[1][0]=J(E*f/(N*(f-2))),y[1][1]=J(E*T/(N*(f-2))),y[2][1]=J((R-k*k/N)/(f*(f-2))),y[3][0]=1==D?K:D*(f-2)/(1-D)),y[2][0]=D,y[3][1]=f-2,y[4][0]=R/f-E,y[4][1]=E),new z.CalcArray(y)}if(1===V&&B===l||1===B&&V===u){for(d=[],p=[],v=1===V,f=l,h=u,a=0;a<f;a++)d[a]=n?e[a][0]:e[0][a],t&&(d[a]=Z(d[a]));for(a=0;a<f;a++)for(p[a]=[],s=0;s<h;s++)p[a][s]=v?o[a][s]:o[s][a];for(j=[],c=0;c<h+1;c++)j[c]=[];for(g=0;g<h+1;g++)for(m=0;m<h+2;m++)j[g][m]=0;for(_=[],g=0;g<h+2;g++)_[g]=0;for(O=r?[]:W,c=0;c<f;c++)for(_[h+1]+=d[c]*d[c],j[0][h+1]+=d[c],_[0]=j[0][h+1],a=0;a<h;a++)for(j[0][a+1]+=p[c][a],j[a+1][0]=j[0][a+1],j[a+1][h+1]+=p[c][a]*d[c],_[a+1]=j[a+1][h+1],s=a;s<h;s++)j[s+1][a+1]+=p[c][a]*p[c][s],j[a+1][s+1]=j[s+1][a+1];if(j[0][0]=f,r){for(g=0;g<h+1;g++)for(O[g]=[],m=0;m<h+1;m++)O[g][m]=0;for(a=0;a<h+1;a++)O[a][a]=1}for(F=n?0:1,a=0;a<h+1;a++){if(0===j[a][a]){for(b=!1,s=a+1;!b&&s<h+1;s++)if(0!==j[s][a]){for(c=0;c<h+2;c++)v=j[a][c],j[a][c]=j[s][c],j[s][c]=v;if(r)for(c=0;c<h+1;c++)v=O[a][c],O[a][c]=O[s][c],O[s][c]=v;b=!0}if(!b)return K}for(C=1/j[a][a],c=F;c<h+2;c++)j[a][c]*=C;if(r)for(c=F;c<h+1;c++)O[a][c]*=C;for(s=F;s<h+1;s++)if(s!==a){for(C=-j[s][a],c=F;c<h+2;c++)j[s][c]+=C*j[a][c];if(r)for(c=F;c<h+1;c++)O[s][c]+=C*O[a][c]}n||(j[0][h+1]=0)}for(y=t?[[],h+1]:[[]],a=0;a<h+1;a++)y[0][a]=t?U(j[h-a][h+1]):j[h-a][h+1];if(r){if(t)y[1]=[],y[2]=[],y[3]=[],y[4]=[];else for(g=1;g<5;g++)for(y[g]=[],m=0;m<h+1;m++)y[g][m]=0;for(P=void 0,L=_[h+1]-_[0]*_[0]/f,P=_[h+1],a=0;a<h+1;a++)P-=j[a][h+1]*_[a];if(H=L-P,y[2][0]=0==L?K:H/L,y[4][0]=H,y[4][1]=P,0===(v=n?f-h-1:f-h)){for(a=0;a<h+1;a++)y[1][a]=K;y[2][1]=K}else{for(w=P/Q(v),n||(y[1][h]=q),a=F;a<h+1;a++)y[1][h-a]=J(w*O[a][a]);y[2][1]=J(w)}for(y[3][0]=0===P?K:Q(v)*H/(P*Q(h)),y[3][1]=Q(v),a=2;a<5;a++)for(s=2;s<h+1;s++)y[a][s]=q}return new z.CalcArray(y)}return K}function ke(t,e){var o,n,r,i,a,s=0,l=0,u=0,c=[];for(r=0;r<S(e);r++)for(a=e[r],c.push(a),i=0;i<S(a);i++)(o=a[i])!==P&&(s+=o,u++);for(n=s/u,r=0;r<S(e);r++)for(a=c[r],i=0;i<S(a);i++)(o=a[i])!==P&&(l+=t?(o-n)*(o-n):k(o-n));return t?D(l):0===u?E:D(l/u)}function Ee(){return i(arguments,2,7)}function De(t,e){return h([t,e],16)}function je(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v=o,C=o!==G&&j(o);if(o!==G){if(t=Y(t,0,!0,!1,!1),(o=Y(o,1,!0,!1,!1,!0,G,!0)).isError)return o[0]}else{if((t=Y(t,1,!0,!1,!1,!0,G,!0)).isError)return t[0];o=t}if(i=r=0,a=_(e),t.rowCount!==o.rowCount||t.colCount!==o.colCount)return T;for(p=t.rowCount,C&&(s=n.row,l=n.column,u=v.getRow(0),c=v.getColumn(0),h=n.source.getCalcSourceModel().qg(s,l),f=v.getSource(),C=h&&f.getRangeKey),d=0;d<S(t);d++)if(g=t[d],a&&a(g,!0)&&(m=o[d],C&&(y={id:f.id,row:u+d%p,col:c+x(d/p),rowCount:1,colCount:1},b=f.getRangeKey(f,y),h.eOb||(h.eOb={}),h.eOb[b]=y),m!==P)){if(O(m))return m;r+=m,i++}return 0===i?E:D(r/i)}function _e(t,e,o,n,r){var i,a,s,l=e,u=e,c=t?l.getRowCount():u.getRowCount(0),h=t?l.getColumnCount():u.getColumnCount(0),f=[];for(i=0;i<c;i++)for(f[i]=[],a=0;a<h;a++)s=t?l.getValue(i,a):u.getValue(0,i,a),f[i][a]=je(o,s,n,r);return new z.CalcArray(f)}function Oe(){return h(arguments,13)}function Fe(t,e,o){var n=z.CalcArrayHelper;if(z.Convert._isReference(t)){if(1!==n.getLength(t))return T;t=n.getValueByIndex(t,0)}return t=Q(t),M(t)?T:Se(!0,e,t,o)}function Pe(t,e,o){return Qt(t,e,o,!0)}function Le(t,e){return h([t,e],17)}function He(t,e){var o,n,r=0,i=0===e||"*"===e,a=_(e);for(o=0;o<S(t);o++)n=t[o],i&&n===W||!a||!a(n)||r++;return D(r)}function Be(){return i(arguments,2,8)}function Ve(){return i(arguments,2,10)}function ze(){return i(arguments,2,11)}function We(t,e){return Ie(!0,t,e)}function Ge(t,e,o){var n=uo(t/2);return O(n)?n:-Q(n)*(e/J(o))}function Ue(t){var e,o=t,n=o+5.5;return n-=(o+.5)*Z(n),e=1.000000000190015+76.18009172947146/(t+1),e-=86.50532032941678/(t+2),e+=24.01409824083091/(t+3),e-=1.231739572450155/(t+4),e+=.001208650973866179/(t+5),Z(2.506628274631001*(e-=5395239384953e-18/(t+6))/o)-n}function Je(t,e,o,n,r){var i,a,s,l,u,c,h;return t<n||r<t||n===r?K:(i=(t-n)/(r-n),a=Ue(e+o),s=Ue(e),l=Ue(o),u=Z(i),c=Z(1-i),h=U(a-s-l+e*u+o*c)*function(t,e,o){var n,r,i,a,s,l=1e-50,u=t+e,c=t+1,h=t-1,f=1,p=1-u*o/c;for(k(p)<l&&(p=l),n=p=1/p,r=1;r<=300&&(k(p=1+(a=(e-r)*r*o/((h+(i=r+r))*(t+i)))*p)<l&&(p=l),k(f=1+a/f)<l&&(f=l),n*=(p=1/p)*f,k(p=1+(a=0-(t+r)*(u+r)*o/((t+i)*(c+i)))*p)<l&&(p=l),k(f=1+a/f)<l&&(f=l),n*=s=(p=1/p)*f,!(k(s-1)<1e-20));r++);return n}(o,e,1-i)/o,D(i<(e+1)/(e+o+2)?h:1-h))}function Ze(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A=ie(e,o);for(i=t<=.5?(l=t,f=e,d=o,0):(l=1-t,f=o,d=e,1),C=(g=J(-Z(l*l)))-(2.30753+.27061*g)/(1+(.99229+.04481*g)*g),T=1<f&&1<d?(v=C*J((h=2/((m=1/(f+f-1))+(y=1/(d+d-1))))+(g=(C*C-3)/6))/h-(y-m)*(g+5/6-2/(3*h)),f/(f+d*U(v+v))):(y=(g=d+d)*N(1-(y=1/(9*d))+C*J(y),3))<=0?1-U((Z((1-l)*d)+A)/d):(y=(4*f+g-2)/y)<=1?U((Z(l*f)+A)/f):1-2/(y+1),g=1-f,y=1-d,w=0,u=1,T<3e-308?T=3e-308:1-222e-18<T&&(T=1-222e-18),x=R(1e-300,N(10,-13-2.5/(f*f)-.5/(l*l))),b=p=0,a=0;a<1e3;a++){for((C=((C=ae(T,f,d))-l)*U(A+g*Z(T)+y*Z(1-T)))*w<=0&&(p=R(k(u),3e-308)),c=1,s=0;s<1e3;s++){if(k(u=c*C)<p&&(0<=(b=T-u)&&b<=1)){if(p<=x)return 0!==i&&(T=1-T),D((r-n)*T+n);if(k(C)<=x)return 0!==i&&(T=1-T),D((r-n)*T+n);if(0!==b&&1!==b)break}c/=3}if(b===T)return 0!==i&&(T=1-T),D((r-n)*T+n);T=b,w=C}return 0!==i&&(T=1-T),D((r-n)*T+n)}function qe(t,e,o,n){var r,i,a,s;if(e<t)return K;if(!n){if(0===(i=N(r=1-o,e))){if(0===(i=N(o,e)))return K;for(a=0;a<e-t&&0<i;a++)i*=Q(e-a)/Q(a+1)*r/o;return i}for(a=0;a<t&&0<i;a++)i*=Q(e-a)/Q(a+1)*o/r;return i}if(e===t)return 1;if(0===(i=N(r=1-o,e))){if(0===(i=N(o,e)))return K;for(s=1-i,a=0;a<e-t&&0<i;a++)s-=i*=Q(e-a)/Q(a+1)*r/o;return s<0?0:s}for(s=i,a=0;a<t&&0<i;a++)s+=i*=Q(e-a)/Q(a+1)*o/r;return s}function Ke(t,e,o){var n,r,i=1-e,a=N(i,t);if(0===a){if(0===(a=N(e,t)))return K;for(n=1-a,r=0;r<t&&o<=n;r++)n-=a*=Q(t-r)/Q((r+1)*i/e);return Q(t-r)}for(n=a,r=0;r<t&&n<o;r++)n+=a*=Q(t-r)/Q((r+1)*e/i);return Q(r)}function Ye(t,e){var o,n,r,i,a,s,l=Z(J(g)),u=1/J(g),c=0,h=t,f=.5*h,p=e%2==0;if(1<e&&(c=U(-f)),a=b(-J(h)),O(a))return a;if(s=Q(a),n=p?c:2*s,2<e){if(h=.5*(e-1),r=p?1:.5,20<f){for(o=p?0:l,i=Z(f);r<=h;)o=Z(r)+o,n+=U(i*r-f-o),r+=1;return n}for(o=p?1:u/J(f),i=0;r<=h;)i+=o*=f/r,r+=1;return i*c+n}return n}function Qe(t,e){var o=ro(1-t,.5*e,2);return Q(o)}function Xe(t,e){var o,n,r,i,a=0,s=t.rowCount,l=t.colCount;if(s!==e.rowCount||l!==e.colCount)return q;if(1<s&&1<l)o=(s-1)*(l-1);else if(1<s&&1===l)o=s-1;else{if(!(1===s&&1<l))return q;o=l-1}for(n=0;n<S(t);n++)if(r=t[n],i=e[n],r!==P&&i!==P){if(0===i)return E;a+=(r-i)*(r-i)/i}return a<0?K:Ye(a,o)}function $e(t,e,o){var n=U(-e*t);return D(o?1-n:e*n)}function to(t,e,o){var n=Je(e*t/(e*t+o),.5*e,.5*o,0,1);return O(n)?n:1-Q(n)}function eo(t,e,o){var n=Ze(1-(1-t),o/2,e/2,0,1);return O(n)?n:(1/Q(n)-1)*(o/e)}function oo(t,e){var o,n,r,i,a,s,l={N:0,M:0,Q:0,kl:0};return ce(l,t),i=l.N-1,1===l.N?E:0==(o=l.Q/(l.N-1))?E:(l.N=0,l.M=0,l.Q=0,l.kl=0,ce(l,e),a=l.N-1,1===l.N?E:0==(n=l.Q/(l.N-1))?E:(s=to(o/n,i,a),O(s)?s:(1<(r=2*(1-Q(s)))&&(r=2-r),r)))}function no(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y,b;if(!1===n)return r=N(o,e),M(r)||!I(r)?E:1/(r*ne(e))*(N(t,e-1)*U(-t/o));if((t/=o)<=0)return K;if(1e3<e)return b=so(i=3*J(e)*(N(t/e,1/3)+1/(9*e)-1),0,1,!0),O(b)?b:Q(b);if(1e8<t)return 1;if(t<=1||t<e){if(b=io(e+1),O(b))return b;for(h=e*Z(t)-t-Q(b),y=f=1,d=e;y+=f=f*t/(d+=1),2220446049250313e-31<f;);h+=Z(y),y=0,-88<=h&&(y=U(h))}else{if(b=io(e),O(b))return b;for(h=e*Z(t)-t-Q(b),f=0,y=(s=(a=t)+(i=1))/(l=t*(g=(d=1-e)+t+1));;){if(u=(g+=2)*s-(m=(d+=1)*(f+=1))*i,0<k(c=g*l-m*a)){if(k(y-(p=u/c))<=w(2220446049250313e-31,2220446049250313e-31*p))break;y=p}i=s,a=l,l=c,1e37<=k(s=u)&&(i/=1e37,a/=1e37,s/=1e37,l/=1e37)}h+=Z(y),y=1,-88<=h&&(y=1-U(h))}return y}function ro(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m;if(t<2e-6)return 0;if(.999998<t)return F;if(u=2*e,i=e-1,m=io(e),O(m))return m;if(s=Q(m),u<-1.24*Z(t)){if((a=N(t*e*U(s+.6931471805599453*e),1/e))<5e-7)return NaN}else if(.32<u){if(m=lo(t,0,1),O(m))return m;d=Q(m),2.2*u+6<(a=u*N(d*J(l=.222222/u)+1-l,3))&&(a=-2*(Z(1-t)-i*Z(.5*a)+s))}else for(a=.4,n=Z(1-t)+s+.6931471805599453*i;p=(4.67+2*(h=a))/(l=1+a*(4.67+a))-.5-(6.73+a*(13.32+3*a))/(c=a*(6.73+a*(6.66+a))),a-=(1-U(n+.5*a)*c/l)/p,.01<k(h/a-1););for(g=1;g<=20;g++){if(m=no(l=.5*(h=a),e,1,!0),O(m))return m;if(p=(c=t-Q(m))*U(.6931471805599453*e+s+l-i*Z(a)),5e-7<k(h/(a+=p*(1+.5*p*(f=(210+(n=.5*p-(r=p/a)*i)*(140+n*(105+n*(84+n*(70+60*n)))))/420)-r*i*(f-r*((420+n*(735+n*(966+n*(1141+1278*n))))/2520-r*((210+n*(462+n*(707+932*n)))/2520-r*((252+n*(672+1182*n)+i*(294+n*(889+1740*n)))/5040-r*((84+2264*n+i*(1175+606*n))/2520-r*((120+i*(346+127*i))/5040))))))))-1))return.5*o*a}return.5*o*a}function io(t){return re(t)}function ao(t,e,o){var n,r=uo(t);return O(r)?r:(n=Q(r),D(U(e+o*n)))}function so(t,e,o,n){return n?b((t-e)/o):D(U(-(t-e)*(t-e)/(2*o*o))/(J(2*g)*o))}function lo(t,e,o){var n,r,i,a,s,l=t-.5;if(k(l)<=.42)r=l*(((-25.44106049637*(n=l*l)+41.39119773534)*n-18.61500062529)*n+2.50662823884)/((((3.13082909833*n-21.06224101826)*n+23.08336743743)*n-8.4735109309)*n+1);else{if(n=t,0<l&&(n=1-t),!(2220446049250313e-31<n))return 1e-300<n?(r=-2*Z(t),n=Z(6.283185307179586*r),r=J(r*(1-(n=n/r+(2-n)/(r*r)+(6*n-14-n*n)/(2*r*r*r)))),l<0?-r:r):l<0?-F:F;r=(((2.32121276858*(n=J(-Z(n)))+4.85014127135)*n-2.29796479134)*n-2.78718931138)/((1.63706781897*n+3.54388924762)*n+1),l<0&&(r=-r)}return a=.3989422804014327*U(-.5*(i=+r)*i),s=so(r,0,1,!0),O(s)?s:e+o*(r-=(s-t)/a)}function uo(t){return lo(t,0,1)}function co(t,e,o){var n,r=0;if(o)for(n=0;n<=t;n++)r+=U(-e)*N(e,n)/z.Functions.tk(n);else r=U(-e)*N(e,t)/z.Functions.tk(t);return D(r)}function ho(t,e,o){var n,r,i,a,s,l,u,c,h,f;if(1!==o&&2!==o)return K;if(r=t/J(n=e),i=n/(n+t*t),a=n-2,s=n%2,n=u=l=1,h=c=2+s,2<=a)for(f=A(c);f<=a&&(l+=u=u*i*(h-1)/h)!==n;f+=2)n=l,h+=2;return 1!=s?o*(1-(.5+.5*r*J(i)*l)):(1===e&&(l=0),o*(1-(.5+.3183098862*(r*i*l+p(r)))))}function fo(t,e){var o,n,r,i,a,s,l,u,c,h,f=t/2,p=f;if(1e20<e)return uo(f);if(a=p<.5?(c=0,2*p):2*((c=1)-p),k(e-2)<1e-12)s=0<a?J(2/(a*(2-a))-2):F;else if(Q(e)<1+1e-12)s=0<a?-d(1.5707963267948966*(a+1)):F;else{if(i=((94.5/((n=48/((o=1/(e-.5))*o))+(r=((20700*o/n-98)*o-16)*o+96.36))-3)/n+1)*J(1.5707963267948966*o)*e,.05+o<(u=N(i*a,2/e))){if(h=uo(.5*a),O(h))return h;l=Q(h),e<5&&(r+=.3*(e-4.5)*(l+.6)),u=(((((.4*(u=l*l)+6.3)*u+36)*u+94.5)/(r=(((.05*i*l-5)*l-7)*l-2)*l+n+r)-u-3)/n+1)*l,u=.002<(u*=o*u)?U(u)-1:.5*u*u+u}else u=((1/(((e+6)/(e*u)-.089*i-.822)*(e+2)*3)+.5/(e+4))*u-1)*(e+1)/(e+2)+1/u;s=J(e*u)}return 0!==c&&(s=-s),D(s)}function po(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A={N:0,M:0,Q:0,kl:0};if(1!==o&&2!==o)return K;if(1===n){if(v=b=y=m=g=d=p=void 0,S(t)!==S(e))return q;for(C=S(t),v=0;v<C;v++)t[v]=t[v]-e[v];for(m=y=b=p=0,v=0;v<C;v++)m+=g=(d=(w=t[v])-m)/(b+1),y+=b*d*g,b++,p+=w;if(b-1==0||0===b)return E;if(s=J(y/(b-1)),M(s)||!I(s))return K;a=(r=p/b)/(s/J(b)),c=b-1}else A.N=0,A.M=0,A.Q=0,A.kl=0,le(A,t),l=A.Q/(A.N-1),r=A.kl/A.N,h=A.N,A.N=0,A.M=0,A.Q=0,A.kl=0,le(A,e),u=A.Q/(A.N-1),i=A.kl/A.N,f=A.N,c=2!==n?1/((x=l/h/(l/h+u/f))*x/Q(h-1)+(1-x)*(1-x)/Q(f-1)):Q(h+f-2),a=(r-i)/J(l/Q(h)+u/Q(f));return T=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m=0===o||1===o?0:U(ue(t+e)-ue(t)-ue(e)+t*Z(o)+e*Z(1-o)),y=(t+1)/(t+e+2)<=o;for(y&&(n=t,t=e,e=n,o=1-o),r=4450147717014403e-323,s=t-1,k(u=(l=1)-(i=t+e)*o/(a=t+1))<r&&(u=r),c=u=1/u,h=1,f=2;h<=100;h++,f+=2)if(k(u=1+(p=h*(e-h)*o/((s+f)*(t+f)))*u)<r&&(u=r),k(l=1+p/l)<r&&(l=r),c*=(u=1/u)*l,k(u=1+(p=-(t+h)*(i+h)*o/((t+f)*(a+f)))*u)<r&&(u=r),k(l=1+p/l)<r&&(l=r),c*=d=(u=1/u)*l,k(Q(d-1))<5e-324)return g=m*c/t,y?1-g:g;return K}(.5*c,.5,c/(c+(a=k(a))*a)),O(T)?T:.5*o*Q(T)}function go(t,e,o,n){var r=U(-N(t/o,e));return D(n?1-r:e/N(o,e)*N(t,e-1)*r)}function mo(t,e,o){var n,r,i,a,s,l,u=0,c=0,h=0,f=0;if(o!==G&&(u=Q(o),M(u)))return T;for(a=0;a<S(t);a++)(s=t[a])!==P&&(c+=i=Q(s),h+=i*i,f++);return 0===f?q:1===f?E:(n=c/f,0===(r=o!==G?u:J((f*h-c*c)/(f*(f-1))))?E:(l=b((n-e)/(r/J(f))),O(l)?l:D(1-Q(l))))}Object.defineProperty(e,"__esModule",{value:!0}),a=o("Common"),z=o("CalcEngine"),S=a.Common.k.ac,W=null,G=void 0,M=isNaN,I=isFinite,s=parseInt,N=Math.pow,R=Math.max,w=Math.min,x=Math.floor,u=Math.sin,d=Math.tan,g=Math.PI,p=Math.atan,U=Math.exp,k=Math.abs,J=Math.sqrt,Z=Math.log,l=Math.round,E=z.Errors.DivideByZero,T=z.Errors.Value,q=z.Errors.NotAvailable,K=z.Errors.Number,m=z.Errors.Null,D=z.Convert.Nh,Y=z.Convert.Ph,A=z.Convert.Rh,Q=z.Convert.Pa,j=z.Convert._isReference,r=z.Functions.MathHelper,c=r.Bk,_=r.xk,y=z.Convert.Na,O=z.Convert.vf,n=z.Functions.Hfc,i=z.Functions.sk,h=z.Functions.sja,b=z.Functions.qk,f=z.Functions.ik,v=z.Functions.jk,C=z.Functions.Na,F=z.Functions.hk,P=z.Convert.CalcConvertedError,L=z.Functions.ak,H=z.Convert.Th,B=z.Convert.Sh,rt={Hi:0,aj:["< 0",">= 1"]},gt={Hi:4,Ii:1,Ji:!0,Ki:!0,Mi:!0,Xi:!0},mt={Hi:4,Ii:1,Ji:!0,Ki:!0,Xi:!0},yt={Hi:4,Ii:1,Ki:!0,Mi:!0},bt={Hi:4,Ii:0,Ji:!0},wt={Hi:4,Ii:0,Ji:!0,Ki:!0,Xi:!0},xt={Hi:4,Ii:0,Ji:!0,Ki:!0,Mi:!0,Xi:!0},At=[pt={Hi:4,Ii:1,Ji:!0,Ki:!0,Mi:!0},{Hi:2}],St=[pt,nt={Hi:0},{_i:3,Hi:2,aj:"< 1"}],Mt=[it={Hi:0,aj:["<= 0",">= 1"]},at={Hi:0,aj:"<= 0"},tt={Hi:2,aj:"< 1"}],It=[it,at,at,st={_i:0,Hi:0},lt={_i:1,Hi:0}],Nt=[et={Hi:2,aj:"< 0"},et,ut={Hi:0,aj:["< 0","> 1"]},V={Hi:7}],Rt=[et,ut,it],kt=[ct={Hi:0,aj:"< 0"},ht={Hi:0,aj:["< 1","> 10000000000"]}],Et=[ut,ot={Hi:2,aj:["< 1","> 10000000000"]}],Dt=[dt={Hi:4,Ii:1,Ji:!0,Ki:!0},dt],jt=[ct,at,V],_t=[ct,ft={Hi:0,aj:["< 1",">= 10000000000"]},ft],Ot=[ut,ft,ft],Ft=[pt,pt],Pt=[ct,at,at,V],Lt=[ut,at,at],Ht=[ut,nt,at],Bt=[nt,nt,at,V],Vt=[vt={Hi:4,Ii:1,Ji:!0},vt],zt=[et,ct,V],Wt=[ct,tt],Gt=[Ct={Hi:4,Ii:1,Ji:!0,Ki:!0,Li:!0},Ct,$={Hi:2},{Hi:2,aj:["< 1","> 3"]}],Ut=[ct,at,at,V],Zt=[Tt={Hi:4,Ii:1,Ki:!0,Li:!0},{},X={_i:!0,Hi:7},{_i:!(Jt=[pt,nt]),Hi:7}],qt=[{},pt,st],Kt=[{Hi:4,Ii:1,Ji:!0,Ki:!0,hOb:!0,Mi:!0},nt],L("TREND",function(t,e,o,n){var r,i;for(e=e!==G?Y(e,0,!1,!0,!1):t,o=o!==G?Y(o,0,!1,!0,!1):e,r=0;r<t.rowCount;r++)for(i=0;i<t.colCount;i++)if(!y(t[r][i]))return T;for(r=0;r<e.rowCount;r++)for(i=0;i<e.colCount;i++)if(!y(e[r][i]))return T;for(r=0;r<o.rowCount;r++)for(i=0;i<o.colCount;i++)if(!y(o[r][i]))return T;return a.Common.qc(t,e,o,n,Q,z.CalcArray,T,q)},1,4,[{Hi:4,Ii:0,Ki:!0},{},{},X],[0,1,2],[0,1,2],{bk:[1,2,3]}),L("GROWTH",function(t,e,o,n){return e=e!==G?Y(e,1,!1,!0,!0):t,o=o!==G?Y(o,1,!1,!0,!0):e,a.Common.sc(t,e,o,n,z.CalcArray,K,q)},1,4,[Tt,{},{},X],"!= 3","!= 3",{bk:[1,2,3]}),L("FORECAST",function(t,e,o){var n,r,i,a,s=0,l=0,u=0,c=0,h=S(e),f=0;if(h!==S(o))return q;for(n=0;n<h;n++)r=e[n],i=o[n],r!==P&&i!==P&&(s+=r,l+=i,u+=i*i,c+=i*r,f++);return 0===f||f*u-l*l==0?E:D(s/f-l/f*(a=(f*c-l*s)/(f*u-l*l))+a*t)},3,3,[nt,dt,dt],"> 0","> 0"),L("AVERAGE",function(){return n(arguments,2,1)},1,G,G,-1,-1),L("STDEV",Ee,1,G,G,-1,-1),L("STDEV.S",Ee,1,G,G,-1,-1),L("PERCENTILE",De,2,2,G,0,0),L("PERCENTILE.INC",De,2,2,G,0,0),L("MAX",function(){return n(arguments,2,4)},1,G,G,-1,-1),L("MAXA",function(){return Ae(!0,arguments)},1,G,wt,-1,-1),L("MIN",function(){return n(arguments,2,5)},1,G,G,-1,-1),L("MINA",function(){return Ae(!1,arguments)},1,G,wt,-1,-1),L("LARGE",function(t,e){return h([t,e],14)},2,2,Kt,0,0),L("SMALL",function(t,e){return h([t,e],15)},2,2,Kt,0,0),L("AVERAGEA",function(){var t,e,o,n,r=arguments,i=0,a=0;for(t=0;t<S(r);t++)for(n=r[t],e=0;e<S(n);e++)o=n[e],y(o,!0)||f(o)?(i+=Q(o),a++):o!==W&&!v(o)||a++;return 0===a?E:D(i/a)},1,G,xt,-1,-1),L("AVERAGEIF",function(t,e,o,n){return z.Convert._isReference(o)?_e(!1,o,e,n,t):z.Convert.Ca(o)?_e(!0,o,e,n,t):je(e,o,n,t)},2,3,G,[0,1,2],[0,1,2],{bk:2,KMc:[2],dk:!0}),L("MEDIAN",function(){return h(arguments,12)},1,G,gt,-1,-1),L("MODE",Oe,1,G,gt,-1,-1),L("MODE.SNGL",Oe,1,G,gt,-1,-1),L("GEOMEAN",function(){return Ne(!0,arguments)},1,G,mt,-1,-1),L("HARMEAN",function(){return Ne(!1,arguments)},1,G,gt,-1,-1),L("TRIMMEAN",function(t,e){var o,n,r,i=0,a=[];for(fe(t,a),o=function(t){var e,o=0;for(e=0;e<t.length;e++)t[e]!==P&&o++;return o}(a),r=n=s(""+o*e/2);r<o-n;r++)i+=Q(a[r]);return i/(o-2*n)},2,2,[pt,rt],0,0),L("FREQUENCY",function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d=0,g=e.rowCount,m=e.colCount;for(o=0;o<g;o++)for(n=0;n<m;n++)e[o][n]!==P&&d++;for(i=t.rowCount,a=t.colCount,s=[],l=[],u=d+1,o=d=0;o<g;o++)for(n=0;n<m;n++)(r=e[o][n])!==P&&(s[d++]=Q(r));for(c=s.slice(0),he(s),o=0;o<u;o++)l[o]=[0];for(o=0;o<i;o++)for(n=0;n<a;n++)if(r=t[o][n],y(r)){for(h=Q(r),f=!1,p=0;!f&&p<d;p++)h<=s[p]&&(l[c.indexOf(s[p])][0]++,f=!0);f||l[d][0]++}return new z.CalcArray(l)},2,2,[yt,yt],-1,-1),L("RANK",Fe,2,3,qt,[0,1],[0,1],{bk:2}),L("RANK.EQ",Fe,2,3,qt,[0,1],1,{bk:2}),L("KURT",function(){var t,e,o,n,r,i,a=arguments,s=0,l=0,u=0,c=0,h=S(a),f=[];if(0<h){for(i=a[0],f.push(i),n=0;n<S(i);n++)(t=i[n])!==P&&(s+=t,l+=t*t,c++);if(c<=3)return E;if(e=s/c,0===(o=J((c*l-s*s)/(c*(c-1)))))return E;for(r=0;r<h;r++)for(i=f[r],n=0;n<S(i);n++)(t=i[n])!==P&&(u+=N((t-e)/o,4));return D(c*(c+1)*u/((c-1)*(c-2)*(c-3))-3*(c-1)*(c-1)/((c-2)*(c-3)))}},1,G,gt,-1,-1),L("PERCENTRANK",Pe,2,3,St,0,0,{bk:2}),L("PERCENTRANK.INC",Pe,2,3,St,0,0,{bk:2}),L("PERCENTRANK.EXC",function(t,e,o){return Qt(t,e,o,!1)},2,3,St,0,0,{bk:2}),L("QUARTILE",Le,2,2,At,0,0),L("QUARTILE.INC",Le,2,2,At,0,0),L("COUNT",function(){return n(arguments,2,2)},1,G,G,-1,-1,{gk:-1}),L("COUNTA",function(){return n(arguments,2,3)},1,G,G,-1,-1,{gk:-1}),L("COUNTBLANK",function(t){var e,o=0;for(e=0;e<S(t);e++)t[e]!==W&&""!==t[e]||o++;return o},1,1,bt,-1,-1),L("COUNTIF",function(t,e){var o,n,r,i,a,s,l,u,c;if(e.isArray||e.isReference){for(n=o=void 0,r=0,i=[],a=e.rowCount,s=e.colCount,l=0;l<a;l++){for(u=[],c=0;c<s;c++,r++)n=He(t,e[r]),O(n)?u.push(n):(o=Q(n),M(o)?u.push(T):u.push(o));i.push(u)}return new z.CalcArray(i)}return He(t,e[0])},2,2,[bt,bt],[0,1],[0,1]),L("AVEDEV",function(){return ke(!1,arguments)},1,G,gt,-1,-1),L("STDEVA",function(){return Me(arguments,1,!0,!0)},1,G,xt,-1,-1),L("STDEVP",Be,1,G,G,-1,-1),L("STDEV.P",Be,1,G,G,-1,-1),L("STDEVPA",function(){return Me(arguments,0,!0,!1)},1,G,xt,-1,-1),L("VAR",Ve,1,G,G,-1,-1),L("VAR.S",Ve,1,G,G,-1,-1),L("VARA",function(){return Me(arguments,1,!1,!1)},1,G,xt,-1,-1),L("VARP",ze,1,G,G,-1,-1),L("VAR.P",ze,1,G,G,-1,-1),L("VARPA",function(){return Me(arguments,0,!1,!1)},1,G,xt,-1,-1),L("COVAR",We,2,2,Dt,-1,-1),L("COVARIANCE.P",We,2,2,Dt,-1,-1),L("DEVSQ",function(){return ke(!0,arguments)},1,G,gt,-1,-1),L("CONFIDENCE",Ge,3,3,Mt),L("CONFIDENCE.NORM",Ge,3,3,Mt),L("CONFIDENCE.T",function(t,e,o){return 1===o?E:e*Te(t,o-1,2)/J(o)},3,3,Mt),L("INTERCEPT",function(t,e){var o,n,r,i=0,a=0,s=0,l=0,u=0,c=S(t);if(c!==S(e))return q;for(r=0;r<c;r++)o=t[r],(n=e[r])!==P&&o!==P&&(i+=o,a+=n,s+=n*n,l+=n*o,u++);return 0===u||u*s-a*a==0?E:D(i/u-a/u*((u*l-a*i)/(u*s-a*a)))},2,2,[gt,gt],-1,-1),L("LINEST",function(t,e,o,n){return Re(!1,t,e,o,n)},1,4,Zt,[0,1],[0,1],{bk:[1,2,3],fk:1}),L("SLOPE",function(t,e){var o,n,r,i,a,s=0,l=0,u=0,c=0,h=0,f=S(e);if(f!==S(t))return q;for(o=0;o<f;o++)n=t[o],(r=e[o])===P||n===P||O(r)||O(n)||(s+=i=Q(n),l+=a=Q(r),u+=a*a,c+=a*i,h++);return h*u-l*l==0?E:D((h*c-l*s)/(h*u-l*l))},2,2,[gt,gt],-1,-1,{fk:1}),L("LOGEST",function(t,e,o,n){return Re(!0,t,e,o,n)},1,4,Zt,[0,1],[0,1],{bk:[1,2,3]}),L("STEYX",function(t,e){var o,n,r,i=0,a=0,s=0,l=0,u=0,c=0,h=S(t);if(h!==S(e))return q;for(o=0;o<h;o++)n=t[o],r=e[o],n!==P&&r!==P&&(i+=n,a+=n*n,s+=r,l+=r*r,u+=r*n,c++);return c*(c-2)==0||c*l-s*s==0?E:J((c*a-i*i-(c*u-s*i)*(c*u-s*i)/(c*l-s*s))/(c*(c-2)))},2,2,Dt,-1,-1),L("BETADIST",Je,3,5,[nt,at,at,st,lt],G,G,{bk:[3,4]}),L("BETA.DIST",function(t,e,o,n,r,i){if(t<r||i<t||r===i)return K;var a=(t-r)/(i-r);return n?pe(a,e,o):de(a,e,o)/(i-r)},4,6,[nt,at,at,V,st,lt],G,G,{bk:[5,6]}),L("BETAINV",Ze,3,5,It,G,G,{bk:[3,4]}),L("BETA.INV",Ze,3,5,It,G,G,{bk:[3,4]}),L("BINOMDIST",qe,4,4,Nt),L("BINOM.DIST",qe,4,4,Nt),L("NEGBINOMDIST",function(t,e,o){if(t+e-1<=0)return K;var n=c(t+e-1,e-1);return O(n)?n:D(Q(n)*N(o,e)*N(1-o,t))},3,3,[$,$,rt]),L("NEGBINOM.DIST",function(t,e,o,n){if(t+e-1<=0)return K;if(n)return 1-pe(1-o,t+1,e);var r,i=N(o,e);for(r=0;r<t;r++)i*=(r+e)/(r+1)*(1-o);return i},4,4,[et,tt,rt,V]),L("CRITBINOM",Ke,3,3,Rt),L("BINOM.INV",Ke,3,3,Rt),L("CHIDIST",Ye,2,2,kt),L("CHISQ.DIST.RT",Ye,2,2,kt),L("CHISQ.DIST",function(t,e,o){return(o?Ce:function(t,e){var o,n;if(t<=0)return 0;if(1391e3<e*t)o=U((.5*e-1)*Z(.5*t)-.5*t-Z(2)-be(.5*e));else{for(n=e%2<.5?(o=.5,2):(o=1/J(2*t*g),1);n<e;)o*=t/n,n+=2;o=1425<=t?U(Z(o)-t/2):o*U(-t/2)}return o})(t,e)},3,3,[ct,ot,V]),L("CHIINV",Qe,2,2,Et),L("CHISQ.INV.RT",Qe,2,2,[ut,tt]),L("CHISQ.INV",function(t,e){var o,n,r={jl:!1},i=se((o=t,{ge:function(t){return o-Ce(t,n)}}),.5*(n=e),e,r);return r.jl?q:i},2,2,Et),L("CHITEST",Xe,2,2,Dt,-1,-1),L("CHISQ.TEST",Xe,2,2,Dt,-1,-1),L("CORREL",function(t,e){var o,n,r,i,a,s,l,u,c=z.ExcelCompatibleCalcMode?5:1,h=Y(t,c,!0,!1,!1,!0),f=Y(e,c,!0,!1,!1,!0),p=0,d=0,g=0,m=0,y=0,b=S(f);if(b!==S(h))return q;for(s=a=0;s<b;s++){if(l=h[s],u=f[s],O(l))return l;if(O(u))return u;l!==P&&u!==P&&(p+=l,d+=u,g+=l*l,m+=u*u,a++)}if(a<=1)return E;if(o=p/a,n=d/a,r=J((a*g-p*p)/(a*(a-1))),i=J((a*m-d*d)/(a*(a-1))),0===r||0===i)return E;for(s=0;s<b;s++)l=h[s],u=f[s],l!==P&&u!==P&&(y+=(l-o)*(u-n));return D(y/Q((a-1)*r*i))},2,2,G,-1,-1),L("EXPONDIST",$e,3,3,jt),L("EXPON.DIST",$e,3,3,jt),L("FDIST",to,3,3,_t),L("F.DIST",function(t,e,o,n){return n?1-pe(o/(o+e*t),o/2,e/2):N(e/o,e/2)*N(t,e/2-1)/(N(1+t*e/o,(e+o)/2)*ge(!0,e/2,o/2))},4,4,[ct,ht,ht,V]),L("F.DIST.RT",to,3,3,_t),L("FINV",eo,3,3,Ot),L("F.INV.RT",eo,3,3,Ot),L("F.INV",function(t,e,o){var n=Ze(1-t,o/2,e/2,0,1);return O(n)?n:(1/Q(n)-1)*(o/e)},3,3,[ut,ot,ot]),L("FISHER",function(t){return Z((1+t)/(1-t))/2},1,1,{Hi:0,aj:["<= -1",">= 1"]}),L("FISHERINV",function(t){var e=U(2*t)-1,o=U(2*t)+1;return!I(e)&&0<e&&!I(o)&&0<o?1:e/o},1,1,nt),L("FTEST",oo,2,2,Ft,-1,-1),L("F.TEST",oo,2,2,Ft,-1,-1),L("GAMMADIST",no,4,4,Pt),L("GAMMA.DIST",no,4,4,Pt),L("GAMMAINV",ro,3,3,Lt),L("GAMMA.INV",ro,3,3,Lt),L("GAMMALN",io,1,1,at),L("GAMMALN.PRECISE",io,1,1,at),L("HYPGEOMDIST",function(t,e,o,n){return t>w(e,o)||t<R(0,e-n+o)||n<e||n<o?K:we(t,e,o,n)},4,4,[et,et,et,et]),L("HYPGEOM.DIST",function(t,e,o,n,r){var i,a;if(t>w(e,o)||t<R(0,e-n+o)||n<e||n<o)return K;if(r){for(a=i=0;a<=t;a++)i+=we(a,e,o,n);return i}return we(t,e,o,n)},5,5,[et,et,et,et,V]),L("LOGNORMDIST",function(t,e,o){return b((Z(t)-e)/o)},3,3,[at,nt,at]),L("LOGNORM.DIST",function(t,e,o,n){if(n)return b((Z(t)-e)/o);var r=(Z(t)-e)/o;return.3989422804014327*U(-r*r/2)/o/t},4,4,[at,nt,at,V]),L("LOGINV",ao,3,3,Ht),L("LOGNORM.INV",ao,3,3,Ht),L("NORMDIST",so,4,4,Bt),L("NORM.DIST",so,4,4,Bt),L("NORMINV",lo,3,3,Ht),L("NORM.INV",lo,3,3,Ht),L("NORMSDIST",b,1,1,nt,G,G),L("NORMSINV",uo,1,1,ut),L("NORM.S.INV",uo,1,1,ut),L("NORM.S.DIST",function(t,e){return e?(o=Q(.7071067811865475*-t),M(o)?T:(n=b(o*J(2)),O(n)?NaN:.5*(2-2*n))):U(-N(t,2)/2)/J(2*g);var o,n},2,2,[nt,V]),L("PEARSON",function(t,e){var o,n,r,i,a=0,s=0,l=0,u=0,c=0,h=S(t);if(h!==S(e))return q;for(n=o=0;n<h;n++)r=t[n],i=e[n],C(r)&&C(i)&&(a+=r,s+=i,l+=r*r,u+=i*i,c+=r*i,o++);return o*l-a*a==0||o*u-s*s==0?E:(o*c-a*s)/J((o*l-a*a)*(o*u-s*s))},2,2,Vt,-1,-1),L("RSQ",function(t,e){var o,n,r,i,a,s=0,l=0,u=0,c=0,h=0,f=0,p=S(e);if(p!==S(t))return q;for(o=0;o<p;o++)n=e[o],r=t[o],C(n)&&C(r)&&(s+=n,l+=r,u+=n*n,c+=r*r,h+=n*r,f++);return 0===(i=J((f*u-s*s)*(f*c-l*l)))?E:D((a=(f*h-s*l)/i)*a)},2,2,Vt,[0,1],[0,1]),L("POISSON",co,3,3,zt),L("POISSON.DIST",co,3,3,zt),L("PROB",function(t,e,o,n){var r,i,a,s,l,u,c=o;if(n!==G&&(c=Q(n),M(c)))return T;if(i=r=0,(a=S(t))!==S(e))return q;for(s=0;s<a;s++)if(l=t[s],u=e[s],l!==P&&u!==P){if(u<=0||1<u)return K;o<=l&&l<=c&&(r+=u),i+=u}return 1!==i?K:r},3,4,[Ct,dt,nt],[0,1],[0,1],{bk:3}),L("SKEW",function(){var t,e,o,n,r,i,a=arguments,s=0,l=0,u=0,c=0,h=[];for(o=0;o<S(a);o++)for(i=a[o],h.push(i),n=0;n<S(i);n++)(r=i[n])!==P&&(s+=r,l+=r*r,c++);if(c<=2)return E;if(t=s/c,0===(e=J((c*l-s*s)/(c*(c-1)))))return E;for(o=0;o<S(h);o++)for(i=h[o],n=0;n<S(i);n++)(r=i[n])!==P&&(u+=N((r-t)/e,3));return D(c*u/((c-1)*(c-2)))},1,G,gt,-1,-1),L("STANDARDIZE",function(t,e,o){return(t-e)/o},3,3,[nt,nt,at]),L("TDIST",ho,3,3,[ct,tt,$]),L("T.DIST",function(t,e,o){return xe(t,e,o?4:3)},3,3,[ct,tt,V]),L("T.DIST.RT",function(t,e){return ho(t,e,1)},2,2,Wt),L("T.DIST.2T",function(t,e){return ho(t,e,2)},2,2,Wt),L("TINV",fo,2,2,Et),L("T.INV.2T",fo,2,2,Et),L("T.INV",function(t,e){return t<.5?-Te(1-t,e,4):Te(t,e,4)},2,2,[{Hi:0,aj:["<= 0","> 1"]},ot]),L("TTEST",po,4,4,Gt,[0,1],[0,1]),L("T.TEST",po,4,4,Gt,[0,1],[0,1]),L("WEIBULL",go,4,4,Ut),L("WEIBULL.DIST",go,4,4,Ut),L("ZTEST",mo,2,3,Jt,0,0,{bk:2}),L("Z.TEST",mo,2,3,Jt,0,0,{bk:2}),L("PERMUT",function(t,e){t=Q(A(t)),e=Q(A(e));var o,n=1;if(t<0||e<0||t<e)return K;for(o=t-e+1;o<=t;o++)n*=o;return D(n)},2,2),L("COVARIANCE.S",function(t,e){return Ie(!1,t,e)},2,2,Dt,-1,-1),L("MODE.MULT",function(){var t,e,o,n=0,r=[],i=function(t){var e,o=[];for(e=0;e<S(t);e++)fe(t[e],o);return o}(arguments),a=S(i);for(t=0;t<a;t++){for(e=0,o=t+1;o<a;o++)i[t]===i[o]&&e++;n<e?(n=e,(r=[]).push([i[t]])):e===n&&r.push([i[t]])}return 0===n?q:new z.CalcArray(r)},1,G,mt,-1,-1),L("PERCENTILE.EXC",function(t,e){return h([t,e],18)},2,2,[pt,it],0,0),L("QUARTILE.EXC",function(t,e){return h([t,e],19)},2,2,[wt,$],0,0),L("RANK.AVG",function(t,e,o){return 1<t.rowCount||1<t.colCount?T:Se(!1,e,t[0],o)},2,3,[Ct,vt,st],[0,1],1,{bk:2}),L("PERMUTATIONA",function(t,e){var o,n=e;return 0<=t&&t<2147483647&&0<=n&&n<2147483647&&(t=Math.pow(s(t),s(n)),(o=Math.abs(t))<=179769e303)?22250738585072014e-324<=o?t:0:K},2,2,[nt,nt]),L("PHI",function(t){var e,o;return""===t?T:!0===H(t,e={value:0})?(t=.3989422804014327*Math.exp(-e.value*e.value*.5),(o=Math.abs(t))<=179769e303?22250738585072014e-324<=o?t:0:K):T},1,1),L("BINOM.DIST.RANGE",function(t,e,o,n){var r,i,a,s,l,u,c,h,f=[1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600,6227020800,87178291200,1307674368e3,20922789888e3,355687428096e3,6402373705728e3,0x1b02b9306890000,243290200817664e4,5109094217170944e4,11240007277776077e5,2585201673888498e7,6204484017332394e8,15511210043330986e9,40329146112660565e10,10888869450418352e12,30488834461171387e13,8.841761993739702e30,26525285981219107e16,8222838654177922e18,2631308369336935e20,8683317618811886e21,29523279903960416e22,1.0333147966386145e40,37199332678990125e25,13763753091226346e27,5230226174666011e29,20397882081197444e30,8159152832478977e32,3345252661316381e34,140500611775288e37,6041526306337383e37,2658271574788449e39,11962222086548019e40,5502622159812089e42,25862324151116818e43,12413915592536073e45,6082818640342675e47,30414093201713376e48,15511187532873822e50,8065817517094388e52,42748832840600255e53,2308436973392414e56,12696403353658276e57,7109985878048635e59,40526919504877214e60,23505613312828785e62,1.3868311854568984e80,832098711274139e67,5075802138772248e68,3146997326038794e70,198260831540444e73,12688693218588417e73,8.247650592082472e90,5443449390774431e77,3647111091818868e79,24800355424368305e80,1711224524281413e83,1.1978571669969892e100,8504785885678623e86,61234458376886085e87,44701154615126844e89,3307885441519386e92,248091408113954e95,18854947016660504e95,14518309202828587e97,11324281178206297e99,8946182130782976e101,7156945704626381e103,5.797126020747368e120,4753643337012842e107,3945523969720659e109,3314240134565353e111,281710411438055e114,2.4227095383672734e130,2107757298379528e117,18548264225739844e118,1650795516090846e121,14857159644817615e122,1.352001527678403e140,12438414054641308e126,11567725070816416e128,1087366156656743e131,1032997848823906e133,9916779348709496e134,9619275968248212e136,9426890448883248e138,9332621544394415e140,9332621544394415e142,942594775983836e145,9614466715035127e146,990290071648618e149,10299016745145628e150,1081396758240291e153,1.1462805637347084e170,1226520203196138e157,1324641819451829e159,14438595832024937e160,1588245541522743e163,1.7629525510902446e180,1974506857221074e167,22311927486598138e168,25435597334721877e170,2925093693493016e173,3.393108684451898e190,3969937160808721e177,4684525849754291e179,5574585761207606e181,6689502913449127e183,8.094298525273444e200,9875044200833601e187,1214630436702533e190,1506141741511141e192,1882677176888926e194,2372173242880047e196,30126600184576594e197,3856204823625804e200,4974504222477287e202,6466855489220474e204,847158069087882e207,11182486511960043e208,14872707060906857e210,19929427461615188e212,2.6904727073180504e230,3659042881952549e217,5012888748274992e219,6917786472619489e221,9615723196941089e223,13462012475717526e225,1898143759076171e228,2695364137888163e230,3854370717180073e232,55502938327393044e233,8047926057471992e236,11749972043909107e238,1727245890454639e241,25563239178728654e242,3.80892263763057e260,5713383956445855e247,862720977423324e250,13113358856834524e251,20063439050956823e253,30897696138473508e255,4789142901463394e258,7471062926282894e260,11729568794264145e262,1.853271869493735e280,29467022724950384e266,47147236359920616e268,7590705053947219e271,12296942187394494e273,20044015765453026e275,3287218585534296e278,5423910666131589e280,9003691705778438e282,1.503616514864999e300,25260757449731984e286,4269068009004705e289,7257415615307999e291];function p(t){return t<171?t<0?NaN:f[t]:1/0}if(t=B(t,r={value:0}),e=H(e,i={value:0}),o=B(o,a={value:0}),4===arguments.length&&n?n=B(n,s={value:0}):(n=o,s=a),!0!==t||!0!==e||!0!==o||!0!==n)return T;if(t=r.value,e=i.value,o=a.value,n=s.value,0<=t&&t<=2147483646&&0<=e&&e<=1&&0<=o&&o<=t&&o<=n&&n<=t){if(100<(l=t*e*(1-e)))return Yt((n-(e*=t)+.5)/(l=Math.sqrt(l)))-Yt((o-1-e+.5)/l);if(0==(u=function(t,e){var o,n,r,i;if(t<=e)return t===e&&0<=e?1:T;if(t<2*e&&(e=t-e),e<2)return 0<=e?0!==e?t:1:T;if(t<171)return p(t)/(p(e)*p(t-e));if(514<e)return T;if(8192<t){for(o=t,n=2;n<=e;n++)o*=--t/n;return o}for(r=t,t--,i=2;;)switch(e-i){case-1:return r;case 0:return t/i*r;case 1:return t*(t-1)/(i*(i+1))*r;case 2:return t*(t-1)*(t-2)/(i*(i+1)*(i+2))*r;default:r*=t*(t-1)*(t-2)*(t-3)/(i*(i+1)*(i+2)*(i+3)),i+=4,t-=4}}(t,o)*Math.pow(e,o)*Math.pow(1-e,t-o)))return 0;for(l=c=u,e/=1-e,h=o;h<n;h++)c+=l*=(t-h)/(h+1)*e;return c<=1?c:1}return K},3,4,[{_i:0},{_i:0},{_i:0}]),L("GAMMA",function(t){var e,o,n;if(0<t)t=Math.exp(re(t));else{if(0===(o=t+(e=Math.abs(s(t)))))return K;t=Math.pow(-1,e-1)*Math.exp(re(-o))*Math.exp(re(1+o))/Math.exp(re(e+1-o))}return(n=Math.abs(t))<=179769e303?22250738585072014e-324<=n?t:0:K},1,1,at),L("GAUSS",function(t){t=Yt(t)-.5;var e=Math.abs(t);return e<=179769e303?22250738585072014e-324<=e?t:0:K},1,1,nt),L("SKEW.P",function(){var t,e,o,n,r,i,a,s,l,u,c=arguments,h=0,f=0,p=[];for(o=0;o<S(c);o++){if(i=c[o],1===S(c)&&0===S(i))return m;for(n=0;n<S(i);n++)a={value:0},(r=i[n])!==P&&"boolean"!=typeof r&&H(r,a)&&(h+=a.value,f++,p.push(a.value))}if(f<=2)return E;for(t=h/f,o=u=l=s=0;o<p.length;o++)u=p[o]-t,l+=N(u,2),s+=N(u,3);return 0===(e=J(l/f))?E:D(s/f/e/e/e)},1,G,xt,-1,-1)},CalcEngine:function(t,e){t.exports=o("@grapecity/js-calc")},Common:function(t,e){t.exports=o("@grapecity/js-sheets-common")}},a.c=r,a.d=function(t,e,o){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(e,t){var o,n;if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;if(o=Object.create(null),a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(n in e)a.d(o,n,function(t){return e[t]}.bind(null,n));return o},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/assets/",a(a.s="./src/advancedFunctions.entry.ts")),t.exports=i.Spread.CalcEngine.AdvancedFunctions},"./node_modules_local/@grapecity/js-calc-advancedfunctions/index.js":function(t,e,o){t.exports=o("./node_modules_local/@grapecity/js-calc-advancedfunctions/dist/gc.spread.calcengine.advancedfunctions.js")},"./node_modules_local/@grapecity/js-calc-basicfunctions/dist/gc.spread.calcengine.basicfunctions.js":function(t,e,o){var n,r,i="object"==typeof i?i:{};function a(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,a),e.l=!0,e.exports}i.Spread=i.Spread||{},i.Spread.CalcEngine=i.Spread.CalcEngine||{},i.Spread.CalcEngine.BasicFunctions=(r={},a.m=n={"./node_modules/webpack/buildin/global.js":function(t,e){var o;o=function(){return this}();try{o=o||Function("return this")()}catch(t){"object"==typeof window&&(o=window)}t.exports=o},"./src/basicFunctions.entry.ts":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("CalcEngine");e.Functions=n.Functions,o("./src/functions-basic.ts")},"./src/functions-basic.ts":function(t,Se,Me){"use strict";(function(p){var l,v,a,h,t,f,g,i,S,e,s,M,u,I,c,d,m,y,o,b,C,w,n,r,x,T,A,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J,Z,q,K,Y,Q,X,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ht,ft,pt,dt,gt,mt,yt,bt,vt,Ct,wt,xt,Tt,At,St,Mt,It,Nt,Rt,kt,Et,Dt,jt,_t,Ot,Ft;function Pt(t,e){for(;0!==e;){var o=t%e;t=e,e=o}return t}function Lt(t,e,o,n){return 0===e||0===t?0:0!==o&&t<0?!0===n?st(t/Math.abs(e))*Math.abs(e):at(t/Math.abs(e))*Math.abs(e):!0===n?at(t/Math.abs(e))*Math.abs(e):st(t/Math.abs(e))*Math.abs(e)}function Ht(t,e,o){var n,r,i,a,s,l,u=t[0],c=U(t[1],1,!0,!1,!1),h=S(c),f=c.rowCount,p=c.colCount,d=[],g=[],m=[],y=u.row,b=u.column,v=u.source.getCalcSourceModel().qg(y,b);function C(e){var o=e.getSource();return function(t){return{id:o.id,source:o,row:e.getRow(0)+t%f,col:e.getColumn(0)+w(t/f),rowCount:1,colCount:1}}}for(a=2;a<S(t);a+=2){if((l=U(t[a],0,!0,!1,!1)).rowCount!==f||l.colCount!==p)return k;s=it.xk(t[a+1]),d.push(l),g.push(s),4<=a&&v&&L(t[a])&&(l.getRef=C(t[a]))}for(v&&L(t[1])&&!o&&(c.getRef=C(t[1])),i=0;i<h;i++){for(r=!0,a=0;a<S(d)&&(s=g[a],n=d[a][i],r=s&&s(n),d[a].getRef&&qt(v,d[a].getRef(i)),r);a++);r&&(c.getRef&&qt(v,c.getRef(i)),n=c[i],!o&&n===F||m.push(n))}return e(m)}function Bt(t,e){return e=e<0?w(e):Math.ceil(e),(t&&e%2==0||!t&&e%2!=0)&&(e+=e<0?-1:1),e}function Vt(t,e,o){return 0<e&&o<0?O:e<0&&0<o?(o=-o,t?st(e/o)*o:at(e/o)*o):t?at(e/o)*o:st(e/o)*o}function zt(t,e,o){var n,r,i,a=it.yk(y(o));return n=at(e=o<0?e/a:e*a),r=st(e),t&&(i=n,n=r,r=i),e=e<0?n:r,J(e=o<0?e*a:e/a)}function Wt(t,e,o,n){var r,i,a,s=e?-1:1,l=0;if(S(o)!==S(n))return _;for(a=0;a<S(o);a++)r=o[a],i=n[a],r!==F&&i!==F&&(l+=t?(r-i)*(r-i):r*r+s*i*i);return J(l)}function Gt(t,e,o){var n=k;return 0<=s(t,[1,101,2,102,3,103,4,104,5,105,6,106,9,109])?n=ot(o,e,t):0<=s(t,[7,107,8,108,10,110,11,111])&&(n=rt(o,e,t)),n}function Ut(t,e){return it.Ak(t,e)}function Jt(t,e){return zt(!1,t,e)}function Zt(t,e){return at(t/y(e))*y(e)}function qt(t,e){var o,n=e.source;n.getRangeKey&&(o=n.getRangeKey(n,e),t.eOb||(t.eOb={}),t.eOb[o]=e)}function Kt(t){return J(Math.sin(t))}function Yt(t){return J(Math.cos(t))}function Qt(t){return J(it.Dk(t,!0))}function Xt(t){return J(it.Dk(t,!1))}function $t(t){var e=n(t),o=n(-t);return J(e-o)/(e+o)}function te(t){return J(r((1+t)/(1-t))/2)}function ee(t,e){var o,n,r,i,a=!0;for(o=0;o<S(e);o++)for(r=e[o],n=0;n<S(r);n++){if(v.ExcelCompatibleCalcMode){if("string"==typeof r[n]||M(r[n]))continue;a=!1}if(i={value:u},r[n]=ut(r[n],i)?i.value:F,t){if(!r[n])return!1}else if(r[n]&&r[n]!==F)return!0}return v.ExcelCompatibleCalcMode&&a?k:!!t}function oe(t){var e,o=t.getFullYear(),n=t.getMonth(),r=t.getDate();for(e=0;e<n;e++)r+=tt(o,e);return r}function ne(t){if(K(t)){if(7!==S(t)||c(m(t)))return k}else if(!c(t)){if(w(t)<1||17<w(t))return O;t=""+t}var e,o=["1","2","3","4","5","6","7"],n=[0,0,0,0,0,0,0];switch(S(t)){case 1:if(0<=s(t,o)){n[((e=m(t))+4)%7]=1,n[(e+5)%7]=1;break}return O;case 2:if("1"===t[0]&&0<=s(t[1],o)){n[((e=m(t[1]))+5)%7]=1;break}return O;case 7:for(e=0;e<7;e++)n[e]=m(t[e]);break;default:return k}return n}function re(t,e,o,n,r){var i,a=le(e,3);if(P(a))return a;for(i=V(a);o<0;++o)e.setDate(e.getDate()-1),i=0===i?6:--i,(t&&(5===i||6===i)||!t&&r[i]||0<=n.indexOf(f(e)))&&o--;for(;0<o;--o)e.setDate(e.getDate()+1),i=6===i?0:++i,(t&&(5===i||6===i)||!t&&r[i]||0<=n.indexOf(f(e)))&&o++;return f(e)}function ie(t,e,o,n,r,i){var a,s,l,u=V(f(e)),c=V(f(o)),h=!1;return c<u&&(a=e,e=o,o=a,s=u,u=c,c=s,h=!0),l=i(e,o,l=c-u+1,n),t&&P(l)?l:l<=0?0:(l=function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d;if(i&&(s=ne(t=t!==I?t:"0000011"),P(s)))return s;if(e!==I&&(a=U(e,4,!0,!0,!1)),!a)return r;if(a.isError)return a[0];for(l=S(a),u=[],c=0;c<l;c++)h=a[c],p=(f=g(h)).getDay(),d=S(s)?s[le(f,3)]:6===p||0===p,-1===u.indexOf(h)&&!d&&o<=h&&h<=n&&u.push(h);return r-S(u)}(n,r,u,c,l,t),l=h?-l:l)}function ae(t,e,o){var n,r;return e=v.Convert.Wh(e),(n=new Date(e.getFullYear(),e.getMonth(),1)).setMonth(n.getMonth()+o),r=tt(n.getFullYear(),n.getMonth()),n.setDate(t?r:C(e.getDate(),r)),n}function se(t){var e;return K(t)&&(e=i(t)),e?(60*(60*e.getHours()+e.getMinutes())+e.getSeconds())/86400:k}function le(t,e){var o=t.getDay();switch(e){case 1:return o+1;case 2:return 0===o?7:o;case 3:return 0===o?6:o-1;default:return O}}function ue(t,e,o,n){var r,i,a,s,l,u,c;if(r=ne(n=n!==I?n:"0000011"),a=i=0,P(r))return r;for(s=0;s<S(r);s++)1===r[s]&&i++;if(o<30){for(s=0;s<o;s++)r[(V(le(t,3))+s)%7]&&a++;return o-a}for(l=o,s=c=u=0;s<l&&V(le(t,3)+s)%7!=0;s++)u++;for(s=0;s<u;s++)r[(V(le(t,3))+s)%7]&&a++;for(s=0;s<l&&(V(le(e,3))+7-s)%7!=6;s++)c++;for(s=0;s<c;s++)r[(V(le(e,3))+7-s)%7]&&a++;return(o-=V((l=l-u-c)/7)*i)-a}function ce(t){var e,o,n;if(isNaN(t))return O;function r(t){var e=new Date(t,0,4),o=e.getDay();return 0===o&&(o=7),e.setDate(e.getDate()+1-o),e}return e=new Date(1900,1,28),t.getTime()<=e.getTime()&&t.setDate(t.getDate()-1),1900===(o=t.getFullYear())?o+=400:9999===o&&(o-=400),t.setYear(o),t.getTime()<new Date(o,11,29).getTime()&&o--,n=r(o+1),t.getTime()<n.getTime()&&(n=r(o)),m(""+(t.getTime()-n.getTime())/864e5/7)+1}function he(t){var e,o,n,r=""+t,i="",a=[];if(t<0&&(r=r.substr(1),i="-"),o=r.split("."),(n=S(o))<1||2<n)return k;for(2===n&&(a.push(o[1]),a.push(".")),r=o[0],e=S(r)-3;0<=e;e-=3)a.push(r.substr(e,3)),0<e&&a.push(",");return a.push(r.substring(0,e+3)),a.reverse(),i+a.join("")}function fe(t,e){var o,n,r,i,a=[],s=S(t);for(o=0;o<s;o++){if(r=t[o],0===(i=S(r))&&"concat"===e)return N;for(n=0;n<i;n++)M(r[n])||a.push(W(r[n]))}return a.join("")}function pe(t,e,o){var n,r=[],i=0;for(n=0;n<e.length;n++)if("fourByte"===Q(e[n])){if(0===i){i++;continue}i=0,r.push(e[n-1]+e[n])}else r.push(e[n]);return o>=r.length?e:r.splice(t?0:r.length-o,o).join("")}function de(t,e,o,n){var r,i,a=S(t);return e=C(e,a+1),o=C(o||0,a-e+1),r=t.substring(0,e-1),i=t.substr(e-1+o),r.concat(n).concat(i)}function ge(t,e,o){var n,r=S(e);if(0===r)return N;for(n=0;n<r;n++)M(e[n])||""===e[n]?o||t.push(""):t.push(W(e[n]))}function me(t,e,o){var n,r,i,a,s,l,u,c;if(be()||v.usedbcs){for(n=[],r=void 0,a=void(i=0),a=s=0;a<e.length;a++)if(r=e[a],"fourByte"===(l=Q(e[a]))){if(i%2==0){i++;continue}i++,r=e[a-1]+e[a],n[n.length]=r}else"doubleByte"===l&&(s++,r=e[a]),n[a-(0<i?i/2:0)+s]=r;return t||(n=$(n)),(u=n.length)<=o?e:(c=void 0,t?0<(c=n.slice(0,o-1<0?0:o)).length&&M(c[c.length-1])&&(c[c.length-1]="​"):0<(c=n.slice(u-o)).length&&M(c[0])&&(c[0]="​"),c.join(""))}return pe(t,e,o)}function ye(t,e,o){e--;var n=S(t);return n<=e?"":n<e+o?t.substr(e):t.substr(e,o)}function be(){return l.Common.CultureManager.q4().isJCKCulture}function ve(t,e,o){if(o<1||S(e)<o)return k;var n=e.indexOf(t,o-1);return-1===n?k:n+1}function Ce(t,e,o){var n,r,i=-1;return-1===(i=(n=a.ub(t))?(r=a.sb(n).exec(e),M(r)?-1:r.index):e.toLowerCase().indexOf(t.toLowerCase(),--o))?k:i+1}function we(t){for(var e=0;e<t.length;e++)M(t[e])&&t[e-1]&&2!==t[e-1].length&&(t[e]="​");return t.join("")}function xe(t,e){return e}function Te(t,e){return P(t)?_:H(t)?U(t,e,!0,!0,!1):U(t,e,!0,!0,!0)}function Ae(e,t){var n,r,i,o=t;if(!o||o.length>ft)return k;if(n=null,XMLHttpRequest&&(n=new XMLHttpRequest),r=function(t){e.setAsyncResult(t)},i=["application/json","application/xml","application/x-java-applet","application/java-archive","application/javascript","video/vnd.dlna.mpeg-tts"],null===n)return k;try{n.open("GET",o,!0),n.onreadystatechange=function(){var t,e,o;4===n.readyState&&(200===n.status?!(e=(t=n.response)&&t.type)||-1===e.indexOf("text")&&-1===i.indexOf(e)?r(k):((o=new FileReader).onloadend=function(){r(o.result)},o.onerror=function(){r(k)},o.readAsText(t)):r(k))},n.onerror=function(){r(k)},n.timeout=pt,n.ontimeout=function(){r(k)},n.responseType="blob",n.send(null)}catch(e){return k}}Object.defineProperty(Se,"__esModule",{value:!0}),l=Me("Common"),v=Me("CalcEngine"),a=l.Common.q,h=l.Common.u,t=l.Common.l,f=t.Ra,g=t.Xb,i=t.Qa,S=l.Common.k.ac,e=l.Common.j,s=e.Ea,M=e.Fa,u=null,I=void 0,c=isNaN,d=parseFloat,m=parseInt,Math.round,y=Math.abs,o=Math.sqrt,b=Math.max,C=Math.min,w=Math.floor,n=Math.exp,r=Math.log,x=Math.PI,T=Math.random,A=Math.pow,N=v.Errors.Null,R=v.Errors.DivideByZero,k=v.Errors.Value,E=v.Errors.Reference,D=v.Errors.Name,j=v.Errors.Calc,_=v.Errors.NotAvailable,O=v.Errors.Number,F=v.Convert.CalcConvertedError,P=v.Convert.vf,L=v.Convert._isReference,H=v.Convert.Ca,B=v.Convert.Uh,V=v.Convert.Rh,z=v.Convert.Pa,W=v.Convert.bc,G=v.Convert.Na,U=v.Convert.Ph,J=v.Convert.Nh,Z=v.Zh.tryExtractToSingleValue,q=v.Functions.ik,K=v.Functions.jk,Y=v.Functions.kk,Q=v.Functions.UAb,X=v.Functions.VAb,$=v.Functions.WAb,tt=v.Functions.nk,et=v.Functions.tk,ot=v.Functions.Hfc,nt=v.Functions.mja,rt=v.Functions.sk,it=v.Functions.MathHelper,at=it.zk,st=it.wk,lt=v.Functions.ak,ut=v.Convert.Th,ct=v.Convert.Uh,ht=v.Convert.jja,ft=2048,pt=1e4,dt=new Date(1900,0,1),gt=new Date(9999,11,31),yt={Hi:0,aj:"= 0",bj:R},bt={Hi:0,aj:"= 0",bj:0},vt={_i:1,Hi:0,aj:"= 0",bj:0},Ct={Hi:2,aj:"< 0"},wt={Hi:0,aj:["> 134217728","< -134217728"]},xt={Hi:1},Tt={Hi:2},At={_i:1,Hi:2},St={_i:1,Hi:2,aj:"< 0",bj:k},Mt={Hi:5},It={Hi:6},Nt={Hi:2,aj:"< 0",bj:k},Rt={_i:[],Hi:4,Ii:4,Ji:!0,Ki:!0,Li:!0},kt={Hi:4,Ii:1,Ki:!0,Li:!0},Et={Hi:4,Ii:1,Ji:!0,Ki:!0,Xi:!0},Dt={Hi:4,Ii:3,Ji:!0,Ki:!0,Xi:!0},jt={Hi:4,Ii:0,Ji:!0,Ki:!0,Xi:!0},_t=[0,"%= 1 && >= 3"],lt("ABS",function(t){return J(y(t))},1,1,mt={Hi:0}),lt("ACOS",function(t){return J(Math.acos(t))},1,1,{Hi:0,aj:["> 1","< -1"]}),lt("ACOT",function(t){return J(t<0?Math.PI+Math.atan(1/t):Math.atan(1/t))},1,1,mt),lt("ASIN",function(t){return J(Math.asin(t))},1,1,{Hi:0,aj:["> 1","< -1"]}),lt("ATAN",function(t){return J(Math.atan(t))},1,1,mt),lt("ATAN2",function(t,e){return 0===t&&0===e?R:J(Math.atan2(e,t))},2,2,[mt,mt]),lt("COS",Yt,1,1,mt),lt("SEC",function(t){var e=Yt(t);return 0===e?R:1/e},1,1,wt),lt("CEILING",function(t,e){return Vt(!0,t,e)},2,2,[bt,bt]),lt("ODD",function(t){return Bt(!0,t)},1,1,xt),lt("EVEN",function(t){return Bt(!1,t)},1,1,xt),lt("FLOOR",function(t,e){return Vt(!1,t,e)},2,2,[bt,bt]),lt("LN",function(t){return J(r(t))},1,1,{Hi:1,aj:"<= 0"}),lt("SQRT",function(t){return o(t)},1,1,{Hi:0,aj:"< 0"}),lt("SIN",Kt,1,1,mt),lt("CSC",function(t){var e=Kt(t);return 0===e?R:1/e},1,1,wt),lt("TAN",function(t){return J(Math.tan(t))},1,1,mt),lt("COT",function(t){return 0===t?R:J(1/Math.tan(t))},1,1,wt),lt("SIGN",function(t){return 0===t?0:-1},1,1,{Hi:1,aj:"> 0",bj:1}),lt("GCD",function(){var t,e,o,n,r=arguments,i=0;for(t=0;t<S(r);t++)for(o=r[t],e=0;e<S(o);e++)if((n=o[e])!==F){if(n<0)return O;i=Pt(i,V(n))}return i},1,I,Et,-1,-1),lt("LCM",function(){var t,e,o,n,r=arguments,i=1,a=[];for(t=0;t<S(r);t++){for(o=r[t],e=0;e<S(o);e++)if((n=o[e])!==F){if(n<0)return O;if(0===n)return 0;a.push(V(n))}for(e=0;e<S(a);e++)i/=Pt(i,n=a[e]),i*=n}return i},1,I,Et,-1,-1),lt("PRODUCT",function(){return ot(arguments,2,6)},1,I,I,-1,-1),lt("POWER",function(t,e){if(0===t&&e<0)return R;if(0===t&&0===e)return O;var o=v.Functions.MathHelper.YDc(t,e);return o===Number.POSITIVE_INFINITY||o===Number.NEGATIVE_INFINITY||isNaN(o)?O:o},2,2,[mt,mt]),lt("MOD",function(t,e){return t-e*w(t/e)},2,2,[mt,{Hi:0,aj:"= 0",bj:R}]),lt("QUOTIENT",function(t,e){return m(""+t/e)},2,2,[mt,yt],I,I),lt("SUBTOTAL",function(t){var e,o=arguments,n=[];for(e=1;e<S(o);e++)n[e-1]=o[e];return Gt(t,0,n)},2,I,Tt,"!= 0"),lt("_SUBTOTALFORSTATUSBAR",function(t){var e,o=arguments,n=[];for(e=1;e<S(o);e++)n[e-1]=o[e];return Gt(t,1,n)},2,5e3,Tt,"!= 0"),lt("INT",function(t,e){var o,n,r,i;if(L(e))if(o=e.getRow(0),n=e.getColumn(0),r=e.getRowCount(0),i=e.getColumnCount(0),1===r&&1===i)e=e.getValue(0,0,0);else if(1!==r&&1===i&&o<=t.row&&t.row<o+r)e=e.getValue(0,t.row-o,0);else{if(!(1===r&&1!==i&&n<=t.column&&t.column<n+i))return k;e=e.getValue(0,0,t.column-n)}return e=z(e),isNaN(e)?k:st(e)},1,1,I,[0],I,{dk:!0}),lt("MROUND",function(t,e){return t<0&&0<e||e<0&&0<t?O:st(t/e+.5)*e},2,2,[bt,bt]),lt("ROUND",Ut,2,2,[mt,Tt]),lt("ROUNDDOWN",Jt,2,2,[mt,Tt]),lt("ROUNDUP",function(t,e){return zt(!0,t,e)},2,2,[mt,Tt]),lt("TRUNC",Jt,1,2,[mt,{_i:0,Hi:2}],I,I,{bk:1}),lt("EXP",function(t){return J(n(t))},1,1,mt),lt("LOG",function(t,e){return 1===e?R:J(it.Ek(t,e))},1,2,[{Hi:0,aj:"<= 0"},{_i:10,Hi:0,aj:"<= 0"}],I,I,{bk:1}),lt("LOG10",function(t){return J(it.Ek(t,10))},1,1,{Hi:0,aj:"<= 0"}),lt("SUM",function(){var t,e,o,n,r,i;if(!v.ExcelCompatibleCalcMode)return function(){var t,e,o,n,r=arguments,i=0;for(t=0;t<S(r);t++){if(n=o=void 0,P(e=r[t]))return e;if(L(e)||H(e)){if((o=U(e,1,!0,!0,!1)).isError)return o[0]}else o=U(e,1,!0,!0,!0);for(n=0;n<S(o);n++)o[n]!==F&&(i+=o[n])}return i}.apply(null,arguments);for(t=arguments,o=e=0;o<S(t);o++){if(i=r=void 0,P(n=t[o]))return n;if(L(n)||H(n)){if((r=U(n,5,!0,!0,!1,!0)).isError)return r[0]}else r=U(n,1,!0,!0,!1,!0);for(i=0;i<S(r);i++)r[i]!==F&&(e+=r[i])}return e},1,I,I,-1,-1),lt("SUMIF",function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A=n!==I&&L(n);if(n=n!==I?n:e,M(o)&&(o=0),r=0,i=it.xk(o),a=H(e),s=H(n),(a?1:e.getRangeCount())!==(s?1:n.getRangeCount()))return k;if((l=n)===e||s||(u=a?e.getRowCount():e.getRowCount(0),c=a?e.getColumnCount():e.getColumnCount(0),u===n.getRowCount(0)&&c===n.getColumnCount(0)||(h=n.getRow(0),f=n.getColumn(0),l=n.create([{row:h,col:f,rowCount:u,colCount:c}]))),p=e.toArray(0,!1,!1),d=l.toArray(1,!1,!1),p.isError)return p[0];if(d.isError)return d[0];for(A&&(g=t.row,m=t.column,y=l.getRow(0),b=l.getColumn(0),v=t.source.getCalcSourceModel().qg(g,m),C=n.getSource(),A=v&&C.getRangeKey),w=0;w<S(p);w++)for(x=0;x<S(p[w]);x++)i&&i(p[w][x])&&((T=d[w]&&d[w][x])&&T!==F&&(r+=T),A&&qt(v,{id:C.id,source:C,row:y+w,col:b+x,rowCount:1,colCount:1}));return J(r)},2,3,I,[0,2],I,{bk:2,KMc:[2],fk:4,gk:1,dk:!0}),lt("SUMIFS",function(){return Ht(arguments,function(t){var e,o,n=0;for(e=0;e<t.length;e++){if(o=t[e],P(o))return o;n+=o}return n})},3,I,I,[0,"%= 1"],I,{KMc:_t,fk:4,dk:!0}),lt("SUMPRODUCT",function(){var t,e,o,n,r,i,a,s=arguments,l=0,u=[],c=0;for(t=0;t<S(s);t++){if((n=U(s[t],1,!0,!0,!1,!0)).isError)return n[0];if(n.isConvertError)return k;if(0===t)e=n.rowCount,o=n.colCount,c=S(n);else if(n.rowCount!==e||n.colCount!==o)return k;u.push(n)}for(t=0;t<c;t++){for(r=1,i=0;i<S(s);i++){if((a=u[i][t])===F){if(1===c)return k;r=0;break}r*=a}l+=r}return J(l)},1,I,I,-1,-1,{fk:1}),lt("SUMSQ",function(){var t,e,o,n,r=arguments,i=0;for(e=0;e<S(r);e++)for(n=r[e],o=0;o<S(n);o++)(t=n[o])!==F&&(i+=t*t);return J(i)},1,I,Et,-1,-1),lt("SUMX2MY2",function(t,e){return Wt(!1,!0,t,e)},2,2,Et,-1,-1),lt("SUMX2PY2",function(t,e){return Wt(!1,!1,t,e)},2,2,Et,-1,-1),lt("SUMXMY2",function(t,e){return Wt(!0,!1,t,e)},2,2,Et,-1,-1),lt("SERIESSUM",function(t,e,o,n){var r,i,a=0;for(r=0;r<S(n);r++){if(i=z(n[r]),c(i))return k;a+=i*A(t,e+r*o)}return J(a)},4,4,[mt,Tt,Tt,{Hi:4,Ii:1,Ji:!0,Ki:!0,Li:!0}],3,3),lt("PI",function(){return x},0,0),lt("SQRTPI",function(t){return J(o(t*x))},1,1,{Hi:0,aj:"< 0"}),lt("DEGREES",function(t){return 180*t/x},1,1,xt),lt("RADIANS",function(t){return x*t/180},1,1,mt),lt("COSH",Xt,1,1,mt),lt("SECH",function(t){if(709<t||t<-709)return 0;var e=Xt(t);return 0===e?R:1/e},1,1,mt),lt("ACOSH",function(t){return J(r(t+o(t*t-1)))},1,1,{Hi:0,aj:"< 1"}),lt("SINH",Qt,1,1,mt),lt("CSCH",function(t){if(709<t||t<-709)return 0;var e=Qt(t);return 0===e?R:1/e},1,1,mt),lt("ASINH",function(t){return J(r(t+o(t*t+1)))},1,1,mt),lt("TANH",$t,1,1,mt),lt("COTH",function(t){return 0===t?R:10<t?1:t<-10?-1:1/$t(t)},1,1,{Hi:0}),lt("ATANH",te,1,1,{Hi:0,aj:["<= -1",">= 1"]}),lt("ACOTH",function(t){return te(1/t)},1,1,{Hi:0}),lt("MDETERM",function(t){var e,o,n,r,i,a,s,l,u=t.rowCount,c=1;if(1<t.rangeCount||u!==t.colCount)return k;for(e=0;e<u-1;e++){if(0===t[e][e]){for(a=!1,o=e+1;!a&&o<u;o++)if(0!==t[o][e]){for(r=e;r<u;r++)s=t[e][r],t[e][r]=t[o][r],t[o][r]=s;c*=-1,a=!0}if(!a)return 0}for(n=e+1;n<u;n++)if(0!==t[n][e])for(l=t[n][e]/t[e][e],i=e;i<u;i++)t[n][i]-=l*t[e][i]}for(e=0;e<u;e++)c*=t[e][e];return c},1,1,kt,-1,-1),lt("MINVERSE",function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y=t.rowCount,b=[];if(1<t.rangeCount||y!==t.colCount)return k;for(e=0;e<y;e++)for(b[e]=[y],r=0;r<y;r++)b[e][r]=e===r?1:0;for(o=0;o<y;o++){if(0===t[o][o]){for(m=!1,i=o+1;!m&&i<y;i++)if(0!==t[i][o]){for(s=o;s<y;s++)d=t[o][s],t[o][s]=t[i][s],t[i][s]=d;for(l=1;l<y;l++)g=b[o][l],b[o][l]=b[i][l],b[i][l]=g;m=!0}if(!m)return O}for(a=0;a<y;a++)if(a!==o&&0!==t[a][o]){for(f=t[a][o]/t[o][o],u=o;u<y;u++)t[a][u]-=f*t[o][u];for(c=0;c<y;c++)b[a][c]-=f*b[o][c]}}for(n=0;n<y;n++)for(p=t[n][n],h=0;h<y;h++)b[n][h]/=p;return new v.CalcArray(b)},1,1,kt,-1,-1),lt("MMULT",function(t,e){var o,n,r,i,a,s,l=t.rowCount,u=t.colCount,c=e.rowCount,h=e.colCount,f=[];if(u!==c)return k;for(r=0;r<l;r++)for(f[r]=o=[],n=t[r],i=0;i<h;i++){for(a=s=0;a<c;a++)s+=n[a]*e[a][i];o[i]=s}return new v.CalcArray(f)},2,2,[kt,kt],-1,-1),lt("FACT",function(t){return et(t)},1,1,{Hi:3,aj:["< 0","> 170"]}),lt("FACTDOUBLE",function(t){var e,o=1;for(e=t;1<e;e-=2)o*=e;return o},1,1,{Hi:3,aj:["< 0","> 300"]}),lt("MULTINOMIAL",function(){var t,e,o,n,r=arguments,i=0,a=1;for(e=0;e<S(r);e++)for(t=r[e],o=0;o<S(t);o++){if((n=V(t[o]))<0||170<n)return O;i+=n,a*=et(n)}return i<0||170<i?O:et(i)/a},1,I,{Hi:4,Ii:0,Ji:!0,Ki:!0,Xi:!0},-1,-1),lt("RAND",function(){return y(2*T()-1)},0,0,I,I,I,{ck:!0}),lt("RANDBETWEEN",function(t,e){return e<t?O:V(t+T()*(e-t+1))},2,2,[Tt,Tt],I,I,{ck:!0}),lt("COMBIN",function(t,e){var o,n=1;if(t<e)return O;for(e=C(t-e,e),o=1;o<=e;o++)n*=t-o+1,n/=o;return J(n)},2,2,[Ct,Ct]),lt("COMBINA",function(t,e){var o,n=1;for(o=1;o<=e;o++)n*=t+o-1;for(o=2;o<=e;o++)n/=o;return J(n)},2,2,[Ct,Ct]),lt("DECIMAL",function(t,e){var o,n,r,i,a,s,l;if(!t||255<t.length)return 0;if(0===(o=t.length))return 0;if("-"===t[0])return O;for(n=0;n<o&&" "===t[n];)n++;if(r=0,n===o)return 0;for(a=o-(i=1);n<=a;a--){if((l=0<=(s=t.charCodeAt(a)|" ".charCodeAt(0))-"a".charCodeAt(0)?s-87:s-48)<0||e<=l)return O;r+=l*i,i*=e}return r},2,2,[{_i:"0",Hi:5},{Hi:0,aj:["> 36","< 2"]}]),lt("CEILING.MATH",function(t,e,o){return Lt(t,e,o,!0)},1,3,[mt,{Hi:0,_i:1},{Hi:0,_i:0}]),lt("FLOOR.MATH",function(t,e,o){return Lt(t,e,o,!1)},1,3,[mt,{Hi:0,_i:1},{Hi:0,_i:0}]),lt("BASE",function(t,e,o){var n=""+t.toString(e);return o&&n.length<o?Array.apply(null,{length:o-n.length+1}).join(0)+n:n},2,3,[{Hi:0,aj:["< 0",">= 9007199254740992"]},{Hi:3,aj:["> 36","< 2"]},{Hi:3,_i:0,aj:["< 0",">= 256"]}]),lt("ROMAN",function(t,e){var o,n,r,i,a,s,l,u,c=["M","D","C","L","X","V","I"],h=[1e3,500,100,50,10,5,1],f=[];if(4<(o=q(e)?e?0:4:e)||o<0)return k;for(n=0;n<7;n+=2){if(2<=n&&h[n-2]-h[n]<=t){for(i=(r=n)-2,a=void 0,a=0;a<o&&r+1<7&&h[i]-h[r+1]<=t;a++)r++;f.push(c[r]),f.push(c[i]),t+=h[r],t-=h[i]}if(1<=n&&h[n-1]<=t&&(f.push(c[n-1]),t-=h[n-1]),1<=n&&h[n-1]-h[n]<=t){for(l=(s=n)-1,u=void 0,u=0;u<o&&s+1<7&&h[l]-h[s+1]<=t;u++)s++;f.push(c[s]),f.push(c[l]),t+=h[s],t-=h[l]}for(;h[n]<=t;)f.push(c[n]),t-=h[n]}return f.join("")},1,2,[{Hi:2,aj:["< 0","> 3999"],bj:k},{_i:0}],I,I,{bk:1}),lt("ARABIC",function(t){var e,o,n,r,i,a,s,l,u,c;if(!t.length)return 0;if(255<t.length)return k;for(e=0,o=(t=t.toLowerCase()).length-1,r=0,s=-1;0<=o&&" "===t[o];)o--;for(l=0;l<=o&&" "===t[l];)l++;u=!1,l<=o&&"-"===t[l]&&(u=!0,l++);do{for(c=t[n=o],--o;l<=o&&(t[o].charCodeAt(0)|" ".charCodeAt(0))===c.charCodeAt(0);)--o;switch(c){case"i":i=n-o,a=1;break;case"v":i=5*(n-o),a=5;break;case"x":i=10*(n-o),a=10;break;case"l":i=50*(n-o),a=50;break;case"c":i=100*(n-o),a=100;break;case"d":i=500*(n-o),a=500;break;case"m":i=1e3*(n-o),a=1e3;break;default:return k}s<=a?(e+=i-r,s=a,r=0):r+=i}while(l<=o);return 0!==r&&(e-=r),u&&(e=-e),e},1,1,Mt),lt("CEILING.PRECISE",Zt,1,2,[bt,vt]),lt("ISO.CEILING",Zt,1,2,[bt,vt]),lt("FLOOR.PRECISE",function(t,e){return st(t/y(e))*y(e)},1,2,[bt,vt]),lt("MAXIFS",function(){return Ht(arguments,function(t){var e=null;return 0<t.length&&(e=Math.max.apply(null,t)),e})},3,I,I,[0,"%= 1"],[0,"%= 1"],{KMc:_t,dk:!0}),lt("MINIFS",function(){return Ht(arguments,function(t){var e=null;return 0<t.length&&(e=Math.min.apply(null,t)),e})},3,I,I,[0,"%= 1"],[0,"%= 1"],{KMc:_t,dk:!0}),lt("AVERAGEIFS",function(t){return Ht(arguments,function(t){var e,o,n=0,r=0;for(e=0;e<t.length;e++){if(o=t[e],P(o))return o;n+=o,r++}return 0===r?R:J(n/r)})},3,I,I,[0,"%= 1"],[0,"%= 1"],{KMc:_t,dk:!0}),lt("COUNTIFS",function(){var t,e=arguments,o=S(e),n=[e[0],e[1]];for(t=1;t<o;t++)n[t+1]=e[t];return Ht(n,function(t){return t.length},!0)},2,I,I,"%= 0","%= 0",{KMc:["%= 0 && >= 2"],dk:!0}),lt("MUNIT",function(t){for(var e=[],o=0,n=[];o<t;o++)n[o]=0;for(o=0;o<t;o++)e[o]=n.slice(0),e[o][o]=1;return new v.CalcArray(e)},1,1,{Hi:2,aj:"<= 0",bj:k}),lt("SEQUENCE",function(t,e,o,n){var r,i,a,s,l,u,c;if(void 0===t&&(t=1),void 0===e&&(e=1),void 0===o&&(o=1),void 0===n&&(n=1),0===t||0===e)return j;if(t<0||e<0)return k;if("string"==typeof(r=o)||o instanceof Date){if(i={},!v.Convert.Th(o,i))return k;r=i.value}for(a=[],s=0,l=r;s<t;s++)for(u=[],a.push(u),c=0;c<e;c++)u.push(l),l+=n;return new v.CalcArray(a)},1,4,[Tt,Tt,mt,mt],I,I,{bk:[0,1,2,3]},!0),lt("RANDARRAY",function(t,e,o,n,r){var i,a,s,l,u,c;if(void 0===t&&(t=1),void 0===e&&(e=1),void 0===o&&(o=0),void 0===n&&(n=1),void 0===r&&(r=!1),0===t||0===e)return j;if(t<0||e<0)return k;if(n<o)return k;if(r&&(o!==w(o)||n!==w(n)))return k;for(i=n-o,r&&i++,a=[],s=0;s<t;s++)for(l=[],a.push(l),u=0;u<e;u++)c=o+T()*i,r&&(c=m(c)),l.push(c);return new v.CalcArray(a)},0,5,[Tt,Tt,mt,mt],I,I,{ck:!0,bk:[0,1,2,3,4]},!0),lt("AGGREGATE",function(t,e,o){var n,r=arguments,i=[];for(n=3;n<S(r);n++)i[n-3]=r[n];return nt(i,o,e,t)},3,I,I,"> 1","> 1",{fk:1,dk:!0}),lt("AND",function(){return ee(!0,arguments)},1,I,jt,-1,-1),lt("OR",function(){return ee(!1,arguments)},1,I,jt,-1,-1),lt("NOT",function(t){var e;return v.ExcelCompatibleCalcMode&&"string"==typeof t?k:(e={},v.Convert.Uh(t,e)?!e.value:k)},1,1),lt("IF",function(t,e,o){var n,r,i=e,a=Z(t);return P(t)?t:(n=o!==I?o:2!==S(arguments)&&null,r={},B(a.value,r),r.value?i:n)},2,3,I,[1,2],[1,2],{gk:[1,2],bk:2,isBranch:!0,findTestArgument:0,findBranchArgument:function(t){if(v.Convert.vf(t))return-1;var e={value:!1};return B(t,e),e.value?1:2}}),lt("IFERROR",function(t,e){var o,n,r,i,a,s;if(!P(t)&&L(t)){if(1<t.getRangeCount())return k;if(n=o=0,r=this.y0a)if(o=r.row,n=r.col,(i=t._identities&&t._identities[0])&&1===i.rowCount&&1===i.colCount)n=o=0;else if(i&&(o+1>i.rowCount||n+1>i.colCount))return e;t=t.getValue(0,o,n)}return s=e,P(a=t)?M(s)?0:s:M(a)?0:a},2,2,I,I,I,{gk:-1}),lt("TRUE",function(){return!0},0,0),lt("FALSE",function(){return!1},0,0),lt("IFNA",function(t,e){return ht(t)?e:t},2,2,I,I,I,{gk:-1}),lt("IFS",function(){var t,e,o;for(t=0,e=arguments.length;t<e;t++){if(o={value:!1},P(arguments[t]))return arguments[t];if(!B(arguments[t++],o))return k;if(o.value)return arguments[t]}return _},2,254,I,0,I,{gk:-1}),lt("SWITCH",function(){var t,e,o,n,r=arguments;if(r.length<3)return k;if(P(t=r[0]))return t;for(t===u&&(t=0),o=r.length-(e=1);e<o;e++){if(n=r[e],e++,P(n))return n;if(n===u&&(n=0),K(t)&&K(n)){if(t.toUpperCase()===n.toUpperCase())return r[e]}else if(t===n)return r[e]}return r.length%2==0?r[r.length-1]:_},3,253,I,I,I,{gk:-1}),lt("XOR",function(){var t,e,o,n=0;for(t=0;t<S(arguments);t++)for(o=arguments[t],e=0;e<S(o);e++)o[e]&&n++;return!!(n%2)},1,I,Dt,-1,-1),lt("DATE",function(t,e,o){t<=1899&&(t+=1900);var n=new Date(t,e-1,o);return n<new Date(1899,11,30)?O:n},3,3,[{Hi:2,aj:["< 0","> 9999"]},Tt,Tt]),lt("TIME",function(t,e,o){var n=g(0);return n.setHours(t),n.setMinutes(e),n.setSeconds(o),n.setMilliseconds(0),n.getHours()<0&&n.getMinutes()<0&&n.getSeconds()<0?O:n},3,3,[Tt,Tt,Tt]),lt("DATEVALUE",function(t){var e,o,n,r;if(K(t)&&((e=i(t))||((e=new Date(t))&&!c(e.valueOf())||(e=null))),!e)return k;if(n=e.getFullYear(),r=oe(e),n<1900)return k;for(o=1900;o<n;o++)r+=365,Y(o)&&r++;return r},1,1,{Ni:!0}),lt("TIMEVALUE",se,1,1,{Ni:!0}),lt("NOW",function(){return new Date},0,0,I,I,I,{ck:!0}),lt("TODAY",function(){var t=new Date;return t.setHours(0,0,0,0),t},0,0,I,I,I,{ck:!0}),lt("HOUR",function(t){return t.getHours()},1,1,It),lt("MINUTE",function(t){return t.getMinutes()},1,1,It),lt("SECOND",function(t){return t.getSeconds()},1,1,It),lt("DAY",function(t){return t.getDate()},1,1,It),lt("MONTH",function(t){return t.getMonth()+1},1,1,It),lt("YEAR",function(t){return t.getFullYear()},1,1,It),lt("WEEKNUM",function(t,e){var o,n,r;return 1===e||17===e||M(e)||2===e||11===e||12===e||13===e||14===e||15===e||16===e?(o=oe(t),n=new Date(t.getFullYear(),0,1).getDay(),2===e?--n:11===e||12===e||13===e||14===e||15===e?n=n-e+10:16===e&&(n+=1),n<0&&(n=7+n),(r=o-1-(6-n))<0&&(r=0),7===n&&16===e?V(r/7)+(r%7!=0?1:0):1+V(r/7)+(r%7!=0?1:0)):21===e?ce(t):O},1,2,[It,At],I,I,{bk:1}),lt("WEEKDAY",le,1,2,[It,At],I,I,{bk:1}),lt("EDATE",function(t,e){return ae(!1,t,e)},2,2,[It,Tt]),lt("EOMONTH",function(t,e){return ae(!0,t,e)},2,2,[It,Tt]),lt("WORKDAY",function(t,e,o){return re(!0,t,e,o)},2,3,[It,Tt,Rt],2,2,{bk:2}),lt("WORKDAY.INTL",function(t,e,o,n){M(o)&&0===e&&(o=1);var r=ne(o);return P(r)?r:"1111111"===r.join("")?k:re(!1,t,e,n,r)},2,4,[It,Tt,{_i:"0000011"},Rt],[3],[2,3],{bk:[2,3]}),lt("DAYS360",v.Functions.uk,2,3,[It,It,{_i:!1,Hi:7}],I,I,{bk:2}),lt("NETWORKDAYS",function(t,e,o){return ie(!1,t,e,I,o,function(t,e,o){var n=V(f(e)-f(t))%7,r=V(le(t,2)+n),i=0===t.getDay()?1:2;return(o-=n=i<(n=5<r?r-5:0)?i:n)-2*w(o/7)})},2,3,[It,It],2,2,{bk:2}),lt("NETWORKDAYS.INTL",function(t,e,o,n){return ie(!0,t,e,o,n,ue)},2,4,[It,It],[2,3],[2,3],{bk:[2,3]}),lt("YEARFRAC",v.Functions.vk,2,3,[It,It,{_i:0,Hi:2}],I,I,{bk:2}),lt("DATEDIF",function(t,e,o){var n,r,i;if(t.setHours(0,0,0,0),e.setHours(0,0,0,0),v.ExcelCompatibleCalcMode&&(t<dt||gt<e))return O;if(o=o.toLocaleUpperCase(),(i=[])[0]=function(t,e){return e.getFullYear()-t.getFullYear()+(e.getMonth()<t.getMonth()||e.getMonth()===t.getMonth()&&e.getDate()<t.getDate()?-1:0)},i[1]=function(t,e){return 12*(e.getFullYear()-t.getFullYear())+(e.getMonth()-t.getMonth())+(e.getDate()<t.getDate()?-1:0)},i[2]=function(t,e){return(e.getTime()-t.getTime())/864e5},i[3]=function(t,e){var o=new Date(e.getFullYear(),e.getMonth()+(e.getDate()<t.getDate()?-1:0),t.getDate());return(e.getTime()-o.getTime())/864e5},i[4]=function(t,e){return e.getMonth()-t.getMonth()+(e.getMonth()<t.getMonth()||e.getMonth()===t.getMonth()&&e.getDate()<t.getDate()?12:0)+(e.getDate()<t.getDate()?-1:0)},i[5]=function(t,e){var o=e.getFullYear()+(e.getMonth()<t.getMonth()||e.getMonth()===t.getMonth()&&e.getDate()<t.getDate()?-1:0),n=t.getMonth(),r=t.getDate(),i=Y(t.getFullYear());return 1!==n||29!==r||Y(o)||r--,!i&&1===n&&28===r&&Y(o)&&r++,(e-new Date(o,n,r))/864e5},n=i,r=s(o,["Y","M","D","MD","YM","YD"]),e<t)return O;if(r<0)throw v.sR().Exp_NotSupported;return(0,n[r])(t,e)},3,3,[It,It,Mt]),lt("DAYS",function(t,e){var o,n={value:0};if(!ut(t,n))return k;if(!ut(e,o={value:0}))return k;function r(t){return 0<=t&&t<2958466}return r(n.value)&&r(o.value)?n.value-o.value:O},2,2),lt("ISOWEEKNUM",ce,1,1,It),lt("CLEAN",function(t){var e,o,n=[];for(e=0;e<S(t);e++)0<=(o=t.charCodeAt(e))&&o<=31||127===o||128<=o&&o<=159||n.push(t[e]);return n.join("")},1,1,Mt),lt("TRIM",function(t){var e,o,n,r,i;for(t=t.trim(),e=[],o=!0,n=0;n<S(t);n++)(i=" "===(r=t.charAt(n))||"\t"===r||"\n"===r)&&!o||e.push(r),o=!i;return e.join("")},1,1,Mt),lt("DOLLAR",function(t,e){return t=z(Ut(t,e)),n=he(o=t),r=[],o<0&&(n=n.substr(1)),r.push("$"),r.push(n),o<0&&(r.push(")"),r.unshift("(")),r.join("");var o,n,r},1,2,[mt,{_i:2,Hi:2,aj:"> 99",bj:k}],I,I,{bk:1}),lt("FIXED",function(t,e,o){var n,r,i,a,s=0;if(e<0&&(t/=s=V(A(10,y(e)))),t=z(Ut(t,b(0,e))),e<0&&(t*=s),n=o?""+t:he(t),0<e)if(-1===(r=n.indexOf(".")))for(n+=".",i=0;i<e;i++)n+="0";else for(a=n.length-(r+1);a<e;a++)n+="0";return n},1,3,[mt,{_i:2,Hi:2},{_i:!1,Hi:7}],I,I,{bk:[1,2]}),lt("TEXT",function(t,e){var o;if(""===e)return W(t);M(t)&&(t=0),"string"==typeof t&&(t=t.trim());try{return(o=l.Formatter&&l.Formatter.GeneralFormatter)?new o(e).format(t):""+t}catch(t){return k}},2,2,[{},Mt]),lt("VALUE",function(t){if(!t)return 0;var e,o=i(t);return M(o)?function(t){var e,o,n,r,i,a,s=l.Common.CultureManager.q4().NumberFormat;if("$"!==t[0]&&t[0]!==s.currencySymbol||(t=t.substring(1)),e=d(t),c(e))return k;for(("."===t[0]||"-"===t[0]&&"."===t[1])&&(t="-"===t[0]?t.replace(t[1],"0."):"0"+t),o=t.length,a=i=n=0;n<o;n++){for(r=t[n];n<o&&v.isDigit(r.charCodeAt(0));)r=t[++n];if(n===o){if(i&&n-i<=3)return k;break}if(r===s.numberGroupSeparator){if(a||i&&n-i<=3)return k;i=n}else if(r===s.numberDecimalSeparator){if(a||i&&n-i<=3)return k;a=n}}return t=h.Gb(t,",",""),d(t)}(t):(e=f(o),P(e)?se(o):e)},1,1,Mt),lt("LOWER",function(t){return t.toLowerCase()},1,1,Mt),lt("UPPER",function(t){return t.toUpperCase()},1,1,Mt),lt("PROPER",function(t){var e,o,n,r=S(t),i=[];if(0<r)for(e=t.toUpperCase(),o=t.toLowerCase(),n=1,i[0]=e[0];n<r;)i[n]=v.ei(t[n-1])?o[n]:e[n],n++;return i.join("")},1,1,Mt),lt("CHAR",function(t){return String.fromCharCode(t)},1,1,{Hi:2,aj:["> 255","< 1"],bj:k}),lt("CODE",function(t){return t[0].charCodeAt(0)},1,1,{Hi:5,Ni:!0}),lt("REPLACE",de,4,4,[Mt,{Hi:2,aj:"< 1",bj:k},Nt,Mt],I,I,{bk:2}),lt("SUBSTITUTE",function(t,e,o,n){var r,i,a,s,l,u,c=S(e);if(3<S(arguments)){if(s=void(a=0),(i=V(n))<1)return k;for(s=0;s<i;s++){if(-1===(a=t.indexOf(e,a)))return t;a+=c}l=t.substring(0,a-c),u=t.substr(a),r=l.concat(o).concat(u)}else r=h.yb(t,e,o);return r},3,4,[Mt,{Hi:5,Ni:!0},Mt],I,I,{bk:3}),lt("CONCATENATE",function(){return fe(arguments,"concatenate")},1,I,{Hi:4,Ii:0,Ji:!0,Xi:!0},I,-1),lt("LEFT",function(t,e){return pe(!0,t,e)},1,2,[Mt,St],I,I,{bk:1}),lt("MID",ye,3,3,[Mt,{Hi:2,aj:"<= 0",bj:k},Nt]),lt("RIGHT",function(t,e){return pe(!1,t,e)},1,2,[Mt,St],I,I,{bk:1}),lt("REPT",function(t,e){var o,n=[];if(e<0||32767<e*S(t))return k;for(o=0;o<e;o++)n.push(t);return n.join("")},2,2,[Mt,Tt]),lt("LEN",function(t){return t?t.length:0},1,1,Mt),lt("FIND",ve,2,3,[Mt,Mt,At],I,I,{bk:2}),lt("SEARCH",Ce,2,3,[Mt,Mt,St],I,I,{bk:2}),lt("EXACT",function(t,e){return t===e},2,2,[Mt,Mt]),lt("T",function(t){return K(t)?t:""},1,1),lt("UNICHAR",function(t){if(t){var e=t;return e<=0||1114111<e?k:55296<=e&&e<=57343?_:e<1048576?String.fromCharCode(e):(e-=1048576,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}return k},1,1,[{Hi:2,bj:k}]),lt("UNICODE",function(t){var e,o,n=W(t);return""===n||null===n?k:55296<=(e=n.charCodeAt(0))&&e<=56319?1===n.length?k:56320<=(o=n.charCodeAt(1))&&o<=57343?e|o<<8:1:56320<=e&&e<=57343?e-53248+53248:e},1,1),lt("BAHTTEXT",function(t){var e,o;function n(t){var e,o,n,r,i=["ล้าน","สิบ","ร้อย","พัน","หมื่น","แสน",""],a=["ศูนย์","หนึ่ง","สอง","สาม","สี่","ห้า","หก","เจ็ด","แปด","เก้า"],s=["ลบ","บาท","ถ้วน","สตางค์","ยี่","เอ็ด",","," ","฿"],l="",u=t+"",c=u.length;for(e=c;0<e;--e){if(n=a[o=m(u[c-e])],1==(r=1<e?(e-1)%6:6)&&2===o&&(n=s[4]),1===o)switch(r){case 0:case 6:l+=e<c?s[5]:n;break;case 1:break;default:l+=n}else{if(0===o){0==r&&(l+=i[r]);continue}l+=n}l+=i[r]}return l}return t?(e=Math.abs(m(t)),o=parseFloat((Math.abs(t)-e).toFixed(2)),0!==e?0===o?(t<0?"ลบ":"")+n(e)+"บาทถ้วน":(t<0?"ลบ":"")+n(e)+"บาท"+n(100*o)+"สตางค์":0!==o?(t<0?"ลบ":"")+n(100*o)+"สตางค์":"ศูนย์บาทถ้วน"):k},1,1,[{Hi:0,bj:k}]),lt("CONCAT",function(){return fe(arguments,"concat")},1,I,{Hi:4,Ji:!0,Ki:!0,Xi:!0},-1,-1),lt("TEXTJOIN",function(t,e){var o,n,r,i,a,s,l;if(t.isReference&&0===t.length)return N;if(o={value:!1},n=!!M(e[0])||e[0],!ct(n,o))return k;for(n=o.value,i=[],a=[],s=S(r=arguments),l=2;l<s;l++)ge(i,r[l],n);return ge(a,r[0],!1),function(t,e){if(0===t.length)return"";if(1===e.length)return t.join(e[0]);for(var o=t[0],n=1,r=0;n<t.length;n++,r++)r===e.length&&(r=0),o+=e[r]+t[n];return o}(i,a)},3,I,{Hi:4,Ji:!0,Ki:!0,Xi:!0},-1,-1),lt("FINDB",function(t,e,o){var n,r,i,a,s,l;return be()||v.usedbcs?(n=X(e),r=X(t),i=n.length,o<1||i<o?k:(a=we(n),s=we(r),-1===(l=a.indexOf(s,o-1))?k:l+1)):ve(t,e,o)},2,3,[Mt,Mt,At],I,I,{bk:2}),lt("LEFTB",function(t,e){return me(!0,t,e)},1,2,[Mt,St],I,I,{bk:1}),lt("RIGHTB",function(t,e){return me(!1,t,e)},1,2,[Mt,St],I,I,{bk:1}),lt("MIDB",function(t,e,o){var n,r,i;return be()||v.usedbcs?(r=(n=X(t)).length,--e<0?k:r<=e?"":r<e+o?n.slice(e).join(""):(i=n.slice(e,e+o),"singleByte"!==Q(i[i.length-1])&&(i[i.length-1]="​",M(i[0])&&(i[i.length]="​")),i.join(""))):ye(t,e,o)},3,3,[Mt,Nt,Nt]),lt("LENB",function(t){var e,o,n,r;if(!t)return 0;if(be()||v.usedbcs){for(o=e=0;o<t.length;o++)if(8203!==t[o].charCodeAt(0)&&(n=Q(t[o]),r=l.Common.CultureManager.q4(),"doubleByte"===n&&9390!==t[o].charCodeAt(0))){if("ja-jp"===(r&&r.name().toLocaleLowerCase())&&(711===t[o].charCodeAt(0)||9356===t[o].charCodeAt(0)||8212===t[o].charCodeAt(0)))continue;e++}return t.length+e}return t.length},1,1,Mt),lt("REPLACEB",function(t,e,o,n){var r,i,a,s,l,u,c;if(be()||v.usedbcs){for(r=[],i=void 0,s=a=0;s<t.length;s++)i=t[s],"doubleByte"===Q(t[s])&&(a++,i=t[s]),r[s+a]=i;return l=r.length,e=C(e,l+1),o=C(o||0,l-e+1),M(r[e-1])?(r[e-1]=" ",r[e]=" "):M(r[e-2])&&2<=e&&(r[e-2]=" ",r[e-1]=" "),u=r.slice(0,e-1).join(""),c=r.slice(e-1+o).join(""),u.concat(n).concat(c)}return de(t,e,o,n)},4,4,[Mt,{Hi:2,aj:"< 1",bj:k},Nt,Mt],I,I,{bk:2}),lt("SEARCHB",function(t,e,o){var n,r,i,a;return be()||v.usedbcs?(n=X(e),r=X(t),i=n.length,o<1||i<o?k:(a=Ce(we(r),we(n),o))===k?k:a):Ce(t,e,o)},2,3,[Mt,Mt,St],I,I,{bk:2}),lt("ENCODEURL",function(t){var e,o,n,r,i,a,s,l,u,c="object"==typeof p&&p&&p.Object===Object&&p,h="object"==typeof self&&self&&self.Object===Object&&self,f=c||h||Function("return this")();if(f&&f.encodeURIComponent)return encodeURIComponent(t).replace(/[!~'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()});if(e="",(o=t.length-1)<0)return"";for(n=0;n<=o;n++)if((r=t.charCodeAt(n))>="A".charCodeAt(0)&&r<="Z".charCodeAt(0)||r>="0".charCodeAt(0)&&r<="9".charCodeAt(0)||r>="a".charCodeAt(0)&&r<="z".charCodeAt(0)||r==="-".charCodeAt(0)||r==="_".charCodeAt(0)||r===".".charCodeAt(0))e+=t[n];else{if(i=void 0,55296<=(u=r)&&u<=57343){if(o===n||(s=r,l=t.charCodeAt(n+1),!(!(s<55296||56319<s)&&56320<=l&&l<=57343)))return null;i=[r,t.charCodeAt(n+1)],n++}else i=[r];for(a=0;a<i.length;a++)e+="%",e+=i[a].toString(16).toUpperCase()}return e},0,1,Mt),lt("ISERROR",function(t){return P(t)},1,1,I,I,I,{gk:-1}),lt("ISERR",function(t){return!!P(t)&&t._code!==_._code},1,1,I,I,I,{gk:-1}),lt("ISNA",function(t){return!!P(t)&&t._code===_._code},1,1,I,I,I,{gk:-1}),lt("ERROR.TYPE",function(t){if(!M(t)&&P(t)){var e=s(t._code,[N._code,R._code,k._code,E._code,D._code,O._code,_._code]);if(0<=e)return e+1}return _},1,1,I,I,I,{gk:-1}),lt("ISNUMBER",function(t){return G(t,v.ExcelCompatibleCalcMode)},1,1,I,I,I,{gk:-1}),lt("ISEVEN",function(t){return st(y(t))%2==0},1,1,mt,I,I),lt("ISODD",function(t){return st(y(t))%2!=0},1,1,mt,I,I),lt("N",function(t){return G(t)?z(t):q(t)?t?1:0:P(t)?t:0},1,1,I,I,I),lt("ISBLANK",function(t){return M(t)},1,1,I,I,I,{gk:-1}),lt("ISLOGICAL",function(t){return q(t)},1,1,I,I,I,{gk:-1}),lt("ISTEXT",function(t){return K(t)},1,1,I,I,I,{gk:-1}),lt("ISNONTEXT",function(t){return!K(t)},1,1,I,I,I,{gk:-1}),lt("ISREF",function(t){return L(t)},1,1,I,-1,I,{gk:-1}),lt("TYPE",function(t){return q(t)?4:G(t)?1:K(t)?2:P(t)?16:H(t)?64:k},1,1,I,I,-1,{gk:-1}),lt("NA",function(){return _},0,0),lt("SHEET",function(t,e){var o,n=0,r=t.source.kj;if(H(e))return _;if(e instanceof v.CalcReference||M(e))return o=e&&(e._source||e.references[0]._source)||t.source,r.parent.getSheetIndex(o.kj.name())+1;if(G(e)||K(e))for(;n<r.parent.sheets.length;n++)if(e.toUpperCase()===r.parent.sheets[n].name().toUpperCase())return n+1;return _},0,1,I,-1,I,{dk:!0}),lt("SHEETS",function(t,e){var o,n,r=t.source.kj;return M(e)?r.parent.sheets.length:H(e)||G(e)?_:K(e)?k:e instanceof v.CalcReference?(o=e.references)?o.length:(n=e._source||t.source,r.parent.getSheetIndex(n.kj.name())+1):_},0,1,I,-1,I,{dk:!0}),lt("LET",I,3,253,I,I,I,{argsValidator:function(t,e,o){if(o%2==0)throw v.sR().Exp_FormulaInvalid},subExpressionValidator:function(t,e){if(e%2==0&&(1===t.type||100===t.type&&-1<t.value.indexOf(".")))throw v.sR().Exp_FormulaInvalid},LMc:function(t,e){var o=e.source;o&&o.q$a&&t.bhc&&(t.value=t.value.replace(/\./g,"_"))}}),lt("OBJECT",function(){var t,e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m=arguments,y=S(m);if(y<2||y%2!=0)return _;for(e=0;e<y;e+=2){if(r=m[e+1],i=Te(m[e],2),a=Te(r,0),P(i))return i;if(P(a))return a;if(i.isError||a.isError)return _;if(s=i.length,l=a.length,M(n))n=l;else if(n!==l)return _;if(l<s)return _;if(s<l){if(!1===o||1<s)return _;for(M(t)&&(t=[]),u=a.rowCount,c=a.colCount,h=i[0],f=0;f<u;f++){for(p=t[f],M(p)&&(p=t[f]=[]),d=0;d<c;d++)M(p[d])&&(p[d]={}),p[d][h]=a[d+f*c];t[f]=p}o=!0}else{if(!0===o)return _;for(M(t)&&(t={}),g=0;g<l;g++)t[i[g]]=a[g];o=!1}}return o?new v.CalcArray(t):t},2,I,I,-1,-1),lt("PROPERTY",function(){var t,e=arguments,o=e[0],n=e[1].split("."),r=n.length,i=o;if(M(o)||"object"!=typeof o)return _;for(t=0;t<r;t++)if(i=i[n[t]],M(i))return _;return i},2,2,I),lt("FILTERJSON",function(t){var e,o,n,r,i;try{if(e=JSON.parse(t),Array.isArray(e)&&0<e.length){for(o=!0,n=0;n<e.length;n++)if(!Array.isArray(e[n])){o=!1;break}if(o)e=new v.CalcArray(e);else{for(r=[],i=0;i<e.length;i++)r.push([e[i]]);e=new v.CalcArray(r)}}return e}catch(t){return k}},1,1,I),(Ft=new v.Functions.AsyncFunction("WEBSERVICE",1,1)).defaultValue=function(){return""},Ft.evaluate=Ae,v.Functions.bi.WEBSERVICE=Ft,(Ot=new v.Functions.AsyncFunction("REFRESH",1,3)).evaluate=xe,v.Functions.bi.REFRESH=Ot}).call(this,Me("./node_modules/webpack/buildin/global.js"))},CalcEngine:function(t,e){t.exports=o("@grapecity/js-calc")},Common:function(t,e){t.exports=o("@grapecity/js-sheets-common")}},a.c=r,a.d=function(t,e,o){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(e,t){var o,n;if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;if(o=Object.create(null),a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(n in e)a.d(o,n,function(t){return e[t]}.bind(null,n));return o},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/assets/",a(a.s="./src/basicFunctions.entry.ts")),t.exports=i.Spread.CalcEngine.BasicFunctions},"./node_modules_local/@grapecity/js-calc-basicfunctions/index.js":function(t,e,o){t.exports=o("./node_modules_local/@grapecity/js-calc-basicfunctions/dist/gc.spread.calcengine.basicfunctions.js")},"./node_modules_local/@grapecity/js-calc/dist/gc.spread.calcengine.js":function(t,e,o){var n,r,i="object"==typeof i?i:{};function a(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,a),e.l=!0,e.exports}i.Spread=i.Spread||{},i.Spread.CalcEngine=(r={},a.m=n={"./src/Parser.ts":function(t,R,e){"use strict";var n,k,A,o,r,E,S,i,a,s,l,f,c,D,j,_,O,u,F,P,h,p,d,g,m,y=this&&this.__extends||(g=function(t,e){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}g(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function M(){throw k.sR()[l]}function L(t,e,o){throw S.Kb(k.sR()[o||s],[t,e])}function b(t){return t<=255}function v(t){return t<=127}function I(t){return t===k.getBoolean().boolean_true||t===o}function N(t){return t===k.getBoolean().boolean_false||t===r}function H(t){return 48<=t&&t<=57}function B(t,e,o,n,r,i){var a,s,l=t.length,u=o===n?0:1,c=[],h=0;for(a=e+1;a<l;a++)if((s=t[a])===r&&(c.push(s),h++,s=t[++a]),s===o&&u++,s===n)if(u--,o===n&&a+2<l&&t[a+1]===o)c.push(o),a++,h++;else{if(0===u)return{result:c,endIndex:a,skipCount:h};c.push(s)}else c.push(s);i&&L(n,o,f)}function V(t,e){return F.apply(t,e),t}function C(t){void 0===t&&(t=5e3),this.priority=t}function w(t,e,o,n,r){var i,a;this.oi=[],r=r||0,this.Qb=t,i=Array.isArray(t)?t.join(""):t,this.Nc=e,this.mi=o,this.li=n||o+t.length-1,0===e&&0===r&&t?(I(a=i.toUpperCase())||N(a))&&(r=5,i=a):1===e&&i!==E&&(i=i.toUpperCase()),this.ni=i,this.hi=r}function x(t,e,o,n){this.Eh=!1,this.ignoreError=!1;this.useR1C1=e,this.baseIdentity=o,this.option=n,this.source=t}function T(){}function z(t,e){if(e&&0!==e.length&&t.Eh){var o="'"===e[0]?1:0;return"["===e[o]&&e.indexOf("]")>o}}function W(){return null!==m&&m.apply(this,arguments)||this}function G(t,e){var o,n,r;for(o=0;o<e.length;o++)for(n=e[o],r=0;r<n.length;r++)if(t===n[r])return 1}Object.defineProperty(R,"__esModule",{value:!0}),n=e("Common"),k=e("./src/calc.common.ts"),A=void 0,o="TRUE",r="FALSE",E="ARRAY",S=n.Common.u,i=n.Common.j,a=i.Fa,s="Exp_FormulaInvalidChar",l="Exp_FormulaInvalid",f="Exp_NoSyntax",R.di=["+","-","%","+","-","*","/","^","&","=","<>","<","<=",">",">=",":",","," "],c={":":1,"^":2," ":3,"*":4,"/":4,",":5,"+":6,"-":6,"&":7,"<":8,"=":8,">":8,">=":8,"<=":8,"<>":8},D=".",_=";",O=j=",",u=[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,24,24,26,24,24,24,20,21,24,25,24,19,24,24,8,8,8,8,8,8,8,8,8,8,24,24,25,25,25,24,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,24,21,27,18,27,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,25,21,25,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,26,26,26,26,28,28,27,28,1,22,25,19,28,27,28,25,10,10,27,1,28,24,27,10,1,23,10,10,10,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,25,1,1,1,1,1,1,1,1],R.isDigit=H,R.ei=function(t){var e=t.charCodeAt(0);return!b(e)||(v(e)?96<=(e|=32)&&e<=122:0===u[e]||1===u[e])},R.fi=function(t){var e=t.charCodeAt(0);return!b(e)||(v(e)?e<=57?48<=e:96<=(e|=32)&&e<=122:0===u[e]||1===u[e])},R.isNumber=function(t){var e=t.charCodeAt(0);return v(e)?48<=e&&e<=57:8===u[e]||10===u[e]},F=[].push,w.prototype.type=function(){return this.Nc},w.prototype.subType=function(){return this.hi},w.prototype.stringValue=function(){return this.ni},P=w,R.FormulaToken=P,C.prototype.resolveToken=function(t,e,o,n,r,i){return 0},C.prototype.unparse=function(t,e,o,n){return!0},h=C,R.TokenResolver=h,R.preOperaterTypesMap={"+":0,"-":1},R.operaterTypesMap={":":15,",":16,"+":3,"-":4,"*":5,"/":6,"^":7,"%":2,"&":8,"=":9,"<":11,"<>":10,"<=":12,">":13,">=":14},T.prototype.setParserOption=function(t){var e,o;t!==A&&n.Common.CultureManager.q4()?(o="object"==typeof t&&t.NumberFormat?t.NumberFormat:n.Common.CultureManager.q4().NumberFormat,e=t?o:{}):o=e={},j=T.listSeparator=e.listSeparator||",",D=e.numberDecimalSeparator||".",!t&&T.numberDecimalSeparator||(T.numberGroupSeparator=o.numberGroupSeparator||",",T.numberDecimalSeparator=o.numberDecimalSeparator||"."),_=T.arrayGroupSeparator=e.arrayGroupSeparator||";",O=T.arrayListSeparator=e.arrayListSeparator||","},T.prototype.parse=function(t,e){var o,n;return this.setParserOption(t.culture),o=e.split(""),this.gi=o,n=this.parseToTokens(t,o,!t.ignoreError),this.buildExpressionTree(t,n,!t.ignoreError)},T.prototype.unparse=function(t,e,o){return void 0===o&&(o=[]),this.Cma(t,e,o),"@"===o[0]&&e&&e.arguments&&e.arguments[0]&&1===e.arguments[0].type&&t&&t.source&&t.source._service&&!0!==t.source._service.allowDynamicArray&&o.splice(0,1),o.join("")},T.prototype.Cma=function(t,e,o){var n,r;if(e)for(this.setParserOption(t.culture),n=t.getResolvers(),r=0;r<n.length&&!n[r].unparse(t,this,e,o);r++);},T.prototype.parseToTokens=function(d,g,m){var y,b,v,C,w,x,T,A,S,t,M,I,e,N,o;for(void 0===m&&(m=!0),y=this,b=function(t,e,o){return 0<e.length&&t.push(new P(e,0,o)),[]},v=g.length,C=[],w=[],x=-1,T=[],t=0;t<v&&" "===g[t];)t++;for("="===g[t]&&t++,e=function(e){var t,o,n,r,i,a,s,l,u,c,h=g[e],f=h.charCodeAt(0),p=void 0;if(64===f&&d.kj&&d.kj.Wu&&!0===d.kj.Wu.allowDynamicArray)A=new P(h,1,e),C.push(A),S=e+1;else if(97<=f&&f<=122||65<=f&&f<=90)T.push(h);else if(34===f)0<T.length&&(T=b(C,T,S)),(p=B(g,e,'"','"',"",m))?(t=new P(p.result,0,e,e+p.result.length+2,3),p.skipCount&&(t.HTa=g.slice(e,p.endIndex+1).join(""),t.li+=p.skipCount),C.push(t),e=p.endIndex,S=e+1):(V(T,g.slice(e,v)),e=v-1);else if(39===f)p=B(g,e,"'","'","",m),e=p?(n=[],1<(o=function(t){var e,o,n=[];if(-1<t.indexOf(":"))for(e=t.split(":"),o=0;o<e.length;o++)n.push("'"+e[o].replace(/'/g,"''")+"'");return n}(p.result.join(""))).length&&(r=o.join(":").split(""),n=y.parseToTokens(d,r,m)),n&&0<n.length?(n.forEach(function(t){t.mi+=e,t.li+=e}),V(C,n)):(T.push("'"),V(T,p.result),T.push("'")),p.endIndex):(T.push("'"),v-1);else if(91===f)if(p=B(g,e,"[","]","'",m))T.push("["),V(T,p.result),T.push("]"),e=p.endIndex;else{if(y.lda&&0===T.length&&("R"===T[0]||"r"===T[0]||"C"===T[0]||"c"===T[0]))return N=e,"continue";V(T,g.slice(e,v)),e=v-1}else{if(13===f||10===f)return N=e,"continue";if(35===f)(i=function(t,e,o){var n,r,i,a,s=t.length,l=s-e;for(n=0;n<k.ErrorList.length;n++)if(e+(i=(r=k.ErrorList[n]).length)<=s&&(a=t.slice(e,e+i),i<=l&&r===a.join("").toUpperCase()))return{result:a,endIndex:e+i-1};o&&L([t[e],e])}(g,e))?(C.push(new P(i.result,0,e,e+i.result.length-1,6)),S=e+1,e=i.endIndex):T.push(h);else if(33===f)T.length,0<(a=C.length)&&0===C[a-1].Nc?(s=C[a-1],F.apply(s.Qb,T),C[a-1]=new P(s.Qb,0,s.mi,e,12)):C.push(new P(T,0,S,e,12)),T=[],S=e+1;else if(43===f||45===f)l=0===C.length?null:C[C.length-1],0!==T.length?(C.push(new P(T,0,S)),C.push(new P(h,5,e)),T=[]):(l&&7===l.Nc&&C.pop(),!l||2!==l.hi&&6!==l.Nc&&0!==l.Nc?C.push(new P(h,4,e)):C.push(new P(h,5,e))),S=e+1;else if(h===D||H(f))!(0<T.length)&&(u=function(t,e,o){var n,r,i=t.length,a=0,s=[];for(n=e;n<i;n++)if(H((r=t[n]).charCodeAt(0)))0===a?a=2:3===a?a=4:1===a?a=2:5!==a&&6!==a||(a=7),s.push(r);else if(r===o){if(2===a)a=4;else{if(0!==a&&1!==a)return{};a=3}s.push(".")}else if("+"===r||"-"===r){if(0===a)a=1;else{if(5!==a)return{num:s,endIndex:n-1};a=6}s.push(r)}else if("E"===r||"e"===r){if(2!==a&&4!==a)return{};a=5,s.push(r)}else if(2===a||4===a||7===a)return{num:s,endIndex:n-1};return 2===a||4===a||7===a?{num:s,endIndex:i-1}:{}}(g,e,D)).num?(M=u.endIndex,c=u.num,S=M<=v-2&&"!"===g[M+1]?(V(T,c),M):(C.push(new P(c,0,e,M,4)),M+1),e=M):T.push(h);else if(123===f)0<T.length&&(m?L(h,e):T=b(C,T,S)),A=new P(E,1,e,e,1),C.push(A),w[++x]=A,S=e+1;else if(h===_&&0<=x&&w[x].value===E)T=b(C,T,S),x<0&&m&&L(h,e),C.push(new P(_,3,e,e)),S=e+1;else if(125===f)T=b(C,T,S),M<0&&m&&L(h,e),I=w[x--],I=new P(h,I.Nc,e,e,2),C.push(I),S=e+1;else if(32===f)T=b(C,T,S),S=e+1;else if(h===j||h===O||h===_)T=b(C,T,S),x<0||1!==w[x].Nc?C.push(new P(j,5,e,e,10)):C.push(new P(h,3,e,e)),S=e+1;else if(37===f)T=b(C,T,S),C.push(new P(g[e],6,e,e)),S=e+1;else if(e+2<=v&&R.operaterTypesMap[h+g[e+1]])T=b(C,T,S),C.push(new P(g.slice(e,e+2),5,e,e+1,5)),S=++e+1;else if(R.operaterTypesMap[h])T=b(C,T,S),C.push(new P(h,5,e,e)),S=e+1;else if("("===h)0<T.length?(A=new P(T,1,S,e,1),T=[]):A=new P(h,2,e,e,1),C.push(A),w[++x]=A,S=e+1;else if(")"===h){if(T=b(C,T,S),x<0)return m&&L(h,e),b(C,h,e),S=e+1,N=e,"continue";I=w[x--],I=new P(h,I.Nc,e,e,2),C.push(I),S=e+1}else if(":"===h)T=b(C,T,S),C.push(new P(h,5,e,e,11)),S=e+1;else if("\r"!==h&&"\n"!==h){if("\\"===h){if(v<=++e)return m&&L(h,e),N=e,"continue";T.push(h),h=g[e]}T.push(h)}}N=e},o=S=t;o<v;o++)e(o),o=N;return b(C,T,S),C},T.prototype.buildExpressionTree=function(t,e,o){var n,r=this.ii(t,e,o),i=this.ji(t,r,o);return o&&(i||M(),this.rSa(i)),(n=t.source)&&n.q$a||!i||(i.ehc=!0),i},T.prototype.rSa=function(t){for(var e,o,n,r,i;10===t.type;)t=t.value;if(9===t.type)t.value||M(),this.rSa(t.value),t.value2&&this.rSa(t.value2);else if(7===t.type)for(o=(e=t.arguments).length,(n=t.function)&&n.gEc(n.minArgs,n.maxArgs,o),r=0;r<o;r++)i=e[r],n?n.hEc(i,r):k.iEc(i,r),this.rSa(i)},T.prototype.ji=function(t,e,o){var n,r,i,a,s,l,u=this.ki(t,e,o);for(a=3;a<u.length;)if(s=u[a],9!==(l=u[a-2]).type&&o&&M(),s&&9===s.type){for(;3<=a&&c[s.value]>=c[l.value];)r=u[a-3],i=u[a-1],n=k.Kh(l.operatorType,r,i),u.splice(a-3,3,n),3<=(a-=2)&&(l=u[a-2]);a+=2}else a++;if(1===u.length)return u[0];for(a=u.length-2;0<a;a-=2)r=u[a-1],i=u[a+1],9!==u[a].type&&o&&M(),n=k.Kh(u[a].operatorType,r,i),u.splice(a-1,3,n);return n},T.prototype.ki=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w;for(n=[],r=(e=Array.isArray(e)?e:[e]).length,i=0;i<r;i++){if(9===(s=a=e[i]).type){if(0===a.operatorType||1===a.operatorType)if(i===r-1)o&&M();else{for(l=i;9===e[l].type&&e[l].operatorType<=1;)l++;for(u=this.ji(t,e[l]),c=l-1;i<=c;c--)u=s=k.Kh(e[c].operatorType,u);s=u,i=l}else if(2===a.operatorType){if(0!==i){s=k.Kh(a.operatorType,n[n.length-1]),n[n.length-1]=s;continue}o&&M()}}else if(10===a.type)a.value=this.ji(t,a.value),s=a;else if(7===a.type){if(h=0,f=a.arguments,p=[],d=[],g=a.function,m="LET"===a.functionName,0<f.length){for(y=[],m&&!t.MMc&&(t.MMc=[]),t.MMc&&t.MMc.push(y),b=0;b<=f.length;b++)v=f[b],C=void 0,b===f.length||0===v.type&&v.value===j?(C=h===b?new k.Expression(11):this.ji(t,d,o),p.push(C),w=p.length-1,m&&w%2==0&&100===C.type&&(b<f.length||b===f.length&&G(C.value,t.MMc))&&(C.bhc=!0,y.push(C.value)),h=b+1,d=[]):(C=v,d.push(C),100===C.type&&G(C.value,t.MMc)&&(C.bhc=!0)),g&&C&&(g.LMc&&g.LMc(C,t),C.bhc&&(t.getFunction("LET")||k.Functions.findGlobalFunction("LET")).LMc(C,t));a.arguments=p}s=a,m&&t.MMc&&t.MMc.pop()}n.push(s)}return n},T.prototype.ii=function(t,e,o){var n,r,i=[];for(n=0,r=e.length;n<r;)n=this.resolveToken(t,e,i,n,o);return i},T.prototype.resolveToken=function(t,e,o,n,r,i){var a,s,l,u,c,h=e[n],f=t.getResolvers();for(a=0;a<f.length;a++)if(s=f[a].resolveToken(t,this,e,n,r,i)){u=n-1,(l=s.expr)&&s.index!==A?n=s.index-1:l=s,(c=0<o.length?o[o.length-1]:null)&&0!==l.type&&7!==l.type&&l.type<9&&0!==c.type&&7!==c.type&&c.type<9&&e[u].li<h.mi-1&&o.push(k.Kh(17," ")),o.push(l);break}return n+1},T.prototype.resolveSubTokens=function(t,e,o,n,r,i){for(var a=[];o<e.length&&2!==e[o].hi;)if(o=this.resolveToken(t,e,a,o,n,r),i){o--;break}return{exprs:a,index:o+1}},p=T,R.Parser=p,x.prototype.getExternalSource=function(t,e){var o,n=this.source.getCalcService().getAllSourceModels();for(o=0;o<n.length;o++)if(S.Mb(n[o].getSource().getName(),e))return n[o].getSource();return null},x.prototype.getExternalSourceToken=function(t){return t.getName()},x.prototype.setSource=function(t){this.source=t},x.prototype.getResolvers=function(){var t=(this.source||this.kj).getCalcService();return t&&t.getResolvers()},x.prototype.addResolver=function(t){var e=(this.source||this.kj).getCalcService();e&&e.addResolver(t)},x.prototype.getFunction=function(t){var e,o=t,n=k.getMapping()&&k.getMapping().builtInFunctionsMapping;if(!a(n))for(e in n)n[e].alias===t&&(o=e);return this.source&&this.source.getCustomFunction(o)||k.Functions.findGlobalFunction(t)},d=x,R.ParserContext=d,k.CalcSource.prototype.getParserContext=function(t,e,o){return new d(this,t,e,o)},y(W,m=h),W.prototype.resolveToken=function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y,b=o[n],v=b.ni,C=b.Qb,w=b.Nc,x=null,T=b.hi;if(0===w&&12===T){if(c=void 0,v&&"'"===(c=v).charAt(0)&&(c=c.substring(1,c.length-1)),n++,c&&(x=t.getExternalSource("",c)),!(b=o[n]))return(a=new k.Expression(8)).value=v,a;v=b.ni}if(0===w)0===b.hi?I(l=v.toUpperCase())||N(l)?(b.hi=5,b.ni=l,(a=new k.Expression(4)).value=I(l)):(h=i?100:8,(a=new k.Expression(h)).value=v):4===b.hi?((a=new k.Expression(2)).value=parseFloat(v),a.originalValue=v):3===b.hi?(a=new k.Expression(3)).value=v:5===b.hi?(a=new k.Expression(4)).value=I(v):6===b.hi?(a=new k.Expression(5)).value=k.CalcError.parse(v):7===b.hi&&(h=i?100:8,(a=new k.Expression(h)).value=v);else if(1===w){if(v===E){for(a=new k.Expression(6),n++,l=[[]],p=f=s=0;n<o.length&&2!==o[n].hi;){if(b=o[n],n<o.length-1&&4===b.Nc&&"-"===b.ni&&4===o[n+1].hi&&((b=o[++n]).Qb.unshift("-"),b.ni="-"+b.ni),3===b.Nc){if(b.ni===_){if(f!==p)throw S.Kb(k.sR().Exp_InvalidArrayColumns,[b.mi]);l.push([]),s++,p=0}}else{if(0!==b.Nc||4!==b.hi&&3!==b.hi&&5!==b.hi&&6!==b.hi)throw k.sR().Exp_InvalidArray;g=d=b.ni,4===b.hi?g=parseFloat(d):5===b.hi?g="TRUE"===d.toUpperCase():6===b.hi&&(g=k.CalcError.parse(d)),l[s].push(g),0===s&&f++,p++}n++}if(f!==p)throw S.Kb(k.sR().Exp_InvalidArrayColumns,[b.mi]);return n++,a.value=new k.CalcArray(l),{expr:a,index:n}}if(0<C.length)return m=t.source&&t.source._service&&t.source._service.allowDynamicArray,"@"!==C[0]||m||(b.ni=C.slice(1).join(""),v=b.ni),(a=new k.Expression(7)).functionName=v,y=t.getFunction(a.functionName)||k.Functions.findGlobalFunction(a.functionName),!1===m&&y&&!0===y.isDynamicArrayFunction&&(y=A),a.function=y,(u=e.resolveSubTokens(t,o,n+1,void 0,i||"LET"===v,"@"===C[0]&&m))?(a.arguments=u.exprs,{expr:a,index:u.index}):(a.arguments=[],a)}else if(4===w||6===w||5===w)a=k.Kh(4===w?R.preOperaterTypesMap[v]:R.operaterTypesMap[v],v);else if(2===w){if(a=new k.Expression(10),u=e.resolveSubTokens(t,o,n+1))return a.value=u.exprs,{expr:a,index:u.index};r&&M()}else 3===w&&((a=new k.Expression(0)).value=v);return x&&a&&(a.source=x,a={expr:a,index:n+1}),a},W.prototype.unparse=function(t,e,o,n){var r,i,a,s,l;if(6===o.type||4===o.type||2===o.type||5===o.type||3===o.type)this.qi(t,o,n);else if(9===o.type)this.ri(t,e,o,n);else if(10===o.type)n.push("("),e.Cma(t,o.value,n),n.push(")");else{if(7!==o.type)return(1===o.type||8===o.type)&&(this.unparseRefenceExpressions(t,e,o,n),!0);for(r=o.function&&o.function.name||o.functionName,V(n,((a=(i=k.getMapping()&&k.getMapping().builtInFunctionsMapping)&&i[r])&&a.alias||r).split("")),s="@"===r?["",""]:["(",")"],n.push(s[0]),l=0;l<o.arguments.length;l++)0!==l&&n.push(j),e.Cma(t,o.arguments[l],n);n.push(s[1])}return!0},W.prototype.unparseSource=function(t,e,o,n){if(t.getExternalSourceToken){if(o!==k.BangSource){var r=function(t,e,o){var n,r;if(!e||0===e.length||z(t,e)||z(t,o))return[];if(n=e,o)for(n.push(":"),r=0;r<o.length;r++)n.push(o[r]);return n}(t,t.getExternalSourceToken(o).split(""),n&&t.getExternalSourceToken(n).split(""));if(!(0<r.length))return!1;F.apply(e,r)}return e.push("!"),!0}return!1},W.prototype.unparseRefenceExpressions=function(t,e,o,n){if(o.source===k.BangSource)n.push("!");else if(o.source&&!this.unparseSource(t,n,o.source,o.endSource))return void n.push("#","R","E","F","!");8===o.type&&n.push(o.value)},W.prototype.ri=function(t,e,o,n){var r=o.operatorType;2===r?(e.Cma(t,o.value,n),n.push("%")):0===r||1===r?(n.push(R.di[r]),e.Cma(t,o.value,n)):(e.Cma(t,o.value,n),n.push(R.di[r]),e.Cma(t,o.value2,n))},W.prototype.qi=function(t,e,o){var n,r,i,a,s,l,u,c,h=k.sR().Exp_InvalidArray;if(3===e.type)o.push('"'),o.push(S.Gb(e.value,'"','""')),o.push('"');else if(2===e.type)n=e.originalValue||""+e.value,"."!==D&&(n=n.replace(".",D)),o.push(n);else if(4===e.type)o.push(e.value?k.getBoolean().boolean_true:k.getBoolean().boolean_false);else if(6===e.type){if(o.push("{"),(r=e.value).getRowCount()<=0)throw h;for(i=0,a=r.getRowCount();i<a;i++)for(1<=i&&o.push(_),s=0,l=r.getColumnCount();s<l;s++){if(0!==s&&o.push(O),(u=r.getValue(i,s))===A||null===u)throw h;"string"==(c=typeof u)?(o.push('"'),o.push(S.Gb(u,'"','""')),o.push('"')):"boolean"==c?o.push(u?k.getBoolean().boolean_true:k.getBoolean().boolean_false):"number"==c&&"."!==D?o.push((""+u).replace(".",D)):o.push(""+u)}o.push("}")}else 5===e.type?o.push(""+e.value):e.type},R.DefaultTokenResolver=W,k.ParserWrapper.XAb=function(){p.numberDecimalSeparator===A&&(new p).setParserOption(!0);return p.numberDecimalSeparator},k.ParserWrapper.YAb=function(){p.numberGroupSeparator===A&&(new p).setParserOption(!0);return p.numberGroupSeparator}},"./src/calc.common.ts":function(t,k,e){"use strict";var p,o,m,d,y,n,c,h,E,v,D,g,C,f,b,w,a,i,r,x,T,s,l,u,A,S,M,I,N,j,R,_,O,F,P,L,H,B,V,z,W,G,U,J,Z,q,K,Y,Q,X,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ht,ft,pt,dt,gt,mt,yt,bt=this&&this.__extends||(X=function(t,e){return(X=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}X(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function vt(t){return t&&t.toUpperCase()}function Ct(t){var e=Ct.nf(t);if(!e)throw k.sR().Exp_NotSupported;this._error=e.error,this._code=e.code}function wt(t){return isNaN(t)||!isFinite(t)}function xt(t,e){var o,n,r,i,a,s,l,u,c,h,f;if(!t)return!(e.value=0);n=typeof t;try{if(n===m)o=t;else if(n===d){if(/[\f\n\r\t\v]/.test(t))return!1;if(0===(t=(r=t).trim()).length)return!(e.value=0);if(i=z.XAb(),a=z.YAb(),"."!==i&&"."!==a&&0<=t.indexOf(".")||","!==i&&","!==a&&0<=t.indexOf(","))return!1;if(l=s=!1,u=t[0],c=t[t.length-1],"("===t[0]&&")"===c){if(l=!0,"+"===(u=(t=t.substring(1,t.length-1).trim())[0])||"-"===u)return!1;c=t[t.length-1]}if("%"===u?(s=!0,t=t.substring(1)):"%"===c?(s=!0,t=t.substring(0,t.length-1)):"$"===u&&(t=t.substring(1)),""===t)return!1;if(0<=t.indexOf(a)&&(g.qb("^\\ *[\\+|\\-]?\\ *\\d+(\\"+a+"\\d{3,})+(\\"+i+"\\d*)?([E|e][\\+|\\-]?\\d+)?\\ *$").test(t)&&(t=t.replace(g.qb("[ \\"+a+"]"),"")))," "===(t=t.trim())[1]&&("+"===t[0]?t=t.replace(/^\+ +/,"+"):"-"===t[0]&&(t=t.replace(/^\- +/,"-"))),"."!==i&&(t=t.replace(i,".")),t.indexOf(i)!==t.lastIndexOf(i))return!1;if(2<=t.length&&"0"===t[0]&&"x"===t[1])return!1;if(o=(+t).valueOf(),s&&(o/=100),l&&(o=-o),wt(o)){if(h=(t=r.trim()).charCodeAt(0),h|=32,4<t.length&&97<=h&&h<=122&&(f=(f=t[0]+t[1]+t[2]).toUpperCase(),!V[f]))return!1;if(u=t[0],c=t[t.length-1],"/"===u||"-"===u||":"===u||"/"===c||"-"===c)return!1;if(g.qb("[\\'\\$\\#\\*\\%\\!\\@\\&\\(\\)\\=\\;\\\"\\<\\>\\?\\,]").test(t))return!1;if(wt((o=new Date(t)).valueOf()))return!1;o=b.Ra(o)}}else if(n===y)o=t?1:0;else{if(!(t instanceof Date))return!1;o=b.Ra(t)}}catch(t){return!1}return e.value=o,!0}function Tt(t){var e={value:0};if(xt(t,e))return e.value;throw k.sR().Exp_InvalidCast}function At(t,e){return e&&(t===x||t===T||typeof t===d&&""===t.trim())}function St(t,e){try{if(t){if(typeof t!==y)if(t instanceof Date)t=0!==b.Ra(t);else{if(!Nt(t))return!1;t=0!==t}}else t=!1}catch(t){return!1}return e.value=t,!0}function Mt(t,e,o,n,r){var i,a,s;if(Rt(t))return t;if(i={value:x},a=j,0!==e&&At(t,n))return a;switch(e){case 1:case 5:if(o&&5!==e){if(typeof t===y&&r)return a;t=xt(t,i)?i.value:a}else typeof t===m||(t=t instanceof Date?b.Ra(t):a);break;case 11:t=xt(t,i)?i.value:a;break;case 4:typeof t===d?t=(s=p.Common.l.Qa(t))!==T&&s!==x?b.Ra(s):a:o?t=xt(t,i)?i.value:a:typeof t===m||t instanceof Date||(t=a);break;case 3:o?t=xt(t,i)?i.value:a:typeof t!==y&&(t=a);break;case 2:t=t===x||t===T?"":""+t}return t}function It(t,e){this.array=t,this.referenceInTwoDimension=e}function Nt(t,e){return typeof t===m||t instanceof Date||!e&&(typeof t===y||!isNaN(t)&&!isNaN(parseFloat(t)))}function Rt(t){return t instanceof R}function kt(t){return t instanceof W}function Et(t){return t instanceof Z}function Dt(t){this.id=Dt.sourceId++,this._service=t,this.Bf=null}function jt(t,e){this._source=t,e?(this._identities=e,this.zf=e.length):this.zf=1}function _t(t){this.type=t}function Ot(){}function Ft(t,e,o){var n=new J(5);return e&&(n.source=e),o&&(n.endSource=o),n.value=t,n}function Pt(){}function Lt(t,e){return t.charAt(e)}function Ht(t,e){for(var o=t.length,n=!1;e<o&&!isNaN(+Lt(t,e));)e++,n=!0;for(e<o&&"."===Lt(t,e)&&e++;e<o&&!isNaN(+Lt(t,e));)e++,n=!0;if(e<o&&("E"===Lt(t,e)||"e"===Lt(t,e)))for(n=!1,++e<o&&("+"===Lt(t,e)||"-"===Lt(t,e))&&e++;e<o&&!isNaN(+Lt(t,e));)e++,n=!0;return{Vi:n,mi:e}}function Bt(t){return"string"==typeof t}function Vt(t){this.Di=t}function zt(t,e){if(!t||8===t.type&&0<=t.value.indexOf("'"))throw k.sR().Exp_FormulaInvalid}function Wt(t,e,o,n){return gt.call(this,t,e,o,n)||this}function Gt(t,e,o,n){void 0===e&&(e=0),void 0===o&&(o=0),this.name=t,this.minArgs=e,this.maxArgs=o;this.$h=n,this.typeName=""}function Ut(){var t,e,o=tt.bi,n=tt.ci,r=[];for(t in o)r.push(o[t]);for(e in n)r.push(n[e]);return r}function Jt(t,e,o){this.Ri=t,this.Si=e,this.kja=o||"i"}function Zt(t){return t%400==0||t%4==0&&t%100!=0||1900===t}function qt(t,e){switch(e){case 0:case 2:case 4:return 360;case 1:return ft(t.getFullYear())?366:365;case 3:return 365;default:return-1}}function Kt(t,e){return t-e}function Yt(t,e){return 0<=v(e,[0,2,4,6,7,9,11])?31:0<=v(e,[3,5,8,10])?30:1===e?ft(t)?29:28:void 0}function Qt(t,e,o,n){var r,i,a=o.getFullYear(),s=o.getMonth(),l=o.getDate(),u=n.getFullYear(),c=n.getMonth(),h=n.getDate();return t?(r=2===s&&pt(a,s)===l,i=2===c&&pt(u,c)===h,e?(r&&(l=30),i&&(h=30)):r&&i&&(h=l=30),31===h&&30<=l&&(h=30)):31===h&&(h=1,e&&c++),31===l&&(l=30),360*(u-a)+30*(c-s)+h-l}function Xt(t,e,o){var n,r=1;return 0<t-e&&(n=t,t=e,e=n,r=-1),0<=v(o,[1,2,3])?r*it(w(e)-w(t)):0<=v(o,[4,5])?r*Qt(!1,5===o,t,e):r*Qt(!0,6===o,t,e)}function $t(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y,b,v=o<100,C=2===o||102===o,w=C||3===o||103===o,x=5===o||105===o,T=4===o||104===o||x,A=9===o||109===o,S=1===o||101===o||A||n,M=6===o||106===o,I=M?1:0,N=!1,R=0;for(i=0;i<D(t);i++){if(d=t[i],g=void 0,(g=w?lt(d,0,!1,!1,!1,C):(m=1,k.ExcelCompatibleCalcMode&&!kt(d)&&!Et(d)||(m=5),lt(d,m,!1,!1,!1,!0))).isError)return g[0];if(g.isConvertError)return O;for(y=g.rangeCount,b=g.isReference,a=0;a<y;a++)for(s=1<y?g[a]:g,b&&(l=d.getRow(a),u=d.getColumn(a)),c=0;c<D(s);c++)if(2===e||!b||!d.isHiddenRow(a,c,v))for(f=s[c],h=0;h<D(f);h++)if(!(1!==e&&2!==e&&b&&d.isSubtotal(a,c+l,h+u)||(null===(p=f[h])||p===j))){if(p&&p._error&&!w)return r&&(r.sumx=0,r.sumx2=0,r.n=0),p;w&&!E(p)&&(!C||""!==p&&U.Na(p,!0))?I++:T&&(!N||x&&p<I||!x&&I<p)?I=p:S?n?(r.sumx+=p,r.sumx2+=p*p,r.n++,r.values.push(p),r.values[0]!==p&&(r.allSame=!1)):(I+=p,R++):M&&(I*=p,R++),N=!0}}return S?A?I:n?void 0:0===R?L:ut(I/R):M?ut(0<R?I:0):I}function te(t,e,o){var n,r,i=o%100,a=7==i||8==i,s=7==i||10==i?1:0,l={sumx:0,sumx2:0,n:0,values:[],allSame:!1},u=$t(t,e,o,!0,l);if(u&&u._error)return u;if(l.n<=s)return L;if(l.allSame)u=0;else if(ht(l.n*l.sumx2,l.sumx*l.sumx))for(n=l.sumx/l.n,r=u=0;r<l.n;r++)u+=A(l.values[r]-n,2);else u=l.sumx2-l.sumx*l.sumx/l.n;return u/=l.n-s,ut(a?Math.sqrt(u):u)}function ee(t){var e=t.charCodeAt(0);return 0<=e&&e<129||63728===e||65377<=e&&e<65440||63729<=e&&e<63732?"singleByte":55296<=e&&e<=57343?"fourByte":"doubleByte"}function oe(t){var e,o=[];for(e=0;e<t.length;e++)E(t[e])?(o[e]=t[e+1],e++):o[e]=t[e];return o.length===t.length-1&&(o[o.length]=T),o}function ne(t,e){var o,n;for(void 0===e&&(e=!0),o=[],n=0;n<D(t);n++)ie(t[n],o,e);return o}function re(t){t.sort(function(t,e){return t-e})}function ie(t,e,o){var n,r;for(void 0===o&&(o=!0),n=0;n<D(t);n++)(r=t[n])!==j&&e.push(r);o&&re(e)}function ae(t,e,o){var n,r=[];return ie(e,r),n=D(r),o<1||n<o?P:(o=(t?M:S)(o),t?r[n-o]:r[o-1])}function se(t,e){var o,n,r;return t=lt(t,1,!0,!0,!1,!0),e=at(e),t.isError?t[0]:t.isConvertError||f(e)?O:(ie(t,o=[]),!D(o)||e<0||1<e?P:(r=(n=e*(D(o)-1))%1,n=C(""+n),0==r?o[n]:at(o[n])+r*(at(o[n+1])-at(o[n]))))}function le(t,e){var o,n,r,i,a,s,l=D(t),u=[];for(o=0;o<l;o++)st(t[o],!0)&&u.push(t[o]);return u.length?(n=u.length,re(u),i=(r=e*(n+1)-1)%1,r<0||n-1<r?P:(s=u[a=S(r)],0==i?s:s+i*(u[a+1]-s))):P}function ue(t,e){var o,n,r,i,a,s,l,u,c,h,f=13===e,p=14===e,d=15===e,g=16===e,m=17===e,y=18===e,b=19===e;return 12===e?function(t){var e,o,n,r=[];for(e=0;e<arguments.length;e++)r[e]=arguments[e];return o=ne(t),0===(n=D(o))?P:n%2==0?(at(o[n/2-1])+at(o[n/2]))/2:o[C(""+n/2)]}(t):f?function(t){var e,o,n,r,i,a,s,l,u=[];for(e=0;e<arguments.length;e++)u[e]=arguments[e];for(o=x,n=0,r=ne(t,!1),i=D(r),a=0;a<i;a++){for(s=l=0;s<i;s++)s!==a&&r[s]===r[a]&&l++;n<l&&(n=l,o=r[a])}return 0===n?H:o}(t):p?(c=t[0],h=t[1],ae(!0,c,h)):d?(l=t[0],u=t[1],ae(!1,l,u)):g?se(t[0],t[1]):m?(i=t[0],a=t[1],(s=v(a,[0,1,2,3,4]))<0?P:se(i,.25*s)):y?le(t[0],t[1]):b?(o=t[0],n=t[1],(r=v(n,[1,2,3]))<0?P:le(o,.25*(r+1))):B}function ce(t,e,o){var n;return 0===t?n=e<=o:1===t?n=o<=e:2===t?n=e!==o:3===t?n=e<o:4===t?n=e===o:5===t&&(n=o<e),n}function he(r,i){var a,t,s=-1,l=!0,e={value:0},u=g.zb(i);if(4!==r&&2!==r||!u||((t=i.replace(/\*+/g,"*"))!==i&&(u=g.zb(t)),a=function(t){if(""===t)return 2===r;var e=g.sb(u);return e.lastIndex=0,4===r?e.test(t):!e.test(t)}),4===r&&p.Common.F(i,Date))return function(t,e){var o={value:null};return!(!t||!U.Xh(t,o))&&o.value.getTime()===i.getTime()};return E(i)?s=0:u?l=!1:0===(""+i).trim().length||f(parseFloat(i))||!rt(i,e)?l=!1:s=e.value,function(t,e){var o,n;return(""!==i||4===r||2===r)&&!(!e&&t instanceof R)&&(E(t)&&(t=""),o={value:0},!(k.ExcelCompatibleCalcMode&&l&&!st(t,!0)&&4!==r&&2!==r)&&(l&&rt(t,o)?""===t?2===r:ce(r,o.value,s):u&&st(t,!0)?2===r:(n=E(i)?"":(""+i).toUpperCase(),u&&a?a(""+t):ce(r,(""+t).toUpperCase(),n))))}}function fe(){}function pe(t){var e=yt.call(this,x)||this;return e.u4=t,e}Object.defineProperty(k,"__esModule",{value:!0}),p=e("Common"),o=e("./src/calcEngine.res.en.ts"),k.ExcelCompatibleCalcMode=!1,k.SR={en:o.resource},k.ErrorCodeList=[0,7,15,23,29,42,36,99,100],m="number",d="string",y="boolean",n=["#NULL!","#DIV/0!","#VALUE!","#REF!","#NAME?","#N/A","#NUM!","#SPILL!","#CALC!"],k.ErrorList=n,k.BAND_INDEX_CONST=-2147483648,k.MAX_ROW_COUNT=1048576,k.MAX_COLUMN_COUNT=16384,c=p.Common.j,h=c.Ca,E=c.Fa,v=c.Ea,D=p.Common.k.ac,g=p.Common.q,C=parseInt,f=isNaN,b=p.Common.l,w=b.Ra,a=p.Common.u,i=p.Common.o,r=new p.Common.ResourceManager(k.SR,"CalcEngine"),k.sR=r.getResource.bind(r),k.getMapping=function(){return Q&&Q.resourceMapping},k.getBoolean=function(){var t=k.getMapping()&&k.getMapping().booleanMapping;return{boolean_true:t&&t.boolean_true||"TRUE",boolean_false:t&&t.boolean_false||"FALSE"}},x=null,T=void 0,s=Math.abs,l=Math.exp,u=Math.log,A=Math.pow,S=Math.floor,M=Math.ceil,I={},k.BangSource=I,N={},k.RefErrorSource=N,k.missingArgument=void 0,j={},Ct.prototype.toString=function(){var t=k.getMapping()&&k.getMapping().clacErrorMapping;return t&&t[this._error]||this._error},Ct.prototype.clone=function(){return new Ct(this._error)},Ct.prototype.toJSON=function(){return{_calcError:this._error,_code:this._code}},Ct.parse=function(t){try{return new Ct(t)}catch(t){return T}},Ct.nf=function(t){var e,o;if(t)for(e=0;e<n.length;e++)if((o=n[e])===t||o===vt(t))return{error:o,code:k.ErrorCodeList[e]};return T},R=Ct,k.CalcError=R,_={Name:new R("#NAME?"),Null:new R("#NULL!"),DivideByZero:new R("#DIV/0!"),NotAvailable:new R("#N/A"),Value:new R("#VALUE!"),Reference:new R("#REF!"),Number:new R("#NUM!"),Spill:new R("#SPILL!"),Calc:new R("#CALC!")},k.Errors=_,O=_.Value,F=_.Reference,P=_.Number,L=_.DivideByZero,H=_.NotAvailable,B=_.Null,V={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12},z=function(){},k.ParserWrapper=z,It.prototype.getRowCount=function(){return this.array.length},It.prototype.getColumnCount=function(){var t=this.array[0];return t&&t.length||0},It.prototype.getValue=function(t,e){var o=this.array,n=t;return"number"!=typeof e&&(n=t.row,e=t.column),n<0||e<0||n>=o.length||e>=o[0].length?O:this.array[n][e]},It.prototype.getValueByIndex=function(t){var e=this.getColumnCount(),o=S(t/e),n=t%e;return this.getValue(o,n)},It.prototype.toArray=function(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d;if(void 0===e&&(e=!0),l=0,u=[],f=j,s=this.getRowCount())for(l=this.getColumnCount(),p=0;p<s;p++)for(e||(h=[],u.push(h)),d=0;d<l;d++){if(c=this.getValue(p,d),this.referenceInTwoDimension&&Et(c)&&(c=c.getValueByIndex(0)),o&&Rt(c))return(u=[c]).isError=!0,u;if(c=Mt(c,t,!1,i),n&&c===f)return(u=[c]).isConvertError=!0,u;e?u.push(c):h.push(c)}return u.rowCount=s,u.colCount=l,u.rangeCount=1,u},It.prototype.slice=function(t,e,o,n){var r,i,a,s=this.array,l=[];for(e=e<0?0:e,o=(t=t<0?0:t)+o>this.getRowCount()?this.getRowCount()-t:o,n=e+n>this.getColumnCount()?this.getColumnCount()-e:n,i=0;i<o;i++)for(r=[],l.push(r),a=0;a<n;a++)r.push(s[i+t][a+e]);return new It(l)},W=It,k.CalcArray=W,G=["o","n","s","b","d"],Ot.jja=function(t){return Rt(t)&&t._code===k.ErrorCodeList[5]},Ot.Nh=function(t){return isNaN(t)||!isFinite(t)?P:t},Ot.Ph=function(t,e,o,n,r,i,a,s){var l,u,c;if(t&&t.length&&t.rowCount&&t.colCount)return t;if(kt(t))(l=t.toArray(e,o,n,r,i)).isArray=!0;else if(Et(t))(l=t.toArray(e,o,n,r,i,a,s)).isReference=!0;else if(h(t)){if(l=[],0===t.length)return l;if(h(t[0]))return Ot.Oh(t,e,!0);for(u=0;u<t.length;u++)(c=Mt(t[u],e,!1))===Ot.CalcConvertedError&&(l.isConvertError=!0),l.push(c);l.rowCount=1,l.colCount=t.length,l.rangeCount=1}else t=Mt(t,e,!0,i),n&&Ot.vf(t)?(l=[O]).isError=!0:t===Ot.CalcConvertedError?(l=[Ot.CalcConvertedError]).isConvertError=!0:o?(l=[]).push(t):(l=[[]])[0].push(t),l.rowCount=1,l.colCount=1,l.rangeCount=1;return l},Ot.Oh=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g;if(!t||!t.length||!t[0].length)return(n=[]).isError=!0,[[O]];if(0===e)return t;if(r=G[e],i=t.length,a=t[0].length,f=h=!(c={value:x}),p=Ot.CalcConvertedError,!(n=t[r]))for(n=[],t[r]=n,d=0;d<i;d++)for(s=t[d],l=n[d]=[],g=0;g<a;g++)if(Rt(u=s[g]))h=h||(n.isError=!0),l.push(u);else{switch(e){case 1:case 5:o&&5!==e?u=xt(u,c)?c.value:(f||(f=!0,n.isConvertError=!0),0):typeof u===m||u instanceof Date||(f||(f=!0,n.isConvertError=!0),u=p);break;case 3:o?u=St(u,c)?c.value:(f||(f=!0,n.isConvertError=!0),!1):typeof u!==y&&(f||(f=!0,n.isConvertError=!0),u=p);break;case 2:u=u===x||u===T?"":""+u}l.push(u)}return n},Ot.Rh=function(t){var e=Tt(t);if(s(e)<1e21)return parseInt(""+e,10);throw k.sR().Exp_InvalidCast},Ot.Sh=function(t,e){return""!==t&&!!xt(t,e)&&s(e.value)<1e21&&(e.value=parseInt(""+e.value,10),!0)},Ot.Vh=function(t){if(!t)return!1;if(typeof t===y)return t;if(t instanceof Date)return 0!==b.Ra(t);if(Ot.Na(t))return 0!==t;if(Ot.vf(t))return!1;throw k.sR().Exp_InvalidCast},Ot.bc=function(t){try{if(t===T||t===x)return"";if(typeof t===y)return t?"TRUE":"FALSE";if(typeof t===d)return t;if(t instanceof Date)return""+b.Ra(t);if(kt(t))throw k.sR().Exp_InvalidCast;return typeof t===m?""+i.Lma(t,Q.CALC_PRECISION||15):""+t}catch(t){throw k.sR().Exp_InvalidCast}},Ot.Wh=function(t){var e={value:x};if(Ot.Xh(t,e))return e.value;throw k.sR().Exp_InvalidCast},Ot.Xh=function(t,e){var o,n,r,i;if(t)if(t instanceof Date)e.value=new Date(t.valueOf());else if(typeof t===d){if(!(o=p.Common.l.Qa(t)))if(isNaN(t)){if(o=new Date(t),isNaN(o.valueOf()))return!1;try{if(n=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,r=a.ib(a.Db(t.replace(/ |\n/g,"")," ")," "),(i=n.exec(r))&&4===i.length&&(-1===i.indexOf(""+o.getFullYear())||-1===i.indexOf(""+o.getMonth())||-1===i.indexOf(""+o.getDate())))return!1}catch(t){return!1}}else if(!(o=p.Common.l.Xb(parseFloat(t))))return!1;e.value=o}else{if(typeof t!==m)return!1;e.value=p.Common.l.Xb(t)}else e.value=p.Common.l.Xb(0);return!0},Ot.CalcConvertedError=j,Ot.Ca=kt,Ot.Na=Nt,Ot.vf=Rt,Ot._isReference=Et,Ot.wf=Mt,Ot.j$a=At,Ot.Qh=wt,Ot.Pa=Tt,Ot.Th=xt,Ot.Uh=St,U=Ot,k.Convert=U,($=k.ExpressionType||(k.ExpressionType={}))[$.unknow=0]="unknow",$[$.reference=1]="reference",$[$.number=2]="number",$[$.string=3]="string",$[$.boolean=4]="boolean",$[$.error=5]="error",$[$.array=6]="array",$[$.function=7]="function",$[$.name=8]="name",$[$.operator=9]="operator",$[$.parentheses=10]="parentheses",$[$.missingArgument=11]="missingArgument",$[$.expand=12]="expand",$[$.structReference=13]="structReference",$[$.field=14]="field",$[$.spillReference=33]="spillReference",$[$.letLocalName=100]="letLocalName",_t.prototype.sf=function(){return x},_t.prototype.offset=function(t,e,o,n,r){return x},_t.prototype.offsetWhenCopy=function(t,e,o,n,r,i,a,s,l,u){return x},_t.prototype.getRange=function(t,e){var o,n=[];for(o=2;o<arguments.length;o++)n[o-2]=arguments[o];return x},J=_t,k.Expression=J,jt.prototype.getRangeCount=function(){return this.zf},jt.prototype.getSource=function(){return this._source},jt.prototype.create=function(t){return new jt(this._source,t)},jt.prototype.toArray=function(t,e,o,n,r,i,a){var s=this._source,l=s.referenceToArray;return l&&l.call(s,this,t,e,o,n,r,i,a)},jt.prototype.getRow=function(t){return this._identities?this._identities[t||0].row:0},jt.prototype.getColumn=function(t){return this._identities?this._identities[t||0].col:0},jt.prototype.getRowCount=function(t){return this._identities?this._identities[t||0].rowCount:this._source.getRowCount()},jt.prototype.getColumnCount=function(t){return this._identities?this._identities[t||0].colCount:this._source.getColumnCount()},jt.prototype.getValue=function(t,e,o){var n,r,i;if(typeof t===m?(n=arguments[1],r=o,e=arguments[0]):(n=(t=t).row,r=t.col),e=e||0,0<=n||0<=r){if(!(i=this._identities))return this._source.getValue(n,r);if(e<i.length)return this._source.getValue(n+i[e].row,r+i[e].col)}return F},jt.prototype.getValueByIndex=function(t){var e=this.getColumnCount(),o=S(t/e),n=t%e;return this.getValue(0,o,n)},jt.prototype.isHiddenRow=function(t,e,o){return this._source.isHiddenRow(e+this.getRow(t),o)},jt.prototype.isSubtotal=function(t,e,o){var n=this._source;return 0===t&&e<n.getRowCount()&&o<n.getColumnCount()&&function t(e){var o,n;if(e){if(7===e.type&&("SUBTOTAL"===e.functionName||"AGGREGATE"===e.functionName))return!0;for(o=e.arguments&&e.arguments.length,n=0;n<o;n++)if(t(e.arguments[n]))return!0;if(t(e.value)||t(e.value2))return!0}return!1}(n.getCalcSourceModel()._getExpressionWithRowColumn(e,o))},Z=jt,k.CalcReference=Z,Dt.prototype.getCalcService=function(){return this._service},Dt.prototype.Cf=function(){return this._service},Dt.prototype.setCalcService=function(t){this._service=t},Dt.prototype.getCalcSourceModel=function(){return this.Bf},Dt.prototype.setCalcSourceModel=function(t){this.Bf=t},Dt.prototype.getValue=function(){var t,e=[];for(t=0;t<arguments.length;t++)e[t]=arguments[t];return x},Dt.prototype.getName=function(){return""},Dt.prototype.getField=function(t){return x},Dt.prototype.setValue=function(){var t,e=[];for(t=0;t<arguments.length;t++)e[t]=arguments[t]},Dt.prototype.getReference=function(t){return new Z(this,t&&[t])},Dt.prototype.getSources=function(t){return[this]},Dt.prototype.referenceToArray=function(t,e,o,n,r,i,a,s){return t.toArray(e,o,n,r,i,a,s)},Dt.prototype.setFormula=function(){var t,e=[];for(t=0;t<arguments.length;t++)e[t]=arguments[t]},Dt.prototype.setArrayFormula=function(){var t,e=[];for(t=0;t<arguments.length;t++)e[t]=arguments[t]},Dt.prototype.getRowCount=function(){return 1e3},Dt.prototype.getColumnCount=function(){return 100},Dt.prototype.isHiddenRow=function(t,e){return!1},Dt.prototype.startCalculation=function(){},Dt.prototype.endCalculation=function(){},Dt.prototype.getCustomFunction=function(t){return x},Dt.prototype.getCustomName=function(t){return x},Dt.prototype.refresh=function(){},Dt.prototype.toJSON=function(t,e){var o,n=[];for(o=2;o<arguments.length;o++)n[o-2]=arguments[o]},Dt.sourceId=1,q=Dt,k.CalcSource=q,k.Hh=Ft,k.Ih=Ft(F),k.Jh=function(t,e){var o=new J(7);return o.arguments=e,t instanceof J?(o.function=t.function,o.functionName=t.functionName):(o.function=t.name&&t,o.functionName=t.name||t),o},k.createExpandExpression=function(t,e){var o=new J(12);return o.value=t,o.needExpendIndexs=e,o},k.Kh=function(t,e,o){var n=new J(9);return n.operatorType=t,n.value=e,n.value2=o,n},k.Lh=function(t){var e=new J(10);return e.value=t,e},k.createStringExpression=function(t){var e=new J(3);return e.value=t,e},k.createNumberExpression=function(t){var e=new J(2);return e.value=t,e},k.createBooleanExpression=function(t){var e=new J(4);return e.value=t,e},Pt.Yh=function(t,e){var o=16777216;return!!(t===e||s(t-e)<s(t)/(o*o))||(t=i.Lma(t,15),e=i.Lma(e,15),s(t-e)<s(t)/(o*o))},Pt.getArrayValue=function(t,e,o){return t?e<t.getRowCount()&&o<t.getColumnCount()?t.getValue(e,o):o>=t.getColumnCount()&&1===t.getColumnCount()&&e<t.getRowCount()?t.getValue(e,0):e>=t.getRowCount()&&1===t.getColumnCount()&&o<t.getColumnCount()?t.getValue(0,o):O:O},Pt.tryExtractToSingleValue=function(t){var e,o=!0;return(Et(t)||kt(t))&&((e=U.Ph(t,0,!1,!0)).isError?t=e[0]:1===e.rowCount&&1===e.colCount?t=e[0][0]:(t=e,o=!1)),{value:t,success:o}},K=Pt,k.Zh=K,k.charAtFunc=Lt,Vt.prototype.$j=function(t){var e,o,n,r,i,a,s,l,u=this.Di;if(c.Ca(u)||(u=[u]),-1===u[0])return!0;for(e=0;e<u.length;e++)if(r=n=void 0,Bt(o=u[e])){for(i=o.split(" && "),a=!0,s=0;s<i.length;s++)n=(l=i[s].split(" "))[0],r=C(l[1]),"!="===n&&t!==r||">"===n&&r<t||">="===n&&r<=t||"%="===n&&t%2===r||(a=!1);if(a)return!0}else if(t===o)return!0;return!1},Vt.prototype._j=function(){return this.Di},Y=Vt,k.iEc=zt,tt=Q=Q||{},(mt=tt.ArrayArgumentEvaluateMode||(tt.ArrayArgumentEvaluateMode={}))[mt.normal=0]="normal",mt[mt.allwaysExpand=1]="allwaysExpand",mt[mt.neverExpand=2]="neverExpand",Gt.prototype.description=function(){var t=k.sR()._h;return this.$h?this.$h:t&&t[this.name]},Gt.prototype.acceptsArray=function(t){return!1},Gt.prototype.acceptsReference=function(t){return!1},Gt.prototype.acceptsError=function(t){return!1},Gt.prototype.acceptsMissingArgument=function(t){return!1},Gt.prototype.isVolatile=function(){return!1},Gt.prototype.isContextSensitive=function(){return!1},Gt.prototype.isBranch=function(){return!1},Gt.prototype.findTestArgument=function(){return-1},Gt.prototype.findBranchArgument=function(t){return-1},Gt.prototype.expandRows=function(){return!0},Gt.prototype.expandColumns=function(){return!0},Gt.prototype.skipPrecedent=function(t){return!1},Gt.prototype.returnReference=function(){return!1},Gt.prototype.evaluate=function(){var t,e=[];for(t=0;t<arguments.length;t++)e[t]=arguments[t]},Gt.prototype.evaluateWithContext=function(t,e){var o=e;return this.isContextSensitive()&&(o=[t].concat(o)),this.evaluate.apply(this,o)},Gt.prototype.toJSON=function(){var t,e={};for(t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},Gt.prototype.fromJSON=function(t){if(t)for(var e in t)t[e]!==T&&(this[e]=t[e])},Gt.prototype.gEc=function(t,e,o){if(o<t||e<o)throw k.sR().Exp_FormulaInvalid},Gt.prototype.hEc=function(t,e){zt(t)},Gt.ai=function(t,e,o){var n,r=new Gt(t,0,255);if(e&&"function"==typeof e&&(r.evaluate=e),o)for(n in o)o.hasOwnProperty(n)&&"override"!==n&&(r[n]=o[n]);return r},et=Gt,tt.Function=et,bt(Wt,gt=et),Wt.prototype.isContextSensitive=function(){return!0},Wt.prototype.evaluate=function(t,e){return this.evaluateAsync.apply(this,arguments)},Wt.prototype.evaluateAsync=function(t,e){this.evaluate.apply(this,arguments)},Wt.prototype.defaultValue=function(){return 0},Wt.prototype.evaluateMode=function(){return 0},Wt.prototype.evaluateWhenArgumentsIsSame=function(){return!0},Wt.prototype.interval=function(){return 1e4},tt.AsyncFunction=Wt,tt.AsyncFunctionEvaluateMode={onRecalculation:0,calculateOnce:1,onInterval:2},tt.bi={},tt.ci={},tt.defineGlobalCustomFunction=function(t,e){return tt.ci[vt(t)]=e},tt.findGlobalFunction=function(t){var e,o,n;return t?(t=vt(t),e=tt.bi,o=tt.ci,n=k.getMapping()&&k.getMapping().builtInFunctionsMapping,e&&(function(t,e){var o,n=tt.bi;if(!E(t))for(o in t)if(t[o].alias===e)return n[o];return T}(n,t)||e[t])||o&&o[t]):Ut()},tt.findGlobalFunctions=function(){return Ut()},tt.removeGlobalFunction=function(t){if(!t)return tt.bi={},void(tt.ci={});t=vt(t);var e=tt.bi,o=tt.ci;e[t]?delete e[t]:o[t]&&delete o[t]},ot=k.sR().Exp_Format,Jt.prototype.Pi=function(){return this.Ri},Jt.prototype.Qi=function(){return this.Si},Jt.prototype.lja=function(){return this.kja},Jt.prototype.bc=function(t){t=t||"i";var e=this.Ri,o=this.Si,n="",r=tt.CALC_PRECISION;return r&&(e=i.Lma(e,r),o=i.Lma(o,r)),0===e&&0!==o||(n+=""+e),-1===o?n+="-":0!==e&&0<o&&(n+="+"),-1!==o&&0!==o&&1!==o&&(n+=""+o),0!==o&&(n+=t),n},nt=Jt,tt.Ui=nt,tt.Wi=function(t){try{return t?"number"==typeof t?new nt(t,0):"string"==typeof t?function(t){var e,o,n,r,i=0,a=0,s=!1,l=0,u=0,c=0,h=t.length;if(!t)throw k.sR().Exp_ArgumentNull;if(0===h)throw ot;if(c<h&&("+"===Lt(t,c)||"-"===Lt(t,c))&&c++,c=(r=Ht(t,c)).mi,e=r.Vi,c<h&&("+"===Lt(t,c)||"-"===Lt(t,c))?(l=c,c=(r=Ht(t,++c)).mi,o=r.Vi,c<h&&("i"===Lt(t,c)||"j"===Lt(t,c))&&(n=Lt(t,c),c++,s=!0),u=c-l):c<h&&("i"===Lt(t,c)||"j"===Lt(t,c))?(n=Lt(t,c),u=++c,o=e,e=!(s=!0)):l=c,c<h)throw ot;if(0<l){if(!e)throw ot;i=parseInt(t.substr(0,l),10)}if(0<u){if(!s)throw ot;if(1===u||2===u&&"+"===Lt(t,l))a=1;else if(2===u&&"-"===Lt(t,l))a=-1;else{if(!o)throw ot;a=parseInt(t.substr(l,u-1),10)}}return new nt(i,a,n)}(t):null:new nt(0,0)}catch(t){return null}},rt=U.Th,it=U.Rh,at=U.Pa,st=U.Na,lt=U.Ph,ut=U.Nh,ct=U.vf,ht=K.Yh,tt.ak=function(t,e,o,n,r,i,a,s,l){return s=s||{},o!==T&&(s.minArgs=o),n!==T&&(s.maxArgs=n),i!==T&&(s.acceptsReference=i),a!==T&&(s.acceptsArray=a),r!==T&&(s.Ci=r),s.bk!==T&&(s.acceptsMissingArgument=s.bk),s.ck!==T&&(s.isVolatile=s.ck),s.dk!==T&&(s.isContextSensitive=s.dk),s.KMc!==T&&(s.skipPrecedent=s.KMc),s.fk!==T&&(s.arrayArgumentEvaluateMode=s.fk),s.gk!==T&&(s.acceptsError=s.gk),l!==T&&(s.isDynamicArrayFunction=l),function(t,e,n){var r,i,o;if(E(t))throw k.sR().Exp_InvalidFunctionName;if(t=t.toUpperCase(),tt.bi[t])throw k.sR().Exp_InvalidOverrideFunction;if(r=tt.bi[t]){if(!n||!n.override)throw k.sR().Exp_OverrideNotAllowed}else tt.bi[t]=r=new et(t,0,255);return e&&"function"==typeof e&&(r.evaluate=e),"function"==typeof n.argsValidator&&(i=r.gEc,r.gEc=function(t,e,o){i(t,e,o),n.argsValidator(t,e,o)}),"function"==typeof n.subExpressionValidator&&(o=r.hEc,r.hEc=function(t,e){o(t,e),n.subExpressionValidator(t,e)}),c.H(n,function(t,e){var o;0<=v(t,["acceptsReference","acceptsArray","acceptsError","acceptsMissingArgument","skipPrecedent"])?(o=new Y(e),r[t]=function(t){return o.$j(t)}):0<=v(t,["isVolatile","isBranch","findTestArgument","returnReference","isContextSensitive","expandColumns","expandRows"])?(o=new Y(e),r[t]=function(){return o._j()}):n.hasOwnProperty(t)&&(r[t]=e)}),r}(t,e,s)},tt.hk=179769e303,tt.ik=function(t){return"boolean"==typeof t},tt.jk=Bt,tt.Na=function(t){return"number"==typeof t},tt.kk=Zt,ft=Zt,tt.lk=qt,tt.mk=Kt,tt.nk=Yt,pt=Yt,tt.pk=Xt,tt.qk=function(t){var e,o,n;return o=0===t?0:3<=(n=.5*s(t))?1:n<1?((((((((.000124818987*(e=n*n)-.001075204047)*e+.005198775019)*e-.019198292004)*e+.059054035642)*e-.151968751364)*e+.319152932694)*e-.5319230073)*e+.797884560593)*n*2:(((((((((((((-45255659e-12*(n-=2)+.00015252929)*n-19538132e-12)*n-.000676904986)*n+.001390604284)*n-.00079462082)*n-.002034254874)*n+.006549791214)*n-.010557625006)*n+.011630447319)*n-.009279453341)*n+.005353579108)*n-.002141268741)*n+.000535310849)*n+.999936657524,0<t?.5*(o+1):.5*(1-o)},tt.Hfc=$t,tt.sk=te,tt.mja=function(t,e,p,a){var d,g,m,y,b,o,n,r,i,s,l,u,c;if(null===p)return O;if((p=parseInt(p,10))<=0||19<p)return O;function h(t){var e,o,n,r,i,a,s,l,u,c,h,f=[];if((e=lt(t,b?0:5,!1,!1,!1,!1)).isConvertError)return O;for(c=e.rangeCount,h=e.isReference,o=0;o<c;o++)for(n=1<c?e[o]:e,h&&(r=t.getRow(o),i=t.getColumn(o)),a=0;a<D(n);a++)if(!(h&&t.isHiddenRow(o,a,!1)&&d))for(l=n[a],s=0;s<D(l);s++)if(!(h&&g&&t.isSubtotal(o,a+r,s+i)||(null===(u=l[s])||m&&ct(u)||ct(u)&&y))){if(!m&&ct(u)&&3!==p)return u;"object"==typeof u&&0===Object.keys(u).length||f.push(u)}return f}if(d=1===(e=e||0)||3===e||5===e||7===e,g=1===e||2===e||3===e||0===e,m=2===e||3===e||6===e||7===e,b=(y=2===p)||3===p,o=12===p,n=13===p,r=14===p||15===p||16===p||17===p||18===p||19===p,i=[],s=D(t),r){if(2!==s)return O;if((i=h(t[0]))._error)return i;if(l=void 0,t[1]===x)return P;if(t[1]instanceof Z)l=function(t){var e,o=t.getRow(0),n=t.getColumn(0),r=t.getRowCount(0),i=t.getColumnCount(0);if(1===r&&1===i)e=t.getValue(0,0,0);else if(1!==r&&1===i&&o<=a.row&&a.row<o+r)e=t.getValue(0,a.row-o,0);else{if(!(1===r&&1!==i&&n<=a.column&&a.column<n+i))return O;e=t.getValue(0,0,a.column-n)}return e===x||""===e?P:isNaN(parseInt(e,10))?O:parseFloat(e)}(t[1]);else if(t[1]instanceof W)l=t[1].array[0][0];else{if(isNaN(parseInt(t[1],10)))return O;l=at(t[1])}return l._error?l:(17!==p&&19!==p||(l=it(l)),ue([i,l],p))}for(u=0;u<s;u++)if(!(t[u]instanceof Z))return O;for(u=0;u<s;u++){if(!((c=h(t[u]))instanceof Array))return c;i.push.apply(i,c)}return o||n?ue([i],p):7===p||8===p||10===p||11===p?te(i,g?1:0,p):$t(i,1,p)},tt.UAb=ee,tt.WAb=oe,tt.VAb=function(t){var e,o,n,r=[],i=0,a=0;for(o=0;o<t.length;o++){if(e=t[o],"doubleByte"===(n=ee(t[o]))||"fourByte"===n)if("fourByte"===n){if(i%2==0){i++;continue}a++,i++,e=t[o-1]+t[o]}else a++,e=t[o];r[o-(0<i?i/2:0)+a]=e}return oe(r)},tt.sja=ue,tt.tk=function(t){var e,o=1;for(e=t;1<e;e--)o*=e;return o},tt.uk=function(t,e,o){var n=t.getDate(),r=e.getDate(),i=t.getMonth(),a=e.getMonth(),s=t.getFullYear(),l=e.getFullYear();return n=31===n?30:n,o?r=31===r?30:r:31===r&&(n<30?(r=1,12<++a&&(a=1,l++)):r=30),30*(12*(l-s)+a-i)+r-n},tt.vk=function(t,e,o){return o<0||4<o?P:((p=Xt(n=t,r=e,i=o))<0&&(p=-p,a=n,n=r,r=a),p/(1===i?(s=n.getFullYear(),l=r.getFullYear(),f=h=c=u=void 0,(u=new Date(n.valueOf())).setFullYear(u.getFullYear()+1),h=0<r-u?(f=l+1-s,u=new Date(s,0,1),c=new Date(l+1,0,1),it(w(c)-w(u))-365*(l+1-s)):(f=1,ft(s)&&n.getMonth()<2||ft(l)&&285<=256*r.getMonth()+r.getDate()?1:0),365+at(h)/at(f)):qt(new Date,i)));var n,r,i,a,s,l,u,c,h,f,p},dt={},fe.wk=function(t){var e=S(t);return ht(t,e+1)?e+1:e},fe.xk=function(t){var e,o,n,r,i,a=t,s=dt;if(s||(dt=s={}),e=s[a])return e;if(st(t))return s[a]=he(4,t);for(o=E(t)?"":(""+t).toUpperCase(),n="\0",r=0;r<2&&r<D(o);r++){if(i=o[r],-1==="=><".indexOf(i)){if("<"===n)return s[a]=e=he(3,o.substring(1)),e;if(">"===n)return s[a]=e=he(5,o.substring(1)),e;break}if("="===i)return e="<"===n?he(0,o.substring(2)):">"===n?he(1,o.substring(2)):he(4,"\0"===n?o.substring(1):t),s[a]=e;if("\0"===n)n=i;else{if("<"===n)return e=">"===i?he(2,o.substring(2)):he(3,o.substring(1)),s[a]=e;if(">"===n)return s[a]=e=he(5,o.substring(1)),e}}return s[a]=e=he(4,t),e},fe.yk=function(t){var e=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13,1e14,1e15,1e16][t];return 308<t&&(t=308),E(e)?A(10,parseFloat(t)):e},fe.zk=function(t){var e=M(t);return ht(t,e-1)?e-1:e},fe.Ak=function(t,e){var o,n,r=fe.yk(s(e)),i=M,a=S;return o=(t=e<0?t/r:t*r).toExponential(),(n=C(o.split("e")[1])+1)<=15&&-85<=n&&(t=parseFloat(t.toFixed(15-n))),t=t<0?i(t-.5):a(t+.5),ut(t=e<0?t*r:t/r)},fe.Bk=function(t,e){var o,n;if(t<0||e<0||t<e)return P;for(o=1,e=Math.min(t-e,e),n=1;n<=e;n++)o*=t-n+1,o/=n;return ut(o)},fe.YDc=function(t,e){if(t<0&&s(e)<1){var o=(1/e).toPrecision(15);if(parseFloat(o)===parseInt(o,10)&&parseInt(o,10)%2!=0)return-A(-t,e)}return A(t,e)},fe.Ck=function(t,e){var o=.5<s(t)?A(1+t,e):l(e*u(1+t));return isFinite(o)?f(o)&&(o=5e-324):o===Number.POSITIVE_INFINITY?o=tt.hk:o===Number.NEGATIVE_INFINITY&&(o=-tt.hk),o},fe.Dk=function(t,e){return(l(t)+(e?-1:1)*l(-t))/2},fe.Ek=function(t,e){return f(t)?t:f(e)?e:1!==e&&1===t||0!==e&&e!==Number.POSITIVE_INFINITY?u(t)/u(e):NaN},tt.MathHelper=fe,k.Functions=Q,k.gOb=function(o,n,r){var t,e,i,a,s,l,u,c,h,f;if(void 0===r&&(r=!0),Rt(o))return o;if(Rt(n))return n;if(i=typeof n===y,(e=typeof o===y)||i)t=e&&i?o===n?0:n<o?1:-1:e?1:-1;else{if(s=typeof n===d,u=(l=(a=typeof o===d)||s)?"":0,o=o===x||o===T?u:o,n=n===x||n===T?u:n,c=function(){var e,t;if(o===n)return 0;if(a&&s){e=void 0;try{e=(t=p.Common.CultureManager.getCultureInfo()).localeCompare?r?t.localeCompare(o,n):t.localeCompare(o.toUpperCase(),n.toUpperCase()):r?o.localeCompare(n):o.toUpperCase().localeCompare(n.toUpperCase())}catch(t){e=r?o.localeCompare(n):o.toUpperCase().localeCompare(n.toUpperCase())}return e}return a?1:s?-1:K.Yh(o,n)?0:o-n},!l){if(f={value:0},!xt(o,h={value:0})||!xt(n,f))return O;o=h.value,n=f.value}t=c()}return t},bt(pe,yt=q),pe.prototype.startCalculation=function(){},pe.prototype.endCalculation=function(){},pe.prototype.getValue=function(){return _.Reference},pe.prototype.getReference=function(){var t=new Z(this,[{row:0,col:0}]);return t.getValue=function(){return _.Reference},t},pe.prototype.referenceToArray=function(){var t=[_.Reference];return t.isError=!0,t},pe.prototype.getName=function(){return this.u4},pe.prototype.setValue=function(){},k.ErrorSource=pe},"./src/calc.entry.ts":function(t,o,e){"use strict";var n,r;function i(t){for(var e in t)o.hasOwnProperty(e)||(o[e]=t[e])}Object.defineProperty(o,"__esModule",{value:!0}),i(e("./src/calc.common.ts")),i(e("./src/Parser.ts")),i(e("./src/evaluator.ts")),i(e("./src/calc.ts")),i(e("./src/referenceExpression.ts")),n=e("./src/calc.ts"),Object.defineProperty(o,"supportRowColumnFormula",{set:function(t){n.supportRowColumnFormula=t},get:function(){return n.supportRowColumnFormula}}),Object.defineProperty(o,"approximatelyEqual",{set:function(t){n.approximatelyEqual=t},get:function(){return n.approximatelyEqual}}),r=e("./src/calc.common.ts"),Object.defineProperty(o,"ExcelCompatibleCalcMode",{set:function(t){r.ExcelCompatibleCalcMode=t},get:function(){return r.ExcelCompatibleCalcMode}})},"./src/calc.ts":function(t,g,e){"use strict";var l,ut,ct,ht,ft,h,a,s,i,M,pt,dt,r,gt,mt,yt,bt,I,u,c,B,o,vt,f,p,Ct,wt,xt,d,m,n,V,y,b,v,C,w,x,T,A,S,N,R,k,E=this&&this.__extends||(w=function(t,e){return(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}w(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function D(){this.autoCalculation=!0,this.jh={},this.useR1C1=!1,this.allowDynamicArray=!1,this.iterativeCalculation=!0,this.iterativeCalculationMaximumIterations=1e3,this.iterativeCalculationMaximumChange=.01,this.mh=0,this.Bka=0,this.hmb=[];this.kh=new ht.Parser,this.lh=new ft.Evaluator(this),this.nh=this.uzb&&this.uzb(),this.addResolver(new ht.DefaultTokenResolver)}function j(t,e,o){var n=x.call(this,t)||this;return n.id=e,n.name=o,n.delay=0,n}function _(t,e){var o=T.call(this,t)||this;return o.name=e,o.delay=0,o}function O(t){this.Ze=[],this.ah=t}function F(t,e){var o,n,r,i,a,s;if(t)for(o in t)if(n=+o,r=t[o])for(i in r)a=+i,(s=r[i])&&e.setValue(n,a,s.value,s.oldValue,!0!==s.isAnchorCell)}function P(t,y,b){if(t){var v=b.anchors,C={};t.forEach(function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d=t.row,g=t.col,m=[d,g].join(",");for(y.Ag(d,g,1,1),C[m]=!0,e=t.rowCount,o=t.colCount,n=1,r=0;r<e;r++){for(;n<o;n++)if(i=b.getAnchorItem(r+d,n+g))for(s in a=i.anchorRefs)m!==s&&a[s]&&(u=v,0,c=s.split(",").map(function(t){return+t}),h=c[0],f=c[1],(l=(p=u[h])&&p[f])&&!C[s]&&(y.Ag(l.row,l.col,1,1),C[s]=!0));n=0}})}}function L(){}function H(t,e,o,n,r,i){var a,s;a=t.kOb,s=t.eOb,vt(a)&&vt(s)||!vt(a)&&!vt(s)&&Object.keys(a).join()===Object.keys(s).join()||(t.kOb&&(W(o,t,t.kOb,!1),delete t.kOb),t.eOb&&(t.delay=W(o,t,t.eOb,!0,i),t.kOb=t.eOb,delete t.eOb))}function z(t,e,o,n,r,i,a,s,l){var u,c,h,f=0;for(u=o;u<=r;u++)for(c=n;c<=i;c++)h=e.qg(u,c,!0),a&&h&&h.lWc(0,t,s),l&&h&&h.$l&&f++;return f}function W(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g=0;for(i in o)if(o.hasOwnProperty(i)){if(a=!1,s=o[i],!(l=t.jh[s.id]))continue;u=s.row,c=s.col,p=u+(h=s.rowCount)-1,d=c+(f=s.colCount)-1,l&&tt(u,c,h,f)&&(l.ug(!0).Jg(u,c,h,f,e,n,!0),a=!0),!l||a&&!r||(g+=z(e,l,u,c,p,d,!a,n,r))}return g}function G(t,e,o){var n=A.call(this,t)||this;return n.row=e,n.column=o,n.delay=0,n}function U(t,e){this.Ef=0,this.Ff=0,this.Gf=[],this.OMc=[],this.qhc=[],this.dataTable={},this.dataTableByName={},this.Hf=[],this.If=[],this.B5=0;this._source=e,this._service=t}function J(t){return S.call(this,t)||this}function Z(t,e){var o=N.call(this,t)||this;return o.name=e,o}function q(t,e){var o=R.call(this,t)||this;return o.column=e,o}function K(t,e){var o=k.call(this,t)||this;return o.row=e,o}function Y(t,e){var o,n,r;for(o in t)(n=t[o])&&(e?Y(n):(r=n.calc)&&r.ng())}function Tt(t){var e,o;for(e=0;e<t.length;e++)if((o=t[e].expr)&&7===o.type&&"LET"===o.functionName)return!0;return!1}function Q(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J,Z=t.row,q=t.column,K=[],Y=0,Q=t.arrayIdentity?t.arrayIdentity.row:Z,X=t.arrayIdentity?t.arrayIdentity.col:q;for(l=s=0,h=n,f=r,p=u=!(K[Y]={expr:e,acceptsArray:i||!1,acceptsRef:a||!1,index:-1});0<=Y;){if(d=K[Y],Y--,g=d.acceptsArray,m=d.acceptsRef,e=d.expr,y=pt,e)if(7===e.type){if(I=(M=e).arguments.length,!M.function){if(!t){y=ut.Hh(gt);continue}M.function=t.getFunction(M.functionName)}if(N=M.function,R=d.index,S=d.neeedExpendindexs,R<0?(d.arrayArgumentEvaluateMode=p,d.arrayFormulaCatchValue=o,N&&N.arrayArgumentEvaluateMode&&(p=N.arrayArgumentEvaluateMode),d.args=[]):(N&&N.acceptsArray(R)?s--:u&&(S||(S=[],d.neeedExpendindexs=S),M.arguments[R],S.push(R)),d.args.push(b)),R===I-1){if(p=d.arrayArgumentEvaluateMode,o=d.arrayFormulaCatchValue,E=!1,(k=d.args)&&0<k.length)for(D=0;D<k.length;D++)if(k[D]!==M.arguments[D]){E=!0;break}y=E?ut.Jh(M,k):e,S&&0<S.length&&(y=ut.createExpandExpression(y,S),u=!0)}else 0===R&&N&&3===N.arrayArgumentEvaluateMode&&3===p&&(p=0),u=!1,R++,d.index=R,N&&N.acceptsArray(R)&&s++,K[++Y]=d,K[++Y]={expr:M.arguments[R],acceptsArray:!!N&&N.acceptsArray(R),acceptsRef:!!N&&N.acceptsReference(R),index:-1}}else if(1===e.type&&e.sf())l&&(w=(C=e.source!==ut.BangSource&&e.source||t.source).getRowCount(),x=C.getColumnCount(),T=(T=e.rowRelative?(e.row+Q)%ut.MAX_ROW_COUNT%w:e.row)<0?T+w:T,A=(A=e.columnRelative?(e.column+X)%ut.MAX_COLUMN_COUNT%x:e.column)<0?A+x:A,e=ct.rf(e.source&&C,pt,T,A,!1,!1));else if(1===e.type||13===e.type){if(13===e.type){if(v=(j=e).getRange(Z,q),j.tzb(Z,q,t.source.id),!v){j._error?(delete j._error,y=b=mt,t.iOb=1):b=y=e;continue}e=ct.uf(j.source===t.source?pt:j.source,pt,v.row,v.col,v.row+v.rowCount-1,v.col+v.colCount-1)}_=e.source!==ut.BangSource&&e.source,O=e,l&&(C=_||t.source,w=ut.MAX_ROW_COUNT,x=ut.MAX_COLUMN_COUNT,F=O.rowRelative?(O.row+Q)%w:O.row,P=O.columnRelative?(O.column+X)%x:O.column,B=void 0,(L=(L=O.endRowRelative?(O.endRow+Q)%w:O.endRow)<0?L+w:L)<(F=F<0?F+w:F)&&(B=F,F=L,L=B),(H=(H=O.endColumnRelative?(O.endColumn+X)%x:O.endColumn)<0?H+x:H)<(P=P<0?P+x:P)&&(B=P,P=H,H=B),(w=C.getRowCount())<=F?(F%=w,L%=w):w<=L&&(L=w-1),(x=C.getColumnCount())<=P?(P%=x,H%=x):x<=H&&(H=x-1),e.row===ut.BAND_INDEX_CONST&&(F=L=ut.BAND_INDEX_CONST),e.column===ut.BAND_INDEX_CONST&&(P=H=ut.BAND_INDEX_CONST),e=ct.uf(_,e.endSource,F,P,L,H,!1,!1,!1,!1)),m&&(g||!o&&1!==p&&3!==p)||Z<0||q<0||4===p||(0<s&&!o&&1!==p&&3!==p||0===s||2===p?(v=O.getRange(Z,q),y=o||(m||g)&&1===p?!O.isFullColumn&&1!==v.rowCount&&h>=v.rowCount||!O.isFullRow&&1!==v.colCount&&f>=v.colCount?ut.Hh(bt):(T=(O.isFullColumn?0:v.row)+(1===v.rowCount?0:h),A=(O.isFullRow?0:v.col)+(1===v.colCount?0:f),ct.rf(_,e.endSource,T,A,!1,!1)):1<v.rowCount&&1<v.colCount||1<v.rowCount&&!O.isFullColumn&&(Z<v.row||Z>=v.row+v.rowCount)||1<v.colCount&&!O.isFullRow&&(q<v.col||q>=v.col+v.colCount)?ut.Hh(yt):(T=O.isFullColumn||1<v.rowCount?Z:v.row,A=O.isFullRow||1<v.colCount?q:v.col,ct.rf(_,e.endSource,T,A,!1,!1))):u=!0)}else if(9===e.type)V=15<=e.operatorType,o&&vt(e.value2)&&(V=g=!1),-1===d.index?(d.index=e.value2?0:1,K[++Y]=d,K[++Y]=At(e.value,V,V,-1)):0===d.index?(b!==e.value&&(y=ut.Kh(e.operatorType,b,e.value2),d.expr=y),u&&((S=[]).push(0),d.neeedExpendindexs=S,u=!1),d.index=1,K[++Y]=d,K[++Y]=At(e.value2,V,V,-1)):(y=e.value2&&b!==e.value2?ut.Kh(e.operatorType,e.value,b):vt(e.value2)&&b!==e.value?ut.Kh(e.operatorType,b,dt):e,S=d.neeedExpendindexs,u&&(S?S.push(1):S=[e.value2&&e.value2===c?1:0]),S&&(y=ut.createExpandExpression(y,S),u=!0));else if(10===e.type)-1===d.index?(d.index=0,K[++Y]=d,K[++Y]=At(e.value,g,m,-1)):e.value!==b&&(y=ut.Lh(b));else if(8===e.type)1===d.index?(l--,y=b,d.context&&(t=d.context)):(l++,K[++Y]=At(e,g,m,1,t),W=t,G=z=void 0,e.source?(G=e.source===ut.BangSource?t.source:e.source,(W=new ft.EvaluateContext(G)).cloneFrom(t),z=G.getCustomName(e.value)):(z=t.getName(e.value),t.source.getCustomName(e.value)||(W=new ft.GloableEvaluateContext(t.source)).cloneFrom(t)),z=z||ut.Hh(gt),t=W||t,K[++Y]=At(z,g,m,-1,t));else if(6===e.type)if(U=e,!g&&(0<s||o||1===p||3===p))u=!0,c=e;else if(!g&&0===s)if(h>=U.value.RowCount&&1<U.value.RowCount||f>=U.value.colCount&&1<U.value.colCount)y=ut.Hh(bt);else try{1===U.value.RowCount&&(h=0),1===U.value.colCount&&(f=0),y=typeof(J=U.value.getValue(h,f))===wt?ut.createStringExpression(J):typeof J===Ct?ut.createNumberExpression(J):typeof J===xt?ut.createBooleanExpression(J):J._error?ut.Hh(J):(new ht.Parser).parse(t.source.getParserContext(t.useR1C1,St(0,0)),""+J)}catch(t){y=ut.Hh(bt)}y===pt&&(y=e),b=y}return y}function X(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J,Z,q,K,Y,Q,X,$,tt,et,ot,nt=t.row,rt=t.column,it=[],at=0,st=t.arrayIdentity?t.arrayIdentity.row:nt,lt=t.arrayIdentity?t.arrayIdentity.col:rt;for(l=s=0,h=n,f=r,p=u=!(it[at]={expr:e,acceptsArray:i||!1,acceptsRef:a||!1,index:-1});0<=at;){if(d=it[at],at--,g=d.acceptsArray,m=d.acceptsRef,e=d.expr,y=pt,e)if(7===e.type){if(N=(I=(M=e).arguments).length,!M.function){if(!t){y=ut.Hh(gt);continue}if("ANCHORARRAY"===(R=M.functionName)){1===N&&(E=(k=I[0]).source,D=t.source,1===k.type&&k.sf()?y=ct.BLb(D,E,dt,k.row,k.column,k.rowRelative,k.columnRelative):5===k.type&&(y=ct.lOb(D,E))),y?t.iOb=2:y=ut.Hh(gt),M.ensureSingle&&(y.ensureSingle=!0),b=y;continue}M.function=t.getFunction(R)}if(j=M.function,_=d.index,S=d.neeedExpendindexs,_<0?(d.arrayArgumentEvaluateMode=p,d.arrayFormulaCatchValue=o,j&&j.arrayArgumentEvaluateMode&&(p=j.arrayArgumentEvaluateMode),d.args=[]):(j&&j.acceptsArray&&j.acceptsArray(_)?s--:u&&(S||(S=[],d.neeedExpendindexs=S),M.arguments[_],S.push(_)),d.args.push(b)),_===N-1){if(p=d.arrayArgumentEvaluateMode,o=d.arrayFormulaCatchValue,F=!1,(O=d.args)&&0<O.length)for(P=0;P<O.length;P++)if(O[P]!==M.arguments[P]){F=!0;break}y=F?ut.Jh(M,O):e,S&&0<S.length&&(y=ut.createExpandExpression(y,S),u=!0)}else 0===_&&j&&3===j.arrayArgumentEvaluateMode&&3===p&&(p=0),u=!1,_++,d.index=_,j&&j.acceptsArray&&j.acceptsArray(_)&&s++,it[++at]=d,it[++at]={expr:M.arguments[_],acceptsArray:!!j&&j.acceptsArray&&j.acceptsArray(_),acceptsRef:!!j&&j.acceptsReference&&j.acceptsReference(_),index:-1}}else if(1===e.type&&e.sf())l&&(w=(C=e.source!==ut.BangSource&&e.source||t.source).getRowCount(),x=C.getColumnCount(),T=(T=e.rowRelative?(e.row+st)%ut.MAX_ROW_COUNT%w:e.row)<0?T+w:T,A=(A=e.columnRelative?(e.column+lt)%ut.MAX_COLUMN_COUNT%x:e.column)<0?A+x:A,e=ct.rf(e.source&&C,pt,T,A,!1,!1));else if(1===e.type||13===e.type){if(13===e.type){if(v=(L=e).getRange(nt,rt),L.tzb(nt,rt,t.source.id),!v){L._error?(delete L._error,y=b=mt,t.iOb=1):b=y=e;continue}e=ct.uf(L.source===t.source?pt:L.source,pt,v.row,v.col,v.row+v.rowCount-1,v.col+v.colCount-1)}H=e.source!==ut.BangSource&&e.source,V=(B=e).ensureSingle,l&&(C=H||t.source,w=ut.MAX_ROW_COUNT,x=ut.MAX_COLUMN_COUNT,z=B.rowRelative?(B.row+st)%w:B.row,W=B.columnRelative?(B.column+lt)%x:B.column,J=void 0,(G=(G=B.endRowRelative?(B.endRow+st)%w:B.endRow)<0?G+w:G)<(z=z<0?z+w:z)&&(J=z,z=G,G=J),(U=(U=B.endColumnRelative?(B.endColumn+lt)%x:B.endColumn)<0?U+x:U)<(W=W<0?W+x:W)&&(J=W,W=U,U=J),(w=C.getRowCount())<=z?(z%=w,G%=w):w<=G&&(G=w-1),(x=C.getColumnCount())<=W?(W%=x,U%=x):x<=U&&(U=x-1),e.row===ut.BAND_INDEX_CONST&&(z=G=ut.BAND_INDEX_CONST),e.column===ut.BAND_INDEX_CONST&&(W=U=ut.BAND_INDEX_CONST),e=ct.uf(H,e.endSource,z,W,G,U,!1,!1,!1,!1),V&&(e.ensureSingle=!0)),a||m&&(g||!o&&1!==p&&3!==p)||nt<0||rt<0||(0<s&&!o&&1!==p&&3!==p||0===s||2===p?(v=B.getRange(nt,rt),y=o||(m||g)&&1===p?!B.isFullColumn&&1!==v.rowCount&&h>=v.rowCount||!B.isFullRow&&1!==v.colCount&&f>=v.colCount?ut.Hh(bt):(T=(B.isFullColumn?0:v.row)+(1===v.rowCount?0:h),A=(B.isFullRow?0:v.col)+(1===v.colCount?0:f),ct.rf(H,e.endSource,T,A,!1,!1)):1<v.rowCount&&1<v.colCount||1<v.rowCount&&!B.isFullColumn&&(nt<v.row||nt>=v.row+v.rowCount)||1<v.colCount&&!B.isFullRow&&(rt<v.col||rt>=v.col+v.colCount)?ut.Hh(yt):(T=B.isFullColumn||1<v.rowCount?nt:v.row,A=B.isFullRow||1<v.colCount?rt:v.col,ct.rf(H,e.endSource,T,A,!1,!1))):u=!0)}else if(9===e.type)Z=15<=e.operatorType,q=m&&t.source&&t.source._service&&t.source._service.allowDynamicArray,-1===d.index?(o&&vt(e.value2)&&(Z=g=!1),d.index=e.value2?0:1,it[++at]=d,it[++at]=At(e.value,Z||g,Z||q,-1)):0===d.index?(b!==e.value&&(y=ut.Kh(e.operatorType,b,e.value2),d.expr=y),u&&((S=[]).push(0),d.neeedExpendindexs=S,u=!1),d.index=1,it[++at]=d,it[++at]=At(e.value2,Z||g,Z||q,-1)):(y=e.value2&&b!==e.value2?ut.Kh(e.operatorType,e.value,b):vt(e.value2)&&b!==e.value?ut.Kh(e.operatorType,b,dt):e,S=d.neeedExpendindexs,u&&(S?S.push(1):S=[e.value2&&e.value2===c?1:0]),S&&(y=ut.createExpandExpression(y,S),u=!0));else if(10===e.type)-1===d.index?(d.index=0,it[++at]=d,it[++at]=At(e.value,g,m,-1)):e.value!==b&&(y=ut.Lh(b));else if(8===e.type)1===d.index?(l--,y=b,d.context&&(t=d.context)):(l++,it[++at]=At(e,g,m,1,t),Y=t,Q=K=void 0,Tt(it)?(K=new ut.Expression(100)).value=e.value:(e.source?(Q=e.source===ut.BangSource?t.source:e.source,(Y=new ft.EvaluateContext(Q)).cloneFrom(t),K=Q.getCustomName(e.value)):(K=t.getName(e.value),t.source.getCustomName(e.value)||(Y=new ft.GloableEvaluateContext(t.source)).cloneFrom(t)),K=K||ut.Hh(gt)),t=Y||t,it[++at]=At(K,g,m,-1,t));else if(6===e.type)if($=(X=e).value,!g&&(0<s||o||1===p||3===p))u=!0,c=e;else if(!g&&0===s)if(tt=$.getRowCount(),et=$.getColumnCount(),tt<=h&&1<tt||et<=f&&1<et)y=ut.Hh(bt);else if(o||!(t.source&&t.source._service&&t.source._service.allowDynamicArray))try{1===tt&&(h=0),1===et&&(f=0),y=typeof(ot=X.value.getValue(h,f))===wt?ut.createStringExpression(ot):typeof ot===Ct?ut.createNumberExpression(ot):typeof ot===xt?ut.createBooleanExpression(ot):ot._error?ut.Hh(ot):(new ht.Parser).parse(t.source.getParserContext(t.useR1C1,St(0,0)),""+ot)}catch(t){y=ut.Hh(bt)}y===pt&&(y=e),b=y}return y}function At(t,e,o,n,r){return{expr:t,acceptsArray:e,acceptsRef:o,index:n,context:r}}function St(t,e){return{row:t,col:e}}function $(t,e,o,n){return{row:t,col:e,rowCount:o,colCount:n}}function tt(t,e,o,n){return-1===t||-1===e||1<o*n}Object.defineProperty(g,"__esModule",{value:!0}),l=e("Common"),ut=e("./src/calc.common.ts"),ct=e("./src/referenceExpression.ts"),ht=e("./src/Parser.ts"),ft=e("./src/evaluator.ts"),h=l.Common.F,a=l.Common.A,s=l.Common.B,i=l.Common.u,M=l.Common.l,pt=null,dt=void 0,r=Math.abs,gt=ut.Errors.Name,mt=ut.Errors.Reference,yt=ut.Errors.Value,bt=ut.Errors.NotAvailable,I=ut.Errors.Calc,u=ut.Convert.Ca,c=ut.Convert._isReference,B=i.Nb,o=l.Common.j,vt=o.Fa,f=Math.min,p="rowSliceListeners",Ct="number",wt="string",xt="boolean",g.approximatelyEqual=function(t,e,o){if(void 0===t&&(t=0),void 0===e&&(e=0),t===e||h(t,ut.CalcError)&&h(e,ut.CalcError)&&t._code===e._code)return!0;var n=1;return h(t,Date)&&h(e,Date)?n=864e5:h(t,Date)?t=M.Ra(t):h(e,Date)&&(e=M.Ra(e)),r(e-t)/n<o},g.supportRowColumnFormula=!1,O.prototype.getKey=function(){return""},O.prototype.hasListeners=function(){var t,e,o,n;for(t=0,e=this.Ze;t<e.length;t++)if(o=this[e[t]])for(n in o)if(o[n])return!0;return!1},O.prototype.gmb=function(t,e,o){var n,r=this[t],i=e.getKey();e.LDc&&1<=e.LDc.length&&((n=e.LDc)[n.length-1].push(this),i="?"+i),r||(this.Ze.push(t),r=this[t]={}),o?r[i]=e:delete r[i]},O.prototype.lWc=function(t,e,o){var n=this[t],r=e.getKey();r="!"+r,n||(this.Ze.push(t),n=this[t]={}),o?n[r]=e:delete n[r]},O.prototype.Yg=function(){var t,e,o,n,r,i,a=[];for(t=0;t<arguments.length;t++)a[t]=arguments[t];for(e=this.Ze,n=0;n<e.length;n++)if(r=this[e[n]])for(i in r)(o=r[i])&&o.bh()},O.prototype.Bg=function(){var t,e,o,n,r,i,a=[];for(t=0;t<arguments.length;t++)a[t]=arguments[t];for(e=this.Ze,n=0;n<e.length;n++)if(r=this[e[n]])for(i in r)!(o=r[i])||o.dh||o.eh||o.fh()},O.prototype.gh=function(){var t,e,o,n,r,i,a,s,l,u,c,h,f=[];for(t=0;t<arguments.length;t++)f[t]=arguments[t];for(e=f[0],o=this.Ze,n=e?1:-1,r=0;r<o.length;r++)if(i=this[o[r]])for(a in i)if(s=i[a],"?"===a[0]){if(e||!this.MDc)continue;for(;0<=this.MDc.indexOf(s);)this.MDc.splice(this.MDc.indexOf(s),1),s.delay--}else s&&(s.delay+=n,e&&s.y$a&&s.y$a());if((l=this.node&&this.node.Pf)&&l.isDynamicArray)for(u=0;u<l.rowCount;u++)for(c=0;c<l.colCount;c++)0===u&&0===c||(h=this.ah.getNode(u+l.row,c+l.col))&&h.calc&&h.calc.gh(e)},O.prototype.bh=function(){},O.prototype.fh=function(){},O.prototype.ng=function(){},O.prototype.og=function(){},O.prototype.ZAb=function(){return this.ah.Cf()},d=O,g.BaseCalc=d,E(_,T=d),_.prototype.getKey=function(){var t=this.ah;return(null===t?"":t._source.id+",")+this.name},_.prototype.og=function(){this.ah.Og(this.name,!0)},_.prototype.ng=function(){this.ah.Og(this.name,!1)},_.prototype.bh=function(){this.ZAb().onAddAdjust(this,3)},_.prototype.fh=function(){this.ZAb().pg(this,3)},m=_,g.NameIDCalc=m,E(j,x=d),j.prototype.getKey=function(){return this.ah.getName()+","+this.id+"#"+this.name},j.prototype.og=function(){this.ah.Ig(this.id,this.name,!0)},j.prototype.ng=function(){this.ah.Ig(this.id,this.name,!1)},j.prototype.ZAb=function(){return this.ah._service},j.prototype.bh=function(){this.ZAb().onAddAdjust(this,6)},j.prototype.fh=function(){this.ZAb().pg(this,6)},g.PathCalc=j,D.prototype.getResolvers=function(){return this.hmb},D.prototype.addResolver=function(t){var e,o=this.hmb;for(e=0;;e++)if(!o[e]||t.priority>o[e].priority){o.splice(e,0,t);break}},D.prototype.dispose=function(){this.jh={},this.oh=pt},D.prototype.cloneFrom=function(t){this.useR1C1=t.useR1C1,this.mh=t.mh,this.qh=t.qh,this.calcOnDemand=t.calcOnDemand},D.prototype.ih=function(){return this.nh},D.prototype.getExternalSource=function(t,e){var o,n,r=this.getAllSourceModels();for(o=0,n=r.length;o<n;o++)if(i.Mb(r[o].getSource().getName(),e))return r[o].getSource();return pt},D.prototype.getSourceModel=function(t){var e=this.jh[t.id];return e||(e=t.createSourceModel?t.createSourceModel(this):this.createSourceModel(this,t),this.jh[t.id]=e,t.setCalcSourceModel(e),t.setCalcService(this)),e},D.prototype.getGlobalSourceModel=function(t){return this.oh||((t=t||new ut.CalcSource).createSourceModel?this.oh=t.createSourceModel(this):this.oh=this.createSourceModel(this,t),t.setCalcSourceModel(this.oh)),this.oh},D.prototype.setSourceModel=function(t,e){(this.jh[t.id]=e).setCalcService(this)},D.prototype.getAllSourceModels=function(){var t,e=[],o=this.jh;for(t in o)e.push(o[t]);return e},D.prototype.removeSource=function(t){var e,o,n,r;for(o in this.suspend(),this.jh[t.id]&&(""!==t.getName()&&this.onRemoveSource(t),delete this.jh[t.id]),this.clearDirties(),e=this.jh)e[o].addDirtyNodesForCalc(!0);n=this._parserContext&&this._parserContext.kj,r=t&&t.kj,n&&r&&r===n&&(this._parserContext=null),this.resume(!1)},D.prototype.clearSource=function(){this.jh={},this._parserContext=null,this.clearDirties()},D.prototype.ignoreDirty=function(){return this.qh},D.prototype.suspend=function(t){this.mh++,this.qh=!!t},D.prototype.resume=function(t){this.mh--,this.mh<0&&(this.mh=0),this.IsSuspended()||(this.rh=pt,this.qh=!1,this.recalculateAll(t))},D.prototype.suspendAdjust=function(){this.Bka++},D.prototype.resumeAdjust=function(){this.Bka--,this.Bka<0&&(this.Bka=0)},D.prototype.isAdjustSuspended=function(){return 0<this.Bka},D.prototype.clearDirties=function(){var t,e,o,n=this.imb;if(n)for(t in n)if(n.hasOwnProperty(t))for(e=n[t];e;)e=(o=e.eh)?(e.$l=!1,e.eh=o.dh=dt,o):pt;this.imb=this.jmb=pt},D.prototype.resumeWithoutCalc=function(){this.mh--,this.mh<0&&(this.mh=0),this.clearDirties(),this.qh=!1},D.prototype.IsSuspended=function(){return 0<this.mh},D.prototype.recalculateAll=function(t,e){var o,n,r;if(!this.IsSuspended()){for(r in this.CIb=Date.now(),e||this.lh.startCache(),n=this.jh)(o=n[r]).getSource().startCalculation(),o.addDirtyNodesForCalc(t,e);for(r in this.Gg(),n)(o=n[r]).getSource().endCalculation();e||this.lh.endCache(),delete this.CIb}},D.prototype.Gg=function(t){var e,o,n,r,i,a;if(void 0===t&&(t=!0),e=this.imb){if(t){for(o in r=e[1]||e[2],e)e.hasOwnProperty(o)&&(i=parseInt(o),r&&1!==i&&2!==i||(n=e[o])&&(n.ah.addListenersToDirty(this,i),n.processed=!0));for(o in e)e.hasOwnProperty(o)&&(n=e[o])&&(n.processed?delete n.processed:n.ah.addListenersToDirty(this,parseInt(o)))}for(o in e)e.hasOwnProperty(o)&&e[o].ah.initDelay(this,parseInt(o));for(o in e)e.hasOwnProperty(o)&&e[o].ah.adjustDelayOfListeners(this,parseInt(o),!0);do{for(o in a=!1,e)e.hasOwnProperty(o)&&e[o].ah.calculateDirtyNodes(this,parseInt(o))&&(a=!0)}while(a);for(o in e)e.hasOwnProperty(o)&&e[o].ah.calculateIterations(this,parseInt(o));this.imb=this.jmb=dt}},D.prototype.initParserContext=function(t){this._parserContext||(this._parserContext=t.getParserContext(this.useR1C1))},D.prototype.getParserContext=function(t){var e=this._parserContext;return e||(t?this._parserContext=e=t.getParserContext(this.useR1C1):e=new ht.ParserContext(pt,this.useR1C1)),e.setSource(t),e},D.prototype.parseWithContext=function(t,e){return this.kh.parse(t,e)},D.prototype.unparseWithContext=function(t,e){return this.kh.unparse(t,e)},D.prototype.pg=function(t,e){var o,n,r,i;isNaN(e)||(r=this.imb,i=this.jmb,r||(r=this.imb={},i=this.jmb={}),o=r[e],n=i[e],t.$l=!0,t&&!t.dh&&t!==o&&(o?n.eh=t:r[e]=t,t.dh=n,t.eh=pt,i[e]=t))},D.prototype.Bh=function(t,e){var o,n,r,i,a;isNaN(e)||(t.$l=!1,n=this.imb,r=this.jmb,n&&(o=this.imb[e]),t&&(t.dh||t===o)&&(i=t.dh,a=t.eh,i?i.eh=a:n&&(a?n[e]=a:delete n[e]),a?a.dh=i:r&&(i?r[e]=i:delete r[e]),t.dh=pt,t.eh=pt))},D.prototype.evaluateExpression=function(t,e,o){return this.lh.evaluateExpression(e,t.getEvaluatorContext(o,!1),!1)},D.prototype.onClearExpr=function(t,e){this.lh&&this.lh.asyncManager.clearCell(t,e)},D.prototype.parse=function(t,e,o,n,r,i,a){var s,l,u=this.rh,c=this.getParserContext(t);return c.useR1C1=!a&&this.useR1C1,c.ignoreError=i,c.row=o,c.column=n,c.culture=r,u?(s=u[e])?s:(l=this.kh.parse(c,e),u[e]=l):this.kh.parse(c,e)},D.prototype.unparse=function(t,e,o,n,r,i,a){var s,l=this.getParserContext(t);return l.useR1C1=this.useR1C1,l.row=o,l.column=n,l.culture=r,l.addSheetName=a,i&&(l.Eh=!0,l.useR1C1=!1),s=this.kh.unparse(l,e),l.Eh=!1,s},D.prototype.recalculate=function(t,e,o,n){var r=this.getSourceModel(t);-1===o?r.Ag(e,0,1,r.cC()):-1===e?r.Ag(0,o,r.rC(),1):r.Ag(e,o,1,1),this.IsSuspended()||this.recalculateAll(!1,n)},D.prototype.recalculateByName=function(t,e){var o,n;e&&(n=t,o=this.getSourceModel(n).mg(B(e),!0),this.pg(o,3),this.IsSuspended()||this.recalculateAll(!1))},D.prototype.recalcRange=function(t,e,o,n,r){var i=this.getSourceModel(t);-1===o?i.Ag(e,0,n,i.cC()):-1===e?i.Ag(0,o,i.rC(),r):i.Ag(e,o,n,r),this.IsSuspended()||this.recalculateAll(!1)},D.prototype.evaluate=function(t,e,o,n,r){var i=e instanceof ut.Expression?e:this.parse(t,e,o,n);return this.lh.evaluateExpression(i,t.getEvaluatorContext(St(o,n),!1),!1,r,r)},D.prototype._evaluateParsedFormula=function(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d,g,m,y,b,v=o.row||0,C=o.col||0,w=i?i.row:v,x=i?i.col:C,T=t.getEvaluatorContext(o,n,i,e);if(T.NMc=s,u=4===arguments.length&&n||a,this.allowDynamicArray&&!n&&(T.Exb=!0),(l=this.lh.evaluateExpression(e,T,r,u,u))&&l.pause)return l;if(t.ODc){for(c=0;c<t.ODc.length;c++)delete t.ODc[c].PDc;delete t.ODc}if(n&&arguments.length<=5)return l;if(!n&&a&&(ut.Convert._isReference(l)||ut.Convert.Ca(l)))return l;if(ut.Convert._isReference(l)){if(h=l.getRowCount(0),f=l.getColumnCount(0),1!==l.getRangeCount())return yt;try{if(p=n?v-w:v-l.getRow(0),d=n?C-x:C-l.getColumn(0),g=St(0,0),1!==h||1!==f)if(1===h&&1<f&&0<=d&&d<f)g.col=d;else if(1<h&&1===f&&0<=p&&p<h)g.row=p;else{if(!(n&&p<h&&d<f))return n?bt:yt;g.row=p,g.col=d}l=l.getValue(g,0)}catch(t){return yt}}else if(ut.Convert.Ca(l))if(n){if(y=(m=l).getRowCount(),b=m.getColumnCount(),1!==y&&y<=v-w||1!==b&&b<=C-x)return bt;l=l.getValue(1===y?0:v-w,1===b?0:C-x)}else l=l.getValueByIndex(0);return l!==dt&&l!==pt||!1===r?l:0},D.prototype.onAddAdjust=function(t,e){this.nh.hh(t,e)},D.prototype.onRemoveSource=function(t){this.nh.ph(t)},D.prototype.createSourceModel=function(t,e){return new n(t,e)},D.prototype.NHb=function(){var t,e,o=this.jh;for(t in o)(e=o[t])instanceof n&&e.getAllNodes().forEach(function(t){var e=t.calc;e&&(e.$l=!1,(e.eh||e.dh)&&(e.dh=e.eh=pt))})},g.CalcService=D,g.setSpillValues=F,g.markAnchorCellDirty=P,L.getLength=function(t,e){return u(t)?t.getRowCount()*t.getColumnCount():c(t)?(e=e||0,t.getRowCount(e)*t.getColumnCount(e)):void 0},L.getRowCount=function(t,e){return u(t)?t.getRowCount():c(t)?(e=e||0,t.getRowCount(e)):void 0},L.getColumnCount=function(t,e){return u(t)?t.getColumnCount():c(t)?(e=e||0,t.getColumnCount(e)):void 0},L.getValueByIndex=function(t,e,o){if(u(t))return t.getValueByIndex(e);if(c(t)){o=o||0;var n=t.getColumnCount(o);return t.getValue(o,parseInt(""+e/n,10),e%n)}},L.getValue=function(t,e,o,n){return u(t)?t.getValue(e,o):c(t)?(n=n||0,t.getValue(n,e,o)):void 0},g.CalcArrayHelper=L,U.prototype.getNode=function(t,e,o){var n,r=this,i=pt;return 0<=t&&0<=e?(n=r.dataTable[t],o&&!n&&(n=r.dataTable[t]={},t>r.Ef&&(r.Ef=t)),n&&(i=n[e],o&&!i&&(i=n[e]={},e>r.Ff&&(r.Ff=e)))):-1===t&&0<=e?(i=r.If[e],o&&!i&&(i=r.If[e]={},e>r.Ff&&(r.Ff=e))):0<=t&&-1===e?(i=r.Hf[t],o&&!i&&(i=r.Hf[t]={},e>r.Ff&&(r.Ff=e))):-1===t&&-1===e&&(i=r.Jf,o&&!i&&(i=r.Jf={})),i},U.prototype.getNodeByName=function(t,e){var o=this.dataTableByName[t];return e&&!o&&(o=this.dataTableByName[t]={}),o},U.prototype.Kf=function(t,e){var o=this.getNode(t,e);return o&&o.Lf},U.prototype.Mf=function(t,e){var o=this.getNode(t,e);return o&&o.Nf},U.prototype.Qf=function(t,e){return this.getWorkingNodeInfo(t,e,2)},U.prototype._getWorkingExpressionWithRowColumn=function(t,e){return this.getWorkingNodeInfo(t,e,1)},U.prototype._getExpressionWithRowColumn=function(t,e){return this.getWorkingNodeInfo(t,e,0)},U.prototype.CTa=function(t){var e=this.getNodeByName(t);return e&&e.Nf},U.prototype.DTa=function(t){var e=this.getNodeByName(t);return e&&e.Lf},U.prototype.clearAll=function(){this.clear(-1,-1,-1,-1),this.dataTable={},this.dataTableByName={},this.Hf=[],this.If=[],this.Jf=pt},U.prototype.clear=function(t,e,o,n,r){this.$b(t,e,o,n,r)},U.prototype.rzb=function(){Y(this.Hf),Y(this.If),Y(this.dataTable,!0),Y(this.dataTableByName),this.eHb()},U.prototype.eHb=function(){this.dataTable={},this.dataTableByName={},this.Hf=[],this.If=[],this.Jf=pt,this.Gf=[],this.OMc=[],this.vg=pt,this.xg=pt},U.prototype.addRows=function(t,e){var o,n=this.rC();if(!(t<0||n<t||e<0))for(a(this.dataTable,n,t,e),a(this.Hf,n,t,e),o=0;o<e;o++)this.dataTable[t+o]&&(this.dataTable[t+o]={rs:"n"})},U.prototype.deleteRows=function(t,e){var o=this.rC();t<0||o<=t||e<=0||(o<t+e&&(e=o-t),s(this.dataTable,o,t,e),s(this.Hf,o,t,e))},U.prototype.addColumns=function(t,e){var o,n,r=this.rC(),i=this.cC();if(!(t<0||i<t||e<0)){for(o=0;o<r;o++)(n=this.dataTable[o])&&t<i&&a(n,i,t,e);a(this.If,i,t,e)}},U.prototype.deleteColumns=function(t,e){var o,n,r=this.rC(),i=this.cC();if(!(t<0||i<=t||e<0)){for(o=0;o<r;o++)(n=this.dataTable[o])&&s(n,i,t,e);s(this.If,i,t,e)}},U.prototype.ETa=function(t,e){var o=[t,e],n=this.getNode(t,e);return n&&o.push(n.Lf,n.Nf,n.Pf),o},U.prototype.FTa=function(t,e,o){t&&t.push(this.ETa(e,o))},U.prototype.dUa=function(){var t=this.getSource(),e=t&&t.getSheet(),o=e&&e._modelManager;return o&&o.dUa()},U.prototype.$Va=function(t,e,o,n,r){-1===t?this.kg(e,o,n):-1===e?this.jg(t,o,n):this.ig(t,e,o,n,r)},U.prototype.Rf=function(t,e,o,n){var r=this.getNode(t,e,!!o);r&&(n&&n.push([t,e,r.Lf]),r.Lf=o)},U.prototype.GTa=function(t,e,o,n,r,i,a){var s=this.getNode(t,e,!!o);s&&(this.FTa(a,t,e),s.Lf=o,(s.Nf||n)&&(s.Nf=n),(s.Pf||r)&&(s.Pf=r),s.isVolatile&&!o?this.Tf(s):(i||s.isVolatile)&&(s.isVolatile=i))},U.prototype.Sf=function(t,e,o){this.GTa(t,e,dt,dt,dt,!1,o)},U.prototype.Uf=function(t,e,o,n,r,i){var a=this.getNode(e,o);a&&a.Lf&&t.GTa(n,r,a.Lf,a.Nf,a.Pf,a.isVolatile,i)},U.prototype.ega=function(t,e){var o=this.dataTable[t];return o&&o[e]},U.prototype.Wf=function(t,e,o){var n=this.getNode(t,e,!!o);n&&(n.Nf=o)},U.prototype.Xf=function(t,e,o){var n=this.getNode(t,e,!!o);n&&(n.Pf=o)},U.prototype.Yf=function(t,e){var o=this.getNode(t,e);return o&&o.calc},U.prototype.Zf=function(t,e,o){var n=this.getNode(t,e,!0);n&&(n.calc&&n.calc.isVolatile&&this.Tf(n),n.calc&&n.calc.isPivotData&&this.PMc(n),(n.calc=o)&&(o.node=n))},U.prototype.Q3=function(t,e,o){var n=this.getNode(t,e,!0);n&&n.calc&&(n.calc.isVolatile&&this.Tf(n),n.calc.isPivotData&&this.PMc(n),this._service.Bh(n.calc,o),n.calc=dt)},U.prototype.$f=function(t,e,o,n,r){0<=o&&0<=n?((this.dataTable[o]||(this.dataTable[o]={}))[n]=r)&&r.calc&&delete r.calc:0<=o&&-1===n&&0<=t&&-1===e?this.Hf[o]=r:0<=n&&-1===o&&0<=e&&-1===t&&(this.If[n]=r)},U.prototype._f=function(t,e,o,n){var r=this.getNode(t,e),i=this.getNode(o,n);r&&r.Lf?this.$f(t,e,o,n,r):i&&i.Lf&&this.$f(t,e,o,n,pt),i&&i.Lf?this.$f(o,n,t,e,i):r&&r.Lf&&this.$f(o,n,t,e,pt)},U.prototype.rhc=function(t,e,o){var n,r,i,a,s,l;t.isIterativeCalc||(t.isIterativeCalc=!0,this.qhc.push(t),e||(r=o,(l=(n=t).ah&&n.ah.getSource())&&(i=n.row,a=n.column,s=l.getValue(i,a),l.setValue(i,a,r,s))))},U.prototype.shc=function(t){delete t.isIterativeCalc},U.prototype.thc=function(){var t,e=[],o=this.qhc,n=this.qhc.length;for(t=0;t<n;t++)o[t].isIterativeCalc&&e.push(o[t]);return this.qhc=e,this.qhc},U.prototype.lmb=function(){return this.Gf},U.prototype.QMc=function(){return this.OMc},U.prototype.bg=function(t){t.isVolatile||(t.isVolatile=!0,this.Gf.push(t))},U.prototype.RMc=function(t){t.isPivotData||(t.isPivotData=!0,this.OMc.push(t))},U.prototype.Tf=function(t){var e,o,n,r;if(t.isVolatile=dt,this.B5++,100<this.B5){for(this.B5=0,e=[],o=this.Gf,n=this.Gf.length,r=0;r<n;r++)o[r].isVolatile&&e.push(o[r]);this.Gf=e}},U.prototype.PMc=function(t){var e,o,n,r;for(t.isPivotData=void 0,e=[],o=this.OMc,n=this.OMc.length,r=0;r<n;r++)o[r].isPivotData&&e.push(o[r]);this.OMc=e},U.prototype.getCalcService=function(){return this._service},U.prototype.setCalcService=function(t){this._service=t},U.prototype.Cf=function(){return this._service},U.prototype.getSource=function(){return this._source},U.prototype.hasFormula=function(t,e){return t=t!==dt?t:-1,e=e!==dt?e:-1,!!this._getExpressionWithRowColumn(t,e)},U.prototype.setFormula=function(t,e,o,n,r,i,a,s){var l,u,c,h,f;if(o&&0===o.length&&(o=pt),!r&&this.dg(t,e,1,1)&&this.eg(),l=this.getFormula(t,e),i||l!==o&&(""!==l||o)&&(l||""!==o)||l===o&&this.Qf(t,e)){if(u=this.Cf(),c=pt,u)try{h=0<=t?t:0,f=0<=e?e:0,c=n||(o?u.parse(this._source,o,h,f,!1,r):pt),this.fg(t,e,c,dt,!1,a,s)}catch(t){if(!r)throw t}0<=t&&0<=e&&this._source.setFormula(t,e,o)}},U.prototype.getFormula=function(t,e,o){var n,r,i=this.Cf();return i&&(n=this._getExpressionWithRowColumn(t,e))?(t=(r=this.Qf(t,e))&&!0!==r.isDynamicArray?r.row:t,e=r&&!0!==r.isDynamicArray?r.col:e,i.unparse(this._source,n,t,e,o)):pt},U.prototype.setFormulaByName=function(t,e,o,n,r){var i,a,s,l;if(t&&(t=B(t),i=this,e&&0===e.length&&(e=pt),(a=i.getFormulaByName(t))!==e&&(""!==a||e)&&(a||""!==e))){if(s=i.Cf(),l=pt,s)try{l=e?s.parse(i._source,e,0,0,!1,o):pt,i.gg(t,l,dt,!1,n,r)}catch(t){if(!o)throw t}i._source.setFormula({name:t},e)}},U.prototype.getFormulaByName=function(t){var e,o=this.Cf();return o&&t&&(e=this.DTa(B(t)))?o.unparse(this._source,e,0,0):pt},U.prototype.eg=function(){throw ut.sR().Exp_ArrayFromulaPart},U.prototype.rC=function(){return f(this._source.getRowCount())},U.prototype.cC=function(){return f(this._source.getColumnCount())},U.prototype.setArrayFormula=function(t,e,o,n,r,i,a,s){var l,u,c,h;if(r&&0===r.length&&(r=pt),this.dg(t,e,o,n)&&this.eg(),t=t<0?0:t,e=e<0?0:e,(u=this.Cf())&&(this.$b(t,e,o,n,a),r)){try{l=r?u.parse(this._source,r,t,e,!1,i,i):pt}catch(t){if(!i)throw t;return}for(c=t;c<t+o;c++)for(h=e;h<e+n;h++)this.fg(c,h,l,$(t,e,o,n),!1,a,s);0<=t&&0<=e&&this._source.setArrayFormula(t,e,o,n,u.unparse(this._source,l,t,e))}},U.prototype.getWorkingNodeInfo=function(t,e,o){var n,r=this._source;return t>=r.getRowCount()||e>=r.getColumnCount()?n:(0<=t&&0<=e?((!(n=this.getNode(t,e))||0===o&&!n.Lf||1===o&&!n.Nf||2===o&&!n.Pf)&&(n=this.getNode(t,-1)),(!n||0===o&&!n.Lf||1===o&&!n.Nf||2===o&&!n.Pf)&&(n=this.getNode(-1,e))):n=0<=t&&-1===e?this.getNode(t,-1):-1===t&&0<=e?this.getNode(-1,e):this.getNode(-1,-1),n&&(0===o&&n.Lf||1===o&&n.Nf||2===o&&n.Pf))},U.prototype.fg=function(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m,y,b,v=this.Cf();v.nia&&v.lh.asyncManager.endCalcCell(),l=(s=n!==dt&&null!==n)?n.row:t,u=s?n.col:e,c=this._source,h=new ft.EvaluateContext(c,St(l,u),s),f=v.allowDynamicArray?X(h,o,s,s?t-n.row:0,s?e-n.col:0,!0,!0):Q(h,o,s,s?t-n.row:0,s?e-n.col:0),(p=h.iOb)&&(delete h.iOb,2===p?o=f:1===p&&(d=v.unparse(c,o,l,u),o=v.parse(c,d,l,u))),f=f===o?dt:f,n!==dt&&(g=n),0<=t&&0<=e?(r!==dt&&!r||(m=0<=t?t:0,y=0<=e?e:0,b=o?v.unparse(c,o,m,y):dt,this._source.setFormula(t,e,b)),this.ig(t,e,o,f,g,i,a)):0<=t&&-1===e?this.jg(t,o,f,i,a):-1===t&&0<=e&&this.kg(e,o,f,i,a),v.autoCalculation&&!v.IsSuspended()&&v.recalculateAll(!1)},U.prototype.gg=function(t,e,o,n,r,i){var a,s=this.Cf(),l=X(new ft.EvaluateContext(this._source,St(0,0),!1),e,!1,0,0);l=l===e?dt:l,n!==dt&&!n||r||(a=e?s.unparse(this._source,e,0,0):dt,this._source.setFormulaByName&&this._source.setFormulaByName(t,a)),this.lg(t,e,l,null,i),s.autoCalculation&&!s.IsSuspended()&&(r||s.recalculateAll(!1))},U.prototype.getRowExpression=function(t){return this.Kf(t,-1)},U.prototype.getColumnExpression=function(t){return this.Kf(-1,t)},U.prototype.lg=function(t,e,o,n,r){var i,a=this.mg(t,!0);a&&(r||a.ng(),(i=this.getNodeByName(t,!0)).Lf=e,n&&(n[0].push("dataTable",t),n[1]=i.Lf),o=e&&o?o:dt,i.Nf=o,r||a.og(),a.fh())},U.prototype.ig=function(t,e,o,n,r,i,a){var s,l=this,u=l.qg(t,e,!0);u&&(l.FTa(i,t,e),(s=l._service).onClearExpr(l._source,St(t,e)),W(s,u,u.kOb,!1),delete u.kOb,delete u.eOb,u.ng(),l.Rf(t,e,o),o?((n||l.Mf(t,e))&&l.Wf(t,e,n),r&&!0===r.isDynamicArray||l.Xf(t,e,r)):(l.Wf(t,e,dt),l.Xf(t,e,dt)),u.og(),u.fh())},U.prototype.jg=function(t,e,o,n,r){var i=this.rg(t,!0);i&&(this.FTa(n,t,-1),r||i.ng(),this.Rf(t,-1,e),(o||this.Mf(t,-1))&&this.Wf(t,-1,o),r||i.og(),i.fh())},U.prototype.kg=function(t,e,o,n,r){var i=this.sg(t,!0);i&&(this.FTa(n,-1,t),r||i.ng(),this.Rf(-1,t,e),(o||this.Mf(-1,t))&&this.Wf(-1,t,o),r||i.og(),i.fh())},U.prototype.$b=function(t,e,o,n,r){function i(t,e){if(a=h.Mf(t,e),s=h.Kf(t,e),a||s){var o=(l=h.Qf(t,e))&&!0!==l.isDynamicArray?$(l.row,l.col,l.rowCount,l.colCount):dt;h.fg(t,e,pt,o,!0,r)}}var a,s,l,u,c,h=this,f=t<0?0:t,p=e<0?0:e,d=f+(t<0?h.rC():o)-1,g=p+(e<0?h.cC():n)-1;for(u=f;u<=d&&0<=u;u++)for(e<0&&i(u,-1),c=p;c<=g&&0<=c;c++)u===f&&t<0&&i(-1,c),i(u,c);t<0&&e<0&&i(t,e)},U.prototype.dg=function(t,e,o,n){return this.tg(t,e,o,n,!0,!0)},U.prototype.tg=function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d=t<0?0:t,g=e<0?0:e,m=t<0?this.rC():o,y=e<0?this.cC():n,b=d+(0===m?1:m)-1,v=g+(0===y?1:y)-1,C=!1,w=[],x=[],T=this.dataTable;for(l=d;l<=b&&0<=l&&!(l>this.Ef);l++)if(s=T[l])for(u=g;u<=v&&0<=u&&!(u>this.Ff);u++)if(a=s[u])if(h=void 0,(c=a.Pf)&&!c.isDynamicArray){if(c.row<d||c.row+c.rowCount-1>b||c.col<g||c.col+c.colCount-1>v){if(r)return f=c.row===t&&0===o,p=c.col===e&&0===n,!f&&!p;C=!0}if(l!==c.row&&l!==d)continue;w.push($(c.row,c.col,c.rowCount,c.colCount)),h=a.Lf,x.push(h),u=c.col+c.colCount-1}else i||(h=a.Lf)&&(w.push({row:l,col:u}),x.push(h));return!r&&{hasPart:C,ranges:w,formulas:x}},U.prototype.getCalcObj=function(){var t,e,o,n,r,i,a,s,l,u,c=[];for(t=0;t<arguments.length;t++)c[t]=arguments[t];if(e=c[0],o=c[1],n=e.row,r=e.column,i=null,isNaN(n)||isNaN(r))e.name&&(i=this.mg(e.name,o));else if(0<=n&&0<=r)if(e.sf())i=this.qg(n,r,o);else for(a=e.endRow,s=e.endColumn,i=[],l=n;l<=a;l++)for(u=r;u<=s;u++)i.push(this.qg(l,u,o));else 0<=n?i=this.rg(n,o):0<=r&&(i=this.sg(r,o));return i},U.prototype.mg=function(t,e){var o=pt,n=this.getNodeByName(t,e);return n&&!(o=n.calc)&&e&&(o=new m(this,t),(n.calc=o).node=n),o},U.prototype.qg=function(t,e,o){var n,r,i,a=this,s=pt;if(0<=t&&0<=e){if(!(r=(n=a.dataTable)[t])){if(!o)return s;r=n[t]={},t>a.Ef&&(a.Ef=t)}if(!(i=r[e]))return o&&(i=r[e]={},s=new V(a,t,e),(i.calc=s).node=i,e>a.Ff&&(a.Ff=e)),s;!(s=i.calc)&&o&&(s=new V(a,t,e),(i.calc=s).node=i,t>a.Ef&&(a.Ef=t),e>a.Ff&&(a.Ff=e))}return s},U.prototype.rg=function(t,e){var o=pt;return 0<=t&&!(o=this.Yf(t,-1))&&e&&(o=new y(this,t),this.Zf(t,-1,o),t>this.Ef&&(this.Ef=t)),o},U.prototype.sg=function(t,e){var o=pt;return 0<=t&&!(o=this.Yf(-1,t))&&e&&(o=new b(this,t),this.Zf(-1,t,o),t>this.Ff&&(this.Ff=t)),o},U.prototype.ug=function(t){return!this.vg&&t&&(this.vg=new C(this)),this.vg},U.prototype.wg=function(t,e){var o;return t=B(t),this.xg||(this.xg={}),!(o=this.xg[t])&&e&&(o=this.xg[t]=new v(this,t)),o},U.prototype.updateNameCalc=function(t,e){var o=this.wg(B(t));o&&(o.updateListening(!0,e),o.fh())},U.prototype.yg=function(t,e){var o,n,r=f(this.Ff,t+e-1);for(o=t;-1!==o&&o<=r;o++)this.isDirty(-1,o)&&(n=this.sg(o,!0),this._service.pg(n,2))},U.prototype.zg=function(t,e){var o,n,r=f(this.Ef,t+e-1);for(o=t;-1!==o&&o<=r;o++)this.isDirty(o,-1)&&(n=this.rg(o,!0),this._service.pg(n,1))},U.prototype.Ag=function(t,e,o,n){var r,i,a,s=this,l=null,u=f(s.Ef,t+o-1),c=f(s.Ff,e+n-1);for(r=t;r<=u;r++)for(i=e;i<=c;i++)s.ega(r,i)&&(s._service.calcOnDemand?(l=s.qg(r,i,!1))&&(l.Bg(),l.$l=!0):(l=s.qg(r,i,!0),s._service.pg(l,0)));s.zg(t,o),s.yg(e,n),(a=s.ug(!1))&&a.Bg(t,e,o,n)},U.prototype.uhc=function(){var t,e,o,n,r,i=this,a=i.lmb().concat(i.thc()).concat(i.QMc());for(o=0;o<a.length;o++)n=a[o],i._service.calcOnDemand&&n&&(n.isVolatile||n.isIterativeCalc)&&(n.$l=!0,n.Bg()),n&&(n.isVolatile||n.isIterativeCalc||n.isPivotData)&&n instanceof V&&!i.Dg(n)&&(r=i.qg(n.row,n.column,!0),i._service.pg(r,0),(t=i.rg(n.row,!1))&&!i.Eg(t)&&i.zg(n.row,1),(e=i.sg(n.column,!1))&&!i.Eg(e)&&i.yg(n.column,1))},U.prototype.Dg=function(t){var e=this.getCalcService().imb;return!!t.dh||t===(e&&e[0])},U.prototype.Eg=function(t){var e=this.getCalcService().imb;return t.dh||t===(e&&e[1])},U.prototype.isDirtyColumn=function(t){var e=this.getCalcService().imb;return t.dh||t===(e&&e[2])},U.prototype.isDirty=function(t,e){return!(!this.Yf(t,e)&&!this.Kf(t,e))},U.prototype.recalculateForContext=function(t,e,o){var n=this._service,r=n.getSourceModel(t),i=e.row,a=e.col;-1===a?r.Ag(i,0,1,r.cC()):-1===i?r.Ag(0,a,r.rC(),1):r.Ag(i,a,1,1),n.IsSuspended()||n.recalculateAll(!1,o)},U.prototype.recalculateCell=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C=this,w=C._source,x=C._getWorkingExpressionWithRowColumn(t,e)||C._getExpressionWithRowColumn(t,e),T=w,A=T.q$a,S=T&&T.kj&&T.kj._modelManager;if(S&&(S.SIb=!0),r=!1,x){if(i=St(t,e),a=w.getValue(t,e),s=!1,h=c=u=l=void 0,(f=C.Qf(t,e))&&!0!==f.isDynamicArray&&(s=!0,l=f.row,u=f.col,c=f.rowCount,h=f.colCount),(p=C._service).nia&&p.lh.asyncManager.startCalcCell(C._source,i),d=p._evaluateParsedFormula(C._source,x,i,s,!0,f&&!0!==f.isDynamicArray&&$(l,u,c,h),p.allowDynamicArray,o),o&&d&&d.pause)return d;if(H(g=C._source.getCalcSourceModel().qg(t,e),0,p,0,0,o),o&&0<g.delay)return{pause:"newDetectedRefs"};if((ut.Convert._isReference(d)||ut.Convert.Ca(d)||x.hJc)&&!s&&(f={row:t,col:e,rowCount:c=d.getRowCount?d.getRowCount():1,colCount:h=d.getColumnCount?d.getColumnCount():1,isDynamicArray:!0},C.Xf(t,e,f)),r=!0,y=void 0,(m=ut.Convert._isReference(d)||ut.Convert.Ca(d))&&((y=ut.Convert.Ph(d,0,!1,!1,!1)).isError||y.isConvertError?(d=yt,m=!1):(c=y.rowCount,h=y.colCount,0===c||0===h?(d=I,m=!1):1!==c||1!==h||x instanceof ct.SpillReferenceExpression||(d=y[0][0],vt(d)&&(d=0),m=!1),x.ensureSingle&&m&&(b=C.getNode(t,e),delete x.ensureSingle,x=b.Lf=ut.Jh(ut.Functions.findGlobalFunction("@"),[x]),b.Nf=dt,d=x.function.evaluate({row:t,column:e},d),m=!1))),m)(v=T.setArray(t,e,c,h,y))&&F(v[1],T);else if((v=T.updateItem&&T.updateItem(t,e,d))&&(F(v[0],T),n=v[1]),a!==d||"string"==typeof d&&d.hyperlink){if(a instanceof Date){if(d instanceof Date&&a.valueOf()===d.valueOf())return!1;if(typeof d===Ct){if(M.Ra(a)===d)return!1;d=M.Xb(d)}}w.setValue(t,e,d,a)}else r=!1;p.nia&&p.lh.asyncManager.endCalcCell(),T.Ppb&&T.Ppb(t,e)}else A||(v=T.updateItem&&T.updateItem(t,e,pt))&&(F(v[0],T),n=v[1]);return S&&(n&&P(n,C,S.ZHb),S.SIb=!1),r},U.prototype.recalculateNameID=function(t){var e,o,n=this._source,r=this.CTa(t)||this.DTa(t);if(r){if((e=n.getValueByName?n.getValueByName(t):n.getValue({name:t}))===(o=this._service._evaluateParsedFormula(this._source,r,{name:t},!1,!0)))return;if(e instanceof Date&&o instanceof Date&&e.valueOf()===o.valueOf())return;n.setValueByName?n.setValueByName(t,o):n.setValue({name:t},o)}},U.prototype.addDirtyNodesForCalc=function(t,e){var o,n;!1!==t?(o=this.cC(),n=this.rC(),this.yg(0,o),this.zg(0,n),this.Ag(0,0,n,o)):e||this.uhc()},U.prototype.addListenersToDirtyForRow=function(t){for(var e,o,n,r;t.imb[1];){for(n=(o=(e=t.imb[1]).ah).cC(),r=0;r<n;r++)t.pg(o.qg(e.row,r,!0),0);t.Bh(e,1)}},U.prototype.addListenersToDirtyForCol=function(t){for(var e,o,n,r;t.imb[2];){if(0<(n=(o=(e=t.imb[2]).ah).rC()))for(r=0;r<n;r++)t.pg(o.qg(r,e.column,!0),0);else e.Bg();t.Bh(e,2)}},U.prototype.Ah=function(t,e){for(var o=t.length,n=e;n;)t[o]=n,o++,n=n.eh},U.prototype.addListenersToDirty=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d,g;if(1===e)this.addListenersToDirtyForRow(t);else if(2===e)this.addListenersToDirtyForCol(t);else if(0===e)for(o=[],t.imb[2]&&this.Ah(o,t.imb[2]),n=t.imb[0];n;n=n.eh)for(r=n.ah,i=n.row,a=n.column,s=r.rg(i,!1),l=r.sg(a,!1),u=r.ug(!1),n.Bg(),s&&s.Bg(),l&&l.Bg(),u&&u.Bg(i,a,1,1),this.addListenersToDirtyForRow(t);t.imb[2];){for(c=t.imb[2],h=!1,f=0;f<o.length;f++)if(o[f]===c){h=!0;break}if(h)t.Bh(c,2);else{for(p=(r=(o[o.length]=c).ah).rC(),d=0;d<p;d++)t.pg(r.qg(d,c.column,!0),0);t.Bh(c,2)}}else if(3===e)for(g=t.imb[3];g;g=g.eh)g.Bg()},U.prototype.initDelay=function(t,e){var o,n,r,i,a,s,l;if(0===e)for(o=null,n=t.imb[0];n;n=o)n.kOb&&(W(t,n,n.kOb,!1),delete n.kOb),o=n.eh,i=(r=n.ah).rC(),a=r.cC(),n.row<i&&n.column<a?(g.supportRowColumnFormula&&(s=r.sg(n.column,!1))&&(s.delay=0),n.delay=0,delete n.MDc):t.Bh(n,0);else if(3===e)for(l=t.imb[3];l;l=l.eh)l.delay=0},U.prototype.adjustDelayOfListeners=function(t,e,o){var n,r,i,a,s,l,u,c;if(0===e)for(n=t.imb[e];n;n=n.eh)r=n.ah,i=n.row,a=n.column,s=r.rg(i,!1),l=r.sg(a,!1),u=r.ug(!1),n.gh(o),s&&s.gh(o),l&&l.gh(o),u&&u.gh(i,a,o);else if(3===e)for(c=t.imb[3];c;c=c.eh)c.gh(o)},U.prototype.calculateDirtyNodes=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d,g;if(t.calcOnDemand)return!1;if(o=!1,n=null,0===e){for(i=t.imb[e];i;i=r)if(r=i.eh,i.delay<=0){if(this.shc(i),n=i.ah,a=i.row,s=i.column,l=n.rg(a,!1),(u=n.sg(s,!1))&&u.delay)continue;if(c=n.ug(!1),(h=n.recalculateCell(a,s,!i.SMc||i.SMc<9))&&h.pause){if(i.SMc=i.SMc?i.SMc+1:1,h.branch)for(r=i,f=0;f<h.branch.length;f++)(h.branch[f].dh||h.branch[f].eh||h.branch[f]===i)&&(i.delay++,(p=h.branch[f]).MDc=p.MDc||[],p.MDc.push(i))}else delete i.SMc,t.Bh(i,0),i.gh(!1),l&&l.gh(!1),u&&u.gh(!1),c&&c.gh(a,s,!1),(d=i.node&&i.node.Lf)&&d.ehc&&delete d.ehc;o=!0}}else if(3===e)for(g=t.imb[e];g;g=r)r=g.eh,0===g.delay&&((n=g.ah).recalculateNameID(g.name),t.Bh(g,3),g.gh(!1),o=!0);return o},U.prototype.calculateIterations=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d;if(!t.calcOnDemand&&0===e&&(o=t.imb[e])){if(r=!(n=null),t.iterativeCalculation){for(a in t.jh)t.jh.hasOwnProperty(a)&&(s=t.jh[a].getSource()).clearValueCache&&s.clearValueCache();for(l=0;r&&l<t.iterativeCalculationMaximumIterations;l++)for(r=!1,n=o;n;n=n.eh)i=n.node&&n.node.Lf&&n.node.Lf.ehc,this.rhc(n,!i,pt),i&&(n.node.Lf.ehc=dt),u=n.ah,c=n.row,h=n.column,f=u.getSource().getValue(c,h),u.recalculateCell(c,h),r||(p=u.getSource().getValue(c,h),g.approximatelyEqual(f,p,t.iterativeCalculationMaximumChange)||(r=!0))}else for(n=o;n;n=n.eh)i=n.node&&n.node.Lf&&n.node.Lf.ehc,this.rhc(n,!i,0),i&&(n.node.Lf.ehc=dt);for(d=null,n=o;n;n=d)d=n.eh,n.eh=dt,d&&(d.dh=dt)}},U.prototype.Ig=function(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H=this;for(i&&H.shc(t);12===n.type;)n=n.value;for(;10===n.type;)n=n.value;for(;12===n.type;)n=n.value;if(r){for(;12===r.type;)r=r.value;for(;10===r.type;)r=r.value;for(;12===r.type;)r=r.value}if(13===n.type){if((f=n.getRange(e,o,!0))===pt)return;n=1===f.rowCount&&1===f.colCount?ct.rf(pt,pt,f.row,f.col,!1,!1):ct.uf(pt,pt,f.row,f.col,f.row+f.rowCount-1,f.col+f.colCount-1,!1,!1,!1,!1)}if(r&&r!==n&&8===r.type){if(r.source instanceof ut.ErrorSource)return;l=r.value,(u=(A=n.source||r.source||a||H._source).getCustomName(l))?S=A.getCalcSourceModel():(u=(S=H._service.getGlobalSourceModel()||A.getCalcSourceModel()).getSource().getCustomName(l))||A.getCalcSourceModel().wg(l,!0).gmb(0,t,i),(c=S.wg(l,!0)).gmb(0,t,i),r=null,u&&H.Ig(t,e,o,u,pt,i,S.getSource())}if(1===n.type&&n.endSource)for(I=(M=n).source.getSources(M.endSource),s=0;s<I.length;s++)(N=ct.uf(I[s],pt,M.row,M.column,M.endRow,M.endColumn,M.rowRelative,M.columnRelative,M.endRowRelative,M.endColumnRelative,e,o)).isFullRow=M.isFullRow,N.isFullColumn=M.isFullColumn,H.Ig(t,e,o,N,pt,i);else if(1===n.type){if(!(S=(A=n.source!==ut.BangSource&&n.source||H._source).getCalcSourceModel()))return;if(R=n,k=t.row===dt||t.column===dt,E=R.tf(),p=(D=ct.getRangeForReference(R,e,o)).row,g=D.col,d=p+(y=D.rowCount)-1,m=g+(b=D.colCount)-1,0===E){if(0<=e&&0<=o)if(1<y*b)h=S.ug(!0),k?h.Xoa(p,g,y,b,t,i):h.Jg(p,g,y,b,t,i);else for(x=p;x<=d;x++)for(T=g;T<=m;T++)v=S.qg(x,T,!0),k?v&&v.gmb(3,t,i):v&&v.gmb(0,t,i);else if(0<=e&&-1===o)for(x=p;x<=d;x++)for(T=g;T<=m;T++)R.columnRelative||R.endColumnRelative?(C=S.rg(x,!0))&&C.Kg(t.row,-T,i):(v=S.qg(x,T,!0))&&v.gmb(1,t,i);else if(0<=o&&-1===e)for(x=p;x<=d;x++)for(T=g;T<=m;T++)R.rowRelative||R.endRowRelative?(w=S.sg(T,!0))&&w.Mg(t,-x,i):(v=S.qg(x,T,!0))&&v.gmb(2,t,i)}else if(1===E){if(0<=e&&0<=o)h=S.ug(!0),k?h.Xoa(p,g,y,b,t,i):h.Jg(p,g,y,b,t,i);else if(!(0<=e&&-1===o)&&-1===e&&0<=o&&!R.rowRelative&&!R.endRowRelative)for(p=R.row,d=R.endRow,x=p;x<=d;x++)(C=S.rg(x,!0))&&C.gmb(2,t,i)}else if(2===E)if(0<=e&&0<=o)h=S.ug(!0),k?h.Xoa(p,g,y,b,t,i):h.Jg(p,g,y,b,t,i);else if(!(0<=e&&-1===o)&&-1===e&&0<=o)for(T=g;T<=m;T++)(w=S.sg(T,!0))&&w.gmb(2,t,i)}else if(9===n.type)H.Ig(t,e,o,n.value,r&&9===r.type&&r.value,i),n.value2&&H.Ig(t,e,o,n.value2,r&&9===r.type&&r.value2,i);else if(8===n.type){if(A=n.source||a||H._source,l=B(n.value),(u=A.getCustomName(l))?S=A.getCalcSourceModel():(u=(S=H._service.getGlobalSourceModel()||A.getCalcSourceModel()).getSource().getCustomName(l))||A.getCalcSourceModel().wg(l,!0).gmb(0,t,i),!(c=S.wg(l,!0)))return;c.gmb(0,t,i),u&&H.Ig(t,e,o,u,pt,i,S.getSource())}else if(7===n.type)for((j=n.function)&&(j.isVolatile()&&(i?H.bg(t):H.Tf(t)),"GETPIVOTDATA"===j.name&&(i?H.RMc(t):H.PMc(t)),j instanceof ut.Functions.AsyncFunction&&(H._service.nia=!0)),_=n.arguments.length,s=0;s<_;s++)j&&j.skipPrecedent(s)||(O=!1,j&&j.isBranch()&&j.findTestArgument()!==s&&t instanceof V&&(n.QDc=!0,n.RDc=n.RDc||[],n.RDc[s]=[],O=!0,t.LDc=t.LDc||[],t.LDc.push(n.RDc[s])),H.Ig(t,e,o,n.arguments[s],r&&7===r.type&&r.arguments[s],i),O&&t.LDc.pop());else if(25===n.type||26===n.type){if(!(P=(S=(A=(F=n).source||H._source).getCalcSourceModel()).mg(F.value,!0)))return;P.gmb(0,t,i)}else 33===n.type&&((L=n).isReferenceError||(S=(A=L.source||L.contextSource||H._source).getCalcSourceModel(),D=ct.getRangeForReference(L,e,o),(v=S.qg(D.row,D.col,!0))&&v.gmb(0,t,i)))},U.prototype.Og=function(t,e){var o=this.getNodeByName(t);o&&(o.Nf||o.Lf)&&this.Ig(this.mg(t),0,0,o.Nf||o.Lf,o.Lf,e)},U.prototype.Pg=function(t,e,o,n,r){var i,a,s,l,u,c,h=t+o,f=e+n;for(l=t;l<h;l++)for(u=e;u<f;u++)i=this.Mf(l,u),a=this.Kf(l,u),(i||a)&&(s=this.Qf(l,u),c=this.qg(l,u),s&&!0!==s.isDynamicArray?this.Ig(c,s.row,s.col,i||a,a,r):this.Ig(c,l,u,i||a,a,r),r||c.kOb&&W(c.ZAb(),c,c.kOb,!1,!1))},U.prototype.Qg=function(t,e,o){var n,r,i=t+e;for(n=t;-1!==n&&n<i;n++)(r=this.getColumnExpression(n))&&this.Ig(this.sg(n,!1),-1,n,r,r,o)},U.prototype.Rg=function(t,e,o,n){this.Pg(t,e,o,n,!0)},U.prototype.Sg=function(t,e,o,n){this.Pg(t,e,o,n,!1)},U.prototype.Tg=function(t,e){},U.prototype.Ug=function(t,e){},U.prototype.Vg=function(t,e){this.Qg(t,e,!0)},U.prototype.Wg=function(t,e){this.Qg(t,e,!1)},U.prototype.Xg=function(t,e,o,n,r,i,a){var s,l,u,c=t+o,h=e+n;for(s=t;s<c;s++)for(l=e;l<h;l++)(u=this.qg(s,l,!1))&&(this.FTa(a,s,l),r&&u.Yg(),i&&u.Bg())},U.prototype.Zg=function(t,e,o,n,r){var i,a,s,l,u=this.Hf;if(-1!==t&&u)for(i=f(t+e,u.length),a=t;a<i;a++)(s=u[a])&&s.calc&&(this.FTa(r,a,-1),l=s.calc,o&&l.Yg(),n&&l.Bg())},U.prototype.$g=function(t,e,o,n,r){var i,a,s,l,u=this.If;if(-1!==t&&u)for(i=f(t+e,u.length),a=t;a<i;a++)(s=u[a])&&s.calc&&(this.FTa(r,-1,a),l=s.calc,o&&l.Yg(),n&&l.Bg())},U.prototype._g=function(t,e,o,n,r,i,a){var s,l,u,c;(r||i)&&(s=this,l=void 0,a&&(l=s.dUa()),0<=t&&0<=e?(s.Xg(t,e,o,n,r,i,l),s.Zg(t,o,r,i,l),s.$g(e,n,r,i,l),s.vg&&(r&&s.vg.Yg(t,e,o,n),i&&s.vg.Bg(t,e,o,n))):0<=t&&-1===e?(s.Xg(t,0,o,s.cC(),r,i,l),s.Zg(t,o,r,i,l),s.vg&&(r&&s.vg.Yg(t,e,o,n),i&&s.vg.Bg(t,e,o,n))):-1===t&&0<=e?(s.Xg(0,e,s.rC(),n,r,i,l),s.$g(e,n,r,i,l),s.vg&&(r&&s.vg.Yg(t,e,o,n),i&&s.vg.Bg(t,e,o,n))):-1===t&&-1===e&&(u=s.rC(),c=s.cC(),s.Xg(0,0,u,c,r,i,l),s.Zg(0,u,r,i,l),s.$g(0,c,r,i,l),s.vg&&(r&&s.vg.Yg(t,e,o,n),i&&s.vg.Bg(t,e,o,n))))},U.prototype.getAllNodes=function(){var t,e,o,n,r=[],i=this.dataTable,a=this.Hf,s=this.If,l=this.Jf;for(e in l&&r.push(l),a)a.hasOwnProperty(e)&&(t=a[e])&&r.push(t);for(e in s)s.hasOwnProperty(e)&&(t=s[e])&&r.push(t);for(o in i)if(i.hasOwnProperty(o)&&(n=i[o]))for(e in n)n.hasOwnProperty(e)&&(t=n[e])&&r.push(t);return r},U.prototype.toJSON=function(t){g.supportRowColumnFormula?this._source.toJSON(t,this.dataTable,this.Ef,this.Ff,this.If):this._source.toJSON(t,this.dataTable,this.Ef,this.Ff)},n=U,g.CalcSourceModel=n,E(G,A=d),G.prototype.getKey=function(){var t=this.ah;return(null===t?"":t._source.id+",")+this.row+","+this.column},G.prototype.og=function(){this.ah.Rg(this.row,this.column,1,1)},G.prototype.ng=function(){this.ah.Sg(this.row,this.column,1,1)},G.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,0)},G.prototype.fh=function(){this.ah.Cf().pg(this,0)},G.prototype.Bg=function(){var t,e,o,n,r,i,a,s,l=this.ah.Cf(),u=this.Ze;for(e=0;e<u.length;e++)if(o=this[u[e]])for(n in o)o.hasOwnProperty(n)&&(!(t=o[n])||t.dh||t.eh||t.fh(),l.calcOnDemand&&t&&!t.$l&&(t.$l=!0,t.Bg()));if((r=this.node&&this.node.Pf)&&r.isDynamicArray)for(i=0;i<r.rowCount;i++)for(a=0;a<r.colCount;a++)0===i&&0===a||(s=this.ah.getNode(i+r.row,a+r.col))&&s.calc&&s.calc.Bg()},G.prototype.y$a=function(){var t,e,o,n,r,i,a,s=this.ah,l=s.getCalcService();l&&l.nia&&((e=(t=this.nia)&&this.z$a)||!vt(t)||(o=s.getSource())&&(n=o.getName(),(r=l.lh.asyncManager.y5[n])&&(!(i=r[this.row])||(a=i[this.column])&&((e=a[0])?(this.nia=!0,(this.z$a=e).h_a=this):this.nia=!1))),e&&0===e.evaluateMode&&(e.v5=!1))},V=G,g.CellCalc=V,E(K,k=d),K.prototype.getKey=function(){var t=this.ah;return(null===t?"":t._source.id+",")+this.row+",-1"},K.prototype.og=function(){this.ah.Tg(this.row,1)},K.prototype.ng=function(){this.ah.Ug(this.row,1)},K.prototype.Kg=function(t,e,o){var n,r,i;o?(i={row:t,columnOffset:e,columnCount:1},(n=this)[r=p]||(n[r]=[]),n[r].push(i)):function(t,e,o){var n,r=t[e];if(r)for(n=0;n<r.length;n++)if(r[n]===o)return r.splice(n,1)}(this,p,{row:t,columnOffset:e,columnCount:1})},K.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,1)},K.prototype.fh=function(){this.ah.Cf().pg(this,1)},y=K,g.RowCalc=y,E(q,R=d),q.prototype.getKey=function(){var t=this.ah;return(null===t?"":t._source.id+",")+"-1,"+this.column},q.prototype.og=function(){this.ah.Vg(this.column,1)},q.prototype.ng=function(){this.ah.Wg(this.column,1)},q.prototype.Mg=function(t,e,o){this.gmb(2,t,o)},q.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,2)},q.prototype.fh=function(){this.ah.Cf().pg(this,2)},b=q,g.ColumnCalc=b,E(Z,N=d),Z.prototype.getKey=function(){var t=this.ah;return(null===t?"":t._source.id+",")+this.name},Z.prototype.updateListening=function(t,e){var o,n,r,i,a,s,l,u,c=this.Ze;for(r=0;r<c.length;r++)if(i=this[c[r]]){for(s in a=[],i)i.hasOwnProperty(s)&&(o=i[s])&&a.push(o);for(l=a.length,u=0;u<l;u++)n=(o=a[u]).node,o.ng(),n&&(!n.Pf||n.Pf.row===o.row&&n.Pf.col===o.column)&&o.ah.fg(o.row,o.column,n.Lf,n.Pf,!0)}},Z.prototype.updateListeningOnRemoved=function(){var t,e,o,n,r,i,a,s,l,u,c=this.Ze,h=this.ah,f=h.Cf();for(i=0;i<c.length;i++)if(a=this[c[i]])for(s in a)a.hasOwnProperty(s)&&(t=a[s])&&(e=t.ah,o=t.row,n=t.col,o=o===dt?-1:o,n=n===dt?-1:n,r=e.Kf(o,n),l=e.Qf(o,n),r&&(u=f.ih().adjustFormulaOnRemoveName(h,r,this.name))!==r&&e.fg(o,n,u,l,!0))},Z.prototype.fh=function(){var t,e,o,n,r=this.Ze;for(e=0;e<r.length;e++)if(o=this[r[e]])for(n in o)o.hasOwnProperty(n)&&(t=o[n])&&t.fh()},v=Z,g.NameCalc=v,E(J,S=d),J.prototype.processListener=function(t,e,o,n,r,i,a,s){var l,u,c,h=this[t],f=e+","+o+","+n+","+r;if(3!==t||i instanceof m){if(i.LDc&&1<=i.LDc.length&&((u=i.LDc)[u.length-1].push(this),f="?"+f),s&&(f="!"+f),h||(this.Ze.push(t),this[t]=h={}),!(l=h[f])){if(!a)return;(l=h[f]={}).content={},l.length=0,l.row=e,l.col=o,l.rowCount=n,l.colCount=r}if(c=i.getKey(),a){if(l.content[c])return;l.content[c]=i,l.length++}else l.content[c]&&(delete l.content[c],l.length--,l.length<1&&(delete l.content,delete h[f]));this.clearListenersCache()}},J.prototype.Jg=function(t,e,o,n,r,i,a){this.processListener(0,t,e,o,n,r,i,a)},J.prototype.Xoa=function(t,e,o,n,r,i){this.processListener(3,t,e,o,n,r,i)},J.prototype.Yg=function(t,e,o,n){this.visit(0,t,e,o,n)},J.prototype.clearListenersCache=function(){var t,e=this.Ze;for(t=0;t<e.length;t++)delete this[e[t]+"cached"]},J.prototype.getListeners=function(t,e){var o,n,r,i,a=t[e],s=this[a];if(s&&!(o=this[n=a+"cached"]))for(r in o=this[n]=new l.Common.rbush(16),s)s.hasOwnProperty(r)&&(i=s[r])&&o.insert({minX:i.col,minY:i.row,maxX:i.col+i.colCount-1,maxY:i.row+i.rowCount-1,item:i});return o},J.prototype.visit=function(t,e,o,n,r){var i,a,s,l,u,c,h=this.Ze;for(i=0;i<h.length;i++)if(this[h[i]])for(a=this.getListeners(h,i).search({minX:o,minY:e,maxX:o+r-1,maxY:e+n-1}),s=0;s<a.length;s++)for(u in l=a[s].item.content)c=l[u],0===t?c.bh():c.fh()},J.prototype.Bg=function(t,e,o,n){this.visit(1,t,e,o,n)},J.prototype.gh=function(t,e,o){var n,r,i,a,s,l,u=this.Ze,c=o?1:-1;for(n=0;n<u.length;n++)if(this[u[n]])for(r=this.getListeners(u,n).search({minX:e,minY:t,maxX:e,maxY:t}),i=0;i<r.length;i++)for(s in a=r[i].item.content)l=a[s],h(l,d)&&(l.delay+=c)},J.prototype.og=function(){},J.prototype.ng=function(){},C=J,g.RangeCalc=C,g.CWc=Q,g.Mh=X,g._createCellIdentity=St,g.qf=$},"./src/calcEngine.res.en.ts":function(t,e,o){"use strict";var n,r;function i(t,e){return{description:t,parameters:e}}function a(t,e){return{name:t,repeatable:e}}Object.defineProperty(e,"__esModule",{value:!0}),n="[start_num]",r="[significance]",e.resource={Exp_InvalidCast:"Invalid Cast Exception",Exp_FormulaInvalidChar:"The formula contains an invalid character: '{0}' at index on {1}",Exp_FormulaInvalid:"Invalid Formula",Exp_InvalidFunctionName:"Invalid function name",Exp_InvalidOverrideFunction:"Cannot override built-in function",Exp_InvalidArray:"Invalid array",Exp_OverrideNotAllowed:"Attempt to override function while override is not allowed",Exp_NoSyntax:"No syntax '{0}' to match the syntax '{1}'.",Exp_IsValid:"'{0}' is invalid.",Exp_InvalidParameters:"Invalid function parameter at {0}.",Exp_InvalidArrayColumns:"The length of array columns are not equal at {0}.",Exp_ExprIsNull:"The argument 'expr' is null",Exp_InvalidOperation:"Invalid Operation Exception",Exp_ArgumentNull:"Argument Null Exception",Exp_CriteriaIsNull:"Criteria is null",Exp_Format:"Format",Exp_ArrayFromulaPart:"Cannot change part of an array.",Exp_NotSupported:"Not Supported Exception",_h:{ABS:i("This function calculates the absolute value of the specified value.",[a("number")]),ACCRINT:i("This function calculates the accrued interest for a security that pays periodic interest.",[a("issue"),a("first_interest"),a("settlement"),a("rate"),a("par"),a("frequency"),a("basis")]),ACCRINTM:i("This function calculates the accrued interest at maturity for a security that pays periodic interest.",[a("issue"),a("settlement"),a("rate"),a("par"),a("basis")]),ACOS:i("This function calculates the arccosine, that is, the angle whose cosine is the specified value.",[a("number")]),ACOSH:i("This function calculates the inverse hyperbolic cosine of the specified value.",[a("number")]),ADDRESS:i("This function uses the row and column numbers to create a cell address in text.",[a("row_num"),a("column_num"),a("abs_num"),a("a1style"),a("sheet_text")]),AGGREGATE:i("This function aggregate a list of numbers using a specified built-in function.",[a("function_num"),a("options"),a("ref1"),a("ref2",!0)]),AMORDEGRC:i("This function returns the depreciation for an accounting period, taking into consideration prorated depreciation, and applies a depreciation coefficient in the calculation based on the life of the assets.",[a("cost"),a("date_purchased"),a("first_period"),a("salvage"),a("period"),a("rate"),a("basis")]),AMORLINC:i("This function calculates the depreciation for an accounting period, taking into account prorated depreciation.",[a("cost"),a("date_purchased"),a("first_period"),a("salvage"),a("period"),a("rate"),a("basis")]),AND:i("Check whether all arguments are True, and returns True if all arguments are True.",[a("logical1"),a("logical2")]),ASIN:i("This function calculates the arcsine, that is, the angle whose sine is the specified value.",[a("number")]),ASINH:i("This function calculates the inverse hyperbolic sine of a number.",[a("number")]),ATAN:i("This function calculates the arctangent, that is, the angle whose tangent is the specified value.",[a("number")]),ATAN2:i("This function calculates the arctangent of the specified x- and y-coordinates.",[a("x_num"),a("y_num")]),ATANH:i("This function calculates the inverse hyperbolic tangent of a number.",[a("number")]),AVEDEV:i("This function calculates the average of the absolute deviations of the specified values from their mean.",[a("number1"),a("number2",!0)]),AVERAGE:i("This function calculates the average of the specified numeric values.",[a("number1"),a("number2",!0)]),AVERAGEA:i("This function calculates the average of the specified values, including text or logical values as well as numeric values.",[a("value1"),a("value2",!0)]),AVERAGEIF:i("This function calculates the average of the specified numeric values provided that they meet the specified criteria.",[a("range"),a("criteria"),a("[average_range]")]),AVERAGEIFS:i("This function calculates the average of all cells that meet multiple specified criteria.",[a("average_range"),a("criteria_range1",!0),a("criteria1",!0)]),BESSELI:i("This function calculates the modified Bessel function of the first kind evaluated for purely imaginary arguments.",[a("value"),a("order")]),BESSELJ:i("This function calculates the Bessel function of the first kind.",[a("value"),a("order")]),BESSELK:i("This function calculates the modified Bessel function of the second kind evaluated for purely imaginary arguments.",[a("value"),a("order")]),BESSELY:i("This function calculates the Bessel function of the second kind.",[a("value"),a("order")]),BETADIST:i("This function calculates the cumulative beta distribution function.",[a("x"),a("alpha"),a("beta"),a("lower"),a("upper")]),BETAINV:i("This function calculates the inverse of the cumulative beta distribution function.",[a("probability"),a("alpha"),a("beta"),a("lower"),a("upper")]),BIN2DEC:i("This function converts a binary number to a decimal number",[a("number")]),BIN2HEX:i("This function converts a binary number to a hexadecimal number.",[a("number"),a("places")]),BIN2OCT:i("This function converts a binary number to an octal number.",[a("number"),a("places")]),BINOMDIST:i("This function calculates the individual term binomial distribution probability.",[a("number_s"),a("trials"),a("probability_s"),a("cumulative")]),CEILING:i("This function rounds a number up to the nearest multiple of a specified value.",[a("number"),a("significance")]),CHAR:i("This function returns the character specified by a number.",[a("number")]),CHIDIST:i("This function calculates the one-tailed probability of the chi-squared distribution.",[a("value"),a("deg_freedom")]),CHIINV:i("This function calculates the inverse of the one-tailed probability of the chi-squared distribution",[a("probability"),a("deg_freedom")]),CHITEST:i("This function calculates the test for independence from the chi-squared distribution.",[a("actual_range"),a("expected_range")]),CHOOSE:i("This function returns a value from a list of values.",[a("index_num"),a("value1"),a("value2",!0)]),CLEAN:i("This function removes all non-printable characters from text.",[a("text")]),CODE:i("This function returns a numeric code to represent the first character in a text string. The returned code corresponds to the Windows character set (ANSI).",[a("text")]),COLUMN:i("This function returns the column number of a reference.",[a("reference")]),COLUMNS:i("This function returns the number of columns in an array.",[a("array")]),COMBIN:i("This function calculates the number of possible combinations for a specified number of items.",[a("number"),a("number_chosen")]),COMPLEX:i("This function converts real and imaginary coefficients into a complex number.",[a("real_num"),a("image_num"),a("suffix")]),CONCATENATE:i("This function combines multiple text strings or numbers into one text string.",[a("text1"),a("text2",!0)]),CONFIDENCE:i("This function returns confidence interval for a population mean.",[a("alpha"),a("standard_dev"),a("size")]),CONVERT:i("This function converts a number from one measurement system to its equivalent in another measurement system.",[a("number"),a("from_unit"),a("to_unit")]),CORREL:i("This function returns the correlation coefficient of the two sets of data.",[a("array1"),a("array2")]),COS:i("This function returns the cosine of the specified angle.",[a("number")]),COSH:i("This function returns the hyperbolic cosine of the specified value.",[a("number")]),COUNT:i("This function returns the number of cells that contain numbers.",[a("value1"),a("value2",!0)]),COUNTA:i("This function returns the number of number of cells that contain numbers, text, or logical values.",[a("value1"),a("value2",!0)]),COUNTBLANK:i("This function returns the number of empty (or blank) cells in a range of cells on a sheet.",[a("cellrange")]),COUNTIF:i("This function returns the number of cells that meet a certain condition",[a("cellrange"),a("criteria")]),COUNTIFS:i("This function returns the number of cells that meet multiple conditions.",[a("criteria_range1",!0),a("criteria1",!0)]),COUPDAYBS:i("This function calculates the number of days from the beginning of the coupon period to the settlement date.",[a("settlement"),a("maturity"),a("frequency"),a("basis")]),COUPDAYS:i("This function returns the number of days in the coupon period that contains the settlement date.",[a("settlement"),a("maturity"),a("frequency"),a("basis")]),COUPDAYSNC:i("This function calculates the number of days from the settlement date to the next coupon date.",[a("settlement"),a("maturity"),a("frequency"),a("basis")]),COUPNCD:i("This function returns a date number of the next coupon date after the settlement date.",[a("settlement"),a("maturity"),a("frequency"),a("basis")]),COUPNUM:i("This function returns the number of coupons due between the settlement date and maturity date.",[a("settlement"),a("maturity"),a("frequency"),a("basis")]),COUPPCD:i("This function returns a date number of the previous coupon date before the settlement date.",[a("settlement"),a("maturity"),a("frequency"),a("basis")]),COVAR:i("This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[a("array1"),a("array2")]),CRITBINOM:i("This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[a("trials"),a("probability_s"),a("alpha")]),CUMIPMT:i("This function returns the cumulative interest paid on a loan between the starting and ending periods.",[a("rate"),a("nper"),a("pval"),a("start_period"),a("end_period"),a("paytype")]),CUMPRINC:i("This function returns the cumulative principal paid on a loan between the start and end periods.",[a("rate"),a("nper"),a("pval"),a("start_period"),a("end_period"),a("paytype")]),DATE:i("This function returns the DateTime object for a particular date, specified by the year, month, and day.",[a("year"),a("month"),a("day")]),DATEDIF:i("This function returns the number of days, months, or years between two dates.",[a("start_date"),a("end_date"),a("unit")]),DATEVALUE:i("This function returns a DateTime object of the specified date.",[a("date_text")]),DAVERAGE:i("This function calculates the average of values in a column of a list or database that match the specified conditions.",[a("database"),a("field"),a("criteria")]),DAY:i("This function returns the day number of the month (integer 1 to 31) that corresponds to the specified date.",[a("date")]),DAYS360:i("This function returns the number of days between two dates based on a 360-day year.",[a("start_date"),a("end_date"),a("method")]),DB:i("This function calculates the depreciation of an asset for a specified period using the fixed‑declining balance method",[a("cost"),a("salvage"),a("life"),a("period"),a("month")]),DCOUNT:i("This function counts the cells that contain numbers in a column of a list or database that match the specified conditions",[a("database"),a("field"),a("criteria")]),DCOUNTA:i("This function counts the non-blank cells in a column of a list or database that match the specified conditions",[a("database"),a("field"),a("criteria")]),DDB:i("This function calculates the depreciation of an asset for a specified period using the double-declining balance method or another method you specify.",[a("cost"),a("salvage"),a("life"),a("period"),a("factor")]),DEC2BIN:i("This function converts a decimal number to a binary number.",[a("number"),a("places")]),DEC2HEX:i("This function converts a decimal number to a hexadecimal number",[a("number"),a("places")]),DEC2OCT:i("This function converts a decimal number to an octal number",[a("number"),a("places")]),DEGREES:i("This function converts the specified value from radians to degrees",[a("angle")]),DELTA:i("This function identifies whether two values are equal. Returns 1 if they are equal; returns 0 otherwise.",[a("number1"),a("number2")]),DEVSQ:i("This function calculates the sum of the squares of deviations of data points (or of an array of data points) from their sample mean.",[a("number1"),a("number2",!0)]),DGET:i("This function extracts a single value from a column of a list or database that matches the specified conditions.",[a("database"),a("field"),a("criteria")]),DISC:i("This function calculates the discount rate for a security.",[a("settlement"),a("maturity"),a("price"),a("redemption"),a("basis")]),DMAX:i("This function returns the largest number in a column of a list or database that matches the specified conditions.",[a("database"),a("field"),a("criteria")]),DMIN:i("This function returns the smallest number in a column of a list or database that matches the specified conditions.",[a("database"),a("field"),a("criteria")]),DOLLAR:i("This function converts a number to text using currency format, with the decimals rounded to the specified place.",[a("number"),a("decimals")]),DOLLARDE:i("This function converts a fraction dollar price to a decimal dollar price.",[a("fractional_dollar"),a("fraction")]),DOLLARFR:i("This function converts a decimal number dollar price to a fraction dollar price.",[a("decimal_dollar"),a("fraction")]),DPRODUCT:i("This function multiplies the values in a column of a list or database that match the specified conditions.",[a("database"),a("field"),a("criteria")]),DSTDEV:i("This function estimates the standard deviation of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[a("database"),a("field"),a("criteria")]),DSTDEVP:i("This function calculates the standard deviation of a population based on the entire population using the numbers in a column of a list or database that match the specified conditions.",[a("database"),a("field"),a("criteria")]),DSUM:i("This function adds the numbers in a column of a list or database that match the specified conditions.",[a("database"),a("field"),a("criteria")]),DURATION:i("This function returns the Macaulay duration for an assumed par value of $100.",[a("settlement"),a("maturity"),a("coupon"),a("yield"),a("frequency"),a("basis")]),DVAR:i("This function estimates the variance of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[a("database"),a("field"),a("criteria")]),DVARP:i("This function calculates the variance of a population based on the entire population by using the numbers in a column of a list or database that match the specified conditions.",[a("database"),a("field"),a("criteria")]),EDATE:i("This function calculates the date that is the indicated number of months before or after a specified date.",[a("start_date"),a("months")]),EFFECT:i("This function calculates the effective annual interest rate for a given nominal annual interest rate and the number of compounding periods per year.",[a("nominal_rate"),a("npery")]),EOMONTH:i("This function calculates the date for the last day of the month (end of month) that is the indicated number of months before or after the starting date.",[a("start_date"),a("months")]),ERF:i("This function calculates the error function integrated between a lower and an upper limit.",[a("lower_limit"),a("upper_limit")]),ERFC:i("This function calculates the complementary error function integrated between a lower limit and infinity.",[a("lowerlimit")]),"ERROR.TYPE":i("This function returns a number corresponding to one of the error values.",[a("error_val")]),EURO:i("This function returns the equivalent of one Euro based on the ISO currency code.",[a("code")]),EUROCONVERT:i("This function converts currency from a Euro member currency (including Euros) to another Euro member currency (including Euros).",[a("number"),a("source"),a("target"),a("full_precision"),a("triangulation_precision")]),EVEN:i("This function rounds the specified value up to the nearest even integer.",[a("number")]),EXACT:i("This function returns true if two strings are the same; otherwise, false.",[a("text1"),a("text2")]),EXP:i("This function returns e raised to the power of the specified value.",[a("number")]),EXPONDIST:i("This function returns the exponential distribution or the probability density.",[a("value"),a("lambda"),a("cumulative")]),FACT:i("This function calculates the factorial of the specified number.",[a("number")]),FACTDOUBLE:i("This function calculates the double factorial of the specified number.",[a("number")]),FALSE:i("This function returns the value for logical FALSE.",[]),FDIST:i("This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[a("value"),a("deg_freedom1"),a("deg_freedom2")]),FIND:i("This function finds one text value within another and returns the text value’s position in the text you searched.",[a("find_text"),a("within_text"),a(n)]),FINV:i("This function returns the inverse of the F probability distribution.",[a("probability"),a("deg_freedom1"),a("deg_freedom2")]),FISHER:i("This function returns the Fisher transformation for a specified value.",[a("value")]),FISHERINV:i("This function returns the inverse of the Fisher transformation for a specified value.",[a("value")]),FIXED:i("This function rounds a number to the specified number of decimal places, formats the number in decimal format using a period and commas (if so specified), and returns the result as text.",[a("number"),a("decimals"),a("no_commas")]),FLOOR:i("This function rounds a number down to the nearest multiple of a specified value.",[a("number"),a("significance")]),FORECAST:i("This function calculates a future value using existing values.",[a("value"),a("Yarray"),a("Xarray")]),FREQUENCY:i("This function calculates how often values occur within a range of values. This function returns a vertical array of numbers.",[a("data_array"),a("bins_array")]),FTEST:i("This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[a("array1"),a("array2")]),FV:i("This function returns the future value of an investment based on a present value, periodic payments, and a specified interest rate.",[a("rate"),a("numper"),a("paymt"),a("pval"),a("type")]),FVSCHEDULE:i("This function returns the future value of an initial principal after applying a series of compound interest rates. Calculate future value of an investment with a variable or adjustable rate.",[a("principal"),a("schedule")]),GAMMADIST:i("This function returns the gamma distribution.",[a("x"),a("alpha"),a("beta"),a("cumulative")]),GAMMAINV:i("This function returns the inverse of the gamma cumulative distribution.",[a("probability"),a("alpha"),a("beta")]),GAMMALN:i("This function returns the natural logarithm of the Gamma function, G(x).",[a("value")]),GCD:i("This function returns the greatest common divisor of two numbers.",[a("number1"),a("number2")]),GEOMEAN:i("This function returns the geometric mean of a set of positive data.",[a("number1"),a("number2",!0)]),GESTEP:i("This function, greater than or equal to step, returns an indication of whether a number is equal to a threshold.",[a("number"),a("step")]),GROWTH:i("This function calculates predicted exponential growth. This function returns the y values for a series of new x values that are specified by using existing x and y values.",[a("y"),a("x"),a("newx"),a("constant")]),HARMEAN:i("This function returns the harmonic mean of a data set.",[a("number1"),a("number2",!0)]),HEX2BIN:i("This function converts a hexadecimal number to a binary number.",[a("number"),a("places")]),HEX2DEC:i("This function converts a hexadecimal number to a decimal number.",[a("number")]),HEX2OCT:i("This function converts a hexadecimal number to an octal number.",[a("number"),a("places")]),HLOOKUP:i("This function searches for a value in the top row and then returns a value in the same column from a specified row.",[a("lookup_value"),a("table_array"),a("row_index_num"),a("range_lookup")]),HOUR:i("This function returns the hour that corresponds to a specified time.",[a("time")]),HYPGEOMDIST:i("This function returns the hypergeometric distribution.",[a("sample_s"),a("number_sample"),a("population_s"),a("number_pop")]),IF:i("This function performs a comparison and returns one of two provided values based on that comparison.",[a("logical_test"),a("value_if_true"),a("value_if_false")]),IFERROR:i("This function evaluates a formula and returns a value you provide if there is an error or the formula result.",[a("value"),a("value_if_error")]),IMABS:i("This function returns the absolute value or modulus of a complex number.",[a("complexnum")]),IMAGINARY:i("This function returns the imaginary coefficient of a complex number.",[a("complexnum")]),IMARGUMENT:i("This function returns the argument theta, which is an angle expressed in radians.",[a("complexnum")]),IMCONJUGATE:i("This function returns the complex conjugate of a complex number.",[a("complexnum")]),IMCOS:i("This function returns the cosine of a complex number.",[a("complexnum")]),IMDIV:i("This function returns the quotient of two complex numbers.",[a("complexnum"),a("complexdenom")]),IMEXP:i("This function returns the exponential of a complex number.",[a("complexnum")]),IMLN:i("This function returns the natural logarithm of a complex number.",[a("complexnum")]),IMLOG2:i("This function returns the base-2 logarithm of a complex number.",[a("complexnum")]),IMLOG10:i("This function returns the common logarithm of a complex number.",[a("complexnum")]),IMPOWER:i("This function returns a complex number raised to a power.",[a("complexnum"),a("powernum")]),IMPRODUCT:i("This function returns the product of up to 29 complex numbers in the x+yi or x+yj text format.",[a("complexnum1"),a("complexnum2",!0)]),IMREAL:i("This function returns the real coefficient of a complex number in the x+yi or x+yj text format.",[a("complexnum")]),IMSIN:i("This function returns the sine of a complex number in the x+yi or x+yj text format.",[a("complexnum")]),IMSQRT:i("This function returns the square root of a complex number in the x+yi or x+yj text format.",[a("complexnum")]),IMSUB:i("This function returns the difference of two complex numbers in the x+yi or x+yj text format.",[a("complexnum1"),a("complexnum2")]),IMSUM:i("This function returns the sum of two or more complex numbers in the x+yi or x+yj text format.",[a("complexnum1"),a("complexnum2",!0)]),INDEX:i("This function returns a value or the reference to a value from within an array or range.",[a("array"),a("row_num"),a("column_num"),a("area_num")]),INDIRECT:i("This function returns the reference specified by a text string. References are immediately evaluated to display their contents.",[a("ref_text"),a("[a1_style]")]),INT:i("This function rounds a specified number down to the nearest integer.",[a("number")]),INTERCEPT:i("This function returns the coordinates of a point at which a line intersects the y-axis, by using existing x values and y values.",[a("dependent"),a("independent")]),INTRATE:i("This function calculates the interest rate for a fully invested security.",[a("settlement"),a("maturity"),a("investment"),a("redemption"),a("basis")]),IPMT:i("This function calculates the payment of interest on a loan.",[a("rate"),a("per"),a("nper"),a("pval"),a("fval"),a("type")]),IRR:i("This function returns the internal rate of return for a series of cash flows represented by the numbers in an array.",[a("arrayvals"),a("estimate")]),ISBLANK:i("This function tests whether a value, an expression, or contents of a referenced cell is empty.",[a("cellreference")]),ISERR:i("This function, Is Error Other Than Not Available, tests whether a value, an expression, or contents of a referenced cell has an error other than not available (#N/A).",[a("cellreference")]),ISERROR:i("This function, Is Error of Any Kind, tests whether a value, an expression, or contents of a referenced cell has an error of any kind.",[a("cellreference")]),ISEVEN:i("This function, Is Number Even, tests whether a value, an expression, or contents of a referenced cell is even.",[a("cellreference")]),ISLOGICAL:i("This function tests whether a value, an expression, or contents of a referenced cell is a logical (Boolean) value.",[a("cellreference")]),ISNA:i("This function, Is Not Available, tests whether a value, an expression, or contents of a referenced cell has the not available (#N/A) error value.",[a("cellreference")]),ISNONTEXT:i("This function tests whether a value, an expression, or contents of a referenced cell has any data type other than text.",[a("cellreference")]),ISNUMBER:i("This function tests whether a value, an expression, or contents of a referenced cell has numeric data.",[a("cellreference")]),ISODD:i("This function, Is Number Odd, tests whether a value, an expression, or contents of a referenced cell has numeric data.",[a("cellreference")]),ISPMT:i("This function calculates the interest paid during a specific period of an investment.",[a("rate"),a("per"),a("nper"),a("pv")]),ISREF:i("This function, Is Reference, tests whether a value, an expression, or contents of a referenced cell is a reference to another cell.",[a("cellreference")]),ISTEXT:i("This function tests whether a value, an expression, or contents of a referenced cell has text data.",[a("cellreference")]),KURT:i("This function returns the kurtosis of a data set.",[a("number1"),a("number2"),a("number3"),a("number4",!0)]),LARGE:i("This function returns the nth largest value in a data set, where n is specified.",[a("array"),a("n")]),LCM:i("This function returns the least common multiple of two numbers.",[a("number1"),a("number2")]),LEFT:i("This function returns the specified leftmost characters from a text value, and based on the number of characters you specify.",[a("text"),a("num_chars")]),LEN:i("This function returns the length of the number of characters in a text string.",[a("text")]),LINEST:i("This function calculates the statistics for a line.",[a("y"),a("x"),a("constant"),a("stats")]),LN:i("This function returns the natural logarithm of the specified number.",[a("value")]),LOG:i("This function returns the logarithm base Y of a number X.",[a("number"),a("base")]),LOG10:i("This function returns the logarithm base 10 of the number given.",[a("number")]),LOGEST:i("This function calculates an exponential curve that fits the data and returns an array of values that describes the curve.",[a("y"),a("x"),a("constant"),a("stats")]),LOGINV:i("This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[a("probability"),a("mean"),a("standard_dev")]),LOGNORMDIST:i("This function returns the cumulative natural log normal distribution of x, where LN(x) is normally distributed with the specified mean and standard deviation. Analyze data that has been logarithmically transformed with this function.",[a("x"),a("mean"),a("standard_dev")]),LOOKUP:i("This function searches for a value and returns a value from the same location in a second area.",[a("lookup_value"),a("lookup_vector"),a("result_vector")]),LOWER:i("This function converts text to lower case letters.",[a("text")]),MATCH:i("This function returns the relative position of a specified item in a range.",[a("lookup_value"),a("lookup_array"),a("match_type")]),XMATCH:i("This function returns the relative position of an item in an array. By default, an exact match is required.",[a("lookup_value"),a("lookup_array"),a("[match_mode]"),a("[search_mode]")]),XLOOKUP:i("This function searches a range or an array for a match and returns the corresponding item from a second range or array. By default, an exact match is used.",[a("lookup_value"),a("lookup_array"),a("return_array"),a("[if_not_found]"),a("[match_mode]"),a("[search_mode]")]),MAX:i("This function returns the maximum value, the greatest value, of all the values in the arguments.",[a("number1"),a("number2",!0)]),MAXA:i("This function returns the largest value in a list of arguments, including text and logical values.",[a("value1"),a("value2",!0)]),MDETERM:i("This function returns the matrix determinant of an array.",[a("array")]),MDURATION:i("This function calculates the modified Macaulay duration of a security with an assumed par value of $100.",[a("settlement"),a("maturity"),a("coupon"),a("yield"),a("frequency"),a("basis")]),MEDIAN:i("This function returns the median, the number in the middle of the provided set of numbers; that is, half the numbers have values that are greater than the median, and half have values that are less than the median.",[a("number1"),a("number2",!0)]),MID:i("This function returns the requested number of characters from a text string starting at the position you specify, and based on the number of characters you specify.",[a("text"),a("start_num"),a("num_chars")]),MIN:i("This function returns the minimum value, the least value, of all the values in the arguments.",[a("number1"),a("number2",!0)]),MINA:i("This function returns the minimum value in a list of arguments, including text and logical values.",[a("value1"),a("value2",!0)]),MINUTE:i("This function returns the minute corresponding to a specified time.",[a("time")]),MINVERSE:i("This function returns the inverse matrix for the matrix stored in an array.",[a("array")]),MIRR:i("This function returns the modified internal rate of return for a series of periodic cash flows.",[a("values"),a("finance_rate"),a("reinvest_rate")]),MMULT:i("This function returns the matrix product for two arrays.",[a("array1"),a("array2")]),MOD:i("This function returns the remainder of a division operation.",[a("dividend"),a("divisor")]),MODE:i("This function returns the most frequently occurring value in a set of data.",[a("number1"),a("number2",!0)]),MONTH:i("This function returns the month corresponding to the specified date value.",[a("date")]),MROUND:i("This function returns a number rounded to the desired multiple.",[a("number"),a("multiple")]),MULTINOMIAL:i("This function calculates the ratio of the factorial of a sum of values to the product of factorials.",[a("number1"),a("number2",!0)]),MUNIT:i("The function returns the unit matrix for the specified dimension.",[a("dimension")]),N:i("This function returns a value converted to a number.",[a("value")]),NA:i("This function returns the error value #N/A that means not available.",[]),SHEET:i("Returns the sheet number of reference sheet.",[a("[value]")]),SHEETS:i("Returns the number of sheets in a reference.",[a("[reference]")]),NEGBINOMDIST:i("This function returns the negative binomial distribution.",[a("number_f"),a("number_s"),a("probability_s")]),NETWORKDAYS:i("This function returns the total number of complete working days between the start and end dates.",[a("start_date"),a("end_date"),a("holidays")]),NOMINAL:i("This function returns the nominal annual interest rate for a given effective rate and number of compounding periods per year.",[a("effect_rate"),a("npery")]),NORMDIST:i("This function returns the normal cumulative distribution for the specified mean and standard deviation.",[a("x"),a("mean"),a("standard_dev"),a("cumulative")]),NORMINV:i("This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[a("probability"),a("mean"),a("standard_dev")]),NORMSDIST:i("This function returns the standard normal cumulative distribution function.",[a("value")]),NORMSINV:i("This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[a("probability")]),NOT:i("This function reverses the logical value of its argument.",[a("logical")]),NOW:i("This function returns the current date and time.",[]),NPER:i("This function returns the number of periods for an investment based on a present value, future value, periodic payments, and a specified interest rate.",[a("rate"),a("paymt"),a("pval"),a("fval"),a("type")]),NPV:i("This function calculates the net present value of an investment by using a discount rate and a series of future payments and income.",[a("rate"),a("value1"),a("value2",!0)]),OBJECT:i("This function converts the property/expression sequence to an object.",[a("property1",!0),a("expression1",!0)]),OCT2BIN:i("This function converts an octal number to a binary number.",[a("number"),a("places")]),OCT2DEC:i("This function converts an octal number to a decimal number.",[a("number")]),OCT2HEX:i("This function converts an octal number to a hexadecimal number.",[a("number"),a("places")]),ODD:i("This function rounds the specified value up to the nearest odd integer.",[a("number")]),ODDFPRICE:i("This function calculates the price per $100 face value of a security with an odd first period.",[a("settlement"),a("maturity"),a("issue"),a("first_coupon"),a("rate"),a("yield"),a("redemption"),a("frequency"),a("basis")]),ODDFYIELD:i("This function calculates the yield of a security with an odd first period.",[a("settlement"),a("maturity"),a("issue"),a("first_coupon"),a("rate"),a("price"),a("redemption"),a("frequency"),a("basis")]),ODDLPRICE:i("This function calculates the price per $100 face value of a security with an odd last coupon period.",[a("settlement"),a("maturity"),a("last_interest"),a("rate"),a("yield"),a("redemption"),a("frequency"),a("basis")]),ODDLYIELD:i("This function calculates the yield of a security with an odd last period.",[a("settlement"),a("maturity"),a("last_interest"),a("rate"),a("price"),a("redemption"),a("frequency"),a("basis")]),OFFSET:i("This function returns a reference to a range. The range is a specified number of rows and columns from a cell or range of cells. The function returns a single cell or a range of cells.",[a("reference"),a("rows"),a("cols"),a("height"),a("width")]),OR:i("This function calculates logical OR. It returns TRUE if any of its arguments are true; otherwise, returns FALSE if all arguments are false.",[a("logical1"),a("logical2",!0)]),PEARSON:i("This function returns the Pearson product moment correlation coefficient, a dimensionless index between -1.0 to 1.0 inclusive indicative of the linear relationship of two data sets.",[a("array_ind"),a("array_dep")]),PERCENTILE:i("This function returns the nth percentile of values in a range.",[a("array"),a("n")]),PERCENTRANK:i("This function returns the rank of a value in a data set as a percentage of the data set.",[a("array"),a("x"),a("significance")]),PERMUT:i("This function returns the number of possible permutations for a specified number of items.",[a("number"),a("number_chosen")]),PI:i("This function returns PI as 3.1415926536.",[]),PMT:i("This function returns the payment amount for a loan given the present value, specified interest rate, and number of terms.",[a("rate"),a("nper"),a("pval"),a("fval"),a("type")]),POISSON:i("This function returns the Poisson distribution.",[a("nevents"),a("mean"),a("cumulative")]),POWER:i("This function raises the specified number to the specified power.",[a("number"),a("power")]),PPMT:i("This function returns the amount of payment of principal for a loan given the present value, specified interest rate, and number of terms.",[a("rate"),a("per"),a("nper"),a("pval"),a("fval"),a("type")]),PRICE:i("This function calculates the price per $100 face value of a periodic interest security",[a("settlement"),a("maturity"),a("rate"),a("yield"),a("redemption"),a("frequency"),a("basis")]),PRICEDISC:i("This function returns the price per $100 face value of a discounted security.",[a("settlement"),a("maturity"),a("discount"),a("redemption"),a("basis")]),PRICEMAT:i("This function returns the price at maturity per $100 face value of a security that pays interest.",[a("settlement"),a("maturity"),a("issue"),a("rate"),a("yield"),a("basis")]),PROB:i("This function returns the probability that values in a range are between two limits.",[a("x_range"),a("prob_range"),a("lower_limit"),a("upper_limit")]),PRODUCT:i("This function multiplies all the arguments and returns the product.",[a("number1"),a("number2",!0)]),PROPER:i("This function capitalizes the first letter in each word of a text string.",[a("text")]),PROPERTY:i("This function returns the value of property path in object.",[a("data_expression"),a("property_path")]),PV:i("This function returns the present value of an investment based on the interest rate, number and amount of periodic payments, and future value. The present value is the total amount that a series of future payments is worth now.",[a("rate"),a("numper"),a("paymt"),a("fval"),a("type")]),QUARTILE:i("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[a("array"),a("quart")]),QUOTIENT:i("This function returns the integer portion of a division. Use this to ignore the remainder of a division.",[a("numerator"),a("denominator")]),RADIANS:i("This function converts the specified number from degrees to radians.",[a("angle")]),RAND:i("This function returns an evenly distributed random number between 0 and 1.",[]),RANDBETWEEN:i("This function returns a random number between the numbers you specify.",[a("bottom"),a("top")]),RANGEBLOCKSPARKLINE:i("This function returns a rangetemplate.",[a("template_range"),a("data_expression")]),RANK:i("This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[a("number"),a("ref"),a("order")]),RATE:i("This function returns the interest rate per period of an annuity.",[a("nper"),a("pmt"),a("pval"),a("fval"),a("type"),a("guess")]),RECEIVED:i("This function returns the amount received at maturity for a fully invested security.",[a("settlement"),a("maturity"),a("investment"),a("discount"),a("basis")]),REPLACE:i("This function replaces part of a text string with a different text string, based on the number of characters you specify.",[a("old_text"),a("start_num"),a("num_chars"),a("new_text")]),REPT:i("This function repeats text a specified number of times.",[a("text"),a("number_times")]),RIGHT:i("This function returns the specified rightmost characters from a text value, and based on the number of characters you specify.",[a("text"),a("num_chars")]),ROMAN:i("This function converts an Arabic numeral to a Roman numeral text equivalent.",[a("number"),a("form")]),ROUND:i("This function rounds the specified value to the nearest number, using the specified number of decimal places.",[a("number"),a("num_digits")]),ROUNDDOWN:i("This function rounds the specified number down to the nearest number, using the specified number of decimal places.",[a("number"),a("num_digits")]),ROUNDUP:i("This function rounds the specified number up to the nearest number, using the specified number of decimal places.",[a("number"),a("num_digits")]),ROW:i("This function returns the number of a row from a reference.",[a("reference")]),ROWS:i("This function returns the number of rows in an array.",[a("array")]),RSQ:i("This function returns the square of the Pearson product moment correlation coefficient (R-squared) through data points in known y's and known x's.",[a("array_dep"),a("array_ind")]),SEARCH:i("This function finds one text string in another text string and returns the index of the starting position of the found text.",[a("find_text"),a("within_text"),a(n)]),SECOND:i("This function returns the seconds (0 to 59) value for a specified time.",[a("time")]),SERIESSUM:i("This function returns the sum of a power series.",[a("x"),a("n"),a("m"),a("coefficients")]),SIGN:i("This function returns the sign of a number or expression.",[a("cellreference")]),SIN:i("This function returns the sine of the specified angle.",[a("angle")]),SINH:i("This function returns the hyperbolic sine of the specified number.",[a("number")]),SKEW:i("This function returns the skewness of a distribution.",[a("number1"),a("number2",!0)]),SLN:i("This function returns the straight-line depreciation of an asset for one period.",[a("cost"),a("salvage"),a("life")]),SLOPE:i("This function calculates the slope of a linear regression.",[a("array_dep"),a("array_ind")]),SMALL:i("This function returns the nth smallest value in a data set, where n is specified.",[a("array"),a("n")]),SQRT:i("This function returns the positive square root of the specified number.",[a("value")]),SQRTPI:i("This function returns the positive square root of a multiple of pi (p).",[a("multiple")]),STANDARDIZE:i("This function returns a normalized value from a distribution characterized by mean and standard deviation.",[a("x"),a("mean"),a("standard_dev")]),STDEVA:i("This function returns the standard deviation for a set of numbers, text, or logical values.",[a("value1"),a("value2",!0)]),STDEVP:i("This function returns the standard deviation for an entire specified population (of numeric values).",[a("number1"),a("number2",!0)]),STDEVPA:i("This function returns the standard deviation for an entire specified population, including text or logical values as well as numeric values.",[a("value1"),a("value2",!0)]),STEYX:i("This function returns the standard error of the predicted y value for each x. The standard error is a measure of the amount of error in the prediction of y for a value of x.",[a("array_dep"),a("array_ind")]),SUBSTITUTE:i("This function substitutes a new string for specified characters in an existing string.",[a("text"),a("old_text"),a("new_text"),a("instance_num")]),SUBTOTAL:i("This function calculates a subtotal of a list of numbers using a specified built-in function.",[a("function_num"),a("ref1"),a("ref2",!0)]),SUM:i("This function returns the sum of cells or range of cells.",[a("number1"),a("number2",!0)]),SUMIF:i("This function adds the cells using a given criteria.",[a("range"),a("criteria"),a("sum_range")]),SUMIFS:i("This function adds the cells in a range using multiple criteria.",[a("sum_range"),a("criteria_range1",!0),a("criteria1",!0)]),SUMPRODUCT:i("This function returns the sum of products of cells. Multiplies corresponding components in the given arrays, and returns the sum of those products.",[a("array1"),a("array2",!0)]),SUMSQ:i("This function returns the sum of the squares of the arguments.",[a("number1"),a("number2",!0)]),SUMX2MY2:i("This function returns the sum of the difference of the squares of corresponding values in two arrays.",[a("array_x"),a("array_y")]),SUMX2PY2:i("This function returns the sum of the sum of squares of corresponding values in two arrays.",[a("array_x"),a("array_y")]),SUMXMY2:i("This function returns the sum of the square of the differences of corresponding values in two arrays.",[a("array_x"),a("array_y")]),SYD:i("This function returns the sum-of-years' digits depreciation of an asset for a specified period.",[a("cost"),a("salvage"),a("life"),a("period")]),T:i("This function returns the text in a specified cell.",[a("value")]),TAN:i("This function returns the tangent of the specified angle.",[a("angle")]),TANH:i("This function returns the hyperbolic tangent of the specified number.",[a("number")]),TBILLEQ:i("This function returns the equivalent yield for a Treasury bill (or T-bill)",[a("settlement"),a("maturity"),a("discount")]),TBILLPRICE:i("This function returns the price per $100 face value for a Treasury bill (or T-bill).",[a("settlement"),a("maturity"),a("discount")]),TBILLYIELD:i("This function returns the yield for a Treasury bill (or T-bill).",[a("settlement"),a("maturity"),a("priceper")]),TDIST:i("This function returns the probability for the t-distribution.",[a("x"),a("deg_freedom"),a("tails")]),TEXT:i("This function formats a number and converts it to text.",[a("value"),a("format_text")]),TIME:i("This function returns the TimeSpan object for a specified time.",[a("hour"),a("minute"),a("second")]),TIMEVALUE:i("This function returns the TimeSpan object of the time represented by a text string.",[a("time_text")]),TINV:i("This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[a("probability"),a("deg_freedom")]),TODAY:i("This function returns the date and time of the current date.",[]),TRANSPOSE:i("This function returns a vertical range of cells as a horizontal range or a horizontal range of cells as a vertical range.",[a("array")]),TREND:i("This function returns values along a linear trend. This function fits a straight line to the arrays known x and y values. Trend returns the y values along that line for the array of specified new x values.",[a("y"),a("x"),a("newx"),a("constant")]),TRIM:i("This function removes extra spaces from a string and leaves single spaces between words.",[a("text")]),TRIMMEAN:i("This function returns the mean of a subset of data excluding the top and bottom data.",[a("array"),a("percent")]),TRUE:i("This function returns the value for logical TRUE.",[]),TRUNC:i("This function removes the specified fractional part of the specified number.",[a("number"),a("num_digits")]),TTEST:i("This function returns the probability associated with a t-test.",[a("array1"),a("array2"),a("tails"),a("type")]),TYPE:i("This function returns the type of value.",[a("value")]),UPPER:i("This function converts text to uppercase letters.",[a("text")]),VALUE:i("This function converts a text string that is a number to a numeric value.",[a("text")]),VAR:i("This function returns the variance based on a sample of a population, which uses only numeric values.",[a("number1"),a("number2",!0)]),VARA:i("This function returns the variance based on a sample of a population, which includes numeric, logical, or text values.",[a("value1"),a("value2",!0)]),VARP:i("This function returns variance based on the entire population, which uses only numeric values.",[a("number1"),a("number2",!0)]),VARPA:i("This function returns variance based on the entire population, which includes numeric, logical, or text values.",[a("value1"),a("value2",!0)]),VDB:i("This function returns the depreciation of an asset for any period you specify using the variable declining balance method.",[a("cost"),a("salvage"),a("life"),a("start_period"),a("end_period"),a("factor"),a("no_switch")]),VLOOKUP:i("This function searches for a value in the leftmost column and returns a value in the same row from a column you specify.",[a("lookup_value"),a("table_array"),a("col_index_num"),a("range_lookup")]),WEEKDAY:i("This function returns the number corresponding to the day of the week for a specified date.",[a("date"),a("type")]),WEEKNUM:i("This function returns a number that indicates the week of the year numerically.",[a("date"),a("weektype")]),WEIBULL:i("This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[a("x"),a("alpha"),a("beta"),a("cumulative")]),WORKDAY:i("This function returns the number of working days before or after the starting date.",[a("start_date"),a("days"),a("holidays")]),XIRR:i("This function calculates the internal rate of return for a schedule of cash flows that may not be periodic.",[a("values"),a("dates"),a("guess")]),XNPV:i("This function calculates the net present value for a schedule of cash flows that may not be periodic.",[a("rate"),a("values"),a("dates")]),YEAR:i("This function returns the year as an integer for a specified date.",[a("date")]),YEARFRAC:i("This function returns the fraction of the year represented by the number of whole days between the start and end dates.",[a("start_date"),a("end_date"),a("basis")]),YIELD:i("This function calculates the yield on a security that pays periodic interest.",[a("settlement"),a("maturity"),a("rate"),a("price"),a("redemption"),a("frequency"),a("basis")]),YIELDDISC:i("This function calculates the annual yield for a discounted security.",[a("settlement"),a("maturity"),a("price"),a("redemption"),a("basis")]),YIELDMAT:i("This function calculates the annual yield of a security that pays interest at maturity.",[a("settlement"),a("maturity"),a("issue"),a("rate"),a("price"),a("basis")]),ZTEST:i("This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[a("array"),a("x"),a("sigma")]),HBARSPARKLINE:i("This function returns a data set used for representing a Hbar sparkline",[a("value"),a("colorScheme"),a("axisVisible"),a("barHeight")]),VBARSPARKLINE:i("This function returns a data set used for representing a Vbar sparkline",[a("value"),a("colorScheme"),a("axisVisible"),a("barWidth")]),VARISPARKLINE:i("This function returns a data set used for representing a variance sparkline",[a("variance"),a("reference"),a("mini"),a("maxi"),a("mark"),a("tickunit"),a("legend"),a("colorPositive"),a("colorNegative"),a("vertical")]),PIESPARKLINE:i("This function returns a data set used for representing a pie sparkline",[a("range|percentage"),a("color",!0)]),AREASPARKLINE:i("This function returns a data set used for representing a area sparkline",[a("points"),a("mini"),a("maxi"),a("line1"),a("line2"),a("colorPositive"),a("colorNegative")]),SCATTERSPARKLINE:i("This function returns a data set used for representing a scatter sparkline",[a("points1"),a("points2"),a("minX"),a("maxX"),a("minY"),a("maxY"),a("hLine"),a("vLine"),a("xMinZone"),a("xMaxZone"),a("yMinZone"),a("yMaxZone"),a("tags"),a("drawSymbol"),a("drawLines"),a("color1"),a("color2"),a("dash")]),LINESPARKLINE:i("This function returns a data set used for representing a line sparkline",[a("data"),a("dataOrientation"),a("dateAxisData"),a("dateAxisOrientation"),a("setting")]),COLUMNSPARKLINE:i("This function returns a data set used for representing a column sparkline",[a("data"),a("dataOrientation"),a("dateAxisData"),a("dateAxisOrientation"),a("setting")]),WINLOSSSPARKLINE:i("This function returns a data set used for representing a win/loss sparkline",[a("data"),a("dataOrientation"),a("dateAxisData"),a("dateAxisOrientation"),a("setting")]),BULLETSPARKLINE:i("This function returns a data set used for representing a bullet sparkline",[a("measure"),a("target"),a("maxi"),a("good"),a("bad"),a("forecast"),a("tickunit"),a("colorScheme"),a("vertical"),a("measureColor"),a("targetColor"),a("maxiColor"),a("goodColor"),a("badColor"),a("forecastColor"),a("allowMeasureOverMaxi"),a("barSize")]),SPREADSPARKLINE:i("This function returns a data set used for representing a spread sparkline",[a("points"),a("showAverage"),a("scaleStart"),a("scaleEnd"),a("style"),a("colorScheme"),a("vertical")]),STACKEDSPARKLINE:i("This function returns a data set used for representing a stacked sparkline",[a("points"),a("colorRange"),a("labelRange"),a("maximum"),a("targetRed"),a("targetGreen"),a("targetBlue"),a("tragetYellow"),a("color"),a("highlightPosition"),a("vertical"),a("textOrientation"),a("textSize")]),BOXPLOTSPARKLINE:i("This function returns a data set used for representing a boxplot sparkline",[a("points"),a("boxPlotClass"),a("showAverage"),a("scaleStart"),a("scaleEnd"),a("acceptableStart"),a("acceptableEnd"),a("colorScheme"),a("style"),a("vertical")]),CASCADESPARKLINE:i("This function returns a data set used for representing a cascade sparkline",[a("pointsRange"),a("pointIndex"),a("labelsRange"),a("minimum"),a("maximum"),a("colorPositive"),a("colorNegative"),a("vertical"),a("itemTypeRange"),a("colorTotal")]),PARETOSPARKLINE:i("This function returns a data set used for representing a pareto sparkline",[a("points"),a("pointIndex"),a("colorRange"),a("target"),a("target2"),a("highlightPosition"),a("label"),a("vertical"),a("targetColor"),a("target2Color"),a("labelColor"),a("barSize")]),MONTHSPARKLINE:i("This function returns a data set used for representing a month sparkline",[a("year"),a("month"),a("dataRange"),a("emptyColor"),a("startColor"),a("middleColor"),a("endColor")]),YEARSPARKLINE:i("This function returns a data set used for representing a year sparkline",[a("year"),a("dataRange"),a("emptyColor"),a("startColor"),a("middleColor"),a("endColor")]),GAUGEKPISPARKLINE:i("This function returns a data set used for representing a gauge KPI sparkline",[a("targetValue"),a("currentValue"),a("minValue"),a("maxValue"),a("showLabel"),a("targetValueLabel"),a("currentValueLabel"),a("minValueLabel"),a("maxValueLabel"),a("fontArray"),a("minAngle"),a("maxAngle"),a("radiusRatio"),a("gaugeType"),a("colorRange"),a("...")]),HISTOGRAMSPARKLINE:i("This function returns a data set used for representing a histogram sparkline",[a("dateRange"),a("continuous"),a("paintLabel"),a("scale"),a("barWidth"),a("barColor"),a("labelFontStyle"),a("labelColor"),a("edgeColor")]),"CEILING.PRECISE":i("This function rounds a number up to the nearest integer or to the nearest multiple of a specified value.",[a("number"),a(r)]),"COVARIANCE.S":i("This function returns the sample covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[a("array1"),a("array2")]),"FLOOR.PRECISE":i("This function rounds a number down to the nearest integer or to the nearest multiple of a specified value.",[a("number"),a(r)]),"PERCENTILE.EXC":i("This function returns the nth percentile of values in a range.",[a("array"),a("k")]),"QUARTILE.EXC":i("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[a("array"),a("quart")]),"RANK.AVG":i("This function returns the rank of a number in a set of numbers. If some values have the same rank, it will return the average rank.",[a("number"),a("ref"),a("[order]")]),"MODE.MULT":i("This function returns the most frequently occurring vertical array or the most frequently occurring value in a set of data.",[a("number1"),a("number2",!0)]),"STDEV.P":i("This function returns the standard deviation for an entire specified population (of numeric values).",[a("number1"),a("number2",!0)]),"VAR.P":i("This function returns variance based on the entire population, which uses only numeric values.",[a("number1"),a("number2",!0)]),"COVARIANCE.P":i("This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[a("array1"),a("array2")]),"MODE.SNGL":i("This function returns the most frequently occurring value in a set of data.",[a("number1"),a("number2",!0)]),"PERCENTILE.INC":i("This function returns the nth percentile of values in a range.",[a("array"),a("k")]),"QUARTILE.INC":i("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[a("array"),a("quart")]),"RANK.EQ":i("This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[a("number"),a("ref"),a("[order]")]),STDEV:i("This function returns standard deviation is estimated based on a sample.",[a("number1"),a("number2",!0)]),"STDEV.S":i("This function returns standard deviation is estimated based on a sample.",[a("number1"),a("number2",!0)]),"VAR.S":i("This function returns the variance based on a sample of a population, which uses only numeric values.",[a("number1"),a("number2",!0)]),"BETA.INV":i("This function calculates the inverse of the cumulative beta distribution function.",[a("probability"),a("alpha"),a("beta"),a("[lower]"),a("[upper]")]),"BINOM.DIST":i("This function calculates the individual term binomial distribution probability.",[a("number_s"),a("trials"),a("probability_s"),a("cumulative")]),"BINOM.INV":i("This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[a("trials"),a("probability_s"),a("alpha")]),"CHISQ.DIST.RT":i("This function calculates the one-tailed probability of the chi-squared distribution.",[a("value"),a("deg_freedom")]),"CHISQ.INV.RT":i("This function calculates the inverse of the one-tailed probability of the chi-squared distribution.",[a("probability"),a("deg_freedom")]),"CHISQ.TEST":i("This function calculates the test for independence from the chi-squared distribution.",[a("actual_range"),a("expected_range")]),"CONFIDENCE.NORM":i("This function returns confidence interval for a population mean.",[a("alpha"),a("standard_dev"),a("size")]),"EXPON.DIST":i("This function returns the exponential distribution or the probability density.",[a("value"),a("lambda"),a("cumulative")]),"F.DIST.RT":i("This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[a("value"),a("deg_freedom1"),a("deg_freedom2")]),"F.INV.RT":i("This function returns the inverse of the F probability distribution.",[a("probability"),a("deg_freedom1"),a("deg_freedom2")]),"F.TEST":i("This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[a("array1"),a("array2")]),"GAMMA.DIST":i("This function returns the gamma distribution.",[a("x"),a("alpha"),a("beta"),a("cumulative")]),"GAMMA.INV":i("This function returns the inverse of the gamma cumulative distribution.",[a("probability"),a("alpha"),a("beta")]),"LOGNORM.INV":i("This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[a("probability"),a("mean"),a("standard_dev")]),"NORM.DIST":i("This function returns the normal cumulative distribution for the specified mean and standard deviation.",[a("x"),a("mean"),a("standard_dev"),a("cumulative")]),"NORM.INV":i("This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[a("probability"),a("mean"),a("standard_dev")]),"NORM.S.INV":i("This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[a("probability")]),"PERCENTRANK.INC":i("This function returns the rank of a value in a data set as a percentage of the data set.",[a("array"),a("n"),a(r)]),"POISSON.DIST":i("This function returns the Poisson distribution.",[a("nevents"),a("mean"),a("cumulative")]),"T.INV.2T":i("This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[a("probability"),a("deg_freedom")]),"T.TEST":i("This function returns the probability associated with a t-test.",[a("array1"),a("array2"),a("tails"),a("type")]),"WEIBULL.DIST":i("This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[a("x"),a("alpha"),a("beta"),a("cumulative")]),"Z.TEST":i("This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[a("array"),a("x"),a("[sigma]")]),"T.DIST.RT":i("This function returns the right-tailed t-distribution.",[a("x"),a("deg_freedom")]),"T.DIST.2T":i("This function returns the two-tailed t-distribution.",[a("x"),a("deg_freedom")]),"ISO.CEILING":i("This function returns a number up to the nearest integer or to the nearest multiple of significance, regardless of sign of significance.",[a("number"),a(r)]),"BETA.DIST":i("This function returns the beta distribution.",[a("x"),a("alpha"),a("beta"),a("cumulative"),a("lower"),a("upper")]),"GAMMALN.PRECISE":i("This function returns the natural logarithm of the gamma function.",[a("value")]),"ERF.PRECISE":i("This function returns the error function.",[a("lowerlimit")]),"ERFC.PRECISE":i("This function returns the complementary ERF function.",[a("lowerlimit")]),"PERCENTRANK.EXC":i("This function returns the percentage rank(0..1, exclusive) of a value in a data set.",[a("array"),a("x"),a(r)]),"HYPGEOM.DIST":i("This function returns the hypergeometric distribution.",[a("sample_s"),a("number_sample"),a("population_s"),a("number_pop"),a("cumulative")]),"LOGNORM.DIST":i("This function returns the log normal distribution of x.",[a("x"),a("mean"),a("stdev"),a("cumulative")]),"NEGBINOM.DIST":i("This function returns the negative binomial distribution.",[a("number_f"),a("number_s"),a("probability_s"),a("cumulative")]),"NORM.S.DIST":i("This function returns the standard normal distribution.",[a("z"),a("cumulative")]),"T.DIST":i("This function returns the t-distribution.",[a("x"),a("deg_freedom"),a("cumulative")]),"F.DIST":i("This function returns the F probability distribution.",[a("x"),a("deg_freedom1"),a("deg_freedom2"),a("cumulative")]),"CHISQ.DIST":i("This function returns the chi-squared distribution.",[a("x"),a("deg_freedom"),a("cumulative")]),"F.INV":i("This function returns the inverse of the F probability distribution.",[a("probability"),a("deg_freedom1"),a("deg_freedom2")]),"T.INV":i("This function returns the left-tailed inverse of the t-distribution.",[a("probability"),a("deg_freedom")]),"CHISQ.INV":i("This function returns the inverse of left-tailed probability of the chi-squared distribution.",[a("probability"),a("deg_freedom")]),"CONFIDENCE.T":i("This function returns the confidence interval for a Student's t distribution.",[a("alpha"),a("standard_dev"),a("size")]),"NETWORKDAYS.INTL":i("This function returns the number of workdays between two dates using arguments to indicate holidays and weekend days.",[a("start_date"),a("end_date"),a("[weekend]"),a("[holidays]")]),"WORKDAY.INTL":i("This function returns the serial number of the date before or after a number of workdays with custom weekend parameters. These parameters indicate weekend days and holidays.",[a("start_date"),a("days"),a("[weekend]"),a("[holidays]")]),REFRESH:i("This function decides how to re-calculate the formula. Can use the evaluateMode argument to specific the formula re-calculate on the reference value changed, evaluate once , re-calculate or interval.",[a("formula"),a("evaluateMode"),a("interval")]),DAYS:i("This function returns the number of days between two dates.",[a("end_date"),a("start_date")]),ISOWEEKNUM:i("This function returns the number of the ISO week number of the year for a given date.",[a("date")]),BITAND:i('This function returns a bitwise "AND" of two numbers.',[a("number1"),a("number2")]),BITLSHIFT:i('This function returns a bitwise "OR" of two numbers.',[a("number"),a("shift_amount")]),BITOR:i('This function returns a bitwise "OR" of two numbers.',[a("number1"),a("number2")]),BITRSHIFT:i('This function returns a bitwise "OR" of two numbers.',[a("number"),a("shift_amount")]),BITXOR:i('This function returns a bitwise "XOR" of two numbers.',[a("number1"),a("number2")]),IMCOSH:i("This function returns the hyperbolic cosine of a complex number in x+yi or x+yj text format.",[a("complexnum")]),IMCOT:i("This function returns the cotangent of a complex number in x+yi or x+yj text format.",[a("complexnum")]),IMCSC:i("This function returns the cosecant of a complex number in x+yi or x+yj text format.",[a("complexnum")]),IMCSCH:i("This function returns the hyperbolic cosecant of a complex number in x+yi or x+yj text format.",[a("complexnum")]),IMSEC:i("This function returns the secant of a complex number in x+yi of x+yj text format.",[a("complexnum")]),IMSECH:i("This function returns the hyperbolic secant of a complex number in x+yi or x+yj text format.",[a("complexnum")]),IMSINH:i("This function returns the hyperbolic sine of a complex number in x+yi of x+yj text format.",[a("complexnum")]),IMTAN:i("This function returns the tangent of a complex number in x+yi or x+yj text format.",[a("complexnum")]),PDURATION:i("This function returns the number of periods required by an investment to reach a specified value.",[a("rate"),a("pval"),a("fval")]),RRI:i("This function returns an equivalent interest rate for the growth of an investment.",[a("nper"),a("pval"),a("fval")]),ISFORMULA:i("This function tests whether contains a formula of a referenced cell.",[a("cellreference")]),IFNA:i("This function returns the value you specify if the formula returns the #N/A error value, otherwise returns the result of the formula.",[a("value"),a("value_if_na")]),IFS:i("This function checks whether one or more conditions are met and returns a value that corresponds to the first TRUE condition.",[a("logical_test1"),a("value_if_true1",!0)]),SWITCH:i("This function evaluates one value (called the expression) against a list of values, and returns the result corresponding to the first matching value. If there is no match, an optional default value may be returned.",[a("expression"),a("value1"),a("result1"),a("[default_or_value2]",!0),a("[result2]",!0)]),XOR:i("This function returns a logical exclusive or of all arguments.",[a("logical",!0)]),AREAS:i("This function returns the number of areas in a reference.",[a("reference")]),FORMULATEXT:i("This function returns a formula as a string.",[a("reference")]),HYPERLINK:i("This function creates a shortcut or jump that opens a document stored on a network server, an intranet, or the Internet.",[a("link_location"),a("friendly_name")]),ACOT:i("This function calculates the inverse arccotangent of a number.",[a("number")]),ACOTH:i("This function calculates the inverse hyperbolic arccotangent of a number.",[a("number")]),ARABIC:i("This function converts a Roman numeral text to an Arabic numeral equivalent.",[a("text")]),BASE:i("This function converts a number into a text representation with the given radix (base).",[a("number"),a("radix"),a("[min_length]")]),"CEILING.MATH":i("This function round  a number up to the nearest integer or to the nearest multiple of significance.",[a("number"),a(r),a("[mode]")]),COMBINA:i("This function calculates the number of possible combinations with repetitions for a specified number of items.",[a("number"),a("number_chosen")]),COT:i("This function returns the cotangent of the specified angle.",[a("angle")]),COTH:i("This function returns the hyperbolic cotangent of the specified number.",[a("value")]),CSC:i("This function returns the cosecant of the specified angle.",[a("angle")]),CSCH:i("This function returns the hyperbolic cosecant of the specified number.",[a("value")]),DECIMAL:i("This function converts a text representation of a number in a given base into a decimal number.",[a("text"),a("radix")]),"FLOOR.MATH":i("This function round a number down to the nearest integer or to the nearest multiple of significance.",[a("number"),a(r),a("[mode]")]),SEC:i("This function returns the secant of the specified angle.",[a("angle")]),SECH:i("This function returns the hyperbolic secant of the specified value.",[a("value")]),"BINOM.DIST.RANGE":i("This function calculates the probability of a trial result using a binomial distribution.",[a("trials"),a("probability_s"),a("number_s"),a("[number_s2]")]),GAMMA:i("This function returns the gamma function value.",[a("number")]),MAXIFS:i("This function returns the maximum value among cells specified by a given set of conditions or criteria.",[a("max_range"),a("criteria_range",!0),a("criteria",!0)]),GAUSS:i("This function calculates the probability that a member of a standard normal population will fall between the mean and z standard deviations from the mean.",[a("number")]),MINIFS:i("This function returns the minimum value among cells specified by a given set of conditions or criteria.",[a("min_range"),a("criteria_range",!0),a("criteria",!0)]),PERMUTATIONA:i("This function returns the number of permutations for a given number of object that can be selected from the total objects.",[a("number"),a("number_chosen")]),PHI:i("This function returns the value of the density function for a standard normal distribution.",[a("value")]),"SKEW.P":i("This function returns the skewness of a distribution base on a poopulation: a characterization of the degree of asymmetry of a distribution around its mean.",[a("number1"),a("number2",!0)]),BAHTTEXT:i('This function converts a number to Thai text and adds a suffix of "Baht"',[a("number")]),CONCAT:i('This function combines multiple text strings or numbers into one text string, the function will stay available for compatibility with "CONCATENATE" function.',[a("text1"),a("text2",!0)]),FINDB:i("This function finds one text value within another and returns the text value's position in the text you searched, and counts each double-byte characte as 2 when set DBCS as the default language.",[a("find_text"),a("within_text"),a(n)]),LEFTB:i("This function returns the specified leftmost characters from a text value, and based on the number of bytes you specify.",[a("text"),a("num_bytes")]),LENB:i("This function returns the length of the number of bytes in a text string.",[a("text")]),MIDB:i("This function returns the requested number of characters from a text string starting at the position you specify, and based on the number of bytes you specify.",[a("text"),a("start_num"),a("num_bytes")]),REPLACEB:i("This function replaces part of a text string with a different text string, based on the number of bytes you specify.",[a("old_text"),a("start_byte"),a("num_bytes"),a("new_text")]),RIGHTB:i("This function returns the specified rightmost characters from a text value, and based on the number of bytes you specify.",[a("text"),a("num_bytes")]),SEARCHB:i("This function finds one text string in another text string and returns the index of the starting position of the found text, and counts each double-byte characte as 2 when set DBCS as the default language.",[a("find_text"),a("within_text"),a(n)]),TEXTJOIN:i("This function combines multiple ranges and/or strings into one text, and the text includes a delimiter you specify between each text value.",[a("delimiter"),a("ignore_empty"),a("text1"),a("text2",!0)]),UNICHAR:i("This function returns the Unicode character of a given numeric reference.",[a("number")]),UNICODE:i("This function returns the number corresponding to the first character of the text.",[a("text")]),ENCODEURL:i("This function returns a URL-encoded string.",[a("text")]),BC_QRCODE:i("This function returns a data set for representing a QRCode",[a("value"),a("color"),a("backgroundColor"),a("errorCorrectionLevel"),a("model"),a("version"),a("mask"),a("connection"),a("connectionNo"),a("charCode"),a("charset"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_EAN13:i("This function returns a data set for representing a EAN13.",[a("value"),a("color"),a("backgroundColor"),a("showLabel"),a("labelPosition"),a("addOn"),a("addOnLabelPosition"),a("fontFamily"),a("fontStyle"),a("fontWeight"),a("textDecoration"),a("textAlign"),a("fontSize"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_EAN8:i("This function returns a data set for representing a EAN8.",[a("value"),a("color"),a("backgroundColor"),a("showLabel"),a("labelPosition"),a("fontFamily"),a("fontStyle"),a("fontWeight"),a("textDecoration"),a("textAlign"),a("fontSize"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_CODABAR:i("This function returns a data set for representing a CODABAR.",[a("value"),a("color"),a("backgroundColor"),a("showLabel"),a("labelPosition"),a("checkDigit"),a("nwRatio"),a("fontFamily"),a("fontStyle"),a("fontWeight"),a("textDecoration"),a("textAlign"),a("fontSize"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_CODE39:i("This function returns a data set for representing a CODE39.",[a("value"),a("color"),a("backgroundColor"),a("showLabel"),a("labelPosition"),a("labelWithStartAndStopCharacter"),a("checkDigit"),a("nwRatio"),a("fullASCII"),a("fontFamily"),a("fontStyle"),a("fontWeight"),a("textDecoration"),a("textAlign"),a("fontSize"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_CODE93:i("This function returns a data set for representing a CODE93.",[a("value"),a("color"),a("backgroundColor"),a("showLabel"),a("labelPosition"),a("checkDigit"),a("fullASCII"),a("fontFamily"),a("fontStyle"),a("fontWeight"),a("textDecoration"),a("textAlign"),a("fontSize"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_CODE128:i("This function returns a data set for representing a CODE128.",[a("value"),a("color"),a("backgroundColor"),a("showLabel"),a("labelPosition"),a("codeSet"),a("fontFamily"),a("fontStyle"),a("fontWeight"),a("textDecoration"),a("textAlign"),a("fontSize"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_GS1_128:i("This function returns a data set for representing a GS1_128.",[a("value"),a("color"),a("backgroundColor"),a("showLabel"),a("labelPosition"),a("fontFamily"),a("fontStyle"),a("fontWeight"),a("textDecoration"),a("textAlign"),a("fontSize"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_CODE49:i("This function returns a data set for representing a CODE49.",[a("value"),a("color"),a("backgroundColor"),a("showLabel"),a("labelPosition"),a("grouping"),a("groupNo"),a("fontFamily"),a("fontStyle"),a("fontWeight"),a("textDecoration"),a("textAlign"),a("fontSize"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_PDF417:i("This function returns a data set for representing a PDF417.",[a("value"),a("color"),a("backgroundColor"),a("errorCorrectionLevel"),a("rows"),a("columns"),a("compact"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_DATAMATRIX:i("This function returns a data set for representing a DATAMATRIX.",[a("value"),a("color"),a("backgroundColor"),a("eccMode"),a("ecc200SymbolSize"),a("ecc200EncodingMode"),a("ecc00_140SymbolSize"),a("structuredAppend"),a("structureNumber"),a("fileIdentifier"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),FILTER:i("This function filter a range or array.",[a("array"),a("include"),a("if_empty")]),RANDARRAY:i("This function returns an array of random numbers.",[a("rows"),a("columns"),a("min"),a("max"),a("whole_number")]),SEQUENCE:i("This function returns a sequence of numbers.",[a("rows"),a("columns"),a("start"),a("step")]),SINGLE:i("This function returns a single value when given a value, range or array.",[a("value")]),SORT:i("This function sorts a range or array.",[a("array"),a("sort_index"),a("sort_order"),a("by_col")]),SORTBY:i("This function sorts a range or array based on the values in a corresponding range or array.",[a("array"),a("by_array1"),a("sort_order1"),a("by_array2",!0),a("sort_order2",!0)]),UNIQUE:i("This function returns the unique values from a range or array.",[a("array"),a("by_col"),a("exactly_once")]),LET:i("This function assigns calculation results to names. Useful for storing intermediate calculations and values by defining names inside a formula. These names only apply within the scope of the LET function.",[a("name1"),a("name_value1"),a("calculation_or_name2"),a("[name_value2, ...")]),IMAGE:i("This function input an URL or a base64 string to show an image in cell",[a("URL"),a("[mode]"),a("[height]"),a("[width]"),a("[clipY]"),a("[clipX]"),a("[clipHeight]"),a("[clipWidth]"),a("[vAlign]"),a("[hAlign]")]),GETPIVOTDATA:i("This function extracts data stored in a PivotTable",[a("data_field"),a("pivot_table"),a("[field1, item1]"),a("...")]),WEBSERVICE:i("This function returns data from a web service",[a("url")]),FILTERJSON:i("This function parses json string to a scalar value, an object or an array of objects.",[a("json_string")])},Fbx_Summary:"Summary",Fbx_TableName_Description:"Table name for ",Fbx_TableSheetName_Description:"TableSheet name for ",Fbx_CustomName_Description:"Custom name for ",B2:{All:{name:"#All",description:"Returns the entire contents of the table, or specified table columns including column headers, data and total rows."},Data:{name:"#Data",description:"Returns the data cells of the table or specified table columns."},Headers:{name:"#Headers",description:"Returns the columns headers for the table, or specified table columns."},Totals:{name:"#Totals",description:"Returns the total rows for the table or specified table columns."},thisRow:{name:"#This Row",description:"This row."}}}},"./src/evaluator.ts":function(t,e,o){"use strict";var _,M,a,m,O,F,y,b,l,r,s,P,L,C,T,I,H,u,c,i,h,v,n,f,p,d,g,w,x,A,S=this&&this.__extends||(x=function(t,e){return(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}x(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function B(t,e,o,n){return{row:t,col:e,rowCount:o,colCount:n}}function N(t,e){var o,n,r,i=t.getRangeCount(),a=t._source,s=e.source.getCalcSourceModel().qg(e.identity.row,e.identity.col,!0);for(o=0;o<i;o++)(n=t._identities[o]).id=a.id,a.getRangeKey&&(r=a.getRangeKey(a,n),s&&(s.eOb||(s.eOb={}),s.eOb[r]=n))}function R(t,e,o,n,r,i,a,s){var l=A.call(this,t,isNaN(s)?O:{row:a,col:s},e,isNaN(i)?O:{row:o,col:n,rowCount:r,colCount:i})||this,u=t.Cf().getGlobalSourceModel(t);return l.yi=u&&u.getSource(),l}function k(t,e){this.id=t.si++,this.ctx=t,this.row=t.row+(t.arrayFormulaMode&&t.rowOffset||0),this.col=t.column+(t.arrayFormulaMode&&t.columnOffset||0),this.node=e}function E(t,e,o,n,r){var i,a,s=[];for(i=5;i<arguments.length;i++)s[i-5]=arguments[i];this.si=0,this.ti=0,this.ui=0,(a=this).source=t,a.arrayFormulaMode=!!o,a.identity=e||a.$Ab(0,0),a.arrayIdentity=n,a.row=n?n.row:a.identity.row||0,a.column=n?n.col:a.identity.col||0,a.rowOffset=n?a.identity.row-n.row:a.row,a.columnOffset=n?a.identity.col-n.col:a.column,a.Lf=r}function D(t){this.w5=[],this.x5=-1,this.y5={},this.lh=t,this.vQa=0}function j(t,e){this.id=t,this.Fi=F,this.v5=!1,this.oi=[],e!==F&&(this.evaluateMode=e)}function V(t){this.service=t,this.asyncManager=new n(this)}function z(t){var e,o;for(o=0;o<t.oi.length;o++)(e=t.oi[o]).v5=!1,0<e.oi.length&&z(e)}function W(t){var e,o=!0,n=t;return t&&t.getValue&&((e=s(t,0,!1,!1)).isError?n=e[0]:1===e.rowCount&&1===e.colCount?n=e[0][0]:(n=e,o=!1)),{value:n,success:o}}function G(t,e,o){return r(e)?e:r(o)?o:(t<=2?function(t,e,o){var n,r,i,a,s,l,u,c;if(!e)return 0;if((n=W(e)).success)return U(t,n.value);if(o){for(r=[],i=n.value,a=i.rowCount,s=i.colCount,l=0;l<a;l++)for(u=r[l]=[],c=0;c<s;c++)u[c]=U(t,i[l][c]);return new M.CalcArray(r)}}:t<=14?function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b;if(n=t<=7?U:8===t?J:Z,r=W(e),i=W(o),r.success&&i.success)return n(t,r.value,i.value);if(e=r.value,o=i.value,a=r.success?-1:e.rowCount,s=r.success?-1:e.colCount,l=i.success?-1:o.rowCount,u=i.success?-1:o.colCount,h=c=-1,r.success||i.success)h=r.success?(c=l,u):(c=a,s);else{if(1!==a&&1!==l&&a!==l||1!==s&&1!==u&&s!==u)return H;c=1===a?l:a,h=1===s?u:s}for(f=[],p=0;p<c;p++)for(f[p]=[],d=0;d<h;d++)!r.success&&(1!==a&&a<c||1!==s&&s<h)||!i.success&&(1!==l&&l<c||1!==u&&u<h)?f[p][d]=H:(g=1===a?0:p,m=1===s?0:d,y=1===l?0:p,b=1===u?0:d,f[p][d]=n(t,r.success?e:e[g][m],i.success?o:o[y][b]));return new M.CalcArray(f)}:function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g;if(!e||!o||(1!==e.getRangeCount()||1!==o.getRangeCount())&&16!==t||e.endSource||o.endSource)return T;if(!(n=e.getSource())||n!==o.getSource())return T;if(16===t)r=e._identities.concat(o._identities);else{if(i=15===t?y:b,a=15===t?b:y,s=e.getRow(0),l=e.getColumn(0),u=o.getRow(0),c=o.getColumn(0),h=i(s,u),f=i(l,c),p=a(s+e.getRowCount(0),u+o.getRowCount(0))-h,d=a(l+e.getColumnCount(0),c+o.getColumnCount(0))-f,p<1||d<1)return M.Errors.Null;r=[B(h,f,p,d)]}return(g=new M.CalcReference(n,r)).ck=!0,g})(t,e,o)}function U(t,e,o){var n,r,i,a;function s(t){return"string"==typeof t&&0===t.trim().length}if(s(e)||s(o))return T;if(!l(e,n={value:0}))return 0===t&&"string"==typeof e||e instanceof M.CalcError?e:T;if(r=n.value,o!==F){if(!l(o,n))return o instanceof M.CalcError?o:T;i=n.value}else i=0;return 0===t?r:1===t?-r:2===t?r/100:3===t?M.Zh.Yh(r,-i)?0:r+i:4===t?M.Zh.Yh(r,i)?0:r-i:5===t?_.Common.o.Lma(r*i,M.Functions.CALC_PRECISION||15):6===t?i?r/i:u:7===t?!r&&i<0?u:0===r&&0===i?c:(a=M.Functions.MathHelper.YDc(r,i))===Number.POSITIVE_INFINITY||a===Number.NEGATIVE_INFINITY||isNaN(a)?c:a:void 0}function J(t,e,o){if(8===t)return r(e)?e:r(o)?o:M.Convert.bc(e)+M.Convert.bc(o)}function Z(t,e,o){var n=M.gOb(e,o,!1);return r(n)?n:9===t&&0===n||10===t&&0!==n||11===t&&n<0||12===t&&n<=0||13===t&&0<n||14===t&&0<=n}function q(t,e){var o,n,r,i=!0;switch(e.Hi){case 0:o=f(t),n=!0;break;case 1:o=parseFloat(t),n=!0;break;case 2:o=p(t),n=!0;break;case 3:o=parseInt(t,10),n=!0;break;case 4:(o=s(t,e.Ii,e.Ji||!1,e.Ki||!1,e.Li||!1,e.Mi,e.xTa,e.hOb)).isError&&(o=o[0],i=!1),o.isConvertError&&(o=T,i=!1);break;case 5:o=d(t),e.Ni&&""===o&&(o=T,i=!1);break;case 6:g(t,r={value:O})?o=r.value:(o=T,i=!1);break;case 7:o=w(t);break;case 8:!(o=M.Functions.Wi(t))||e.Oi&&0===o.Pi()&&0===o.Qi()?(o=M.Errors.Number,i=!1):o={Ri:o.Pi(),Si:o.Qi()};break;default:o=t}return n&&isNaN(o)&&(o=T,i=!1),{Ti:o,Ei:i}}function K(t,e,o){var n,r,i,a,s;for(Array.isArray(e)||(e=[e]),n=t.Ti,r=0;r<e.length;r++)if(a=(i=e[r].split(" "))[0],s=parseInt(i[1],10),"<"===a&&n<s||">"===a&&s<n||"<="===a&&n<=s||">="===a&&s<=n||"="===a&&n===s||"!="===a&&n!==s||"checkLength"===a&&n.length>s)return t.Ti=o===F?M.Errors.Number:o,t.Ei=!1}Object.defineProperty(e,"__esModule",{value:!0}),_=o("Common"),M=o("./src/calc.common.ts"),a=o("./src/calc.ts"),m=_.Common.j.Fa,O=null,F=void 0,Math.pow,y=Math.min,b=Math.max,l=M.Convert.Th,r=M.Convert.vf,s=M.Convert.Ph,P=M.Convert.Ca,L=M.Convert._isReference,C=M.Errors.Reference,T=M.Errors.Value,I=M.Errors.Name,H=M.Errors.NotAvailable,u=M.Errors.DivideByZero,c=M.Errors.Number,E.prototype.$Ab=function(t,e){return{row:t,col:e}},E.prototype.fga=function(t){return t===M.BangSource?this.source:t},E.prototype.getValue=function(t,e){return t?this.fga(t).getValue(e):C},E.prototype.getReference=function(t,e){return t?this.fga(t).getReference(e):C},E.prototype.getSheetRangeReference=function(t){return!t||!t.source||!t.endSource||t.source instanceof M.ErrorSource?C:this.fga(t.source).getSheetRangeReference(t)},E.prototype.getFunction=function(t){return this.source?this.source.getCustomFunction(t):O},E.prototype.getName=function(t){var e,o=this.source?this.source.getCustomName(t):O;return!o&&this.source&&(o=(e=this.source.Cf().getGlobalSourceModel())&&e.getSource().getCustomName(t)),o},E.prototype.getField=function(t){return this.source?this.source.getField(t):O},E.prototype.vi=function(){return 0<this.ui},E.prototype.wi=function(){this.ui++},E.prototype.xi=function(){this.ui--},E.prototype.SetAsyncResult=function(t,e){this.source.Cf().lh.SetAsyncResult(t,e)},E.prototype.cloneFrom=function(t){this.acceptsReference=t.acceptsReference,this.arrayFormulaMode=t.arrayFormulaMode},i=E,e.EvaluateContext=i,M.CalcSource.prototype.getEvaluatorContext=function(t,e,o,n){return new i(this,t,e,o,n)},k.prototype.setAsyncResult=function(t){this.node.Fi=t,this.node.v5=!0,this.ctx.SetAsyncResult(this,t),this.ctx.source.refresh()},k.prototype.getFormula=function(){return this.ctx.source.getCalcService().unparse(this.ctx.source,this.expression,this.row,this.col)},k.prototype.DIc=function(){var t,e=this.node&&this.node.parent&&this.node.parent.oi||[];for(t=0;t<e.length;t++)if(!e[t].v5)return!1;return!0},h=k,e.AsyncEvaluateContext=h,S(R,A=i),R.prototype.getName=function(t){return this.yi?this.yi.getCustomName(t):O},e.GloableEvaluateContext=R,V.prototype.evaluateExpression=function(t,e,o,n,r){var i,a,s=void 0===t.type&&t.Lf?t.Lf:t,l=this.evaluate(s,e,!!n,!!r);return l&&l.pause?l:l===F||l===O?!1===o?l:0:((P(l)&&!n||L(l)&&!r)&&(l=this.getOneValue(e,l)),i=15,"number"==typeof l&&-10<l&&l<10&&(1<(a=""+l).indexOf("000000000000")||1<a.indexOf("999999999999"))&&(i=14),_.Common.o.Lma(l,M.Functions.CALC_PRECISION||i))},V.prototype.evaluate=function(t,e,o,n){var r,i,a;if(!t)throw M.sR().Exp_ExprIsNull;if(void 0===t.type){if(t._error)return t;t.Lf&&(t=t.Lf)}for(;10===t.type;)t=t.value;if(i=O,12===t.type?(i=t.needExpendIndexs,t=t.value):e.Exb&&(o=!0,i=[]),2<=(a=t.type)&&a<=6)r=this.evaluateConst(t,e,o);else if(1===a||13===a||33===a)r=this.evaluateReference(t,e,n,o);else if(8===a)r=this.evaluateName(t,e,o,n);else if(t&&100===t.type)r=this.evaluateLocalName(t,e,o,n);else if(9!==a||t.value2){if(9===a)r=this.evaluateBinaryOperation(t,e,o,n,i);else if(7===a){if(t.QDc&&e.NMc&&(r=this.evaluateBranchFunction(t,e,o,n,i))&&r.pause)return r;r=this.evaluateFunction(t,e,o,n,i)}else if(11===a)r=F;else if(14===a)r=this.evaluateField(t,e);else if(e.evaluate)return e.evaluate(t,o,n)}else r=this.evaluateUnaryOperation(t,e,o,n,i);return r},V.prototype.evaluateLocalName=function(t,e,o,n){var r,i,a;if(e.letContext)for(r=t.value,i=e.letContext.length-1;0<=i;i--)if((a=e.letContext[i])[r]!==F)return a[r];return t.type=8,delete t.bhc,this.evaluate(t,e,o,n)},V.prototype.evaluateConst=function(t,e,o){var n=t.value;return!P(n)||o||e&&(e.arrayFormulaMode||e.vi())?n:n.getValue(0,0)},V.prototype.evaluateReference=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v;if(!e)return T;if(r=t.source||e.source,i=isNaN(e.row)?0:e.row,a=isNaN(e.column)?0:e.column,s=t.getRange&&t.getRange(i,a),l=t.type,!s)return 13===l?T:C;if(33===l&&s.isSpillError)return M.Errors.Spill;if(u=s.row<0?0:s.row,c=s.col<0?0:s.col,h=s.rowCount,f=s.colCount,n&&(p=r.getRowCount(),d=r.getColumnCount(),(-1===h||p<h)&&(h=p),(-1===f||d<f)&&(f=d)),o||e.arrayFormulaMode)return t.endSource?e.getSheetRangeReference({source:t.source,endSource:t.endSource,row:u,col:c,rowCount:h,colCount:f}):e.getReference(r,s);if(n&&(1<h||1<f)){for(g=[],m=0;m<h;m++)for(g[m]=[],y=0;y<f;y++)g[m][y]=r.getValue(m+u,y+c);return new M.CalcArray(g)}if(1<h||1<f)if(b=i>=s.row&&i<s.row+h,v=a>=s.col&&a<s.col+f,b&&v)u=i,c=a;else{if(!b&&!v)return T;if(b&&1===f)u=i;else{if(!v||1!==h)return T;c=a}}else if(-1===s.row&&-1===h){if(1!==f)return T;u=i}else if(-1===s.col&&-1===f){if(1!==h)return T;c=a}return r.getValue(u,c)},V.prototype.evaluateName=function(t,e,o,n){var r,i;return e?(t.source&&(e=t.source.getEvaluatorContext(e.identity,e.arrayFormulaMode,e.arrayIdentity)),(r=e.getName(t.value))?(i=a.Mh(e,r,!1,0,0,o,n),this.evaluate(i,e,o,n)):I):I},V.prototype.evaluateUnaryOperation=function(e,o,t,n,r){var i,a=!1;return r&&0<r.length&&(a=t=!0),(i=this.evaluate(e.value,o,t,a))&&i.pause||M.Convert.vf(i)?i:i===M.missingArgument?H:this.evaluateWithArgs(e,function(t){return t[0]&&t[0].getRowCount&&o.Exb&&o.Lf&&(o.Lf.hJc=!0),G(e.operatorType,t[0],o.Exb)},o,r,[i],t,n)},V.prototype.evaluateBinaryOperation=function(e,o,t,n,r){var i,a,s,l,u,c,h,f,p;if(o.Exb&&(t=!0),i=[t,t],s=[a=15<=e.operatorType,a],r&&0<r.length)for(l=0;l<r.length;l++)i[r[l]]=!0,s[r[l]]=!0;for(u=function(t,e){if(0===e){for(;10===t.type;)t=t.value;if(7===t.type&&t.function&&t.function.TAb)return null}return e},c=[e.value,e.value2],h=[],l=0;l<2;l++){if((f=this.evaluate(c[l],o,i[l],s[l]))&&f.pause)return f;if(p=u(c[l],f),M.Convert.vf(p))return p;if(p===M.missingArgument)return H;h[l]=p}return this.evaluateWithArgs(e,function(t){return o.Lf&&(t[0]&&t[0].getRowCount||t[1]&&t[1].getRowCount)&&(o.Lf.hJc=!0),G(e.operatorType,t[0],t[1])},o,r,h,t,n)},V.prototype.evaluateField=function(t,e){var o;return e?(t.source&&(e=t.source.getEvaluatorContext(e.identity,e.arrayFormulaMode,e.arrayIdentity)),o=e.getField(t.value),m(o)?H:o):I},V.prototype.startCache=function(){this.Bi={},this.service.nia&&this.asyncManager.startCalc()},V.prototype.endCache=function(){this.Bi=O},V.prototype.evaluateBranchFunction=function(t,e,o,n,r){var i,a,s,l,u,c,h;if(m(t.PDc))return i=t.function,a=t.arguments.length,s=i.findTestArgument(),u=(l=this.preprocessFunction(e,i,a,r,o)).acceptsArrays,c=l.keepArrayValuesFlagSet,(h=this.testArgGetBranch(e,i,t,u[s],!1,s))&&h.pause?h:(c&&delete e.Exb,0<=h.branchArgument&&"number"==typeof h.branchArgument?(t.PDc=!0,e.source.ODc=e.source.ODc||[],e.source.ODc.push(t),{pause:"Branch",branch:t.RDc[h.branchArgument]}):void(h.testArgValue._error||delete t.QDc))},V.prototype.evaluateLetFunction=function(t,e,o,n){var r,i,a,s,l,u,c,h,f=t.arguments.length;for(e.letContext=e.letContext||[],i={},a=1;a<f-1;a+=2){if(s=t.arguments[a-1],l=t.arguments[a],u=s.value,(c=e).letContext.push(i),(r=this.evaluate(l,c,o,n))&&r.pause)return r;e.letContext.pop(),i[u]=r}return e.letContext.push(i),(h=this.evaluate(t.arguments[f-1],e,o,n))&&h.pause||(e.letContext.pop(),0===e.letContext.length&&delete e.letContext),h},V.prototype.evaluateGetPivotDataFunction=function(t,e,o,n){var r,i,a=t.arguments,s=a[0].value,l=a[1],u=[],c=l.source||e.source,h=isNaN(e.row)?0:e.row,f=isNaN(e.column)?0:e.column,p=l.getRange(h,f),d=c.kj,g=d.pivotTables&&p&&d.pivotTables.findPivotTable(p.row,p.col);if(m(g))return C;for(r=2;r<a.length;r++){if(i=a[r],(i=this.evaluate(i,e,o,n))&&i.pause||i instanceof M.CalcError)return i;u.push(i)}return g.evaluateGetPivotDataFunction(s,u)},V.prototype.preprocessFunction=function(t,e,o,n,r){var i,a,s,l,u=[],c=[],h=t.Exb,f=!1,p=O;for(!h&&(1===e.arrayArgumentEvaluateMode||4===e.arrayArgumentEvaluateMode&&r)&&(h=t.Exb=!0,f=!0),i=0;i<o;i++)u[i]=e.acceptsArray(i),c[i]=e.acceptsReference(i);if(n&&0<n.length||h){for(p=[],i=0;i<o;i++)p[i]=!0;for(a=h?o:n.length,i=0;i<a;i++)u[s=h?i:n[i]]=!0,c[s]=!0,(l=!(e.acceptsReference(s)&&!e.acceptsArray(s)))&&h&&e.acceptsReference(s)&&(l=!1),p[s]=l}return e.isBranch()&&(t.arrayFormulaMode||t.vi())&&(u[e.findTestArgument()]=!0,c[e.findTestArgument()]=!0),{acceptsArrays:u,acceptsReferences:c,getReferenceValues:p,keepArrayValuesFlagSet:f}},V.prototype.testArgGetBranch=function(t,e,o,n,r,i){var a,s=-1,l=t.Exb;return t.arrayFormulaMode&&(t.Exb=!0),e.acceptsArray(i)&&t.wi(),(a=this.evaluate(o.arguments[i],t,n,r))&&a.pause?a:(e.acceptsArray(i)&&t.xi(),t.Exb=l,L(a)||P(a)||(s=e.findBranchArgument(a)),{testArgValue:a,branchArgument:s})},V.prototype.evaluateFunction=function(t,u,e,c,o){var n,h,f,p,r,i,a,s,l,d,g,m,y,b,v,C,w,x,T,A,S;if(!t||!t.function||"string"==typeof t.function)return I;if(n=t.arguments.length,h=this,f=u.ti,"LET"===t.functionName)return h.evaluateLetFunction(t,u,e,c);if(p=t.function,r=[],a=O,p instanceof M.Functions.AsyncFunction&&this.asyncManager.startCalcFunction(p,t,u),0!==n){if(d=(l=h.preprocessFunction(u,p,n,o,e)).acceptsArrays,g=l.acceptsReferences,a=l.getReferenceValues,s=l.keepArrayValuesFlagSet,b=y=m=void 0,p.isBranch()){if(y=p.findTestArgument(),(v=h.testArgGetBranch(u,p,t,d[y],g[y],y))&&v.pause)return v;m=v.testArgValue,b=v.branchArgument}for(C=0;C<n;C++){if(y===C)i=m;else{if(0<=b&&C!==b){r[C]=null;continue}if(p.acceptsArray(C)&&u.wi(),(i=h.evaluate(t.arguments[C],u,d[C],g[C]))&&i.pause)return i;p.acceptsArray(C)&&u.xi()}if(!p.acceptsArray(C)&&P(i)||!p.acceptsReference(C)&&L(i))if(w=P(i)?i:O,x=L(i)?i:O,w&&1===w.getRowCount()&&1===w.getColumnCount())i=w.getValue(0,0);else if(x&&1===x.getRowCount(0)&&1===x.getColumnCount(0))i=x.getValue(0,0,0);else{if(A=!(T=[]),o)for(S=0;S<o.length;S++)T.push(o[S]),o[S]===C&&(A=!0);A||(T.push(C),o=T)}if(M.Convert.vf(i)&&!p.acceptsError(C))return p instanceof M.Functions.AsyncFunction&&this.asyncManager.endCalcFunction(),i;i!==M.missingArgument||p.acceptsMissingArgument(C)||(i=O),(r[C]=i)&&"INDIRECT"!==t.functionName&&i.ck&&i._source&&N(i,u)}}return s&&delete u.Exb,h.evaluateWithArgs(t,function(t,e,o){var n,r,i,a,s,l=function(t,e){var o,n,r,i,a,s=[];if(!e)return{Di:t,Ei:!0};if(e.Xi)for(r=0;r<t.length;r++)s.push(e);else s=Array.isArray(e)?e:[e];for(n=0;n<s.length;n++){if((i=s[n]).Yi&&!t[n])throw M.sR().Exp_ArgumentNull;if(a=t[n]!==F){if(o=q(t[n],i),i.aj&&K(o,i.aj,i.bj),!o.Ei)break;t[n]=i.Zi?{$i:a,Qb:o.Ti}:o.Ti}else t[n]=i.Zi?{$i:a,Qb:i._i}:i._i}return o?{Di:t,Ei:o.Ei,Fi:o.Ti}:void 0}(t,p.Ci);return t=l.Di,l.Ei?p.isContextSensitive()?(u.acceptsReference=c||u.vi(),p instanceof M.Functions.AsyncFunction?(h.T4=h.T4||{},p.evaluateWhenArgumentsIsSame()?h.evaluateAsyncFunction(u,e,p,f,t,o):h.evaluateWithCache(p,t,function(){return h.evaluateAsyncFunction(u,e,p,f,t,o)},h.T4)):p.evaluateWithContext(u,t)):((r=u.arrayFormulaMode)&&(p.y0a={row:u.rowOffset,col:u.columnOffset}),i=M.getMapping()&&M.getMapping().builtInFunctionsMapping,a=i&&i[p.name]&&i[p.name].specialFun,s=function(){return a&&a.apply(p,t)||p.evaluate.apply(p,t)},n=r?h.evaluateWithCache(p,t,s,h.Bi):s(),delete p.y0a,n):l.Fi},u,o,r,e,c,a)},V.prototype.evaluateAsyncFunction=function(t,e,o,n,r,i){var a,s,l=this.asyncManager.getNode();if(l.v5)a=l.Fi;else if(l.canEvaluate()){if(s=new h(t,l),a=o.evaluateWithContext(s,r),s.notAsync)return a;a===F?a=l.Fi!==F?l.Fi:o.defaultValue():1===l.evaluateMode&&(l.v5=!0)}else a=l.Fi!==F?l.Fi:o.defaultValue();return l.Fi=a,i||this.asyncManager.endCalcFunction(),a},V.prototype.evaluateWithCache=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y;if(n)if(i=!1,r=n[t.name+e.length])for(a=0;a<r.length;a++){if(i=!1,(s=r[a]).args.length===e.length){for(i=!0,l=0;l<e.length;l++)if((u=s.args[l])!==(c=e[l])){if(!(u instanceof M.CalcReference&&c instanceof M.CalcReference)){i=!1;break}if(h=u.zf,u._source!==c._source||h!==c.zf){i=!1;break}for(f=0;f<h;f++)if(u.getRow(f)!==c.getRow(f)||u.getColumn(f)!==c.getColumn(f)||u.getRowCount(f)!==c.getRowCount(f)||u.getColumnCount(f)!==c.getColumnCount(f)){i=!1;break}}i&&(m=s.y0a,y=t.y0a,m&&y?m.row!==y.row||m.col!==y.col:m!==y)&&(i=!1)}if(i)return s.flag++,s.value}else r=n[t.name+e.length]=[];if(p=o(),n&&p!==F){if(100<=(d=r.length)){for(g=[],a=0;a<d;a++)0<r[a].flag&&g.push(r[a]);g.sort(function(t,e){return e.flag-t.flag}),d=Math.min(50,g.length),r=g.slice(0,d),n[t.name+e.length]=r}r.push({args:e,value:p,flag:0,y0a:t.y0a})}return p},V.prototype.SetAsyncResult=function(t){if(t.DIc()){var e=t.ctx;e.source.Cf().recalculate(e.source,t.row,t.col,!0)}},V.prototype.evaluateWithArgs=function(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d,g,m,y,b,v,C,w,x=o.Exb;if(!x||n&&0<n.length||(n=[],(l=7===t.type&&t.function)&&r.forEach(function(t,e){(!l.acceptsArray(e)&&P(t)||!l.acceptsReference(e)&&L(t))&&n.push(e)})),n&&0<n.length){if(!(c=this.Gi(o,t,r,n,s)))return H;for(h=[],f=c[0].length,p=c[0][0].length,d=0;d<f;d++)for(h[d]=[],g=0;g<p;g++)try{for(m=[],y=0;y<r.length;y++)m[y]=c[y][d][g];if(u=e(m,t,d+1!==f||g+1!==p),L(u)&&!x){if(7===t.type&&(l=t.function).returnReference&&l.returnReference())return u;u=this.getOneValue(o,u)}h[d][g]=u,o.Lf.hJc=!0}catch(t){h[d][g]=T}return new M.CalcArray(h,x)}try{if(u=e(r,t),15===t.operatorType&&u&&u.ck&&N(u,o),o.arrayFormulaMode&&o.vi())return u;if(P(u)&&!i)return this.getOneValue(o,u);if(!L(u)||a)return u;if(b=u,i&&1===b.getRangeCount()){for(v=[],C=0;C<b.getRowCount(0);C++)for(v[C]=[],w=0;w<b.getColumnCount(0);w++)v[C][w]=b.getValue(0,C,w);return new M.CalcArray(v)}return this.getOneValue(o,u)}catch(t){return T}},V.prototype.getOneValue=function(t,e){var o,n,r,i,a,s;return L(e)?(i=(r=e).getRowCount(0),a=r.getColumnCount(0),e=1<r.getRangeCount()||!t.arrayFormulaMode&&1<i&&1<a?T:(n=-1!==t.rowOffset||-1!==t.columnOffset?(o=1===i?0:t.arrayFormulaMode?t.rowOffset:t.rowOffset-r.getRow(0),1===a?0:t.arrayFormulaMode?t.columnOffset:t.columnOffset-r.getColumn(0)):(o=1===i?0:t.row-r.getRow(0),1===a?0:t.column-r.getColumn(0)),i<=o||a<=n?H:r.getValue(0,o,n))):P(e)&&(s=e,e=!t.arrayFormulaMode||-1===t.rowOffset&&-1===t.columnOffset?s.getValue(0,0):(o=1===s.getRowCount()?0:t.rowOffset,n=1===s.getColumnCount()?0:t.columnOffset,o>=s.getRowCount()||n>=s.getColumnCount()?H:s.getValue(o,n))),L(e)||P(e)?this.getOneValue(t,e):e},V.prototype.Gi=function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A=1,S=1,M=-1,I=!0,N=!0,R=1,k=1,E=7===e.type?e:O,D=E&&E.function,j=t.arrayFormulaMode||t.source&&t.source._service&&t.source._service.allowDynamicArray;if(D&&!D.expandRows()&&(I=!1),D&&!D.expandColumns()&&(N=!1),D&&D.isBranch()&&(j||t.vi())){if(M=D.findTestArgument(),l=!(s=[]),n)for(u=0;u<n.length;u++)s.push(n[u]),n[u]===M&&(l=!0);if(l||P(o[M])||L(o[M])){for(c=0;c<E.arguments.length;c++)c!==M&&_.Common.k.Cb(s,c)<0&&(P(o[c])||L(o[c]))&&s.push(c);n=s}}for(h=[],p=n[f=0],d=o.length,y=[],g=0;g<d;g++)m=o[g],a=i=O,R=k=1,g===p?(i=P(m)?m:O,a=L(m)?m:O,(i||a)&&(R=i&&i.getRowCount()||(I&&a?a.getRowCount(0):1),k=i&&i.getColumnCount()||(N&&a?a.getColumnCount(0):1)),p=++f<n.length?n[f]:-1):r===F&&(i=P(m)?m:O,a=L(m)?m:O,(i||a)&&(R=i&&i.getRowCount()||(I&&a?a.getRowCount(0):1),k=i&&i.getColumnCount()||(N&&a?a.getColumnCount(0):1))),y[g]=[i,a,m,R,k],A=A<R?R:A,S=S<k?k:S;for(g=0;g<d;g++){if(b=h[g]=[],i=(v=y[g])[0],a=v[1],m=v[2],R=v[3],k=v[4],(i||a)&&(1!==R&&R!==A||1!==k&&k!==S)&&(-1===M||g===M)&&!j)return;for(C=0;C<A;C++)for(w=b[C]=[],x=0;x<S;x++)1!==R&&R<=C||1!==k&&k<=x?w[x]=H:i?(T=i.getValue(1===R?0:C,1===k?0:x),P(T)&&(T=T.getValue(0,0)),w[x]=T):a?!r||r[g]?w[x]=a.getValue(0,1===R?0:C,1===k?0:x):w[x]=a.create([B(a.getRow(0)+(1===R?0:C),a.getColumn(0)+(1===k?0:x),1,1)]):w[x]=m}return h},e.Evaluator=V,j.prototype.canEvaluate=function(){var t,e=this.oi;for(t=0;t<e.length;t++)if(!e[t].v5)return!1;return!0},v=j,e.AsyncFunctionNode=v,D.prototype.startCalc=function(){var t,e,o,n,r,i,a,s,l;if(this.vQa)for(e in this.y5)if(o=this.y5[e])for(n in o)if(r=o[n])for(i in r)if((a=r[i])&&(a.root.oi=[],0<(t=a.length)))for(s=0;s<t;s++)0===(l=a[s]).evaluateMode&&(l.v5=!1)},D.prototype.startCalcCell=function(t,e){var o,n,r,i,a=this,s=t.getName(),l=e.row,u=e.col;a.source=t,(r=(n=(n=(o=(o=a.y5[s])||(a.y5[s]={}))[l])||(o[l]={}))[u])||(i=new v(-1),(r=n[u]=[]).root=i),a.vQa++,a.x5=0,a.cellNodes=r,a.row=l,a.col=u,a.w5[0]=r.root,a.evaluateMode=-1},D.prototype.startCalcFunction=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p=this,d=e.arguments,g=!1;if(0!==p.w5.length&&p.cellNodes||(g=!0,p.startCalcCell(o.source,o.identity)),n=p.evaluateMode,r=t.evaluateMode(),"REFRESH"===t.name?(r=d[1]?p.lh.evaluate(d[1],o,!1,!1):0,p.evaluateMode=r):-1!==n&&(r=n),a=o.identity?o.identity.row+"|"+o.identity.col:"0",e.PIc&&e.PIc[a]?i=e.PIc[a]:(e.PIc=e.PIc||{},i=e.PIc[a]=new v(p.cellNodes.length,r),p.cellNodes.push(i)),p.currentNode=i,p.w5[p.x5].oi.indexOf(i)<0&&(p.w5[p.x5].oi.push(i),i.parent=p.w5[p.x5],i.oi=[]),p.w5.push(i),p.x5++,2===r&&-1===n){for(s=p.intervals,l=t.interval()||6e4,"REFRESH"===t.name&&(i.isRefresh=!0,l=d[2]?p.lh.evaluate(d[2],o,!1,!1):6e4),s||(p.intervals=s={}),(u=s[l])||"object"!=typeof window||((u=s[l]=[]).intervalObj=window.setInterval(function(){var t,e,o=p.intervals[l];for(c=0;c<o.length;c++)(e=(t=o[c]).node).v5=!1,e.isRefresh&&z(e),p.lh.service.recalculate(t.source,t.row,t.col,!0),p.source.refresh()},l)),h=!1,c=0;c<u.length;c++)if((f=u[c]).source===p.source&&f.node===i&&f.row===p.row&&f.col===p.col){h=!0;break}h||u.push({source:p.source,node:i,row:p.row,col:p.col})}return g&&p.endCalcCell(),i},D.prototype.getNode=function(){return this.currentNode},D.prototype.endCalcFunction=function(){this.w5.pop(),this.x5--,this.currentNode=this.currentNode.parent},D.prototype.endCalcCell=function(){this.x5=-1,this.w5=[]},D.prototype.clearCell=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d,g;if(this.vQa&&(o=t.getName(),n=e.row,r=e.col,this.source=t,(i=this.y5[o])&&(a=i[n])&&(s=a[r])&&((u=(l=s[0])&&l.h_a)&&(delete u.nia,delete u.z$a),a[r]=F,this.vQa--),"object"==typeof window))for(h in c=this.intervals)if(f=c[h]){for(p=[],d=0;d<f.length;d++)(g=f[d]).source===t&&g.row===e.row&&g.col===e.col||p.push(g);p.length?p.length!==f.length&&(p.intervalObj=f.intervalObj,c[h]=p):(c[h]=F,window.clearInterval(f.intervalObj))}},D.prototype.setAsyncResult=function(t,e){t.Fi=e},D.prototype.addRows=function(t,e,o){this.GQa(t,e,o,!0)},D.prototype.deleteRows=function(t,e,o){this.GQa(t,e,o,!1)},D.prototype.GQa=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g;if(this.vQa){if(r=t.getName(),i=this.y5[r]){for(s in a={},i)(l=i[s])&&(u=parseInt(s,10),n?a[e<=u?u+o:u]=l:u<e?a[u]=l:e+o<=u&&(a[u-o]=l));this.y5[r]=a}for(h in c=this.intervals)if(f=c[h]){for(p=[],d=0;d<f.length;d++)(g=f[d]).source===t&&n&&g.row>=e?g.row+=o:g.source===t&&!n&&(g.row<e||g.row>=e+o)&&(g.row=g.row<e?g.row:g.row-o,p.push(g));n||p.length===f.length||(p.intervalObj=f.intervalObj,c[h]=p)}}},D.prototype.addColumns=function(t,e,o){this.HQa(t,e,o,!0)},D.prototype.deleteColumns=function(t,e,o){this.HQa(t,e,o,!1)},D.prototype.HQa=function(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y;if(this.vQa){if(r=t.getName(),i=this.y5[r])for(a in i)if(s=i[a]){for(u in l={},s)(c=s[u])&&c.length&&(h=parseInt(u,10),n?l[e<=h?h+o:h]=c:h<e?l[h]=c:e+o<=h&&(l[h-o]=c));i[a]=l}for(p in f=this.intervals)if(d=f[p]){for(g=[],m=0;m<d.length;m++)(y=d[m]).source===t&&n&&y.col>=e?y.col+=o:y.source===t&&!n&&(y.col<e||y.col>=e+o)&&(y.col=y.col<e?y.col:y.col-o,g.push(y));n||g.length===d.length||(g.intervalObj=d.intervalObj,f[p]=g)}}},D.prototype.changeSourceName=function(t,e){var o;!this.vQa||(o=this.y5[t])&&(this.y5[e]=o,delete this.y5[t])},n=D,e.evaluateOperator=G,f=M.Convert.Pa,p=M.Convert.Rh,d=M.Convert.bc,g=M.Convert.Xh,w=M.Convert.Vh},"./src/referenceExpression.ts":function(t,e,o){"use strict";var v,n,l,C,u,r,i,a,s=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function c(t){return i.call(this,t)||this}function h(t,e,o,n,r,i){var a=new C(1);return a.row=o,a.column=n,a.rowRelative=r,a.columnRelative=i,t&&(a.source=t),e&&(a.endSource=e),a}function f(t,e,o,n,r,i,a,s,l,u,c,h,f){var p,d,g,m,y,b=new C(1);return b.isFullRow=n===v.BAND_INDEX_CONST,c=c||0,h=h||0,d=o-(a?0:c),g=n-(s?0:h),m=r-(l?0:c),y=i-(u?0:h),b.isFullRow&&0===o&&r===v.MAX_ROW_COUNT-1&&(o=r=v.BAND_INDEX_CONST),b.isFullColumn=o===v.BAND_INDEX_CONST,m<d&&(p=o,o=r,r=p,p=a,a=l,l=p),y<g&&(p=n,n=i,i=p,p=s,s=u,u=p),b.row=o,b.column=n,b.endRow=r,b.endColumn=i,b.rowRelative=a,b.columnRelative=s,b.endRowRelative=l,b.endColumnRelative=u,b.isArrayReference=f,t&&(b.source=t),e&&(b.endSource=e),b}function p(t,e,o){var n,r,i,a,s={row:-1,col:-1,rowCount:-1,colCount:-1};return t.isFullRow?(s.col=-1,s.colCount=-1):(i=t.columnRelative?(i=t.column+o)>=v.MAX_COLUMN_COUNT?i%v.MAX_COLUMN_COUNT:i:t.column,t.sf()?(s.col=i,s.colCount=1):(a=t.endColumnRelative?(a=t.endColumn+o)>=v.MAX_COLUMN_COUNT?a%v.MAX_COLUMN_COUNT:a:t.endColumn,s.col=i<=a?i:a,s.colCount=l(a-i)+1)),t.isFullColumn?(s.row=-1,s.rowCount=-1):(n=t.rowRelative?(n=t.row+e)>=v.MAX_ROW_COUNT?n%v.MAX_ROW_COUNT:n:t.row,t.sf()?(s.row=n,s.rowCount=1):(r=t.endRowRelative?(r=t.endRow+e)>=v.MAX_ROW_COUNT?r%v.MAX_ROW_COUNT:r:t.endRow,s.row=n<=r?n:r,s.rowCount=l(r-n)+1)),s}function d(t,e,o,n,r){var i=a.call(this,33)||this;return i.row=t,i.column=e,i.rowRelative=o,i.columnRelative=n,i.isReferenceError=r,i.sf=function(){return!this.isReferenceError},i.getRange=function(t,e){var o,n,r,i,a,s=this.source||this.contextSource;if(!this.isReferenceError&&s&&(n=(o=p(this,t,e)).row,r=o.col,i=s.getReference({row:n,col:r,spillRef:!0})))return a={spillRef:!0,row:n,col:r,rowCount:i.getRowCount(),colCount:i.getColumnCount()},i.isSpillError&&(a.isSpillError=!0),a},i.offset=function(t,e,o){var n=this.contextSource,r=this.source,i=this.endSource;return this.isReferenceError?m(n,r):g(n,r,i,this.row+(this.rowRelative||o?t:0),this.column+(this.columnRelative||o?e:0),this.rowRelative,this.columnRelative)},i}function g(t,e,o,n,r,i,a,s){var l=new u(n,r,i,a,s);return l.contextSource=t,l.source=e,l.endSource=o,l}function m(t,e){return g(t,e,n,0,0,!1,!1,!0)}Object.defineProperty(e,"__esModule",{value:!0}),v=o("./src/calc.common.ts"),n=void 0,l=Math.abs,i=v.Expression,s(c,i),c.prototype.sf=function(){return this.endRow===n||this.endColumn===n},c.prototype.tf=function(){return this.isFullRow&&this.isFullColumn?3:this.isFullRow?1:this.isFullColumn?2:0},c.prototype.getRange=function(t,e){return p(this,t,e)},c.prototype.offset=function(t,e,o,n,r){var i,a=this,s=a.source,l=a.endSource;return a.sf()?h(s,l,a.row+(a.rowRelative||o?t:0),a.column+(a.columnRelative||o?e:0),a.rowRelative,a.columnRelative):((i=f(s,l,a.row+(a.rowRelative||o?t:0),a.column+(a.columnRelative||o?e:0),a.endRow+(a.isFullColumn||!a.endRowRelative&&!o?0:t),a.endColumn+(a.isFullRow||!a.endColumnRelative&&!o?0:e),a.rowRelative,a.columnRelative,a.endRowRelative,a.endColumnRelative,n,r)).isFullRow=a.isFullRow,i.isFullColumn=a.isFullColumn,i)},c.prototype.offset2=function(t,e,o,n,r,i){var a=this,s=f(a.source,a.endSource,a.row+(a.isFullColumn?0:t),a.column+(a.isFullRow?0:e),a.endRow+(a.isFullColumn?0:o),a.endColumn+(a.isFullRow?0:n),a.rowRelative,a.columnRelative,a.endRowRelative,a.endColumnRelative,r,i);return s.isFullRow=a.isFullRow,s.isFullColumn=a.isFullColumn,s},C=c,e.ReferenceExpression=C,e.rf=h,e.uf=f,e.getRangeForReference=p,a=v.Expression,s(d,a),u=d,e.SpillReferenceExpression=u,e.BLb=g,e.lOb=m},Common:function(t,e){t.exports=o("@grapecity/js-sheets-common")}},a.c=r,a.d=function(t,e,o){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(e,t){var o,n;if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;if(o=Object.create(null),a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(n in e)a.d(o,n,function(t){return e[t]}.bind(null,n));return o},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/assets/",a(a.s="./src/calc.entry.ts")),t.exports=i.Spread.CalcEngine},"./node_modules_local/@grapecity/js-calc/index.js":function(t,e,o){t.exports=o("./node_modules_local/@grapecity/js-calc/dist/gc.spread.calcengine.js")},"./node_modules_local/@grapecity/js-sheets-common/dist/gc.spread.common.js":function(t,e){var o,n,r="object"==typeof r?r:{};function i(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return o[t].call(e.exports,e,e.exports,i),e.l=!0,e.exports}r.Spread=(n={},i.m=o={"./node_modules/webpack/buildin/global.js":function(t,e){var o;o=function(){return this}();try{o=o||Function("return this")()}catch(t){"object"==typeof window&&(o=window)}t.exports=o},"./src/all.entry.ts":function(t,e,o){"use strict";var n,r,i,a,s;Object.defineProperty(e,"__esModule",{value:!0}),n=o("./src/common/common.entry.ts"),e.Common=n,r=o("./src/plugins/commands/commands.entry.ts"),e.Commands=r,i=o("./src/plugins/formatter/formatter.entry.ts"),e.Formatter=i,a=o("./src/plugins/sparkline/sparkline.entry.ts"),e.Sparklines=a,s=o("./src/plugins/slicer/slicer.entry.ts"),e.Slicers=s},"./src/common/common.entry.ts":function(t,o,e){"use strict";var n,r,i,a,s,l,u,c,h,f;function p(t){for(var e in t)o.hasOwnProperty(e)||(o[e]=t[e])}Object.defineProperty(o,"__esModule",{value:!0}),n=e("./src/common/util/colorhelper.ts"),o.pc=n.pc,r=e("./src/common/util/types.ts"),o.j=r.j,i=e("./src/common/util/arrayhelper.ts"),o.k=i.k,a=e("./src/common/util/datetimehelper.ts"),o.l=a.l,s=e("./src/common/util/numberhelper.ts"),o.o=s.o,l=e("./src/common/util/regexhelper.ts"),o.q=l.q,u=e("./src/common/util/stringhelper.ts"),o.u=u.u,c=e("./src/common/util/rbush.ts"),o.rbush=c.rbush,h=e("./src/common/util/datetimehelper.ts"),o.FXc=h.getSR,p(e("./src/common/util/common.ts")),f=e("./src/common/culture/cultureInfo.ts"),o.CultureInfo=f.CultureInfo,o.CultureManager=f.CultureManager,p(e("./src/common/util/functionhelper.ts"))},"./src/common/culture/cultureInfo.ts":function(t,L,H){"use strict";(function(t){var e,s,i,r,a,n,l,o,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M=this&&this.__extends||(w=function(t,e){return(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}w(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function I(t){return t.split(" ").join(" ").toUpperCase()}function N(t){var e,o,n=[];for(e=0,o=t.length;e<o;e++)n[e]=I(t[e]);return n}function R(t,e,o){var n=I(t),r=e.indexOf(n);return-1===r&&(r=o.indexOf(n)),r}function k(){var t,e,o=x.call(this)||this;return F.call(o,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","dbNumber","standardDictionaryNumbers"],[0,1,"₩",!1,{1:{letters:["兆","千","百","十","億","千","百","十","万","千","百","十",""],numbers:["０","一","二","三","四","五","六","七","八","九"]},2:{letters:["兆","阡","百","拾","億","阡","百","拾","萬","阡","百","拾",""],numbers:["零","壹","貳","參","四","伍","六","七","八","九"]},3:{letters:["兆","千","百","十","億","千","百","十","万","千","百","十",""],numbers:["０","１","２","３","４","５","６","７","８","９"]},4:{letters:["조","천","백","십","억","천","백","십","만","천","백","십",""],numbers:["○","일","이","삼","사","오","육","칠","팔","구"]}},{Hundreds:"백",Thousands:"천",Millions:"백만",Billions:"10억",Trillions:"조"}]),F.call(o,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter"],[["일","월","화","수","목","금","토"],t=["1","2","3","4","5","6","7","8","9","10","11","12",""],t,"오전",!(e=["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월",""]),["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],1,"yyyy'년' M'월' d'일' dddd h:mm:ss","yyyy'년' M'월' d'일' dddd","h:mm:ss","M'월' d'일'",e,e,"서기","오후","yyyy-MM-dd",["일","월","화","수","목","금","토"],"tt h:mm","yyyy'년' M'월'","yyyy년/mmmm/d일"]),o.DateTimeFormat.defaultDatePattern=o.DateTimeFormat.shortDatePattern+" "+o.DateTimeFormat.longTimePattern,o.name=function(){return"ko-kr"},o.id=1042,o.isJCKCulture=!0,o}function E(){var t,e,o,n=T.call(this)||this;return F.call(n,"NumberFormat",["currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber","standardDictionaryNumbers"],[2,"¥",!1,"非数字","负无穷大",1,1,"正无穷大",{1:{letters:["兆","千","百","十","亿","千","百","十","万","千","百","十",""],numbers:["○","一","二","三","四","五","六","七","八","九"]},2:{letters:["兆","仟","佰","拾","亿","仟","佰","拾","万","仟","佰","拾",""],numbers:["零","壹","贰","叁","肆","伍","陆","柒","捌","玖"]},3:{letters:null,numbers:["０","１","２","３","４","５","６","７","８","９"]}},{Hundreds:"百",Thousands:"千",Millions:"百万",Billions:"十亿",Trillions:"兆"}]),F.call(n,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","quarterNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter"],[["周日","周一","周二","周三","周四","周五","周六"],t=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月",""],t,"上午",!(o=["一季度","二季度","三季度","四季度"]),["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],1,"yyyy'年'M'月'd'日' H:mm:ss","yyyy'年'M'月'd'日'","H:mm:ss","M'月'd'日'",e=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月",""],e,o,"公历","下午","yyyy/M/d",["日","一","二","三","四","五","六"],"H:mm","yyyy'年'M'月'","yyyy年/mmmm/d日"]),n.DateTimeFormat.defaultDatePattern=n.DateTimeFormat.shortDatePattern+" "+n.DateTimeFormat.longTimePattern,n.name=function(){return"zh-cn"},n.id=2052,n.isJCKCulture=!0,n.localeCompare=function(t,e){return t.localeCompare(e,"en")},n}function D(){var t,e,o,n=A.call(this)||this;return F.call(n,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber","standardDictionaryNumbers"],[0,1,"¥",!1,"NaN (非数値)","-∞",1,1,"+∞",{1:{letters:["兆","千","百","十","亿","千","百","十","万","千","百","十",""],numbers:["〇","一","二","三","四","五","六","七","八","九"]},2:{letters:["兆","阡","百","拾","億","阡","百","拾","萬","阡","百","拾",""],numbers:["〇","壱","弐","参","四","伍","六","七","八","九"]},3:{letters:null,numbers:["０","１","２","３","４","５","６","７","８","９"]}},{Hundreds:"百",Thousands:"千",Millions:"百万",Billions:"十億",Trillions:"兆"}]),F.call(n,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","quarterNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter","preselectedFormatters","EraFilterDialogDateFormatter"],[["日","月","火","水","木","金","土"],t=["1","2","3","4","5","6","7","8","9","10","11","12",""],t,"午前",!(o=["yyyy年M月d日","yyyy年M月dd日","yyyy年MM月d日","yyyy年MM月dd日"]),["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],"yyyy'年'M'月'd'日' H:mm:ss","yyyy'年'M'月'd'日'","H:mm:ss","M'月'd'日'",e=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月",""],e,["Q1","Q2","Q3","Q4"],"西暦 (日本語)","午後","yyyy/MM/dd",["日","月","火","水","木","金","土"],"H:mm","yyyy'年'M'月'","yyyy年/mmmm/d日",o,"ggge/mmmm/d日"]),n.DateTimeFormat.eras=!0,n.DateTimeFormat.defaultDatePattern=n.DateTimeFormat.shortDatePattern+" "+n.DateTimeFormat.longTimePattern,n._Ab=['gggee"年"MM"月"dd"日','gggee"年"M"月"d"日','ge"年"M"月"d"日','ggge"年"M"月"d"日','ggee"年"M"月"d"日','gge"年"M"月"d"日'],n.name=function(){return"ja-JP"},n.id=1041,n.isJCKCulture=!0,n}function j(){var t,e=S.call(this)||this;return F.call(e,"NumberFormat",["currencySymbol","isReadOnly"],["$",!1]),F.call(e,"DateTimeFormat",["fullDateTimePattern","longDatePattern","longTimePattern","shortDatePattern","shortTimePattern","yearMonthPattern","calendarIsReadOnly","preselectedFormatters"],["dddd, MMMM dd, yyyy h:mm:ss tt","dddd, MMMM dd, yyyy","h:mm:ss tt","M/d/yyyy","h:mm tt","MMMM, yyyy",!(t=["MMM yyyy","MMMM yyyy"]),t]),e.DateTimeFormat.defaultDatePattern=e.DateTimeFormat.shortDatePattern+" H:mm:ss",e.name=function(){return"en-US"},e.id=1033,e}function _(){}function O(){this.NumberFormat={currencyDecimalDigits:2,currencyDecimalSeparator:".",currencyGroupSeparator:",",currencyGroupSizes:[3],currencyNegativePattern:0,currencyPositivePattern:0,currencySymbol:"¤",digitSubstitution:1,isReadOnly:!0,numberGroupSizes:[3],nanSymbol:"NaN",nativeDigits:["0","1","2","3","4","5","6","7","8","9"],numberNegativePattern:1,negativeInfinitySymbol:"-Infinity",negativeSign:"-",numberDecimalDigits:2,numberDecimalSeparator:".",numberGroupSeparator:",",positiveInfinitySymbol:"Infinity",positiveSign:"+",percentDecimalDigits:2,percentDecimalSeparator:".",percentGroupSeparator:",",percentGroupSizes:[3],percentNegativePattern:0,percentPositivePattern:0,percentSymbol:"%",perMilleSymbol:"‰",listSeparator:",",arrayListSeparator:",",arrayGroupSeparator:";",dbNumber:{},standardDictionaryNumbers:{Hundreds:"Hundreds",Thousands:"Thousands",Millions:"Millions",Billions:"Billions",Trillions:"Trillions"}},this.DateTimeFormat={abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],abbreviatedMonthGenitiveNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],amDesignator:"AM",calendarIsReadOnly:!0,calendarWeekRule:0,Calendar:{MinSupportedDateTime:"@-62135568000000@",MaxSupportedDateTime:"@253402300799999@",AlgorithmType:1,CalendarType:1,Eras:[1],TwoDigitYearMax:2029,isReadOnly:!0},dateSeparator:"/",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],defaultDatePattern:"MM/dd/yyyy H:mm:ss",firstDayOfWeek:0,fullDateTimePattern:"dddd, dd MMMM yyyy HH:mm:ss",longDatePattern:"dddd, dd MMMM yyyy",longTimePattern:"HH:mm:ss",monthDayPattern:"MMMM dd",monthGenitiveNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],quarterNames:["Q1","Q2","Q3","Q4"],nativeCalendarName:"Gregorian Calendar",pmDesignator:"PM",rfc1123Pattern:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",shortDatePattern:"MM/dd/yyyy",shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],shortTimePattern:"HH:mm",sortableDateTimePattern:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",timeSeparator:":",universalSortableDateTimePattern:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",yearMonthPattern:"yyyy MMMM",filterDialogDateFormatter:"yyyy/mmmm/dd",preselectedFormatters:[],eraFormatter:["ge/M/d","ge-M-d","ge.M.d","gee/MM/dd"]},this.name=function(){return""},this.id=-1,this.LocalNumberFormat={}}function F(t,e,o){var n,r,i;for(r=0,i=e.length;r<i;r++)n=e[r],this[t][n]=o[r]}function P(){this.bBb=1,this.OXc={}}Object.defineProperty(L,"__esModule",{value:!0}),e=H("./src/common/util/types.ts"),s=H("./src/common/util/common.ts"),i=H("./src/common/util/arrayhelper.ts"),r="undefined"!=typeof window?window:t,a=void 0,n=e.j.H,l=e.j.Ia,c=["MM-dd-yyyy","MM-d-yyyy","M-dd-yyyy","M-d-yyyy","yy-MM-dd","yy-MM-d","yy-M-dd","yy-M-d","yyyy-MM-dd","yyyy-MM-d","yyyy-M-dd","yyyy-M-d","dd-MMMM-yy","dd-MMM-yy"],h=(o=["MM/dd/yyyy","MM/d/yyyy","M/dd/yyyy","M/d/yyyy","yy/MM/dd","yy/MM/d","yy/M/dd","yy/M/d","yyyy/MM/dd","yyyy/MM/d","yyyy/M/dd","yyyy/M/d"]).concat(u=["hh:mm:ss","hh:mm:s","hh:m:ss","hh:m:s","h:mm:ss","h:mm:s","h:m:ss","h:m:s","hh:mm:ss tt","hh:mm:s tt","hh:m:ss tt","hh:m:s tt","h:mm:ss tt","h:mm:s tt","h:m:ss tt","h:m:s tt","hh:mm","hh:m","h:mm","h:m","hh:mm tt","hh:m tt","h:mm tt","h:m tt"]),n(o,function(t,o){n(u,function(t,e){t<u.length-4&&h.push(o+" "+e)})}),h=h.concat(c),n(c,function(t,o){n(u,function(t,e){t<u.length-4&&h.push(o+" "+e)})}),O.prototype.ma=function(){var t,e,o,n;return this.na||(o=(o=[e=(t=this.DateTimeFormat).shortDatePattern.replace(/m/g,"M"),e+" h:mm",e+" h:mm:ss",e+" h:mm:ss.0","MMMdd","MMMd","MMM dd","MMM d"]).concat(h),1041===this.id&&(n=t.eraFormatter,o=(o=o.concat(this._Ab)).concat(n)),o=o.concat(t.preselectedFormatters),this.na=o),this.na},O.prototype.oa=function(t){return this.pa||(this.pa=N(this.DateTimeFormat.monthNames),this.qa=N(this.DateTimeFormat.monthGenitiveNames)),R(t,this.pa,this.qa)},O.prototype.ra=function(t){return this.sa||(this.sa=N(this.DateTimeFormat.abbreviatedMonthNames),this.ta=N(this.DateTimeFormat.abbreviatedMonthGenitiveNames)),R(t,this.sa,this.ta)},O.prototype.ua=function(t){return this.va||(this.va=N(this.DateTimeFormat.dayNames)),this.va.indexOf(I(t))},O.prototype.wa=function(t){return this.xa||(this.xa=N(this.DateTimeFormat.abbreviatedDayNames)),this.xa.indexOf(I(t))},f=O,L.CultureInfo=f,_.I=function(t){return t>=_.J()&&t<=_.K()},_.L=function(){var t,e,o=f.eras;if(o===a)return this.O;for(t=[],e=0;e<o.length;e++)t[e]=new Date(o[e].startDate.replace(/-/g,"/"));return t},_.P=function(t){var e,o,n,r,i;switch(t){case"g":e="symbol",o=_.R;break;case"gg":e="abbreviation",o=_.S;break;case"ggg":e="name",o=_.U;break;default:return[]}if(r=[],(n=f.eras)===a)return o;for(i=0;i<n.length;i++)r[i]=n[i][e];return r},_.K=function(){var t,e=f.eras;return e!==a&&0<e.length?((t=new Date(e[e.length-1].startDate.replace(/-/g,"/"))).setFullYear(t.getFullYear()+99),t):this.W},_.J=function(){var t=f.eras;return t!==a&&0<t.length?new Date(t[0].startDate.replace(/-/g,"/")):this.Z},_.$=function(){var t=f.eras;return t!==a?t.length:this._},_.aa=function(){var t,e,o,n,r=f.eras;if(r===a)return this.ba;for(t=[],e=1;e<r.length;e++)o=new Date(r[e-1].startDate.replace(/-/g,"/")),n=new Date(r[e].startDate.replace(/-/g,"/")),t[e-1]=n.getFullYear()-o.getFullYear()+1;return t[e-1]=99,t},_.ca=function(t){var e,o={da:-1,ea:-1};if(!_.I(t))return o;for(e=0;e<_.$();e++)if(t<(e+1!==_.$()?_.L()[e+1]:_.fa(_.K(),1))){o.da=e,o.ea=t.getFullYear()-_.L()[e].getFullYear()+1;break}return o},_.fa=function(t,e){var o=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());return o.setMilliseconds(o.getMilliseconds()+e),new Date(o.valueOf())},_.ga=function(t,e){return _.L()[t].getFullYear()+e-1},_.ha=function(t,e){var o,n;for(e=e.toUpperCase(),o=_.P(t),n=0;n<o.length;n++)if(o[n]===e)return n;return-1},_.ia=function(t,e,o){var n,r,i,a=_,s=a.ca(e),l=s.da;if(0<=l&&0<(n=a.P(t)).length)return n[l];if(0<=(r=s.ea)){if("1"==(i=""+r)&&o)return"元";if("ee"===t)return 1===i.length&&(i="0"+i),i;if("e"===t)return i}return""},_.O=[new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8),new Date(2019,4,1)],_._=5,_.ba=[45,15,64,31,99],_.W=new Date(2117,11,31,23,59,59),_.Z=new Date(1868,8,8),_.ja=["1,m","2,t","3,s","4,h","5,r"],_.ka=[0,1,2,3,0,1,2,3],_.U=["明治","大正","昭和","平成","令和"],_.R=["M","T","S","H","R"],_.S=["明","大","昭","平","令"],_.la=99,_.eraExcelFormatter="[$-ja-JP-x-gannen]",_.eraInternalFormatter="[$-411]",L.aBb=_,M(j,S=f),p=j,M(D,A=f),d=D,M(E,T=f),g=E,M(k,x=f),m=k,y={invariant:new f,"en-us":new p,"ja-jp":new d,"zh-cn":new g,"ko-kr":new m},b={},v=["lsru","lsde","ls1","ls2","ls3","ls4","ls5","ls6","ls7","ls8"],C=["wmk1","wmk2"],P.instance=function(){return this.cBb||(this.cBb=new this)},P.prototype.culture=function(t){return 0===arguments.length?P.dBb:void(t&&P.dBb!==t&&(P.dBb=t.toLowerCase(),this.bBb++,e=P.dBb,o=P.cBb.getCultureInfo(),"object"==typeof document&&("function"!=typeof CustomEvent?(n=document.createEvent("CustomEvent")).initCustomEvent("cultureChanged",!1,!1,void 0):n=new CustomEvent("cultureChanged",{}),n.cultureInfo=e,r.gcCultureInfo=e,r.gcCultureObj=o,document.dispatchEvent(n))));var e,o,n},P.prototype.addCultureInfo=function(t,e,o){var n,r,i,a;if(e&&e instanceof f){if(n=e.NumberFormat&&e.NumberFormat.numberDecimalSeparator,r=e.NumberFormat.arrayListSeparator,i=e.NumberFormat.arrayGroupSeparator,n===e.NumberFormat.listSeparator||i===r)throw new s.ResourceManager(s.SR).getResource().Exp_Separator;y[t.toLowerCase()]=e}o&&"object"==typeof o&&(a=t.toLowerCase(),b[a]=l(!0,{},o),this.bBb++)},P.prototype.getCultureInfo=function(t){var e,o,n;if(0===arguments.length)return y[P.dBb];for(n in"string"==typeof t&&(t=t.toLowerCase()),o=null,e=y)if(n===t||e[n].id!==a&&e[n].id===t){o=e[n];break}return o},P.prototype.getLanguage=function(t){if("string"!=typeof t)return null;var e=t.toLowerCase();return b[e]},P.prototype.getResources=function(t){var e,o=this.culture().toLowerCase();return null!==t&&t!==a||(t=o),"string"==typeof t&&(e=t.toLowerCase(),this.OXc[e])?this.PXc(this.OXc[e]):null},P.prototype.PXc=function(t){var e,o="PivotTables",n=l(!0,{},t);return n[o]&&this.QXc(n[o],C),n.Sheets&&this.QXc(n.Sheets,v),(e=n.CalcEngine)&&(n.Functions=e._h,n.TableFunctions=e.B2,delete e._h,delete e.B2),n},P.prototype.QXc=function(t,e){var o,n;for(o=0,n=e;o<n.length;o++)delete t[n[o]]},P.prototype.eBb=function(t,e){var o,n,r=b[t.toLowerCase()];for(o in e)i.k.Bb(v,o)||null!==(n=this.fBb(r,o))&&"string"==typeof n&&"string"==typeof e[o]&&(e[o]=n);e._h&&r.Functions&&this.gBb(r.Functions,e._h),e.B2&&r.TableFunctions&&l(!0,e.B2,r.TableFunctions)},P.prototype.fBb=function(t,e){var o,n;if(t.hasOwnProperty(e))return t[e];for(o in t)if((n=t[o])&&"object"==typeof n&&n.hasOwnProperty(e))return n[e];return null},P.prototype.gBb=function(t,e){var o,n,r,i,a,s,l;for(o in e)if(t.hasOwnProperty(o))for(s in n=e[o],r=t[o],i=n.parameters,a=r.parameters,n.description=r.description,i)a.hasOwnProperty(s)&&"string"==typeof(l=a[s])&&(i[s].name=l);return{}},P.prototype.q4=function(t){var e=this.getCultureInfo(t);return e=e||((e=y[P.dBb])||new f)},P.prototype.LZa=function(t,e){var o=(this.getCultureInfo(t)||this.getCultureInfo("en-US")).DateTimeFormat,n=o.filterDialogDateFormatter;return(0<=e.indexOf("g")||0<=e.indexOf("e"))&&(n=o.EraFilterDialogDateFormatter||n),n},P.dBb="en-us",L.CultureManager=P.instance()}).call(this,H("./node_modules/webpack/buildin/global.js"))},"./src/common/util/arrayhelper.ts":function(t,e,o){"use strict";var i;function n(){}Object.defineProperty(e,"__esModule",{value:!0}),i=null,n.Eb=function(t,e,o){t.splice(e,0,o)},n.Sb=function(t,e){t.push(e)},n.Bb=function(t,e){return-1<t.indexOf(e)},n.Fb=function(t,e){var o=t.indexOf(e);-1<o&&t.splice(o,1)},n.Zb=function(t,e){return t.slice(0,e).concat(t.slice(e+1))},n.Cb=function(t,e,o){return t.indexOf(e,o)},n.$b=function(t,e,o){if(!(e<0))for(var n=0;n<o&&e+n<t.length;n++)t[e+n]=i},n._b=function(t,e){var o;for(e<0&&(e=-1),o=e+1;o<t.length;o++)if(void 0!==t[o]&&t[o]!==i)return o;return-1},n.ac=function(t){return t&&t.length},n.Uo=function(t){var e=[];return function t(e,o){var n,r;for(n in o)o.hasOwnProperty(n)&&(r=o[n],Array.isArray(r)?(e[n]=[],t(e[n],o[n])):r!==i&&"object"==typeof r?(e[n]={},t(e[n],o[n])):e[n]=o[n])}(e,t),e},e.k=n},"./src/common/util/colorhelper.ts":function(t,e,o){"use strict";var n,i,f,p,a,d,r,u;function s(t,e,o){return o<0&&(o+=240),240<o&&(o-=240),o<40?t+((e-t)*o+20)/40:o<120?e:o<160?t+((e-t)*(160-o)+20)/40:t}function l(t,e,o){var n,r,i,a,s;return 0===o?n=r=i=d(255*e/240+"",10):(0,n=c(a=2*e-(s=e<=120?d((e*(240+o)+120)/240+""):e+o-d((e*o+120)/240+"")),s,t+80),r=c(a,s,t),i=c(a,s,t-80)),{a:255,r:n,g:r,b:i}}function c(t,e,o){return f(d((255*s(t,e,o)+120)/240+""),255)}function h(t){var e,o,n,r,i=this,a=t.r,s=t.g,l=t.b,u=p(p(a,s),l),c=f(f(a,s),l),h=u+c;i.kc=d((240*h+255)/510+"",10),0==(e=u-c)?(i.mc=0,i.lc=160):(i.kc<=120?i.mc=d((240*e+h/2)/h+"",10):i.mc=d((240*e+(510-h)/2)/(510-h)+"",10),o=(40*(u-a)+e/2)/e,n=(40*(u-s)+e/2)/e,r=(40*(u-l)+e/2)/e,i.lc=d(a===u?r-n+"":s===u?80+o-r+"":160+n-o+"",10),i.lc<0&&(i.lc+=240),240<i.lc&&(i.lc-=240))}function g(){}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./src/common/util/numberhelper.ts"),i=n.o.pb,f=Math.min,p=Math.max,a=Math.abs,d=parseInt,h.prototype.nc=function(t){var e=this.kc,o=this.oc(this.kc,500,!0);return l(this.lc,e+(o-e)*t,this.mc)},h.prototype.oc=function(t,e,o){return 0===e?t:o?0<e?(t*(1e3-e)+241*e)/1e3:t*(e+1e3)/1e3:((t+=240*e/1e3)<0&&(t=0),240<t&&(t=240),t)},r=h,u=/rgb[a]?\((\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})(\s*,\s*(\d{0,1}))?\)/,g.bc=function(t){var e=t.a,o=t.r,n=t.g,r=t.b;return 3===arguments.length&&(e=255,o=t,n=arguments[1],r=arguments[2]),4===arguments.length&&(e=t,o=arguments[1],n=arguments[2],r=arguments[3]),255===e?"#"+i(o,!0,2)+i(n,!0,2)+i(r,!0,2):"rgba("+o+","+n+","+r+","+e+")"},g.Pka=function(t,e){return t.stops||t.type?JSON.stringify(t)===JSON.stringify(e):t.a===e.a&&t.r===e.r&&t.g===e.g&&t.b===e.b},g.dc=function(t){return(299*t.r+587*t.g+114*t.b)/1e3},g.hc=function(t,e){var o=255-a(t.r-e.r),n=255-a(t.g-e.g),r=255-a(t.b-e.b),i=a(t.a-e.a);return!!(.9<=((o/=255)+(n/=255)+(r/=255))/3&&i<=.05)},g.ic=function(t){var e=255^t.r,o=255^t.g,n=255^t.b;return g.bc(t.a,e,o,n)},g.hBb=function(t){var e,o,n,r,i,a,s,l;return"object"!=typeof document?/^#[A-Fa-f0-9]+$/.test(r=t)?(i=r.replace(/^#/,""),a=i.length,(s=(s=i.split(3===a?/(.)/:/(..)/)).filter(Boolean).map(function(t){return 3===a?parseInt(t+t,16):parseInt(t,16)}))[0]||(s[0]=0),s[1]||(s[1]=0),s[2]||(s[2]=0),[s[0],s[1],s[2],1]):null!==(l=u.exec(r))?[l[1],l[2],l[3],1]:null:((e=g.Yn)||(o=document.createElement("canvas"))&&o.getContext&&(e=g.Yn=o.getContext("2d")),e?(e.clearRect(1,1,1,1),e.fillStyle=t,e.fillRect(1,1,1,1),(n=e.getImageData(1,1,1,1))?n.data:null):t)},g.ec=function(t){var e,o,n,r,i;return t instanceof g||"object"==typeof t?t:(r=n=o=e=0,t&&(i=g.hBb(t))&&(o=i[0],n=i[1],r=i[2],e=i[3]),{a:e,r:o,g:n,b:r})},g.jc=function(t,e){var o,n;return 0===e?t:(o=new r(t),n=d((0<e?(240-o.kc)*e:o.kc*e)+"",10),g.gc(o.lc,o.kc+n,o.mc))},g.nc=function(t,e){var o=g.ec(t),n=new r(o).nc(e);return g.bc(n)},g.fc=s,g.gc=l,e.pc=g},"./src/common/util/common.ts":function(t,e,o){"use strict";var a,n,r,s;function i(t,e){this.res=t,this.RXc=e,this.OXc=a.CultureManager.OXc,this.cachedResource=this.iBb(t,!0),this.SXc(this.cachedResource,e),this.bBb=0}Object.defineProperty(e,"__esModule",{value:!0}),a=o("./src/common/culture/cultureInfo.ts"),n=o("./src/common/util/util.res.en.ts"),r=o("./src/common/util/types.ts"),e.SR={en:n},s=r.j.Ia,i.prototype.getResource=function(){var t=this.iBb(this.res,!this.cachedResource);return t&&(this.cachedResource=t),this.SXc(this.cachedResource,this.RXc),this.cachedResource},i.prototype.SXc=function(t,e){var o;e&&(o=a.CultureManager.culture().toLowerCase(),this.OXc[o]=this.OXc[o]||{},this.OXc[o][e]=t,a.CultureManager.OXc=this.OXc)},i.prototype.iBb=function(t,e){var o,n,r,i=a.CultureManager.culture();if(t&&i){if(o=a.CultureManager.bBb,this.bBb===o&&!e)return;return this.bBb=o,a.CultureManager.getLanguage(i)?(n=s(!0,{},t.en),a.CultureManager.eBb(i,n),n):(r=i.substr(0,2).toLowerCase(),t.hasOwnProperty(r)?t[r]:t.en)}return{}},e.ResourceManager=i,e.A=function(t,e,o,n){var r,i,a,s,l;if(t&&0<=o&&o<e){for(r=[],a=void 0,a=o;a<e;a++)void 0!==t[a]&&r.push(a);for(i=r.length,a=0;a<i;a++)l=t[s=r[i-a-1]],t[s]=null,t[Math.floor(s)+n]=l}},e.B=function(t,e,o,n){var r,i,a,s,l,u;if(t&&0<=o&&o<e){for(r=[],a=o+n,s=void 0,s=o;s<e;s++)void 0!==t[s]&&(o<=s&&s<a?t[s]=null:a<=s&&r.push(s));for(i=r.length,s=0;s<i;s++)u=t[l=r[s]],t[l]=null,t[Math.floor(l)-n]=u}},e.D=function(t,e){return t.hasOwnProperty(e)},e.F=function(t,e){return t instanceof e}},"./src/common/util/datetimehelper.ts":function(t,F,e){"use strict";var o,P,L,H,n,i,E,B,V,z,D,j,_,r,a;function O(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I=o.DateTimeFormat,N=I.Calendar.convert;if(!e||!e.length)return o&&o.name.length?N?O(t,I.fullDateTimePattern,o):t.toLocaleString():""+t;function R(){return s||l||(s=u.test(e),l=D),s}function k(t,e){if(f)return f[e];switch(e){case 0:return t.getFullYear();case 1:return t.getMonth();case 2:return t.getDate();case 3:return Math.floor(t.getMonth()/3);default:return}}for(r=I.eras,i="",u=/([^d]|^)(d|dd)([^d]|$)/g,c=0,h=G(),!("s"===e)&&N&&(f=N.fromGregorian(t)),d=p=-2,g={Qb:""},m=0;y=h.lastIndex,b=h.exec(e),v=e.slice(y,b?b.index:e.length),g.Qb="",c+=W(v,g),i+=g.Qb,b;m++)if(c%2!=1)switch(C=t.getFullYear(),w=t.getDay(),x=t.getHours(),T=t.getMinutes(),A=t.getSeconds(),S=t.getMilliseconds(),M=t.getTimezoneOffset(),b[0]){case"dddd":i+=I.dayNames[w];break;case"ddd":i+=I.abbreviatedDayNames[w];break;case"dd":s=D,i+=E(k(t,2),2);break;case"d":s=D,i+=k(t,2);break;case"MMMM":i+=I.monthGenitiveNames&&R()?I.monthGenitiveNames[k(t,1)]:I.monthNames[k(t,1)];break;case"MMM":i+=I.abbreviatedMonthGenitiveNames&&R()?I.abbreviatedMonthGenitiveNames[k(t,1)]:I.abbreviatedMonthNames[k(t,1)];break;case"MM":i+=E(k(t,1)+1,2);break;case"M":i+=k(t,1)+1;break;case"QQ":case"qq":i+=I.quarterNames[k(t,3)];break;case"Q":case"q":i+=k(t,3)+1;break;case"yyyy":case"yyy":i+=0<=p?H.aBb.ia("ee",t,n):E(f?f[0]:C,4);break;case"yy":i+=0<=p?H.aBb.ia("ee",t,n):E((f?f[0]:C)%100,2);break;case"y":i+=0<=p?H.aBb.ia("e",t,n):""+(f?f[0]:C)%100;break;case"hh":0===(a=x%12)&&(a=12),i+=E(a,2);break;case"h":0===(a=x%12)&&(a=12),i+=a;break;case"HH":i+=E(x,2);break;case"H":i+=""+x;break;case"mm":i+=E(T,2);break;case"m":i+=""+T;break;case"ss":i+=E(A,2);break;case"s":i+=""+A;break;case"tt":i+=x<12?I.amDesignator:I.pmDesignator;break;case"t":i+=(x<12?I.amDesignator:I.pmDesignator).charAt(0);break;case"f":case"0":i+=E(S,3).charAt(0);break;case"ff":case"00":i+=E(S,3).substr(0,2);break;case"fff":case"000":i+=E(S,3);break;case"z":i+=((a=M/60)<=0?"+":"-")+j(_(a));break;case"zz":i+=((a=M/60)<=0?"+":"-")+E(j(_(a)),2);break;case"zzz":i+=((a=M/60)<=0?"+":"-")+E(j(_(a)),2)+":"+E(_(M%60),2);break;case"g":case"gg":case"ggg":if(!r)break;if(p===m-1){p=m;break}i+=H.aBb.ia(b[0],t,n),p=m;break;case"e":case"ee":if(!r){i+=E(f?f[0]:C,4);break}if(d===m-1){d=m;break}i+=H.aBb.ia(b[0],t,n),d=m;break;case"/":i+=I.dateSeparator;break;case"[h]":case"[hh]":case"[H]":case"[HH]":case"[mm]":case"[m]":case"[ss]":case"[s]":i+=b[0];break;default:throw Error(F.getSR().Exp_InvalidDateFormat)}else i+=b[0];return""+i}function W(t,e){var o,n,r,i=0,a=z;for(o=0,n=t.length;o<n;o++)switch(r=t.charAt(o)){case'"':a?e.Qb+="'":i++,a=z;break;case"\\":a&&(e.Qb+="\\"),a=!a;break;default:e.Qb+=r,a=z}return i}function G(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|QQ|Q|qq|q|yyyy|yyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|000|00|0|zzz|zz|z|ggg|gg|g|ee|e|\[H\]|\[HH\]|\[h\]|\[hh\]|\[mm\]|\[m\]|\[ss\]|\[s\]/g}function u(t){var e=t.getTimezoneOffset();return-485===e&&(e=-485-43/60),-321===e&&(e=-321-10/60),-507===e&&(e=-507-52/60),e}function c(){}Object.defineProperty(F,"__esModule",{value:!0}),o=e("./src/common/util/common.ts"),P=e("./src/common/util/stringhelper.ts"),L=e("./src/common/util/arrayhelper.ts"),H=e("./src/common/culture/cultureInfo.ts"),n=e("./src/common/util/types.ts"),i=n.j.Fa,E=P.u.Sa,B=null,V=parseInt,D=!(z=!1),j=Math.floor,_=Math.abs,r=new o.ResourceManager(o.SR,"Common"),F.getSR=r.getResource.bind(r),a={},c.mb=function(t,e,o,n){return O(t,e,o=o||H.CultureManager.q4(),n)},c.Vb=function(t,e,o){return O(t,e,o||H.CultureManager.q4())},c.gBa=function(t,e,o){var n,r,i,a,s,l=z;for((s=o).slice(1).forEach(function(t){t&&(l=!0)}),l||(s=s.concat(e.ma())),r=s.length,n=1;n<r;n++)if((a=s[n])&&(l=D,i=c.Wb(t,a,e)))return i;return B},c.Qa=function(t,e,o){var n,r;return(e||o||void 0===(r=a[t]))&&(n=e?[t,e]:[t],r=c.gBa(t,o||H.CultureManager.q4(),n),e||o||(a[t]=r)),r?new Date(r):r},c.lb=function(t,e){return c.gBa(t,H.CultureManager.q4("invariant"),[t,e])},c.Wb=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O;if(t=t.trim(),(a=(i=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p;if(t.Rb){if(t.Rb[e])return t.Rb[e]}else t.Rb={};for(n=(n=(n=e).replace("%M","M")).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1"),r="^",i={Qb:""},a=[],l=s=0,u=G();(c=u.exec(n))!==B;)if(i.Qb="",h=n.slice(s,c.index),s=u.lastIndex,l+=W(h,i),r+=i.Qb,l%2!=1){switch(c[0]){case"dddd":case"ddd":case"MMMM":case"MMM":case"gggg":case"ggg":case"gg":case"g":r+="(\\D+)";break;case"tt":case"t":r+="(\\D*)";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":r+="(\\d\\d?\\d?)";break;case"eee":case"ee":case"e":r+=o?"(\\u5143|\\d\\d?)":"(\\d\\d?)";break;case"yyy":case"yyyy":r+="(\\d{2}|\\d{4})";break;case"fff":case"000":r+="(\\d{3})";break;case"ff":case"00":r+="(\\d{2})";break;case"f":case"0":r+="(\\d)";break;case"zzz":r+="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":r+="([+-]?\\d\\d?)";break;case"/":r+="/"===t.dateSeparator?"(\\/)":"([\\/\\"+t.dateSeparator+"])";break;default:throw Error(F.getSR().Exp_InvalidDateFormat)}L.k.Sb(a,c[0])}else r+=c[0];return i.Qb="",W(n.slice(s),i),r+=i.Qb,p={Tb:f=(r+="$").replace(/\s+/g,"\\s+"),Ub:a,_a:RegExp(f)},t.Rb[e]=p}(n=o.DateTimeFormat,e,r=1041===o.id))._a.exec(t))===B)return B;for(s=i.Ub,b=f=h=c=u=l=B,C=v=z,w=y=m=g=p=0,x=s.length;w<x;w++)if(T=a[w+1])switch(s[w]){case"dd":case"d":if((h=V(T,10))<1||31<h)return B;break;case"MMMM":if((c=o.oa(T))<0||11<c)return B;break;case"MMM":if((c=o.ra(T))<0||11<c)return B;break;case"M":case"MM":case"%M":if((c=V(T,10)-1)<0||11<c)return B;break;case"e":case"ee":if((u=r&&"元"===T?1:(D=o,j=V(T,10),_=void 0,O=new Date,D.DateTimeFormat.eras&&j<100&&(j+=(_=H.aBb.ca(O).ea)-_%100)>D.DateTimeFormat.Calendar.TwoDigitYearMax&&(j-=100),j))<0||9999<u)return B;break;case"y":case"yy":case"yyy":case"yyyy":if((u=V(T,10))<0||9999<u)return B;break;case"h":case"hh":case"H":case"HH":if((p=V(T,10))<0)return B;break;case"m":case"mm":if((g=V(T,10))<0||59<g)return B;break;case"s":case"ss":if((m=V(T,10))<0||59<m)return B;break;case"tt":case"t":if(v=(A=T.toUpperCase())===n.pmDesignator.toUpperCase(),C=A===n.amDesignator.toUpperCase(),!v&&!C)return B;break;case"f":case"0":if((y=100*V(T,10))<0||999<y)return B;break;case"ff":case"00":if((y=10*V(T,10))<0||999<y)return B;break;case"fff":case"000":if((y=V(T,10))<0||999<y)return B;break;case"dddd":if((f=o.ua(T))<0||6<f)return B;break;case"ddd":if((f=o.wa(T))<0||6<f)return B;break;case"zzz":if(2!==(S=T.split(/:/)).length)return B;if((d=V(S[0],10))<-12||13<d)return B;if((M=V(S[1],10))<0||59<M)return B;b=60*d+(P.u.kb(T,"-")?-M:M);break;case"z":case"zz":if((d=V(T,10))<-12||13<d)return B;b=60*d;break;case"g":case"gg":case"ggg":if(!T||!n.eras)return B;if((l=H.aBb.ha(s[w],T))<0)return B}if(N=(I=/^(\d|\d\d|\d\d\d):/.test(t))?new Date(1899,11,30):new Date,(k=n.Calendar.convert)&&(R=k.fromGregorian(N)),k||(R=[N.getFullYear(),N.getMonth(),N.getDate()]),u===B?u=R[0]:u<100&&(n.eras&&l!==B?u=H.aBb.ga(l||0,u):u+=30<=u?1900:2e3),c===B&&(c=R[1]),h===B&&(h=I?R[2]:1),k){if((N=k.toGregorian(u,c,h))===B)return B}else{if(N.setFullYear(u,c,h),N.getDate()!==h)return B;if(f!==B&&N.getDay()!==f)return B}return v&&p<12?p+=12:C&&12===p&&(p=0),N.setHours(p,g,m,y),b!==B&&(E=N.getMinutes()-(b+N.getTimezoneOffset()),N.setHours(N.getHours()+E/60,E%60)),N},c.Xb=function(t){var e,o=t-25569,n=0<=o?1:-1,r=u(new Date(864e5*o)),i=(864e5*t*1440+n-3181192704e6+864e5*r)/1440,a=new Date(i),s=0<=r?1:-1,l=u(new Date(i+36e5*s));if(60<=_(r-l))if(e=new Date(i+60*(l-r)*1e3),l<r){if(-1==s||l===u(a))return 999===e.getMilliseconds()?new Date(e.valueOf()+1):e}else if(r<l&&(1==s||l===u(a)))return 999===e.getMilliseconds()?new Date(e.valueOf()+1):e;return 999===a.getMilliseconds()?new Date(a.valueOf()+1):a},c.Rka=function(t){if("/OADate("===t.substr(0,8)){var e=parseFloat(t.substr(8,t.length-10));return c.Xb(e)}},c.Daa=function(t){return"/OADate("+c.Ra(t)+")/"},c.Ra=function(t){if(i(t))return 0;"number"==typeof t&&(t=new Date(t));var e=u(t);return(1440*t.getTime()+3181192704e6-864e5*e)/124416e6},c.Yb=function(t){var e,o,n=B,r=D;if(i(t)?n=c.Xb(0):t instanceof Date?n=new Date(t.valueOf()):"string"==typeof t?((e=c.Qa(t))||(isNaN(t)?c.fvb(t)?r=z:(e=new Date(t),isNaN(e.valueOf())&&(r=z),(o=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/.exec(t.replace(/ |\n/g,"").trim()))&&4===o.length&&(-1!==o.indexOf(""+e.getFullYear())&&-1!==o.indexOf(""+(e.getMonth()+1))&&-1!==o.indexOf(""+e.getDate())||(r=z))):(e=c.Xb(parseFloat(t)))||(r=z)),n=e):"number"==typeof t?n=c.Xb(t):r=z,r)return n;throw F.getSR().Exp_InvalidCast},c.fvb=function(t){function e(e,t){var o=0;return t.forEach(function(t){t&&-1<e.indexOf(t)&&o++}),1<o}var o=H.CultureManager.q4().DateTimeFormat;return e(t,o.monthNames)||e(t,o.abbreviatedMonthNames)||e(t,o.dayNames)||e(t,o.abbreviatedDayNames)||function(t,e){if(t&&-1<t.indexOf(" ")){var o=t.split(" "),n=o.length;return 2<=n&&e.indexOf(o[n-2])<=-1&&!isNaN(o[n-1])}return!1}(t,o.monthNames.concat(o.abbreviatedMonthNames))},c.Ska=function(t){return t&&(t.constructor===Date||t.getUTCDate&&t.setFullYear)},F.l=c},"./src/common/util/functionhelper.ts":function(t,e,o){"use strict";var z,W,G;function u(t){return t}function c(t,e,o,n,r,i,a,s,l,u,c){var h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_=o[W],O=o[G],F=e[W],P=e[G],L=n[W],H=n[G],B=1===O,V=1===P;if(F===_&&P===O){for(y=_*O,h=k=R=N=I=0;h<_;h++)for(f=0;f<O;f++){if(d=i(o[h][f]),g=i(e[h][f]),t&&(z(d)||z(g)))return l;I+=d,N+=d*d,R+=g=u(g),k+=d*g}for(E=y*k-I*R,m=r?E/(y*N-I*I):k/N,b=r?(R*N-I*k)/(y*N-I*I):0,v=[],h=0;h<L;h++)for(v[h]=[],f=0;f<H;f++){if(d=i(n[h][f]),t&&z(d))return l;v[h][f]=0==E?e[0][0]:c(m*d+b)}return a?new a(v):v}if(V&&F===_||1===F&&P===O){for(d=[],g=[],S=O+1,M=O+2,h=0;h<_;h++){if(b=i(w=V?e[h][0]:e[0][h]),t&&z(b))return l;g[h]=B?u(b):b}for(h=0;h<_;h++)for(d[h]=[],f=0;f<O;f++){if(b=i(o[h][f]),t&&z(b))return l;d[h][f]=b}for(D=[],m=0;m<S;m++)for(D[m]=[],y=0;y<M;y++)D[m][y]=0;for(p=0;p<_;p++)for(D[0][S]+=g[p],h=0;h<O;h++)for(w=h+1,D[0][w]+=d[p][h],D[w][0]=D[0][w],D[w][S]+=d[p][h]*g[p],f=h;f<O;f++)D[T=f+1][w]+=d[p][h]*d[p][f],D[w][T]=D[T][w];for(D[0][0]=_,C=j=r?0:1;C<S;C++){if(t){if(0===D[C][C]){for(A=!1,f=C+1;!A&&f<S;f++)if(0!==D[f][C]){for(p=0;p<M;p++)T=D[C][p],D[C][p]=D[f][p],D[f][p]=T;A=!0}if(!A)return s}}else{for(h=C;h<S&&0===D[h][C];)h++;if(S<=h)return s;for(x=j;x<M;x++)w=D[C][x],D[C][x]=D[h][x],D[h][x]=w}for(w=1/D[C][C],x=j;x<M;x++)D[C][x]*=w;for(h=j;h<S;h++)if(h!==C)for(w=-D[h][C],x=0;x<M;x++)D[h][x]+=w*D[C][x];r||(D[0][S]=0)}for(v=[],V||(v[0]=[]),h=0;h<L;h++){for(V&&(v[h]=[]),w=D[0][S],f=0;f<O;f++){if(b=i(V?n[h][f]:n[f][h]),t&&z(b))return l;w+=D[f+1][S]*b}V?v[h][0]=c(w):v[0][h]=c(w)}return a?new a(v):v}return s}Object.defineProperty(e,"__esModule",{value:!0}),z=isNaN,W="rowCount",G="colCount",e.qc=function(t,e,o,n,r,i,a,s){return c(!0,t,e,o,n,r,i,s,a,u,u)},e.sc=function(t,e,o,n,r,i,a){var s,l;for(s=0;s<t[W];s++)for(l=0;l<t[G];l++)if(t[s][l]<=0)return i;return c(!1,t,e,o,n,u,r,a,null,Math.log,Math.exp)}},"./src/common/util/numberhelper.ts":function(t,e,o){"use strict";var n,r,i,b,a,v,M,g,C,m,w,x,I,N,h,S,R,k,s,l,E,u,c,D,j,_,O,y,F;function f(t,e,o,n){return e&&0!==e.length&&"i"!==e?(r=t,i=e,a=o.NumberFormat,s=n,l=p(i),d(r,l,a,s)):o&&0<o.name.length?t.toLocaleString():""+t;var r,i,a,s,l}function P(t,e){for(var o,n,r,i,a,s,l,u=h(S(t)),c={Xa:1,Ya:0};10<=u;)u/=10,c.Xa++;return n=(o=""+t).search(/e/gi),r=o.indexOf(e),-1!==n?(a=E(o,0,n),s=E(o,n+1),l=0,-1!==r&&(l=E(a,r+1).length),(i=l-x(s))<0&&(i=0)):(i=0,-1!==r&&(i=E(o,r+1).length)),c.Ya=i,c}function T(t){var e,o={Za:t.charAt(0),$a:0,_a:0},n="";for(e=1;e<t.length;e++)if("+"===(n=t.charAt(e)))o.$a=1;else{if("-"!==n){if("0"!==n)throw Error(D().Exp_InvalidExponentFormat);o._a=t.length-e;break}o.$a=-1}return o}function p(t){var e,o,n,r,i,a,s={ab:C,bb:C,cb:I,eb:0,fb:0,Rja:0,hb:C},l="",u=I,c=I,h=I,f=I,p=I,d=I,g=C,m=[];for(o=0;o<t.length;o++){if(e=t.charAt(o),u)l+=e,'"'===e&&(m.push(l),l="",u=I);else if(c){if("E"===g||"e"===g){if(!(0<=["+","-","0"].indexOf(e))){c=I,o--;continue}l+=e}else if("+"===g||"-"===g){if("0"!==e){c=I,o--;continue}l+=e}else if("0"===g){if("0"!==e){c=I,p||(p=N,s.hb=T(l)),o--;continue}l+=e}}else if("*"!==g&&"_"!==g&&"\\"!==g||""===l)if("*"===e||"_"===e||"\\"===e)d=I,""!==l&&(m.push(l),l=""),l+=e;else if("'"===e)d=I,""!==l&&(m.push(l),l=""),m.push(e);else if('"'===e)d=I,u=N,""!==l&&(m.push(l),l=""),l+=e;else if(0<=y.indexOf(e))d=N,y.indexOf(g)<0&&""!==l&&(m.push(l),l=""),l+=e;else if("."!==e||h)if("%"===e)d=I,s.fb++,""!==l&&(m.push(l),l=""),m.push(e);else if("‰"===e)d=I,s.Rja++,""!==l&&(m.push(l),l=""),m.push(e);else if(","===e)if(d){for(n=void 0,""!==l&&(m.push(l),l=""),r=N,i="",a=o+1;a<t.length;a++)if(n=t.charAt(a),""===i)if('"'===n)i=n;else{if(0<=y.indexOf(n)){r=I;break}if("."===n||";"===n)break}else'"'===n&&(i="");r?s.eb++:h||(n=t.charAt(o+1))&&0<=y.indexOf(n)&&(f=N)}else l+=e;else"E"===e||"e"===e?(d=I,c=N,""!==l&&(m.push(l),l="")):(d=I,0<=y.indexOf(g)&&""!==l&&(m.push(l),l="")),l+=e;else""!==l&&(m.push(l),l=""),s.ab=m,m=[],h=N,d=I;else l+=e,m.push(l),l="";g=e}return""!==l&&(c&&!p&&(s.hb=T(l)),m.push(l)),f&&(s.cb=N),h?s.bb=m:s.ab=m,s}function L(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d=(c=+(c=t),h=+(h=-e),isNaN(c)||h%1!=0?NaN:(c=(f=c<0)?-c:c,typeof h===m||0===h?(c=Math.round(c),f?-c:c):(p=(""+c).split("e"),c=Math.round(+(p[0]+"e"+(p[1]?p[1]-h:-h))),+((p=(""+(c=f?-c:c)).split("e"))[0]+"e"+(p[1]?+p[1]+h:h)))));return isFinite(d)||(d=t),a=(u=(a=""+(t=d)).split(/e/i))[0],l=1<u.length?w(u[1],10):0,a=(u=a.split("."))[0],s=1<u.length?u[1]:"",0<l?(a+=(s=g(s,l)).slice(0,l),s=E(s,l)):l<0&&(l=-l,s=(a=t<0?i+M(a.replace(i,""),l+1):M(a,l+1)).slice(-l,a.length)+s,a=a.slice(0,-l)),a+(s=0<e?r+(s=s.length>e?s.slice(0,e):g(s,e)):"")}function H(t){var e,o,n=C;if(t)for(n="",e=0;e<t.length;e++)o=t[e],/^(0|#|\?)+/g.test(o)&&(n+=o);return n}function B(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d,g,m,y,b,v=s.numberGroupSizes,C=s.numberGroupSeparator,w=s.negativeSign,x=s.percentSymbol,T=s.perMilleSymbol,A=n.hb,S=E(e,0,1);for(S===w&&(e=E(e,1)),e=0===(l=1===e.length&&"0"===e?0:e.length)?"":e,u=0,c="",h=t.length-1;0<=h;h--)if(f="",p=t[h],/^(0|#|\?)+/g.test(p)){if(c!==o){for(d=p.length,g=l-u-1;0<=g&&0<d;g--)f=e.charAt(g)+f,d--,u++;for(m=d-1;0<=m;m--)u++,"0"===(y=p[m])?f=y+f:"?"===y&&(""!==f&&(i.push({type:"number",value:f}),f=""),i.push({type:"numberPlaceholder",value:y}));(c=p+c)===o&&u<l&&(f=e.substr(0,l-u)+f),""!==f&&i.push({type:"number",value:f})}}else n.hb&&!a.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(p)?(a.replaceExponent=N,b="",b+=A.Za,b+=O[A.$a],b+=M(""+r,A._a),i.push({type:"exponent",value:b})):"_"===p[0]?i.push({type:"placeholder",value:p[1]}):"*"===p[0]?a.hasInfilling||(i.push({type:"fillingChar",value:p[1]}),a.hasInfilling=!0,a.infillIndex=i.length-1):"\\"===p[0]?2===p.length&&i.push({type:"text",value:p[1]}):'"'===p[0]&&'"'===p[p.length-1]?2<p.length&&i.push({type:"text",value:p.substr(1,p.length-2)}):p===x?i.push({type:"percent",value:p}):p===T?i.push({type:"permille",value:p}):F[p]?i.push({type:"currency",value:p}):i.push({type:"text",value:p});S===w&&o&&i.push({type:"text",value:S}),n.cb===N&&function(t,e,o,n){var r,i,a,s,l,u=e[0],c=1,h=0,f=I,p=t.length;for(r=0;r<p;r++)if("number"===(i=t[r].type)){for(a="",l=(s=t[r].value).length-1;0<=l;){if(!(1<=u&&u<=9||0===u&&c===e.length))throw Error(D().Exp_InvalidNumberGroupSize);/\d/gi.test(s[l])?(f&&(a&&t.push({type:"number",value:a}),t.push({type:"groupSeparator",value:o}),a="",f=I),h++):h=0,a=s[l]+a,h===u&&0<u&&(f=N,h=0,c<e.length&&(u=e[c],c++)),l--}a&&t.push({type:i,value:a})}else"fillingChar"===i&&(n.infillIndex=t.length-p),t.push({type:i,value:t[r].value});t.splice(0,p)}(i,v,C,a),i.reverse(),a.infillIndex=i.length-1-a.infillIndex}function d(t,e,o,n){var r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A=[];return v=t,C=e.fb,w=e.Rja,x=e.eb,T=v,0<C&&(T=W(T*R(100,C),15)),0<w&&(T=W(T*R(1e3,w),15)),0<x&&(T=W(T/R(1e3,x),15)),t=T,r=e.ab,i=e.bb,(r||i)&&(a=H(r),s=(s=H(i))||"",e.hb&&(t=(u=function(t,e,o){var n,r={value:t,exponentValue:0},i=P(t,".").Xa,a=S(t),s=o?o.length:1;if(1<=a)s<i?(i-=s,r.value=t/R(10,i),r.exponentValue=i):r.exponentValue=0,-1===e.$a&&(e.$a=0);else if(a<1&&0<a){for(e.$a=-1,n=R(10,s);10*a<n;)a*=10,r.exponentValue++;r.value*=R(10,r.exponentValue)}return r}(t,e.hb,a)).value,l=u.exponentValue),15<(c=P(t,".")).Xa+c.Ya&&(t=W(t,15)),o.numberGroupSizes,o.numberGroupSeparator,h=o.numberDecimalSeparator,f=o.negativeSign,p=L(t,k(c.Ya,s.length),0,0,h,f),n||(y=h,-1!==(b=m=p).indexOf(y)&&(b=m.replace(/0+$/,"")),p=b),""===p?A.push({type:"text",value:(r?r.join(""):"")+(i?i.join(""):"")}):(d={hasInfilling:I,infillIndex:-1,replaceExponent:I},"10"!==(g=p.split(h)[0])||isNaN(l)||(g="1",l+=e&&e.hb&&-1===e.hb.$a?-1:1),r&&B(r,g,a,e,l,A,d,o),"0"!==g&&""===a&&i&&A.push({type:"number",value:g}),i&&function(t,e,o,n,r,i,a,s,l){var u,c,h,f,p,d,g,m,y,b,v,C,w=l.numberDecimalSeparator,x=l.percentSymbol,T=l.perMilleSymbol,A=e.indexOf(w),S=r.hb;for((0<A||n!==j||o!==_)&&a.push({type:"decimalSeparator",value:w}),u=-1!==A?e.substring(A+1):"",h="",f=c=0;f<t.length;f++)if(p=t[f],/^(0|#|\?)+/g.test(p)){if(d="",h!==o){for(g=p.length,m=0,y=c;0<g&&0<u.length-c;)d+=u.charAt(y),g--,c++,m++,y++;for(b=m;0<g;)v=p[b],b++,c++,g--,"0"===v?d+=v:"?"===v&&(""!==d&&(a.push({type:"number",value:d}),d=""),a.push({type:"numberPlaceholder",value:v}));""!==d&&a.push({type:"number",value:d}),h+=p}}else S&&!s.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(p)?(s.replaceExponent=N,C="",C+=S.Za,C+=O[S.$a],C+=M(""+i,S._a),a.push({type:"exponent",value:C})):"_"===p[0]?a.push({type:"placeholder",value:p[1]}):"*"===p[0]?(a.push({type:"fillingChar",value:p[1]}),s.hasInfilling&&a.splice(s.infillIndex,1),s.hasInfilling=!0,s.infillIndex=a.length-1):"\\"===p[0]?2===p.length&&a.push({type:"text",value:p[1]}):'"'===p[0]&&'"'===p[p.length-1]?2<p.length&&a.push({type:"text",value:p.substr(1,p.length-2)}):p===x?a.push({type:"percent",value:p}):p===T?a.push({type:"permille",value:p}):F[p]?a.push({type:"currency",value:p}):a.push({type:"text",value:p})}(i,p,s,a,e,l,A,d,o))),A}function A(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y;return(t=v(t)?"":b.u.ib(t,"")).match(/^[+-]?infinity$/i)?x(t):t.match(/^0x[a-f0-9]+$/i)?w(t,10):(i=(r=V(t,o=e.NumberFormat,n=o.numberNegativePattern))[0],a=r[1],""===i&&1!==n&&(i=(r=V(t,o,1))[0],a=r[1]),""===i&&(i="+"),a[0]===o.currencySymbol&&(a=E(a,1)),(u=a.indexOf("e"))<0&&(u=a.indexOf("E")),s=u<0?(l=a,C):(l=E(a,0,u),E(a,u+1)),h=(f=l.indexOf("."))<0?(c=l,C):(c=E(l,0,f),E(l,f+1)),c=c.split(",").join(""),","!==(p=",".replace(/\u00A0/g," "))&&(c=c.split(p).join("")),d=i+c,h!==C&&(d+="."+h),d[d.length-1]===o.percentSymbol&&(d=E(d,0,d.length-1),-1===(g=(d=b.u.ib(d,"")).indexOf("."))&&(g=d.length),m="",m+=E(d,0,g-2),m+=".",m+=E(d,g-2,2),d=m+=E(d,g+1)),s!==C&&(""===(y=V(s,o,1))[0]&&(y[0]="+"),d+="e"+y[0]+y[1]),d.match(/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/)?x(d):NaN)}function V(t,e,o){var n=e.negativeSign,r=e.positiveSign;if(4!==o&&2!==o||(n=" "+n,r=" "+r),4===o||3===o){if(b.u.jb(t,n))return["-",E(t,0,t.length-n.length)];if(b.u.jb(t,r))return["+",E(t,0,t.length-r.length)]}else if(2===o||1===o){if(b.u.kb(t,n))return["-",E(t,n.length)];if(b.u.kb(t,r))return["+",E(t,r.length)]}else{if(0!==o)throw Error("");if(b.u.kb(t,"(")&&b.u.jb(t,")"))return["-",E(t,1,t.length-2)]}return["",t]}function z(t){var e=a.CultureManager.q4().NumberFormat;return"string"==typeof t&&(e=a.CultureManager.q4(t).NumberFormat),e}function W(t,e){return"number"==typeof t&&e<=(""+t).length&&(t=+t.toPrecision(e)),t}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./src/common/util/common.ts"),r=o("./src/common/util/types.ts"),i=o("./src/common/util/regexhelper.ts"),b=o("./src/common/util/stringhelper.ts"),a=o("./src/common/culture/cultureInfo.ts"),v=r.j.Fa,M=b.u.Sa,g=b.u.Ta,C=null,m=void 0,w=parseInt,x=parseFloat,N=!(I=!1),h=Math.floor,S=Math.abs,R=Math.pow,k=Math.min,s="#dot#",l="#group#",E=function(t,e,o){return t.substr(e,o)},u=function(t){return i.q.qb(t)},c=new n.ResourceManager(n.SR),D=c.getResource.bind(c),j="##################0",_="################",O={1:"+",0:"","-1":"-"},y=["0","#","?"],F={"¤":"¤",Br:"Br",Fdj:"Fdj",Nfk:"Nfk",R:"R",$:"$",FCFA:"FCFA","GH₵":"GH₵","ብር":"ብር","ر.س.‏":"ر.س.‏",XDR:"XDR","د.إ.‏":"د.إ.‏","د.ب.‏":"د.ب.‏","د.ج.‏":"د.ج.‏","ج.م.‏":"ج.م.‏","₪":"₪","د.ع.‏":"د.ع.‏","د.ا.‏":"د.ا.‏","ف.ج.ق.‏":"ف.ج.ق.‏","د.ك.‏":"د.ك.‏","ل.ل.‏":"ل.ل.‏","د.ل.‏":"د.ل.‏","د.م.‏":"د.م.‏","أ.م.‏":"أ.م.‏","ر.ع.‏":"ر.ع.‏","ر.ق.‏":"ر.ق.‏","ج.س.":"ج.س.",S:"S","£":"£","ل.س.‏":"ل.س.‏","د.ت.‏":"د.ت.‏","ر.ي.‏":"ر.ي.‏","₹":"₹",TSh:"TSh","€":"€","₼":"₼","₽":"₽",K:"K","лв.":"лв.","₦":"₦",CFA:"CFA","৳":"৳","¥":"¥",KM:"KM","КМ":"КМ",USh:"USh","Kč":"Kč","kr.":"kr.",Ksh:"Ksh",CHF:"CHF","ރ.":"ރ.","Nu.":"Nu.",EC$:"EC$",P:"P",US$:"US$",D:"D",Rp:"Rp",Ar:"Ar",MOP$:"MOP$",Rs:"Rs",MK:"MK",RM:"RM","₱":"₱",RF:"RF",SR:"SR",SDG:"SDG",Le:"Le","NAf.":"NAf.",E:"E",T$:"T$",VT:"VT",WS$:"WS$",Bs:"Bs","₡":"₡",Q:"Q",L:"L",C$:"C$","B/.":"B/.","S/.":"S/.","₲":"₲","Bs.":"Bs.","ريال":"ريال",FG:"FG",UM:"UM",kr:"kr",FBu:"FBu",FC:"FC",DA:"DA",G:"G",CF:"CF",DH:"DH",FCFP:"FCFP",LS:"LS",DT:"DT",kn:"kn",HUF:"HUF","֏":"֏",ISK:"ISK","₾":"₾","​":"​","₸":"₸","៛":"៛","₩":"₩","сом":"сом",Kz:"Kz","₭":"₭",MTn:"MTn","ден":"ден","₮":"₮","रु":"रु","Afl.":"Afl.","ߖߕ.":"ߖߕ.","руб.":"руб.","zł":"zł","؋":"؋",R$:"R$",Db:"Db",RON:"RON","₴":"₴",MAD:"MAD","රු.":"රු.","Lekë":"Lekë",den:"den",RSD:"RSD","дин.":"дин.","ܠ.ܣ.‏":"ܠ.ܣ.‏","Rs.":"Rs.","смн":"смн","฿":"฿","m.":"m.","₺":"₺","ⴷⵔ":"ⴷⵔ","soʻm":"soʻm","сўм":"сўм","₫":"₫",HK$:"HK$",MOP:"MOP",NT$:"NT$"},e.o={Qa:function(t){return A(t,a.CultureManager.q4())},lb:function(t){return A(t,a.CultureManager.q4("invariant"))},mb:function(t,e,o,n){return f(t,e,o=o||a.CultureManager.q4(),n)},nb:function(t,e){var o,n,r;return"string"!=typeof t||(n=(o=z(e)).numberDecimalSeparator,r=o.numberGroupSeparator,"."!==n&&(t=t.replace(u("[.]"),s)),","!==r&&(t=t.replace(u("[,]"),l)),"."!==n&&(t=t.replace(u(s),n)),","!==r&&(t=t.replace(u(l),r))),t},Oa:function(t,e){var o,n,r;return"string"!=typeof t||(n=(o=z(e)).numberDecimalSeparator,r=o.numberGroupSeparator,"."!==n&&(t=t.replace(u("["+n+"]"),s)),","!==r&&(t=t.replace(u("["+r+"]"),l)),"."!==n&&(t=t.replace(u(s),".")),","!==r&&(t=t.replace(u(l),","))),t},Xia:function(t,e){var o,n,r;return!("string"==typeof t&&(n=(o=z(e)).numberDecimalSeparator,r=o.numberGroupSeparator,"."!==n&&"."!==r&&0<=t.indexOf(".")||","!==n&&","!==r&&0<=t.indexOf(",")))},ob:function(t,e){return x(this.Oa(t,e))},pb:function(t,e,o){if(0!==S(h(t)-t))throw Error(D().Exp_BadFormatSpecifier);var n=0<=t?t.toString(16):(4294967295+t+1).toString(16);return n=e?n.toLowerCase():n.toUpperCase(),!v(o)&&n.length<o?M(n,o):n},Hja:p,Ija:d,Jja:function(t){var e,o,n,r="";if(Array.isArray(t)&&0<t.length)for(e=0;e<t.length;e++)if(o=t[e].type,n=t[e].value,"placeholder"===o)r+=" ";else{if("fillingChar"===o)continue;r+="numberPlaceholder"===o?" ":n}return r},eka:j,fka:_,Lma:W}},"./src/common/util/rbush.ts":function(t,e,o){"use strict";function n(t,e){this.TMc=Math.max(4,t||9),this.UMc=Math.max(2,Math.ceil(.4*this.TMc)),e&&this.VMc(e),this.clear()}function c(t,e,o){if(!o)return e.indexOf(t);for(var n=0;n<e.length;n++)if(o(t,e[n]))return n;return-1}function s(t,e){y(t,0,t.children.length,e,t)}function y(t,e,o,n,r){(r=r||l(null)).minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var i=e,a=void 0;i<o;i++)a=t.children[i],h(r,t.leaf?n(a):a);return r}function h(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function i(t,e){return t.minX-e.minX}function a(t,e){return t.minY-e.minY}function b(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function f(t){return t.maxX-t.minX+(t.maxY-t.minY)}function p(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&(0<=e.maxX&&e.maxX<=t.maxX||t.maxX<0)&&(0<=e.maxY&&e.maxY<=t.maxY||t.maxY<0)}function u(t,e){return(-1===t.minY||-1===e.minY||t.minY<=e.maxY&&e.minY<=t.maxY)&&(-1===t.minX||-1===e.minX||t.minX<=e.maxX&&e.minX<=t.maxX)}function l(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}Object.defineProperty(e,"__esModule",{value:!0}),(e.rbush=n).prototype={all:function(){return this.zR(this.data,[])},search:function(t){var e,o,n,r,i,a=this.data,s=[],l=this.toBBox;if(!u(t,a))return s;for(e=[];a;){for(o=0,n=a.children.length;o<n;o++)r=a.children[o],u(t,i=a.leaf?l(r):r)&&(a.leaf?s.push(r):p(t,i)?this.zR(r,s):e.push(r));a=e.pop()}return s},collides:function(t){var e,o,n,r,i,a=this.data,s=this.toBBox;if(!u(t,a))return!1;for(e=[];a;){for(o=0,n=a.children.length;o<n;o++)if(r=a.children[o],u(t,i=a.leaf?s(r):r)){if(a.leaf||p(t,i))return!0;e.push(r)}a=e.pop()}return!1},insert:function(t){return t&&this.Eb(t,this.data.height-1),this},clear:function(){return this.data=l([]),this},remove:function(t,e){if(!t)return this;for(var o,n,r,i,a=this.data,s=this.toBBox(t),l=[],u=[];a||l.length;){if(a||(a=l.pop(),n=l[l.length-1],o=u.pop(),i=!0),a.leaf&&-1!==(r=c(t,a.children,e)))return a.children.splice(r,1),l.push(a),this.WMc(l),this;i||a.leaf||!p(a,s)?n?(o++,a=n.children[o],i=!1):a=null:(l.push(a),u.push(o),o=0,a=(n=a).children[0])}return this},toBBox:function(t){return t},compareMinX:i,compareMinY:a,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},zR:function(t,e){for(var o=[];t;)t.leaf?e.push.apply(e,t.children):o.push.apply(o,t.children),t=o.pop();return e},XMc:function(t,e,o,n){for(var r,i,a,s,l,u,c,h;n.push(e),!e.leaf&&n.length-1!==o;){for(c=h=1/0,r=0,i=e.children.length;r<i;r++)l=b(a=e.children[r]),f=t,p=a,(u=(Math.max(p.maxX,f.maxX)-Math.min(p.minX,f.minX))*(Math.max(p.maxY,f.maxY)-Math.min(p.minY,f.minY))-l)<h?(h=u,c=l<c?l:c,s=a):u===h&&l<c&&(c=l,s=a);e=s||e.children[0]}var f,p;return e},Eb:function(t,e,o){var n=this.toBBox,r=o?t:n(t),i=[],a=this.XMc(r,this.data,e,i);for(a.children.push(t),h(a,r);0<=e&&i[e].children.length>this.TMc;)this.YMc(i,e),e--;this.ZMc(r,i,e)},YMc:function(t,e){var o,n,r=t[e],i=r.children.length,a=this.UMc;this.$Mc(r,a,i),o=this._Mc(r,a,i),(n=l(r.children.splice(o,r.children.length-o))).height=r.height,n.leaf=r.leaf,s(r,this.toBBox),s(n,this.toBBox),e?t[e-1].children.push(n):this.aNc(r,n)},aNc:function(t,e){this.data=l([t,e]),this.data.height=t.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},_Mc:function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m;for(l=u=1/0,n=e;n<=o-e;n++)r=y(t,0,n,this.toBBox),i=y(t,n,o,this.toBBox),h=r,f=i,0,p=Math.max(h.minX,f.minX),d=Math.max(h.minY,f.minY),g=Math.min(h.maxX,f.maxX),m=Math.min(h.maxY,f.maxY),a=Math.max(0,g-p)*Math.max(0,m-d),s=b(r)+b(i),a<l?(l=a,c=n,u=s<u?s:u):a===l&&s<u&&(u=s,c=n);return c},$Mc:function(t,e,o){var n=t.leaf?this.compareMinX:i,r=t.leaf?this.compareMinY:a;this.bNc(t,e,o,n)<this.bNc(t,e,o,r)&&t.children.sort(n)},bNc:function(t,e,o,n){t.children.sort(n);var r,i,a=this.toBBox,s=y(t,0,e,a),l=y(t,o-e,o,a),u=f(s)+f(l);for(r=e;r<o-e;r++)i=t.children[r],h(s,t.leaf?a(i):i),u+=f(s);for(r=o-e-1;e<=r;r--)i=t.children[r],h(l,t.leaf?a(i):i),u+=f(l);return u},ZMc:function(t,e,o){for(var n=o;0<=n;n--)h(e[n],t)},WMc:function(t){for(var e=t.length-1,o=void 0;0<=e;e--)0===t[e].children.length?0<e?(o=t[e-1].children).splice(o.indexOf(t[e]),1):this.clear():s(t[e],this.toBBox)},VMc:function(t){var e=["return a"," - b",";"];this.compareMinX=Function("a","b",e.join(t[0])),this.compareMinY=Function("a","b",e.join(t[1])),this.toBBox=Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},"./src/common/util/regexhelper.ts":function(t,e,o){"use strict";var r;function l(){}Object.defineProperty(e,"__esModule",{value:!0}),r=o("./src/common/util/stringhelper.ts"),l.qb=function(t){var e=l.rb[t];return(e=e||(l.rb[t]=RegExp(t,"g"))).lastIndex=0,e},l.sb=function(t){var e=l.tb[t];return(e=e||(l.tb[t]=RegExp(t,"gi"))).lastIndex=0,e},l.ub=function(t,e,o){var n,r,i,a,s;if(l.vb[t])return l.wb[t];if(l.qb("[~?*]+").test(t)){for(n=[],r=t.split(""),a={".":!(i=void 0),"+":!0,$:!0,"^":!0,"[":!0,"]":!0,"(":!0,")":!0,"{":!0,"}":!0,"|":!0,"/":!0,"\\":!0},s=0;s<r.length;s++)"~"===(i=r[s])&&s<r.length-1?("*"===(i=r[++s])||"?"===i?n.push("\\"):e&&n.push("~"),n.push(i)):"?"===i?n.push("."):"*"===i?(n.push("[\\s\\S]"),o?n.push("+"):n.push("*")):(a[i]&&n.push("\\"),n.push(i));return n.join("")}return null},l.zb=function(t,e,o){var n=l.ub(t,e,o);return n=n&&"^"+n+"$"},l.xb=function(t,e){for(var o="#"+t+"0#",n=1;0<e.indexOf(o);)o=r.u.yb(o,"#"+t+(n-1)+"#","#"+t+n+"#"),n++;return o},l.Ab=function(t){return t.replace(/([\~\!\@\#\$\%\^\&\*\(\)\-\_\+\=\[\]\{\}\|\\\;\:\'\"\,\.\/\<\>\?])/,"\\$1")},l.rb={},l.tb={},l.vb={},l.wb={},e.q=l},"./src/common/util/stringhelper.ts":function(t,r,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("./src/common/util/regexhelper.ts");function n(t,e,o){return t.substr(e,o)}function a(t){return null==t}function s(t,e,o,n){var r,i;if(a(e))throw Error();return""===e||!(e.length>t.length)&&(r=t,i=e,o&&(r=r.toLowerCase(),i=i.toLowerCase()),n(r,i))}r.u={Bb:function(t,e,o){return o&&(t=t.toLowerCase(),e=e.toLowerCase()),""===e||0<=t.indexOf(e)},Cb:function(t,e,o){var n,r;return o?(n=t.toLowerCase(),r=e.toLowerCase(),n.indexOf(r)):t.indexOf(e)},Db:function(t,e){if(!e)return t;for(var o=t;n(o,0,e.length)===e;)o=n(o,e.length);return o},ib:function(t,e){if(!e)return t;for(var o=t;n(o,o.length-e.length,e.length)===e;)o=n(o,0,o.length-e.length);return o},Eb:function(t,e,o){if(e<0||e>t.length||a(o))throw Error();return n(t,0,e)+o+n(t,e,t.length-e)},Fb:function(t,e,o){if(a(o)&&(o=t.length-e),e<0||o<0||e+o>t.length)throw Error();return n(t,0,e)+n(t,e+o,t.length-e-o)},kb:function(t,e,o){return void 0===o&&(o=!1),s(t,e,o,function(t,e){return t.slice(0,e.length)===e})},jb:function(t,e,o){return void 0===o&&(o=!1),s(t,e,o,function(t,e){return t.slice(-e.length)===e})},Gb:function(t,e,o,n){if(!e)throw Error();return o=(""+o).replace(/\$/g,"$$$$"),t.replace(RegExp(e,"g"+(n?"i":"")),o)},Hb:function(t,e,o,n){return e=i.q.Ab(e),r.u.Gb(t,e,o,n)},Ib:function(t,e){var o=t.indexOf(e);return o<0||o>=t.length?t:n(t,0,o)},Jb:function(t,e){for(var o=0,n=t.indexOf(e);0<=n;)o+=1,n=t.indexOf(e,n+1);return o},yb:function(t,e,o){return t.split(e).join(o)},Kb:function(t,e){var o,n,r=t;for(o=0;o<e.length;o++)n=RegExp("\\{"+o+"\\}","g"),r=r.replace(n,e[o]);return r},Lb:function(t,e,o){var n,r=""+t;for(n=r.length;n<e;n++)r=o?"0"+r:r+"0";return r},Sa:function(t,e){return r.u.Lb(t,e,!0)},Ta:function(t,e){return r.u.Lb(t,e,!1)},Mb:function(t,e){return t===e||!t&&!e||t&&e&&t.toLowerCase()===e.toLowerCase()},Nb:function(t){return t.toUpperCase()},Ob:function(t){var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},o=i.q.qb("(?:&|<|>|\"|'|`)");return o.test(t)?t.replace(o,function(t){return e[t]}):t},Pb:function(t){var e={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#x60;":"`"},o=i.q.qb("(?:&amp;|&lt;|&gt;|&quot;|&#x27;|&#x60;)");return o.test(t)?t.replace(o,function(t){return e[t]}):t},BIc:function(t){return t.replace(/javascript:/gi,"")}}},"./src/common/util/types.ts":function(t,f,e){"use strict";Object.defineProperty(f,"__esModule",{value:!0}),f.j={r4:null,H:function(t,e){var o,n,r;if(f.j.ya(t))for(o=0,n=t.length;o<n&&!1!==e.call(t[o],o,t[o]);o++);else for(r in t)if(t.hasOwnProperty(r)&&!1===e.call(t[r],r,t[r]))break;return t},za:function(t){return!t||"object"==typeof t&&0===Object.keys(t).length},Aa:function(t){return"function"===f.j.Ba(t)},Ca:function(t){return Array.isArray?Array.isArray(t):"array"===f.j.Ba(t)},Da:function(t){return f.j.jk(t)&&(t=parseFloat(t)),!isNaN(t)&&isFinite(t)},jk:function(t){return"string"==typeof t},Ba:function(t){var e,o,n,r,i,a;if(null===t)return"null";if(!(e=f.j.r4))for(e=f.j.r4={},n=0,r=(o=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"]).length;n<r;n++)e["[object "+o[n]+"]"]=o[n].toLowerCase();return i=e.toString,"object"==(a=typeof t)||"function"==a?e[i.call(t)]||"object":a},Ea:function(t,e,o){var n,r;if(e){if(r=[].indexOf)return r.call(e,t,o);for(n=e.length,f.j.Fa(o)&&(o=0),o=o<0?Math.max(0,n+o):o;o<n;o++)if(o in e&&e[o]===t)return o}return-1},Ga:function(t,e){var o=e.length,n=t.length,r=0;if("number"==typeof o)for(;r<o;r++)t[n]=e[r],n++;else for(;void 0!==e[r];)t[n]=e[r],n++,r++;return t.length=n,t},Ha:function(t,e,o){var n,r,i,a,s=[];if(f.j.ya(t))for(r=0,i=t.length;r<i;r++)null!==(n=e(t[r],r,o))&&(s[s.length]=n);else for(a in a=void 0,t)t.hasOwnProperty(a)&&(null!==(n=e(t[a],a,o))&&(s[s.length]=n));return s.concat([])},Ia:function(){var t,e,o,n,r,i,a,s,l,u,c,h=[];for(t=0;t<arguments.length;t++)h[t]=arguments[t];for(s=h[0]||{},l=1,u=h.length,c=!1,"boolean"==typeof s&&(c=s,s=h[1]||{},l=2),"object"==typeof s||f.j.Aa(s)||(s={}),u===l&&(s=this,--l);l<u;l++)if(i=h[l],!f.j.Fa(i))for(r in i)e=s[r],s!==(n=i[r])&&(o=f.j.Ca(n),c&&n&&(f.j.Ja(n)||o)?(a=o?e&&f.j.Ca(e)?e:[]:e&&f.j.Ja(e)?e:{},s[r]=f.j.Ia(c,a,n)):void 0!==n&&(s[r]=n));return s},G:function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n},Ka:function(t){return null!==t&&t===t.window},Ja:function(t){var e,o;if(!t||"object"!==f.j.Ba(t)||t.nodeType||f.j.Ka(t))return!1;e={}.hasOwnProperty;try{if(t.constructor&&!e.call(t,"constructor")&&!e.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}for(o in t);return void 0===o||e.call(t,o)},ya:function(t){if(f.j.Fa(t))return!1;var e=t.length,o=f.j.Ba(t);return!f.j.Ka(t)&&(!(1!==t.nodeType||!e)||"array"===o||"function"!==o&&(0===e||"number"==typeof e&&0<e&&e-1 in t))},La:function(t,e){var o=e||[];return null!==t&&(f.j.ya(Object(t))?f.j.Ga(o,"string"==typeof t?[t]:t):[].push.call(o,t)),o},Ma:null,Fa:function(t){return null==t},Na:null,Pa:null,C4:function(t){if(!t)return t;if("number"==typeof t||"string"==typeof t||"boolean"==typeof t||f.j.Fa(t))return t;if(t.clone)return t.clone();if(t instanceof Date)return new Date(t.valueOf());var e,o,n;for(o in e=t instanceof Object?new t.constructor:new t.constructor(t.valueOf()),t)t.hasOwnProperty(o)&&(n=t[o],t.hasOwnProperty(o)&&e[o]!==n&&(e[o]="object"==typeof n?f.j.C4(n):n));return e.toString=t.toString,e.valueOf=t.valueOf,e}}},"./src/common/util/util.res.en.ts":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_InvalidDateFormat="Invalid date format pattern",e.Exp_InvalidExponentFormat="invalid exponent format",e.Exp_InvalidSemicolons="invalid format : too many semicolons",e.Exp_InvalidNumberGroupSize="NumberGroupSize must be between 1 and 9, except for the last element, which can be zero.",e.Exp_BadFormatSpecifier="Bad Format Specifier",e.Exp_InvalidNumberFormat="Invalid number format pattern",e.Exp_InvalidCast="InvalidCastException",e.Exp_Separator="numberDecimalSeparator, listSeparator and arrayListSeparator should be different in cluture info."},"./src/plugins/commands/commands.entry.ts":function(t,e,o){"use strict";var n,r;Object.defineProperty(e,"__esModule",{value:!0}),n=o("./src/plugins/commands/commands.ts"),e.Key=n.Key,e.CommandManager=n.CommandManager,r=o("./src/plugins/commands/undomanager.ts"),e.UndoManager=r.UndoManager},"./src/plugins/commands/commands.ts":function(t,e,o){"use strict";var a,l,n;function r(t){this.xc=t,this.Ze={},this.dNc={},this.wc={}}function i(t,e,o){var r,i;this.tc=t,this.j4=e,this.Cj=o,r=this,Object.defineProperty(r,"shortcutKey",{get:function(){return r.vc},set:function(t){var e,o,n=r.vc;n!==t&&(!(e=(i=r.tc.wc)[n])||0<=(o=e.indexOf(r))&&e.splice(o,1),(r.vc=t)&&((e=i[t])||(i[t]=e=[]),e.splice(0,0,r)))}})}Object.defineProperty(e,"__esModule",{value:!0}),(n=a=e.Key||(e.Key={}))[n.left=37]="left",n[n.right=39]="right",n[n.up=38]="up",n[n.down=40]="down",n[n.tab=9]="tab",n[n.enter=13]="enter",n[n.shift=16]="shift",n[n.ctrl=17]="ctrl",n[n.space=32]="space",n[n.altkey=18]="altkey",n[n.home=36]="home",n[n.end=35]="end",n[n.pup=33]="pup",n[n.pdn=34]="pdn",n[n.backspace=8]="backspace",n[n.del=46]="del",n[n.esc=27]="esc",n[n.a=65]="a",n[n.c=67]="c",n[n.v=86]="v",n[n.x=88]="x",n[n.z=90]="z",n[n.y=89]="y",i.prototype.canUndo=function(){return this.j4.canUndo},i.prototype.execute=function(t,e,o){var n,r=!0;this.j4&&e&&this.j4.canUndo&&this.tc.cNc({command:e,result:n,s4:o});try{r=!1!==(n=(this.j4.execute||this.j4)(t,e,1===o))}catch(t){r=!1}return e&&r&&this.tc.g4({command:e,result:n,s4:o}),n},l=i,r.prototype.register=function(t,e,o,n,r,i,a){var s=new l(this,e,t);this[t]=s,o&&(s.shortcutKey=this.getShortcutKey(o,n,r,i,a))},r.prototype.getCommand=function(t){return this[t]},r.prototype.execute=function(t){var e=this[t.cmd];if(e)return e.execute(this.xc,t,0)},r.prototype.setShortcutKey=function(t,e,o,n,r,i){var a,s,l,u;if(t)(a=this[t])&&(a.shortcutKey=this.getShortcutKey(e,o,n,r,i));else if(s=this.getShortcutKey(e,o,n,r,i),l=this.getCommands(s))for(u=l.length-1;0<=u;u--)l[u].shortcutKey=void 0},r.prototype.getShortcutKey=function(t,e,o,n,r){if(t){var i="A".charCodeAt(0)<=t&&t<="Z".charCodeAt(0)?String.fromCharCode(t):a[t];return(i=i||t)+(e?"+ctrl":"")+(o?"+shift":"")+(n?"+alt":"")+(r?"+window":"")}},r.prototype.getCommands=function(t){return this.wc[t]},r.prototype.addListener=function(t,e){this.Ze[t]=e},r.prototype.removeListener=function(t){delete this.Ze[t]},r.prototype.g4=function(t){var e,o=this.Ze;for(e in o)o.hasOwnProperty(e)&&o[e](t)},r.prototype.EKc=function(t,e){this.dNc[t]=e},r.prototype.eNc=function(t){delete this.dNc[t]},r.prototype.cNc=function(t){var e,o=this.dNc;for(e in o)o.hasOwnProperty(e)&&o[e](t)},r.prototype.no=function(){this.xc=null},e.CommandManager=r},"./src/plugins/commands/undomanager.ts":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=(r.prototype.Cc=function(t,e){var o,n,r;if(t)if(1===e)this.Bc.push(t);else{if(o=this.yc,n=this.Ac.length,0<o&&o<=n)for(r=0;r<n-o+1;r++)this.Ac.shift();this.Ac.push(t),0===e&&(this.Bc=[])}},r.prototype.canUndo=function(){return 0<this.Ac.length},r.prototype.undo=function(){var t,e,o=this.Ac,n=!0;if(this.zc&&this.canUndo()){t=o[o.length-1];try{(e=this.xc.commandManager()[t.cmd])&&(t.yTa=!0,n=e.execute(this.xc,t,1))}catch(t){n=!1}delete t.yTa,!1!==n&&(o.pop(),this.Bc.push(t))}return n},r.prototype.canRedo=function(){return 0<this.Bc.length},r.prototype.redo=function(){var t,e,o=this.Bc,n=!0;if(this.zc&&this.canRedo()){t=o[o.length-1];try{(e=this.xc.commandManager()[t.cmd])&&(t.yTa=!0,n=e.execute(this.xc,t,2))}catch(t){n=!1}delete t.yTa,!1!==n&&(o.pop(),this.Ac.push(t))}return n},r.prototype.getRedoStack=function(){return this.Bc.slice()},r.prototype.getUndoStack=function(){return this.Ac.slice()},r.prototype.maxSize=function(t){return arguments.length<1?this.yc:(0<=t&&(this.yc=t),this)},r.prototype.clear=function(){this.Ac=[],this.Bc=[]},r.prototype.PY=function(t){this.Ac=this.Ac.filter(t),this.Bc=this.Bc.filter(t)},r.prototype.no=function(){this.xc=null},r);function r(t,e,o){this.xc=t,e<0&&(e=2147483647),this.yc=e,this.zc=o,this.Ac=[],this.Bc=[]}e.UndoManager=n},"./src/plugins/formatter/formatter.entry.ts":function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),function(t){for(var e in t)o.hasOwnProperty(e)||(o[e]=t[e])}(e("./src/plugins/formatter/formatter.ts"))},"./src/plugins/formatter/formatter.res.en.ts":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_TokenIsNull="token is null",e.Exp_InvalidBackslash="the '\\' cannot be evaluated",e.Exp_FormatIllegal="format is illegal.",e.Exp_ValueIsNull="value is null",e.Exp_DuplicatedDescriptor="The type of descriptor was added.",e.Exp_TokenIllegal="token is illegal.",e.Exp_ValueIllegal="value is illegal.",e.Exp_InvalidCast="InvalidCastException"},"./src/plugins/formatter/formatter.ts":function(t,e,o){"use strict";var M,I,N,n,T,r,i,a,c,R,A,v,h,s,f,p,d,l,u,k,g,m,y,x,S,b,E,D,j,C,_,w,O,F,P,L,H,B,V,z,W,G,U,J,Z,q,K,Y,Q,X,$,tt=this&&this.__extends||(X=function(t,e){return(X=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}X(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function et(t,e,o,n){var r;xt.call(this,e,o,n),r=Ct(t,!1),e&&(r=yt(r,this.Ic.Kc,this.Ic.currencySymbol())),r=bt(r=gt(r)),this.Yc=r,this._c=3}function ot(t,e,o,n){xt.call(this,e,o,n),0<arguments.length?(ot.kBb(t)||F(),this.Bd=t):this.Bd="General",this._c=0}function nt(t,e,o,n){var r,i,a,s,l;xt.call(this,e,o,n),(r=this).Ad=!1,r._c=1,r.Bd=gt(t),i=Ct(t),e&&(i=yt(i,r.Ic.Kc,r.Ic.currencySymbol())),-1<(i=gt(i)).indexOf("/")&&((a=function(t,e){var o,n,r,i,a,s=[];if(t===R||""===t)return s;for(o=!1,r=!(n=[]),i=0;i<t.length;i++)'"'!==(a=t[i])||o||(r=!r),o||r||a!==e?n.push(a):(s.push(n.join("")),n=[]),o="\\"===a&&!o;return s.push(n.join("")),s}(i,"/"))&&2===a.length&&(r.Cd=a[1],(s=a[0])&&(-1<(l=s.lastIndexOf(" "))?(r.Dd=ht(s,0,l),r.Ed=ht(s,l+1,s.length-l-1)):r.Ed=s))),r.Fd=i}function rt(t,e){Tt.call(this,e),this.foreColor=t}function it(t,e){var o,n;if(Tt.call(this,e),"h"===(o=w(t)[0]))n=3600;else if("m"===o)n=60;else{if("s"!==o)throw Error(c().Exp_TokenIllegal);n=1}this.Tc=function(t){var e=t/1e3/n;return Math.abs(e-Math.round(e))<1e-6?Math.round(e):Math.floor(e)}}function at(t,e,o,n,r,i){xt.call(this,e,o,n,i);this.Yc=this.Zc(Ct(t)),this.$c=r,this._c=2,this.ad()}function st(t,e){Tt.call(this,e);if(this.token=t,this.type=parseInt(M.u.Fb(t,0,5),10),this.type<0||4<this.type)throw Error(c().Exp_TokenIllegal)}function lt(t,e){var n,o,r,i,a,s,l,u;for(Tt.call(this,e),n=this,s=0,l=(a=["<=","<>",">=",">","<","="]).length;s<l;s++)if(o=a[s],M.u.kb(t,o,!0)){r=M.u.Fb(t,0,o.length),u=parseFloat(r),D(u)||(i=u);break}if(i===R&&i===A)throw Error(c().Exp_TokenIllegal);n.value=i,n.Sc=o,n.isMeetCondition=function(t){var e=n.Sc,o=n.value;switch(e){case"<=":return t<=o;case"<>":return t!==o;case">=":return o<=t;case">":return o<t;case"<":return t<o;case"=":return t===o}}}function ut(t,e){this.formatCached=t,this.cultureName=e,this.typeName=""}function ct(t,e){var o,n,r;if(Tt.call(this,e),this.Uc=t,n=vt((o=this.Uc)[0],"$",!1),r=o.indexOf("-"),!(n&&-1<r))throw Error(c().Exp_TokenIllegal);this.Vc=ht(o,1,r-1),0<(o=M.u.Fb(o,0,r+1)).length&&(this.Wc=parseInt(o,16))}function ht(t,e,o){return t.substr(e,o)}function ft(t){return N.j.Fa(t)?"":"boolean"==typeof t?t?"TRUE":"FALSE":"string"==typeof t?t:""+t}function pt(t,e){if("\\"===t[e])throw Error(c().Exp_InvalidBackslash);if(0<e-1&&e-1<t.length&&"\\"===t[e-1]){if(e-2<0)return 1;if(0<e-2&&e-2<t.length)return"\\"!==t[e-2]}}function dt(t){if(!t)throw Error(c().Exp_TokenIsNull);return"["+t+"]"}function gt(t){var e,o,n,r,i;if(t===A||t===R||""===t)return t;for(e="",n=!1,r=o=0;r<t.length;r++)'"'===(i=t[r])?(n=!n,e+=i):n?e+=i:"["===i?o++:"]"===i?--o<0&&(o=0):0===o&&(e+=i);return""+e}function mt(t){return t=yt(t,"[",""),yt(t,"]","")}function yt(t,e,o){return!t||t===L.Dc||vt(e,o,!0)?t:(e=e.replace(l,"\\$1"),t.replace(RegExp(e,"g"),o))}function bt(t){var e,o,n=t.length,r=!1,i="";for(e=0;e<n;e++)"\\"===(o=t.charAt(e))?(r=!r)&&"@"!==t.charAt(e+1)||(i+=o):(r=!1,i+=o);return i}function vt(t,e,o){return o?w(t)===w(e):t===e}function Ct(t,e){var o,n,r,i;for(1===arguments.length&&(e=!0),o=!1,n="",r=0;r<t.length;r++){if('"'===(i=t[r]))o=!o;else if(!o&&!e&&"/"===i&&!pt(t,r))continue;n+=i}return n}function wt(t,e){var o,n,r;if(!t||t===L.Dc)return!1;for(o=function(t){var e,o,n,r="",i=!1;for(e=0,o=t.length;e<o;e++)'"'===(n=t[e])&&(i=!i),"E"===n||i||(r+=w(n));return r}(Ct(t)),n=0;n<e.length;n++){if(0===(r=o.indexOf(e[n])))return!0;if(0<r&&"_"!==o[r-1]&&"*"!==o[r-1])return!0}return!1}function xt(t,e,o,n){this.Ic=t,this.Jc=e,this.cultureName=o,this.nOb=n}function Tt(t){this.Kc=t}function At(t){var e,o,n=mt(t);return n&&n!==L.Dc&&(o=n[0],-1<["<",">","="].indexOf(o)?(e=z).Name="ConditionalFormatPart":M.u.kb(n,"DBNum",!0)?(e=W).Name="DBNumberFormatPart":vt(n[0],"$",!1)&&-1<n.indexOf("-")?(e=B).Name="LocaleIDFormatPart":function(t){var e,o=w(t),n=o[0];if("h"!==n&&"m"!==n&&"s"!==n)return;for(e=1;e<o.length;e++)if(n!==o[e])return;return 1}(n)?(e=U).Name="ABSTimeFormatPart":n.indexOf("$")<0&&3<=n.length&&((e=J).Name="ColorFormatPart")),e}function St(t,e,o){var n,r;return n=t?t.cultureInfo():j(o),(e<4||4===e&&("ko-kr"===o||"ko-kr"===n.name()))&&(r=n.NumberFormat.dbNumber)?r[e]:R}function Mt(t,e){var o=$.call(this,t,e)||this,n=o;return n.Sd=!0,n.PropertyChanged=[],L.Ec(t)&&(t="General"),n.formatCached=t,n.cultureName=e,n.init(),o}function It(t,e){0===arguments.length?(this.formatCached="General",this.Rd=new q):this.ad(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),M=o("./src/common/util/stringhelper.ts"),I=o("./src/common/util/datetimehelper.ts"),N=o("./src/common/util/types.ts"),n=o("./src/common/util/numberhelper.ts"),T=o("./src/common/culture/cultureInfo.ts"),r=o("./src/common/util/common.ts"),i=o("./src/plugins/formatter/formatter.res.en.ts"),N.j.Ia(r.SR.en,i),a=new r.ResourceManager(r.SR),c=a.getResource.bind(a),N.j.Ma=function(t,e){if(N.j.Fa(t))return"null"===e;if(!e)return!1;if(e instanceof Function&&t instanceof e)return!0;if(typeof t===e)return!0;if("function"===e&&/^\s*\bfunction\b/.test(""+t))return!0;if(Object.prototype.toString.call(t).slice(8,-1).toLowerCase()===e.toLowerCase())return!0;if("DateTime"===e)return t instanceof Date;if("TimeSpan"!==e)return"string"==typeof e&&"undefined number boolean string".indexOf(e),!1;if(t instanceof Date){var o=I.l.Ra(t);return 0<=o&&o<1}return!1},N.j.Na=function(t,e){return!!n.o.Xia(t,e)&&(t=n.o.Oa(t,e),N.j.Ma(t,"number")||N.j.Ma(t,"DateTime")||N.j.Ma(t,"TimeSpan")||t&&!N.j.Ma(t,"boolean")&&!isNaN(t)&&!isNaN(parseFloat(t))&&!(2<=t.length&&"0"===t[0]&&"x"===t[1]))},N.j.Pa=function(t){return N.j.Fa(t)||""===t?0:N.j.Ma(t,"number")?t:N.j.Ma(t,"string")&&!isNaN(t)?n.o.Qa(t):N.j.Ma(t,"boolean")?t?1:0:N.j.Ma(t,"DateTime")?I.l.Ra(t):N.j.Ma(t,"TimeSpan")?Math.floor(I.l.Ra(t)):parseFloat(t)},R=null,A=void 0,v=Math.abs,h={Rc:"yy",vd:"y",Qc:"yyyy",bYc:"q",cYc:"qq",jd:"m",hd:"mm",gd:"mmm",fd:"mmmm",dd:"mmmmm",ud:"d",wd:"dd",kd:"aaa",ld:"aaaa",md:"h",nd:"hh",xd:"m",yd:"mm",td:"s",zd:"ss",ea:"e",rd:"AM/PM",sd:"A/P",ed:"@mmmmm",qd:new Date(1899,11,30,0,0,0,0)},s=[h.vd,h.Rc,h.Qc,h.bYc,h.cYc,h.jd,h.hd,h.gd,h.fd,h.dd,h.ud,h.wd,h.kd,h.ld,h.md,h.nd,h.xd,h.yd,h.td,h.zd,"ggg","gg","g","ee","e"],f="一十",p="十",d={Hc:0,Va:1,Ua:2,_text:3},l=RegExp("([.+?*$^\\[\\](){}|/])","g"),u=[["M/d","MMM/d","MMMM/d","d/M","d/MMM","d/MMMM","M-d","MMM-d","MMMM-d","d-M","d-MMM","d-MMMM"],["M/y","MMM/y","M/yyyy","MMM/yyyy","M-y","MMM-y","M-yyyy","MMM-yyyy"],["M/d/y","MMM/d/y","MMMM/d/y","M/d/yyyy","MMM/d/yyyy","MMMM/d/yyyy","d/M/y","d/MMM/y","d/MMMM/y","d/M/yyyy","d/MMM/yyyy","d/MMMM/yyyy","yyyy/M/d","M-d-y","MMM-d-y","MMMM-d-y","M-d-yyyy","MMM-d-yyyy","MMMM-d-yyyy","d-M-y","d-MMM-y","d-MMMM-y","d-M-yyyy","d-MMM-yyyy","d-MMMM-yyyy","yyyy-M-d"],["H:m","h:m tt"],["H:m:s","H:m:s"],["H:m:s.FFF","h:m:s.FFF tt"],["h:m:s tt","h:mm:ss tt"],["M/d H:m","MMM/d H:m","MMMM/d H:m","d/M H:m","d/MMM H:m","d/MMMM H:m","M/y H:m","MMM/y H:m","M/yyyy H:m","MMM/yyyy H:m","M/d/y H:m","MMM/d/y H:m","MMMM/d/y H:m","M/d/yyyy H:m","MMM/d/yyyy H:m","MMMM/d/yyyy H:m","M-d H:m","MMM-d H:m","MMMM-d H:m","d-M H:m","d-MMM H:m","d-MMMM H:m","M-y H:m","MMM-y H:m","M-yyyy H:m","MMM-yyyy H:m","M-d-y H:m","MMM-d-y H:m","MMMM-d-y H:m","M-d-yyyy H:m","MMM-d-yyyy H:m","MMMM-d-yyyy H:m","M/d h:m tt","MMM/d h:m tt","MMMM/d h:m tt","d/M h:m tt","d/MMM h:m tt","d/MMMM h:m tt","M/y h:m tt","MMM/y h:m tt","M/yyyy h:m tt","MMM/yyyy h:m tt","M/d/y h:m tt","MMM/d/y h:m tt","MMMM/d/y h:m tt","M/d/yyyy h:m tt","MMM/d/yyyy h:m tt","MMMM/d/yyyy h:m tt","M-d h:m tt","MMM-d h:m tt","MMMM-d h:m tt","d-M h:m tt","d-MMM h:m tt","d-MMMM h:m tt","M-y h:m tt","MMM-y h:m tt","M-yyyy h:m tt","MMM-yyyy h:m tt","M-d-y h:m tt","MMM-d-y h:m tt","MMMM-d-y h:m tt","M-d-yyyy h:m tt","MMM-d-yyyy h:m tt","MMMM-d-yyyy h:m tt"],["M/d H:m:s","MMM/d H:m:s","MMMM/d H:m:s","d/M H:m:s","d/MMM H:m:s","d/MMMM H:m:s","M/y H:m:s","MMM/y H:m:s","M/yyyy H:m:s","MMM/yyyy H:m:s","M/d/y H:m:s","MMM/d/y H:m:s","MMMM/d/y H:m:s","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s","MMMM/d/yyyy H:m:s","d/M/y H:m:s","d/MMM/y H:m:s","d/MMMM/y H:m:s","d/M/yyyy H:m:s","d/MMM/yyyy H:m:s","d/MMMM/yyyy H:m:s","yyyy/M/d H:m:s","M-d H:m:s","MMM-d H:m:s","MMMM-d H:m:s","d-M H:m:s","d-MMM H:m:s","d-MMMM H:m:s","M-y H:m:s","MMM-y H:m:s","M-yyyy H:m:s","MMM-yyyy H:m:s","M-d-y H:m:s","MMM-d-y H:m:s","MMMM-d-y H:m:s","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s","MMMM-d-yyyy H:m:s","d-M-y H:m:s","d-MMM-y H:m:s","d-MMMM-y H:m:s","d-M-yyyy H:m:s","d-MMM-yyyy H:m:s","d-MMMM-yyyy H:m:s","yyyy-M-d H:m:s","M/d h:m:s tt","MMM/d h:m:s tt","MMMM/d h:m:s tt","d/M h:m:s tt","d/MMM h:m:s tt","d/MMMM h:m:s tt","M/y h:m:s tt","MMM/y h:m:s tt","M/yyyy h:m:s tt","MMM/yyyy h:m:s tt","M/d/y h:m:s tt","MMM/d/y h:m:s tt","MMMM/d/y h:m:s tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s tt","MMMM/d/yyyy h:m:s tt","d/M/y h:m:s tt","d/MMM/y h:m:s tt","d/MMMM/y h:m:s tt","d/M/yyyy h:m:s tt","d/MMM/yyyy h:m:s tt","d/MMMM/yyyy h:m:s tt","yyyy/M/d h:m:s tt","M/d/yyyy h:mm:ss tt","M-d h:m:s tt","MMM-d h:m:s tt","MMMM-d h:m:s tt","d-M h:m:s tt","d-MMM h:m:s tt","d-MMMM h:m:s tt","M-y h:m:s tt","MMM-y h:m:s tt","M-yyyy h:m:s tt","MMM-yyyy h:m:s tt","M-d-y h:m:s tt","MMM-d-y h:m:s tt","MMMM-d-y h:m:s tt","M-d-yyyy h:m:s tt","MMM-d-yyyy h:m:s tt","MMMM-d-yyyy h:m:s tt","d-M-y h:m:s tt","d-MMM-y h:m:s tt","d-MMMM-y h:m:s tt","d-M-yyyy h:m:s tt","d-MMM-yyyy h:m:s tt","d-MMMM-yyyy h:m:s tt","yyyy-M-d h:m:s tt"],["M/d H:m:s.FFF","MMM/d H:m:s.FFF","MMMM/d H:m:s.FFF","d/M H:m:s.FFF","d/MMM H:m:s.FFF","d/MMMM H:m:s.FFF","M/y H:m:s.FFF","MMM/y H:m:s.FFF","M/yyyy H:m:s.FFF","MMM/yyyy H:m:s.FFF","d/M/y H:m","d/MMM/y H:m","d/MMMM/y H:m","d/M/yyyy H:m","d/mmm/yyyy H:m","d/MMMM/yyyy H:m","yyyy/M/d H:m","M/d/y H:m:s.FFF","MMM/d/y H:m:s.FFF","MMMM/d/y H:m:s.FFF","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s.FFF","MMMM/d/yyyy H:m:s.FFF","d/M/y H:m:s.FFF","d/MMM/y H:m:s.FFF","d/MMMM/y H:m:s.FFF","d/M/yyyy H:m:s.FFF","d/MMM/yyyy H:m:s.FFF","d/MMMM/yyyy H:m:s.FFF","yyyy/M/d H:m:s.FFF","M-d H:m:s.FFF","MMM-d H:m:s.FFF","MMMM-d H:m:s.FFF","d-M H:m:s.FFF","d-MMM H:m:s.FFF","d-MMMM H:m:s.FFF","M-y H:m:s.FFF","MMM-y H:m:s.FFF","M-yyyy H:m:s.FFF","MMM-Yyyy H:m:s.FFF","d-M-y H:m","d-MMM-y H:m","d-MMMM-y H:m","d-M-yyyy H:m","d-MMM-yyyy H:m","d-MMMM-yyyy H:m","yyyy-M-d H:m","M-d-y H:m:s.FFF","MMM-d-y H:m:s.FFF","MMMM-d-y H:m:s.FFF","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s.FFF","MMMM-d-yyyy H:m:s.FFF","D-M-y H:m:s.FFF","d-MMM-y H:m:s.FFF","d-MMMM-y H:m:s.FFF","D-M-yyyy H:m:s.FFF","d-MMM-yyyy H:m:s.FFF","d-MMMM-yyyy H:m:s.FFF","yyyy-M-d H:m:s.FFF","M/d h:m:s.FFF tt","MMM/d h:m:s.FFF tt","MMMM/d h:m:s.FFF tt","d/M h:m:s.FFF tt","d/MMM h:m:s.FFF tt","d/MMMM h:m:s.FFF tt","M/y h:m:s.FFF tt","MMM/y h:m:s.FFF tt","M/yyyy h:m:s.FFF tt","MMM/yyyy h:m:s.FFF tt","d/M/y h:m tt","d/MMM/y h:m tt","d/MMMM/y h:m tt","d/M/yyyy h:m tt","d/mmm/yyyy h:m tt","d/MMMM/yyyy h:m tt","yyyy/M/d h:m tt","M/d/y h:m:s.FFF tt","MMM/d/y h:m:s.FFF tt","MMMM/d/y h:m:s.FFF tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s.FFF tt","MMMM/d/yyyy h:m:s.FFF tt","d/M/y h:m:s.FFF tt","d/MMM/y h:m:s.FFF tt","d/MMMM/y h:m:s.FFF tt","d/M/yyyy h:m:s.FFF tt","d/MMM/yyyy h:m:s.FFF tt","d/MMMM/yyyy h:m:s.FFF tt","yyyy/M/d h:m:s.FFF tt","M-d h:m:s.FFF tt","MMM-d h:m:s.FFF tt","MMMM-d h:m:s.FFF tt","d-M h:m:s.FFF tt","d-MMM h:m:s.FFF tt","d-MMMM h:m:s.FFF tt","M-y h:m:s.FFF tt","MMM-y h:m:s.FFF tt","M-yyyy h:m:s.FFF tt","MMM-Yyyy h:m:s.FFF tt","d-M-y h:m tt","d-MMM-y h:m tt","d-MMMM-y h:m tt","d-M-yyyy h:m tt","d-MMM-yyyy h:m tt","d-MMMM-yyyy h:m tt","yyyy-M-d h:m tt","M-d-y h:m:s.FFF tt","MMM-d-y h:m:s.FFF tt","MMMM-d-y h:m:s.FFF tt","M-d-yyyy H:m:s tt","MMM-d-yyyy H:m:s.FFF tt","MMMM-d-yyyy h:m:s.FFF tt","d-M-y h:m:s.FFF tt","d-MMM-y h:m:s.FFF tt","d-MMMM-y h:m:s.FFF tt","d-M-yyyy h:m:s.FFF tt","d-MMM-yyyy h:m:s.FFF tt","d-MMMM-yyyy h:m:s.FFF tt","yyyy-M-d h:m:s.FFF tt"]],k=N.j.Ma,g=N.j.Ca,m=n.o,y=m.eka+"."+m.fka,x=m.Jja,S=m.mb,b=m.Lma,E=N.j.Fa,D=isNaN,j=function(t){return T.CultureManager.q4(t)},C=function(t){return j(t).DateTimeFormat},_=function(t){return j(t).NumberFormat},w=function(t){return t&&t.toLowerCase()},O=function(t){return t&&t.toUpperCase()},F=function(){throw Error(c().Exp_FormatIllegal)},P=function(){return T.CultureManager.booleanMapping},L={Dc:"",Kb:function(){var t,e,o,n,r,i,a=[];for(t=0;t<arguments.length;t++)a[t]=arguments[t];for(e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];if(0===arguments.length)return R;for(n=e[0],r=1;r<arguments.length;r++)i=RegExp("\\{"+(r-1)+"\\}","gm"),n=n.replace(i,arguments[r]);return n},Ec:function(t){return!t||t===L.Dc}},H={Fc:function(t){var e=t.charCodeAt(0);return 48<=e&&e<=57},Gc:function(t){var e=t.charCodeAt(0);return 9<=e&&e<=13||32===e||133===e||160===e}},ct.prototype.cultureInfo=function(){return this.Xc||(this.Xc=j(this.Wc),this.Vc&&this.Vc!==L.Dc&&!this.Xc.NumberFormat.isReadOnly&&(this.Xc.NumberFormat.currencySymbol=this.Vc)),this.Xc},ct.prototype.currencySymbol=function(){return this.Vc?M.u.Gb(this.Vc,"\\.",'"."'):L.Dc},ct.prototype.allowScience=function(){if(this.Xc)return!this.Xc.isJCKCulture},ct.prototype.toString=function(){return this.Uc?dt(this.Uc):L.Dc},ct.Name="LocaleIDFormatPart",B=ct,ut.prototype.format=function(t){return R},ut.prototype.parse=function(t){return R},ut.prototype.formatString=function(t){return this.formatCached},ut.prototype.toJSON=function(){var t,e={};for(t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},ut.prototype.fromJSON=function(t){if(t)for(var e in t)t[e]!==A&&(this[e]=t[e])},V=ut,e.FormatterBase=V,lt.prototype.toString=function(){return dt(this.Sc+(""+this.value))},z=lt,st.prototype.Pc=function(t,e,o){var n,r,i,a,s,l,u,c,h,f;if(!t||t===L.Dc)return t;for(s=!(a=i=-1),h=(r=n=t).length-1;0<=h;h--)f=r[h],!D(f)&&!vt(f," ",!1)||vt(f,".",!1)&&!s?(vt(f,".",!1)&&(s=!0),-1===i&&(i=h),a=h):-1<a&&-1<i&&(l=ht(r,a,i-a+1),u=parseFloat(l),D(u)||(c=st.numberString(l,e,o),n=M.u.Fb(n,a,i-a+1),n=M.u.Eb(n,a,c)),s=!(a=i=-1));return-1<a&&-1<i&&(l=ht(r,a,i-a+1),u=parseFloat(l),D(u)||(c=st.numberString(l,e,o),n=M.u.Fb(n,a,i-a+1),n=M.u.Eb(n,a,c))),n},st.prototype.toString=function(){if(-1<this.type)return dt("DBNum"+this.type);throw Error()},st.numberString=function(t,e,o){var n=st.formatNumberString,r=t.split(".");if(r){if(1===r.length)return n(r[0],e.numbers,o?e.letters:R);if(2===r.length)return n(r[0],e.numbers,o?e.letters:R)+"."+n(r[1],e.numbers)}throw Error(c().Exp_ValueIllegal)},st.formatNumberString=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m=t,y=0,b=0;if(2===arguments.length){for(r="",y=0;y<m.length;y++)n=ht(m,y,1),r+=e[b=parseInt(n,10)];return r}if(3===arguments.length){if(!o)return st.formatNumberString(t,e);for(i=0,a="",s=m.length,l=!1,u=[],y=0;y<s;y++)-1<(c=o.length-1-y)?u.push(""+o[c]):u.push(L.Dc);for(h=[],f=u.length-1;0<=f;f--)h[u.length-f-1]=u[f];for(u=h,p=!1,f=0;f<s;f++)n=ht(m,f,1),b=parseInt(n,10),d=void 0,g=L.Dc,0<s-f-16?(d=e[b],p=!(g="")):f!==s-1&&f!==s-5&&f!==s-9&&f!==s-13?"0"===n?(g=d="",i+=1):(d="0"!==n&&0!==i?e[0]+e[b]:e[b],g=u[f],i=0):"0"!==n&&0!==i?(d=e[0]+e[b],g=u[f],i=0):"0"!==n&&0===i||p?(d=e[b],g=u[f],i=0,p=!1):("0"===n&&3<=i?g=d="":11<=s?d="":(d="",g=u[f]),i+=1),d+g===L.Dc||(l=!1),f!==s-13||l||(g=u[f],l=!0),f!==s-9||l||(g=u[f],l=!0),f===s-1&&(g=u[f],l=!0),a=a+d+g;return 0===parseInt(t,10)?e[0]:a}},W=st,at.prototype.ad=function(){var t,e,o,n,r=this,i={Qb:r.Yc};if(at.Lc(i.Qb)){if(t=r.bd(i),e=C(this.cultureName).amDesignator&&C(this.cultureName).pmDesignator,r.hasJD=r.Gb(i.Qb,h.dd,'"'+h.ed+'"',!0,!1,i,!1),r.Gb(i.Qb,h.fd,"MMMM",!0,!1,i,!1),r.Gb(i.Qb,h.gd,"MMM",!0,!1,i,!1),r.Gb(i.Qb,h.hd,"MM",!0,!1,i,!1),r.Gb(i.Qb,h.jd,"M",!0,!1,i,!1),r.Gb(i.Qb,h.cYc,"QQ",!0,!1,i,!1),r.Gb(i.Qb,h.bYc,"Q",!0,!1,i,!1),r.Gb(i.Qb,h.kd,"ddd",!0,!0,i,!0),r.Gb(i.Qb,h.ld,"dddd",!0,!0,i,!0),t&&e||(r.Gb(i.Qb,h.md,"H",!0,!0,i,!1),r.Gb(i.Qb,h.nd,"HH",!0,!0,i,!1)),r.Jc&&(r.Ic||j(r.cultureName).NumberFormat.dbNumber)&&(r.od=r.od||r.Gb(i.Qb,h.Qc,'"@'+h.Qc+'"',!0,!1,i,!0),r.od=r.od||r.Gb(i.Qb,h.Rc,'"@'+h.Rc+'"',!0,!1,i,!0)),r.$c)for(o=0;o<r.$c.length;o++)n=r.$c[o],r.Gb(i.Qb,n.Kc,"@"+n.Kc,!0,!0,i,!0);r.pd=i.Qb}else F()},at.prototype.formatString=function(){return this.Yc},at.prototype.format=function(t){var e,o,n,r,i,a,s=this,l=L.Dc,u=R;try{if((u=I.l.Yb(t))&&D(u.valueOf())&&(u=R),u?t=u:l=""+t,u&&(l=I.l.mb(u,s.pd,s.Ic&&s.Ic.cultureInfo()||j(s.cultureName),s.nOb),s.hasJD&&(e=j(s.cultureName).DateTimeFormat.monthNames[u.getMonth()],l=M.u.Gb(l,h.ed,ht(e,0,1))),s.$c))for(o=24*(I.l.Ra(u)-I.l.Ra(h.qd))*60*60*1e3,n=0;n<s.$c.length;n++)i=(r=s.$c[n]).Tc(o),E(i)||(a=r.Kc.replace("[","\\[").replace("]","\\]"),l=M.u.Gb(l,"@"+a,i))}catch(e){l=ft(t)}return function(t,e,o,n,r){var i,a=t;if(!E(n)&&e instanceof Date){if(!(i=St(o,n.type,r)))return t;a=n.Pc(a,i,!0),1===n.type&&(a=a.replace(RegExp(f,"g"),p)),a=(a=a.replace("@"+h.Qc,I.l.Vb(e,h.Qc))).replace("@"+h.Rc,I.l.Vb(e,h.Rc)),a=n.Pc(a,i,!1)}return a}(l,t,s.Ic,s.Jc,s.cultureName)},at.prototype.parse=function(t){var e,o,n,r;if(!t||t===L.Dc)return R;if("true"===(o=w(e=t)))return!0;if("false"===o)return!1;if(this.pd&&(n=I.l.Wb(e,this.pd,j(this.cultureName))))return n;try{return(r=I.l.Yb(e))&&!D(r)?r:(r=new Date(e),D(r.valueOf())?e:r)}catch(t){return e}},at.prototype.Zc=function(t){var e,o,n,r=t,i="",a=!1;for(e=0;e<r.length;e++)'"'===(o=r[e])?a=!a:a||("Y"===o||"D"===o||"S"===o||"E"===o||"G"===o?o=w(o):"M"===o&&(vt("A",n=r[e-1],!0)||vt("P",n,!0)||(o=w(o)))),i+=o;return i},at.prototype.bd=function(t){var e,o,n,r=C(this.cultureName).amDesignator,i=C(this.cultureName).pmDesignator,a=[h.rd];for(r&&i?a.push(r+"/"+i):a.push(h.rd),a.push(h.sd),e=["tt","tt","t"],o=t.Qb,n=0;n<3;n++){if(M.u.Bb(o,e[n]))return!0;if(M.u.Bb(o,a[n],!0))return t.Qb=M.u.Gb(o,a[n],e[n],!0),!0}return!1},at.prototype.Gb=function(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m,y;if(n||r){for(s=[],l=!0,!at.hasDate(t)&&at.hasTime(t)&&(l=!1),u=!1,c=0;c<t.length;c++){if(h=t[c],at.hasTime(h)&&!u?l=!1:at.hasDate(h)&&!u&&(l=!0),n&&vt(h,e[0],a)&&l||r&&vt(h,e[0],a)&&!l){for(f=!0,p=0;p<e.length;p++)if(p+c>=t.length||!vt(e[p],t[p+c],a)){f=!1;break}if(d=c+e.length-1,f&&1+d<t.length){for(g=t[d],m=-1,m=1+d;m<t.length&&vt(g,t[m],a);m++);1+d<m&&(c=m,f=!1)}f&&!u&&s.splice(0,0,c)}'"'===h&&(u=!u)}if(i.Qb=t,0<s.length){for(c=0;c<s.length;c++)y=s[c],i.Qb=M.u.Fb(i.Qb,y,e.length),i.Qb=M.u.Eb(i.Qb,y,o);return!0}return!1}return!1},at.hasTime=function(t){return-1<M.u.Cb(t,h.md[0],!0)||-1<M.u.Cb(t,h.td[0],!0)},at.hasDate=function(t){return-1<M.u.Cb(t,h.Rc[0],!0)||-1<M.u.Cb(t,h.ud[0],!0)},at.Lc=function(t,e){return wt(t,e||s)},G=at,e.lxb=G,it.Name="ABSTimeFormatPart",U=it,rt.prototype.toString=function(){return dt(this.foreColor)},rt.Name="ColorFormatPart",J=rt,nt.prototype.formatString=function(){return this.Bd},nt.prototype.format=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w;return k(t,"boolean")?(""+t).toUpperCase():(e=this,o=N.j.Pa(t),D(o)||!isFinite(o)||D(t)?"string"==typeof t?t:R:(n=j(e.cultureName),e.Ed&&e.Cd?(u={value:0},c={value:0},h={value:0},f=e.bPa(),nt.getFraction(o,f,u,c,h)?(1<(p=nt.getGCD(c.value,h.value))&&(c.value/=p,h.value/=p),e.Dd?(l="",1===h.value&&(u.value+=c.value,c.value=0,h.value=0),(d=x(S(u.value,e.Dd,n)))&&"0"!==d&&(l+=d,l+=" "),0===u.value&&o<0&&(l+=n.NumberFormat.negativeSign),0===o&&(l+="0"),r=e.Cd,i=parseFloat(r),!D(i)&&0<i&&(0!==c.value&&0!==h.value&&(c.value*=i/h.value),h.value=i,r=r.replace(/^\d+/,nt.toNumberPlaceholder(i)),s=(a=Math.ceil(c.value))-c.value,c.value=s<=.5&&0<=s?parseFloat(""+a):parseFloat(""+(a-1))),g=e.Ed,m=parseFloat(g),D(m)||0!==m||(y=g.length,(v=(b=""+c.value).length)<y?g=g.substr(0,y-(y-v)):y<v&&(b=b.substr(0,v-(v-y)),c.value=parseInt(b,10))),C=e.Mja(c.value,h.value,g,r,n),0===c.value&&(C=C.replace(/./g," "),""===d)?"0 "+C:""===(l+=C)?"0":l):(l="",w=u.value*h.value+c.value,r=e.Cd,0<(i=parseFloat(r))?(w*=i/h.value,h.value=i,l+=(w=(s=(a=Math.ceil(w))-w)<=.5&&0<=s?parseFloat(""+a):parseFloat(""+(a-1)))+"/"+h.value):l+=e.Mja(w,h.value,e.Ed,e.Cd,n),0===w?"0":l)):""+o):function(t,e,o,n,r){var i,a,s,l,u,c,h;if(E(n)||(i=St(o,n.type,r),E(i)))return t;for(a=!1,s=void 0,l=j(r),u=void 0,c=0,h=t.length;c<h;c++)"decimalSeparator"===t[c].type&&(a=!0,t[c].value=n.Pc(t[c].value,i,e),s=t[c].value),"number"===t[c].type&&(t[c].value=a?n.Pc(s+t[c].value,i,e).slice(1):n.Pc(t[c].value,i,e),"ja-JP"===l.name()&&1<t[c].value.length&&("一千"!==(u=t[c].value.substr(0,2))&&"一百"!==u&&"一十"!==u||(t[c].value=t[c].value.substr(1))));return t}(S(o,e.Fd,n),e.Ad,e.Ic,e.Jc,e.cultureName)))},nt.prototype.parse=function(t){var e,o,n,r,i,a,s,l,u,c,h=this;return t&&t!==L.Dc?!!("TRUE"===(e=O(t))||e===P()&&P().boolean_true)||!("FALSE"===e||e===P()&&P().boolean_false)&&(o=h.Ed&&h.Cd,n=h.Jd(h.Fd).Kd,(o||n)&&0<(r=t.indexOf("/"))&&r<t.length-1&&(i=parseInt(t.substr(0,r),10),a=parseInt(t.substr(r+1),10),!isNaN(i)&&!isNaN(a)&&0!==a)?i/a:(t=h.Hd(t),t=h.Id(t),l=(s=h.Jd(t)).Kd,u=s.Ld,h.jBb(u)&&(u=M.u.Hb(u,_(h.cultureName).numberGroupSeparator,"",!1),c=m.ob(u,h.cultureName),!D(c)&&isFinite(c))?(l&&(c=b(c/100,15)),c):R)):R},nt.prototype.bPa=function(){var t,e,o=this.Cd,n=0;if(o)for(t=o.length,e=0;e<t&&o[e].match(/[#?0\d]/);e++)n++;return n},nt.prototype.jBb=function(t){var e,o="",n=0,r=0,i=0,a=R,s=_(this.cultureName);for(e=t.length-1;-1<e;e--){if(t[e]===s.numberDecimalSeparator)n++,0<i&&(a=!1),o="";else if("e"===w(t[e])){if(r++,o="",e===t.length-1)return!1}else if(t[e]===s.numberGroupSeparator)a=3===o.length,i++,o="";else if("-"===t[e]||"+"===t[e]){if(0<e&&"e"!==w(t[e-1]))return!1}else{if(!H.Fc(t[e]))return!1;if(o+=t[e],0===e&&0===parseInt(o,10)&&a)return!1}if(1<n||1<r||!1===a)return!1}return!0},nt.prototype.Hd=function(t){var e,o,n,r,i,a,s=t,l=[];for(e=0;e<s.length;e++)H.Fc(s[e])&&l.push(e);for(n=[(o=_(this.cultureName)).currencyDecimalSeparator,o.currencyGroupSeparator,o.currencySymbol,o.nanSymbol,o.negativeInfinitySymbol,o.negativeSign,o.numberDecimalSeparator,o.numberGroupSeparator,o.percentDecimalSeparator,o.percentGroupSeparator,o.percentSymbol,o.perMilleSymbol,o.positiveInfinitySymbol,o.positiveSign],r=s.length-1;-1<r;r--)if(i=s[r],!H.Gc(i)||-1<n.indexOf(""+i)){if(("-"===i||"+"===i)&&(a=0<r?""+s[r-1]:R,["e","E","(",_(this.cultureName).currencySymbol].indexOf(a)<0))break}else(r<l[0]||l[l.length-1]<r)&&(s=M.u.Fb(s,r,1));return s},nt.prototype.Id=function(t){var e=_(this.cultureName).currencySymbol,o=M.u.kb(t,e)?M.u.Fb(t,0,e.length):t;return o.indexOf(e)<0?o:t},nt.prototype.Jd=function(t){var e=_(this.cultureName).percentSymbol,o=!0,n=t;return M.u.kb(t,e)?n=M.u.Fb(t,0,e.length):M.u.jb(t,e)?n=M.u.Fb(t,t.length-e.length,e.length):o=!1,M.u.Bb(n,e)&&(o=!1),{Ld:n,Kd:o}},nt.prototype.Mja=function(t,e,o,n,r){var i=x(S(t,o,r)),a=x(S("0."+e,"#."+n,r,!0)),s=i+"/"+a.substr(a.indexOf(".")+1);return""===o&&(s=t+s),""===n&&(s+=e),s},nt.getGCD=function(t,e){var o,n;if(0===t)return v(e);if(0===e)return v(t);for(n=Math.max(t,e)%(o=Math.min(t,e));0!==n;)n=o%(o=n);return v(o)},nt.getFraction=function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d=0,g=0,m=0,y=0,b=Math.ceil;for(0<t?d=1==(y=t-b(t)+1)?(y=0,t):b(t)-1:t<0&&(d=b(t),y=b(t)-t),(i=Math.pow(10,e-1))<2&&(i=2),(a=Math.pow(10,e)-1)<2&&(a=2),s=!1,l=0,u=i;u<=a&&(c=u*y,h=Math.round(c),p=v((f=h/u)-y),!((!s||p<v(l-y))&&(s=!0,l=f,g=h,m=u,p<1e-5)));u++);return o.value=d,n.value=g,r.value=m,s},nt.toNumberPlaceholder=function(t){return(""+t).replace(/\d/g,"?")},Z=nt,ot.kBb=function(t){var e,o,n="",r=!1,i=-1,a=t.length;for(e=0;e<a;e++)'"'===(o=t[e])?i=(r=!r)?e:-1:r||(n+=o);return 0<i&&(n+=t.substring(i,a)),!(0<=n.indexOf("0")||0<=n.indexOf("#")||0<=n.indexOf(".")||0<=n.indexOf("@"))},ot.prototype.Nd=function(){var t;return this.Od||(t=yt(t=this.Bd,"General",y),this.Od=new Z(t,this.Ic,this.Jc,this.cultureName),this.Od.Ad=!0),this.Od},ot.prototype.Pd=function(){return this.Qd||(this.Qd=new Z("0.#####E+00",this.Ic,this.Jc,this.cultureName),this.Qd.Ad=!0),this.Qd},ot.prototype.formatString=function(){return M.u.Gb(this.Bd,"@NumberFormat","General")},ot.prototype.format=function(t){var e,o;if(N.j.Na(t,this.cultureName)){if(e=!this.Ic||this.Ic.allowScience(),(o=N.j.Pa(t))!==A&&o!==R)return 99999999999<v(o)&&e||v(o)<1e-11&&0!==o?this.Pd().format(t):this.Nd().format(t)}else{if(k(t,"string"))return bt(M.u.Gb(this.formatString(),'"',"")),t;if(k(t,"boolean"))return(""+t).toUpperCase()}return""},ot.prototype.parse=function(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d;return L.Ec(t)?R:"number"==typeof t?t:(e=!1,o=t.trim(),0<(n=M.u.Cb(o,"-",!1))&&!vt(o.charAt(n-1),"E",!0)&&(e=!0),a=(i=(r=j(this.cultureName)).DateTimeFormat).dateSeparator,s=i.timeSeparator,l=i.monthNames,u=i.abbreviatedMonthNames,c=function(t,e){var o,n,r;if(!e||0===e.length)return!1;for(o=!1,n=0,r=e.length;n<r;n++)if(M.u.Bb(t,e[n],!0)){o=!0;break}return o},(e||M.u.Bb(o,a,!1)||M.u.Bb(o,s,!1)||M.u.Bb(o,"/",!1)||M.u.Bb(o,":",!1)||M.u.Bb(o,"-",!1)||M.u.Bb(o,"年",!1)||M.u.Bb(o,"月",!1)||M.u.Bb(o,"日",!1)||c(o,l)||c(o,u)||"ja-JP"===r.name()&&0<=T.aBb.R.indexOf(o[0].toUpperCase())&&M.u.Bb(o,".",!1))&&(h=I.l.Qa(o))?h:((d="("===(o=(p="-"===o.charAt(0))?M.u.Fb(o,0,1):o).charAt(0)&&")"===o.charAt(o.length-1))&&(o=o.substring(1,o.length-1)),(f=this.Nd().parse(o))!==R&&f!==A?(d||p)&&k(f,"number")?-1*v(f):f:t))},q=ot,et.prototype.format=function(t,e){var o,n;try{return o=t instanceof Date?""+I.l.Ra(t):ft(t),n=this.Kja(this.Yc),this.Lja(o,n.formatTokens,t,n.hasAtPart,e)}catch(t){return""}},et.prototype.parse=function(t){return t||""},et.prototype.formatString=function(){return this.Yc},et.prototype.Kja=function(t){var e,o,n=[],r=!1,i="",a=!1,s=R;for(o=0;o<t.length;o++)e=t.charAt(o),a?('"'!==e?i+=e:(i+=e,n.push(i),i="",a=!1),s=e):"*"!==s&&"_"!==s&&"\\"!==s||""===i?"*"!==e&&"_"!==e&&"\\"!==e?"@"!==e?'"'!==e?(i+=e,s=e):(s=e,""!==i&&n.push(i),i=e,a=!0):(s=e,""!==i&&(n.push(i),i=""),n.push(e),r=!0):(s=e,""!==i&&(n.push(i),i=""),i+=e):(i+=e,n.push(i),i="");return""!==i&&n.push(i),{formatTokens:n,hasAtPart:r}},et.prototype.Lja=function(t,e,o,n,r){var i,a,s=[],l=!1;if("string"!=typeof o||n||r)for(i=e.length-1;0<=i;i--)"*"===(a=e[i])[0]?l||(l=!0,s.push({type:"fillingChar",value:a[1]})):"_"===a[0]?s.push({type:"placeholder",value:a[1]}):'"'===a[0]&&'"'===a[a.length-1]?2<=a.length&&s.push({type:"text",value:a.substr(1,a.length-2)}):"\\@"===a?s.push({type:"text",value:"@"}):"@"===a[0]?s.push({type:"text",value:t}):s.push({type:"text",value:a});else s.push({type:"text",value:o});return s.reverse()},K=et,Y=function(){return{pattern:u,formatter:["d-mmm","mmm-yy",C().shortDatePattern,"h:mm","h:mm:ss","h:mm:ss.0","h:mm:ss tt",C().shortDatePattern+" h:mm",C().shortDatePattern+" h:mm:ss",C().shortDatePattern+" h:mm:ss.0"]}},It.prototype.ad=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x;for(t!==R&&t!==A||F(),o=t,(n=this).formatCached=t,i=r="",l=s=a=!1,u=[],c=0;c<t.length;c++)'"'===(h=t[c])?(s=!s,i+=h):s?i+=h:"["===h?(a&&F(),i&&(r=r||"",r+=i),i=""+h,a=!0):"]"===h?(a||F(),i?((p=At(f=""+(i+=h)))?"ABSTimeFormatPart"===p.Name?(u.push(new p(It.preProcessPart(f),f)),r+=i):f===T.aBb.eraExcelFormatter?(n.addPart(p,T.aBb.eraInternalFormatter),l=!0):n.addPart(p,f):(r+=d=It.partToNormalStr(f),o=yt(t,f,d)),i=""):F(),a=!1):i+=h;i?a?F():r+=i:r=r||n.o$a(),n.localeIDFormatPart&&(e=n.localeIDFormatPart.cultureInfo().name()),g=n.conditionalFormatPart,C=g,x=!1,w=wt(v=(v=r)?""+v:L.Dc,["general"])?q:G.Lc(v)?G:wt(v,["E+","E-","#",".",",","%","0","/","?"])||C?(x=!0,Z):(x=!0,K),b=(m={Mc:x,Nc:w}).Mc?o:r,(y=m.Nc)?n.Rd=new y(b,n.localeIDFormatPart,n.dbNumberFormatPart,e,0<u.length?u:R,l):F()},It.prototype.o$a=function(){var e=this,t="";return e.dbNumberFormatPart&&(It.proNames.some(function(t){return"dbNumberFormatPart"!==t&&e[t]})||(t="General")),t},It.prototype.formatString=function(){var t,e,o,n="";for(t=0,e=It.proNames.length;t<e;t++)this[o=It.proNames[t]]&&(n+=""+this[o]);return n+this.Rd.formatString()},It.prototype.addPart=function(t,e){var o,n,r,i=It.proNames,a=It.preProcessPart(e);for(o=0,n=i.length;o<n;o++)if(vt(r=i[o],t.Name,!0)){if(this[r])throw Error(c().Exp_DuplicatedDescriptor);this[r]=new t(a,e)}},It.prototype.format=function(t,e){return this.Rd.format(t,e)},It.prototype.parse=function(t){return this.Rd.parse(t)},It.checkFormatter=function(t){if(!t||t===L.Dc)throw Error(c().Exp_TokenIllegal)},It.preProcessPart=function(t){It.checkFormatter(t);var e=mt(t);return It.checkFormatter(e),e},It.partToNormalStr=function(t){var e=It.preProcessPart(t);return"$"===e[0]&&(e=e.slice(1)),'"'+e+'"'},It.proNames=["colorFormatPart","conditionalFormatPart","dbNumberFormatPart","localeIDFormatPart"],Q=It,tt(Mt,$=V),Mt.prototype.toJSON=function(){var t={formatCached:this.formatCached};return this.cultureName&&(t.customerCultureName=this.cultureName),"general"===w(this.formatCached)&&delete t.formatCached,t},Mt.prototype.hasFormatedColor=function(){var t,e;for(t in d)if(d.hasOwnProperty(t)&&(e=this.getFormatter(d[t]))&&e.colorFormatPart)return!0;return!1},Mt.prototype.formatString=function(t){var e,o,n;if(0===arguments.length){for(e=L.Dc,o=0,n=this.formatters.length;o<n;o++)e+=this.formatters[o].formatString(),o!==n-1&&(e+=";");return e}if(!t)throw Error(c().Exp_ValueIsNull);return this.formatters=R,this.formatCached=t,this.init(),this.Td("formatString"),this},Mt.prototype.getFormatter=function(t){return this.formatters&&this.formatters[t]},Mt.prototype.getPreferredEditingFormatter=function(t){var e,o,n=C(this.cultureName),r=Mt.defFormatter;return k(t,"TimeSpan")?r(n.longTimePattern):k(t,"DateTime")?(e=0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds()?"":" h:mm:ss",r(n.shortDatePattern+e)):N.j.Na(t,this.cultureName)?r(1e20<=(o=N.j.Pa(t))||o<=1e-17&&0<o||o<=-1e20||o<0&&-1e-17<=o?"0.##E+00":y):r("General")},Mt.prototype.getPreferredDisplayFormatter=function(t,e){var o,n,r,i,a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S=Mt.defFormatter;if((e=e||{value:R}).value=R,L.Ec(t))return new Mt;if(o=t,n=e.value=this.parse(o),k(n,"DateTime")||k(n,"TimeSpan")){for(i=(r=Y()).pattern,a=r.formatter,0<(u=(l=(s=j(this.cultureName)).DateTimeFormat).preselectedFormatters).length&&(i=i.concat([u]),a=a.concat([u[0]])),"ja-JP"===s.name()&&(i=i.concat([l.eraFormatter]),a=a.concat(["ge.M.d"]),c=s._Ab.filter(function(t){return"ggge"===t.substr(0,4)}),i=i.concat([c]),a=a.concat(['ggge"年"M"月"d"日']),h=s._Ab.filter(function(t){return"gge"===t.substr(0,3)}),i=i.concat([h]),a=a.concat(['gge"年"M"月"d"日']),f=s._Ab.filter(function(t){return"ge"===t.substr(0,2)}),i=i.concat([f]),a=a.concat(['ge"年"M"月"d"日'])),p=0;p<i.length;p++)for(d=i[p],g=0;g<d.length;g++)if(m=d[g],(y=I.l.Qa(t,m))&&y-n==0)return new Mt(a[p])}else if(N.j.Na(n,this.cultureName)){if(v=(b=_(this.cultureName)).currencySymbol,C=b.numberDecimalSeparator,w=b.percentSymbol,x=b.numberGroupSeparator,A=(T=M.u.Bb)(o,C)?".00":"",o[0]===v)return S(L.Kb("{0}#,##0{1};[Red]({0}#,##0{1})",v,A));if(T(o,"E",!0))return S("0.00E+00");if(""+o[0]===w||""+o[o.length-1]===w)return S(L.Kb("0{0}%",A));if(T(o,x))return S(L.Kb("#,##0{0}",A))}return S("General")},Mt.prototype.format=function(t,e){var o,n,r,i,a,s;if(k(t,"boolean"))return P()&&(t=t?P().boolean_true:P().boolean_false),(""+t).toUpperCase();if(n=0,r=this.Ud(t)){i=r.colorFormatPart,e&&i&&(e.conditionalForeColor=e.value=i.foreColor),(o=N.j.Na(t,this.cultureName))&&(n=N.j.Pa(t)),a=L.Dc;try{o&&r===this.getFormatter(d.Va)?a=r.format(r.considerNegSymbol?n:v(n)):(a=r.value)===A&&(s=!this.Sd&&r===this.getFormatter(d._text),a=r.format(t,s)),e&&(e.content=g(a)?a:[{type:"text",value:a}]),g(a)&&(a=m.Jja(a))}catch(e){k(t,"string")&&(a=""+t)}return a}return o&&n<0?"-":k(t,"string")||t!==A&&t!==R?""+t:L.Dc},Mt.prototype.parse=function(t){return this.formatters&&0<this.formatters.length?this.formatters[0].parse(t):R},Mt.prototype.init=function(){var t,e,o,n=this.formatCached;for(L.Ec(n)&&F(),this.formatters=[],t=n.split(";"),this.Sd=1===t.length,(!t||t.length<1||4<t.length)&&F(),e=0;e<t.length;e++)o=new Q(t[e],this.cultureName),this.formatters.push(o);this.getFormatter(d.Hc)||F()},Mt.prototype.Ud=function(t){var e,o,n,r,i,a,s,l=this.getFormatter(d.Hc),u=l&&l.conditionalFormatPart,c=this.getFormatter(d._text);if("string"==typeof t&&D(t))return c||(u?t:l);if(N.j.Na(t,this.cultureName)||k(t,"boolean")){if(e=this.getFormatter(d.Va),o=this.getFormatter(d.Ua),n=N.j.Pa(t),r=u&&l.conditionalFormatPart.isMeetCondition(n),a=(i=e&&e.conditionalFormatPart)&&e.conditionalFormatPart.isMeetCondition(n),s=void 0,this.Sd||(u?r:0<n||0===n&&!o))s=l;else if(i?a:n<0)s=e;else if(o)s=o;else if(e){if(u&&i)return{value:n+""};s=e}return s&&(!u||i||s!==e||o||(s.considerNegSymbol=!0),u&&i&&s===e&&e.conditionalFormatPart&&e.conditionalFormatPart.isMeetCondition(1e-10)&&(s.considerNegSymbol=!0)),s}return R},Mt.prototype.Td=function(t){var e,o;if(this.PropertyChanged)for(e=0;e<this.PropertyChanged.length;e++)"function"==typeof(o=this.PropertyChanged[e])&&o(this,t)},Mt.defFormatter=function(t){var e=Mt[t];return e||(e=new Mt(t),Mt[t]=e),e},e.GeneralFormatter=Mt},"./src/plugins/slicer/slicer.entry.ts":function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),function(t){for(var e in t)o.hasOwnProperty(e)||(o[e]=t[e])}(e("./src/plugins/slicer/slicer.ts"))},"./src/plugins/slicer/slicer.ts":function(t,e,o){"use strict";var n,N,R,i,a,s,r,k,l,u;function b(t){return t&&t.text!==N}function c(){}function h(t,e){var o,n,r;if(t!==R&&t!==N){if(w(t)===i)e.value=t;else if(w(t)===s)e.value=t?1:0;else if(t instanceof Date)e.value=k.Ra(t);else{if(w(t)!==a)return;if(0===E(t=t.trim()))return;if(o=!1,"%"===t.charAt(E(t)-1)&&(o=!0,t=t.substr(0,E(t)-1)),2<=E(t)&&"0"===t[0]&&"x"===t[1])return;if(n=(+t).valueOf(),isNaN(n)||!isFinite(n)){if(r=new Date(t),isNaN(r))return;n=k.Ra(r)}o&&(n/=100),e.value=n}return 1}}function v(t){var e,o,n,r,i,a,s,l,u,c,h,f,p,d=t.Ce;for(d||(t.Ee=[],t.Ie=[]),e=d?t.De:t.Ee,o=t.Fe,n=t.Ge,r=d?t.He:t.Ie,i=t.Je,a=t.Ke,s=t.Le,l=E(t.data),c=0;c<l;c++){for(h=!1,f=void 0,p=0;p<E(i)&&(f=i[p],d&&f===t.Me||(n[f]?(u=t.getExclusiveRowIndex(t.columnNames[f],c),h=!n[f][u]):o[f]&&(h=!o[f][c]),!h));p++);!h&&d&&(a?h=!a[u=t.getExclusiveRowIndex(t.columnNames[f],c)]:s&&(h=!s[c])),h||(e[c]=!0)}for(p=0;p<E(e);p++)e[p]&&r.push(p)}function m(t){return"string"==typeof t?t.toLowerCase():t instanceof Date?k.Ra(t):t}function C(t,e){var o,n,r,i,a,s,l,u=t.Oe,c=t.Pe,h=t.Se,f=t.Qe,p=t.Re,d=t.data,g=p[e]=[];for(t._e=[],u[e]=[],c[e]=[],h[e]={},f[e]=[],o={},n=0;n<E(d);n++)i=b(r=d[n][e])?r.text.trim():r,u[e].push(i),(a=o[m(i)])?(a.list.push(n),g[n]=a.index):(s=[n],c[e].push(i),f[e].push(s),l=E(f[e])-1,h[e][i]=l,g[n]=l,o[m(i)]={list:s,index:l})}function f(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g=t.Te,m=t.getColumnIndex(e),y=[];if(!m)return y;if(n=t.Ce?t.Ue:t.Ve[m],r=t.Ee,!n)return y;for(g[m]||t.We(m),i=[],a=g[m],s=0;s<E(a);s++)u=b(l=t.data[s][m])?l.value:l,i[a[s]]=u;for(c=t.af[m],s=0;s<E(n);s++){for(h=n[s],f=!1,d=(p=t.Xe(i,h)).start;d<=p.end;d++)if(r[c[d]]){f=!0;break}f!==o&&y.push(h)}return y}function d(t,e){var o,n,r,i,a,s,l,u=[],c={},h=t.getColumnIndex(e);if(0<=h)for(o=t.Ke||t.Le,n=t.Ge[h]||t.Fe[h],r=t.Ce&&h===t.Me?o:n,a=E((i=!!t.Fe[h])?t.getData(e):t.getExclusiveData(e)),s=0;s<a;s++)r&&!r[s]&&(c[l=i?t.getExclusiveRowIndex(e,s):s]||(c[l]=!0,u.push(l)));return u}function p(t,e){t.Ce=!1,t.Ke=[],t.He=[],t.De=[],t.Le=[],e&&t.onFiltered()}function g(t,e){var o,n=this;for(n.Ne={},n.Oe=[],n.Pe=[],n.Se=[],n.Qe=[],n.Re=[],n.Ge=[],n.Ye=[],n.Fe=[],n.Ve=[],n.Ee=[],n.Ie=[],n.Je=[],n.He=[],n.De=[],n.Ce=!1,n.Ze=[],n.$e=0,n._e=[],n.af=[],n.Te=[],n.bf(t,e),o=0;o<E(n.data);o++)n.Ee[o]=!0,n.Ie.push(o)}function y(t){return t===R||t===N}function w(t){return typeof t}function E(t){return t?t.length:0}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./src/common/util/datetimehelper.ts"),N=void 0,R=null,i="number",a="string",s="boolean",r=n.l.Ra,(u=e.FilteredOutDataType||(e.FilteredOutDataType={}))[u.all=0]="all",u[u.byCurrentColumn=1]="byCurrentColumn",u[u.byOtherColumns=2]="byOtherColumns",(l=e.SlicerAggregateType||(e.SlicerAggregateType={}))[l.average=1]="average",l[l.count=2]="count",l[l.counta=3]="counta",l[l.max=4]="max",l[l.min=5]="min",l[l.product=6]="product",l[l.stdev=7]="stdev",l[l.stdevp=8]="stdevp",l[l.sum=9]="sum",l[l.vars=10]="vars",l[l.varp=11]="varp",c.Ra=function(t){return r(t)},c.quickSort=function(t){var e,o=E(t),n=[];for(e=0;e<o;e++)n[e]={index:e,value:t[e]};return c.quickSortImp(n)},c.quickSortImp=function(t){var e,o,n,r,i,a,s;if(E(t)<=1)return t;for(e=c,o=t[Math.floor(E(t)/2)],n=[],r=[],i=[],a=0;a<E(t);a++)(s=e.sortCompare(t[a].value,o.value))<0?n.push(t[a]):0<s?r.push(t[a]):i.push(t[a]);return e.quickSortImp(n).concat(i,e.quickSortImp(r))},c.isEquals=function(t,e){return!(!y(t)&&""!==t||!y(e)&&""!==e)||(t instanceof Date&&e instanceof Date?t.valueOf()===e.valueOf():w(t)===a&&w(e)===a?t.toLowerCase()===e.toLowerCase():t===e)},c.isGreaterThan=function(t,e){var o=w(t),n=w(e);return o===s?t=t?1:0:t instanceof Date&&(t=c.Ra(t)),n===s?e=e?1:0:e instanceof Date&&(e=c.Ra(e)),o===n||o!==i&&n!==i?o===a&&n===a?t.toLowerCase()>e.toLowerCase():e<t:w(e)===i},c.sortCompare=function(t,e){var o=c,n=y(t)||""===t||w(t)===i&&isNaN(t),r=y(e)||""===e||w(e)===i&&isNaN(e);return n&&r?0:n?1:r?-1:o.isEquals(t,e)?0:o.isGreaterThan(t,e)?1:-1},k=c,e.jf=k,g.prototype.inPreview=function(){return this.Ce},g.prototype.bf=function(t,e){this.data=t,this.columnNames=e,function(t){var e,o,n=t.Ne={};for(t.Oe=[],t.Pe=[],t.Qe=[],t.Re=[],e=t.columnNames,o=0;o<E(e);o++)n[(e[o]+"").toUpperCase()]=o}(this)},g.prototype.onDataChanged=function(t){var e,o,n,r,i,a,s,l,u,c,h=this,f=Array(E(h.columnNames)),p=h.Ye,d=h.Pe,g=h.Ge,m=h.Oe;for(e=0;e<E(t);e++)n=(o=t[e]).data,r=o.row,i=h.getColumnIndex(o.columnName),a=b(h.data[r][i]=n)?n.text:n,m[i]&&(m[i][r]=a),f[i]=!0;for(s=0;s<E(f);s++)if(f[s]){for(l=p[s],p[s]=l?[]:void 0,g[s]=l?[]:void 0,u=[],e=0;l&&e<E(l);e++)u.push(d[s][l[e]]);for(C(h,s),e=0;e<E(u);e++)c=h.Se[s][u[e]],p[s].push(c),g[s][c]=!0}v(h),h.cf("onDataChanged",t)},g.prototype.cf=function(t){var e,o,n,r,i=[];for(e=1;e<arguments.length;e++)i[e-1]=arguments[e];for(o=this.Ze||[],n=0;n<E(o);n++)(r=o[n])[t]&&r[t].apply(r,i)},g.prototype.onColumnNameChanged=function(t,e){var o=this.Ne,n=this.getColumnIndex(t);n<0||(this.columnNames[n]=e,delete o[t.toUpperCase()],o[e.toUpperCase()]=n,this.cf("onColumnNameChanged",t,e))},g.prototype.onRowsAdded=function(t,e,o){var n,r,i,a,s,l,u,c,h,f,p,d,g,m=this,y=E(m.columnNames),b=m.data,v=m.Oe,C=m.Pe,w=m.Qe,x=m.Re,T=m.Ge,A=m.Ye,S=m.Ee,M=m.Ie,I=m.Je;for(m._e=[],n=0;n<e;n++)b.splice(t,0,Array(y));for(r=0;r<y;r++){for(n=0;n<e;n++)v[r]&&v[r].splice(t,0,N);if(s=void 0,a=C[r]){for(l=R,u=0;u<E(a);u++){for(c=w[r][u],h=0;h<E(c);h++)c[h]>=t&&(c[h]+=e);k.isEquals(a[u],R)&&(l=c,s=u)}for(l||(l=[],a.push(R),s=E(a)-1,m.Se[r][R]=s,w[r].push(l),T[r]&&-1===I.indexOf(r)&&(T[r][s]=!0,A[r].push(s))),f=t;f<t+e;f++)l.push(f);for(i=t;i<t+e;i++)x[r].splice(i,0,s)}}for(p=!0,n=0;n<E(I);n++)d=x[r=I[n]][t],!0!==T[r][d]&&(p=!1);for(n=0;n<E(M);n++)M[n]>=t&&(M[n]+=e);for(i=E(b)-1;t+e<=i;i--)S[i]=S[i-e];for(g=0<E(I),i=t;i<t+e;i++)p&&M.push(i),S[i]=!g;o||m.cf("onRowsChanged",t,e,!0)},g.prototype.onRowsRemoved=function(t,e){this.df(t,e,!0)},g.prototype.df=function(t,e,o){var n,r,i,a,s,l,u,c,h=this,f=h.Ye,p=h.Pe,d=h.Ge,g=h.data,m=E(h.columnNames),y=h.Oe;for(g.splice(t,e),r=0;r<m;r++){if(y[r]&&y[r].splice(t,e),a=[],(i=f[r])&&o){for(n=0;n<E(i);n++){for(s=h.getRowIndexes(h.columnNames[r],i[n]),l=!0,u=0;u<E(s);u++)if(s[u]<t||s[u]>=t+e){l=!1;break}l||a.push(p[r][i[n]])}f[r]=[],d[r]=[]}if(C(h,r),i&&o)for(n=0;n<E(a);n++)c=h.Se[r][a[n]],f[r].push(c),d[r][c]=!0}o&&v(h),h.cf("onRowsChanged",t,e,!1)},g.prototype.onColumnsRemoved=function(t,e){var o,n,r,i,a,s,l,u,c=this,h=c.data,f=[],p=c.Je,d=t+e;for(o=t;o<d;o++)n=c.columnNames[o],r=o,f.push(n),-1!==p.indexOf(r)&&c.doUnfilter(n);for(i=c.Ge||c.Fe,a=c.Ye||c.Ve,s=c.Ne,o=0;o<E(h);o++)h[o].splice(t,e);for(l in c._e=[],c.columnNames.splice(t,e),c.Oe.splice(t,e),c.Pe.splice(t,e),c.Se.splice(t,e),c.Qe.splice(t,e),c.Re.splice(t,e),i.splice(t,e),a.splice(t,e),s)s[l]>=t+e&&(s[l]-=e);for(o=0;o<E(f);o++)delete s[(n=f[o]).toUpperCase()],t=c.getColumnIndex(n),-1!==(u=p.indexOf(t))&&p.splice(u,1),c.cf("onColumnRemoved",f[o])},g.prototype.ef=function(){return this._e},g.prototype.ff=function(){return this.af},g.prototype.We=function(t){var e,o,n,r,i,a,s,l,u,c,h,f=this.data;for(this.Oe[t]||C(this,t),e=E(f),o=[],n=0;n<e;n++)i=b(r=f[n][t])?r.value:r,o.push(i);for(a=k.quickSort(o),s=this._e[t]=[],l=this.af[t]=[],u=this.Te[t]=[],c=0;c<E(a);c++)h=a[c],s.push(h.value),l.push(h.index),u[h.index]=c},g.prototype.getColumnIndex=function(t){var e=this.Ne[t.toUpperCase()];return void 0===e?-1:e},g.prototype.getFilteredRowIndexes=function(){return this.Ce?this.He:this.Ie},g.prototype.getFilteredOutRowIndexes=function(){var t,e=E(this.data),o=this.Ce?this.De:this.Ee,n=[];for(t=0;t<e;t++)o[t]||n.push(t);return n},g.prototype.getData=function(t,e){var o,n,r,i,a,s,l,u=this.Oe,c=this.getColumnIndex(t);if(0<=c){if(e){for(this._e[c]||this.We(c),o=u[c],n=this._e[c],i=(r=this.Xe(n,e)).start,a=r.end,s=[],l=i;l<=a;l++)s.push(o[this.af[c][l]]);return s}return u[c]||C(this,c),u[c]}return[]},g.prototype.aggregateData=function(t,e,o){var n,r,i,a,s,l,u,c,h,f=this.getColumnIndex(t);return f<0?N:(this._e[f]||this.We(f),a=E(i=this._e[f]),n=(s=this.Xe(i,o)).start,r=s.end,5===e?a<=n?N:i[n]:4===e?r<0?N:i[r]:3===e?r<n?0:r-n+1:(u=(l=this.Qka(i,e,n,r)).data1,c=l.data2,h=l.data3,1===e?u/=c:7===e||10===e?(u=(h*c-u*u)/(h*(h-1)),u=7===e?Math.sqrt(u):u):8!==e&&11!==e||(u=(h*c-u*u)/(h*h),u=8===e?Math.sqrt(u):u),u))},g.prototype.Qka=function(t,e,o,n){var r,i,a,s=6===e?1:0,l=0,u=0;for(r=o;r<=n;r++)(i=t[r])===R&&i===N||h(i,a={value:R})&&(i=a.value,1===e?(s+=i,l++):2===e?s++:9===e?s+=i:6===e?s*=i:7!==e&&8!==e&&10!==e&&11!==e||(s+=i,l+=i*i,u++));return{data1:s,data2:l,data3:u}},g.prototype.Xe=function(t,e){var o,n,r,i,a=E(t);if(e){if(e.min===-1/0)o=0;else for(r=0;r<a;r++)if(i=t[r],k.isEquals(e.min,i)||k.isGreaterThan(i,e.min)){o=r;break}if(o===N&&(o=a),n===1/0)n=a-1;else{for(r=a-1;0<=r;r--)if(i=t[r],k.isEquals(i,e.max)||k.isGreaterThan(e.max,i)){n=r;break}n===N&&(n=-1)}}else o=0,n=a-1;return{start:o,end:n}},g.prototype.getExclusiveData=function(t){var e=this.Pe,o=this.getColumnIndex(t);return 0<=o?(e[o]||C(this,o),e[o]):[]},g.prototype.getRowIndexes=function(t,e){var o=this.getColumnIndex(t);return 0<=o?(this.Re[o]||C(this,o),this.Qe[o][e]):[]},g.prototype.getExclusiveRowIndex=function(t,e){var o=this.Re,n=this.getColumnIndex(t);return 0<=n?(o[n]||C(this,n),o[n][e]):-1},g.prototype.getFilteredIndexes=function(t){var e=[];return this.gf(t,e,{}),e},g.prototype.gf=function(t,e,o){var n,r,i,a=this.Ce?this.He:this.Ie;for(n=0;n<E(a);n++)r=a[n],o[i=this.getExclusiveRowIndex(t,r)]?o[i]++:(o[i]=1,e.push(i))},g.prototype.getFilteredRanges=function(t){return f(this,t,!1)},g.prototype.getFilteredOutRanges=function(t){return f(this,t,!0)},g.prototype.getFilteredOutIndexes=function(t,e){return(0===e?function(t,e){var o,n,r,i,a=[];if(0<=t.getColumnIndex(e)){for(o=E(t.getData(e)),n=t.Ce?t.De:t.Ee,r=0;r<o;r++)n[r]||(i=t.getExclusiveRowIndex(e,r),-1===a.indexOf(i)&&a.push(i));return a}}:1===e?d:function(t,e){var o,n,r,i,a,s,l,u,c,h={},f=t.columnNames,p=E(f);for(o=0;o<p;o++)if(f[o]!==e)for(n=d(t,f[o]),r=0;r<E(n);r++)for(i=t.getRowIndexes(f[o],n[r]),a=0;a<E(i);a++)h[i[a]]||(h[i[a]]=!0);for(s={},p=E(t.data),o=0;o<p;o++)l=t.getExclusiveRowIndex(e,o),h[o]||(s[l]=!0);for(u=E(t.getExclusiveData(e)),c=[],o=0;o<u;o++)s[o]||c.push(o);return c})(this,t)},g.prototype.attachListener=function(t){this.Ze.push(t)},g.prototype.detachListener=function(t){var e,o=this.Ze||[];for(e=0;e<E(o);e++)if(o[e]===t){o.splice(e,1);break}},g.prototype.suspendFilteredEvents=function(){this.$e++},g.prototype.resumeFilteredEvents=function(){this.$e--,0===this.$e&&this.onFiltered()},g.prototype.doFilter=function(t,e,o){this.hf(t,e,o),this.onFiltered()},g.prototype.hf=function(t,e,o){var n=this.Je,r=this.getColumnIndex(t);r<0||(o?(this.Ce=!0,this.Me=r):this.Ce&&p(this,!1),n.indexOf(r)<0&&n.push(r),e.ranges?function(t,e,o,n){var r,i,a,s,l,u,c,h,f=t.getColumnIndex(e),p=t.Te;for(p[f]||t.We(f),r=[],i=p[f],a=0;a<E(i);a++)l=b(s=t.data[a][f])?s.value:s,r[i[a]]=l;for(u=[],a=0;a<E(o);a++)for(c=t.Xe(r,o[a]),h=0;h<E(i);h++)i[h]>=c.start&&i[h]<=c.end&&(u[h]=!0);n?(t.Le=u,t.Ue=o):(t.Ve[f]=o,t.Fe[f]=u,delete t.Ge[f],delete t.Ye[f]),v(t)}(this,t,e.ranges,o):function(t,e,o,n){var r,i=t.getColumnIndex(e),a=[];for(r=0;r<E(o);r++)a[o[r]]=!0;n?t.Ke=a:(t.Ge[i]=a,t.Ye[i]=o,delete t.Ve[i],delete t.Fe[i]),v(t)}(this,t,e.exclusiveRowIndexes,o))},g.prototype.clearPreview=function(){p(this,!0)},g.prototype.doUnfilter=function(t){this.if(t),this.onFiltered()},g.prototype.if=function(t){var e,o,n=this;n.Ce&&p(n,!1),(e=n.getColumnIndex(t))<0||(delete n.Ve[e],delete n.Fe[e],delete n.Ge[e],delete n.Ye[e],v(n),0<=(o=n.Je.indexOf(e))&&n.Je.splice(o,1))},g.prototype.onFiltered=function(){0===this.$e&&this.cf("onFiltered",{rowIndexes:this.getFilteredRowIndexes(),isPreview:this.Ce})},g.prototype.getListener=function(){return this.Ze},e.GeneralSlicerData=g},"./src/plugins/sparkline/sparkline.entry.ts":function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),function(t){for(var e in t)o.hasOwnProperty(e)||(o[e]=t[e])}(e("./src/plugins/sparkline/sparkline.ts"))},"./src/plugins/sparkline/sparkline.ts":function(t,f,e){"use strict";var o,C,p,xt,ut,w,d,bt,Tt,At,St,Mt,It,Nt,Rt,st,x,U,kt,J,z,vt,Ct,wt,lt,n,Et,Dt,jt,ct,_t,Ot,W,Z,Ft,q,Pt,Lt,Ht,Bt,K,Y,Q,Vt,X,ht,ft,pt,zt,Wt,Gt,dt,Ut,Jt,r,gt,nt,Zt,mt,yt,qt,Kt,Yt,Qt,N,H,G,Xt,$t,te,ee,oe,y,i,a,s=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function R(t,e){return{x:t,y:e}}function B(t,e,o,n){return{x:t,y:e,width:o,height:n}}function ne(t,e){var o,n,r,i=t[0],a=i&&i.value?i.value:i;for(n=1,r=t.length;n<r;n++)o=(i=t[n])&&i.value?i.value:i,(e&&o<a||!e&&a<o)&&(a=o);return a}function re(t,e,o,n,r,i,a){i&&(t.strokeStyle=i),a&&(t.lineWidth=a),t.beginPath(),t.moveTo(e,o),t.lineTo(n,r),t.stroke()}function ie(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d;if(t.save(),l=[i,a],t.setLineDash)t.beginPath(),t.strokeStyle=s,t.setLineDash(l),t.stroke(),t.moveTo(e,o),t.lineTo(n,r),t.stroke();else{for(t.beginPath(),t.lineWidth=1,t.strokeStyle=s,c={x:(n-e)/(u=U(x(n-e,2)+x(r-o,2))),y:(r-o)/u},f=h=0;h<u;)h+=p=Nt(l[f%2],u-h),(d=++f%2)&&t.moveTo(e,o),e+=p*c.x,o+=p*c.y,d&&t.lineTo(e,o);t.stroke()}t.restore()}function ae(t,e,o,n,r,i,a,s,l,u,c,h){e?re(t,o,n,r,i,c,h):re(t,a,s,l,u,c,h)}function se(t,e,o,n,r,i,a,s){t.save(),a&&(t.fillStyle=a),t.textBaseline=s||Y,t.beginPath(),t.font=r,t.textAlign=i,n="string"==typeof n?n:n+"",t.fillText(n,e,o),t.restore()}function $(t){return C.pc.dc(w(t))<127.5?_t:Ot}function le(t,e,o,n,r,i,a,s){var l,u,c,h,f=s;return xt(s)&&(f=r),h=a?(l=e+f+i,c=n-2*f,u=t+r,o-2*r):(l=t+f,c=o-2*f,u=e+r,n-2*r),{left:l,top:u,width:c,height:h}}function ue(t,e){var o,n,r=0;for(o=0,n=t.length;o<n;o++)r+=e&&!e(t[o])?0:t[o];return r}function ce(t){return t*St/180}function he(t,e,o,n){var r,i,a,s,l=[];for(a=i=0,s=t.length;i<s;i++)e?(e(t[i])?l[a]=o?o(t[i]):t[i]:l[a]=0,a++):(r=wt(t[i]),!Ct(r)&&isFinite(r)&&(l[a]=r,a++));return n&&n(l),l}function fe(t,e,o,n,r,i){var a=st(e+n),s=st(o+r);e=st(e),o=st(o),n=st(a-e),r=st(s-o),t.beginPath(),t.fillStyle=i,t.fillRect(e,o,n,r),t.fill()}function tt(t,e,o){return t=Nt(t,e),Rt(t,o)}function pe(t,e,o,n,r){t.save(),t.rect(e,o,n,r),t.clip()}function de(t,e){var o,n,r,i;return t&&e&&(o=Rt(t.x+t.width,e.x+e.width),n=Rt(t.y+t.height,e.y+e.height),r=Nt(t.x,e.x),i=Nt(t.y,e.y),o-r<=t.width+e.width&&n-i<=t.height+e.height)}function l(t){var e=a.call(this,R(t.x,t.y))||this;return e.value=t.value,e}function et(t,e,o){return{x:t,y:e,value:o}}function ge(t,e){var o,n,r=e?1:-1,i=e?Nt:Rt,a=new N(R(r*lt,r*lt)),s=t.length;for(n=0;n<s;n++)o=t[n],a.x=i(a.x,o.x),a.y=i(a.y,o.y);return a}function me(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m,y,b,v,C,w;if(a){for(s=U(x(n-e,2)+x(r-o,2)),p=f=h=c=void(l=0),p=e<=n?(h=n,f=c=e,o):(h=e,f=c=n,r),g=o-(d=(r-o)/(n-e))*e,(u=[]).push(new N(R(f,p))),m=[6,4,2,4];l<s;)for(y=0,b=m.length;y<b;y++)(l+=m[y])<=s&&(p=d*(f=l/s*(h-(w=c))+w)+g,u.push(new N(R(f,p))));for(v=0,C=u.length;v<C-1;v+=2)re(t,u[v].x,u[v].y,u[v+1].x,u[v+1].y,i)}else re(t,e,o,n,r,i)}function ye(t){var e,o,n,r=[],i=t.length;if(0<i)if(i<(e=t[0].length)){if(2<=i)for(o=0;o<e;o++)r.push(new N(R(t[0][o],t[1][o])))}else if(2<=e)for(n=0;n<i;n++)r.push(new N(R(t[n][0],t[n][1])));return r}function j(t,e,o,n){for(var r,i=[],a=Rt(100,10*t),s=0,l=[],u=0;i.length<t;)r=At(n[u]*e),u++,(a<s||c(r,l))&&(i.push(r),l.push([r-o,r+o])),s++;return i}function c(t,e){var o,n,r;for(o=0,n=e.length;o<n;o++)if((r=e[o])[0]<=t&&t<=r[1])return;return 1}function ot(t,e,o,n,r,i){re(t,h(e),h(o),h(n),h(r),xt(i)?Ot:i,1)}function rt(o,n,r,t,e){var i,a,s,l,u,c=.4*t;switch(n=h(n),r=h(r),o.beginPath(),o.moveTo(n,r),i=c/2,a=U(3)*c/2,s=c/U(3),e){case 0:l=[-i,0,i],u=[a,s,a];break;case 2:l=[-i,0,i],u=[-a,-s,-a];break;case 3:l=[a,s,a],u=[-i,0,i];break;case 1:l=[-a,-s,-a],u=[-i,0,i];break;default:l=[],u=[]}l.forEach(function(t,e){o.lineTo(h(n+t),h(r+u[e]))}),o.lineTo(n,r),o.closePath(),o.fillStyle=_t,o.fill()}function u(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m,y,b,v,C,w=o.value,x=o.colorScheme,T=o.axisVisible,A=o.barHeight,S=o.barWidth,M=!1,I=wt(w);if(!Ct(I)){if(xt(p=0===t?A:S))d=.7;else{if(Ct(p)||p<=0)return;d=Math.min(1,p)}1<I?(I=1,M=!0):I<-1&&(I=-1,M=!0),x=xt(x)?"grey":x,T=!!xt(T)||T,e.save(),0===t?(g=i-10,m=a*d,h=0<=I?(M&&(s=new N(R(n+5+g-5,r+a/2))),l=new H(B(n+5,r+a*(1-d)/2,g*I,m)),u=new N(R(n+5,r+1)),c=new N(R(n+5,r+a)),1):(y=kt(g*I),M&&(s=new N(R(n+5+5,r+a/2))),l=new H(B(n+i-5-y,r+a*(1-d)/2,y,m)),u=new N(R(n+i-5,r+1)),c=new N(R(n+i-5,r+a)),3),f=xt(p)?a:a*d):1===t&&(b=a-10,v=i*d,c=0<=I?(l=new H(B(n+(1-d)/2*i,r+a-5-(C=b*I),v,C)),M&&(s=new N(R(n+i/2,r+a-5-C+5)),h=0),u=new N(R(n+1,r+a-5)),new N(R(n+i,r+a-5))):(I=kt(I),l=new H(B(n+(1-d)/2*i,r+5,v,b*I)),M&&(s=new N(R(n+i/2,r+5+b-5)),h=2),u=new N(R(n+1,r+5)),new N(R(n+i,r+5))),f=xt(p)?i:i*d),e.beginPath(),l&&(fe(e,l.x,l.y,l.width,l.height,x),pe(e,l.x,l.y,l.width,l.height)),s&&rt(e,s.x,s.y,f,h),e.restore(),T&&u&&ot(e,u.x,u.y,c.x,c.y),e.restore()}}function h(t){return st(t)-.5}function g(t,e,o,n,r){e=st(e),o=st(o),e===(n=st(n))&&(e=n-=.5),o===(r=st(r))&&(o=r-=.5),t.moveTo(e,o),t.lineTo(n,r)}function be(t,e,o,n,r,i,a,s,l,u,c){t.beginPath(),t.strokeStyle=o,e?g(t,n,r,i,a):g(t,s,l,u,c),t.stroke()}function b(t,e,o,n,r){t.rect(e,o,n,r),t.clip()}function ve(t,e,o,n,r,i){var a,s,l,u,c,h=i.labelText,f=i.fontSize,p=i.startBox,d=i.endBox,g=i.boxColor,m=i.isInRightOrTopOfBox,y=i.fillStyle;t.save(),t.beginPath(),t.font=f+X,y=xt(y)?Ot:y,i.vertical?(l=Bt,m?0<f+d-(p-o)&&p-d-o<d?(u=K,y=$(g),s=p-d+1,b(t,e,p-d,n,d)):(u=Y,s=p-d-1):s=0<f-(o+r-p)&&o+r-p<d?(b(t,e,p-d,n,d),u=Y,y=$(g),p-1):(u=K,p+1),t.textAlign=l,t.textBaseline=u,t.fillStyle=y,t.fillText(h,e+n/2,s)):(u=Q,c=t.measureText(h),m?a=0<c.width+d-(e+n-p)&&e+n-(p+d)<d?(b(t,p,o,d,r),l=Ht,y=$(g),p+d-1):(l=Lt,p+d+1):0<c.width-(p-e)&&p-e<d?(b(t,p,o,d,r),a=p+1,l=Lt,y=$(g)):(l=Ht,a=p-1),t.textAlign=l,t.textBaseline=u,t.fillStyle=y,t.fillText(h,a,o+r/2)),t.restore()}function V(t,e){switch(e){case 2:return t%4==0&&t%100!=0||t%400==0?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}}function m(t,e,o){var n,r,i,a,s,l;return t<0&&(t=0),1<t&&(t=1),n=w(e),r=w(o),i=n.a*(1-t)+r.a*t,a=n.r*(1-t)+r.r*t+"",s=n.g*(1-t)+r.g*t+"",l=n.b*(1-t)+r.b*t+"","rgba("+parseInt(a,10)+","+parseInt(s,10)+","+parseInt(l,10)+","+wt(i/255+"")+")"}function v(t,e,o){return t===e&&t===o?1:t<=e?0:o<=t?1:(t-e)/(o-e)}function it(t,u,c,o,h,f,p){var e,d,g,n,r;o?t.forEach(function(t,e){0!==t&&t!==bt&&t!==Tt&&(u[c+e]=o[e]||u[c+e])}):(r=-(n=lt),t.forEach(function(t){t!==bt&&t!==Tt&&(t<n&&(n=t),r<t&&(r=t))}),d=(e={min:n,max:r}).min,g=e.max,t.forEach(function(t,e){var o,n,r,i,a,s,l;0!==t&&t!==bt&&t!==Tt&&(u[c+e]=(o=h,n=f,r=p,l=((s=g)+(a=d))/2,a<=(i=t)&&i<=l?m(v(i,a,l),o,n):m(v(i,l,s),n,r)))}))}function at(t){var e,o=t.getFullYear(),n=t.getMonth(),r=t.getDate();for(e=1;e<n+1;e++)r+=V(o,e);return r}function Ce(t,e,o,n){return{x:t+It(o)*n,y:e+Mt(o)*n}}function we(t,e){return kt(e.x-t.x)<.01?{x:e.x,y:e.y,textAlign:Bt}:e.x>t.x?{x:e.x+r,y:e.y,textAlign:Lt}:e.x<t.x?{x:e.x-r,y:e.y,textAlign:Ht}:{x:e.x,y:e.y,textAlign:Lt}}function T(e,t,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J,Z,q,K,Y,Q,X,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ht,ft,pt,dt,gt,mt,yt,bt,vt=a.zoomFactor,Ct=!!xt(t.showLabel)||t.showLabel,wt=(B=t,V=o,z=n,W=r,G=i,U=Ct,X=a.zoomFactor,$=B.currentValueOption.normalFontHeight*X,tt=B.minValueOption.normalFontHeight*X,et=B.maxValueOption.normalFontHeight*X,ot=B.minAngle,nt=B.maxAngle,rt=B.currentValueOption.normalFontWidth*X,it=90<kt(ot)||90<kt(nt),at=120<kt(ot)||120<kt(nt),st=Yt*Nt(W,G),U?(J=At(W/2*Kt),Z=At(G*Kt),q=Nt(J,it?Z/2:Z),Y=(G-(it?2*q:q))/2,Q=.03*q,K={x:V+W/2,y:z+G/2+(it?0:q/2),outerRadius:q,innerRadius:q*B.radiusRatio,currentValuePoint:Tt,enoughShowCurrentLabel:!1,enoughShowTargetLabel:!0,enoughShowMinLabel:tt<Y,enoughShowMaxLabel:et<Y,moreThanSemiCircle:it},it?at?2*$/3<Y-Q-Rt(et,tt)&&rt<W-2*st&&(K.currentValuePoint={x:K.x,y:K.y+q+Q+$/2+Rt(et,tt)},K.enoughShowCurrentLabel=!0):2*$/3<G/2-Q&&rt<W-2*st&&(K.currentValuePoint={x:K.x,y:K.y+2*Q+$},K.enoughShowCurrentLabel=!0):$<Y-Q&&rt<W-2*st&&(K.currentValuePoint={x:K.x,y:K.y+$},K.enoughShowCurrentLabel=!0)):(J=At(W/2*qt),Z=At(G*qt),q=Nt(J,it?Z/2:Z),K={x:V+W/2,y:z+G/2+(it?0:q/2),outerRadius:q,innerRadius:q*B.radiusRatio}),K);if(!(wt.outerRadius<=0))return s={showTargetLabel:!1,showCurrentLabel:!1,showMinLabel:!1,showMaxLabel:!1},l=wt.innerRadius,u=wt.outerRadius,c=wt.currentValuePoint,h=wt.moreThanSemiCircle,f={x:wt.x,y:wt.y},ht=ce((lt=t).minAngle-90),ft=ce(lt.maxAngle-90),pt=lt.minValueOption.value,dt=lt.maxValueOption.value,gt=lt.ranges,mt=Pt,yt=(ft-ht)/(dt-pt),bt=[],0<gt.length&&gt.forEach(function(t){ut=t.start,ct=t.end,bt.push({start:yt*(ut-pt)+ht,end:yt*(ct-pt)+ht,color:t.color})}),bt.unshift({start:ht,end:ft,color:mt}),d=(p={paintRanges:bt,fillColor:mt,targetValueRadian:yt*(lt.targetValueOption.value-pt)+ht,currentValueRadian:yt*(lt.currentValueOption.value-pt)+ht,minValueRadian:ht,maxValueRadian:ft}).paintRanges,g=p.fillColor,e.save(),d.forEach(function(t){e.beginPath(),e.strokeStyle=_t,e.moveTo(f.x,f.y),e.fillStyle=t.color||g,e.arc(f.x,f.y,u,t.start,t.end,!1),e.lineTo(f.x,f.y),e.closePath(),e.fill(),e.stroke(),e.beginPath(),e.fillStyle=_t,e.strokeStyle=_t,e.moveTo(f.x,f.y),e.arc(f.x,f.y,l,t.start-Qt,t.end+Qt,!1),e.lineTo(f.x,f.y),e.closePath(),e.fill(),e.stroke()}),e.beginPath(),e.moveTo(f.x,f.y),e.fillStyle=Ot,e.arc(f.x,f.y,u*zt,0,2*St,!1),e.fill(),m=Ce(f.x,f.y,p.targetValueRadian,l),y=Ce(f.x,f.y,p.targetValueRadian,u*Gt),ie(e,m.x,m.y,y.x,y.y,Ut,Jt,Ft),b=Ce(f.x,f.y,p.currentValueRadian,u*Gt),re(e,f.x,f.y,b.x,b.y,Ot,Wt*u),Ct&&(e.save(),e.beginPath(),e.textAlign=Vt,e.fillStyle=Ft,v=t.minValueOption.normalFontHeight*vt,C=t.maxValueOption.normalFontHeight*vt,w=t.minValueOption.normalFontWidth*vt,x=t.maxValueOption.normalFontWidth*vt,T=p.minValueRadian,A=p.maxValueRadian,S=t.currentValueOption.normalFontHeight*vt,M=t.currentValueOption.normalFontWidth*vt,I=void 0,wt.enoughShowCurrentLabel&&(se(e,c.x,c.y,t.currentValueOption.label,t.currentValueOption.fontAfterZoom,Bt),s.showCurrentLabel=!0,I={x:c.x-M/2,y:c.y-S,width:M,height:S}),wt.enoughShowMinLabel&&kt(It(T)*u)+w<r/2-Zt&&(N=Ce(f.x,f.y,p.minValueRadian,u),de({x:(R=we(f,N)).x-w,y:R.y,width:w,height:v},I)||(se(e,R.x,R.y+At(v),t.minValueOption.label,t.minValueOption.fontAfterZoom,Ht),s.showMinLabel=!0)),wt.enoughShowMaxLabel&&kt(It(A)*u)+x<r/2-Zt&&(k=Ce(f.x,f.y,p.maxValueRadian,u),de({x:(E=we(f,k)).x,y:E.y,width:x,height:C},I)||(se(e,E.x,E.y+At(C),t.maxValueOption.label,t.maxValueOption.fontAfterZoom,Lt),s.showMaxLabel=!0)),wt.enoughShowTargetLabel&&(D=t.targetValueOption.normalFontWidth*vt,j=t.targetValueOption.normalFontHeight*vt,_=t.targetValueOption.label,y=Ce(f.x,f.y,p.targetValueRadian,O=u+3*j/2),F=we(f,y),L=h?(i-2*O)/2+O:i-(i-u)/2,kt(It(P=p.targetValueRadian)*O)+D<r/2-Zt&&kt(Mt(P)*O)+j/2+Zt/2<L&&(H=Rt(v,C)/2,se(e,F.x,F.y-(St<P?H:-H),_,t.targetValueOption.fontAfterZoom,F.textAlign),s.showTargetLabel=!0)),e.restore()),e.restore(),s}function A(e,t,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J,Z,q=a.zoomFactor,K=t.showLabel,Y=t.minValueOption,Q=t.maxValueOption,X=t.currentValueOption,$=t.targetValueOption,tt=(v=t,C=o,w=n,x=r,T=i,A=a.zoomFactor,S=v.showLabel,M=v.minValueOption.normalFontHeight*A,I=v.maxValueOption.normalFontHeight*A,N=v.targetValueOption.normalFontHeight*A,R=v.currentValueOption.normalFontHeight*A,k=v.minValueOption.normalFontWidth*A,E=v.maxValueOption.normalFontWidth*A,D=v.targetValueOption.normalFontWidth*A,j=v.currentValueOption.normalFontWidth*A,_=.05*x,O=At(T*mt),F=At(x*yt),P={x:C+x*(1-yt)/2,y:w+T*(mt+(1-mt)/2),graphWidth:F,graphHeight:O,targetValuePoint:Tt,currentValuePoint:Tt,minValuePoint:Tt,maxValuePoint:Tt},S&&(M<(T-O)/2&&k<(x-F)/2-_&&(P.minValuePoint={x:P.x-k,y:P.y+M/3},P.enoughShowMinLabel=!0),I<(T-O)/2&&E<(x-F)/2-_&&(P.maxValuePoint={x:P.x-E,y:P.y-O+I/3},P.enoughShowMaxLabel=!0),(N<(T-O)/2||N/2<O)&&D<(x-F)/2-_-Rt(k,E)&&(P.targetValuePoint={x:P.x-D-Rt(k,E),y:Tt},P.enoughShowTargetLabel=!0),(R<(T-O)/2||R/2<O)&&j<(x-F)/2-_&&(P.currentValuePoint={x:P.x+F+_,y:Tt},P.enoughShowCurrentLabel=!0)),P),et=tt.graphWidth,ot=tt.graphHeight;if(!(et<=0||ot<=0))return s={showTargetLabel:!1,showCurrentLabel:!1,showMinLabel:!1,showMaxLabel:!1},l=tt.currentValuePoint,u=tt.targetValuePoint,c=tt.minValuePoint,h=tt.maxValuePoint,f={x:tt.x,y:tt.y},H=tt,z=(L=t).minValueOption.value,W=L.maxValueOption.value,G=L.ranges,U=Pt,J=H.graphHeight/(W-z),Z=[],0<G.length&&G.forEach(function(t){B=t.start,V=t.end,Z.push({start:H.y-J*(B-z),height:J*(V-B),color:t.color})}),Z.unshift({start:H.y,height:H.graphHeight,color:U}),d=(p={paintRanges:Z,fillColor:U,targetValueY:H.y-J*(L.targetValueOption.value-z),currentValueY:H.y-J*(L.currentValueOption.value-z)}).paintRanges,g=X.normalFontHeight*q,m=$.normalFontHeight*q,y=p.targetValueY,b=p.currentValueY,e.save(),d.forEach(function(t){fe(e,f.x,t.start,et,-t.height,t.color)}),ie(e,f.x-(Gt-1)*et,y,f.x+et,y,Ut,Jt,Ft),re(e,f.x,b,f.x+et*Gt,b,Ot,dt*ot),K&&(e.save(),e.beginPath(),tt.enoughShowMinLabel&&(se(e,c.x,c.y,Y.label,Y.fontAfterZoom,Lt,Ft),s.showMinLabel=!0),tt.enoughShowMaxLabel&&(se(e,h.x,h.y,Q.label,Q.fontAfterZoom,Lt,Ft),s.showMaxLabel=!0),tt.enoughShowTargetLabel&&!(i<y-n+m/2||y-n-nt<0)&&(se(e,u.x,p.targetValueY+$.normalFontHeight*q/3,$.label,$.fontAfterZoom,Lt,Ft),s.showTargetLabel=!0),tt.enoughShowCurrentLabel&&!(i<b-n+g/2||b-n-nt<0)&&(se(e,l.x,p.currentValueY+X.normalFontHeight*q/3,X.label,X.fontAfterZoom,Lt,Ft),s.showCurrentLabel=!0),e.restore()),e.restore(),s}function S(e,t,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J,Z,q,K,Y,Q,X,$,tt,et=a.zoomFactor,ot=t.showLabel,nt=t.minValueOption,rt=t.maxValueOption,it=t.currentValueOption,at=t.targetValueOption,st=(v=t,C=o,w=n,x=r,T=i,A=a.zoomFactor,S=v.showLabel,M=v.minValueOption.normalFontHeight*A,I=v.maxValueOption.normalFontHeight*A,N=v.targetValueOption.normalFontHeight*A,R=v.currentValueOption.normalFontHeight*A,k=v.minValueOption.normalFontWidth*A,E=v.maxValueOption.normalFontWidth*A,D=v.currentValueOption.normalFontWidth*A,j=v.targetValueOption.normalFontWidth*A,_=.1*Nt(x,T),O=At(T*yt),F=At(x*mt),P={x:C+x*(1-mt)/2,y:w+T*(1-yt)/2,graphWidth:F,graphHeight:O,targetValuePoint:Tt,currentValuePoint:Tt,minValuePoint:Tt,maxValuePoint:Tt},S&&((D<3*(x-F)/4||D<F)&&R<(T-O)/2-Zt&&(P.currentValuePoint={x:Tt,y:P.y-R/2},P.enoughShowCurrentLabel=!0),(j<3*(x-F)/4||j<F)&&N<(T-O)/2-Rt(M,I)&&(P.targetValuePoint={x:Tt,y:P.y+O+Rt(M,I)+N/4*3},P.enoughShowTargetLabel=!0),k<3*(x-F)/4&&M<(T-O)/2-_&&(P.minValuePoint={x:P.x-k/2,y:P.y+O+M},P.enoughShowMinLabel=!0),E<3*(x-F)/4&&I<(T-O)/2-_&&(P.maxValuePoint={x:P.x+F-E/2,y:P.y+O+I},P.enoughShowMaxLabel=!0)),P),lt=st.graphWidth,ut=st.graphHeight;if(!(lt<=0||ut<=0))return s={showTargetLabel:!1,showCurrentLabel:!1,showMinLabel:!1,showMaxLabel:!1},l=st.currentValuePoint,u=st.targetValuePoint,c=st.minValuePoint,h=st.maxValuePoint,f={x:st.x,y:st.y},J=st,K=(U=t).minValueOption.value,Y=U.maxValueOption.value,Q=U.ranges,X=Pt,$=J.graphWidth/(Y-K),tt=[],0<Q.length&&Q.forEach(function(t){Z=t.start,q=t.end,tt.push({start:J.x+$*(Z-K),width:$*(q-Z),color:t.color||X})}),tt.unshift({start:J.x,width:J.graphWidth,color:X}),d=(p={paintRanges:tt,fillColor:X,targetValueX:J.x+$*(U.targetValueOption.value-K),currentValueX:J.x+$*(U.currentValueOption.value-K)}).paintRanges,g=it.normalFontWidth*et,m=at.normalFontWidth*et,y=p.targetValueX,b=p.currentValueX,e.save(),d.forEach(function(t){fe(e,t.start,f.y,t.width,ut,t.color)}),ie(e,y,f.y,y,f.y+ut*Gt,Ut,Jt,Ft),B=f.y+ut-1,V=H=b,z=f.y-ut*(Gt-1)-1,W=Ot,G=lt*dt,(L=e).save(),W&&(L.strokeStyle=W),G&&(L.lineWidth=G),L.beginPath(),L.moveTo(H,B),L.lineTo(V,z),L.closePath(),L.stroke(),L.restore(),ot&&(e.save(),st.enoughShowMinLabel&&(se(e,c.x,c.y,nt.label,nt.fontAfterZoom,Lt,Ft),s.showMinLabel=!0),st.enoughShowMaxLabel&&(se(e,h.x,h.y,rt.label,rt.fontAfterZoom,Lt,Ft),s.showMaxLabel=!0),st.enoughShowTargetLabel&&!(r<y-o+m/2+gt||y-o-m/2-gt<0)&&(se(e,y-at.normalFontWidth*et/2,u.y,at.label,at.fontAfterZoom,Lt,Ft),s.showTargetLabel=!0),st.enoughShowCurrentLabel&&!(r<b-o+g/2+gt||b-o-g/2-gt<0)&&(se(e,b-it.normalFontWidth*et/2,l.y,it.label,it.fontAfterZoom,Lt,Ft),s.showCurrentLabel=!0),e.restore()),e.restore(),s}function M(o,t,e,n,r){var i,a,s=!1;return o.save(),o.font=r,i=t.length,a=(e-6)/i,t.forEach(function(t,e){o.measureText(t.axis).width>a&&(s=!0)}),o.restore(),s}function I(t){return t.fontStyle+" "+t.fontWeight+" "+t.fontSize+" "+t.fontFamily}function k(){this.Wd=2,this.Xd=n,this.Yd=n,this.Zd=lt,this.$d=-lt}Object.defineProperty(f,"__esModule",{value:!0}),o=e("./src/common/util/types.ts"),C=e("./src/common/util/colorhelper.ts"),p=e("./src/common/util/arrayhelper.ts"),xt=o.j.Fa,ut=C.pc.nc,w=C.pc.ec,d=p.k.Cb,f.Vd={},bt=null,Tt=void 0,At=Math.floor,St=Math.PI,Mt=Math.sin,It=Math.cos,Nt=Math.min,Rt=Math.max,st=Math.round,x=Math.pow,U=Math.sqrt,kt=Math.abs,J=Math.ceil,z="undefined",vt="string",Ct=isNaN,wt=parseFloat,lt=Number.MAX_VALUE,n=new Date(""),Et="#969696",Dt="#CB0000",jt="#646464",ct="#DCDCDC",_t="white",Ot="black",W="blue",Z="green",Ft="grey",q="red",Pt="lightgrey",Lt="left",Ht="right",Bt="center",K="top",Y="bottom",Q="middle",Vt="start",X="px Arial",ht="-",ft="+",pt="=",zt=.05,Wt=.03,Gt=1.06,dt=.02,Ut=4,r=Jt=5,gt=3,nt=10,Zt=8,mt=.8,yt=.25,qt=.9,Kt=.7,Yt=.1,Qt=1/45*St,H=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},s(l,a=N=function(t){this.x=t.x,this.y=t.y}),G=l,Xt="7ns",$t="5ns",te="tukey",ee="bowley",oe="sigma3",f.fNc=T,f.gNc=A,f.hNc=S,y=function(t,e,o,n){this.X=t,this.Y=e,this.Width=o,this.Height=n,this.Left=this.X,this.Right=this.Left+this.Width,this.Top=this.Y,this.Bottom=this.Y+this.Height},k.prototype.paint=function(t,e,o,n,r,i){var a,s,l;this.options=e,this.setting=e.settings,a=e.values,s=e.dateValues,l=e.zoomFactor,t.save(),t.rect(o,n,r,i),t.clip(),t.beginPath(),0===e.sparklineType&&this._d(t,o,n,r,i,a,s,l),this.ae(t,o,n,r,i,a,s,l),this.be(t,o,n,r,i,a,s,l),t.restore()},k.prototype.ce=function(t){return 0===this.options.sparklineType?3+this.de(t)+1:3},k.prototype.ee=function(t,e){var o,n,r,i,a,s,l,u,c,h=this.fe;if(h)return h;if(h=this.fe=[],o=t.length,this.options.displayDateAxis){for(i=e.length,s=[],0<(a=Nt(o,i))&&(s=e.slice(0,a)),s.sort(function(t,e){return t===e?0:(t===f.Vd&&(t=0),e===f.Vd&&(e=0),t-e)}),l=s.length,c=u=void 0,n=0;n<l;n++)if(typeof(u=s[n])!==z&&u!==bt){for(c=d(e,u);p.k.Bb(h,c);)c=d(e,u,c+1);isNaN(u)||(r=t[c])!==Tt&&r!==bt&&isNaN(r)&&r!==f.Vd||h.push(c)}}else for(n=0;n<o;n++)typeof(r=t[n])!==z&&r!==bt&&isNaN(r)&&r!==f.Vd||h.push(n);return h},k.prototype.ge=function(t,e){var o=e[t];return typeof o===z||o===bt?1===this.setting.options.displayEmptyCellsAs&&(o=0):o===f.Vd&&(o=0),o},k.prototype._d=function(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T=this.ee(i,a),A=T.length-1;for(A<0&&(A=0),h=this.setting.options,f=this.linePos=[],b=h.displayEmptyCellsAs,l=0;l<A;l++)if(typeof(p=this.ge(T[l],i))!==z&&p!==bt){if(g=l+1,typeof(d=this.ge(T[g],i))===z||d===bt)if(1===b)d=0;else if(2===b)for(g=l+2;g<=A;g++)if(typeof(v=i[T[g]])!==z&&v!==bt){d=v;break}typeof d!==z&&d!==bt?(m=this.he(T[l],{Width:n,Height:r},i,a,s),y=this.he(T[g],{Width:n,Height:r},i,a,s),C=m.Width/2,u={X:m.X+C,Y:m.Y+C},c={X:y.X+C,Y:y.Y+C},f[l]={P1:u,P2:c}):l++}if(0<(w=f.length))for(t.strokeStyle=this.options.getColor(h.seriesColor),t.lineCap="round",t.lineWidth=this.de(s),l=0;l<w;l++)(x=f[l])&&(t.beginPath(),u=x.P1,c=x.P2,t.moveTo(e+u.X,o+u.Y),t.lineTo(e+c.X,o+c.Y),t.stroke(),t.closePath())},k.prototype.ie=function(t,e,o){var n,r=this,i=r.options,a=r.setting.options,s=bt,l=r.ge(t,e),u=r.ee(e,o),c=u.length,h=i.getColor.bind(r);return typeof l!==z&&l!==bt&&(r.Zd!==lt&&r.$d!==-lt||r.je(e),l===r.Zd&&a.showLow&&(s=h(a.lowMarkerColor)),l!==r.$d||!a.showHigh||typeof s!==z&&s!==bt||(s=h(a.highMarkerColor)),typeof s!==z&&s!==bt||(i.displayDateAxis?0===d(u,t)&&a.showFirst&&(s=h(a.firstMarkerColor)):0===t&&a.showFirst&&(s=h(a.firstMarkerColor))),typeof s!==z&&s!==bt||(i.displayDateAxis?d(u,t)===c-1&&a.showLast&&(s=h(a.lastMarkerColor)):t===c-1&&a.showLast&&(s=h(a.lastMarkerColor))),l<0&&a.showNegative&&(typeof s===z||s===bt)&&(s=h(a.negativeColor)),typeof s!==z&&s!==bt||(0===(n=i.sparklineType)?a.showMarkers&&(s=h(a.markersColor)):1!==n&&2!==n||(s=h(a.seriesColor)))),s===Tt||s===bt?"Transparent":s},k.prototype.ae=function(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d,g,m,y,b={Width:n,Height:r},v=this.ee(i,a),C=v.length,w=this.options.sparklineType;for(y=0;y<C;y++)l=v[y],u=this.ie(l,i,a),c=this.he(l,b,i,a,s),t.fillStyle!==u&&(t.fillStyle=u),0===w?(t.save(),h=e+c.X+c.Width/2,f=o+c.Y+c.Height/2,t.translate(h,f),t.rotate(45*St/180),t.fillRect(0-c.Width/2,0-c.Height/2,c.Width,c.Height),t.restore()):(p=e+c.X+c.Width/4,p=At(p),d=o+c.Y,g=c.Width/2,m=c.Height,t.fillRect(p,d,g,m))},k.prototype.be=function(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d,g=this.setting&&this.setting.options;g&&g.displayXAxis&&this.ke(i,a)&&(l={Width:n,Height:r},u=this.ce(s),c=l.Width-this.ce(s),f=h=At(this.le(l,i,s))+.5,p=this.options.getColor(g.axisColor),(d=s)<1&&(d=1),t.strokeStyle!==p&&(t.strokeStyle=p),t.lineWidth!==d&&(t.lineWidth=d),t.beginPath(),t.moveTo(e+u,o+h),t.lineTo(e+c,o+f),t.stroke())},k.prototype.me=function(t){var e,o=this.ne(t);return o===-lt||(e=this.oe(t))===lt||o===e||o*e<=0},k.prototype.ke=function(t,e){var o,n,r,i,a=this.me(t);if(2!==this.options.sparklineType)return a;if(n=(o=this.ee(t,e)).length,!a&&0<n)for(i=0;i<n;i++)if(typeof(r=t[o[i]])!==z&&r!==bt)return!0;return a},k.prototype.pe=function(t,e){var o=this.Xd;return isNaN(o&&o.valueOf())&&this.qe(t,e),this.Xd},k.prototype.re=function(t,e){var o=this.Yd;return isNaN(o&&o.valueOf())&&this.qe(t,e),this.Yd},k.prototype.qe=function(t,e){var o,n,r,i,a=new Date(0,0,0),s=lt,l=this.ee(t,e),u=l.length;for(i=0;i<u;i++)n=e[o=l[i]],isNaN(n)||(r=this.ge(o,t))!==bt&&typeof r===z||isNaN(r)||typeof n!==z&&n!==bt&&(a<n&&(a=n),n<s&&(s=n));this.Yd=a,this.Xd=s},k.prototype.se=function(t,e,o,n){var r,i,a,s,l,u,c=this.pe(e,o),h=this.re(e,o),f=[],p=this.ee(e,o),d=p.length;for(r=0;r<d;r++)(i=o[p[r]])&&!isNaN(i)&&f.push(i);if(f.sort(function(t,e){return t-e}),1<(a=f.length)&&c!==h){for(s=lt,l=0,r=1;r<a;r++)(i=f[r]-f[r-1])<s&&0<i&&(s=i),l+=i;return(u=(t.Width-this.ce(n)-this.ce(n))*s/l/2)<2&&(u=2),u}return(t.Width-this.ce(n)-this.ce(n))/2},k.prototype.te=function(t,e,o,n){var r;return this.options.displayDateAxis?this.se(t,e,o,n):(r=this.ee(e,o).length,(t.Width-this.ce(n)-this.ce(n))/r)},k.prototype.ue=function(t,e,o,n,r){var i,a,s,l,u,c,h,f=this.ce(r);return this.options.displayDateAxis?(i=this.te(t,o,n,r),(a=this.re(o,n))===(s=this.pe(o,n))?f+i/2:(l=n[e])?(u=t.Width-f-this.ce(r),u-=i,c=a.valueOf()-s.valueOf(),f+At((l.valueOf()-s.valueOf())/c*u)):0):(i=this.te(t,o,n,r),h=d(this.ee(o,n),e),At(f+i*h))},k.prototype.ve=function(t,e){var o,n=t.Width-this.ce(e)-this.ce(e);return n=Rt(n,0),o=t.Height-this.ce(e)-this.ce(e),{Width:n,Height:o=Rt(o,0)}},k.prototype.je=function(t){var e,o,n=t.length;for(o=0;o<n;o++)typeof(e=t[o])!==z&&e!==bt&&("number"!=typeof e&&(e=0),e<this.Zd&&(this.Zd=e),e>this.$d&&(this.$d=e))},k.prototype.ne=function(t){var e,o;return this.$d!==-lt&&this.$d||this.je(t),0===(o=(e=this.setting.options).maxAxisType)?this.$d:1===o?e.groupMaxValue:2===o?e.manualMax:this.$d},k.prototype.oe=function(t){var e,o;return this.Zd!==lt&&this.Zd||this.je(t),0===(o=(e=this.setting.options).minAxisType)?this.Zd:1===o?e.groupMinValue:2===o?e.manualMin:void 0},k.prototype.we=function(t,e,o,n){var r=this.ve(t,n),i=this.ne(o),a=this.oe(o),s=i-a;if(i===a){if(0===i)return 0;s=kt(i)}return(o[e]||0)*(r.Height/s)},k.prototype.xe=function(t,e,o,n){var r,i,a,s=this.options.sparklineType;if(0===s)return this.we(t,e,o,n);if(1!==s)return 2===s?typeof(r=o[e])===z||r===bt||0===r||isNaN(r)?0:(a=this.ve(t,n),0<=r?a.Height/2:-a.Height/2):void 0;if(r=o[e],1===this.setting.options.displayEmptyCellsAs&&(typeof r===z||r===bt))return 0;if((i=this.we(t,e,o,n))>-this.Wd&&i<this.Wd){if(0<r)return i+this.Wd;if(r<0)return i-this.Wd}return i},k.prototype.ye=function(t,e,o){var n,r,i=this.ve(t,o),a=this.ne(e),s=this.oe(e);if(a===-lt||s===lt)return t.Height/2;if(n=a-s,a===s){if(0===a)return t.Height/2;(n=a)<0&&(a=0)}return r=i.Height/n,this.ce(o)+a*r},k.prototype.le=function(t,e,o){return 2===this.options.sparklineType?t.Height/2:this.ye(t,e,o)},k.prototype.ze=function(t,e,o,n){var r,i,a=this.ve(t,n),s=this.ne(o),l=this.oe(o),u=s-l;if(s===l){if(0===s)return 0;u=s}return r=a.Height/u,typeof(i=this.ge(e,o))!==z&&i!==bt||(i=0),s!==l&&0<s*l?0<=i?(i-l)*r:(i-s)*r:i*r},k.prototype.Ae=function(t,e,o,n){var r,i,a,s=this.options.sparklineType;return 0===s?this.ze(t,e,o,n):1===s?(r=this.ze(t,e,o,n),-(i=this.Wd)<r&&r<i&&(typeof(a=this.ge(e,o))!==z&&a!==bt||(a=0),0!==a)?0<a?r+i:r-i:r):2===s?this.xe(t,e,o,n):void 0},k.prototype.Be=function(t,e,o,n,r){var i,a,s,l,u,c,h,f,p,d=this,g=d.te(e,o,n,r),m=d.ue(e,t,o,n,r);return g<0&&(g=0),(g=At(g))%2==1&&(g+=1),i=d.xe(e,t,o,r),a=d.le(e,o,r),s=d.ne(o),l=d.oe(o),s<(u=0)&&l<0?u=Rt(d.ce(r),a):(u=a,0<=i&&(u=a-i)),c=d.Ae(e,t,o,r),h=new y(m,u,g,kt(c)),0!==i&&(f=d.ce(r),h.Y<f&&h.Bottom<f+1?h.Height=At(h.Height+1):(p=e.Height-d.ce(r),h.Bottom>p&&h.Y>p-1&&(h.Y=p-c,h.Height=c))),h},k.prototype.de=function(t){var e=this.setting.options.lineWeight*t;return e<1&&(e=1),e},k.prototype.he=function(t,e,o,n,r){var i,a,s,l,u=this.de(r);return++u<2&&(u=2),i=this.Be(t,e,o,n,r),0===this.options.sparklineType&&(i.X=i.X+(i.Width-u)/2,typeof(a=this.ge(t,o))!==z&&a!==bt?(0<=a?i.Y-=u/2:i.Y=i.Bottom-u/2,i.Width=u,i.Height=u):(i.Width=0,i.Height=0)),this.setting.options.rightToLeft&&(s=i.X,l=e.Width-s-i.Width,i=new y(l,i.Y,i.Width,i.Height)),i},f.SparklineRender=k,f.SparklineExRenders={PIESPARKLINE:function(t,e,o,n,r,i){var a,s,l,u,c,h,f=o+r/2,p=n+i/2,d=Nt(r,i)/2-5,g=-.5*St,m=f+d*It(g),y=p+d*Mt(g),b=[],v=[];if(!(d<=0)){for(u=function(t,e){var o,n,r,i,a,s,l=[],u=e.length;if(t<=u)l=e.slice(0,t);else{for(0===u?(l.push("darkgray"),u=1):l=e.slice(0),o=[],r=t-u+1,i=n=void 0,i=0;i<u;i++)o[i]=w(l[i]);for(i=u;i<t;i++){for(a in n=o[i%u])n.hasOwnProperty(a)&&(s=n[a],n[a]=At(s-s/r*(i/u)));n.a=255,l[i]=C.pc.bc(n)}}return l}(l=(s=he(e.values,function(t){return!xt(t)&&!Ct(t)&&isFinite(t)},function(t){return kt(t)},function(t){1===t.length&&(t[1]=1-t[0])})).length,e.colors),c=ue(s),t.save(),h=0;h<l;h++)a=g+s[h]/c*2*St,t.beginPath(),t.moveTo(f,p),t.lineTo(m,y),t.arc(f,p,d,g,a,!1),t.lineTo(f,p),t.fillStyle=u[h],t.fill(),b.push(m),v.push(y),m=f+d*It(g=a),y=p+d*Mt(g);for(h=0;h<l;h++)re(t,f,p,b[h],v[h],_t);t.restore()}},AREASPARKLINE:function(n,t,e,o,r,i){var a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B;for(n.save(),a=t.points,s=t.mini,l=t.maxi,u=t.line1,c=t.line2,h=t.colorPositive,f=t.colorNegative,a=he(a,function(t){return!xt(t)&&!Ct(t)&&isFinite(t)}),h=xt(h)?"#787878":h,f=xt(f)?Dt:f,T=ne(a,!1),l=xt(l)?T:l,d=Rt(l,T),A=ne(a,!0),s=xt(s)?A:s,p=Nt(s,A),g=(g=(d=d<0?0:d)<(g=0)?d:g)<(p=0<p?0:p)?p-1:g,m=a.length,S=le(e,o,r,i,5),y=S.left,b=S.top,v=S.width,C=S.height,w=v/(m-1),M=[],E=b+(d-g)/(x=(d-p)/C),_=0;_<m;_++)I=a[_],D=y+w*_,j=b+(d-I)/x,0===_&&M.push(new G(et(D,E,g))),0<_&&I*a[_-1]<0&&((R=M[M.length-1])&&(P=R.x,k=(((L=R.y)-(B=E))*D+(B-(H=j))*P)/(L-H),M.push(new G(et(k,E,g))))),M.push(new G(et(D,j,I))),_===m-1&&M.push(new G(et(D,E,g)));for(n.beginPath(),O=0,F=M.length;O<F;O++)(N=M[O])&&(0===O?n.moveTo(N.x,N.y):n.lineTo(N.x,N.y),R=M[O-1],N.value===g&&R&&(n.fillStyle=R.value>g?h:f,n.fill(),O!==F-1&&(n.beginPath(),n.moveTo(N.x,N.y))));function V(t){var e,o;t===bt&&typeof t!==z||(e=tt(t,d,p),o=st(b+(0!=x?(d-e)/x:C/2))-.5,re(n,y,o,y+v,o,W))}V(u),V(c),n.restore()},SCATTERSPARKLINE:function(r,t,e,o,n,i){var a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D=t.points1,j=t.points2,_=t.minX,O=t.maxX,F=t.minY,P=t.maxY,L=t.hLine,H=t.vLine,B=t.xMinZone,V=t.xMaxZone,z=t.yMinZone,W=t.yMaxZone,G=t.tags,U=t.drawSymbol,J=t.drawLines,Z=t.color1,q=t.color2,K=t.dash,Y=4,Q=le(e,o,n,i,5),X=Q.left,$=Q.top,tt=Q.width,et=Q.height;function ot(t,e,o,n){p=t[e],g=p.x,m=p.y,p=t[e+1],y=p.x,b=p.y,v=X+(g-c)*tt/(h-c),w=X+(y-c)*tt/(h-c),C=$+(u-m)*et/(u-l),x=$+(u-b)*et/(u-l),J&&me(r,v,C,w,x,o,K),U&&(0===e&&n(v,C),n(w,x))}function nt(t,e,o,n,r){var i=ge(t,!0),a=ge(t,!1);l=xt(F)?i.y:e,u=xt(P)?a.y:o,c=xt(_)?i.x:n,h=(h=xt(O)?a.x:r)<=c?c+1:h,u=u<=l?l+1:u}function rt(t,e,o){r.beginPath(),r.arc(t-Y/2,e-Y/2,Y/2,0,2*St,!1),r.fillStyle=o,r.fill()}function it(t,e){r.beginPath(),r.strokeStyle=Z,r.arc(t-Y/2,e-Y/2,Y/2,0,2*St,!1),r.stroke()}function at(t,e){r.beginPath(),r.strokeStyle=q,r.strokeRect(t-Y/2,e-Y/2,Y,Y)}if(D&&!(D.length<=0)&&!((a=ye(D)).length<=0||j&&0<j.length&&(s=ye(j)).length<=0)){for(pe(r,e,o,n,i),r.beginPath(),U=!!xt(U)||U,Z=xt(Z)?Et:Z,q=xt(q)?Dt:q,nt(a,F,P,_,O),!xt(B)&&!xt(V)&&!xt(z)&&!xt(W)&&c<=B&&B<=h&&c<=V&&V<=h&&l<=z&&z<=u&&l<=W&&W<=u&&(N=Rt(c,B),R=Nt(h,V),k=Rt(l,z),R<=N&&(R=N+1),(E=Nt(u,W))<=k&&(E=k+1),fe(r,X+(N-c)*tt/(h-c),$+(u-E)*et/(u-l),(R-N)*tt/(h-c),(E-k)*et/(u-l),ct)),A=T=-lt,M=S=lt,d=a.length,f=0;f<d-1;f++)ot(a,f,Z,it),G&&(0===f&&(A<C&&(T=v,A=C),C<M&&(S=v,M=C)),A<x&&(T=w,A=x),x<M&&(S=w,M=x));if(s&&0<s.length)for(nt(s,l,u,c,h),d=s.length,f=0;f<d-1;f++)ot(s,f,q,at);G&&(rt(T,A,Dt),rt(S,M,"#0000FF")),!xt(L)&&l<=L&&L<=u&&(I=st($+(u-L)*et/(u-l))-.5,me(r,X,I,X+tt,I,Dt)),!xt(H)&&c<=H&&H<=h&&(I=st(X+(H-c)*tt/(h-c))-.5,me(r,I,$,I,$+et,Dt)),r.restore()}},BULLETSPARKLINE:function(s,t,l,u,c,h){var e,o,f,p,n,r,i,a,d,g,m,y,b,v,C,w=t.measure,x=t.target,T=t.maxi,A=t.good,S=t.bad,M=t.forecast,I=t.tickUnit,N=t.colorScheme,R=t.vertical,k=t.measureColor,E=t.targetColor,D=t.maxiColor,j=t.goodColor,_=t.badColor,O=t.forecastColor,F=t.allowMeasureOverMaxi,P=t.barSize;function L(t,e,o,n,r){var i,a;s.fillStyle=t,p<(i=p*(e/o))&&!F&&(i=p),a=new H(R?B(l+c*n,f-i,c*r,i):B(f,u+h*n,i,h*r)),s.fillRect(a.x,a.y,a.width,a.height)}if(!(xt(T)||T<0)&&(xt(P)||!(Ct(P)||P<=0))){if(1<P&&(P=1),w=xt(w)||w<0?0:w,A=xt(A)||A<0?0:A,S=xt(S)||S<0?0:S,x=xt(x)?0:x,M=xt(M)?0:M,I=xt(I)?0:I,N=xt(N)?"#A0A0A0":N,e=xt(k)?"#252525":k,T<w&&!F&&(w=T,e=Dt),T<A&&(A=T,e=Dt),T<S&&(S=T,e=Dt),T<x&&(x=0,e=Dt),T<M&&(M=T,e=Dt),o=le(l,u,c,h,5,h-10,R),f=o.left,p=o.width,s.save(),n=xt(P)?.2:(1-P)/2,r=xt(P)?.6:P,i=F?Rt(T,w):T,L(xt(D)?ut(N,1.66):D,T,i,n,r),L(xt(j)?ut(N,1.33):j,A,i,n,r),L(xt(_)?N:_,S,i,n,r),a=.25*P/.6,L(e,w,i,xt(P)?.375:(1-a)/2,xt(P)?.25:a),0<M&&(d=f,p<(g=p*(M/i))&&(g=p),m=xt(P)?3:3*P/.6,ae(s,R,l+.5*c,d,l+.5*c,d-g,d,u+.5*h,d+g,u+.5*h,xt(O)?"#3690BF":O,m)),0<x&&(y=st(f-(R?1:-1)*p*(x/i))-.5,ae(s,R,l+c*n,y,l+c*(1-n),y,y,u+h*n,y,u+h*(1-n),xt(E)?Dt:E,1)),0<I)for(b=At(i/I),v=void 0,C=0;C<=b;C++)v=st(f-p/i*I*(R?1:-1)*C)-.5,ae(s,R,l,v,l+.05*c,v,v,u+h,v,u+.95*h,jt,1);s.restore()}},SPREADSPARKLINE:function(t,e,o,n,r,i){var a,s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S=e.spreadData,M=e.showAverage,I=e.scaleStart,N=e.scaleEnd,R=e.style,k=e.colorScheme,E=e.vertical,D=S.length;if(!(D<=0)){for(a=S[0].key,s=S[D-1].key,I=xt(I)?a:I,N=xt(N)?s:N,R=xt(R)?4:R,k=xt(k)?jt:k,u=(l=le(o,n,r,i,5,i-10,E)).left,c=l.width,h=l.top,f=l.height,pe(t,o,n,r,i),t.beginPath(),t.strokeStyle=k,t.fillStyle=k,g=ne(S,!(t.lineWidth=2)),y=0,b=S.length;y<b;y++)if(C=(v=S[y]).key,w=v.value,p=u+(E?-1:1)*c*(C-I)/(N-I),p=E?(p=Nt(p,u),Rt(p,u-c)):(p=Rt(p,u),Nt(p,u+c)),p=st(p),1===R)ae(t,E,x=h+f/2-(m=(m=w/2*f/g)<.5?.5:m),p,T=h+f/2+m,p,p,x,p,T);else if(4===R)ae(t,E,h,p,h+(m=(m=w*f/g)<1?1:m),p,p,h+f,p,h+f-m);else if(6===R)ae(t,E,h,p,h+f,p,p,h,p,h+f);else for(A=1;A<=w;A++){switch(R){case 2:d=h+f/2-5-(w/2-A)*f/g;break;case 3:d=h+f-5-j(w,f,3,v.randomNumbers)[A-1];break;case 5:default:d=h+f-A*f/g}d=st(d),t.beginPath(),t.fillRect(E?d:p,E?p:d,2,2)}M&&ae(t,E,h-5,p=u-(E?1:-1)*c*(function(t){var e,o,n,r=0,i=0;for(e=0,o=t.length;e<o;e++)n=t[e],i+=n.value,r+=n.key*n.value;return 0===i?0:r/i}(S)-I)/(N-I),h+f+5,p,p,h-5,p,h+f+5,Dt),t.restore()}},STACKEDSPARKLINE:function(i,t,e,o,n,r,a){var s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S=t.points,M=S&&S.length,I=t.colorRange,N=t.labelRange,R=t.maximum,k=t.targetRed,E=t.targetGreen,D=t.targetBlue,j=t.targetYellow,_=t.color,O=t.highlightPosition,F=t.vertical,P=t.textOrientation,L=t.textSize;function H(t,e,o){var n,r;e!==bt&&e!==Tt&&(e=R<e?R:e,o&&!o(e)||(r=(e=e<0?0:e)/R*h,F?(n=st(c-r)-.5,re(i,f,n,f+p,n,t)):(n=st(c+r)-.5,re(i,n,f,n,f+p,t))))}if(!(xt(S)||M<=0)){if(_=xt(_)?jt:_,xt(I)||I.length!==M||function(t){for(var e=0,o=t.length;e<o;e++)if(xt(t[e]))return 1;return}(I))for(I=[],s=0;s<M;s++)I.push(ut(_,1+s/M));for(l=ue(S,function(t){return 0<t}),R=xt(R)||R<l?l:R,P=xt(P)?0:P,L=xt(L)||L<=0?10:L,L=Ct(L)?L:L*a.zoomFactor,u=le(e,o,n,r,5,r-10,F),c=u.left,h=u.width,f=u.top,p=u.height,i.save(),d=c,w=0,x=M;w<x;w++)(C=S[w])<=0||(g=C/R*h,v=F?(m=e+.15*n,b=.7*n,y=d-g,g):(m=d,b=g,y=o+.15*r,.7*r),T=w+1===O?Dt:I[w],i.save(),i.fillStyle=T,i.fillRect(m,y,b,v),(A=N&&N[w])&&(i.save(),i.fillStyle=$(T),i.textBaseline=Q,i.textAlign=Bt,i.font=L+X,i.rect(m,y,b,v),i.clip(),1===P?(i.translate(m+b/2,y),i.rotate(Math.PI/2),i.fillText(A,v/2,0)):i.fillText(A,m+b/2,y+v/2),i.restore()),d+=(F?-1:1)*g,i.restore());H(q,k,function(t){return 0<t}),H(Z,E),H(W,D),H("yellow",j),i.restore()}},HBARSPARKLINE:function(t,e,o,n,r,i){u(0,t,e,o,n,r,i)},VBARSPARKLINE:function(t,e,o,n,r,i){u(1,t,e,o,n,r,i)},VARISPARKLINE:function(v,t,C,w,x,T,e){var A,o,n,r,S,M,i,I,a,s,l,u,c,N,R,h,f,p,d,g,m,y=t.variance,b=t.reference,k=t.mini,E=t.maxi,D=t.mark,j=t.tickUnit,_=t.legend,O=t.colorPositive,F=t.colorNegative,P=t.vertical,L=Dt,H=Et,B=13*e.zoomFactor,V=wt(y);function z(t,e,o,n,r,i,a,s,l,u,c,h,f,p){var d,g,m,y,b;y=P?(d=C+.25*x,g=0===e?N-R:N,m=.5*x,R):(d=0===e?N:N-R,g=w+.25*T,m=R,.5*T),fe(v,d,g,m,y,t),I&&(pe(v,d,g,m,y),P?rt(v,C+x/2,A+o,M,r):rt(v,A+n,w+T/2,M,i),v.restore()),_&&(b=0,I&&(b=.4*M*U(3)/2+5+2),v.save(),v.beginPath(),v.font=B+X,v.fillStyle=Ot,P?(v.textAlign=Bt,W(B+R+a,p,t,s,l,d,g,m,y,P),v.fillText(S,C+x/2,N+f*(R-b))):(v.textBaseline=Q,W(v.measureText(S).width+R+u,p,t,c,h,d,g,m,y,P),v.fillText(S,N+f*(b-R),w+T/2)),v.restore())}function W(t,e,o,n,r,i,a,s,l,u){u?v.textBaseline=n:v.textAlign=n,0<t&&e<R&&(v.rect(i,a,s,l),v.clip(),u?v.textBaseline=r:v.textAlign=r,v.fillStyle=$(o))}function G(t,e,o,n,r,i,a,s,l,u){P?ot(v,t,e,o,n,l):ot(v,r,i,a,s,u)}if(!(Ct(V)||(F=xt(F)?q:F,O=xt(O)?Z:O,j=xt(j)?0:j,E=xt(E)?1:E,k=xt(k)?-1:k,(i=!xt(b))||(b=0),r=P?(A=w+T-5,o=T-10,n=x-20,-1):(A=C+5,o=x-10,n=T-20,1),_&&(a=wt(t.variance),Ct(a)||(l=(s=""+a).substr(s.indexOf(".")+1).length,S=2<=l?(100*a).toFixed(l-2)+"%":(100*a).toFixed(0)+"%")),E<V&&(V=E,I=!0),V<k&&(V=k,I=!0),b=tt(b,E,k),I&&(M=tt(n,60,15)),c=o/(u=kt(E-k)),N=A+r*kt(k-b)*c,(R=kt(V-b)*c)>kt(u)*c&&(R=kt(u+k)*c),h=A+r*o,P&&N<h||!P&&h<N))){if(pe(v,C,w,x,T),b<V?z(O,0,5-o,o-5,0,1,w-N,Y,K,N-C-x,Lt,Ht,-1,kt(E-V)*c):(R>kt(u)*c&&(R=kt(u+k)*c,N=A),z(F,1,-5,5,2,3,N-w-T,K,Y,C-N,Ht,Lt,1,kt(k-V)*c)),i&&(f=A+r*(Math.abs(k-b)*c),G(C,f,C+x,f,f,w,f,w+T)),0<j)for(v.beginPath(),p=u/j,d=0;d<=p;d++)G(C,g=A+o/p*d*r,C+.1*x,g,g,w+.9*T,g,w+T,H,H);!xt(D)&&k<=D&&D<=E&&(v.beginPath(),m=A-(P?1:-1)*kt(k-D)*c,G(C,m,C+.33*x,m,m,w+.66*T,m,w+T,L,L),v.fill()),v.restore()}},BOXPLOTSPARKLINE:function(u,t,e,o,n,r){var i,a,s,l,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J,Z,q,K,Y,Q,X,$,tt,et,ot,nt,rt=t.points,it=t.boxPlotClass,at=t.showAverage,st=t.scaleStart,lt=t.scaleEnd,ut=t.acceptableStart,ct=t.acceptableEnd,ht=t.style,ft=t.colorScheme,pt=t.vertical,dt=ne(rt,!1),gt=ne(rt,!0);function mt(t,e,o,n,r,i,a,s,l){pt?fe(u,e,o,n,r,t):fe(u,i,a,s,l,t)}function yt(t,e,o,n){ae(u,pt,_+O*t,o,_+O*e,o,o,_+O*t,o,_+O*e,n)}if(!(xt(rt)||(rt=he(rt)).length<=0)){for((it=it===bt||typeof it!==vt?$t:it.toLocaleLowerCase())!==$t&&it!==Xt&&it!==te&&it!==ee&&it!==oe&&(it=$t),i=wt(st),i=Ct(i)?gt:i,a=wt(lt),a=Ct(a)?dt:a,s=wt(ut),l=wt(ct),ft!==bt&&typeof ft===vt||(ft="#D2D2D2"),(ht===bt||0!==ht&&1!==ht)&&(ht=0),c=Dt,gt<i&&(ft=c,i=gt),a<dt&&(ft=c,a=dt),pe(u,e,o,n,r),u.lineWidth=2,f=(h=le(e,o,n,r,5,r-10,pt)).left,p=h.width,d=h.top,g=h.height,m=pt?-1:1,y=t.perc02,b=t.perc09,v=t.perc10,C=t.perc90,w=t.perc91,x=t.perc98,T=t.q1,M=gt,I=dt,R=N=1.5*(S=(A=t.q3)-T),k=t.stDev,E=ue(rt)/Rt(1,rt.length),j=D=0,_=d+.1*g,O=.7*g,F=kt(a-i),P=0,L=rt.length;P<L;P++)(H=rt[P])<T&&T-1.5*S<=H&&H-(T-1.5*S)<N&&(N=H-(T-1.5*S),M=H),A<H&&H<=A+1.5*S&&A+1.5*S-H<R&&(R=A+1.5*S-H,I=H),B=!1,D=f+p*((H-i)/F)*m,it===te&&(H<=T-1.5*S||A+1.5*S<=H)&&(B=!0,j=H<=T-3*S||A+3*S<=H?0:1),it===Xt&&(H<=y||x<=H)&&(B=!0,j=1),it===oe&&(H<=E-2*k||E+2*k<=H)&&(B=!0,j=H<=E-3*k||E+3*k<=H?0:1),V=Et,B&&(1===ht?1===j?yt(.2,.8,D,V):yt(.3,.7,D,V):((z=.1*g)<2&&(z=2),u.beginPath(),u.strokeStyle=V,W=d+.45*g,u.arc(pt?W:D,pt?D:W,z/2,0,2*Math.PI),u.stroke()));switch((s<i||a<l)&&(ft="#C0FF00"),s=Rt(i,s),(l=Nt(a,l))<s?ft=c:s<l&&ae(u,pt,J=d+.9*g,G=f+p*((s-i)/F)*m,J,U=f+p*((l-i)/F)*m,G,J,U,J,jt),q=kt(f+p*((A-i)/F)*m-(Z=f+p*((T-i)/F)*m)),K=f+p*((t.median-i)/F)*m,it){case Xt:X=y,$=x;break;case te:X=M,$=I;break;case oe:q=kt(f+p*((E+k-i)/F)*m-(Z=f+p*((E-k-i)/F)*m)),K=f+p*((E-i)/F)*m,X=i<(tt=E-2*k)?tt:gt,$=(tt=E+2*k)<a?tt:dt,at=!1;break;case $t:case ee:default:X=gt,$=dt}Y=f+p*((X-i)/F)*m,Q=f+p*(($-i)/F)*m,et=Et,1===ht?mt("#F2F2F2",_,Q,O,Y-Q,Y,_,Q-Y,O):ae(u,pt,ot=d+.45*g,Y,ot,Q,Y,ot,Q,ot,et),mt(ft,_,Z-q,O,q,Z,_,q,O),ae(u,pt,_,K,_+O,K,K,_,K,_+O,et),0===ht&&(ae(u,pt,_+.3*O,Q,_+.7*O,Q,Q,_+.3*O,Q,_+.7*O,et),ae(u,pt,_+.3*O,Y,_+.7*O,Y,Y,_+.3*O,Y,_+.7*O,et)),it!==Xt&&it!==ee||(0,$=it===Xt?(X=b,w):(X=v,C),nt=f+p*((X-i)/F)*m,yt(.3,.7,f+p*(($-i)/F)*m,et),yt(.3,.7,nt,et)),at&&yt(.2,.8,D=f+p*((E-i)/F)*m,c),u.restore()}},CASCADESPARKLINE:function(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j,_,O,F,P,L,H,B,V,z,W,G,U,J,Z,q,K,Y,Q,X=e.points,$=e.labels,tt=e.pointIndex,et=e.minimum,ot=e.maximum,nt=e.colorPositive,rt=e.colorNegative,it=e.vertical,at=e.itemTypeRange,st=e.colorTotal,lt=13*a.zoomFactor;if(!(xt(X)||((s=X.length)<=0||(l=parseInt(tt,10),Ct(l)||l<=0||s<l)))){for($=xt($)?[]:$,nt!==bt&&typeof nt===vt||(nt="#8CBF64"),rt!==bt&&typeof rt===vt||(rt="#D6604D"),typeof st!==vt&&(st=bt),c=ut(u=nt,1.3),f=ut(h=rt,1.3),p=1,b=[],x=C=v=y=m=g=d=0,T=s;x<T;x++)C=X[x],w=at[x],A=!1,S=1===p,(M=!xt(w))&&(w===ft?C=kt(C):w===ht?C=-kt(C):w===pt?(A=!0,S?d=C:C=d):M=!1),b[p]=[],I=b[p],Ct(C)?(I[0]=0,I[1]=d,I[2]=0):(I[0]=kt(C),d=A?d:C+d,I[1]=0<C?g:d,I[2]=C),I[3]=p,m=Nt(g,m),y=Rt(g,y),((N=p===s)&&!M||A)&&(v=m<0?-m:0,I[1]=0<C?0:C),M&&A&&!S||(g=C+g,N&&M&&(m=Nt(g,m),y=Rt(g,y))),p++;R=!1,xt(w)||(R=-1===[ht,ft,pt].indexOf(w)),(xt(w)||R)&&(d-=C),D=wt(et),Ct(D)||0<D||m<D?D=k=m:v=-(k=D),j=wt(ot),Ct(j)||j<0||j<y?E=y:(E=j,v=-D),O=(_=le(o,n,r,i,5,i-10,it)).left,F=_.width,P=_.top,L=_.height,H=it?-1:1,B=F/(E-k),pe(t,o,n,r,i),t.beginPath(),t.lineWidth=1,z=(V=b[l])[2],W=at[l-1],G=O+H*(V[1]+v)*B,U=V[0]*B,Z=W===pt,q=(xt(W)||R)&&l===s||Z,J=st&&q?st:1===l||q?0<=z?u:h:0<=z?c:f,it?fe(t,P,G-U,L,U,J):fe(t,G,P,U,L,J),it?(1!==l&&(l!==s?be(t,0<z,ct,o,G,P+L,G,o,G-U,P+L,G-U):be(t,!0,ct,o,K=O-(d+v)*B,P+L,K)),l!==s&&be(t,0<z,ct,P,G-U,o+r,G-U,P,G,o+r,G)):(1!==l&&(l!==s?be(t,0<z,ct,G,n,G,P+L,G+U,n,G+U,P+L):be(t,!0,ct,Y=O+(d+v)*B,n,Y,P+L)),l!==s&&be(t,0<z,ct,G+U,P,G+U,n+i,G,P,G,n+i)),Q=$[l-1],0<$.length&&!xt(Q)&&""!==Q&&ve(t,o,n,r,i,{labelText:Q,vertical:it,isInRightOrTopOfBox:0<z,fontSize:lt,startBox:G,endBox:U,boxColor:J}),be(t,it,Ot,o,O-v*B,o+r,O-v*B,O+v*B,n,O+v*B,n+i),t.restore()}},PARETOSPARKLINE:function(i,t,a,s,l,u,e){var o,n,r,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R,k,E,D,j=t.points,_=t.pointIndex,O=t.colorRange,F=t.target,P=t.target2,L=t.highlightPosition,H=t.label,B=t.vertical,V=13*e.zoomFactor,z=t.targetColor,W=t.target2Color,G=t.labelColor,U=t.barSize;if(!xt(j)&&(xt(U)||!(Ct(U)||U<=0))&&(1<U&&(U=1),!((o=j.length)<=0||(n=parseInt(_,10),Ct(n)||n<=0||o<n)))){for(O=xt(O)?[]:O,r=parseInt(H,10),r=Ct(r)?0:r,c=1,f=[],p=h=0,d=j.length;p<d;p++)g=j[p],f[c]=[],m=f[c],g<0||Ct(g)||xt(g)?(m[0]=1===c?0:h,m[1]=0):(h+=g,m[0]=1===c?0:h-g,m[1]=g),c++;y=xt(U)?5:B?l*(1-U)/2:u*(1-U)/2,b=le(a,s,l,u,y,u-10,B,5),v=b.left,C=b.width,w=b.top,x=b.height,T=B?-1:1,A=C/h,pe(i,a,s,l,u),i.beginPath(),i.lineWidth=1,M=(S=f[n])[1],I=v+T*S[0]*A,N=S[1]*A,R=n===L?Dt:0===O.length||typeof O[n-1]!==vt?Et:O[n-1],B?fe(i,w,I-N,x,N,R):fe(i,I,w,N,x,R),1===r?k=(S[0]+M)/h*1e3:2===r&&(k=M/h*1e3),E=st(k)/10+"%",1!==r&&2!==r||!E||ve(i,a,s,l,u,{labelText:E,vertical:B,isInRightOrTopOfBox:(S[0]+S[1])*A<C/2,fontSize:V,startBox:I,endBox:N,boxColor:R,fillStyle:G}),D=[xt(z)?"#8CBF64":z,xt(W)?"#EE5D5D":W],[F,P].forEach(function(t,e){var o,n=(o=wt(t),1<(o=(o=Ct(o)?0:o)<0?0:o)?1:o),r=J(v+T*C*n);be(i,B,D[e],a,r,a+l,r,r,s,r,s+u)}),i.restore()}},MONTHSPARKLINE:function(t,e,o,n,r,i){var a,s,l,u,c=e.year,h=e.month,f=e.values,p=e.emptyColor||"lightgray",d=e.startColor,g=e.middleColor,m=e.endColor,y=(r-14)/6,b=(i-16)/7,v=[],C=new Date(c,h-1,1).getDay();for(a=0;a<42;a++)!(a<C)&&a<C+V(c,h)?v[a]=p:v[a]="white";for(it(f,v,C,e.colors,d,g,m),t.save(),t.rect(o,n,r,i),t.clip(),t.beginPath(),l=s=0;l<6;l++)for(u=0;u<7;u++)t.fillStyle=v[s],s++,t.fillRect(o+l*y+2*(l+1),n+u*b+2*(u+1),y,b);t.restore()},YEARSPARKLINE:function(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g,m,y,b,v,C,w,x,T,A,S,M,I,N,R=e.year,k=e.values,E=e.emptyColor||"lightgray",D=e.startColor,j=e.middleColor,_=e.endColor,O=parseInt(366/7+"",10)+2,F=[],P=new Date(R,0,1).getDay(),L=at(new Date(R,11,31));for(s=0;s<7*O;s++)F[s]=!(s<P)&&s<P+L?E:"white";for(it(k,F,P,e.colors,D,j,_),t.save(),t.rect(o,n,r,i),t.clip(),c=o+(u=15*(l=a.zoomFactor)),h=n,f=r-u,p=i,t.save(),t.translate(o+u/2,h+p),t.rotate(-Math.PI/2),t.font=13*l+X,t.fillStyle="black",t.textBaseline="middle",t.textAlign="center",t.fillText(R+"",p/2,0),t.restore(),d=(f-2*(O+1))/O,g=(p-16)/7,C=[],b=m=0;b<O;b++)for(y=0;y<7;y++)v={x:c+b*d+2*(b+1),y:h+y*g+2*(y+1),w:d,h:g},C[m]=v,t.fillStyle=F[m],m++,t.fillRect(v.x,v.y,v.w,v.h);for(w=[],x={},T=0;T<12;T++)x[T]=at(new Date(R,T,1))-1+P;for(A=x[11]+V(R,12)-1,b=m=0;b<O;b++)for(y=0;y<7;y++)P<=m&&m<P+L&&(M=x[(S=new Date(R,0,m-P+1)).getMonth()],v=C[m],M<=m&&m<7+M&&w.push({x1:v.x,y1:v.y-1,x2:v.x,y2:v.y+v.h+1}),m!==M&&0!==S.getDay()||w.push({x1:v.x-1,y1:v.y,x2:v.x+v.w+1+(m===M?2:0),y2:v.y}),A-7<m&&m<=A&&w.push({x1:v.x+v.w,y1:v.y-1,x2:v.x+v.w,y2:v.y+v.h+1}),m!==A&&6!==S.getDay()||w.push({x1:v.x-1-(m===A?2:0),y1:v.y+v.h,x2:v.x+v.w+1,y2:v.y+v.h})),m++;for(t.strokeStyle="black",t.lineWidth=2,I=0;I<w.length;I++)N=w[I],t.beginPath(),t.moveTo(N.x1,N.y1),t.lineTo(N.x2,N.y2),t.stroke();t.restore()},GAUGEKPISPARKLINE:function(t,e,o,n,r,i,a){t.save(),t.rect(o,n,r,i),t.clip(),0===e.gaugeType?T(t,e,o,n,r,i,a):1===e.gaugeType?A(t,e,o,n,r,i,a):2===e.gaugeType&&S(t,e,o,n,r,i,a),t.restore()},HISTOGRAMSPARKLINE:function(t,e,o,n,r,i,a){var s,l,u=e.barColor,c=e.values,h=e.paintLabel,f=e.barWidth,p=e.labelFontStyle,d=e.afterZoomFontStyle,g=e.edgeColor,m=e.labelColor;xt(p)||(i<3*d.fontPixelSize||M(t,c,r,0,I(d)))&&(h=!1),h&&xt(p)&&(s=Math.floor(12<=i/3?12:Math.floor(i/3)),d.fontPixelSize=s,d.fontSize=s+"px",M(t,c,r,0,I(d))&&(h=!1)),function(t,e,o){t.save(),t.fillStyle=o;for(var n=0;n<e.length;n++)t.fillRect(e[n].x,e[n].y,e[n].width,e[n].height);t.restore()}(t,l=function(t,e,o,n,r,i,a,s){var l,u,c,h,f,p,d=[],g=t.length,m=0,y=a.fontPixelSize;if(i&&(m=y+3),0===g)return d;for(l=n/g,u=t[0].value,c=1;c<g;c++)u=Math.max(u,t[c].value);for(h=0;h<g;h++)f=o+r-m,(p=t[h].value/u*(r-m))<0&&(p=0),d.push({x:e+h*l+l*(1-s)/2,textX:e+h*l,y:f-p,width:l*s,textWidth:l,height:p,axis:t[h].axis});return d}(c,o+3,n+3,r-6,i-6,h,d,f),u),function(t,e,o,n){if("none"!==n){t.save(),t.lineWidth=1,t.strokeStyle=n,t.beginPath();for(var r=0;r<e.length;r++)re(t,e[r].x,e[r].y,e[r].x+e[r].width,e[r].y),re(t,e[r].x,e[r].y+e[r].height,e[r].x+e[r].width,e[r].y+e[r].height),e[r-1]&&e[r-1].height>=e[r].height&&1===o||re(t,e[r].x,e[r].y,e[r].x,e[r].y+e[r].height),e[r+1]&&e[r+1].height>e[r].height&&1===o||re(t,e[r].x+e[r].width,e[r].y,e[r].x+e[r].width,e[r].y+e[r].height);t.stroke(),t.closePath(),t.restore()}}(t,l,f,g),h&&function(t,e,o,n){var r,i,a,s,l;for(t.save(),r=o.fontPixelSize,i=I(o),t.textAlign="center",t.fillStyle=n,a=0;a<e.length;a++)0,s=e[a].x+e[a].width/2,l=e[a].y+e[a].height+5+r,t.save(),t.font=i,t.beginPath(),t.rect(e[a].textX,e[a].y+e[a].height+1,e[a].textWidth,r+3),t.clip(),t.textBaseline="bottom",t.fillText(e[a].axis,s,l),t.restore();t.restore()}(t,l,d,m)},IMAGESPARKLINE:function(t,e,o,n,r,i,a){var s,l,u,c,h,f,p,d,g;t.save(),t.rect(o,n,r,i),t.clip(),s=e.clipX,l=e.clipY,u=e.clipWidth,c=e.clipHeight,h=e.paintX,f=e.paintY,p=e.paintWidth,d=e.paintHeight,g=e.img,0<u&&0<c&&0<p&&0<d&&t.drawImage(g,s,l,u,c,h,f,p,d),t.restore()}}}},i.c=n,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(e,t){var o,n;if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;if(o=Object.create(null),i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(n in e)i.d(o,n,function(t){return e[t]}.bind(null,n));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/assets/",i(i.s="./src/all.entry.ts")),t.exports=r.Spread},"./node_modules_local/@grapecity/js-sheets-common/index.js":function(t,e,o){t.exports=o("./node_modules_local/@grapecity/js-sheets-common/dist/gc.spread.common.js")},"@grapecity/js-calc":function(t,e){t.exports=Kt.Spread.CalcEngine},"@grapecity/js-sheets-common":function(t,e){t.exports=Kt.Spread},Bindings:function(t,e){t.exports=Kt.Spread.Sheets.Bindings},CellTypes:function(t,e){t.exports=Kt.Spread.Sheets.CellTypes},ConditionalFormatting:function(t,e){t.exports=Kt.Spread.Sheets.ConditionalFormatting},Core:function(t,e){t.exports=Kt.Spread.Sheets},Filters:function(t,e){t.exports=Kt.Spread.Sheets.Filter},SheetsCalc:function(t,e){t.exports=Kt.Spread.Sheets.CalcEngine},Sparkline:function(t,e){t.exports=Kt.Spread.Sheets.Sparklines}},s.c=a,s.d=function(t,e,o){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(e,t){var o,n;if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;if(o=Object.create(null),s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(n in e)s.d(o,n,function(t){return e[t]}.bind(null,n));return o},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s="./all.entry.js")),r=Kt||{},"object"==typeof t.exports?t.exports=r:void 0===(n=function(){return r}.apply(e,[]))||(t.exports=n)}},r.c=n,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/dist/",r(r.s=672));function r(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return o[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}var e=window.WynBi||{},i=e.__libs||{};i.GCSpread||(i.GCSpread=t),e.__libs=i,window.WynBi=e,window.WynDashboards=e}();